//!HOOK LUMA
//!DESC ACNet Layer0 L0
//!WHEN OUTPUT.w LUMA.w / 1.2 > OUTPUT.h LUMA.h / 1.2 > *
//!BIND LUMA
//!SAVE TMP1_L0
//!COMPONENTS 4

#define ACTIVE(v) (max(v, 0.0f))

#define TEX_BIND_L0_TEXOFF LUMA_texOff
#define TEX_BIND_L0_TEX LUMA_tex
#define TEX_BIND_L0_POS LUMA_pos
#define TEX_BIND_L0_SIZE LUMA_size
#define TEX_BIND_L0_PT LUMA_pt

const float kernels[36] = float[36](
  -0.0206762f, +0.0067641f, +0.2828742f, +0.2557583f, +0.1976527f, -0.2470002f, +0.3505613f, +0.2930586f,
  -0.2224502f, +0.0847058f, -0.2945489f, -0.0558305f, -0.0846346f, -0.0968348f, +0.3120822f, +0.1769044f,
  +0.0276244f, +0.0519545f, -0.5386918f, +0.0729341f, -0.0017662f, -0.0314024f, +0.3170035f, +0.1496461f,
  +0.0385689f, +0.0055025f, -0.0066555f, -0.0000000f, -0.0000000f, -0.0000000f, -0.0000000f, -0.0000000f,
  -0.0000000f, -0.0000000f, -0.0000000f, -0.0000000f
);

const float biases[4] = float[4](
  -0.0909640f, +0.2113586f, -0.0120111f, -0.0000000f
);

vec4 hook() {
    const vec4 r0 = vec4(
        TEX_BIND_L0_TEXOFF(vec2(-1.0f,-1.0f)).x,
        TEX_BIND_L0_TEXOFF(vec2( 0.0f,-1.0f)).x,
        TEX_BIND_L0_TEXOFF(vec2( 1.0f,-1.0f)).x,
        TEX_BIND_L0_TEXOFF(vec2(-1.0f, 0.0f)).x
    );
    const vec4 r4 = vec4(
        TEX_BIND_L0_TEXOFF(vec2( 0.0f, 0.0f)).x,
        TEX_BIND_L0_TEXOFF(vec2( 1.0f, 0.0f)).x,
        TEX_BIND_L0_TEXOFF(vec2(-1.0f, 1.0f)).x,
        TEX_BIND_L0_TEXOFF(vec2( 0.0f, 1.0f)).x
    );
    const float r8 = TEX_BIND_L0_TEXOFF(vec2( 1.0f, 1.0f)).x;

    float sum[4] = biases;
    for(int n = 0; n < 4; n++) {
        const vec4 k0 = vec4(kernels[n * 9 + 0], kernels[n * 9 + 1], kernels[n * 9 + 2], kernels[n * 9 + 3]);
        const vec4 k4 = vec4(kernels[n * 9 + 4], kernels[n * 9 + 5], kernels[n * 9 + 6], kernels[n * 9 + 7]);
        const float k8 = kernels[n * 9 + 8];
        sum[n] += (dot(r0, k0) + dot(r4, k4) + r8 * k8);
    }

    return ACTIVE(vec4(sum[0], sum[1], sum[2], sum[3]));
}

//!HOOK LUMA
//!DESC ACNet Layer0 L1
//!WHEN OUTPUT.w LUMA.w / 1.2 > OUTPUT.h LUMA.h / 1.2 > *
//!BIND LUMA
//!SAVE TMP1_L1
//!COMPONENTS 4

#define ACTIVE(v) (max(v, 0.0f))

#define TEX_BIND_L0_TEXOFF LUMA_texOff
#define TEX_BIND_L0_TEX LUMA_tex
#define TEX_BIND_L0_POS LUMA_pos
#define TEX_BIND_L0_SIZE LUMA_size
#define TEX_BIND_L0_PT LUMA_pt

const float kernels[36] = float[36](
  +0.1845103f, -0.0545844f, +0.1449437f, +0.1343278f, +0.1007308f, +0.2637061f, +0.0612608f, +0.2211581f,
  +0.2007449f, +0.0596690f, -0.0391684f, +0.2167416f, -0.2913211f, +0.0030285f, +0.1262516f, -0.0434149f,
  +0.1866277f, -0.1655411f, +0.1010195f, +0.0634665f, +0.1522538f, +0.2169221f, +0.1986008f, -0.0704560f,
  -0.0016406f, -0.2783399f, -0.3544866f, -0.3014004f, -0.4234837f, -0.5826325f, +0.2314010f, -0.2684295f,
  -0.1106910f, -0.0914842f, +0.0114858f, +0.0563957f
);

const float biases[4] = float[4](
  -0.1444289f, +0.1896762f, -0.0290272f, +0.1619869f
);

vec4 hook() {
    const vec4 r0 = vec4(
        TEX_BIND_L0_TEXOFF(vec2(-1.0f,-1.0f)).x,
        TEX_BIND_L0_TEXOFF(vec2( 0.0f,-1.0f)).x,
        TEX_BIND_L0_TEXOFF(vec2( 1.0f,-1.0f)).x,
        TEX_BIND_L0_TEXOFF(vec2(-1.0f, 0.0f)).x
    );
    const vec4 r4 = vec4(
        TEX_BIND_L0_TEXOFF(vec2( 0.0f, 0.0f)).x,
        TEX_BIND_L0_TEXOFF(vec2( 1.0f, 0.0f)).x,
        TEX_BIND_L0_TEXOFF(vec2(-1.0f, 1.0f)).x,
        TEX_BIND_L0_TEXOFF(vec2( 0.0f, 1.0f)).x
    );
    const float r8 = TEX_BIND_L0_TEXOFF(vec2( 1.0f, 1.0f)).x;

    float sum[4] = biases;
    for(int n = 0; n < 4; n++) {
        const vec4 k0 = vec4(kernels[n * 9 + 0], kernels[n * 9 + 1], kernels[n * 9 + 2], kernels[n * 9 + 3]);
        const vec4 k4 = vec4(kernels[n * 9 + 4], kernels[n * 9 + 5], kernels[n * 9 + 6], kernels[n * 9 + 7]);
        const float k8 = kernels[n * 9 + 8];
        sum[n] += (dot(r0, k0) + dot(r4, k4) + r8 * k8);
    }

    return ACTIVE(vec4(sum[0], sum[1], sum[2], sum[3]));
}

//!HOOK LUMA
//!DESC ACNet Layer1 L0
//!WHEN OUTPUT.w LUMA.w / 1.2 > OUTPUT.h LUMA.h / 1.2 > *
//!BIND TMP1_L0
//!BIND TMP1_L1
//!SAVE TMP2_L0
//!COMPONENTS 4

#define ACTIVE(v) (max(v, 0.0f))

#define TEX_BIND_L0_TEXOFF TMP1_L0_texOff
#define TEX_BIND_L0_TEX TMP1_L0_tex
#define TEX_BIND_L0_POS TMP1_L0_pos
#define TEX_BIND_L0_SIZE TMP1_L0_size
#define TEX_BIND_L0_PT TMP1_L0_pt

#define TEX_BIND_L1_TEXOFF TMP1_L1_texOff
#define TEX_BIND_L1_TEX TMP1_L1_tex
#define TEX_BIND_L1_POS TMP1_L1_pos
#define TEX_BIND_L1_SIZE TMP1_L1_size
#define TEX_BIND_L1_PT TMP1_L1_pt

const float kernels[288] = float[288](
  +0.0445607f, -0.0338266f, +0.0627637f, -0.0000000f, +0.1384885f, -0.2595045f, -0.4577001f, -0.1571617f,
  +0.4352682f, -0.0790549f, +0.2547534f, -0.0000000f, +0.1156438f, -0.1418184f, +0.0415615f, -0.1835572f,
  -0.0897374f, +0.2698168f, +0.1370516f, -0.0000000f, -0.1817483f, +0.3181363f, +0.1372052f, +0.0211138f,
  -0.0049011f, -0.0524851f, +0.2099666f, -0.0000000f, -0.0055355f, +0.1766241f, -0.0584436f, -0.3223283f,
  +0.1487912f, -0.4204614f, +0.7335962f, -0.0000000f, -0.1511651f, +0.1842034f, +0.0331476f, +0.0210639f,
  -0.0822098f, -0.0568384f, +0.2080102f, -0.0000000f, -0.2465434f, -0.1518071f, -0.2337010f, +0.2701906f,
  -0.0175933f, +0.1091934f, -0.1149975f, -0.0000000f, +0.0081590f, +0.0762333f, +0.1537421f, -0.1370240f,
  +0.0492943f, -0.0731409f, +0.3124493f, -0.0000000f, -0.1168055f, -0.0783724f, -0.1116212f, +0.2696919f,
  +0.1805808f, +0.0947968f, +0.6745725f, -0.0000000f, +0.0000347f, -0.3196765f, -0.0074099f, +0.2103261f,
  +0.0890272f, -0.0097157f, +0.1066043f, -0.0000000f, +0.0792546f, -0.0148861f, +0.0982617f, -0.2512516f,
  -0.0799691f, +0.0929058f, +0.0116086f, -0.0000000f, +0.0945476f, -0.0714991f, -0.2421490f, -0.1007299f,
  +0.1009555f, +0.0603003f, -0.1241543f, -0.0000000f, +0.0881545f, -0.0707188f, -0.1705063f, +0.4532970f,
  +0.0667726f, -0.0022104f, +0.0263716f, -0.0000000f, -0.0281630f, +0.0975616f, +0.1809561f, +0.1858834f,
  +0.0395584f, +0.0681978f, -0.0363110f, -0.0000000f, +0.1242835f, +0.0909485f, +0.1810644f, -0.2680897f,
  -0.0749444f, -0.1293111f, +0.1562455f, -0.0000000f, -0.0064973f, -0.0565884f, +0.1310842f, -0.1570906f,
  -0.0597885f, +0.0892878f, -0.0795954f, -0.0000000f, +0.0778754f, -0.0128719f, +0.2064860f, +0.4766751f,
  +0.1226528f, -0.1255357f, -0.3366198f, -0.0000000f, +0.0747654f, -0.0663903f, +0.1224224f, -0.2420808f,
  +0.0338727f, -0.0432703f, -0.4076021f, -0.0000000f, -0.0524051f, -0.0641468f, +0.0372255f, -0.6601220f,
  +0.1356080f, +0.0592575f, +0.0291392f, -0.0000000f, +0.0232527f, +0.0395533f, -0.2516233f, +0.0178540f,
  +0.0541092f, -0.0181745f, +0.2274731f, -0.0000000f, +0.0698927f, +0.0000472f, +0.0766594f, +0.0017404f,
  +0.0618994f, +0.0737142f, -0.0640747f, -0.0000000f, +0.1477360f, -0.0555582f, +0.1724489f, -0.0087356f,
  -0.0196049f, +0.0200522f, +0.0730967f, -0.0000000f, +0.0960870f, +0.0416413f, -0.0585221f, -0.0607766f,
  +0.1134888f, +0.0432447f, +0.1570279f, -0.0000000f, +0.0023102f, +0.0587055f, +0.1436491f, -0.0626874f,
  +0.0357809f, -0.0050879f, -0.5381455f, -0.0000000f, -0.0344492f, -0.1033705f, +0.2118881f, -0.0114999f,
  +0.0035513f, -0.0110815f, +0.1062030f, -0.0000000f, +0.0268193f, +0.1129092f, -0.0288967f, -0.1646828f,
  +0.0312121f, -0.1075258f, -0.1138583f, -0.0000000f, +0.1025413f, +0.0596225f, -0.0573647f, -0.2505769f,
  -0.0603990f, -0.0017896f, +0.1710275f, -0.0000000f, -0.0282000f, +0.0706774f, +0.1423223f, -0.1279818f,
  +0.0231935f, +0.0472694f, +0.1864523f, +0.0000000f, +0.0122250f, -0.0203715f, -0.1453882f, -0.1144853f,
  +0.1720883f, +0.1127569f, +0.1054289f, +0.0000000f, +0.1238551f, +0.0834654f, -0.2392337f, -0.0014973f,
  +0.1668726f, -0.0092701f, -0.1559042f, +0.0000000f, +0.0677125f, -0.0742328f, -0.2281802f, -0.0070451f,
  -0.0344826f, +0.0153225f, +0.2105568f, +0.0000000f, +0.0312630f, +0.1226850f, -0.0323677f, -0.0932048f,
  -0.0168462f, +0.0135522f, +0.1105056f, +0.0000000f, +0.1361720f, +0.0840457f, -0.0743599f, -0.1031228f,
  +0.0259301f, +0.0902561f, -0.1551393f, +0.0000000f, +0.1535181f, -0.0368690f, +0.0234927f, +0.0465028f,
  +0.1441042f, -0.0089393f, -0.0704837f, +0.0000000f, +0.0234052f, +0.1024216f, +0.1700374f, -0.2214795f,
  +0.0429320f, +0.0709033f, -0.1515289f, +0.0000000f, +0.0854660f, +0.0732185f, +0.0629240f, -0.1811098f,
  -0.0050149f, -0.0693794f, -0.5087305f, +0.0000000f, +0.0873029f, -0.1149578f, +0.0893275f, -0.1199159f
);

const float biases[4] = float[4](
  +0.0726783f, +0.0085350f, +0.0504003f, +0.0262684f
);

vec4 hook() {
    const vec4 r[9][2] = vec4[9][2](
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 1.0f)))
    );

    float sum[4] = biases;
    for (int n = 0; n < 4; n++) {
        for (int i = 0; i < 9; i++) {
            const vec4 k0 = vec4(kernels[n * 8 * 9 + 8 * i + 0], kernels[n * 8 * 9 + 8 * i + 1], kernels[n * 8 * 9 + 8 * i + 2], kernels[n * 8 * 9 + 8 * i + 3]);
            const vec4 k1 = vec4(kernels[n * 8 * 9 + 8 * i + 4], kernels[n * 8 * 9 + 8 * i + 5], kernels[n * 8 * 9 + 8 * i + 6], kernels[n * 8 * 9 + 8 * i + 7]);
            sum[n] += (dot(k0, r[i][0]) + dot(k1, r[i][1]));
        }
    }

    return ACTIVE(vec4(sum[0], sum[1], sum[2], sum[3]));
}

//!HOOK LUMA
//!DESC ACNet Layer1 L1
//!WHEN OUTPUT.w LUMA.w / 1.2 > OUTPUT.h LUMA.h / 1.2 > *
//!BIND TMP1_L0
//!BIND TMP1_L1
//!SAVE TMP2_L1
//!COMPONENTS 4

#define ACTIVE(v) (max(v, 0.0f))

#define TEX_BIND_L0_TEXOFF TMP1_L0_texOff
#define TEX_BIND_L0_TEX TMP1_L0_tex
#define TEX_BIND_L0_POS TMP1_L0_pos
#define TEX_BIND_L0_SIZE TMP1_L0_size
#define TEX_BIND_L0_PT TMP1_L0_pt

#define TEX_BIND_L1_TEXOFF TMP1_L1_texOff
#define TEX_BIND_L1_TEX TMP1_L1_tex
#define TEX_BIND_L1_POS TMP1_L1_pos
#define TEX_BIND_L1_SIZE TMP1_L1_size
#define TEX_BIND_L1_PT TMP1_L1_pt

const float kernels[288] = float[288](
  +0.0981397f, +0.0423832f, -0.1329222f, -0.0000000f, -0.0217141f, +0.0108135f, -0.0973924f, -0.0676844f,
  +0.0998234f, +0.0307074f, +0.0294775f, -0.0000000f, -0.0352992f, +0.0312937f, +0.0440817f, +0.1129002f,
  -0.0202816f, +0.0285597f, +0.0680319f, -0.0000000f, -0.0075803f, -0.0259073f, +0.1447277f, +0.0428273f,
  -0.0819731f, +0.1043716f, +0.1574063f, -0.0000000f, -0.0240867f, +0.0119625f, +0.0494359f, -0.1085990f,
  +0.1425452f, +0.0612904f, +0.4025818f, -0.0000000f, +0.0752646f, -0.0068664f, +0.2885924f, +0.1295200f,
  -0.0523915f, -0.0977961f, +0.2583767f, -0.0000000f, +0.0766975f, -0.1408369f, +0.2825239f, +0.5978360f,
  +0.0080350f, -0.0171248f, +0.1394796f, -0.0000000f, +0.0453090f, +0.0770133f, -0.0358279f, -0.3540216f,
  -0.0482990f, -0.1357249f, +0.3571320f, -0.0000000f, +0.0895290f, -0.1230534f, -0.0756164f, -0.0395582f,
  -0.0779082f, -0.1534509f, -0.3982472f, -0.0000000f, +0.0076510f, -0.0678000f, +0.2487542f, -0.6077479f,
  -0.0128538f, +0.1268820f, +0.0824996f, +0.0000000f, +0.0144585f, -0.0332506f, -0.0115668f, -0.1139747f,
  +0.1524031f, +0.0285360f, +0.2141338f, +0.0000000f, +0.1080057f, -0.0730963f, -0.2212495f, -0.0351825f,
  +0.1411495f, +0.0948771f, +0.0390155f, +0.0000000f, +0.1590631f, -0.1433025f, -0.0939528f, +0.0229936f,
  -0.0281340f, +0.0960333f, +0.1836109f, +0.0000000f, -0.0146764f, +0.0570095f, -0.0753776f, -0.0651010f,
  -0.0129387f, -0.0139012f, +0.2527061f, +0.0000000f, +0.1369946f, -0.0319047f, -0.1206933f, -0.1501891f,
  -0.0262034f, +0.0600354f, -0.2279411f, +0.0000000f, +0.0924601f, -0.1203466f, +0.1321697f, -0.0274512f,
  +0.1130032f, -0.1124901f, -0.0811953f, +0.0000000f, -0.0364790f, +0.1183778f, -0.0773568f, -0.2426015f,
  +0.1448119f, +0.0439708f, -0.1226873f, +0.0000000f, +0.1452886f, +0.0570109f, -0.1317063f, -0.1354289f,
  -0.0514540f, -0.1091844f, -0.2609711f, +0.0000000f, -0.0286813f, +0.0208002f, +0.1277602f, -0.0198893f,
  -0.0000000f, -0.0000000f, -0.0000000f, -0.0000000f, +0.0000000f, -0.0000000f, -0.0000000f, -0.0000000f,
  -0.0000000f, -0.0000000f, -0.0000000f, -0.0000000f, +0.0000000f, -0.0000000f, -0.0000000f, -0.0000000f,
  -0.0000000f, -0.0000000f, -0.0000000f, -0.0000000f, +0.0000000f, -0.0000000f, -0.0000000f, +0.0000000f,
  -0.0000000f, -0.0000000f, +0.0000000f, -0.0000000f, +0.0000000f, -0.0000000f, +0.0000000f, -0.0000000f,
  -0.0000000f, -0.0000000f, +0.0000000f, -0.0000000f, -0.0000000f, -0.0000000f, +0.0000000f, +0.0000000f,
  -0.0000000f, -0.0000000f, +0.0000000f, -0.0000000f, +0.0000000f, -0.0000000f, +0.0000000f, +0.0000000f,
  -0.0000000f, -0.0000000f, -0.0000000f, -0.0000000f, +0.0000000f, -0.0000000f, -0.0000000f, +0.0000000f,
  -0.0000000f, -0.0000000f, -0.0000000f, -0.0000000f, +0.0000000f, -0.0000000f, -0.0000000f, +0.0000000f,
  -0.0000000f, -0.0000000f, -0.0000000f, -0.0000000f, +0.0000000f, -0.0000000f, -0.0000000f, -0.0000000f,
  +0.0531404f, -0.0348264f, -0.0746287f, -0.0000000f, +0.0555116f, -0.2049247f, +0.0889276f, +0.1742255f,
  +0.1028146f, -0.0511483f, +0.0396335f, -0.0000000f, -0.0215216f, +0.0814414f, -0.4360594f, -0.0531074f,
  +0.1476746f, +0.0970788f, +0.1344548f, -0.0000000f, +0.1086630f, -0.1351299f, -0.0848233f, +0.0229245f,
  -0.0615299f, -0.0136032f, +0.0421534f, -0.0000000f, -0.0928116f, +0.0474471f, -0.0561333f, -0.1762152f,
  -0.0941661f, -0.1224927f, +0.7112924f, -0.0000000f, -0.0351192f, +0.2008115f, +0.3513190f, +0.0444528f,
  +0.0486714f, -0.0193296f, +0.0287032f, -0.0000000f, +0.1139649f, -0.3124909f, +0.1863322f, +0.0281311f,
  +0.0056787f, -0.0681843f, +0.0782472f, -0.0000000f, -0.1392165f, -0.0185458f, -0.0043855f, +0.2686252f,
  -0.1455100f, -0.1434415f, +0.7220991f, -0.0000000f, +0.0672869f, +0.2068014f, +0.0548692f, -0.2908536f,
  +0.0156142f, -0.0094023f, -0.6619805f, -0.0000000f, -0.0556261f, +0.0739788f, +0.1165821f, -0.1509766f
);

const float biases[4] = float[4](
  +0.0624341f, +0.1048340f, -0.0000000f, +0.1006201f
);

vec4 hook() {
    const vec4 r[9][2] = vec4[9][2](
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 1.0f)))
    );

    float sum[4] = biases;
    for (int n = 0; n < 4; n++) {
        for (int i = 0; i < 9; i++) {
            const vec4 k0 = vec4(kernels[n * 8 * 9 + 8 * i + 0], kernels[n * 8 * 9 + 8 * i + 1], kernels[n * 8 * 9 + 8 * i + 2], kernels[n * 8 * 9 + 8 * i + 3]);
            const vec4 k1 = vec4(kernels[n * 8 * 9 + 8 * i + 4], kernels[n * 8 * 9 + 8 * i + 5], kernels[n * 8 * 9 + 8 * i + 6], kernels[n * 8 * 9 + 8 * i + 7]);
            sum[n] += (dot(k0, r[i][0]) + dot(k1, r[i][1]));
        }
    }

    return ACTIVE(vec4(sum[0], sum[1], sum[2], sum[3]));
}

//!HOOK LUMA
//!DESC ACNet Layer2 L0
//!WHEN OUTPUT.w LUMA.w / 1.2 > OUTPUT.h LUMA.h / 1.2 > *
//!BIND TMP2_L0
//!BIND TMP2_L1
//!SAVE TMP1_L0
//!COMPONENTS 4

#define ACTIVE(v) (max(v, 0.0f))

#define TEX_BIND_L0_TEXOFF TMP2_L0_texOff
#define TEX_BIND_L0_TEX TMP2_L0_tex
#define TEX_BIND_L0_POS TMP2_L0_pos
#define TEX_BIND_L0_SIZE TMP2_L0_size
#define TEX_BIND_L0_PT TMP2_L0_pt

#define TEX_BIND_L1_TEXOFF TMP2_L1_texOff
#define TEX_BIND_L1_TEX TMP2_L1_tex
#define TEX_BIND_L1_POS TMP2_L1_pos
#define TEX_BIND_L1_SIZE TMP2_L1_size
#define TEX_BIND_L1_PT TMP2_L1_pt

const float kernels[288] = float[288](
  -0.0000000f, +0.0000000f, -0.0000000f, -0.0000000f, +0.0000000f, -0.0000000f, +0.0000000f, +0.0000000f,
  +0.0000000f, -0.0000000f, +0.0000000f, -0.0000000f, +0.0000000f, +0.0000000f, +0.0000000f, -0.0000000f,
  +0.0000000f, +0.0000000f, -0.0000000f, -0.0000000f, +0.0000000f, -0.0000000f, +0.0000000f, +0.0000000f,
  -0.0000000f, -0.0000000f, -0.0000000f, +0.0000000f, -0.0000000f, +0.0000000f, -0.0000000f, +0.0000000f,
  -0.0000000f, +0.0000000f, -0.0000000f, -0.0000000f, -0.0000000f, -0.0000000f, +0.0000000f, +0.0000000f,
  -0.0000000f, -0.0000000f, -0.0000000f, +0.0000000f, -0.0000000f, -0.0000000f, +0.0000000f, +0.0000000f,
  -0.0000000f, -0.0000000f, +0.0000000f, +0.0000000f, +0.0000000f, -0.0000000f, -0.0000000f, +0.0000000f,
  -0.0000000f, -0.0000000f, -0.0000000f, -0.0000000f, +0.0000000f, +0.0000000f, -0.0000000f, +0.0000000f,
  +0.0000000f, +0.0000000f, -0.0000000f, -0.0000000f, -0.0000000f, +0.0000000f, -0.0000000f, -0.0000000f,
  -0.0000000f, +0.0000000f, -0.0000000f, -0.0000000f, -0.0000000f, -0.0000000f, +0.0000000f, +0.0000000f,
  -0.0000000f, -0.0000000f, -0.0000000f, -0.0000000f, -0.0000000f, -0.0000000f, +0.0000000f, +0.0000000f,
  -0.0000000f, -0.0000000f, -0.0000000f, -0.0000000f, -0.0000000f, -0.0000000f, +0.0000000f, +0.0000000f,
  +0.0000000f, -0.0000000f, -0.0000000f, -0.0000000f, -0.0000000f, -0.0000000f, +0.0000000f, +0.0000000f,
  -0.0000000f, -0.0000000f, -0.0000000f, -0.0000000f, -0.0000000f, -0.0000000f, -0.0000000f, +0.0000000f,
  -0.0000000f, -0.0000000f, -0.0000000f, -0.0000000f, -0.0000000f, -0.0000000f, +0.0000000f, +0.0000000f,
  -0.0000000f, +0.0000000f, -0.0000000f, -0.0000000f, -0.0000000f, -0.0000000f, +0.0000000f, +0.0000000f,
  -0.0000000f, -0.0000000f, -0.0000000f, -0.0000000f, -0.0000000f, -0.0000000f, -0.0000000f, +0.0000000f,
  -0.0000000f, -0.0000000f, -0.0000000f, -0.0000000f, -0.0000000f, -0.0000000f, -0.0000000f, +0.0000000f,
  -0.1496328f, -0.0297183f, -0.0601388f, +0.0828493f, -0.0039591f, +0.1562593f, +0.0000000f, +0.0622939f,
  -0.0803597f, -0.0269313f, -0.0227562f, +0.0597112f, +0.0586172f, +0.0897970f, +0.0000000f, -0.0056804f,
  -0.0790540f, +0.0157684f, -0.0554120f, +0.1435157f, -0.0138425f, -0.0154582f, +0.0000000f, -0.4729252f,
  -0.1373079f, +0.0592324f, +0.0453627f, +0.0117565f, -0.0299489f, +0.1560719f, +0.0000000f, +0.1316081f,
  +0.0507656f, +0.0784706f, +0.1639342f, +0.0154399f, +0.0348772f, +0.0145610f, +0.0000000f, +0.3118670f,
  +0.0696727f, +0.0994653f, +0.0374285f, +0.1303923f, +0.0050679f, +0.1172006f, +0.0000000f, -0.1801339f,
  +0.0322128f, +0.0248723f, +0.0524967f, +0.0043324f, +0.0372776f, -0.0161121f, +0.0000000f, +0.0499077f,
  +0.0332502f, -0.0442261f, +0.0954350f, +0.0591186f, -0.0252208f, +0.0779084f, +0.0000000f, +0.0985831f,
  +0.1317048f, +0.0323569f, +0.0971550f, +0.1112914f, +0.1219142f, -0.0613216f, +0.0000000f, +0.0388632f,
  -0.0000000f, -0.0000000f, -0.0000000f, +0.0000000f, -0.0000000f, +0.0000000f, +0.0000000f, -0.0000000f,
  +0.0000000f, +0.0000000f, +0.0000000f, -0.0000000f, -0.0000000f, +0.0000000f, +0.0000000f, +0.0000000f,
  +0.0000000f, -0.0000000f, +0.0000000f, +0.0000000f, +0.0000000f, +0.0000000f, +0.0000000f, +0.0000000f,
  -0.0000000f, -0.0000000f, -0.0000000f, -0.0000000f, -0.0000000f, -0.0000000f, -0.0000000f, +0.0000000f,
  +0.0000000f, -0.0000000f, +0.0000000f, -0.0000000f, -0.0000000f, -0.0000000f, -0.0000000f, -0.0000000f,
  +0.0000000f, -0.0000000f, +0.0000000f, +0.0000000f, -0.0000000f, +0.0000000f, -0.0000000f, +0.0000000f,
  -0.0000000f, +0.0000000f, -0.0000000f, -0.0000000f, -0.0000000f, -0.0000000f, -0.0000000f, -0.0000000f,
  +0.0000000f, -0.0000000f, +0.0000000f, +0.0000000f, +0.0000000f, -0.0000000f, -0.0000000f, +0.0000000f,
  -0.0000000f, -0.0000000f, +0.0000000f, -0.0000000f, -0.0000000f, -0.0000000f, +0.0000000f, -0.0000000f
);

const float biases[4] = float[4](
  -0.0000000f, -0.0000000f, +0.0006063f, -0.0000000f
);

vec4 hook() {
    const vec4 r[9][2] = vec4[9][2](
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 1.0f)))
    );

    float sum[4] = biases;
    for (int n = 0; n < 4; n++) {
        for (int i = 0; i < 9; i++) {
            const vec4 k0 = vec4(kernels[n * 8 * 9 + 8 * i + 0], kernels[n * 8 * 9 + 8 * i + 1], kernels[n * 8 * 9 + 8 * i + 2], kernels[n * 8 * 9 + 8 * i + 3]);
            const vec4 k1 = vec4(kernels[n * 8 * 9 + 8 * i + 4], kernels[n * 8 * 9 + 8 * i + 5], kernels[n * 8 * 9 + 8 * i + 6], kernels[n * 8 * 9 + 8 * i + 7]);
            sum[n] += (dot(k0, r[i][0]) + dot(k1, r[i][1]));
        }
    }

    return ACTIVE(vec4(sum[0], sum[1], sum[2], sum[3]));
}

//!HOOK LUMA
//!DESC ACNet Layer2 L1
//!WHEN OUTPUT.w LUMA.w / 1.2 > OUTPUT.h LUMA.h / 1.2 > *
//!BIND TMP2_L0
//!BIND TMP2_L1
//!SAVE TMP1_L1
//!COMPONENTS 4

#define ACTIVE(v) (max(v, 0.0f))

#define TEX_BIND_L0_TEXOFF TMP2_L0_texOff
#define TEX_BIND_L0_TEX TMP2_L0_tex
#define TEX_BIND_L0_POS TMP2_L0_pos
#define TEX_BIND_L0_SIZE TMP2_L0_size
#define TEX_BIND_L0_PT TMP2_L0_pt

#define TEX_BIND_L1_TEXOFF TMP2_L1_texOff
#define TEX_BIND_L1_TEX TMP2_L1_tex
#define TEX_BIND_L1_POS TMP2_L1_pos
#define TEX_BIND_L1_SIZE TMP2_L1_size
#define TEX_BIND_L1_PT TMP2_L1_pt

const float kernels[288] = float[288](
  -0.2301049f, +0.1031028f, -0.0184917f, -0.0781349f, -0.1212266f, +0.0000408f, -0.0000000f, -0.0740531f,
  -0.0744452f, -0.0235201f, -0.0207107f, +0.1067163f, +0.0496405f, -0.0333283f, -0.0000000f, -0.4278457f,
  -0.1000562f, -0.0812775f, -0.0352424f, -0.0583801f, +0.0738271f, +0.0511906f, -0.0000000f, -0.4759748f,
  -0.2454303f, -0.0292667f, +0.0761625f, +0.0716184f, -0.1037671f, +0.0965377f, -0.0000000f, +0.4630946f,
  -0.0857498f, +0.1068572f, +0.0608527f, +0.0002797f, -0.0373774f, +0.0717790f, -0.0000000f, +0.0760177f,
  +0.1485932f, +0.0462869f, +0.0942484f, +0.1183531f, -0.0365357f, +0.1212077f, -0.0000000f, -0.3588516f,
  -0.1378262f, -0.0123418f, +0.0620075f, +0.1130570f, +0.0574887f, +0.1159827f, -0.0000000f, +0.3042836f,
  +0.1270940f, -0.0171042f, +0.0113733f, -0.0078578f, -0.0004628f, -0.0590551f, -0.0000000f, +0.0874486f,
  +0.2501233f, +0.0843571f, +0.0266090f, +0.0051743f, +0.0900679f, +0.0826706f, -0.0000000f, +0.0978803f,
  -0.0341912f, -0.0188651f, -0.1014333f, +0.0453831f, -0.1091932f, +0.0553514f, -0.0000000f, +0.0218375f,
  +0.1183399f, +0.0995090f, +0.0831529f, -0.0368928f, -0.1756291f, -0.0505794f, -0.0000000f, -0.0706348f,
  -0.0432731f, -0.0498808f, -0.1047787f, -0.1009634f, -0.3525515f, -0.1616776f, -0.0000000f, +0.3609514f,
  -0.6078171f, +0.0216399f, +0.1620088f, +0.2038950f, -0.1344714f, +0.2528235f, -0.0000000f, +0.5109646f,
  +0.9238740f, -0.2094102f, +0.2073982f, +0.2255714f, +0.3370887f, +0.1971533f, -0.0000000f, +0.6383839f,
  -0.1397218f, -0.1477918f, -0.1265300f, -0.1968527f, -0.1904307f, -0.2403458f, -0.0000000f, +0.5071614f,
  +0.3066522f, +0.1780838f, +0.0816539f, -0.0951984f, -0.2142154f, -0.0307995f, +0.0000000f, +0.1164248f,
  +0.4744452f, -0.1257191f, -0.0762235f, +0.2287671f, -0.2884803f, +0.1932884f, +0.0000000f, +0.1854576f,
  +0.0486834f, -0.0967564f, -0.0898644f, +0.0211351f, -0.0539213f, -0.1089340f, -0.0000000f, +0.1598890f,
  +0.1079934f, +0.0876083f, -0.0393010f, -0.0812873f, +0.1983004f, -0.1919758f, -0.0000000f, +0.1614344f,
  +0.2838026f, +0.0988280f, -0.0943247f, -0.0063940f, -0.2541901f, -0.1541928f, -0.0000000f, +0.1727130f,
  +0.1490999f, +0.0214687f, -0.0621193f, +0.0321618f, -0.0670670f, -0.0754201f, -0.0000000f, +0.4353377f,
  -0.2430523f, -0.0035384f, +0.1284174f, +0.0941162f, +0.3230308f, +0.1607013f, -0.0000000f, -0.2431203f,
  +0.2308371f, -0.1568944f, +0.0974657f, -0.0625672f, +0.1603680f, -0.0610313f, -0.0000000f, +0.4014577f,
  -0.0999817f, -0.1141066f, -0.0275018f, -0.1270404f, -0.0302000f, -0.2017884f, -0.0000000f, +0.4469305f,
  -0.4683949f, +0.0207276f, +0.1656014f, +0.0546540f, +0.1301110f, -0.0158292f, -0.0000000f, +0.1544195f,
  +0.6037641f, +0.0568144f, +0.1505780f, +0.0148853f, +0.0754546f, +0.1991834f, -0.0000000f, +0.3988515f,
  -0.0127483f, -0.0110899f, +0.0228206f, +0.0038166f, -0.0127261f, +0.1096036f, -0.0000000f, -0.1435726f,
  -0.0602356f, +0.0345278f, +0.0014974f, +0.1359479f, -0.0534764f, -0.0429380f, +0.0000000f, +0.0848478f,
  -0.1232387f, +0.1303886f, +0.1019557f, +0.0494979f, +0.0196765f, -0.0501989f, +0.0000000f, -0.1984539f,
  +0.0611970f, +0.0927363f, +0.0676320f, +0.1253515f, +0.0952144f, +0.1435661f, +0.0000000f, -0.5184444f,
  -0.0258419f, +0.0351932f, +0.0898093f, -0.0393960f, +0.0131361f, -0.0570024f, +0.0000000f, +0.3095900f,
  -0.0102657f, +0.0565826f, +0.0575681f, +0.0488587f, +0.0755596f, +0.1415768f, +0.0000000f, +0.3668164f,
  +0.0015670f, +0.0594651f, -0.0606209f, +0.0413886f, +0.0062428f, +0.0494421f, +0.0000000f, +0.0312083f,
  +0.0291028f, +0.1284641f, -0.0027582f, +0.0370259f, -0.0523777f, -0.0683825f, +0.0000000f, +0.1987105f,
  +0.0299663f, +0.0933874f, +0.0319348f, +0.1366722f, -0.0187043f, +0.1131581f, +0.0000000f, +0.2831835f,
  +0.1128602f, +0.0921311f, +0.0312988f, +0.0075657f, +0.1065664f, +0.0520706f, +0.0000000f, +0.1606648f
);

const float biases[4] = float[4](
  +0.0183307f, -0.1136440f, -0.0083962f, -0.0001737f
);

vec4 hook() {
    const vec4 r[9][2] = vec4[9][2](
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 1.0f)))
    );

    float sum[4] = biases;
    for (int n = 0; n < 4; n++) {
        for (int i = 0; i < 9; i++) {
            const vec4 k0 = vec4(kernels[n * 8 * 9 + 8 * i + 0], kernels[n * 8 * 9 + 8 * i + 1], kernels[n * 8 * 9 + 8 * i + 2], kernels[n * 8 * 9 + 8 * i + 3]);
            const vec4 k1 = vec4(kernels[n * 8 * 9 + 8 * i + 4], kernels[n * 8 * 9 + 8 * i + 5], kernels[n * 8 * 9 + 8 * i + 6], kernels[n * 8 * 9 + 8 * i + 7]);
            sum[n] += (dot(k0, r[i][0]) + dot(k1, r[i][1]));
        }
    }

    return ACTIVE(vec4(sum[0], sum[1], sum[2], sum[3]));
}

//!HOOK LUMA
//!DESC ACNet Layer3 L0
//!WHEN OUTPUT.w LUMA.w / 1.2 > OUTPUT.h LUMA.h / 1.2 > *
//!BIND TMP1_L0
//!BIND TMP1_L1
//!SAVE TMP2_L0
//!COMPONENTS 4

#define ACTIVE(v) (max(v, 0.0f))

#define TEX_BIND_L0_TEXOFF TMP1_L0_texOff
#define TEX_BIND_L0_TEX TMP1_L0_tex
#define TEX_BIND_L0_POS TMP1_L0_pos
#define TEX_BIND_L0_SIZE TMP1_L0_size
#define TEX_BIND_L0_PT TMP1_L0_pt

#define TEX_BIND_L1_TEXOFF TMP1_L1_texOff
#define TEX_BIND_L1_TEX TMP1_L1_tex
#define TEX_BIND_L1_POS TMP1_L1_pos
#define TEX_BIND_L1_SIZE TMP1_L1_size
#define TEX_BIND_L1_PT TMP1_L1_pt

const float kernels[288] = float[288](
  -0.0000000f, +0.0000000f, +0.1138900f, -0.0000000f, +0.1152405f, -0.2169146f, -0.0808610f, +0.0745699f,
  -0.0000000f, +0.0000000f, -0.0457737f, -0.0000000f, -0.0501151f, -0.0006692f, -0.0044301f, +0.0544832f,
  -0.0000000f, +0.0000000f, +0.0614229f, -0.0000000f, +0.0941866f, -0.1302616f, +0.0063144f, -0.0126386f,
  -0.0000000f, +0.0000000f, +0.1385783f, -0.0000000f, +0.0424773f, -0.1914253f, +0.0303380f, +0.1248077f,
  -0.0000000f, +0.0000000f, +0.0231021f, +0.0000000f, +0.1419700f, +0.1221135f, -0.0086463f, +0.1468336f,
  -0.0000000f, +0.0000000f, -0.0650789f, +0.0000000f, +0.0249862f, +0.1256174f, +0.0550842f, -0.0475811f,
  -0.0000000f, +0.0000000f, +0.1326907f, +0.0000000f, -0.0286881f, -0.1227311f, -0.1836962f, +0.1674822f,
  -0.0000000f, +0.0000000f, +0.0323871f, -0.0000000f, +0.0922888f, +0.0710446f, -0.0502869f, -0.0313740f,
  -0.0000000f, +0.0000000f, +0.0769658f, -0.0000000f, +0.0419653f, +0.1239592f, -0.0721942f, -0.0172714f,
  +0.0000000f, +0.0000000f, +0.1401542f, -0.0000000f, -0.0143477f, -0.0580574f, -0.0461121f, +0.0552899f,
  -0.0000000f, +0.0000000f, +0.1048581f, -0.0000000f, +0.0641281f, +0.1307974f, +0.0301021f, -0.0666319f,
  -0.0000000f, +0.0000000f, +0.1231983f, +0.0000000f, +0.0610816f, +0.1089545f, +0.0624601f, +0.0422675f,
  -0.0000000f, +0.0000000f, +0.0465454f, +0.0000000f, -0.0111122f, -0.1643621f, -0.0255101f, -0.0276652f,
  -0.0000000f, +0.0000000f, +0.1206788f, +0.0000000f, +0.0859931f, +0.0098593f, +0.0204368f, +0.0934150f,
  -0.0000000f, +0.0000000f, +0.0925306f, -0.0000000f, +0.0248347f, +0.0155855f, -0.0568162f, +0.0510261f,
  -0.0000000f, +0.0000000f, +0.1071747f, +0.0000000f, +0.1279442f, -0.1533624f, -0.1030808f, +0.1565185f,
  -0.0000000f, +0.0000000f, +0.0387375f, -0.0000000f, -0.0910717f, +0.0363914f, -0.1528388f, +0.1083493f,
  -0.0000000f, +0.0000000f, +0.1018075f, +0.0000000f, -0.0134873f, +0.1453926f, -0.0710364f, +0.0961314f,
  -0.0000000f, -0.0000000f, +0.0063645f, +0.0000000f, -0.0152541f, -0.1445707f, -0.0605689f, +0.0280349f,
  -0.0000000f, -0.0000000f, -0.0053080f, -0.0000000f, +0.0983227f, +0.0927612f, -0.0543480f, -0.0581340f,
  -0.0000000f, -0.0000000f, -0.0517586f, -0.0000000f, +0.0455038f, +0.0452192f, -0.0767192f, -0.0438796f,
  +0.0000000f, -0.0000000f, +0.1066479f, -0.0000000f, +0.1385534f, -0.3036081f, -0.0650599f, -0.0163753f,
  +0.0000000f, -0.0000000f, -0.0631260f, -0.0000000f, +0.0693003f, +0.3467287f, +0.2890217f, +0.0981954f,
  -0.0000000f, -0.0000000f, +0.0509178f, -0.0000000f, +0.1913488f, -0.2310989f, +0.0807318f, -0.0740106f,
  +0.0000000f, -0.0000000f, +0.0721933f, +0.0000000f, -0.0523209f, +0.2101730f, -0.3342479f, -0.0595233f,
  +0.0000000f, -0.0000000f, -0.0688355f, +0.0000000f, -0.0060227f, +0.2498338f, -0.3136086f, +0.1023419f,
  +0.0000000f, -0.0000000f, -0.0656571f, -0.0000000f, -0.0001173f, +0.3165883f, -0.2718327f, -0.0533573f,
  +0.0000000f, -0.0000000f, +0.0889194f, -0.0000000f, +0.0962876f, -0.0825307f, +0.0262336f, +0.1193628f,
  -0.0000000f, -0.0000000f, -0.0034541f, -0.0000000f, +0.0097568f, +0.0700892f, +0.0968676f, -0.0223015f,
  -0.0000000f, -0.0000000f, -0.0496190f, +0.0000000f, -0.0581783f, +0.1082098f, +0.0924319f, +0.1136254f,
  +0.0000000f, -0.0000000f, +0.1099694f, -0.0000000f, +0.0233133f, -0.1101591f, +0.0498807f, +0.1398105f,
  -0.0000000f, -0.0000000f, +0.1025749f, +0.0000000f, +0.1172482f, +0.1897653f, +0.0591215f, +0.0677336f,
  -0.0000000f, -0.0000000f, +0.0699495f, -0.0000000f, +0.1029076f, +0.2557611f, -0.0104767f, -0.0827752f,
  -0.0000000f, -0.0000000f, +0.0926238f, -0.0000000f, -0.1011117f, -0.1022100f, -0.1469255f, +0.1040378f,
  -0.0000000f, -0.0000000f, +0.0327119f, -0.0000000f, +0.0837060f, +0.0592359f, -0.1002952f, -0.0077360f,
  -0.0000000f, -0.0000000f, +0.0879157f, +0.0000000f, +0.0096575f, +0.0616778f, -0.1060815f, +0.0425226f
);

const float biases[4] = float[4](
  -0.0090767f, -0.0054583f, +0.0236801f, +0.0093496f
);

vec4 hook() {
    const vec4 r[9][2] = vec4[9][2](
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 1.0f)))
    );

    float sum[4] = biases;
    for (int n = 0; n < 4; n++) {
        for (int i = 0; i < 9; i++) {
            const vec4 k0 = vec4(kernels[n * 8 * 9 + 8 * i + 0], kernels[n * 8 * 9 + 8 * i + 1], kernels[n * 8 * 9 + 8 * i + 2], kernels[n * 8 * 9 + 8 * i + 3]);
            const vec4 k1 = vec4(kernels[n * 8 * 9 + 8 * i + 4], kernels[n * 8 * 9 + 8 * i + 5], kernels[n * 8 * 9 + 8 * i + 6], kernels[n * 8 * 9 + 8 * i + 7]);
            sum[n] += (dot(k0, r[i][0]) + dot(k1, r[i][1]));
        }
    }

    return ACTIVE(vec4(sum[0], sum[1], sum[2], sum[3]));
}

//!HOOK LUMA
//!DESC ACNet Layer3 L1
//!WHEN OUTPUT.w LUMA.w / 1.2 > OUTPUT.h LUMA.h / 1.2 > *
//!BIND TMP1_L0
//!BIND TMP1_L1
//!SAVE TMP2_L1
//!COMPONENTS 4

#define ACTIVE(v) (max(v, 0.0f))

#define TEX_BIND_L0_TEXOFF TMP1_L0_texOff
#define TEX_BIND_L0_TEX TMP1_L0_tex
#define TEX_BIND_L0_POS TMP1_L0_pos
#define TEX_BIND_L0_SIZE TMP1_L0_size
#define TEX_BIND_L0_PT TMP1_L0_pt

#define TEX_BIND_L1_TEXOFF TMP1_L1_texOff
#define TEX_BIND_L1_TEX TMP1_L1_tex
#define TEX_BIND_L1_POS TMP1_L1_pos
#define TEX_BIND_L1_SIZE TMP1_L1_size
#define TEX_BIND_L1_PT TMP1_L1_pt

const float kernels[288] = float[288](
  -0.0000000f, +0.0000000f, +0.0478721f, -0.0000000f, -0.0010893f, -0.2418748f, +0.1455596f, -0.0933158f,
  +0.0000000f, +0.0000000f, -0.0258568f, -0.0000000f, -0.0827076f, -0.3839685f, -0.5105970f, -0.0041307f,
  -0.0000000f, +0.0000000f, +0.0488097f, +0.0000000f, -0.1792533f, +0.1373012f, +0.2155643f, +0.0786125f,
  -0.0000000f, +0.0000000f, +0.1038914f, -0.0000000f, +0.0834609f, +0.1921696f, +0.3571878f, -0.0215263f,
  -0.0000000f, +0.0000000f, -0.1078181f, +0.0000000f, +0.0313393f, +0.1410067f, +0.2728210f, -0.0671408f,
  -0.0000000f, +0.0000000f, +0.0413649f, +0.0000000f, +0.0880959f, +0.4979501f, -0.1901459f, +0.0255132f,
  +0.0000000f, +0.0000000f, +0.0957781f, -0.0000000f, +0.0731394f, -0.1144100f, -0.1094076f, -0.0339419f,
  -0.0000000f, +0.0000000f, -0.0523415f, +0.0000000f, -0.1221190f, +0.3334320f, +0.0276339f, -0.0862819f,
  -0.0000000f, +0.0000000f, +0.0459469f, +0.0000000f, +0.0104892f, +0.0791936f, +0.1183350f, +0.0304455f,
  -0.0000000f, -0.0000000f, -0.3247412f, +0.0000000f, -0.0999856f, +0.4503208f, -0.5148549f, -0.2447110f,
  -0.0000000f, +0.0000000f, +0.0110517f, +0.0000000f, +0.0707274f, +0.4472952f, +0.1237202f, +0.0555541f,
  +0.0000000f, +0.0000000f, +0.0471966f, -0.0000000f, +0.0850234f, +0.1344604f, +0.0543795f, +0.0892839f,
  -0.0000000f, +0.0000000f, -0.1465820f, -0.0000000f, +0.0225006f, -0.1337356f, -0.2966537f, -0.1687008f,
  -0.0000000f, +0.0000000f, +0.1672834f, -0.0000000f, +0.1434310f, +0.0885539f, -0.0331565f, +0.0761558f,
  -0.0000000f, +0.0000000f, +0.0521904f, +0.0000000f, +0.1187798f, +0.3560996f, -0.1868847f, +0.1247197f,
  -0.0000000f, +0.0000000f, +0.0431743f, -0.0000000f, +0.0281262f, +0.3058358f, +0.0517770f, -0.1563325f,
  -0.0000000f, +0.0000000f, +0.0458644f, +0.0000000f, +0.0732395f, +0.2353577f, -0.1431499f, +0.0043184f,
  -0.0000000f, +0.0000000f, +0.0544720f, +0.0000000f, +0.0104682f, +0.1616075f, -0.1136646f, +0.1107780f,
  +0.0000000f, -0.0000000f, -0.0148943f, +0.0000000f, +0.0163992f, +0.0105488f, -0.0338968f, -0.0746526f,
  -0.0000000f, -0.0000000f, +0.0024801f, +0.0000000f, -0.0828278f, -0.0864681f, +0.1330681f, -0.0641688f,
  +0.0000000f, -0.0000000f, -0.0469962f, +0.0000000f, -0.0583611f, -0.1853546f, +0.0074482f, -0.0295259f,
  +0.0000000f, -0.0000000f, +0.0006745f, +0.0000000f, +0.0213152f, -0.1361593f, +0.4812013f, -0.0363364f,
  -0.0000000f, -0.0000000f, +0.0187988f, -0.0000000f, +0.0119679f, +0.2737070f, +0.7705348f, +0.0723622f,
  -0.0000000f, -0.0000000f, +0.0298891f, +0.0000000f, +0.0687274f, +0.1115723f, +0.5335414f, -0.0353316f,
  +0.0000000f, -0.0000000f, +0.0072700f, -0.0000000f, +0.0385582f, -0.1709708f, -0.2427651f, +0.0626276f,
  -0.0000000f, -0.0000000f, +0.1238490f, -0.0000000f, +0.0154506f, +0.1365940f, -0.0591358f, +0.0622778f,
  -0.0000000f, -0.0000000f, +0.0925222f, +0.0000000f, +0.0005447f, +0.0228308f, -0.1341875f, +0.0356386f,
  +0.0000000f, +0.0000000f, +0.0628670f, -0.0000000f, +0.0110002f, -0.3390113f, +0.2354797f, +0.0286214f,
  -0.0000000f, +0.0000000f, -0.1272671f, +0.0000000f, -0.0037088f, -0.1123094f, -0.0680442f, +0.0062698f,
  -0.0000000f, +0.0000000f, -0.0653069f, +0.0000000f, -0.0800422f, -0.0864761f, +0.0942958f, -0.1474560f,
  +0.0000000f, -0.0000000f, +0.1141466f, -0.0000000f, +0.0976027f, +0.1114707f, +0.4480273f, +0.0948194f,
  -0.0000000f, +0.0000000f, -0.0455292f, -0.0000000f, +0.0865808f, +0.4958693f, +0.0061517f, -0.0131094f,
  +0.0000000f, +0.0000000f, -0.1135840f, -0.0000000f, -0.0018921f, -0.1703856f, -0.0551919f, +0.0355402f,
  +0.0000000f, -0.0000000f, +0.0434266f, +0.0000000f, +0.2281989f, -0.2070152f, -0.2730371f, +0.0440465f,
  -0.0000000f, +0.0000000f, -0.0609940f, -0.0000000f, +0.0680725f, +0.0587300f, -0.0260034f, +0.0350655f,
  +0.0000000f, +0.0000000f, -0.0778078f, +0.0000000f, -0.0810813f, -0.1347488f, +0.4071281f, -0.0095886f
);

const float biases[4] = float[4](
  -0.0479350f, +0.0187788f, -0.0034033f, +0.0399154f
);

vec4 hook() {
    const vec4 r[9][2] = vec4[9][2](
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 1.0f)))
    );

    float sum[4] = biases;
    for (int n = 0; n < 4; n++) {
        for (int i = 0; i < 9; i++) {
            const vec4 k0 = vec4(kernels[n * 8 * 9 + 8 * i + 0], kernels[n * 8 * 9 + 8 * i + 1], kernels[n * 8 * 9 + 8 * i + 2], kernels[n * 8 * 9 + 8 * i + 3]);
            const vec4 k1 = vec4(kernels[n * 8 * 9 + 8 * i + 4], kernels[n * 8 * 9 + 8 * i + 5], kernels[n * 8 * 9 + 8 * i + 6], kernels[n * 8 * 9 + 8 * i + 7]);
            sum[n] += (dot(k0, r[i][0]) + dot(k1, r[i][1]));
        }
    }

    return ACTIVE(vec4(sum[0], sum[1], sum[2], sum[3]));
}

//!HOOK LUMA
//!DESC ACNet Layer4 L0
//!WHEN OUTPUT.w LUMA.w / 1.2 > OUTPUT.h LUMA.h / 1.2 > *
//!BIND TMP2_L0
//!BIND TMP2_L1
//!SAVE TMP1_L0
//!COMPONENTS 4

#define ACTIVE(v) (max(v, 0.0f))

#define TEX_BIND_L0_TEXOFF TMP2_L0_texOff
#define TEX_BIND_L0_TEX TMP2_L0_tex
#define TEX_BIND_L0_POS TMP2_L0_pos
#define TEX_BIND_L0_SIZE TMP2_L0_size
#define TEX_BIND_L0_PT TMP2_L0_pt

#define TEX_BIND_L1_TEXOFF TMP2_L1_texOff
#define TEX_BIND_L1_TEX TMP2_L1_tex
#define TEX_BIND_L1_POS TMP2_L1_pos
#define TEX_BIND_L1_SIZE TMP2_L1_size
#define TEX_BIND_L1_PT TMP2_L1_pt

const float kernels[288] = float[288](
  -0.0067011f, -0.0758173f, +0.0604503f, -0.1073341f, -0.1666677f, -0.0215337f, +0.0361639f, +0.1024307f,
  +0.1739843f, +0.1559850f, +0.4465598f, +0.0372280f, +0.0760910f, +0.1391506f, +0.2866381f, -0.1315928f,
  +0.1476724f, +0.1232881f, +0.3895442f, +0.0971574f, +0.1706410f, -0.2819917f, +0.2342573f, -0.1784360f,
  -0.0198824f, +0.0034126f, -0.2120735f, -0.0075810f, +0.2532169f, -0.0029683f, -0.1252469f, -0.0603587f,
  +0.1928629f, -0.0948842f, -0.0106001f, +0.0556054f, -0.0094636f, +0.0144449f, -0.1719525f, +0.1912501f,
  +0.0486261f, -0.0422755f, -0.5635065f, -0.0918977f, -0.2789893f, -0.1555234f, -0.0522699f, +0.3355255f,
  +0.1146512f, +0.0391099f, +0.1807391f, -0.1499165f, +0.0420131f, +0.0347589f, +0.0387825f, -0.1087556f,
  -0.0440174f, -0.1347704f, +0.0307968f, -0.0532056f, +0.1569292f, -0.2032118f, +0.0577342f, -0.1214939f,
  -0.1928795f, -0.0449514f, -0.4038002f, -0.1966673f, +0.3112439f, -0.1115533f, +0.2194529f, -0.5718549f,
  -0.0205831f, +0.0011415f, -0.1304260f, -0.0410303f, -0.1281376f, -0.0346809f, -0.2142387f, +0.0727157f,
  -0.0048168f, -0.0345182f, -0.3034272f, -0.0819771f, +0.0739675f, -0.0135944f, -0.1648898f, -0.0706772f,
  -0.0719081f, -0.0900583f, -0.2079927f, -0.0307763f, -0.0033742f, +0.1669998f, -0.0432480f, -0.1774034f,
  -0.0234276f, +0.0073207f, -0.0462612f, -0.0306846f, -0.1523931f, -0.0773656f, +0.1598740f, -0.0623571f,
  +0.0299021f, +0.0609610f, -0.0176501f, +0.0082163f, +0.0089941f, +0.0085138f, +0.4623456f, +0.1193228f,
  +0.0108880f, +0.0756295f, -0.0721605f, +0.0403571f, +0.1787713f, -0.0431588f, +0.2628705f, +0.1573314f,
  +0.0363833f, -0.0459688f, -0.0262910f, -0.0696335f, +0.2121908f, +0.0405966f, -0.0122698f, -0.1027514f,
  +0.1005152f, +0.0243141f, +0.1570678f, +0.0606900f, -0.5205663f, +0.0009725f, +0.1316482f, +0.1496577f,
  +0.0289718f, +0.0676577f, +0.0950211f, +0.0154175f, -0.2228425f, -0.3432600f, +0.0532168f, +0.0481248f,
  -0.0471500f, -0.0495306f, +0.0803903f, -0.0740867f, +0.0698436f, +0.0492142f, +0.0760634f, -0.0977174f,
  +0.1551579f, +0.1151893f, -0.0410280f, +0.0885315f, -0.0464669f, +0.0315279f, +0.1415853f, +0.0482392f,
  +0.0696148f, +0.0989144f, +0.0037415f, -0.0496968f, -0.0916989f, +0.0333020f, +0.0414086f, +0.0533744f,
  +0.0612523f, +0.1345520f, -0.1031706f, +0.0461345f, +0.0557041f, +0.0312134f, +0.0808118f, -0.1182719f,
  +0.0538587f, +0.1317671f, +0.1027949f, +0.1429970f, -0.0303124f, +0.0988804f, +0.0975688f, +0.1000840f,
  +0.1705177f, -0.0027938f, -0.0065789f, +0.1172022f, -0.0078252f, -0.1109832f, +0.0415321f, +0.0863683f,
  +0.0319405f, +0.1189462f, -0.0233387f, +0.0038271f, -0.0437985f, +0.0450922f, -0.1113645f, -0.0625725f,
  +0.1184233f, +0.1137667f, +0.0727412f, +0.1710804f, -0.1662328f, -0.0016922f, -0.0436856f, +0.0364843f,
  +0.0422648f, +0.0610351f, +0.0416624f, -0.0247788f, -0.0230063f, -0.0513802f, -0.1414381f, -0.0633609f,
  +0.0041008f, -0.0242113f, -0.0156293f, -0.0492740f, +0.1253044f, +0.1331428f, -0.0387065f, +0.1791857f,
  +0.0167086f, +0.0040065f, -0.0943470f, -0.0069233f, -0.0323977f, +0.0506456f, -0.0220820f, +0.0636025f,
  +0.0405531f, -0.0019540f, +0.0727987f, +0.0105780f, -0.0656899f, -0.0348437f, +0.0027591f, -0.0555155f,
  +0.0227658f, -0.0095697f, +0.2311516f, -0.0432908f, -0.2580481f, -0.1255905f, -0.0823530f, +0.1011610f,
  +0.0272410f, +0.0305032f, +0.0734492f, -0.0078361f, +0.0360787f, -0.1177355f, -0.0319415f, +0.0873703f,
  +0.0517855f, +0.0358094f, +0.0693536f, +0.0166465f, +0.0353905f, +0.1289781f, -0.1193720f, -0.0866238f,
  +0.0136073f, -0.0434563f, +0.1601430f, -0.0561685f, -0.1723625f, -0.0774016f, +0.0297466f, -0.0843138f,
  +0.0546383f, +0.0289585f, +0.1887814f, +0.0103168f, +0.0066798f, -0.0107029f, +0.2004077f, +0.0359972f,
  +0.0694389f, +0.0428978f, -0.0221485f, +0.0311702f, +0.0489238f, -0.2635883f, -0.0519839f, +0.2116052f
);

const float biases[4] = float[4](
  +0.0065694f, -0.2225939f, -0.0112261f, -0.0803273f
);

vec4 hook() {
    const vec4 r[9][2] = vec4[9][2](
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 1.0f)))
    );

    float sum[4] = biases;
    for (int n = 0; n < 4; n++) {
        for (int i = 0; i < 9; i++) {
            const vec4 k0 = vec4(kernels[n * 8 * 9 + 8 * i + 0], kernels[n * 8 * 9 + 8 * i + 1], kernels[n * 8 * 9 + 8 * i + 2], kernels[n * 8 * 9 + 8 * i + 3]);
            const vec4 k1 = vec4(kernels[n * 8 * 9 + 8 * i + 4], kernels[n * 8 * 9 + 8 * i + 5], kernels[n * 8 * 9 + 8 * i + 6], kernels[n * 8 * 9 + 8 * i + 7]);
            sum[n] += (dot(k0, r[i][0]) + dot(k1, r[i][1]));
        }
    }

    return ACTIVE(vec4(sum[0], sum[1], sum[2], sum[3]));
}

//!HOOK LUMA
//!DESC ACNet Layer4 L1
//!WHEN OUTPUT.w LUMA.w / 1.2 > OUTPUT.h LUMA.h / 1.2 > *
//!BIND TMP2_L0
//!BIND TMP2_L1
//!SAVE TMP1_L1
//!COMPONENTS 4

#define ACTIVE(v) (max(v, 0.0f))

#define TEX_BIND_L0_TEXOFF TMP2_L0_texOff
#define TEX_BIND_L0_TEX TMP2_L0_tex
#define TEX_BIND_L0_POS TMP2_L0_pos
#define TEX_BIND_L0_SIZE TMP2_L0_size
#define TEX_BIND_L0_PT TMP2_L0_pt

#define TEX_BIND_L1_TEXOFF TMP2_L1_texOff
#define TEX_BIND_L1_TEX TMP2_L1_tex
#define TEX_BIND_L1_POS TMP2_L1_pos
#define TEX_BIND_L1_SIZE TMP2_L1_size
#define TEX_BIND_L1_PT TMP2_L1_pt

const float kernels[288] = float[288](
  +0.0000000f, -0.0000000f, +0.0000000f, +0.0000000f, -0.0000000f, +0.0000000f, +0.0000000f, -0.0000000f,
  +0.0000000f, -0.0000000f, +0.0000000f, +0.0000000f, -0.0000000f, +0.0000000f, +0.0000000f, -0.0000000f,
  +0.0000000f, -0.0000000f, +0.0000000f, +0.0000000f, -0.0000000f, -0.0000000f, +0.0000000f, -0.0000000f,
  +0.0000000f, -0.0000000f, +0.0000000f, +0.0000000f, -0.0000000f, +0.0000000f, +0.0000000f, -0.0000000f,
  +0.0000000f, -0.0000000f, +0.0000000f, +0.0000000f, -0.0000000f, +0.0000000f, +0.0000000f, -0.0000000f,
  +0.0000000f, -0.0000000f, +0.0000000f, +0.0000000f, -0.0000000f, -0.0000000f, +0.0000000f, -0.0000000f,
  +0.0000000f, -0.0000000f, +0.0000000f, +0.0000000f, -0.0000000f, +0.0000000f, +0.0000000f, -0.0000000f,
  +0.0000000f, -0.0000000f, +0.0000000f, +0.0000000f, -0.0000000f, -0.0000000f, +0.0000000f, -0.0000000f,
  +0.0000000f, -0.0000000f, +0.0000000f, +0.0000000f, -0.0000000f, -0.0000000f, +0.0000000f, -0.0000000f,
  +0.0464601f, +0.1214472f, -0.0336046f, +0.0251489f, +0.1065243f, +0.0479861f, +0.0679407f, -0.0869538f,
  +0.1167569f, -0.0719952f, +0.0617508f, +0.0719901f, -0.0660347f, +0.0171050f, +0.1735247f, +0.0099646f,
  -0.0598461f, -0.0136149f, -0.0430044f, +0.0815341f, +0.0857536f, -0.0577114f, +0.0494985f, +0.0800504f,
  +0.0086467f, +0.0978768f, -0.0510397f, +0.0631330f, +0.3291914f, -0.0042066f, +0.0620127f, -0.0441569f,
  -0.0112866f, +0.0660611f, -0.0387981f, +0.0586433f, -0.0159584f, +0.0656676f, +0.0961797f, -0.0063008f,
  +0.0701291f, +0.0102724f, -0.0717358f, +0.0467559f, +0.0021694f, -0.1661706f, -0.0029861f, +0.0406448f,
  -0.1127735f, +0.1139064f, -0.0101793f, -0.0053580f, -0.0909428f, +0.0100569f, -0.0124823f, -0.0796241f,
  +0.0103212f, +0.0569738f, +0.0859643f, +0.0344110f, -0.0219199f, -0.0020108f, +0.0095709f, +0.1085579f,
  -0.0195673f, +0.0974725f, -0.0008144f, +0.0052957f, +0.0297061f, -0.1549940f, -0.0879131f, -0.0004534f,
  +0.0710852f, +0.0059774f, -0.3864426f, +0.0888367f, +0.1567492f, +0.1635677f, -0.0589707f, -0.1362363f,
  +0.0570023f, +0.0054993f, +0.2456290f, +0.0574597f, +0.1080828f, +0.0682726f, +0.2577548f, -0.0530262f,
  +0.0116732f, +0.0243063f, +0.1243559f, -0.0309603f, +0.1102376f, -0.1205114f, +0.0901693f, +0.0031038f,
  -0.0513781f, -0.0059813f, -0.3298553f, -0.0012598f, +0.5446835f, +0.0495106f, -0.3046115f, -0.5621129f,
  -0.0023945f, +0.0449990f, -0.1104430f, +0.0391238f, -0.5926780f, +0.4733351f, -0.0323526f, -0.2837485f,
  -0.0595320f, +0.0747442f, +0.2075275f, -0.0533224f, +0.1008800f, -0.0488758f, -0.2029320f, -0.1252420f,
  +0.0349980f, -0.0307733f, -0.1362094f, -0.0442273f, +0.0823596f, -0.1313012f, +0.0138975f, -0.2381270f,
  -0.0360193f, -0.0368355f, -0.1354358f, -0.0380004f, +0.1964632f, -0.0051568f, +0.1424897f, -0.0224385f,
  +0.0104279f, +0.0005840f, +0.0588817f, -0.0326773f, +0.0064799f, +0.1008792f, -0.0586606f, -0.0440823f,
  +0.0990656f, +0.0658654f, +0.0557412f, -0.0014001f, +0.0445576f, +0.0135918f, +0.0124107f, -0.0896227f,
  -0.0717350f, -0.0806973f, +0.0509172f, -0.0949797f, -0.0525621f, -0.0393463f, +0.0418558f, +0.0452921f,
  +0.0223447f, -0.0684750f, +0.1020898f, -0.0777468f, +0.0406525f, +0.1000336f, -0.0288917f, -0.1663456f,
  -0.0147909f, -0.0768447f, -0.0967295f, +0.0943348f, +0.1805817f, +0.1809051f, +0.0328840f, -0.0318948f,
  +0.1322539f, +0.1156821f, +0.0788763f, +0.1160514f, -0.1076326f, +0.0072687f, +0.0690723f, +0.1428389f,
  +0.0894596f, +0.0037443f, -0.0495505f, +0.0957147f, +0.0489273f, -0.0372410f, -0.0593630f, +0.2075209f,
  -0.0489856f, +0.1044803f, -0.0389265f, +0.0179512f, -0.0052569f, +0.0604381f, -0.1711224f, +0.0233830f,
  -0.0322956f, -0.0033206f, +0.0711630f, +0.0043177f, -0.1343687f, +0.0578722f, -0.0997337f, -0.0134904f,
  -0.0474742f, +0.0545229f, +0.0894360f, -0.0569366f, +0.0285784f, +0.0737777f, -0.0734170f, +0.0051593f
);

const float biases[4] = float[4](
  -0.0000000f, +0.0104020f, +0.0076246f, -0.0659398f
);

vec4 hook() {
    const vec4 r[9][2] = vec4[9][2](
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 1.0f)))
    );

    float sum[4] = biases;
    for (int n = 0; n < 4; n++) {
        for (int i = 0; i < 9; i++) {
            const vec4 k0 = vec4(kernels[n * 8 * 9 + 8 * i + 0], kernels[n * 8 * 9 + 8 * i + 1], kernels[n * 8 * 9 + 8 * i + 2], kernels[n * 8 * 9 + 8 * i + 3]);
            const vec4 k1 = vec4(kernels[n * 8 * 9 + 8 * i + 4], kernels[n * 8 * 9 + 8 * i + 5], kernels[n * 8 * 9 + 8 * i + 6], kernels[n * 8 * 9 + 8 * i + 7]);
            sum[n] += (dot(k0, r[i][0]) + dot(k1, r[i][1]));
        }
    }

    return ACTIVE(vec4(sum[0], sum[1], sum[2], sum[3]));
}

//!HOOK LUMA
//!DESC ACNet Layer5 L0
//!WHEN OUTPUT.w LUMA.w / 1.2 > OUTPUT.h LUMA.h / 1.2 > *
//!BIND TMP1_L0
//!BIND TMP1_L1
//!SAVE TMP2_L0
//!COMPONENTS 4

#define ACTIVE(v) (max(v, 0.0f))

#define TEX_BIND_L0_TEXOFF TMP1_L0_texOff
#define TEX_BIND_L0_TEX TMP1_L0_tex
#define TEX_BIND_L0_POS TMP1_L0_pos
#define TEX_BIND_L0_SIZE TMP1_L0_size
#define TEX_BIND_L0_PT TMP1_L0_pt

#define TEX_BIND_L1_TEXOFF TMP1_L1_texOff
#define TEX_BIND_L1_TEX TMP1_L1_tex
#define TEX_BIND_L1_POS TMP1_L1_pos
#define TEX_BIND_L1_SIZE TMP1_L1_size
#define TEX_BIND_L1_PT TMP1_L1_pt

const float kernels[288] = float[288](
  +0.5870835f, +0.0757412f, -0.0995116f, +0.0596863f, -0.0000000f, -0.0716541f, -0.0188403f, +0.1461405f,
  +0.2602575f, -0.3796987f, -0.0915236f, +0.2893060f, -0.0000000f, +0.0079691f, +0.1668978f, -0.1176659f,
  +0.0883788f, +0.1600064f, -0.0979837f, -0.0171307f, -0.0000000f, -0.1021931f, +0.3805008f, -0.0391548f,
  +0.3181842f, +0.1073938f, +0.0563329f, +0.1639146f, -0.0000000f, -0.0556843f, +0.0627793f, +0.1296336f,
  +0.0070055f, +0.3173491f, -0.1592754f, +0.3374780f, -0.0000000f, -0.1306525f, -0.1212368f, -0.0467526f,
  +0.1165171f, +0.2006143f, +0.0011998f, +0.1229559f, -0.0000000f, -0.0191056f, +0.5030407f, +0.1384765f,
  +0.1171881f, +0.0867192f, +0.0274881f, +0.0892422f, -0.0000000f, +0.1056077f, +0.0218703f, -0.0822921f,
  +0.0877107f, +0.0851109f, +0.0281676f, +0.1476118f, -0.0000000f, +0.0590536f, +0.1763097f, +0.2190780f,
  -0.0116866f, -0.0393538f, +0.1376773f, +0.1718677f, -0.0000000f, -0.0212786f, +0.1485827f, +0.0627936f,
  -0.3262527f, +0.0974351f, +0.0068740f, -0.0402650f, +0.0000000f, +0.1109165f, -0.0586035f, +0.0338192f,
  -0.0088528f, +0.1591104f, +0.1326126f, -0.0306451f, +0.0000000f, -0.0447842f, +0.0293230f, +0.1003970f,
  -0.0065603f, +0.0672848f, -0.0385634f, -0.0520589f, +0.0000000f, +0.0912922f, -0.2422960f, +0.0826003f,
  +0.0542445f, +0.0395699f, +0.0887580f, -0.0461959f, +0.0000000f, +0.0929003f, -0.0949209f, -0.0876036f,
  +0.2798290f, +0.1933286f, -0.0422255f, -0.0248683f, +0.0000000f, +0.1245947f, +0.1910336f, +0.0706410f,
  +0.2160833f, -0.0155308f, +0.0470420f, -0.0332572f, +0.0000000f, -0.0714469f, +0.1166998f, -0.1013209f,
  +0.0858896f, -0.2347492f, +0.0562843f, -0.0372083f, +0.0000000f, +0.0261585f, +0.0120217f, -0.0993708f,
  +0.1095462f, -0.0250065f, -0.0283031f, -0.0024100f, +0.0000000f, -0.0502185f, +0.0628298f, +0.0893632f,
  -0.1160564f, +0.0281060f, +0.0034532f, -0.0007196f, +0.0000000f, -0.0561360f, +0.3039280f, -0.1070335f,
  +0.4460323f, +0.0634807f, -0.0829925f, +0.1644562f, -0.0000000f, +0.0465065f, +0.0994613f, +0.0315034f,
  +0.0079636f, -0.1495767f, -0.0703223f, -0.0118975f, -0.0000000f, -0.0459240f, +0.1960709f, -0.3000414f,
  +0.1883418f, +0.0115535f, -0.1007755f, -0.0833869f, -0.0000000f, -0.0738377f, +0.1489590f, -0.0691140f,
  +0.1185927f, +0.0526680f, -0.0145160f, +0.0713395f, -0.0000000f, -0.0330117f, -0.0111912f, +0.2070491f,
  +0.4076002f, +0.3437945f, -0.0165583f, +0.1625384f, -0.0000000f, +0.0512949f, +0.1835236f, -0.0209784f,
  +0.0968410f, +0.0083536f, +0.0668061f, +0.1696314f, -0.0000000f, -0.0748841f, +0.2677839f, +0.1515423f,
  -0.1173451f, -0.0554033f, -0.0006745f, +0.0126296f, -0.0000000f, +0.0753889f, +0.0809766f, +0.0630327f,
  +0.2399280f, +0.1165535f, -0.0575248f, +0.0579330f, -0.0000000f, +0.1200160f, +0.1088535f, -0.1572141f,
  -0.0779160f, -0.0750222f, +0.1577229f, +0.0846864f, -0.0000000f, +0.0039442f, +0.2533137f, +0.0510673f,
  -0.0112199f, +0.0398074f, +0.0549064f, +0.0478332f, -0.0000000f, -0.0168389f, +0.0001822f, +0.1099548f,
  +0.1531532f, -0.1708827f, -0.1050691f, -0.2619127f, -0.0000000f, -0.0944214f, +0.0033984f, +0.0435813f,
  +0.0045277f, -0.1241449f, -0.0800692f, +0.0334834f, -0.0000000f, -0.0301474f, +0.0519654f, -0.0393966f,
  +0.3324977f, +0.2156430f, -0.0045729f, +0.0616534f, -0.0000000f, -0.0659745f, -0.0735115f, -0.0144764f,
  +0.1420689f, -0.2916031f, -0.0206206f, +0.0071940f, -0.0000000f, -0.0167161f, -0.0056604f, -0.0230873f,
  +0.1346869f, -0.1879556f, +0.0500885f, -0.1357795f, -0.0000000f, +0.0506718f, -0.1163011f, +0.0026423f,
  +0.5299624f, +0.0154817f, +0.0254795f, +0.1766153f, -0.0000000f, -0.0798407f, -0.1076712f, +0.0120473f,
  -0.2580293f, +0.2700484f, +0.0959240f, -0.0281945f, -0.0000000f, -0.0047086f, +0.0322606f, +0.1208422f,
  -0.0455254f, +0.0824456f, +0.0838130f, -0.0275087f, -0.0000000f, +0.0500157f, -0.2004409f, +0.1856253f
);

const float biases[4] = float[4](
  +0.0507112f, +0.0719105f, +0.0252931f, -0.0156080f
);

vec4 hook() {
    const vec4 r[9][2] = vec4[9][2](
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 1.0f)))
    );

    float sum[4] = biases;
    for (int n = 0; n < 4; n++) {
        for (int i = 0; i < 9; i++) {
            const vec4 k0 = vec4(kernels[n * 8 * 9 + 8 * i + 0], kernels[n * 8 * 9 + 8 * i + 1], kernels[n * 8 * 9 + 8 * i + 2], kernels[n * 8 * 9 + 8 * i + 3]);
            const vec4 k1 = vec4(kernels[n * 8 * 9 + 8 * i + 4], kernels[n * 8 * 9 + 8 * i + 5], kernels[n * 8 * 9 + 8 * i + 6], kernels[n * 8 * 9 + 8 * i + 7]);
            sum[n] += (dot(k0, r[i][0]) + dot(k1, r[i][1]));
        }
    }

    return ACTIVE(vec4(sum[0], sum[1], sum[2], sum[3]));
}

//!HOOK LUMA
//!DESC ACNet Layer5 L1
//!WHEN OUTPUT.w LUMA.w / 1.2 > OUTPUT.h LUMA.h / 1.2 > *
//!BIND TMP1_L0
//!BIND TMP1_L1
//!SAVE TMP2_L1
//!COMPONENTS 4

#define ACTIVE(v) (max(v, 0.0f))

#define TEX_BIND_L0_TEXOFF TMP1_L0_texOff
#define TEX_BIND_L0_TEX TMP1_L0_tex
#define TEX_BIND_L0_POS TMP1_L0_pos
#define TEX_BIND_L0_SIZE TMP1_L0_size
#define TEX_BIND_L0_PT TMP1_L0_pt

#define TEX_BIND_L1_TEXOFF TMP1_L1_texOff
#define TEX_BIND_L1_TEX TMP1_L1_tex
#define TEX_BIND_L1_POS TMP1_L1_pos
#define TEX_BIND_L1_SIZE TMP1_L1_size
#define TEX_BIND_L1_PT TMP1_L1_pt

const float kernels[288] = float[288](
  -0.2849748f, +0.0285747f, +0.0949876f, +0.0074352f, +0.0000000f, -0.0709094f, +0.0571729f, +0.0858695f,
  -0.2535293f, +0.1635149f, +0.0254177f, +0.0024917f, +0.0000000f, +0.1112668f, +0.0875136f, -0.0137232f,
  +0.1093310f, +0.1187567f, +0.0898877f, +0.0042713f, +0.0000000f, -0.0889527f, -0.3994456f, +0.0134078f,
  +0.0088974f, -0.0274384f, +0.0966310f, +0.0125340f, +0.0000000f, -0.0005054f, +0.0441157f, +0.0079471f,
  +0.1331545f, -0.0010816f, +0.1582836f, +0.0213145f, +0.0000000f, +0.0000457f, +0.1414832f, +0.0783213f,
  +0.1915275f, -0.0556797f, +0.1157665f, +0.0159630f, +0.0000000f, +0.0138292f, -0.0275777f, +0.0511177f,
  +0.0204267f, +0.0513685f, -0.0296654f, +0.0022920f, +0.0000000f, +0.0743799f, -0.0121332f, -0.0836596f,
  -0.0899004f, -0.0205747f, +0.0320353f, +0.0218642f, +0.0000000f, +0.0013900f, +0.1964720f, -0.0715842f,
  +0.0223630f, +0.0452324f, +0.1442763f, +0.0229211f, +0.0000000f, +0.0403450f, -0.0267671f, +0.0274233f,
  -0.0000000f, -0.0000000f, +0.0000000f, +0.0000000f, +0.0000000f, -0.0000000f, +0.0000000f, +0.0000000f,
  -0.0000000f, +0.0000000f, -0.0000000f, +0.0000000f, -0.0000000f, -0.0000000f, -0.0000000f, +0.0000000f,
  +0.0000000f, -0.0000000f, -0.0000000f, +0.0000000f, -0.0000000f, +0.0000000f, -0.0000000f, +0.0000000f,
  -0.0000000f, -0.0000000f, +0.0000000f, +0.0000000f, +0.0000000f, +0.0000000f, -0.0000000f, +0.0000000f,
  -0.0000000f, -0.0000000f, -0.0000000f, +0.0000000f, +0.0000000f, -0.0000000f, -0.0000000f, +0.0000000f,
  +0.0000000f, -0.0000000f, -0.0000000f, +0.0000000f, +0.0000000f, +0.0000000f, -0.0000000f, +0.0000000f,
  -0.0000000f, -0.0000000f, +0.0000000f, -0.0000000f, +0.0000000f, +0.0000000f, -0.0000000f, +0.0000000f,
  +0.0000000f, -0.0000000f, -0.0000000f, +0.0000000f, +0.0000000f, -0.0000000f, -0.0000000f, -0.0000000f,
  +0.0000000f, -0.0000000f, -0.0000000f, -0.0000000f, +0.0000000f, +0.0000000f, -0.0000000f, +0.0000000f,
  -0.2476390f, +0.0586513f, -0.0143507f, +0.2029778f, +0.0000000f, +0.0091246f, +0.0426365f, +0.0884267f,
  -0.2869627f, -0.0193544f, -0.0150288f, +0.0972176f, +0.0000000f, -0.0181357f, +0.3659993f, +0.0491384f,
  -0.0057562f, +0.0215947f, -0.0977916f, +0.1505219f, +0.0000000f, -0.0058517f, +0.4713423f, -0.2338134f,
  +0.1925471f, -0.0035114f, +0.0467185f, +0.3210849f, +0.0000000f, +0.0091080f, +0.0366664f, -0.0565215f,
  +0.0513354f, +0.1833509f, +0.0386731f, +0.2656803f, +0.0000000f, +0.0425909f, +0.4356469f, +0.0750126f,
  -0.1451239f, +0.0400431f, -0.0234099f, +0.0013809f, +0.0000000f, -0.0156038f, +0.2110517f, -0.1478283f,
  -0.0110169f, +0.1057924f, -0.0028942f, +0.1000806f, +0.0000000f, -0.0362698f, -0.0527467f, -0.0472992f,
  -0.0365055f, -0.0630547f, -0.0084898f, +0.0692617f, +0.0000000f, +0.0591842f, +0.4050331f, -0.0811999f,
  -0.1177276f, +0.0269807f, -0.0336128f, -0.0478103f, +0.0000000f, +0.0231887f, +0.2092628f, -0.0656647f,
  -0.1628071f, +0.0816647f, +0.0000932f, +0.0092121f, +0.0000000f, -0.0817758f, +0.0159932f, +0.0038433f,
  -0.2307002f, +0.0385842f, +0.1521863f, -0.0028742f, -0.0000000f, +0.0908145f, -0.1162643f, -0.0825295f,
  +0.0540331f, +0.0027958f, +0.1084384f, -0.0015988f, -0.0000000f, +0.1022191f, -0.3087034f, +0.0321026f,
  +0.1152741f, +0.0642938f, +0.0762183f, +0.0091980f, +0.0000000f, -0.0349492f, -0.0034119f, -0.0116370f,
  +0.3472981f, +0.1391215f, +0.1701572f, +0.0169833f, -0.0000000f, +0.1026628f, +0.1763788f, -0.1037072f,
  +0.0192925f, -0.0563704f, +0.0924381f, +0.0033154f, +0.0000000f, +0.0368256f, -0.1909207f, +0.0238511f,
  -0.0183522f, -0.0176178f, +0.0433869f, -0.0256419f, +0.0000000f, -0.0838559f, -0.1254923f, +0.0253899f,
  +0.2062621f, +0.0903569f, +0.0801410f, +0.0041607f, +0.0000000f, +0.1110158f, +0.3253821f, +0.0770846f,
  -0.1195454f, -0.0055021f, -0.0320336f, +0.0069246f, +0.0000000f, +0.1102615f, -0.0793813f, +0.0895362f
);

const float biases[4] = float[4](
  +0.0538354f, -0.0000000f, +0.0222429f, +0.0327419f
);

vec4 hook() {
    const vec4 r[9][2] = vec4[9][2](
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 1.0f)))
    );

    float sum[4] = biases;
    for (int n = 0; n < 4; n++) {
        for (int i = 0; i < 9; i++) {
            const vec4 k0 = vec4(kernels[n * 8 * 9 + 8 * i + 0], kernels[n * 8 * 9 + 8 * i + 1], kernels[n * 8 * 9 + 8 * i + 2], kernels[n * 8 * 9 + 8 * i + 3]);
            const vec4 k1 = vec4(kernels[n * 8 * 9 + 8 * i + 4], kernels[n * 8 * 9 + 8 * i + 5], kernels[n * 8 * 9 + 8 * i + 6], kernels[n * 8 * 9 + 8 * i + 7]);
            sum[n] += (dot(k0, r[i][0]) + dot(k1, r[i][1]));
        }
    }

    return ACTIVE(vec4(sum[0], sum[1], sum[2], sum[3]));
}

//!HOOK LUMA
//!DESC ACNet Layer6 L0
//!WHEN OUTPUT.w LUMA.w / 1.2 > OUTPUT.h LUMA.h / 1.2 > *
//!BIND TMP2_L0
//!BIND TMP2_L1
//!SAVE TMP1_L0
//!COMPONENTS 4

#define ACTIVE(v) (max(v, 0.0f))

#define TEX_BIND_L0_TEXOFF TMP2_L0_texOff
#define TEX_BIND_L0_TEX TMP2_L0_tex
#define TEX_BIND_L0_POS TMP2_L0_pos
#define TEX_BIND_L0_SIZE TMP2_L0_size
#define TEX_BIND_L0_PT TMP2_L0_pt

#define TEX_BIND_L1_TEXOFF TMP2_L1_texOff
#define TEX_BIND_L1_TEX TMP2_L1_tex
#define TEX_BIND_L1_POS TMP2_L1_pos
#define TEX_BIND_L1_SIZE TMP2_L1_size
#define TEX_BIND_L1_PT TMP2_L1_pt

const float kernels[288] = float[288](
  -0.0289179f, +0.1689138f, -0.0638795f, -0.4031378f, -0.1860055f, +0.0000000f, +0.0452731f, +0.0828622f,
  -0.0837190f, +0.0038192f, +0.0982060f, +0.3629767f, -0.0188635f, -0.0000000f, +0.0116186f, -0.0315404f,
  -0.0330264f, +0.0727939f, +0.1316262f, -0.0382117f, -0.0418349f, +0.0000000f, +0.1137864f, -0.0648335f,
  -0.2262024f, -0.1636434f, +0.1577826f, -0.2378238f, -0.0586706f, -0.0000000f, +0.1409337f, +0.1516826f,
  +0.0242798f, -0.0410310f, +0.1191439f, +0.2540978f, -0.0899869f, -0.0000000f, +0.1044409f, +0.0017613f,
  -0.2125392f, -0.0131408f, +0.3327713f, -0.2233436f, -0.0610685f, +0.0000000f, +0.1128286f, +0.0426899f,
  +0.0282313f, -0.0394783f, -0.3680848f, +0.0765422f, -0.0710625f, -0.0000000f, -0.0302305f, +0.1882005f,
  +0.0353229f, +0.1490968f, -0.5562677f, +0.0949979f, -0.0959868f, +0.0000000f, +0.3193743f, +0.0437829f,
  -0.0284245f, -0.0709779f, +0.1440061f, +0.0333987f, +0.0123179f, -0.0000000f, +0.0505413f, +0.0634725f,
  +0.0804766f, -0.0027478f, -0.0615350f, -0.0221041f, +0.0767949f, +0.0000000f, +0.0434735f, +0.0551689f,
  +0.1039700f, +0.0087663f, +0.0517816f, -0.0810728f, +0.0468164f, +0.0000000f, -0.0470654f, +0.1187395f,
  -0.0363373f, +0.0438695f, -0.0234942f, -0.0375088f, -0.0132038f, +0.0000000f, -0.0719994f, -0.0704750f,
  -0.0728276f, -0.0331678f, +0.0516766f, +0.0068970f, +0.1398755f, +0.0000000f, +0.0603382f, -0.0134377f,
  +0.0640484f, +0.1191458f, +0.1406700f, +0.0164060f, +0.1117527f, +0.0000000f, +0.0372397f, +0.1433471f,
  +0.0424762f, -0.0180830f, -0.1037685f, +0.0469234f, +0.0871210f, +0.0000000f, +0.0288025f, +0.1518030f,
  -0.0001397f, +0.0481548f, +0.0032951f, -0.0088448f, +0.1209720f, +0.0000000f, -0.0407007f, +0.0563310f,
  -0.2246845f, -0.0417424f, +0.0119419f, +0.0291303f, -0.0384631f, +0.0000000f, +0.0186270f, +0.0797186f,
  -0.0491892f, +0.1125121f, -0.1177518f, +0.0310243f, +0.0673870f, +0.0000000f, -0.0181814f, +0.0062691f,
  -0.0664601f, -0.0761723f, +0.0163857f, -0.0132718f, -0.0260871f, +0.0000000f, +0.1638062f, +0.0449738f,
  +0.2745469f, +0.0619627f, -0.0186117f, +0.1570535f, +0.1599652f, -0.0000000f, -0.0683900f, +0.0775141f,
  +0.0559161f, -0.0138043f, -0.1735399f, +0.0677306f, +0.0962643f, +0.0000000f, +0.0265269f, -0.0846198f,
  +0.1351467f, -0.0528521f, -0.1216618f, +0.1063664f, +0.1243114f, -0.0000000f, -0.0986123f, -0.0298079f,
  -0.3726298f, +0.1000582f, +0.0126665f, +0.0194815f, +0.1146239f, -0.0000000f, +0.2195307f, +0.0215912f,
  +0.1346345f, -0.0341064f, -0.0338525f, -0.2065524f, -0.0971966f, +0.0000000f, -0.2188627f, -0.0395016f,
  -0.0000408f, +0.0672179f, -0.0328966f, -0.0059087f, -0.0623472f, +0.0000000f, +0.0748412f, -0.0557972f,
  +0.3189617f, -0.0038616f, +0.1034299f, -0.0710732f, -0.0452386f, -0.0000000f, -0.1211789f, -0.0651048f,
  -0.0838710f, -0.0717880f, +0.2492411f, +0.0187232f, -0.0264433f, +0.0000000f, -0.0817000f, -0.0598603f,
  -0.3781134f, +0.0779026f, +0.1566557f, +0.3749571f, -0.0995570f, +0.0000000f, -0.1363353f, -0.1214866f,
  -0.2305567f, -0.0159692f, +0.3922200f, +0.1500143f, -0.0269544f, +0.0000000f, -0.0548246f, -0.0797890f,
  -0.0744906f, -0.0630400f, +0.0916778f, +0.1472668f, +0.0260424f, +0.0000000f, -0.0661250f, -0.0295906f,
  +0.0408328f, -0.1781936f, +0.1451919f, +0.3215131f, -0.0533743f, -0.0000000f, -0.2069370f, +0.0128520f,
  -0.2261295f, -0.0714143f, +0.5733145f, +0.1287463f, +0.1136858f, -0.0000000f, +0.1492441f, +0.1245688f,
  -0.1498634f, +0.0184509f, -0.0734664f, -0.0816453f, +0.0465029f, +0.0000000f, +0.1402812f, +0.0130814f,
  -0.1097378f, -0.1061765f, +0.1027062f, +0.2862883f, -0.0340676f, -0.0000000f, +0.0327349f, -0.0032966f,
  -0.6516148f, +0.0035614f, +0.1080341f, +0.1932863f, +0.0091849f, -0.0000000f, +0.0763602f, +0.1108948f,
  +0.1754593f, +0.0367192f, -0.1315037f, -0.0800091f, -0.0914202f, +0.0000000f, -0.0925409f, +0.0864613f
);

const float biases[4] = float[4](
  +0.0156295f, +0.0297031f, +0.0264118f, +0.0123008f
);

vec4 hook() {
    const vec4 r[9][2] = vec4[9][2](
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 1.0f)))
    );

    float sum[4] = biases;
    for (int n = 0; n < 4; n++) {
        for (int i = 0; i < 9; i++) {
            const vec4 k0 = vec4(kernels[n * 8 * 9 + 8 * i + 0], kernels[n * 8 * 9 + 8 * i + 1], kernels[n * 8 * 9 + 8 * i + 2], kernels[n * 8 * 9 + 8 * i + 3]);
            const vec4 k1 = vec4(kernels[n * 8 * 9 + 8 * i + 4], kernels[n * 8 * 9 + 8 * i + 5], kernels[n * 8 * 9 + 8 * i + 6], kernels[n * 8 * 9 + 8 * i + 7]);
            sum[n] += (dot(k0, r[i][0]) + dot(k1, r[i][1]));
        }
    }

    return ACTIVE(vec4(sum[0], sum[1], sum[2], sum[3]));
}

//!HOOK LUMA
//!DESC ACNet Layer6 L1
//!WHEN OUTPUT.w LUMA.w / 1.2 > OUTPUT.h LUMA.h / 1.2 > *
//!BIND TMP2_L0
//!BIND TMP2_L1
//!SAVE TMP1_L1
//!COMPONENTS 4

#define ACTIVE(v) (max(v, 0.0f))

#define TEX_BIND_L0_TEXOFF TMP2_L0_texOff
#define TEX_BIND_L0_TEX TMP2_L0_tex
#define TEX_BIND_L0_POS TMP2_L0_pos
#define TEX_BIND_L0_SIZE TMP2_L0_size
#define TEX_BIND_L0_PT TMP2_L0_pt

#define TEX_BIND_L1_TEXOFF TMP2_L1_texOff
#define TEX_BIND_L1_TEX TMP2_L1_tex
#define TEX_BIND_L1_POS TMP2_L1_pos
#define TEX_BIND_L1_SIZE TMP2_L1_size
#define TEX_BIND_L1_PT TMP2_L1_pt

const float kernels[288] = float[288](
  +0.1435231f, +0.1016844f, -0.0349816f, +0.0782015f, -0.0094643f, -0.0000000f, +0.0241157f, +0.0136655f,
  +0.0592378f, +0.0166847f, -0.1277262f, -0.1395186f, +0.0147176f, -0.0000000f, -0.0953583f, -0.0305485f,
  -0.0211402f, +0.0516160f, +0.0682128f, +0.1515383f, +0.0749324f, -0.0000000f, +0.1646839f, -0.0476351f,
  +0.0739994f, +0.0982411f, -0.1467399f, +0.0238798f, +0.0309956f, +0.0000000f, +0.3191563f, -0.0927141f,
  +0.2089273f, -0.1650213f, -0.3684379f, +0.1407793f, -0.1233948f, +0.0000000f, -0.2347154f, -0.2160480f,
  +0.0355117f, -0.1258563f, +0.0815460f, -0.1290609f, +0.1745175f, +0.0000000f, -0.2164353f, -0.0594642f,
  -0.0531101f, +0.0839149f, -0.1538475f, -0.1826817f, +0.0442212f, +0.0000000f, +0.1294509f, -0.0089110f,
  +0.3922196f, +0.0074837f, -0.0703682f, -0.0156865f, -0.1380806f, +0.0000000f, -0.0184027f, -0.0039299f,
  +0.1310250f, +0.0573553f, +0.0438937f, -0.1258788f, -0.0102050f, -0.0000000f, -0.0322471f, -0.0232893f,
  -0.1785482f, +0.0527938f, +0.0503721f, -0.0779841f, -0.0270061f, -0.0000000f, +0.0016870f, -0.0951552f,
  +0.0090661f, -0.0904135f, +0.0681880f, -0.2073936f, -0.0789215f, +0.0000000f, -0.2170721f, -0.0714218f,
  -0.0191416f, +0.0355597f, -0.0853525f, +0.1173623f, -0.0271239f, -0.0000000f, -0.0388954f, +0.0094611f,
  -0.0567537f, +0.0373947f, +0.2276922f, +0.0245281f, -0.0059232f, -0.0000000f, -0.0584651f, +0.0037587f,
  -0.5445120f, +0.0593552f, +0.5975845f, +0.2184986f, -0.0276934f, +0.0000000f, -0.0591456f, +0.0169659f,
  -0.5766450f, -0.0366761f, -0.0745680f, +0.2563946f, +0.0595236f, -0.0000000f, +0.1193641f, +0.0288390f,
  +0.1683533f, +0.0380350f, +0.0783156f, -0.0245614f, +0.0977043f, +0.0000000f, -0.0277270f, -0.0307939f,
  +0.0205313f, +0.0678436f, +0.0849252f, +0.0846612f, +0.0962231f, -0.0000000f, -0.0950472f, +0.0198877f,
  +0.2081166f, +0.1104156f, -0.0403998f, -0.0921912f, +0.0204322f, -0.0000000f, -0.2262726f, -0.0525409f,
  -0.0107083f, -0.0086821f, +0.0756799f, -0.0024780f, +0.1227814f, +0.0000000f, -0.0561636f, +0.0000106f,
  +0.0301711f, +0.0464845f, +0.0175041f, +0.1510829f, +0.0783183f, -0.0000000f, +0.1035302f, -0.2094939f,
  -0.3047320f, -0.3083587f, +0.1627787f, +0.0133132f, +0.0334001f, -0.0000000f, +0.0662281f, -0.1035813f,
  -0.1021374f, -0.1020547f, +0.1407535f, -0.0952565f, +0.0485967f, -0.0000000f, +0.0821473f, +0.1620637f,
  +0.0420169f, +0.0681133f, +0.2436085f, +0.0618098f, +0.0606323f, +0.0000000f, +0.4782742f, +0.1253792f,
  +0.2556795f, -0.2805859f, +0.2273739f, -0.1938642f, -0.0572379f, +0.0000000f, +0.1200397f, -0.1310403f,
  -0.0986639f, -0.0578283f, -0.1304361f, +0.0713654f, +0.0325223f, -0.0000000f, -0.0681498f, +0.1369962f,
  -0.5592824f, +0.0209904f, +0.0082145f, +0.1532804f, +0.0459260f, +0.0000000f, +0.1834022f, +0.0292816f,
  -0.0768763f, -0.1284273f, +0.1634377f, +0.0009585f, -0.0955658f, -0.0000000f, +0.2211282f, -0.0870203f,
  +0.0000000f, +0.0000000f, -0.0000000f, -0.0000000f, -0.0000000f, -0.0000000f, -0.0000000f, -0.0000000f,
  +0.0000000f, +0.0000000f, -0.0000000f, -0.0000000f, +0.0000000f, +0.0000000f, -0.0000000f, -0.0000000f,
  +0.0000000f, +0.0000000f, -0.0000000f, -0.0000000f, +0.0000000f, +0.0000000f, -0.0000000f, -0.0000000f,
  -0.0000000f, +0.0000000f, -0.0000000f, -0.0000000f, -0.0000000f, +0.0000000f, -0.0000000f, -0.0000000f,
  +0.0000000f, +0.0000000f, -0.0000000f, -0.0000000f, -0.0000000f, -0.0000000f, -0.0000000f, -0.0000000f,
  -0.0000000f, +0.0000000f, -0.0000000f, -0.0000000f, +0.0000000f, +0.0000000f, -0.0000000f, -0.0000000f,
  -0.0000000f, +0.0000000f, -0.0000000f, -0.0000000f, -0.0000000f, +0.0000000f, -0.0000000f, -0.0000000f,
  -0.0000000f, +0.0000000f, -0.0000000f, -0.0000000f, -0.0000000f, +0.0000000f, -0.0000000f, -0.0000000f,
  +0.0000000f, +0.0000000f, -0.0000000f, -0.0000000f, -0.0000000f, +0.0000000f, -0.0000000f, -0.0000000f
);

const float biases[4] = float[4](
  +0.1865387f, -0.0072260f, +0.0246134f, -0.0000000f
);

vec4 hook() {
    const vec4 r[9][2] = vec4[9][2](
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 1.0f)))
    );

    float sum[4] = biases;
    for (int n = 0; n < 4; n++) {
        for (int i = 0; i < 9; i++) {
            const vec4 k0 = vec4(kernels[n * 8 * 9 + 8 * i + 0], kernels[n * 8 * 9 + 8 * i + 1], kernels[n * 8 * 9 + 8 * i + 2], kernels[n * 8 * 9 + 8 * i + 3]);
            const vec4 k1 = vec4(kernels[n * 8 * 9 + 8 * i + 4], kernels[n * 8 * 9 + 8 * i + 5], kernels[n * 8 * 9 + 8 * i + 6], kernels[n * 8 * 9 + 8 * i + 7]);
            sum[n] += (dot(k0, r[i][0]) + dot(k1, r[i][1]));
        }
    }

    return ACTIVE(vec4(sum[0], sum[1], sum[2], sum[3]));
}

//!HOOK LUMA
//!DESC ACNet Layer7 L0
//!WHEN OUTPUT.w LUMA.w / 1.2 > OUTPUT.h LUMA.h / 1.2 > *
//!BIND TMP1_L0
//!BIND TMP1_L1
//!SAVE TMP2_L0
//!COMPONENTS 4

#define ACTIVE(v) (max(v, 0.0f))

#define TEX_BIND_L0_TEXOFF TMP1_L0_texOff
#define TEX_BIND_L0_TEX TMP1_L0_tex
#define TEX_BIND_L0_POS TMP1_L0_pos
#define TEX_BIND_L0_SIZE TMP1_L0_size
#define TEX_BIND_L0_PT TMP1_L0_pt

#define TEX_BIND_L1_TEXOFF TMP1_L1_texOff
#define TEX_BIND_L1_TEX TMP1_L1_tex
#define TEX_BIND_L1_POS TMP1_L1_pos
#define TEX_BIND_L1_SIZE TMP1_L1_size
#define TEX_BIND_L1_PT TMP1_L1_pt

const float kernels[288] = float[288](
  -0.1263257f, +0.0485526f, -0.0214131f, +0.1170543f, +0.1583686f, +0.0881386f, +0.0038572f, -0.0000000f,
  +0.2733174f, -0.0872968f, +0.0460659f, -0.0168822f, -0.2996783f, -0.2482814f, +0.0373288f, +0.0000000f,
  -0.4667393f, +0.1841462f, +0.0923715f, +0.1257486f, +0.1609358f, +0.0005575f, +0.0475110f, +0.0000000f,
  -0.0094537f, +0.0311940f, +0.1576147f, -0.0298343f, +0.0405623f, -0.1387062f, -0.0788476f, -0.0000000f,
  +0.0967970f, -0.0728989f, -0.1035217f, -0.1155770f, -0.1632919f, -0.2483863f, +0.1284404f, -0.0000000f,
  -0.6497453f, -0.0818347f, -0.3480838f, +0.4731848f, -0.0370230f, +0.0017996f, +0.0926767f, +0.0000000f,
  +0.0181031f, +0.0716388f, +0.0237149f, +0.0353008f, -0.0399906f, -0.1167018f, -0.0850413f, -0.0000000f,
  +0.0027190f, -0.0314546f, +0.1645350f, +0.1124585f, +0.1700106f, +0.0336508f, +0.0572120f, -0.0000000f,
  +0.2388793f, -0.0628656f, -0.1369944f, +0.0035038f, -0.0027735f, -0.0295586f, -0.0104154f, +0.0000000f,
  -0.0232430f, -0.0176341f, +0.0489300f, -0.0486815f, +0.0520501f, +0.0548070f, +0.0755558f, +0.0000000f,
  -0.0225254f, -0.0391736f, +0.0912977f, -0.0736143f, +0.2202710f, +0.1117698f, +0.0257336f, +0.0000000f,
  +0.0396684f, -0.0090936f, +0.0181947f, -0.0069206f, -0.0413278f, +0.0235110f, -0.0606337f, +0.0000000f,
  -0.1120966f, -0.0039428f, -0.0633651f, -0.0481932f, -0.0663266f, +0.0060413f, +0.1220060f, +0.0000000f,
  -0.2389158f, -0.0164111f, -0.1540702f, -0.2370389f, +0.1044962f, -0.0324569f, -0.4153336f, +0.0000000f,
  +0.1643143f, +0.0026484f, +0.0815429f, -0.0083394f, +0.0170576f, +0.0766114f, +0.0276337f, +0.0000000f,
  -0.1399830f, +0.0113756f, +0.0499193f, +0.0560238f, -0.1204693f, -0.0212756f, +0.4555966f, +0.0000000f,
  -0.1585695f, -0.0029057f, +0.1685206f, +0.3784528f, +0.0524938f, +0.0300540f, +0.3283217f, +0.0000000f,
  -0.1562522f, +0.0633822f, +0.0440531f, -0.0245499f, -0.0180182f, +0.0507522f, +0.0262769f, +0.0000000f,
  -0.0792065f, +0.0103237f, -0.0761850f, +0.0515764f, -0.0474420f, -0.0078873f, -0.0823441f, +0.0000000f,
  -0.0207630f, +0.1360998f, -0.2898076f, -0.0256562f, -0.0515801f, -0.0702745f, +0.1238766f, +0.0000000f,
  -0.2484160f, +0.0865191f, -0.1181578f, +0.0467890f, -0.0852158f, -0.1095828f, +0.0529305f, +0.0000000f,
  -0.0657769f, +0.1349919f, -0.0990480f, +0.0762862f, -0.1060039f, -0.0806538f, +0.0836655f, -0.0000000f,
  -0.1844627f, +0.0319334f, +0.0538788f, +0.6012606f, -0.1385850f, +0.1394643f, +0.3972936f, -0.0000000f,
  +0.2617771f, +0.0091822f, -0.1735085f, -0.2592546f, -0.3148400f, +0.2529206f, +0.0476871f, -0.0000000f,
  -0.0179083f, -0.0360173f, -0.2187427f, -0.0534428f, +0.2145427f, +0.0013254f, -0.0445023f, +0.0000000f,
  -0.2303894f, -0.2205604f, -0.1210894f, -0.3365604f, -0.1185149f, -0.0673722f, -0.0831048f, +0.0000000f,
  -0.3576708f, -0.2325819f, -0.3145668f, +0.4758548f, -0.0766141f, -0.2642855f, -0.1643035f, -0.0000000f,
  -0.0352783f, +0.1081310f, -0.1426624f, +0.0007320f, +0.0604057f, -0.0227997f, -0.0465247f, +0.0000000f,
  +0.0652106f, +0.0082043f, -0.0252832f, +0.1081349f, -0.1287353f, -0.1211241f, +0.0603145f, +0.0000000f,
  -0.0054199f, +0.0413027f, +0.0064043f, -0.0000903f, -0.0746916f, -0.0093855f, -0.0036467f, +0.0000000f,
  +0.0839606f, +0.1340507f, -0.0186993f, +0.1480787f, -0.1321623f, +0.0369054f, -0.0809433f, +0.0000000f,
  +0.0314105f, +0.1414974f, +0.1089545f, +0.2543566f, -0.0099889f, +0.1004940f, +0.2546133f, +0.0000000f,
  +0.0445100f, +0.0721550f, -0.0214968f, -0.1374941f, +0.0027608f, +0.0090602f, +0.1546137f, +0.0000000f,
  -0.0549052f, +0.0339420f, +0.0550737f, +0.0229362f, -0.1141233f, -0.0731997f, -0.0577076f, +0.0000000f,
  +0.0407266f, -0.0477806f, +0.0170308f, -0.0797334f, -0.0513121f, +0.1062794f, -0.0578233f, +0.0000000f,
  -0.0157102f, +0.1609512f, +0.1057229f, -0.2236029f, -0.0171960f, -0.0482182f, +0.0540416f, +0.0000000f
);

const float biases[4] = float[4](
  -0.0030006f, -0.0123000f, +0.0347558f, +0.0277197f
);

vec4 hook() {
    const vec4 r[9][2] = vec4[9][2](
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 1.0f)))
    );

    float sum[4] = biases;
    for (int n = 0; n < 4; n++) {
        for (int i = 0; i < 9; i++) {
            const vec4 k0 = vec4(kernels[n * 8 * 9 + 8 * i + 0], kernels[n * 8 * 9 + 8 * i + 1], kernels[n * 8 * 9 + 8 * i + 2], kernels[n * 8 * 9 + 8 * i + 3]);
            const vec4 k1 = vec4(kernels[n * 8 * 9 + 8 * i + 4], kernels[n * 8 * 9 + 8 * i + 5], kernels[n * 8 * 9 + 8 * i + 6], kernels[n * 8 * 9 + 8 * i + 7]);
            sum[n] += (dot(k0, r[i][0]) + dot(k1, r[i][1]));
        }
    }

    return ACTIVE(vec4(sum[0], sum[1], sum[2], sum[3]));
}

//!HOOK LUMA
//!DESC ACNet Layer7 L1
//!WHEN OUTPUT.w LUMA.w / 1.2 > OUTPUT.h LUMA.h / 1.2 > *
//!BIND TMP1_L0
//!BIND TMP1_L1
//!SAVE TMP2_L1
//!COMPONENTS 4

#define ACTIVE(v) (max(v, 0.0f))

#define TEX_BIND_L0_TEXOFF TMP1_L0_texOff
#define TEX_BIND_L0_TEX TMP1_L0_tex
#define TEX_BIND_L0_POS TMP1_L0_pos
#define TEX_BIND_L0_SIZE TMP1_L0_size
#define TEX_BIND_L0_PT TMP1_L0_pt

#define TEX_BIND_L1_TEXOFF TMP1_L1_texOff
#define TEX_BIND_L1_TEX TMP1_L1_tex
#define TEX_BIND_L1_POS TMP1_L1_pos
#define TEX_BIND_L1_SIZE TMP1_L1_size
#define TEX_BIND_L1_PT TMP1_L1_pt

const float kernels[288] = float[288](
  -0.3357563f, -0.0372914f, +0.1882590f, -0.0637816f, +0.0000443f, +0.1615539f, +0.0782676f, -0.0000000f,
  +0.0954425f, +0.0762164f, +0.1638735f, +0.0714131f, +0.0862385f, -0.0303374f, +0.0861225f, -0.0000000f,
  +0.0278039f, +0.0861712f, -0.0347501f, -0.0650766f, +0.0057537f, -0.0096808f, +0.0292980f, -0.0000000f,
  -0.2383363f, -0.1632423f, -0.2020342f, -0.1526200f, -0.5763294f, -0.2840449f, +0.0646962f, +0.0000000f,
  -0.7265043f, -0.0086759f, +0.2416961f, +0.4326123f, -0.0050076f, -0.0276251f, +0.2028523f, -0.0000000f,
  -0.1222919f, +0.0430380f, +0.0000904f, -0.0842241f, -0.0522976f, +0.0160582f, +0.0436598f, -0.0000000f,
  +0.1037970f, -0.0343643f, -0.1304888f, +0.0646318f, +0.1855582f, +0.0579374f, +0.1533937f, +0.0000000f,
  +0.1952030f, -0.0072777f, +0.0968554f, +0.1055275f, -0.0113316f, -0.0664640f, -0.0376496f, -0.0000000f,
  +0.0345706f, +0.0374511f, -0.0016737f, -0.1527389f, -0.0270099f, +0.0110965f, +0.0071438f, -0.0000000f,
  +0.0727308f, -0.0565332f, +0.0285313f, +0.0007676f, +0.1106050f, -0.0750439f, -0.0990197f, -0.0000000f,
  -0.1022715f, +0.0621088f, -0.0839600f, +0.0314372f, -0.2109026f, -0.0236550f, +0.1557827f, -0.0000000f,
  -0.0195826f, +0.0520295f, +0.0136153f, -0.0610837f, +0.1643524f, -0.0528652f, -0.0021482f, -0.0000000f,
  -0.0174664f, +0.0579711f, -0.0111508f, -0.0811189f, -0.1024804f, +0.0215415f, -0.0890289f, -0.0000000f,
  -0.2009716f, +0.0515768f, -0.0014162f, +0.2140560f, -0.1188417f, +0.0002730f, +0.1847048f, -0.0000000f,
  +0.0931083f, +0.0663178f, +0.0566608f, +0.0608359f, -0.0799289f, +0.1350806f, +0.0375713f, -0.0000000f,
  +0.0651960f, -0.0021669f, -0.0809539f, +0.0481048f, +0.0599802f, -0.0123173f, -0.2039419f, -0.0000000f,
  -0.1187987f, +0.0772739f, -0.1059972f, -0.1626255f, +0.1027147f, +0.0907422f, -0.1373494f, +0.0000000f,
  -0.0035152f, -0.0406087f, +0.0432761f, +0.0092555f, -0.0118905f, -0.0030079f, +0.0296482f, +0.0000000f,
  -0.0189666f, -0.0189842f, +0.0050613f, +0.0217390f, +0.0404580f, +0.0185114f, -0.0671520f, -0.0000000f,
  -0.1490299f, +0.0419625f, -0.0304591f, +0.0520975f, -0.1287100f, -0.1025653f, +0.1020786f, -0.0000000f,
  +0.0814523f, +0.1018582f, -0.0630549f, -0.0404532f, -0.0434913f, -0.0732383f, +0.0252340f, -0.0000000f,
  +0.1209875f, -0.1082267f, +0.0445403f, -0.0999833f, +0.0989814f, -0.0398019f, -0.0436866f, -0.0000000f,
  -0.0255239f, +0.1107936f, +0.2013454f, +0.0475778f, -0.1363661f, -0.0161202f, +0.2533418f, -0.0000000f,
  +0.0132846f, +0.0786128f, +0.0963512f, -0.0278624f, +0.0200924f, -0.0007407f, +0.0927116f, -0.0000000f,
  -0.1377981f, -0.1452100f, -0.0194955f, -0.0865654f, +0.1562638f, -0.0113773f, +0.3770188f, -0.0000000f,
  -0.0533586f, -0.0775086f, -0.1231382f, +0.1524127f, -0.0008455f, +0.0097975f, +0.0414500f, -0.0000000f,
  -0.0313103f, +0.0187682f, +0.0117196f, -0.0404622f, -0.0257006f, -0.0903418f, +0.0199344f, -0.0000000f,
  +0.0358902f, +0.0702078f, -0.0904625f, +0.0289250f, +0.0384714f, -0.0397053f, -0.0970786f, -0.0000000f,
  -0.0737383f, +0.0414239f, -0.0300829f, +0.2331735f, +0.0307449f, -0.0120169f, -0.0022350f, -0.0000000f,
  +0.0988988f, -0.0607614f, +0.0680752f, +0.0781282f, +0.0284462f, -0.0987905f, -0.0592114f, +0.0000000f,
  +0.0333124f, +0.0446535f, +0.0425305f, +0.0634435f, +0.0106249f, -0.0127976f, -0.2472816f, +0.0000000f,
  +0.0582312f, -0.0335900f, +0.4324830f, +0.1629144f, -0.2400629f, -0.2753950f, +0.4335283f, +0.0000000f,
  -0.2134823f, -0.0530436f, +0.1348000f, -0.0038727f, -0.1248955f, -0.1513848f, -0.1930619f, -0.0000000f,
  +0.0862892f, +0.1231860f, +0.0923892f, +0.0691072f, -0.1300169f, -0.1028972f, -0.1803851f, +0.0000000f,
  +0.0508367f, -0.0446657f, +0.1368317f, +0.0068477f, +0.2002539f, +0.0501117f, +0.1268886f, +0.0000000f,
  -0.0656130f, -0.0881930f, -0.2609178f, +0.3952825f, +0.0476182f, -0.1739140f, +0.0521025f, +0.0000000f
);

const float biases[4] = float[4](
  -0.0152083f, +0.0004871f, -0.0124188f, -0.0208633f
);

vec4 hook() {
    const vec4 r[9][2] = vec4[9][2](
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 1.0f)))
    );

    float sum[4] = biases;
    for (int n = 0; n < 4; n++) {
        for (int i = 0; i < 9; i++) {
            const vec4 k0 = vec4(kernels[n * 8 * 9 + 8 * i + 0], kernels[n * 8 * 9 + 8 * i + 1], kernels[n * 8 * 9 + 8 * i + 2], kernels[n * 8 * 9 + 8 * i + 3]);
            const vec4 k1 = vec4(kernels[n * 8 * 9 + 8 * i + 4], kernels[n * 8 * 9 + 8 * i + 5], kernels[n * 8 * 9 + 8 * i + 6], kernels[n * 8 * 9 + 8 * i + 7]);
            sum[n] += (dot(k0, r[i][0]) + dot(k1, r[i][1]));
        }
    }

    return ACTIVE(vec4(sum[0], sum[1], sum[2], sum[3]));
}

//!HOOK LUMA
//!DESC ACNet Layer8 L0
//!WHEN OUTPUT.w LUMA.w / 1.2 > OUTPUT.h LUMA.h / 1.2 > *
//!BIND TMP2_L0
//!BIND TMP2_L1
//!SAVE TMP1_L0
//!COMPONENTS 4

#define ACTIVE(v) (max(v, 0.0f))

#define TEX_BIND_L0_TEXOFF TMP2_L0_texOff
#define TEX_BIND_L0_TEX TMP2_L0_tex
#define TEX_BIND_L0_POS TMP2_L0_pos
#define TEX_BIND_L0_SIZE TMP2_L0_size
#define TEX_BIND_L0_PT TMP2_L0_pt

#define TEX_BIND_L1_TEXOFF TMP2_L1_texOff
#define TEX_BIND_L1_TEX TMP2_L1_tex
#define TEX_BIND_L1_POS TMP2_L1_pos
#define TEX_BIND_L1_SIZE TMP2_L1_size
#define TEX_BIND_L1_PT TMP2_L1_pt

const float kernels[288] = float[288](
  -0.0945048f, -0.0073820f, +0.0457555f, -0.0075324f, +0.0037748f, -0.0388605f, +0.0315741f, +0.2130505f,
  -0.0704774f, -0.0307404f, -0.3672363f, -0.1690972f, -0.0213105f, +0.0898980f, -0.1216221f, -0.0847502f,
  -0.0001579f, -0.1113143f, -0.0763168f, -0.1610288f, +0.1140971f, -0.0036631f, +0.1966906f, -0.0270280f,
  -0.2347543f, +0.0284290f, +0.3846734f, +0.0463135f, -0.0070164f, +0.0355277f, -0.0046605f, -0.3035138f,
  +0.0588489f, -0.3575046f, +0.0553536f, +0.1291190f, +0.0182283f, +0.1124865f, +0.0118868f, -0.0064246f,
  -0.0681613f, -0.0846834f, +0.1694263f, -0.0304879f, -0.2591991f, +0.0370181f, -0.1195761f, -0.0791279f,
  +0.0070658f, -0.0502095f, -0.0494033f, +0.0263880f, +0.0684159f, -0.0623337f, -0.1073575f, +0.1308104f,
  -0.1027602f, -0.0031096f, +0.0747090f, +0.0569250f, +0.1399790f, -0.0484700f, +0.0601314f, +0.0958784f,
  +0.0724713f, -0.0237298f, -0.0305495f, +0.0643958f, +0.1328987f, -0.0440936f, -0.0128286f, +0.0161935f,
  -0.0583352f, -0.0240769f, +0.1313515f, +0.0276287f, -0.0069909f, +0.0228248f, +0.0151802f, +0.0206331f,
  -0.0559679f, +0.1221023f, +0.0923916f, -0.0706476f, -0.0039627f, +0.0166402f, +0.1566424f, +0.0488085f,
  -0.0026284f, +0.0155313f, +0.0889137f, -0.0268383f, -0.0651624f, +0.0381469f, +0.0098696f, +0.0140801f,
  -0.0722178f, +0.1507401f, +0.1294119f, -0.0218443f, -0.0049296f, +0.0719024f, -0.0729008f, +0.0480829f,
  -0.0116615f, -0.4554518f, -0.3605192f, -0.0961843f, -0.0403826f, -0.0498215f, -0.2181802f, -0.1597918f,
  +0.0019413f, +0.0610037f, +0.0395713f, -0.0336113f, +0.6766958f, -0.0065592f, +0.0924652f, -0.0536342f,
  -0.1604313f, -0.0639482f, -0.0248376f, +0.0859379f, +0.0152508f, +0.0158261f, +0.0643487f, +0.0650039f,
  +0.1138787f, +0.0398042f, +0.0704253f, +0.0526626f, +0.2100016f, +0.0216256f, +0.0602899f, +0.0703173f,
  -0.0364731f, -0.0004882f, -0.0190160f, +0.0229385f, -0.1913672f, +0.0116463f, -0.0210941f, +0.0191170f,
  -0.0430476f, +0.0049008f, -0.2759133f, +0.0242146f, +0.0037784f, -0.0222253f, -0.0257726f, -0.0565822f,
  +0.0596274f, +0.0182414f, +0.0396218f, +0.0021643f, -0.0227687f, +0.0315040f, -0.0409843f, -0.0460405f,
  -0.0150684f, +0.0434488f, -0.0504923f, +0.1144194f, +0.0245295f, +0.0085645f, -0.1540241f, -0.0057562f,
  +0.1886054f, +0.0214203f, +0.1186645f, +0.0753258f, -0.0114411f, +0.0491248f, +0.0530500f, -0.3492363f,
  -0.2686802f, -0.1029857f, +0.5550237f, +0.1445485f, +0.0984630f, +0.1443942f, +0.1550882f, +0.3293311f,
  +0.0012789f, -0.1623523f, -0.0236224f, +0.0804972f, -0.0127613f, +0.0845726f, -0.1904040f, +0.0552105f,
  +0.1127319f, -0.0192996f, -0.0061204f, +0.0661154f, +0.0106421f, +0.0101029f, +0.0377004f, +0.0232297f,
  -0.2779575f, -0.0151207f, -0.0074778f, +0.0297624f, +0.0528711f, +0.0190968f, +0.1063183f, +0.0851076f,
  +0.0498412f, +0.0020616f, +0.0067961f, +0.0286804f, +0.1965019f, +0.0045579f, -0.0225205f, +0.0374481f,
  +0.0142663f, +0.0122521f, -0.0623406f, +0.0349038f, -0.0082725f, -0.0194142f, -0.0218967f, -0.0475842f,
  -0.0720159f, -0.0579658f, -0.1121559f, +0.0558125f, +0.0546683f, +0.0190880f, -0.1143562f, -0.0405238f,
  +0.0045252f, +0.0926723f, -0.0721219f, +0.0468111f, -0.0305328f, +0.0145039f, -0.0508376f, +0.0063032f,
  -0.0702457f, +0.0242245f, +0.1181192f, +0.0809277f, -0.0093953f, +0.0584618f, +0.0711758f, -0.2482214f,
  +0.3914212f, -0.1018579f, +0.4349332f, +0.0766074f, +0.1587376f, +0.0626449f, +0.0846669f, +0.2463498f,
  -0.0192159f, -0.1421901f, +0.0435928f, +0.0639684f, -0.3609287f, +0.0498841f, -0.1448047f, +0.0055942f,
  +0.2053563f, -0.0288146f, -0.0135242f, +0.0546473f, +0.0056412f, +0.0066913f, +0.0376761f, -0.0133473f,
  -0.3561503f, +0.0130878f, +0.0048679f, +0.0286933f, +0.0189768f, +0.0436393f, +0.1083997f, +0.1051494f,
  +0.0380089f, -0.0026031f, -0.0105975f, +0.0219569f, +0.2008813f, +0.0151386f, -0.0264169f, +0.0425487f
);

const float biases[4] = float[4](
  +0.0074856f, +0.0007293f, +0.0083015f, +0.0064820f
);

vec4 hook() {
    const vec4 r[9][2] = vec4[9][2](
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 1.0f)))
    );

    float sum[4] = biases;
    for (int n = 0; n < 4; n++) {
        for (int i = 0; i < 9; i++) {
            const vec4 k0 = vec4(kernels[n * 8 * 9 + 8 * i + 0], kernels[n * 8 * 9 + 8 * i + 1], kernels[n * 8 * 9 + 8 * i + 2], kernels[n * 8 * 9 + 8 * i + 3]);
            const vec4 k1 = vec4(kernels[n * 8 * 9 + 8 * i + 4], kernels[n * 8 * 9 + 8 * i + 5], kernels[n * 8 * 9 + 8 * i + 6], kernels[n * 8 * 9 + 8 * i + 7]);
            sum[n] += (dot(k0, r[i][0]) + dot(k1, r[i][1]));
        }
    }

    return ACTIVE(vec4(sum[0], sum[1], sum[2], sum[3]));
}

//!HOOK LUMA
//!DESC ACNet Layer8 L1
//!WHEN OUTPUT.w LUMA.w / 1.2 > OUTPUT.h LUMA.h / 1.2 > *
//!BIND TMP2_L0
//!BIND TMP2_L1
//!SAVE TMP1_L1
//!COMPONENTS 4

#define ACTIVE(v) (max(v, 0.0f))

#define TEX_BIND_L0_TEXOFF TMP2_L0_texOff
#define TEX_BIND_L0_TEX TMP2_L0_tex
#define TEX_BIND_L0_POS TMP2_L0_pos
#define TEX_BIND_L0_SIZE TMP2_L0_size
#define TEX_BIND_L0_PT TMP2_L0_pt

#define TEX_BIND_L1_TEXOFF TMP2_L1_texOff
#define TEX_BIND_L1_TEX TMP2_L1_tex
#define TEX_BIND_L1_POS TMP2_L1_pos
#define TEX_BIND_L1_SIZE TMP2_L1_size
#define TEX_BIND_L1_PT TMP2_L1_pt

const float kernels[288] = float[288](
  -0.1237972f, -0.0655190f, +0.2069405f, +0.0200638f, +0.0198278f, +0.0435240f, -0.0749184f, -0.0565119f,
  +0.0410741f, +0.1100128f, +0.3304742f, -0.0324799f, -0.2327771f, -0.0731271f, +0.1060231f, +0.1337795f,
  +0.0126084f, +0.0289430f, -0.0944967f, -0.0089041f, -0.0043789f, +0.0824237f, -0.0347515f, +0.0145122f,
  -0.1204181f, +0.1085409f, -0.2197736f, -0.0563846f, +0.0976688f, -0.0501925f, -0.1333124f, +0.0452555f,
  +0.2951552f, -0.0601069f, +0.0466143f, -0.0645308f, +0.1300778f, +0.0040634f, -0.0295826f, +0.2470171f,
  +0.0028380f, -0.1673018f, +0.1220083f, +0.0128789f, -0.1040461f, +0.0406961f, -0.0052197f, -0.0248485f,
  +0.5192985f, -0.0444166f, -0.0295407f, -0.0324990f, +0.0226184f, +0.0274188f, -0.0378519f, -0.1752619f,
  -0.1649768f, +0.0343469f, +0.1890023f, +0.0108833f, -0.2549528f, +0.1835255f, +0.1599782f, +0.1553181f,
  +0.0571522f, -0.0337564f, -0.1839143f, +0.0073564f, -0.1071755f, +0.0921170f, +0.0015078f, +0.0866860f,
  +0.0314861f, -0.0567917f, -0.4636082f, +0.0088278f, -0.0169684f, -0.0241722f, +0.0350432f, -0.5083256f,
  -0.0232466f, -0.0556325f, +0.2745005f, +0.0217756f, -0.0822664f, +0.0464322f, -0.0617490f, +0.0184740f,
  +0.0097320f, +0.0576121f, -0.0822096f, +0.0087710f, -0.1004939f, +0.0080742f, -0.0125654f, +0.0135982f,
  -0.5210595f, -0.0006025f, -0.2673688f, -0.0233777f, +0.0344288f, -0.0231338f, -0.0103536f, +0.3628706f,
  +0.0479368f, +0.0497701f, -0.0661139f, -0.0439071f, +0.1096042f, +0.0177895f, -0.0026515f, +0.1369750f,
  +0.0416138f, -0.0679559f, +0.0635684f, -0.0367508f, +0.3835478f, +0.0271360f, +0.0045632f, -0.0128057f,
  +0.0554364f, +0.0133887f, +0.0169104f, -0.0024694f, -0.0004030f, +0.0307290f, -0.0598181f, -0.0286184f,
  -0.2043194f, -0.0094141f, +0.1445590f, -0.0060419f, -0.0310891f, +0.0069008f, -0.0009769f, -0.0291281f,
  +0.0124436f, -0.0073497f, -0.0900813f, +0.0308399f, -0.0213727f, +0.0128220f, -0.0066467f, +0.0298555f,
  +0.0812434f, +0.0182145f, -0.0054604f, +0.0602219f, -0.0327631f, +0.0049692f, +0.0684946f, -0.1715203f,
  +0.0474142f, -0.1951904f, +0.4577721f, +0.0544184f, +0.0791632f, +0.0170337f, -0.0528366f, -0.0336762f,
  -0.0474337f, +0.0221516f, +0.1729502f, +0.1225878f, -0.0751358f, +0.0470431f, -0.2248169f, +0.0150805f,
  -0.0337380f, -0.0735434f, -0.2056969f, +0.0321602f, +0.0185450f, +0.0120928f, +0.0132587f, +0.0860135f,
  -0.3492607f, +0.2078590f, -0.3096960f, +0.0085146f, -0.0219724f, -0.0312301f, +0.4800942f, +0.0792387f,
  +0.0177860f, -0.0581961f, -0.1907537f, +0.0345784f, +1.3886678f, -0.0082613f, -0.0409399f, +0.0421965f,
  +0.1005555f, +0.0393958f, +0.0767506f, -0.0543906f, -0.0012402f, -0.0078701f, -0.0415470f, -0.0928698f,
  -0.0579373f, -0.0453489f, -0.1309879f, -0.0252846f, -0.2567926f, -0.0023516f, -0.0287533f, -0.0159133f,
  -0.0183080f, +0.0157485f, +0.0612775f, +0.0102511f, +0.0723922f, -0.0007249f, -0.0052579f, -0.0065804f,
  +0.0403643f, +0.0710907f, -0.1303447f, +0.1140160f, -0.0271440f, +0.0210947f, -0.0504004f, -0.2812441f,
  +0.0249141f, -0.2237847f, +0.1554031f, +0.0669616f, +0.1467706f, -0.0188534f, -0.1204959f, +0.0525814f,
  -0.0146376f, +0.0473148f, -0.0525581f, +0.1115013f, -0.0592613f, +0.0679723f, -0.2334446f, -0.0001392f,
  +0.0088705f, +0.0380059f, +0.0815936f, +0.1182402f, +0.0044573f, +0.1295651f, +0.1497662f, -0.1434135f,
  +0.2803674f, -0.2024642f, +0.3556989f, +0.1149207f, +0.2623503f, +0.0301221f, +0.0788061f, +0.3655846f,
  +0.0398904f, -0.0386788f, +0.0212198f, +0.1121900f, -0.7437937f, -0.0100608f, +0.0060771f, +0.0473317f,
  +0.1163839f, -0.0580043f, +0.0149772f, +0.0660671f, -0.0083569f, -0.0348319f, +0.0564832f, -0.0390885f,
  +0.2946671f, +0.0589914f, +0.0024493f, +0.0696394f, +0.0944646f, +0.0854043f, +0.0639272f, +0.0841883f,
  -0.0043518f, -0.0062149f, -0.0406275f, -0.0818357f, -0.0065653f, +0.0576633f, -0.0058376f, +0.0270576f
);

const float biases[4] = float[4](
  +0.0002401f, +0.0000070f, +0.0017948f, +0.0089869f
);

vec4 hook() {
    const vec4 r[9][2] = vec4[9][2](
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 1.0f)))
    );

    float sum[4] = biases;
    for (int n = 0; n < 4; n++) {
        for (int i = 0; i < 9; i++) {
            const vec4 k0 = vec4(kernels[n * 8 * 9 + 8 * i + 0], kernels[n * 8 * 9 + 8 * i + 1], kernels[n * 8 * 9 + 8 * i + 2], kernels[n * 8 * 9 + 8 * i + 3]);
            const vec4 k1 = vec4(kernels[n * 8 * 9 + 8 * i + 4], kernels[n * 8 * 9 + 8 * i + 5], kernels[n * 8 * 9 + 8 * i + 6], kernels[n * 8 * 9 + 8 * i + 7]);
            sum[n] += (dot(k0, r[i][0]) + dot(k1, r[i][1]));
        }
    }

    return ACTIVE(vec4(sum[0], sum[1], sum[2], sum[3]));
}

//!HOOK LUMA
//!DESC ACNet Layer9 L0
//!WIDTH LUMA.w 2 *
//!HEIGHT LUMA.h 2 *
//!BIND TMP1_L0
//!BIND TMP1_L1
//!COMPONENTS 1

#define ACTIVE(v) (max(v, 0.0f))

#define TEX_BIND_L0_TEXOFF TMP1_L0_texOff
#define TEX_BIND_L0_TEX TMP1_L0_tex
#define TEX_BIND_L0_POS TMP1_L0_pos
#define TEX_BIND_L0_SIZE TMP1_L0_size
#define TEX_BIND_L0_PT TMP1_L0_pt

#define TEX_BIND_L1_TEXOFF TMP1_L1_texOff
#define TEX_BIND_L1_TEX TMP1_L1_tex
#define TEX_BIND_L1_POS TMP1_L1_pos
#define TEX_BIND_L1_SIZE TMP1_L1_size
#define TEX_BIND_L1_PT TMP1_L1_pt

const float kernels[32] = float[32](
  +0.4240111f, -0.0984903f, -0.1368322f, +0.2458229f, -0.3976746f, +0.3902037f, +0.0495238f, +0.3061316f,
  +0.4165287f, -0.4454817f, +0.4412722f, -0.3256139f, -0.0421877f, +0.0594237f, +0.1308957f, +0.1826789f,
  +0.1648087f, +0.4638839f, +0.2538688f, -0.0479128f, -0.2736201f, -0.0720678f, -0.1703136f, +0.2443201f,
  +0.1908698f, -0.0533252f, +0.3293573f, +0.3199947f, +0.1053409f, -0.2987550f, +0.0033250f, -0.1259047f
);

vec4 hook() {
    vec2 fcoord = fract(TEX_BIND_L0_POS * TEX_BIND_L0_SIZE);
    vec2 pos = TEX_BIND_L0_POS + (vec2(0.5f) - fcoord) * TEX_BIND_L0_PT;

    ivec2 icoord = ivec2(fcoord * vec2(2.0f));
    int index = icoord.y * 2 + icoord.x;

    vec4 r0 = TEX_BIND_L0_TEX(pos);
    vec4 r1 = TEX_BIND_L1_TEX(pos);

    vec4 k0 = vec4(kernels[8 * index + 0], kernels[8 * index + 1], kernels[8 * index + 2], kernels[8 * index + 3]);
    vec4 k1 = vec4(kernels[8 * index + 4], kernels[8 * index + 5], kernels[8 * index + 6], kernels[8 * index + 7]);

    return vec4(clamp(dot(r0, k0) + dot(r1, k1), 0.0f, 1.0f), 0.0f, 0.0f, 1.0f);
}
