//!HOOK LUMA
//!DESC ARNet b16 Layer0 L0
//!WHEN OUTPUT.w LUMA.w / 1.2 > OUTPUT.h LUMA.h / 1.2 > *
//!BIND LUMA
//!SAVE FEAT_L0
//!COMPONENTS 4

#define ACTIVE(v) (v)

#define TEX_BIND_L0_TEXOFF LUMA_texOff
#define TEX_BIND_L0_TEX LUMA_tex
#define TEX_BIND_L0_POS LUMA_pos
#define TEX_BIND_L0_SIZE LUMA_size
#define TEX_BIND_L0_PT LUMA_pt

const float kernels[36] = float[36](
  +0.3887717f, -0.8062236f, -0.0249019f, -0.3009107f, -0.0617967f, +0.5811815f, +0.5183581f, +0.1609752f,
  -0.3230386f, -0.6819691f, +0.3587798f, +0.5005874f, -0.5655719f, -0.1609114f, +0.1430157f, +0.2437637f,
  +0.0624758f, +0.8451153f, +0.0489285f, +0.2314658f, +0.0881796f, +0.4812120f, -0.5278370f, +0.2056900f,
  -0.3527223f, -0.2326698f, +0.1478061f, -0.5137092f, +0.2669600f, +0.5892894f, +0.0768013f, -0.1582002f,
  -0.3429844f, -0.6292245f, -0.5742162f, +0.9010848f
);

const float biases[4] = float[4](
  -0.0159708f, -0.0084742f, -0.0228902f, +0.0717909f
);

vec4 hook() {
    const vec4 r0 = vec4(
        TEX_BIND_L0_TEXOFF(vec2(-1.0f,-1.0f)).x,
        TEX_BIND_L0_TEXOFF(vec2( 0.0f,-1.0f)).x,
        TEX_BIND_L0_TEXOFF(vec2( 1.0f,-1.0f)).x,
        TEX_BIND_L0_TEXOFF(vec2(-1.0f, 0.0f)).x
    );
    const vec4 r4 = vec4(
        TEX_BIND_L0_TEXOFF(vec2( 0.0f, 0.0f)).x,
        TEX_BIND_L0_TEXOFF(vec2( 1.0f, 0.0f)).x,
        TEX_BIND_L0_TEXOFF(vec2(-1.0f, 1.0f)).x,
        TEX_BIND_L0_TEXOFF(vec2( 0.0f, 1.0f)).x
    );
    const float r8 = TEX_BIND_L0_TEXOFF(vec2( 1.0f, 1.0f)).x;

    float sum[4] = biases;
    for(int n = 0; n < 4; n++) {
        const vec4 k0 = vec4(kernels[n * 9 + 0], kernels[n * 9 + 1], kernels[n * 9 + 2], kernels[n * 9 + 3]);
        const vec4 k4 = vec4(kernels[n * 9 + 4], kernels[n * 9 + 5], kernels[n * 9 + 6], kernels[n * 9 + 7]);
        const float k8 = kernels[n * 9 + 8];
        sum[n] += (dot(r0, k0) + dot(r4, k4) + r8 * k8);
    }

    return ACTIVE(vec4(sum[0], sum[1], sum[2], sum[3]));
}

//!HOOK LUMA
//!DESC ARNet b16 Layer0 L1
//!WHEN OUTPUT.w LUMA.w / 1.2 > OUTPUT.h LUMA.h / 1.2 > *
//!BIND LUMA
//!SAVE FEAT_L1
//!COMPONENTS 4

#define ACTIVE(v) (v)

#define TEX_BIND_L0_TEXOFF LUMA_texOff
#define TEX_BIND_L0_TEX LUMA_tex
#define TEX_BIND_L0_POS LUMA_pos
#define TEX_BIND_L0_SIZE LUMA_size
#define TEX_BIND_L0_PT LUMA_pt

const float kernels[36] = float[36](
  -0.3584085f, +0.0754252f, +0.2714282f, -0.0437219f, -0.2939294f, -0.3461145f, -0.2138243f, +0.2592867f,
  -0.3413155f, +0.0905508f, -0.0849351f, -0.2587322f, -0.1243442f, -0.1719040f, -0.0816729f, +0.5634201f,
  -0.0121288f, +0.2317745f, +0.5379686f, -0.5465518f, -0.3188145f, +0.4914752f, +1.0618705f, +0.1020188f,
  +0.3285486f, -0.5327234f, -0.5846993f, +0.0319682f, -0.0480283f, +0.0350695f, -0.1945255f, +0.5914046f,
  -0.0326975f, +0.0598788f, +0.1384860f, -0.6453066f
);

const float biases[4] = float[4](
  +0.0423546f, -0.0309671f, -0.0330653f, +0.0270756f
);

vec4 hook() {
    const vec4 r0 = vec4(
        TEX_BIND_L0_TEXOFF(vec2(-1.0f,-1.0f)).x,
        TEX_BIND_L0_TEXOFF(vec2( 0.0f,-1.0f)).x,
        TEX_BIND_L0_TEXOFF(vec2( 1.0f,-1.0f)).x,
        TEX_BIND_L0_TEXOFF(vec2(-1.0f, 0.0f)).x
    );
    const vec4 r4 = vec4(
        TEX_BIND_L0_TEXOFF(vec2( 0.0f, 0.0f)).x,
        TEX_BIND_L0_TEXOFF(vec2( 1.0f, 0.0f)).x,
        TEX_BIND_L0_TEXOFF(vec2(-1.0f, 1.0f)).x,
        TEX_BIND_L0_TEXOFF(vec2( 0.0f, 1.0f)).x
    );
    const float r8 = TEX_BIND_L0_TEXOFF(vec2( 1.0f, 1.0f)).x;

    float sum[4] = biases;
    for(int n = 0; n < 4; n++) {
        const vec4 k0 = vec4(kernels[n * 9 + 0], kernels[n * 9 + 1], kernels[n * 9 + 2], kernels[n * 9 + 3]);
        const vec4 k4 = vec4(kernels[n * 9 + 4], kernels[n * 9 + 5], kernels[n * 9 + 6], kernels[n * 9 + 7]);
        const float k8 = kernels[n * 9 + 8];
        sum[n] += (dot(r0, k0) + dot(r4, k4) + r8 * k8);
    }

    return ACTIVE(vec4(sum[0], sum[1], sum[2], sum[3]));
}

//!HOOK LUMA
//!DESC ARNet b16 Layer1 L0
//!WHEN OUTPUT.w LUMA.w / 1.2 > OUTPUT.h LUMA.h / 1.2 > *
//!BIND FEAT_L0
//!BIND FEAT_L1
//!SAVE TMP1_L0
//!COMPONENTS 4

#define ACTIVE(v) (max(v, v * 0.2000000f))

#define TEX_BIND_L0_TEXOFF FEAT_L0_texOff
#define TEX_BIND_L0_TEX FEAT_L0_tex
#define TEX_BIND_L0_POS FEAT_L0_pos
#define TEX_BIND_L0_SIZE FEAT_L0_size
#define TEX_BIND_L0_PT FEAT_L0_pt

#define TEX_BIND_L1_TEXOFF FEAT_L1_texOff
#define TEX_BIND_L1_TEX FEAT_L1_tex
#define TEX_BIND_L1_POS FEAT_L1_pos
#define TEX_BIND_L1_SIZE FEAT_L1_size
#define TEX_BIND_L1_PT FEAT_L1_pt

const float kernels[288] = float[288](
  -0.0344802f, +0.1994418f, -0.1144034f, +0.1005796f, -0.1580018f, -0.0903093f, +0.1946739f, +0.1082764f,
  +0.1357600f, +0.0894440f, -0.2102610f, +0.0794464f, +0.0647890f, -0.1427433f, +0.1348284f, -0.2806391f,
  +0.0805398f, +0.1209174f, +0.1570803f, -0.2703727f, +0.0565587f, -0.0193844f, -0.1257980f, +0.0624566f,
  -0.0548071f, -0.1746658f, -0.0901328f, -0.0495736f, -0.2291673f, +0.3664886f, -0.2027866f, -0.1562275f,
  -0.1807106f, -0.0296843f, +0.2133584f, -0.0680387f, +0.0474570f, +0.0847057f, -0.1935344f, -0.0205507f,
  -0.3872024f, -0.2328521f, +0.0803531f, -0.0998317f, +0.0463406f, +0.0833089f, +0.0165461f, -0.2237350f,
  +0.2104347f, +0.3402863f, +0.0560190f, +0.4863769f, -0.2626073f, -0.0780577f, +0.2100649f, -0.1053509f,
  +0.4867593f, -0.0485070f, -0.1802337f, +0.1285767f, -0.1013645f, +0.2613815f, +0.1022682f, -0.0877720f,
  -0.2399004f, +0.0419075f, +0.5382560f, -0.0374729f, +0.1911302f, -0.3735494f, -0.3821362f, +0.2659694f,
  -0.0871663f, +0.0792905f, -0.0076969f, -0.0034519f, -0.0763876f, -0.0596604f, -0.0183744f, -0.3997191f,
  -0.1921901f, +0.2184911f, -0.4901524f, -0.4351777f, -0.2337020f, -0.4214568f, -0.1506293f, -0.2329750f,
  -0.0014201f, +0.1753157f, -0.1159701f, -0.1791690f, -0.0207007f, -0.1775186f, -0.1621928f, +0.2105723f,
  -0.0155587f, +0.0721233f, +0.4451570f, -0.0812719f, -0.0276786f, -0.0431328f, -0.0298209f, +0.0966497f,
  -0.2026867f, +0.0766256f, -0.2773261f, -0.1037670f, -0.1871461f, -0.3765379f, +0.3469561f, +0.5075851f,
  -0.3144472f, +0.1419543f, -0.0540817f, -0.1226421f, -0.1740015f, +0.2484914f, +0.1892081f, +0.1589469f,
  -0.1575727f, -0.0769476f, -0.0793235f, +0.0654978f, +0.1036247f, +0.1236077f, +0.1271421f, -0.1414001f,
  -0.0831175f, +0.4034413f, -0.2735643f, -0.1060502f, +0.1050733f, +0.1607841f, +0.1322397f, -0.0036147f,
  +0.1648729f, -0.0143207f, +0.0387108f, +0.1412610f, -0.0517626f, -0.2674890f, -0.0527002f, +0.0861477f,
  -0.0148903f, +0.0379737f, +0.1429879f, -0.0671892f, +0.0903095f, +0.0744571f, -0.0156311f, +0.0425116f,
  +0.0944425f, -0.1365923f, +0.0463485f, +0.1736049f, +0.3268067f, -0.1418404f, +0.3141006f, -0.0345003f,
  +0.0318606f, +0.2139176f, -0.1054583f, -0.0123484f, +0.0606198f, -0.0387141f, +0.2785438f, -0.3967179f,
  +0.1275239f, +0.1441151f, +0.3007974f, -0.2123789f, +0.0863357f, -0.0235462f, +0.0151990f, -0.0302265f,
  +0.0963861f, +0.0988439f, -0.4539175f, +0.1801601f, -0.2367644f, -0.1165553f, +0.1135138f, +0.0671926f,
  -0.1424026f, -0.1046984f, -0.2650084f, +0.0081685f, +0.0094037f, -0.1427321f, +0.2103954f, -0.1987554f,
  -0.0081194f, +0.0134006f, +0.3822062f, +0.0754352f, -0.0779905f, +0.2160561f, -0.1781837f, +0.4188710f,
  +0.0583758f, +0.0518689f, +0.2367198f, -0.1558205f, +0.0761498f, -0.1000217f, -0.2952355f, +0.0312851f,
  +0.0517427f, +0.0242118f, +0.0055387f, +0.1629694f, -0.0493438f, +0.1275495f, +0.1298719f, +0.1304177f,
  +0.0447818f, -0.0013455f, +0.0904809f, -0.1048748f, +0.1797155f, -0.0209288f, +0.0180374f, -0.2376054f,
  -0.2480391f, -0.0165281f, -0.1474879f, +0.1980947f, -0.1000642f, -0.1100973f, -0.0949734f, -0.0486969f,
  +0.2217298f, +0.3122341f, -0.1688465f, -0.1591547f, +0.0490568f, +0.2114200f, +0.0413206f, -0.0523004f,
  -0.2858931f, +0.0643669f, -0.0614532f, -0.0959907f, +0.0022635f, -0.0018512f, -0.0871956f, +0.3173039f,
  +0.0910419f, -0.0406423f, +0.3498685f, -0.0315901f, -0.0365202f, -0.2237872f, -0.1215719f, +0.0714384f,
  +0.0400746f, +0.0028325f, -0.0406031f, -0.0942245f, -0.1717044f, -0.2651576f, -0.0878328f, -0.3042459f,
  -0.0844873f, -0.0545035f, -0.1416730f, +0.1736203f, -0.0707060f, +0.0388309f, +0.1092976f, +0.0142518f,
  -0.0684522f, +0.0690679f, +0.3425946f, -0.0718136f, +0.3681760f, +0.5277619f, +0.0903685f, -0.1121338f,
  +0.0624935f, +0.0923015f, -0.1348981f, +0.1230648f, -0.2046796f, -0.2725436f, +0.3479382f, +0.1119642f
);

const float biases[4] = float[4](
  +0.0238798f, +0.0269531f, +0.0259081f, +0.0364903f
);

vec4 hook() {
    const vec4 r[9][2] = vec4[9][2](
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 1.0f)))
    );

    float sum[4] = biases;
    for (int n = 0; n < 4; n++) {
        for (int i = 0; i < 9; i++) {
            const vec4 k0 = vec4(kernels[n * 8 * 9 + 8 * i + 0], kernels[n * 8 * 9 + 8 * i + 1], kernels[n * 8 * 9 + 8 * i + 2], kernels[n * 8 * 9 + 8 * i + 3]);
            const vec4 k1 = vec4(kernels[n * 8 * 9 + 8 * i + 4], kernels[n * 8 * 9 + 8 * i + 5], kernels[n * 8 * 9 + 8 * i + 6], kernels[n * 8 * 9 + 8 * i + 7]);
            sum[n] += (dot(k0, r[i][0]) + dot(k1, r[i][1]));
        }
    }

    return ACTIVE(vec4(sum[0], sum[1], sum[2], sum[3]));
}

//!HOOK LUMA
//!DESC ARNet b16 Layer1 L1
//!WHEN OUTPUT.w LUMA.w / 1.2 > OUTPUT.h LUMA.h / 1.2 > *
//!BIND FEAT_L0
//!BIND FEAT_L1
//!SAVE TMP1_L1
//!COMPONENTS 4

#define ACTIVE(v) (max(v, v * 0.2000000f))

#define TEX_BIND_L0_TEXOFF FEAT_L0_texOff
#define TEX_BIND_L0_TEX FEAT_L0_tex
#define TEX_BIND_L0_POS FEAT_L0_pos
#define TEX_BIND_L0_SIZE FEAT_L0_size
#define TEX_BIND_L0_PT FEAT_L0_pt

#define TEX_BIND_L1_TEXOFF FEAT_L1_texOff
#define TEX_BIND_L1_TEX FEAT_L1_tex
#define TEX_BIND_L1_POS FEAT_L1_pos
#define TEX_BIND_L1_SIZE FEAT_L1_size
#define TEX_BIND_L1_PT FEAT_L1_pt

const float kernels[288] = float[288](
  +0.0621366f, +0.0614410f, +0.0667112f, +0.0693677f, +0.2676500f, +0.1725893f, +0.1945626f, -0.1236727f,
  +0.2061089f, +0.0059480f, +0.4849483f, -0.2156953f, -0.0727890f, -0.3132210f, -0.1879525f, +0.3323288f,
  +0.0965016f, +0.1206535f, +0.1015862f, -0.1821457f, +0.0972552f, +0.2540419f, -0.1223003f, +0.0020845f,
  +0.0436378f, +0.0982322f, +0.2323107f, -0.0734651f, +0.0770262f, +0.1619911f, +0.1619690f, +0.5936470f,
  -0.0731305f, +0.0647606f, -0.2394609f, +0.1403873f, -0.0799810f, +0.2884996f, -0.0082611f, -0.0035799f,
  +0.0091302f, -0.0312639f, +0.5825996f, -0.2108662f, -0.0542329f, -0.2539217f, +0.2895121f, -0.3473187f,
  +0.2441336f, +0.2414533f, +0.4877058f, -0.0777202f, +0.3032038f, +0.0497484f, -0.2455315f, -0.0415388f,
  -0.3126419f, +0.2675315f, +0.8730738f, -0.1505306f, -0.0349257f, +0.0925712f, +0.1680945f, +0.0363702f,
  +0.1266293f, -0.2352420f, +0.3046297f, +0.0016795f, -0.1899410f, +0.2248677f, +0.0378837f, -0.1096574f,
  -0.3254653f, +0.1088099f, -0.0534450f, -0.1587551f, +0.0642793f, +0.1012834f, -0.2816997f, -0.5692792f,
  +0.2157246f, +0.0957465f, -0.5085564f, +0.1141904f, +0.0636845f, -0.0935073f, -0.0417678f, -0.2615786f,
  -0.1106097f, +0.3736843f, -0.1885972f, -0.0285377f, +0.1320352f, +0.0143028f, +0.1526702f, -0.2038100f,
  +0.0289713f, -0.3021916f, -0.1140973f, -0.0634983f, +0.2321412f, -0.2985539f, -0.4853843f, +0.0040355f,
  -0.3504018f, +0.0441119f, +0.0904250f, +0.0443904f, +0.3791102f, +0.3091023f, -0.3865535f, -0.2965425f,
  +0.1651796f, -0.3296947f, -0.0258288f, +0.1709529f, -0.0134063f, +0.0946779f, +0.0231611f, +0.3966580f,
  +0.1155036f, -0.2625641f, -0.6170448f, +0.0577299f, -0.2294789f, -0.4018424f, +0.0681799f, +0.1745534f,
  -0.0446605f, -0.3392507f, +0.0549804f, -0.0165486f, +0.1530755f, +0.1462743f, -0.0241357f, -0.4402637f,
  -0.1432527f, -0.1180450f, +0.0975470f, -0.2100585f, +0.1286029f, +0.2919279f, -0.0643149f, +0.1371749f,
  -0.0439577f, +0.0710668f, +0.0300664f, +0.0204786f, -0.1637335f, +0.0340793f, -0.0073653f, -0.0721671f,
  -0.0197769f, -0.1426703f, -0.0107074f, +0.0986382f, -0.3206251f, -0.2295968f, -0.2494935f, -0.1960040f,
  +0.1045195f, +0.2785051f, -0.0246885f, -0.3443747f, +0.1042989f, +0.2077507f, -0.1117563f, -0.2862032f,
  +0.0926067f, -0.2057329f, +0.1878650f, -0.0679612f, +0.2991543f, -0.1545459f, -0.1281721f, +0.6797854f,
  -0.2702439f, +0.0790967f, +0.0803131f, +0.0928886f, -0.3897232f, -0.2379721f, -0.0144256f, +0.5475894f,
  -0.4520481f, -0.2678688f, -0.0942938f, +0.2092325f, -0.3606592f, -0.3847556f, +0.1764128f, +0.0315630f,
  -0.2048987f, -0.2959896f, -0.3429744f, +0.0454782f, +0.1298796f, +0.1809286f, +0.1433777f, -0.0647919f,
  -0.0581003f, -0.4588653f, +0.2562975f, -0.4109298f, -0.1221699f, +0.2455936f, -0.1505740f, -0.7489576f,
  +0.2644073f, +0.0346287f, -0.2608265f, -0.0720115f, +0.1739054f, +0.1396371f, -0.1247090f, -0.2137701f,
  +0.1564403f, +0.2599201f, +0.1146627f, -0.0488907f, -0.1304675f, -0.2864828f, +0.0230620f, -0.1920877f,
  +0.1387812f, +0.1111688f, +0.2385245f, -0.2497059f, +0.1644684f, -0.0395211f, -0.1895261f, +0.0298853f,
  +0.0492731f, +0.0766403f, -0.0213133f, -0.0669681f, -0.0759417f, +0.0489346f, -0.0169713f, -0.2689714f,
  -0.3256120f, +0.0017350f, -0.1849870f, -0.0493620f, -0.2899984f, -0.0205225f, -0.0280832f, +0.3360681f,
  +0.0611414f, -0.1155834f, +0.0135250f, -0.2101506f, +0.0720274f, -0.1378303f, +0.2270516f, -0.0685673f,
  -0.0801967f, +0.1581875f, +0.3082264f, -0.3365593f, +0.0239770f, -0.0896640f, -0.1457918f, -0.1374744f,
  +0.0758250f, +0.0901836f, -0.0769740f, +0.2266627f, -0.0524638f, -0.0432588f, +0.2176196f, +0.1605185f,
  +0.0349720f, +0.1605830f, -0.0614974f, -0.0414089f, -0.0042541f, -0.1752918f, +0.1835383f, -0.1163076f,
  -0.0660521f, -0.2087336f, -0.3287232f, +0.1085739f, -0.1234744f, +0.0822019f, +0.1916721f, -0.2396530f
);

const float biases[4] = float[4](
  -0.7645376f, -0.3084048f, -0.0027068f, +0.0670374f
);

vec4 hook() {
    const vec4 r[9][2] = vec4[9][2](
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 1.0f)))
    );

    float sum[4] = biases;
    for (int n = 0; n < 4; n++) {
        for (int i = 0; i < 9; i++) {
            const vec4 k0 = vec4(kernels[n * 8 * 9 + 8 * i + 0], kernels[n * 8 * 9 + 8 * i + 1], kernels[n * 8 * 9 + 8 * i + 2], kernels[n * 8 * 9 + 8 * i + 3]);
            const vec4 k1 = vec4(kernels[n * 8 * 9 + 8 * i + 4], kernels[n * 8 * 9 + 8 * i + 5], kernels[n * 8 * 9 + 8 * i + 6], kernels[n * 8 * 9 + 8 * i + 7]);
            sum[n] += (dot(k0, r[i][0]) + dot(k1, r[i][1]));
        }
    }

    return ACTIVE(vec4(sum[0], sum[1], sum[2], sum[3]));
}

//!HOOK LUMA
//!DESC ARNet b16 Layer2 L0
//!WHEN OUTPUT.w LUMA.w / 1.2 > OUTPUT.h LUMA.h / 1.2 > *
//!BIND TMP1_L0
//!BIND TMP1_L1
//!BIND FEAT_L0
//!SAVE TMP2_L0
//!COMPONENTS 4

#define ACTIVE(v) (v)

#define TEX_BIND_L0_TEXOFF TMP1_L0_texOff
#define TEX_BIND_L0_TEX TMP1_L0_tex
#define TEX_BIND_L0_POS TMP1_L0_pos
#define TEX_BIND_L0_SIZE TMP1_L0_size
#define TEX_BIND_L0_PT TMP1_L0_pt

#define TEX_BIND_L1_TEXOFF TMP1_L1_texOff
#define TEX_BIND_L1_TEX TMP1_L1_tex
#define TEX_BIND_L1_POS TMP1_L1_pos
#define TEX_BIND_L1_SIZE TMP1_L1_size
#define TEX_BIND_L1_PT TMP1_L1_pt

#define TEX_BIND_L2_TEXOFF FEAT_L0_texOff
#define TEX_BIND_L2_TEX FEAT_L0_tex
#define TEX_BIND_L2_POS FEAT_L0_pos
#define TEX_BIND_L2_SIZE FEAT_L0_size
#define TEX_BIND_L2_PT FEAT_L0_pt

const float kernels[288] = float[288](
  +0.1956875f, +0.2410383f, +0.1042877f, -0.1573859f, -0.4024817f, -0.0896797f, +0.1218049f, -0.2463240f,
  -0.1423660f, +0.3260997f, +0.2984968f, -0.1369677f, -0.3725291f, +0.0395497f, +0.6675822f, -0.1411437f,
  +0.0308691f, +0.1346432f, +0.2145986f, +0.1379934f, -0.2601914f, -0.1984062f, -0.3396601f, +0.1878272f,
  -0.0945716f, +0.2201780f, -0.1172453f, -0.0144821f, +0.2635410f, +0.0410575f, +0.2306251f, -0.0943975f,
  -0.0802146f, +0.2585228f, -0.6573071f, +0.0678538f, +1.1183497f, +0.1006685f, +0.2750718f, -0.0171937f,
  +0.1996033f, -0.3424793f, -0.0512751f, +0.1820772f, +0.3572741f, +0.3481730f, -0.3439274f, -0.1201190f,
  +0.4480847f, -0.2299272f, +0.0304404f, -0.2876740f, -0.1371367f, +0.6198854f, +0.1090874f, -0.0830342f,
  -0.2449248f, +0.0366135f, -0.0776701f, +0.2929759f, +1.0309784f, -0.2930917f, +0.1022186f, -0.1395669f,
  -0.2191503f, -0.1697468f, -0.3190646f, -0.1476513f, +0.2127525f, +0.2796739f, -0.0689578f, -0.0560556f,
  -0.0947489f, -0.1950804f, -0.1557278f, -0.1438254f, +0.1816939f, +0.1116549f, -0.2888137f, -0.0102075f,
  +0.2677064f, -0.4388933f, -0.2478170f, -0.0546047f, -0.1281179f, -0.3216152f, -1.0224652f, +0.4863388f,
  +0.0754026f, -0.6541278f, -0.0529000f, +0.0910264f, -0.0592728f, +0.1929347f, +0.3258432f, -0.2424556f,
  -0.1921303f, +0.2869559f, -0.0463260f, -0.1027824f, +0.3377390f, +0.1415422f, +0.1972407f, +0.2728231f,
  -0.1881265f, +0.1321210f, -0.0391600f, -0.3321626f, +0.0477167f, -0.3323679f, +0.3103468f, +0.1740354f,
  -0.6497939f, -0.1332414f, -0.0727526f, +0.0665683f, +0.3305630f, +0.7563040f, +0.3497002f, -0.3368200f,
  +0.2139749f, -0.0455072f, -0.0435747f, -0.0056890f, -0.0984315f, -0.2337058f, -0.0258751f, -0.0479200f,
  +0.1234253f, -0.0934327f, -0.0818235f, -0.2953905f, +0.0310444f, +0.3234704f, +0.0856342f, +0.2195546f,
  +0.1037791f, -0.1870973f, -0.1231622f, -0.0416855f, +0.0146762f, +0.1307054f, -0.0154904f, -0.1309260f,
  -0.1899096f, -0.2140470f, -0.2539700f, -0.0768063f, +0.1105713f, -0.2063159f, +0.0401992f, +0.0500062f,
  +0.0500602f, +0.1168672f, -0.1233362f, +0.1192882f, +0.0584899f, +0.1742238f, -0.1457893f, -0.0134697f,
  +0.0080146f, -0.0655314f, -0.1250326f, +0.1158374f, +0.2054247f, +0.1622867f, +0.1072818f, -0.1571226f,
  -0.0054589f, -0.0413179f, -0.0653134f, +0.0115156f, +0.0049334f, +0.2025521f, -0.2956243f, +0.2822872f,
  +0.3537456f, +0.0210493f, -0.5838624f, -0.3586740f, -0.3360741f, -0.1630804f, -0.3997718f, +0.2821571f,
  -0.1849636f, -0.3064083f, -0.0097115f, -0.1187277f, +0.5009184f, -0.1192599f, +0.0915116f, +0.0427908f,
  -0.1653831f, +0.2216954f, +0.1464103f, -0.1419438f, +0.1994129f, +0.3143886f, -0.0932201f, -0.1398942f,
  -0.1946146f, -0.0011266f, +0.1910432f, -0.2160527f, -0.1146002f, +0.0940870f, -0.0790257f, +0.1038640f,
  -0.0265889f, -0.0064186f, +0.2432245f, +0.0148572f, +0.1365669f, -0.0281017f, -0.0079995f, +0.2313450f,
  +0.1456147f, +0.3072373f, +0.2516670f, -0.1960333f, -0.1088665f, +0.0130259f, +0.1217578f, +0.1570077f,
  +0.0703821f, -0.0183878f, -0.0640362f, -0.0221461f, +0.0549962f, -0.2128308f, +0.1057140f, +0.0423490f,
  +0.0777052f, -0.3360049f, -0.2167870f, -0.0156095f, -0.3041913f, -0.0139442f, -0.4301007f, -0.1161215f,
  -0.2355696f, -0.1057774f, +0.0968411f, -0.0834284f, -0.5163125f, +0.0984340f, -0.4384075f, +0.0913711f,
  -0.1028872f, +0.3530416f, -0.0208065f, -0.0022840f, +0.1520301f, -0.5974511f, -0.4253375f, +0.4771287f,
  -0.2666912f, -0.0012460f, +0.1844320f, +0.1022858f, -0.3425675f, -0.1836534f, +0.2611769f, -0.0679907f,
  +0.0855802f, +0.1688935f, -0.0567158f, -0.1837947f, +0.0008843f, -0.1360183f, -0.0411202f, +0.2267016f,
  +0.0091971f, -0.1877287f, +0.0323855f, -0.0203585f, -0.0501164f, -0.3231666f, -0.1400492f, +0.0493143f,
  +0.0709870f, -0.1864752f, -0.0126049f, -0.0054668f, +0.0313751f, -0.2903574f, -0.0051896f, -0.4289071f
);

const float biases[4] = float[4](
  +0.2228143f, +0.0756199f, +0.1598111f, -0.1703274f
);

vec4 hook() {
    const vec4 r[9][2] = vec4[9][2](
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 1.0f)))
    );

    float sum[4] = biases;
    for (int n = 0; n < 4; n++) {
        for (int i = 0; i < 9; i++) {
            const vec4 k0 = vec4(kernels[n * 8 * 9 + 8 * i + 0], kernels[n * 8 * 9 + 8 * i + 1], kernels[n * 8 * 9 + 8 * i + 2], kernels[n * 8 * 9 + 8 * i + 3]);
            const vec4 k1 = vec4(kernels[n * 8 * 9 + 8 * i + 4], kernels[n * 8 * 9 + 8 * i + 5], kernels[n * 8 * 9 + 8 * i + 6], kernels[n * 8 * 9 + 8 * i + 7]);
            sum[n] += (dot(k0, r[i][0]) + dot(k1, r[i][1]));
        }
    }

    return ACTIVE(vec4(sum[0], sum[1], sum[2], sum[3]) * 0.2000000f + TEX_BIND_L2_TEXOFF(vec2(0.0f, 0.0f)));
}

//!HOOK LUMA
//!DESC ARNet b16 Layer2 L1
//!WHEN OUTPUT.w LUMA.w / 1.2 > OUTPUT.h LUMA.h / 1.2 > *
//!BIND TMP1_L0
//!BIND TMP1_L1
//!BIND FEAT_L1
//!SAVE TMP2_L1
//!COMPONENTS 4

#define ACTIVE(v) (v)

#define TEX_BIND_L0_TEXOFF TMP1_L0_texOff
#define TEX_BIND_L0_TEX TMP1_L0_tex
#define TEX_BIND_L0_POS TMP1_L0_pos
#define TEX_BIND_L0_SIZE TMP1_L0_size
#define TEX_BIND_L0_PT TMP1_L0_pt

#define TEX_BIND_L1_TEXOFF TMP1_L1_texOff
#define TEX_BIND_L1_TEX TMP1_L1_tex
#define TEX_BIND_L1_POS TMP1_L1_pos
#define TEX_BIND_L1_SIZE TMP1_L1_size
#define TEX_BIND_L1_PT TMP1_L1_pt

#define TEX_BIND_L2_TEXOFF FEAT_L1_texOff
#define TEX_BIND_L2_TEX FEAT_L1_tex
#define TEX_BIND_L2_POS FEAT_L1_pos
#define TEX_BIND_L2_SIZE FEAT_L1_size
#define TEX_BIND_L2_PT FEAT_L1_pt

const float kernels[288] = float[288](
  -0.2359694f, +0.1611496f, +0.1499720f, +0.1358192f, -0.0501135f, -0.1629159f, -0.1966764f, +0.0817946f,
  +0.1510614f, +0.2669953f, -0.0267739f, -0.2286024f, -0.2682342f, -0.3462053f, +0.2093166f, +0.2126163f,
  +0.0847359f, +0.0132670f, +0.0569325f, +0.0102693f, +0.0895453f, +0.1253456f, -0.4042454f, +0.2230260f,
  +0.0688796f, +0.1490610f, +0.0144023f, +0.3239132f, -0.1800873f, -0.0390104f, +0.0123451f, +0.3292049f,
  -0.3908854f, +0.1858305f, +0.1764248f, +0.0497545f, -0.0246116f, +0.0426342f, -0.2287606f, -0.1515706f,
  +0.1929817f, -0.1004288f, -0.1728832f, -0.3209077f, +0.0808103f, -0.2474259f, -0.2263289f, +0.2838755f,
  -0.0387100f, +0.0632307f, +0.0599491f, +0.3025809f, -0.2122702f, -0.4831620f, +0.0670543f, +0.1011105f,
  +0.3284789f, +0.3106225f, +0.0890754f, -0.0115699f, -0.1534912f, +0.2482138f, -0.0100151f, +0.1677761f,
  -0.0288299f, -0.0399785f, +0.0376473f, +0.1601662f, +0.2387358f, -0.1755473f, +0.0216774f, +0.0274544f,
  -0.1516525f, -0.0806177f, -0.2154665f, -0.1386429f, +0.0365248f, -0.1270927f, -0.0074583f, -0.1515355f,
  +0.1003661f, -0.1863081f, +0.0630244f, -0.0383386f, +0.1387924f, +0.3387823f, -0.1945027f, +0.1209403f,
  -0.0897338f, +0.0913700f, -0.1019027f, +0.0093651f, +0.0747028f, +0.2853491f, +0.0805735f, -0.2602483f,
  -0.0826141f, +0.1984179f, +0.0003416f, +0.0788878f, +0.2028607f, +0.0574052f, +0.4274925f, -0.0031573f,
  -0.1903391f, -0.3983389f, -0.0423793f, -0.0682694f, -0.3515120f, -0.2635078f, +0.3738194f, -0.0665326f,
  -0.0942057f, -0.1038996f, -0.0408960f, -0.0164765f, -0.5463721f, +0.0443450f, +0.2136034f, -0.0961700f,
  +0.1545079f, +0.0078113f, -0.0106648f, +0.0847636f, -0.0323711f, +0.3781809f, +0.0249932f, -0.0629552f,
  +0.1191609f, +0.3732074f, +0.1116081f, -0.0007946f, +0.0913696f, +0.2265495f, +0.0920684f, +0.0405695f,
  +0.1337606f, -0.0450458f, +0.0071459f, +0.1407034f, -0.2016113f, -0.1368928f, +0.0024812f, +0.2778316f,
  +0.1834306f, -0.1991491f, -0.0856908f, -0.1216842f, +0.2950139f, +0.2831930f, +0.0954946f, -0.0156828f,
  -0.1241381f, +0.2864189f, +0.0757373f, +0.0036106f, -0.0311185f, +0.2613249f, +0.1166006f, -0.4057059f,
  +0.1030457f, -0.0030797f, +0.1944507f, +0.0264886f, +0.0136981f, +0.0200547f, +0.0124264f, +0.0738658f,
  +0.1412462f, -0.2548206f, -0.0094072f, +0.0738328f, +0.2277840f, +0.1358616f, +0.0360199f, -0.3650093f,
  -0.0958402f, -0.1253043f, +0.1238929f, -0.1335688f, -0.4447326f, -0.2296980f, -0.0799857f, -0.2057490f,
  +0.1765195f, -0.3080936f, +0.0644977f, -0.0809292f, -0.1199791f, -0.0798059f, -0.2901236f, +0.0295468f,
  +0.0399039f, +0.0386514f, -0.0848128f, +0.2497531f, +0.1927363f, +0.0372619f, +0.0281217f, -0.2708885f,
  -0.1043682f, +0.0834149f, -0.0857920f, +0.4262072f, +0.2021928f, +0.0682584f, +0.0312062f, -0.3502570f,
  -0.1944621f, +0.0489909f, +0.2487523f, -0.1834669f, -0.0566824f, +0.1299920f, -0.0217155f, +0.3235006f,
  -0.0901815f, -0.1375981f, +0.0606583f, -0.0313056f, +0.0314587f, +0.1787832f, -0.2220711f, +0.1170385f,
  +0.2468108f, -0.2616846f, -0.3250708f, -0.0773367f, -0.0012867f, +0.0526663f, -0.0076876f, +0.0037914f,
  +0.1598403f, -0.1242672f, -0.0333309f, +0.1305211f, -0.0647299f, +0.2921405f, -0.2190143f, -0.1552779f,
  -0.3904816f, +0.2357298f, +0.0344853f, -0.1213882f, -0.1390792f, -0.3657128f, -0.1557098f, +0.1055980f,
  -0.1559199f, +0.0381727f, -0.1267711f, -0.0395029f, +0.1749886f, -0.3932703f, -0.2414745f, +0.1643143f,
  +0.0183555f, -0.3208516f, -0.2991961f, -0.2159810f, +0.1208231f, -0.4299766f, -0.4022555f, -0.0021040f,
  +0.0154163f, +0.0150447f, -0.0153185f, +0.3254818f, -0.3627130f, +0.0646422f, +0.0342706f, +0.0497339f,
  +0.0019247f, +0.0701375f, +0.2173566f, -0.0870095f, -0.0677214f, +0.0050723f, -0.0394592f, +0.0194627f,
  +0.0244825f, +0.1618190f, +0.0407842f, +0.0662231f, +0.2644389f, -0.4153986f, -0.0868661f, +0.1657376f
);

const float biases[4] = float[4](
  +0.0518261f, +0.0589239f, -0.0438095f, -0.1105846f
);

vec4 hook() {
    const vec4 r[9][2] = vec4[9][2](
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 1.0f)))
    );

    float sum[4] = biases;
    for (int n = 0; n < 4; n++) {
        for (int i = 0; i < 9; i++) {
            const vec4 k0 = vec4(kernels[n * 8 * 9 + 8 * i + 0], kernels[n * 8 * 9 + 8 * i + 1], kernels[n * 8 * 9 + 8 * i + 2], kernels[n * 8 * 9 + 8 * i + 3]);
            const vec4 k1 = vec4(kernels[n * 8 * 9 + 8 * i + 4], kernels[n * 8 * 9 + 8 * i + 5], kernels[n * 8 * 9 + 8 * i + 6], kernels[n * 8 * 9 + 8 * i + 7]);
            sum[n] += (dot(k0, r[i][0]) + dot(k1, r[i][1]));
        }
    }

    return ACTIVE(vec4(sum[0], sum[1], sum[2], sum[3]) * 0.2000000f + TEX_BIND_L2_TEXOFF(vec2(0.0f, 0.0f)));
}

//!HOOK LUMA
//!DESC ARNet b16 Layer3 L0
//!WHEN OUTPUT.w LUMA.w / 1.2 > OUTPUT.h LUMA.h / 1.2 > *
//!BIND TMP2_L0
//!BIND TMP2_L1
//!SAVE TMP1_L0
//!COMPONENTS 4

#define ACTIVE(v) (max(v, v * 0.2000000f))

#define TEX_BIND_L0_TEXOFF TMP2_L0_texOff
#define TEX_BIND_L0_TEX TMP2_L0_tex
#define TEX_BIND_L0_POS TMP2_L0_pos
#define TEX_BIND_L0_SIZE TMP2_L0_size
#define TEX_BIND_L0_PT TMP2_L0_pt

#define TEX_BIND_L1_TEXOFF TMP2_L1_texOff
#define TEX_BIND_L1_TEX TMP2_L1_tex
#define TEX_BIND_L1_POS TMP2_L1_pos
#define TEX_BIND_L1_SIZE TMP2_L1_size
#define TEX_BIND_L1_PT TMP2_L1_pt

const float kernels[288] = float[288](
  -0.0301245f, +0.0957995f, -0.0471644f, +0.0860751f, -0.1158230f, -0.1025649f, +0.1637068f, -0.2013707f,
  -0.0592754f, -0.0442384f, -0.1304992f, +0.0195172f, -0.0232462f, -0.1347066f, +0.1608739f, -0.2558012f,
  +0.1069546f, +0.1191731f, -0.0474100f, -0.1497949f, +0.0409197f, +0.0848725f, -0.1118315f, -0.4920784f,
  -0.3309300f, -0.1402141f, -0.5421771f, -0.2076546f, -0.0783172f, +0.1944042f, -0.0625729f, -0.3670161f,
  -0.5194904f, +0.0677329f, +0.1996425f, +0.2586277f, +0.1017936f, +0.0759002f, -0.0398537f, +0.2796603f,
  -0.3257534f, -0.2186088f, -0.2161248f, -0.0093345f, -0.1544219f, +0.1153003f, -0.0603377f, +0.4267232f,
  -0.1280036f, -0.2246355f, -0.1142085f, -0.0930714f, +0.0374301f, +0.0350322f, -0.1157309f, -0.2057684f,
  -0.1269184f, -0.1421862f, +0.2125501f, -0.2496592f, +0.3936538f, -0.1356717f, +0.0640516f, -0.5348268f,
  -0.0467239f, +0.0914064f, -0.0741336f, -0.0337493f, +0.0081764f, -0.0068693f, -0.0897042f, -0.0919351f,
  -0.0052590f, -0.0892874f, -0.3251304f, -0.1506445f, +0.2881460f, +0.0805884f, +0.0457680f, -0.3191756f,
  -0.0401767f, -0.0127409f, -0.0117949f, -0.0606486f, -0.0767374f, -0.0934793f, +0.0249481f, -0.0878047f,
  +0.0426981f, -0.0063141f, -0.1965256f, +0.0652866f, -0.0162539f, +0.0545861f, -0.0538501f, -0.0110521f,
  +0.1655954f, +0.0196942f, -0.4067742f, +0.0247659f, -0.1561223f, -0.5282542f, +0.2149420f, -0.0364986f,
  -0.0951036f, -0.2143710f, +0.2663407f, +0.0535952f, +0.1000319f, -0.0952474f, +0.4160504f, +0.1657197f,
  -0.0625436f, +0.0745677f, +0.2432684f, +0.0099091f, +0.0251309f, -0.0736463f, +0.1169388f, -0.0654076f,
  +0.4171911f, +0.1048264f, +0.3896727f, -0.2756749f, -0.0471874f, -0.2911050f, -0.1913057f, -0.5639937f,
  -0.0176525f, -0.0295759f, -0.3216414f, +0.1538685f, +0.2954817f, -0.0585095f, -0.0033330f, -0.4515359f,
  -0.0490400f, +0.0283659f, -0.1903465f, +0.0654954f, +0.0133347f, -0.0917884f, +0.0659820f, +0.0994039f,
  -0.4127732f, +0.1142880f, +0.1882074f, -0.2262345f, -0.0558113f, +0.1124747f, -0.0539495f, +0.2554838f,
  -0.1809097f, +0.0474784f, +0.1945213f, -0.2931923f, -0.0732426f, -0.1870018f, +0.0826947f, +0.2138944f,
  -0.0373311f, -0.0905536f, +0.0784710f, -0.1613784f, -0.0144172f, -0.1456096f, -0.1799623f, +0.0587249f,
  -0.0806960f, +0.1900413f, +0.0262733f, +0.0255019f, +0.1112293f, -0.1239729f, -0.2133499f, +0.1694547f,
  -0.4593849f, +0.0138048f, -0.0570118f, -0.2023260f, -0.0291155f, +0.0758752f, -0.0716426f, -0.1952417f,
  -0.1604239f, +0.1263803f, +0.1396565f, -0.2122980f, -0.0089766f, -0.0811288f, -0.0612723f, -0.1474699f,
  -0.0599360f, -0.1859157f, +0.3054461f, -0.1247843f, +0.1055378f, +0.0094469f, +0.1839409f, +0.0453832f,
  +0.0906250f, +0.2401011f, -0.2598297f, -0.0493777f, -0.2613726f, +0.0088268f, -0.4896670f, +0.3549778f,
  -0.1659222f, -0.2514318f, -0.0465438f, +0.0135230f, -0.0197839f, -0.2379837f, +0.0318860f, -0.3645971f,
  -0.0069954f, +0.0822005f, +0.1738928f, +0.1685295f, -0.0808998f, -0.3101166f, +0.1118722f, +0.6374518f,
  +0.2523975f, -0.0049375f, -0.0521127f, +0.3172934f, -0.0276257f, -0.1732710f, +0.1042128f, -0.0935927f,
  +0.1841810f, +0.1690910f, +0.0987243f, -0.0217532f, -0.0013789f, +0.0601953f, +0.0764966f, -0.0673675f,
  -0.1293408f, -0.1020920f, +0.1398913f, -0.2340970f, +0.0088628f, +0.2508653f, -0.1799904f, -0.4149099f,
  +0.1019239f, +0.2237277f, +0.0453950f, -0.4533257f, +0.4609859f, +0.3105615f, -0.8462875f, -0.1961656f,
  +0.2293351f, -0.0444895f, -0.9663506f, +0.0815613f, +0.4282764f, +0.5582680f, +0.0814982f, -0.2544499f,
  -0.2836775f, -0.1057700f, -0.1703934f, +0.1528563f, -0.3476916f, +0.1067278f, -0.0252908f, +0.1910120f,
  -0.0176365f, -0.0295079f, -0.0191350f, -0.0088789f, -0.2186108f, +0.2616669f, +0.3963249f, +0.5119076f,
  +0.0366006f, +0.3258915f, +0.5355977f, -0.1827618f, +0.1913261f, +0.0009957f, -0.1630350f, +0.2544090f
);

const float biases[4] = float[4](
  +0.1828594f, +0.0685129f, +0.0341266f, -0.0365278f
);

vec4 hook() {
    const vec4 r[9][2] = vec4[9][2](
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 1.0f)))
    );

    float sum[4] = biases;
    for (int n = 0; n < 4; n++) {
        for (int i = 0; i < 9; i++) {
            const vec4 k0 = vec4(kernels[n * 8 * 9 + 8 * i + 0], kernels[n * 8 * 9 + 8 * i + 1], kernels[n * 8 * 9 + 8 * i + 2], kernels[n * 8 * 9 + 8 * i + 3]);
            const vec4 k1 = vec4(kernels[n * 8 * 9 + 8 * i + 4], kernels[n * 8 * 9 + 8 * i + 5], kernels[n * 8 * 9 + 8 * i + 6], kernels[n * 8 * 9 + 8 * i + 7]);
            sum[n] += (dot(k0, r[i][0]) + dot(k1, r[i][1]));
        }
    }

    return ACTIVE(vec4(sum[0], sum[1], sum[2], sum[3]));
}

//!HOOK LUMA
//!DESC ARNet b16 Layer3 L1
//!WHEN OUTPUT.w LUMA.w / 1.2 > OUTPUT.h LUMA.h / 1.2 > *
//!BIND TMP2_L0
//!BIND TMP2_L1
//!SAVE TMP1_L1
//!COMPONENTS 4

#define ACTIVE(v) (max(v, v * 0.2000000f))

#define TEX_BIND_L0_TEXOFF TMP2_L0_texOff
#define TEX_BIND_L0_TEX TMP2_L0_tex
#define TEX_BIND_L0_POS TMP2_L0_pos
#define TEX_BIND_L0_SIZE TMP2_L0_size
#define TEX_BIND_L0_PT TMP2_L0_pt

#define TEX_BIND_L1_TEXOFF TMP2_L1_texOff
#define TEX_BIND_L1_TEX TMP2_L1_tex
#define TEX_BIND_L1_POS TMP2_L1_pos
#define TEX_BIND_L1_SIZE TMP2_L1_size
#define TEX_BIND_L1_PT TMP2_L1_pt

const float kernels[288] = float[288](
  +0.2338980f, +0.0947823f, -0.0091632f, +0.0901634f, +0.1972454f, -0.0168411f, +0.3740198f, -0.1029255f,
  +0.2008753f, +0.0599450f, +0.0841976f, +0.1255947f, +0.0256816f, +0.0347045f, +0.4623612f, -0.1039067f,
  -0.2396054f, -0.1890645f, +0.3067156f, -0.0815282f, +0.0013621f, -0.0675563f, -0.0386272f, -0.7340678f,
  +0.1523633f, +0.1853455f, +0.0865548f, +0.0712503f, -0.1608064f, -0.1823196f, +0.0590995f, +0.0189130f,
  -0.2375941f, +0.4767716f, +0.5527018f, -0.0509906f, +0.2083657f, +0.1123904f, -0.0853351f, +0.1167812f,
  -0.0490105f, +0.1332684f, +0.5321273f, +0.0506636f, -0.1783050f, -0.1643290f, +0.2411595f, +0.0376816f,
  +0.0582644f, +0.1759302f, -0.1667212f, +0.1296165f, +0.1936254f, -0.1420207f, +0.3386281f, +0.1154194f,
  +0.1254172f, +0.1584359f, -0.1620495f, +0.1558106f, +0.1598649f, +0.1805975f, +0.1286707f, +0.0282685f,
  -0.2003594f, -0.2028746f, -0.1676857f, +0.0429032f, -0.1746970f, +0.1440539f, -0.1252292f, +0.1719579f,
  -0.1228965f, +0.0308828f, -0.0626877f, +0.0588949f, +0.0128779f, +0.0728117f, +0.1843004f, +0.2074978f,
  +0.0228343f, +0.1324725f, -0.2608029f, +0.3229809f, -0.3059945f, -0.1374010f, +0.0764952f, +0.1723411f,
  +0.0193331f, -0.0740763f, +0.1009267f, +0.3050404f, -0.3344209f, -0.3841944f, +0.1824888f, +0.2242472f,
  +0.2565082f, +0.2174460f, +0.0511650f, +0.0824479f, -0.4321581f, -0.0485743f, +0.1629073f, -0.0666596f,
  +0.3782159f, +0.2671081f, -0.2390794f, +0.1091039f, -0.3053712f, +0.2472668f, +0.1713494f, +0.0590937f,
  +0.1206795f, -0.1504669f, -0.6839743f, -0.0019448f, -0.0938039f, +0.1020651f, -0.1287271f, +0.2039192f,
  +0.0203189f, -0.1303749f, -0.1628357f, +0.0419339f, -0.1527039f, -0.1095891f, -0.3038031f, +0.0382997f,
  +0.1566969f, -0.1263359f, +0.0779632f, +0.1188031f, -0.1483388f, +0.0216576f, -0.1643804f, +0.0768592f,
  -0.0337189f, -0.1384305f, +0.0225611f, -0.1148421f, -0.1553183f, +0.0680604f, +0.0389408f, -0.0366953f,
  +0.2577679f, +0.0923537f, -0.0676332f, +0.0321731f, -0.2481350f, -0.1844255f, -0.1743599f, +0.3407694f,
  -0.3338061f, -0.2474090f, -0.1697912f, +0.1546031f, -0.0313242f, -0.4269153f, +0.1847794f, +0.4059091f,
  -0.0138963f, +0.0129614f, -0.2506422f, -0.1509808f, +0.2296283f, +0.3239863f, -0.2566574f, -0.0162374f,
  +0.3251830f, -0.2196946f, +0.2929380f, -0.1563112f, -0.0543190f, +0.1603495f, -0.4625250f, -0.3208532f,
  -0.4748683f, +0.4148380f, +0.3062426f, -0.1945292f, -0.1383047f, -0.0722689f, +0.4343819f, +0.1001353f,
  -0.3007985f, -0.0886307f, -1.1058573f, +0.4058596f, +0.2028530f, -0.1901451f, +0.1821779f, -0.1368650f,
  -0.2258834f, +0.0312451f, +0.0181756f, -0.0758750f, -0.1498741f, +0.2047871f, -0.1998348f, +0.4431835f,
  +0.6076881f, +0.1156944f, +1.0479336f, +0.0699567f, +0.0890951f, -0.0423215f, -0.4687910f, -0.1426213f,
  -0.1306023f, +0.0076197f, +0.1109703f, -0.0067426f, +0.1271979f, -0.3684195f, +0.2501869f, -0.3444540f,
  +0.2716173f, +0.2025840f, +0.2901658f, -0.0384827f, -0.1513897f, -0.2589471f, -0.1002020f, -0.2293296f,
  -0.1178595f, +0.1684663f, +0.0450847f, +0.3108535f, -0.2185652f, -0.0350598f, +0.4121425f, -0.0855118f,
  +0.1664959f, +0.1295126f, -0.3393957f, +0.1888341f, -0.1919486f, -0.0242335f, +0.0716970f, +0.0078651f,
  +0.2268952f, -0.1815882f, -0.0465016f, +0.0120921f, +0.2587167f, +0.1456674f, +0.1905493f, -0.0173804f,
  -0.0108794f, -0.0735676f, +0.2143980f, -0.1475760f, +0.1729017f, +0.3733434f, -0.2079027f, +0.0661327f,
  -0.1894417f, +0.0813939f, +0.4941677f, -0.1234737f, -0.0215741f, -0.0055323f, +0.3109188f, +0.2736157f,
  -0.1485024f, -0.1363623f, -0.4239306f, +0.1112216f, +0.1031650f, -0.1014999f, +0.0322508f, -0.0049521f,
  +0.0052417f, -0.2670091f, -0.9920465f, -0.1440657f, +0.2606854f, -0.0703055f, +0.1144408f, -0.5119726f,
  -0.0399488f, +0.1790336f, -0.3695526f, -0.2428717f, +0.1898389f, -0.0239886f, -0.0160844f, -0.5232122f
);

const float biases[4] = float[4](
  +0.1123487f, +0.0484835f, -0.0653999f, +0.0306432f
);

vec4 hook() {
    const vec4 r[9][2] = vec4[9][2](
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 1.0f)))
    );

    float sum[4] = biases;
    for (int n = 0; n < 4; n++) {
        for (int i = 0; i < 9; i++) {
            const vec4 k0 = vec4(kernels[n * 8 * 9 + 8 * i + 0], kernels[n * 8 * 9 + 8 * i + 1], kernels[n * 8 * 9 + 8 * i + 2], kernels[n * 8 * 9 + 8 * i + 3]);
            const vec4 k1 = vec4(kernels[n * 8 * 9 + 8 * i + 4], kernels[n * 8 * 9 + 8 * i + 5], kernels[n * 8 * 9 + 8 * i + 6], kernels[n * 8 * 9 + 8 * i + 7]);
            sum[n] += (dot(k0, r[i][0]) + dot(k1, r[i][1]));
        }
    }

    return ACTIVE(vec4(sum[0], sum[1], sum[2], sum[3]));
}

//!HOOK LUMA
//!DESC ARNet b16 Layer4 L0
//!WHEN OUTPUT.w LUMA.w / 1.2 > OUTPUT.h LUMA.h / 1.2 > *
//!BIND TMP1_L0
//!BIND TMP1_L1
//!BIND TMP2_L0
//!SAVE TMP2_L0
//!COMPONENTS 4

#define ACTIVE(v) (v)

#define TEX_BIND_L0_TEXOFF TMP1_L0_texOff
#define TEX_BIND_L0_TEX TMP1_L0_tex
#define TEX_BIND_L0_POS TMP1_L0_pos
#define TEX_BIND_L0_SIZE TMP1_L0_size
#define TEX_BIND_L0_PT TMP1_L0_pt

#define TEX_BIND_L1_TEXOFF TMP1_L1_texOff
#define TEX_BIND_L1_TEX TMP1_L1_tex
#define TEX_BIND_L1_POS TMP1_L1_pos
#define TEX_BIND_L1_SIZE TMP1_L1_size
#define TEX_BIND_L1_PT TMP1_L1_pt

#define TEX_BIND_L2_TEXOFF TMP2_L0_texOff
#define TEX_BIND_L2_TEX TMP2_L0_tex
#define TEX_BIND_L2_POS TMP2_L0_pos
#define TEX_BIND_L2_SIZE TMP2_L0_size
#define TEX_BIND_L2_PT TMP2_L0_pt

const float kernels[288] = float[288](
  -0.0272897f, -0.0074731f, -0.1653667f, -0.1188036f, +0.2219132f, -0.0270644f, -0.1128366f, +0.0801419f,
  +0.1681204f, -0.0952515f, +0.0742649f, -0.6154844f, -0.0967048f, +0.1316154f, +0.3504754f, -0.0291673f,
  +0.0532881f, -0.5953593f, +0.0761225f, -0.3356547f, -0.0881301f, -0.0058457f, -0.1840126f, -0.0122215f,
  +0.0242528f, +0.1471023f, -0.2367117f, -0.0723543f, +0.0312125f, -0.0486467f, -0.1008563f, +0.0425858f,
  +0.4801890f, +0.3314745f, +0.2713161f, -0.1764608f, +0.3656131f, -0.1864988f, -0.7001467f, -0.3193332f,
  +0.0899825f, -0.2442150f, +0.6070177f, -0.1374777f, -0.1308384f, -0.3448107f, -0.3827830f, -0.1121730f,
  +0.2853886f, -0.0250054f, -0.0385422f, -0.0535040f, -0.0542050f, +0.2261974f, +0.0542172f, -0.3976902f,
  +0.1212162f, +0.2716810f, +0.1832823f, +0.4086477f, -0.5690089f, +0.1077856f, +0.0650293f, -0.0840084f,
  +0.2455107f, +0.1591581f, -0.0426573f, +0.2701957f, -0.2254676f, -0.2103587f, -0.1868056f, -0.1279069f,
  +0.0094610f, -0.0372229f, +0.1128036f, -0.2531255f, -0.0327230f, +0.5132777f, -0.0964987f, -0.1753605f,
  +0.0456622f, -0.2137746f, -0.1179255f, +0.0221069f, -0.2922395f, +0.1585519f, -0.4745415f, -0.3608157f,
  +0.3154635f, -0.3561364f, -0.2681385f, -0.0677256f, -0.1269358f, -0.0723491f, -0.2184689f, +0.0093871f,
  -0.1177737f, +0.0155754f, +0.2763609f, -0.1932662f, -0.1877796f, -0.2265592f, -0.2276414f, -0.0269008f,
  -0.4304903f, +0.4306374f, -0.1405873f, -0.5681744f, -0.6248642f, -0.6063425f, -0.0495356f, +0.0037174f,
  +0.1831093f, +0.2149546f, -0.5309957f, +0.1997973f, -0.1298680f, -0.3183238f, -0.1963865f, +0.3518522f,
  +0.1050060f, -0.0762190f, +0.0483636f, +0.0340334f, -0.2245165f, +0.4941301f, -0.2676445f, -0.1089595f,
  -0.0352185f, -0.1031202f, +0.0588713f, -0.3524053f, +0.0338849f, -0.2283249f, -0.3531547f, -0.5243911f,
  -0.1286094f, -0.0095132f, -0.1383733f, -0.0238057f, +0.0105751f, -0.0318411f, -0.2687430f, +0.0877405f,
  +0.1367286f, +0.1092748f, +0.1128063f, +0.2147767f, -0.1819285f, -0.0696819f, +0.3453756f, +0.0612821f,
  -0.1036155f, +0.1135960f, +0.0607422f, +0.7202241f, +0.0476746f, -0.0128463f, +0.2109743f, +0.0333409f,
  +0.1848943f, -0.1509274f, -0.2916105f, +0.4264317f, +0.0752954f, -0.0612306f, -0.0244497f, +0.2018890f,
  -0.0978164f, +0.0400011f, +0.0762212f, +0.3089456f, +0.2385369f, +0.3498729f, +0.3370252f, +0.1915346f,
  -0.0979274f, -0.2214416f, +0.1481912f, +0.3800656f, -0.2386286f, +0.5307126f, -0.2550033f, +0.0779080f,
  +0.3299171f, +0.4440448f, +0.0077228f, +0.1236399f, -0.1808084f, -0.0724483f, -0.2054074f, +0.2781279f,
  +0.2544664f, -0.1237251f, -0.2869641f, +0.0924854f, -0.2508523f, +0.1667831f, +0.0025835f, -0.0285142f,
  +0.0447905f, +0.0168651f, -0.0398152f, -0.0443151f, -0.2083827f, -0.1309960f, -0.3121128f, +0.0910097f,
  -0.0561806f, +0.2021235f, -0.4016190f, +0.1530982f, +0.0347698f, +0.1138194f, -0.0467751f, +0.0201534f,
  -0.0001376f, +0.0040851f, +0.1427254f, -0.0057837f, +0.0503585f, +0.2229800f, -0.4728914f, -0.2352838f,
  -0.0945568f, +0.0938338f, +0.1838026f, -0.1460548f, -0.0460546f, -0.0603157f, -0.3147414f, +0.2731439f,
  -0.4152114f, +0.2146340f, -0.1659243f, +0.3844098f, -0.0386916f, -0.2627301f, -0.3402649f, -0.1130528f,
  -0.1045286f, -0.0820729f, +0.3804124f, +0.1717786f, +0.1798355f, +0.0132587f, -0.6182776f, +0.0283169f,
  +0.0182554f, +0.3438305f, +0.2553191f, +0.9135088f, -0.0114348f, -0.0137930f, -0.7954866f, +0.4823086f,
  -0.1701864f, +0.1374728f, -0.0778185f, -0.2957187f, -0.3788451f, +0.0986815f, -0.0519908f, +0.0955675f,
  -0.0081066f, -0.1601027f, +0.2202911f, +0.0424303f, +0.2539209f, +0.0943544f, -0.3629132f, -0.0913942f,
  -0.1046544f, +0.0180915f, +0.2052469f, -0.0843482f, -0.0622451f, -0.3244641f, -0.8636973f, -0.0307315f,
  -0.1720985f, +0.1480311f, +0.0944529f, -0.1423417f, +0.1017238f, +0.1133766f, -0.2784294f, -0.2033046f
);

const float biases[4] = float[4](
  +0.0443033f, +0.0599317f, -0.0432725f, -0.1443862f
);

vec4 hook() {
    const vec4 r[9][2] = vec4[9][2](
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 1.0f)))
    );

    float sum[4] = biases;
    for (int n = 0; n < 4; n++) {
        for (int i = 0; i < 9; i++) {
            const vec4 k0 = vec4(kernels[n * 8 * 9 + 8 * i + 0], kernels[n * 8 * 9 + 8 * i + 1], kernels[n * 8 * 9 + 8 * i + 2], kernels[n * 8 * 9 + 8 * i + 3]);
            const vec4 k1 = vec4(kernels[n * 8 * 9 + 8 * i + 4], kernels[n * 8 * 9 + 8 * i + 5], kernels[n * 8 * 9 + 8 * i + 6], kernels[n * 8 * 9 + 8 * i + 7]);
            sum[n] += (dot(k0, r[i][0]) + dot(k1, r[i][1]));
        }
    }

    return ACTIVE(vec4(sum[0], sum[1], sum[2], sum[3]) * 0.2000000f + TEX_BIND_L2_TEXOFF(vec2(0.0f, 0.0f)));
}

//!HOOK LUMA
//!DESC ARNet b16 Layer4 L1
//!WHEN OUTPUT.w LUMA.w / 1.2 > OUTPUT.h LUMA.h / 1.2 > *
//!BIND TMP1_L0
//!BIND TMP1_L1
//!BIND TMP2_L1
//!SAVE TMP2_L1
//!COMPONENTS 4

#define ACTIVE(v) (v)

#define TEX_BIND_L0_TEXOFF TMP1_L0_texOff
#define TEX_BIND_L0_TEX TMP1_L0_tex
#define TEX_BIND_L0_POS TMP1_L0_pos
#define TEX_BIND_L0_SIZE TMP1_L0_size
#define TEX_BIND_L0_PT TMP1_L0_pt

#define TEX_BIND_L1_TEXOFF TMP1_L1_texOff
#define TEX_BIND_L1_TEX TMP1_L1_tex
#define TEX_BIND_L1_POS TMP1_L1_pos
#define TEX_BIND_L1_SIZE TMP1_L1_size
#define TEX_BIND_L1_PT TMP1_L1_pt

#define TEX_BIND_L2_TEXOFF TMP2_L1_texOff
#define TEX_BIND_L2_TEX TMP2_L1_tex
#define TEX_BIND_L2_POS TMP2_L1_pos
#define TEX_BIND_L2_SIZE TMP2_L1_size
#define TEX_BIND_L2_PT TMP2_L1_pt

const float kernels[288] = float[288](
  +0.0392306f, -0.2130457f, -0.0051996f, -0.1831357f, -0.1078626f, +0.1037515f, +0.0033000f, +0.0497848f,
  -0.3787884f, -0.4454622f, +0.0823682f, -0.2234722f, +0.2145768f, +0.2136458f, -0.3821481f, +0.5154469f,
  -0.1441587f, +0.1353348f, -0.0912294f, +0.3797897f, -0.2161237f, -0.1551168f, -0.0272399f, -0.0237438f,
  +0.0891231f, -0.0259196f, +0.1114996f, +0.0199136f, -0.2990860f, -0.0485818f, -0.1069093f, +0.0130969f,
  -0.2060542f, -0.0597439f, -0.1573429f, -0.2990655f, -0.3447749f, +0.2622053f, +0.4742119f, -0.3927543f,
  +0.1063897f, +0.1094444f, -0.1869078f, -0.1028177f, -0.0404891f, +0.1141003f, +0.2271751f, -0.1770850f,
  -0.1901187f, +0.0213696f, +0.1119254f, -0.0472985f, +0.1850004f, +0.1026648f, -0.0025981f, +0.0112371f,
  -0.0262080f, -0.1660921f, -0.2914764f, +0.0612042f, +0.1095133f, +0.2048209f, +0.1706648f, +0.0187808f,
  +0.0898966f, +0.0150051f, -0.1236157f, +0.2173690f, +0.1353005f, +0.0719700f, -0.0301238f, -0.0687356f,
  -0.1155324f, +0.0396598f, +0.0711288f, -0.1042305f, +0.0351966f, +0.0833980f, -0.1971449f, -0.0166596f,
  +0.1603573f, +0.0130948f, -0.2119000f, -0.3289478f, +0.0236122f, +0.1065857f, -0.0460945f, +0.0862748f,
  -0.2303059f, +0.3251825f, +0.0792240f, +0.0526348f, -0.0008840f, -0.1224234f, +0.1543043f, -0.1012598f,
  -0.0051205f, -0.0824009f, +0.0095316f, -0.3279462f, +0.0486974f, -0.2677081f, -0.3933933f, -0.0634601f,
  +0.1599392f, -0.1024006f, -0.1039312f, -0.4842192f, -0.1004892f, -0.3588101f, +0.3298837f, -0.2345892f,
  +0.0447573f, -0.2723608f, +0.0597468f, -0.0304507f, +0.1653766f, +0.0536020f, +0.1626776f, +0.2101799f,
  -0.1572844f, +0.0300891f, +0.1241363f, -0.0771604f, -0.0216966f, +0.1445772f, -0.0904792f, +0.0691614f,
  -0.0348336f, +0.0204529f, +0.1206604f, -0.0161570f, -0.2215773f, -0.0518515f, -0.0914563f, -0.4171025f,
  +0.0308267f, -0.1805769f, -0.0504901f, -0.0169774f, +0.0083325f, +0.0703375f, -0.2298212f, +0.0485872f,
  -0.0210411f, -0.0846433f, +0.0072865f, +0.1001131f, -0.0908395f, -0.1512437f, +0.0345038f, +0.1083691f,
  -0.0200702f, -0.1548107f, +0.0631302f, +0.2327724f, +0.1462080f, -0.3367785f, +0.1980231f, +0.0730240f,
  -0.0031367f, -0.0940762f, -0.0224032f, +0.0037773f, -0.0195571f, +0.0101730f, +0.3044507f, +0.0615048f,
  +0.2065962f, +0.0231919f, -0.0612527f, +0.2281833f, -0.0800369f, -0.1333322f, +0.3547870f, -0.1636665f,
  +0.4439221f, -0.0266020f, +0.2267350f, +0.0533811f, -0.0265093f, +0.0393975f, +0.0313992f, -0.4168244f,
  -0.1215571f, +0.1538677f, +0.0077819f, +0.3247341f, +0.3882479f, +0.1118848f, +0.2053908f, +0.0475180f,
  +0.0943989f, -0.0915048f, +0.0207765f, +0.1512664f, +0.2765006f, +0.0703109f, +0.0472950f, +0.2612727f,
  +0.1107618f, -0.1162782f, +0.0260665f, +0.2018686f, +0.0965595f, +0.1724844f, +0.3038515f, +0.1465127f,
  -0.0009271f, +0.0388774f, -0.1572324f, -0.0859755f, -0.3595428f, -0.1436665f, +0.1750560f, +0.0679750f,
  -0.0716283f, -0.0755692f, +0.1032916f, -0.1068617f, -0.0105858f, -0.0984652f, -0.0223740f, +0.0462538f,
  -0.1894112f, +0.1321062f, +0.0995319f, +0.1271575f, -0.1780483f, -0.1211948f, -0.2401539f, +0.0131765f,
  +0.2628124f, +0.1320265f, -0.1891791f, +0.1189890f, -0.0127696f, -0.1212082f, -0.1292147f, -0.0194274f,
  -0.2438402f, +0.0915620f, +0.0571960f, -0.0749463f, -0.0328939f, +0.1586531f, +0.0385065f, +0.1007517f,
  -0.5162506f, +0.1465575f, +0.1660155f, -0.2564297f, -0.1344595f, +0.2177771f, -0.0816070f, -0.0730212f,
  -0.0411518f, +0.1828362f, -0.0678957f, +0.0136548f, -0.1878637f, +0.1091288f, -0.1143992f, +0.1428920f,
  +0.1235761f, +0.0723744f, -0.1483162f, -0.0459086f, +0.2296278f, -0.1179701f, -0.1931058f, -0.2291127f,
  +0.1039284f, +0.1591405f, -0.0905882f, +0.1299380f, +0.2709170f, -0.0901183f, -0.2928192f, +0.1553645f,
  +0.1195561f, +0.2642896f, -0.0236179f, +0.1319849f, +0.1561602f, +0.0505658f, -0.0634049f, -0.1912974f
);

const float biases[4] = float[4](
  +0.0796275f, +0.1065851f, -0.0533070f, -0.1261383f
);

vec4 hook() {
    const vec4 r[9][2] = vec4[9][2](
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 1.0f)))
    );

    float sum[4] = biases;
    for (int n = 0; n < 4; n++) {
        for (int i = 0; i < 9; i++) {
            const vec4 k0 = vec4(kernels[n * 8 * 9 + 8 * i + 0], kernels[n * 8 * 9 + 8 * i + 1], kernels[n * 8 * 9 + 8 * i + 2], kernels[n * 8 * 9 + 8 * i + 3]);
            const vec4 k1 = vec4(kernels[n * 8 * 9 + 8 * i + 4], kernels[n * 8 * 9 + 8 * i + 5], kernels[n * 8 * 9 + 8 * i + 6], kernels[n * 8 * 9 + 8 * i + 7]);
            sum[n] += (dot(k0, r[i][0]) + dot(k1, r[i][1]));
        }
    }

    return ACTIVE(vec4(sum[0], sum[1], sum[2], sum[3]) * 0.2000000f + TEX_BIND_L2_TEXOFF(vec2(0.0f, 0.0f)));
}

//!HOOK LUMA
//!DESC ARNet b16 Layer5 L0
//!WHEN OUTPUT.w LUMA.w / 1.2 > OUTPUT.h LUMA.h / 1.2 > *
//!BIND TMP2_L0
//!BIND TMP2_L1
//!SAVE TMP1_L0
//!COMPONENTS 4

#define ACTIVE(v) (max(v, v * 0.2000000f))

#define TEX_BIND_L0_TEXOFF TMP2_L0_texOff
#define TEX_BIND_L0_TEX TMP2_L0_tex
#define TEX_BIND_L0_POS TMP2_L0_pos
#define TEX_BIND_L0_SIZE TMP2_L0_size
#define TEX_BIND_L0_PT TMP2_L0_pt

#define TEX_BIND_L1_TEXOFF TMP2_L1_texOff
#define TEX_BIND_L1_TEX TMP2_L1_tex
#define TEX_BIND_L1_POS TMP2_L1_pos
#define TEX_BIND_L1_SIZE TMP2_L1_size
#define TEX_BIND_L1_PT TMP2_L1_pt

const float kernels[288] = float[288](
  -0.0315356f, +0.0360123f, -0.1796232f, -0.0259948f, -0.0664668f, -0.1579207f, -0.0198063f, +0.0538096f,
  -0.2220257f, +0.0151340f, -0.0168517f, +0.0088065f, -0.0747396f, +0.0325299f, -0.0132259f, -0.0473765f,
  +0.0925461f, -0.0348143f, +0.0478132f, -0.0749838f, +0.0128196f, +0.1991641f, -0.1637558f, +0.0525187f,
  +0.1169579f, -0.1640368f, +0.1110181f, -0.1878468f, +0.3539223f, +0.2135696f, +0.0217120f, +0.1694619f,
  -0.0665879f, +0.1164809f, +0.1065297f, -0.1206706f, +0.2577803f, +0.0715397f, +0.0343034f, -0.0466621f,
  -0.1453737f, -0.2679669f, +0.0493624f, -0.0526487f, +0.0014119f, -0.0134970f, -0.1189212f, -0.1320565f,
  -0.1154354f, +0.1024469f, -0.1761830f, -0.1318644f, -0.1018184f, -0.1855125f, -0.0774615f, +0.0110087f,
  -0.0276219f, -0.4948099f, -0.0033595f, -0.0770775f, -0.0385610f, -0.0331465f, -0.2658077f, -0.3923212f,
  -0.2709069f, -0.1664752f, +0.1386187f, +0.1105645f, +0.1280980f, -0.0767612f, -0.1751213f, +0.1303387f,
  +0.0780934f, -0.0366061f, +0.0286298f, -0.0576905f, +0.0391079f, -0.1344073f, -0.0440618f, -0.1882863f,
  -0.1629484f, +0.1690012f, -0.1319362f, +0.0437023f, -0.2084843f, -0.3435582f, +0.0567604f, +0.1027689f,
  +0.2421328f, +0.1680274f, +0.0051736f, -0.2893510f, +0.0336450f, +0.0589328f, -0.1489996f, +0.1058355f,
  +0.0824775f, +0.0709972f, +0.1790644f, +0.2370852f, +0.1106984f, +0.0105194f, +0.3246624f, +0.2857874f,
  -0.0057425f, +0.1370126f, -0.3360507f, +0.0481183f, -0.7830648f, -0.2883066f, +0.3465153f, +0.5489926f,
  +0.0505592f, -0.0519631f, +0.2288530f, +0.0139269f, -0.1210602f, -0.2986311f, +0.2710512f, -0.0640127f,
  +0.2202426f, +0.1111473f, -0.0594249f, +0.0346086f, +0.2622026f, +0.0394876f, +0.0904185f, -0.0531354f,
  -0.2401522f, +0.2853420f, +0.2287098f, -0.0675584f, -0.3181129f, -0.2325180f, -0.1028143f, +0.0555195f,
  +0.3942000f, +0.1714912f, -0.5047665f, -0.0357542f, -0.4286481f, +0.1529862f, +0.1058362f, -0.0381020f,
  +0.1683377f, -0.1848407f, +0.1653357f, +0.4339766f, -0.0758509f, -0.0171212f, -0.1806851f, -0.1703765f,
  -0.2092643f, -0.0767532f, -0.7624991f, +0.4343796f, +0.1785338f, +0.1190443f, -0.1685501f, +0.2501058f,
  +0.0311809f, +0.1661873f, -0.5358198f, +0.3475511f, -0.1916575f, +0.0612693f, +0.0083982f, +0.1984178f,
  -0.2368132f, -0.1085735f, +0.0276031f, -0.3049026f, -0.1071465f, -0.1464186f, +0.4992875f, +0.2202258f,
  -0.3696564f, +0.3124103f, +0.0735679f, +0.3224564f, +0.4434387f, +0.1583022f, +0.1413924f, +0.3434997f,
  -0.0335338f, +0.1605873f, -0.0869118f, -0.0456006f, +0.2583679f, -0.0674803f, +0.0762134f, +0.0092405f,
  +0.1211013f, +0.1005177f, -0.0504166f, -0.2248916f, -0.0885897f, -0.1767537f, -0.0510443f, -0.0376847f,
  +0.1647902f, +0.2527784f, +0.2937327f, -0.1573367f, +0.0085936f, -0.0581836f, -0.0184588f, +0.0095309f,
  -0.0817155f, -0.1156306f, +0.1767300f, -0.1686561f, +0.0609998f, +0.0692672f, +0.0344596f, -0.3006035f,
  +0.4457307f, -0.2673393f, -0.1771295f, -0.7023711f, +0.0623444f, +0.1014195f, -0.3378430f, +0.0531352f,
  +0.4048982f, +0.6818526f, -0.4435481f, -0.0509974f, +0.0105005f, +0.2094252f, -0.0143336f, -0.1016467f,
  +0.1496915f, -0.0670739f, +0.3038350f, +0.0311125f, -0.0535996f, -0.1155820f, +0.1606039f, -0.0258332f,
  -0.5678803f, +0.3224686f, -0.5491914f, -0.0158289f, +0.0083031f, -0.0784274f, -0.0470015f, +0.0741716f,
  +0.3523523f, +0.0173858f, -0.3337681f, -0.2445331f, +0.0908298f, +0.1888863f, +0.2637332f, -0.1257065f,
  -0.0996472f, -0.2519652f, +0.1844485f, -0.2642480f, -0.0012787f, +0.0455837f, -0.0697818f, -0.1051555f,
  -0.0080486f, -0.1943380f, +0.2309742f, -0.2981908f, +0.0934054f, -0.0140855f, -0.1280521f, -0.2347843f,
  +0.0037189f, -0.0928410f, +0.2464422f, -0.0959589f, +0.4742509f, -0.3518547f, +0.0691282f, -0.2805936f,
  -0.1323166f, +0.1393868f, +0.0561723f, -0.2115236f, +0.0080417f, -0.1307739f, -0.1524101f, -0.0737483f
);

const float biases[4] = float[4](
  +0.1851674f, +0.1315005f, +0.0027782f, -0.0036134f
);

vec4 hook() {
    const vec4 r[9][2] = vec4[9][2](
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 1.0f)))
    );

    float sum[4] = biases;
    for (int n = 0; n < 4; n++) {
        for (int i = 0; i < 9; i++) {
            const vec4 k0 = vec4(kernels[n * 8 * 9 + 8 * i + 0], kernels[n * 8 * 9 + 8 * i + 1], kernels[n * 8 * 9 + 8 * i + 2], kernels[n * 8 * 9 + 8 * i + 3]);
            const vec4 k1 = vec4(kernels[n * 8 * 9 + 8 * i + 4], kernels[n * 8 * 9 + 8 * i + 5], kernels[n * 8 * 9 + 8 * i + 6], kernels[n * 8 * 9 + 8 * i + 7]);
            sum[n] += (dot(k0, r[i][0]) + dot(k1, r[i][1]));
        }
    }

    return ACTIVE(vec4(sum[0], sum[1], sum[2], sum[3]));
}

//!HOOK LUMA
//!DESC ARNet b16 Layer5 L1
//!WHEN OUTPUT.w LUMA.w / 1.2 > OUTPUT.h LUMA.h / 1.2 > *
//!BIND TMP2_L0
//!BIND TMP2_L1
//!SAVE TMP1_L1
//!COMPONENTS 4

#define ACTIVE(v) (max(v, v * 0.2000000f))

#define TEX_BIND_L0_TEXOFF TMP2_L0_texOff
#define TEX_BIND_L0_TEX TMP2_L0_tex
#define TEX_BIND_L0_POS TMP2_L0_pos
#define TEX_BIND_L0_SIZE TMP2_L0_size
#define TEX_BIND_L0_PT TMP2_L0_pt

#define TEX_BIND_L1_TEXOFF TMP2_L1_texOff
#define TEX_BIND_L1_TEX TMP2_L1_tex
#define TEX_BIND_L1_POS TMP2_L1_pos
#define TEX_BIND_L1_SIZE TMP2_L1_size
#define TEX_BIND_L1_PT TMP2_L1_pt

const float kernels[288] = float[288](
  -0.2462812f, +0.2572640f, -0.5303349f, +0.1383370f, +0.1827891f, +0.0316198f, +0.4058246f, -0.3792990f,
  -0.4022321f, +0.0880325f, -0.1328475f, -0.0796959f, +0.2461011f, +0.1472613f, -0.1846353f, -0.0100029f,
  -0.3890688f, +0.1850582f, +0.1644147f, +0.0865418f, +0.1134937f, +0.0888222f, +0.0901439f, +0.0710274f,
  -0.6516479f, -0.1700386f, +0.4067455f, +0.6075160f, +0.1846427f, +0.1446731f, -0.1033986f, +0.7343135f,
  -0.2075742f, +0.0602305f, -0.2701360f, +0.4100263f, -0.1363858f, -0.0316646f, -0.2155735f, +0.3088636f,
  +0.3835867f, +0.1788466f, +0.3091791f, -0.1728906f, +0.1005699f, +0.1573511f, -0.1492748f, -0.0482697f,
  -0.7620299f, -0.3690478f, +0.4315057f, +0.2983537f, +0.6419823f, +0.4914716f, +0.1027271f, +0.1431893f,
  -0.7408746f, +0.0196553f, -0.2165949f, +0.4829065f, +0.2505397f, +0.0447776f, -0.1125011f, +0.2654253f,
  +0.1329985f, -0.2987528f, -0.2585365f, +0.1141881f, -0.0808315f, +0.3090467f, +0.2671876f, -0.1230319f,
  -0.0107006f, +0.1705807f, +0.4627376f, +0.0379572f, -0.2748886f, -0.1216353f, -0.0142430f, -0.0227956f,
  +0.1721853f, -0.1193042f, -0.1375450f, -0.2042431f, +0.2444627f, -0.1429931f, -0.1380781f, +0.5976514f,
  +0.0873768f, -0.1063714f, +0.2164676f, -0.0740058f, -0.2822966f, +0.0461197f, +0.0772405f, -0.0604661f,
  +0.1146334f, +0.3296529f, +0.3586862f, +0.0498556f, -0.0628769f, -0.0643645f, +0.0700836f, +0.0087738f,
  -0.0047023f, -0.0523995f, -0.5836017f, -0.1240446f, +0.1022377f, -0.0991218f, +0.1712574f, +0.4012666f,
  +0.7519892f, -0.5212806f, +0.8868735f, +0.0469770f, +0.1329871f, +0.7650769f, +0.0867829f, -0.7718092f,
  +0.1439605f, -0.1326402f, -0.0859177f, -0.0219735f, +0.1337898f, -0.0362242f, +0.0344769f, -0.0852246f,
  +0.0136675f, -0.0753988f, -0.1688694f, +0.1452015f, -0.0664255f, +0.1807882f, +0.0207912f, +0.0946822f,
  +0.1902725f, -0.1226153f, -0.1172180f, -0.2045582f, -0.3402724f, +0.3062574f, +0.0628202f, +0.0033428f,
  -0.0908027f, -0.1545988f, -0.3610803f, -0.1757850f, -0.2188222f, -0.0241947f, -0.1720900f, -0.1737819f,
  +0.2098519f, +0.2471768f, -0.8376477f, -0.3412003f, +0.1841072f, +0.2061159f, -0.3107866f, -0.0549688f,
  +0.0099951f, +0.1919406f, -1.0294801f, -0.1026476f, +0.4712587f, +0.1996447f, +0.0368004f, -0.2192752f,
  +0.0352149f, -0.1226207f, -0.4884893f, +0.1705665f, -0.0508986f, -0.3641812f, +0.0735521f, -0.0115158f,
  +0.6404713f, -0.1420947f, -0.5106637f, -0.0383468f, -0.5048111f, -0.4042349f, -0.0956857f, +0.1480879f,
  +0.4119876f, +0.1174726f, -0.5377303f, +0.0777685f, +0.1434633f, +0.2530357f, -0.1042643f, -0.1273779f,
  +0.0612505f, -0.2152622f, +0.1948008f, -0.0014239f, +0.0331943f, -0.0275564f, +0.2234253f, -0.2129287f,
  +0.0110672f, +0.3814596f, +0.0903245f, -0.1798663f, +0.1772919f, +0.3052639f, +0.1303984f, +0.3970776f,
  +0.1300076f, +0.3541573f, +0.2175574f, -0.1123949f, +0.2397438f, -0.0378790f, +0.3287377f, -0.1453035f,
  +0.0544756f, +0.0482709f, -0.0851373f, -0.2576558f, +0.0755580f, +0.0704263f, -0.0812797f, -0.0986197f,
  -0.0595547f, -0.1244643f, +0.1017584f, -0.0119670f, -0.0742813f, -0.1966021f, -0.2235836f, +0.4631301f,
  +0.1882890f, +0.0543806f, -0.2096366f, -0.0100483f, +0.0948204f, +0.0270978f, -0.1103739f, +0.3118796f,
  +0.1426737f, +0.2217241f, -0.1277014f, +0.1598057f, -0.0538420f, -0.3345139f, +0.1369670f, +0.0883092f,
  -0.1900449f, -0.0332208f, +0.3124049f, +0.3793032f, -0.3347893f, -0.7319125f, +0.9416568f, -0.0113035f,
  +0.2924007f, -0.0021335f, +0.1259896f, -0.0225396f, +0.0761572f, -0.0025242f, +0.0974288f, -0.2443022f,
  -0.0649299f, -0.0605929f, +0.1337828f, +0.2429496f, -0.0066945f, +0.2590691f, +0.0459141f, +0.2421222f,
  -0.3137920f, -0.3358896f, +0.0882618f, +0.3673122f, +0.2242899f, +0.3269842f, -0.2770303f, -0.1782252f,
  +0.0582518f, -0.1899976f, -0.2327013f, +0.4098218f, -0.1323174f, -0.3814656f, +0.0800247f, +0.1920703f
);

const float biases[4] = float[4](
  -0.0502343f, +0.0265636f, -0.0474376f, -0.0295054f
);

vec4 hook() {
    const vec4 r[9][2] = vec4[9][2](
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 1.0f)))
    );

    float sum[4] = biases;
    for (int n = 0; n < 4; n++) {
        for (int i = 0; i < 9; i++) {
            const vec4 k0 = vec4(kernels[n * 8 * 9 + 8 * i + 0], kernels[n * 8 * 9 + 8 * i + 1], kernels[n * 8 * 9 + 8 * i + 2], kernels[n * 8 * 9 + 8 * i + 3]);
            const vec4 k1 = vec4(kernels[n * 8 * 9 + 8 * i + 4], kernels[n * 8 * 9 + 8 * i + 5], kernels[n * 8 * 9 + 8 * i + 6], kernels[n * 8 * 9 + 8 * i + 7]);
            sum[n] += (dot(k0, r[i][0]) + dot(k1, r[i][1]));
        }
    }

    return ACTIVE(vec4(sum[0], sum[1], sum[2], sum[3]));
}

//!HOOK LUMA
//!DESC ARNet b16 Layer6 L0
//!WHEN OUTPUT.w LUMA.w / 1.2 > OUTPUT.h LUMA.h / 1.2 > *
//!BIND TMP1_L0
//!BIND TMP1_L1
//!BIND TMP2_L0
//!SAVE TMP2_L0
//!COMPONENTS 4

#define ACTIVE(v) (v)

#define TEX_BIND_L0_TEXOFF TMP1_L0_texOff
#define TEX_BIND_L0_TEX TMP1_L0_tex
#define TEX_BIND_L0_POS TMP1_L0_pos
#define TEX_BIND_L0_SIZE TMP1_L0_size
#define TEX_BIND_L0_PT TMP1_L0_pt

#define TEX_BIND_L1_TEXOFF TMP1_L1_texOff
#define TEX_BIND_L1_TEX TMP1_L1_tex
#define TEX_BIND_L1_POS TMP1_L1_pos
#define TEX_BIND_L1_SIZE TMP1_L1_size
#define TEX_BIND_L1_PT TMP1_L1_pt

#define TEX_BIND_L2_TEXOFF TMP2_L0_texOff
#define TEX_BIND_L2_TEX TMP2_L0_tex
#define TEX_BIND_L2_POS TMP2_L0_pos
#define TEX_BIND_L2_SIZE TMP2_L0_size
#define TEX_BIND_L2_PT TMP2_L0_pt

const float kernels[288] = float[288](
  -0.4245827f, +0.0852784f, -0.1287724f, -0.0832071f, -0.1303576f, -0.2595951f, -0.1365044f, -0.0327951f,
  -0.0413405f, +0.3571476f, -0.1467362f, -0.1492738f, +0.3677145f, -0.0133768f, +0.4400533f, +0.2207103f,
  -0.2003574f, -0.0529718f, +0.1033915f, +0.1294179f, +0.2938575f, -0.0404280f, +0.0855597f, +0.2672506f,
  +0.1263302f, -0.1427670f, -0.0138990f, -0.0557751f, -0.0010955f, -0.4387158f, -0.5259904f, +0.2212489f,
  +0.3659322f, -0.1388159f, +0.2778983f, -0.2713808f, +0.2060665f, +0.1198889f, -0.7619809f, -0.2188138f,
  -0.2507471f, -0.2644171f, +0.2919347f, +0.5771253f, +0.1625858f, +0.0684044f, +0.1273423f, -0.0273881f,
  -0.0598193f, +0.1041618f, -0.0925372f, -0.0940790f, +0.0101657f, -0.5194364f, -0.4310291f, -0.0001656f,
  +0.0952956f, -0.0183355f, -0.3503937f, -0.3550861f, -0.1451368f, -0.4397113f, -0.0245998f, -0.3865747f,
  +0.2294765f, +0.3924023f, -0.3588125f, -0.3489530f, -0.2700671f, -0.0058103f, -0.1648053f, -0.2281793f,
  +0.1720242f, +0.0479339f, +0.0650449f, -0.1108888f, -0.0414155f, +0.0815952f, -0.4722533f, +0.4014800f,
  +0.4143758f, -0.5173089f, -0.0194493f, -0.0286097f, -0.3900175f, +0.2577783f, -0.0164709f, +0.7224351f,
  -0.2570471f, -0.6398616f, +0.0659664f, +0.0478731f, +0.1724587f, +0.1354786f, -0.5448139f, +0.5490773f,
  +0.2115567f, +0.2568599f, -0.0411229f, +0.1218345f, -0.1428974f, +0.2734238f, -0.1171895f, +0.2104307f,
  -0.2659455f, -0.1593668f, -0.1576346f, +0.1437796f, -0.1890608f, -0.0839339f, +0.7046239f, +0.2809781f,
  -0.2177808f, -0.0223659f, -0.2554748f, -0.2335337f, +0.0095957f, -0.1355380f, -0.0356969f, -0.2334007f,
  +0.0180969f, -0.0335219f, -0.0299190f, +0.0910641f, +0.0584120f, +0.0589241f, +0.2021224f, -0.0685977f,
  -0.1609799f, +0.0953091f, -0.0346526f, +0.0214639f, -0.0418370f, -0.0991121f, +0.6184928f, +0.2402611f,
  +0.1278037f, +0.2193407f, -0.6113892f, +0.5530559f, -0.0727705f, -0.2958852f, -0.0034581f, -0.1737855f,
  -0.0492894f, -0.1644645f, +0.0376796f, +0.0776201f, +0.3937131f, +0.0330883f, -0.2451428f, +0.1407762f,
  +0.1941758f, -0.3058437f, +0.2448803f, +0.0143173f, -0.2141443f, +0.0927353f, +0.4837404f, -0.0404031f,
  -0.1370464f, +0.2928842f, +0.1244189f, -0.0294844f, +0.2244250f, -0.1071715f, -0.3201220f, -0.5121642f,
  -0.0222583f, -0.2665992f, -0.0184842f, +0.1048416f, -0.3264249f, -0.0728777f, +0.0187740f, -0.1990770f,
  -0.0358293f, -0.1272905f, -0.0190524f, -0.0595386f, -0.3839724f, -0.1098703f, +0.0210982f, +0.2456144f,
  +0.0763125f, +0.1746238f, +0.3315050f, +0.1647333f, -0.1806719f, -0.3393039f, -0.2907653f, -0.1858679f,
  -0.0102246f, +0.1986148f, +0.0800139f, +0.1597765f, +0.1058767f, -0.1376470f, +0.3797056f, -0.1343818f,
  -0.1361032f, +0.2263760f, +0.4315020f, +0.1816822f, +0.2910115f, -0.3303494f, +0.0554841f, -0.0554680f,
  +0.1137237f, +0.1349451f, -0.4629071f, +0.3281358f, +0.4081964f, -0.4146573f, -0.0493194f, -0.1395369f,
  +0.0837180f, +0.3642171f, +0.0633668f, +0.2123537f, +0.0986799f, +0.1920363f, +0.0829229f, -0.2115165f,
  +0.1062464f, +0.0421681f, +0.1437034f, -0.1147055f, -0.6033895f, +0.1272959f, +0.2346905f, -0.0034658f,
  +0.2911168f, -0.3652326f, +0.2453200f, -0.0588722f, -0.3156115f, +0.0891276f, -0.2796667f, -0.6075211f,
  -0.1696482f, -0.0935323f, +0.2180595f, +0.2398608f, -0.2310699f, -0.4678723f, +0.0139571f, -0.0445741f,
  +0.0341883f, -0.0379079f, -0.1280318f, +0.3173062f, -0.0544882f, +0.4320174f, -0.2520655f, -0.8390257f,
  +0.1017964f, +0.3714603f, +0.3514001f, -0.0827929f, -0.1429029f, -0.3067715f, +0.2726591f, +0.0843863f,
  -0.0561277f, +0.2761674f, +0.1047826f, +0.0652679f, +0.0090822f, -0.1817678f, +0.0712686f, +0.0560969f,
  -0.0818219f, +0.0478710f, -0.0967730f, +0.5767944f, -0.3759062f, -0.0353228f, -0.1755946f, -0.0302197f,
  -0.0535811f, -0.3917918f, -0.4782370f, -0.1385554f, +0.0926858f, -0.0932027f, +0.5034916f, +0.1770633f
);

const float biases[4] = float[4](
  +0.1413485f, -0.0043864f, +0.0057872f, -0.1142889f
);

vec4 hook() {
    const vec4 r[9][2] = vec4[9][2](
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 1.0f)))
    );

    float sum[4] = biases;
    for (int n = 0; n < 4; n++) {
        for (int i = 0; i < 9; i++) {
            const vec4 k0 = vec4(kernels[n * 8 * 9 + 8 * i + 0], kernels[n * 8 * 9 + 8 * i + 1], kernels[n * 8 * 9 + 8 * i + 2], kernels[n * 8 * 9 + 8 * i + 3]);
            const vec4 k1 = vec4(kernels[n * 8 * 9 + 8 * i + 4], kernels[n * 8 * 9 + 8 * i + 5], kernels[n * 8 * 9 + 8 * i + 6], kernels[n * 8 * 9 + 8 * i + 7]);
            sum[n] += (dot(k0, r[i][0]) + dot(k1, r[i][1]));
        }
    }

    return ACTIVE(vec4(sum[0], sum[1], sum[2], sum[3]) * 0.2000000f + TEX_BIND_L2_TEXOFF(vec2(0.0f, 0.0f)));
}

//!HOOK LUMA
//!DESC ARNet b16 Layer6 L1
//!WHEN OUTPUT.w LUMA.w / 1.2 > OUTPUT.h LUMA.h / 1.2 > *
//!BIND TMP1_L0
//!BIND TMP1_L1
//!BIND TMP2_L1
//!SAVE TMP2_L1
//!COMPONENTS 4

#define ACTIVE(v) (v)

#define TEX_BIND_L0_TEXOFF TMP1_L0_texOff
#define TEX_BIND_L0_TEX TMP1_L0_tex
#define TEX_BIND_L0_POS TMP1_L0_pos
#define TEX_BIND_L0_SIZE TMP1_L0_size
#define TEX_BIND_L0_PT TMP1_L0_pt

#define TEX_BIND_L1_TEXOFF TMP1_L1_texOff
#define TEX_BIND_L1_TEX TMP1_L1_tex
#define TEX_BIND_L1_POS TMP1_L1_pos
#define TEX_BIND_L1_SIZE TMP1_L1_size
#define TEX_BIND_L1_PT TMP1_L1_pt

#define TEX_BIND_L2_TEXOFF TMP2_L1_texOff
#define TEX_BIND_L2_TEX TMP2_L1_tex
#define TEX_BIND_L2_POS TMP2_L1_pos
#define TEX_BIND_L2_SIZE TMP2_L1_size
#define TEX_BIND_L2_PT TMP2_L1_pt

const float kernels[288] = float[288](
  -0.1995904f, +0.2262561f, -0.0542116f, +0.0166230f, -0.1787258f, -0.1558592f, -0.0248895f, +0.0922121f,
  -0.0931166f, -0.0882940f, +0.0618623f, -0.1027516f, -0.3884404f, -0.1348886f, -0.0315068f, +0.7477390f,
  +0.2127640f, +0.0531770f, -0.2696739f, +0.0658603f, -0.5144801f, -0.0808734f, -0.0767166f, -0.7823647f,
  -0.1040690f, +0.1920092f, -0.0662626f, +0.0478678f, +0.2405098f, -0.2137759f, -0.3581429f, -0.0883720f,
  -0.1677787f, +0.2764055f, +0.1599967f, -0.0615547f, +0.0426521f, -0.1336730f, +0.5022644f, +0.3004433f,
  +0.3197044f, +0.1696366f, +0.0296749f, +0.2289310f, -0.6148639f, +0.0042682f, -0.4557191f, +0.1108689f,
  +0.0217620f, +0.1162765f, -0.1934326f, -0.0387016f, -0.0233446f, +0.1773738f, -0.1386551f, +0.0358916f,
  -0.0045357f, -0.0392425f, -0.0894676f, +0.1110989f, -0.0383082f, -0.1314731f, -0.2210179f, +0.0690400f,
  -0.0197431f, -0.2366293f, +0.4494246f, -0.0579554f, -0.0241224f, +0.0544569f, -0.3365430f, -0.1902997f,
  +0.0231247f, -0.0919372f, +0.0363009f, -0.0523511f, -0.1865681f, -0.0138423f, -0.1908040f, +0.0330839f,
  +0.3306258f, -0.2304287f, +0.0624844f, +0.0486828f, -0.1582285f, -0.2181212f, -0.1606729f, +0.7185801f,
  +0.2349215f, -0.1404807f, -0.1241651f, +0.0281595f, -0.1772821f, +0.0354621f, -0.0657614f, +0.0890218f,
  +0.1444893f, +0.2217268f, +0.0208707f, -0.1651293f, -0.0654202f, +0.0132610f, -0.0326037f, +0.3446110f,
  -0.4219648f, -0.0615472f, -0.1263071f, -0.0722799f, -0.1205197f, -0.1214111f, +0.5403041f, +0.0475003f,
  -0.3072047f, +0.0545412f, -0.2032436f, -0.2785382f, -0.1883494f, +0.1224091f, +0.0186002f, +0.1728581f,
  -0.0913169f, +0.0593701f, +0.0441767f, -0.0075054f, -0.1482899f, -0.0017729f, +0.0326755f, -0.0410445f,
  -0.0008601f, -0.0648649f, -0.0888972f, +0.1521413f, +0.1897812f, -0.2397748f, +0.2445389f, +0.0477513f,
  -0.0994145f, -0.0166317f, +0.0103852f, +0.0647357f, -0.1038896f, +0.0285575f, -0.0520974f, +0.0002726f,
  +0.3165131f, -0.0955503f, -0.0007283f, +0.1378348f, -0.1728914f, -0.4333080f, -0.1868204f, +0.0513328f,
  -0.0118329f, -0.1570827f, +0.0034080f, +0.0054641f, +0.1383961f, -0.0991158f, +0.0802027f, +0.0477145f,
  -0.0564349f, +0.1184852f, -0.0872187f, -0.1108764f, -0.1541010f, -0.0254760f, -0.0402151f, -0.0375854f,
  -0.1063472f, -0.3855854f, +0.0706995f, -0.0350206f, -0.0178530f, -0.2008851f, -0.0702219f, -0.2078228f,
  +0.0775351f, +0.0435642f, +0.2711347f, -0.0404732f, +0.8583890f, -0.1877356f, +0.1816612f, +0.0580676f,
  +0.1516478f, -0.1569705f, -0.2372659f, -0.0089529f, -0.2306486f, +0.1365003f, +0.0583054f, -0.4057923f,
  +0.0497208f, +0.0110190f, -0.2277733f, -0.0524915f, +0.0123155f, -0.2504596f, -0.1665100f, -0.0350373f,
  -0.0885715f, +0.2575811f, -0.3227779f, +0.0181370f, +0.4081203f, -0.0448149f, +0.0872999f, -0.0147773f,
  +0.2546263f, +0.2318422f, -0.0028394f, +0.0173319f, -0.1752763f, +0.0683200f, -0.0013111f, +0.0935464f,
  -0.1224945f, +0.1218010f, +0.0614855f, -0.0747142f, +0.0425418f, +0.0848109f, +0.2449058f, +0.0447479f,
  -0.0554698f, -0.1173365f, -0.0753063f, +0.0349949f, -0.1453349f, +0.1804879f, -0.0232860f, -0.5297421f,
  +0.1482297f, -0.2656699f, -0.0375884f, +0.0336131f, -0.0736637f, +0.0757958f, +0.1624241f, -0.2136823f,
  -0.1071824f, +0.2422854f, -0.0581291f, +0.0746346f, -0.1214309f, +0.1571933f, -0.0558676f, +0.0034976f,
  -0.0576372f, +0.0125130f, -0.0414292f, +0.1125437f, -0.1987298f, +0.4375755f, -0.2908634f, +0.3621382f,
  +0.3283751f, +0.0278006f, +0.0708873f, +0.3664186f, -0.2788794f, +0.0744760f, -0.0164457f, -0.1839087f,
  -0.0231861f, -0.1955629f, +0.0305051f, +0.1169369f, +0.0060504f, -0.0998776f, -0.1933349f, +0.0544838f,
  +0.0926195f, -0.1515492f, -0.1012069f, -0.1555038f, -0.1245496f, -0.0441511f, -0.1505684f, -0.1887680f,
  +0.0628961f, +0.0568484f, -0.1057881f, -0.1037052f, -0.3883841f, +0.0749963f, -0.1633483f, -0.1368923f
);

const float biases[4] = float[4](
  -0.0972168f, +0.0912962f, -0.0048477f, +0.0422459f
);

vec4 hook() {
    const vec4 r[9][2] = vec4[9][2](
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 1.0f)))
    );

    float sum[4] = biases;
    for (int n = 0; n < 4; n++) {
        for (int i = 0; i < 9; i++) {
            const vec4 k0 = vec4(kernels[n * 8 * 9 + 8 * i + 0], kernels[n * 8 * 9 + 8 * i + 1], kernels[n * 8 * 9 + 8 * i + 2], kernels[n * 8 * 9 + 8 * i + 3]);
            const vec4 k1 = vec4(kernels[n * 8 * 9 + 8 * i + 4], kernels[n * 8 * 9 + 8 * i + 5], kernels[n * 8 * 9 + 8 * i + 6], kernels[n * 8 * 9 + 8 * i + 7]);
            sum[n] += (dot(k0, r[i][0]) + dot(k1, r[i][1]));
        }
    }

    return ACTIVE(vec4(sum[0], sum[1], sum[2], sum[3]) * 0.2000000f + TEX_BIND_L2_TEXOFF(vec2(0.0f, 0.0f)));
}

//!HOOK LUMA
//!DESC ARNet b16 Layer7 L0
//!WHEN OUTPUT.w LUMA.w / 1.2 > OUTPUT.h LUMA.h / 1.2 > *
//!BIND TMP2_L0
//!BIND TMP2_L1
//!SAVE TMP1_L0
//!COMPONENTS 4

#define ACTIVE(v) (max(v, v * 0.2000000f))

#define TEX_BIND_L0_TEXOFF TMP2_L0_texOff
#define TEX_BIND_L0_TEX TMP2_L0_tex
#define TEX_BIND_L0_POS TMP2_L0_pos
#define TEX_BIND_L0_SIZE TMP2_L0_size
#define TEX_BIND_L0_PT TMP2_L0_pt

#define TEX_BIND_L1_TEXOFF TMP2_L1_texOff
#define TEX_BIND_L1_TEX TMP2_L1_tex
#define TEX_BIND_L1_POS TMP2_L1_pos
#define TEX_BIND_L1_SIZE TMP2_L1_size
#define TEX_BIND_L1_PT TMP2_L1_pt

const float kernels[288] = float[288](
  -0.1655149f, -0.0127137f, +0.0179142f, +0.1998992f, +0.1208124f, +0.1382358f, +0.0501656f, -0.0278668f,
  +0.3588425f, +0.0318437f, +0.2182354f, +0.2457094f, +0.0890578f, -0.1964234f, +0.1549016f, +0.0323464f,
  +0.4005517f, -0.2980606f, -0.0023554f, +0.1857181f, -0.0691675f, +0.1760132f, +0.1869807f, +0.0468095f,
  -0.0377210f, -0.2867250f, -0.2357695f, -0.0658369f, +0.3267345f, -0.1070382f, +0.0137213f, -0.0924486f,
  -0.3065513f, -0.0587922f, -0.0478779f, -0.6469821f, +0.3346178f, -0.1127169f, +0.1807614f, -0.0130949f,
  +0.2631261f, +0.0864681f, +0.1782525f, +0.0284000f, -0.1835114f, -0.1821931f, -0.0141919f, +0.1115314f,
  +0.2042411f, +0.1670140f, -0.0524476f, -0.0671472f, -0.0318739f, +0.1547161f, +0.2748745f, -0.2622694f,
  +0.4599023f, -0.0825372f, +0.0955883f, -0.4300880f, -0.1847145f, +0.0000579f, +0.0614372f, -0.8054356f,
  -0.2868202f, -0.1925988f, +0.2565760f, -0.1576273f, +0.2124511f, +0.1992225f, +0.1956062f, -0.1691371f,
  +0.2685345f, +0.1590280f, +0.1121665f, -0.2056536f, -0.0155302f, +0.1770889f, +0.0954939f, -0.1739061f,
  +0.0827802f, -0.3088608f, +0.4630536f, -0.0497732f, +0.0350722f, +0.1579351f, +0.1555507f, -0.2466833f,
  -0.7553756f, -0.3490263f, -0.3596019f, +0.0341865f, +0.0281907f, -0.4623322f, +0.0539792f, -0.0279160f,
  -0.1118272f, -0.0047612f, +0.2923670f, +0.4284165f, +0.4336678f, +0.1689625f, -0.1479424f, +0.3059649f,
  +0.2949501f, -0.3008464f, +0.3088525f, -0.1253108f, +0.0488947f, +0.0455661f, +0.2590008f, +0.2157752f,
  -0.2159152f, -0.1406273f, +0.6182521f, -0.4153894f, +0.0601687f, +0.0665853f, -0.1435314f, -0.2450642f,
  -0.0029462f, +0.0365957f, -0.6774113f, +0.2517600f, -0.2027153f, +0.0517331f, +0.0419017f, +0.0887049f,
  +0.0662224f, +0.2046014f, +0.2133790f, +0.1329643f, +0.0966364f, -0.2539363f, +0.2256612f, -0.2202981f,
  -0.0328395f, +0.1414894f, -0.2348866f, +0.0006292f, -0.0560647f, +0.0223891f, -0.0910913f, +0.1904118f,
  -0.0324388f, +0.0009787f, -0.0628954f, +0.0968910f, -0.3921584f, -0.1327556f, -0.0146036f, +0.0022006f,
  -0.1083519f, +0.6956090f, -0.2903113f, -0.1693090f, -0.1468953f, +0.4682259f, -0.1284457f, -0.2815009f,
  -0.2375195f, +0.0231623f, -0.1524421f, +0.0767704f, +0.1086846f, +0.3117106f, -0.2737288f, -0.1929959f,
  -0.0677724f, -0.1023100f, +0.2923217f, +0.2089025f, +0.0045192f, -0.0622348f, -0.0714241f, -0.1058614f,
  +0.1433860f, -0.2916303f, -0.1424171f, -0.0287138f, +0.2739477f, +0.1295949f, +0.3752646f, +0.3934763f,
  +0.0169722f, +0.0667714f, -0.0952729f, -0.2318847f, -0.0912224f, +0.3161346f, -0.0711607f, -0.0636146f,
  +0.0488041f, -0.4006325f, -0.0110258f, -0.0589034f, -0.3345138f, -0.0980013f, -0.2202183f, +0.0675743f,
  +0.2230025f, +0.1594077f, -0.3316204f, +0.1737916f, -0.5482085f, -0.2295122f, -0.4682446f, +0.1977685f,
  -0.0625562f, +0.1703966f, +0.0420790f, +0.1394389f, +0.0533567f, -0.0768132f, +0.1989565f, +0.1517024f,
  +0.0603841f, +0.0271439f, -0.2171063f, +0.0578079f, -0.0912619f, +0.1402051f, +0.0942938f, -0.0202353f,
  -0.6460873f, -0.0997741f, -0.4555133f, +0.0698187f, +0.0908010f, -0.1441868f, +0.3438508f, -0.1754545f,
  -0.3013452f, -0.0968492f, -0.0894498f, +0.4926537f, +0.3910379f, +0.7008606f, -0.7993512f, -0.3162991f,
  -0.0898800f, -0.1070473f, -0.0170878f, -0.0340381f, +0.2533886f, +0.3693212f, +0.0334112f, -0.0440334f,
  -0.3021541f, -0.4269903f, +0.1185614f, +0.0574052f, +0.5116876f, +0.2064598f, +0.1581008f, +0.0838289f,
  +0.3258034f, +0.3924864f, -0.3306489f, +0.0570985f, +0.7447531f, +0.3314205f, -0.0617062f, -0.1192100f,
  -0.0523109f, +0.0477143f, +0.0927771f, +0.0446143f, +0.1596067f, -0.1175545f, +0.1418992f, -0.2295715f,
  +0.0585452f, -0.0226658f, -0.0291794f, -0.0070230f, +0.0661791f, -0.0761503f, +0.0401946f, +0.0891686f,
  -0.0772441f, +0.2588173f, -0.0930593f, +0.2203716f, +0.2555122f, +0.0650735f, +0.2198295f, +0.1286273f
);

const float biases[4] = float[4](
  -0.0436627f, -0.0453201f, +0.0159913f, -0.0539646f
);

vec4 hook() {
    const vec4 r[9][2] = vec4[9][2](
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 1.0f)))
    );

    float sum[4] = biases;
    for (int n = 0; n < 4; n++) {
        for (int i = 0; i < 9; i++) {
            const vec4 k0 = vec4(kernels[n * 8 * 9 + 8 * i + 0], kernels[n * 8 * 9 + 8 * i + 1], kernels[n * 8 * 9 + 8 * i + 2], kernels[n * 8 * 9 + 8 * i + 3]);
            const vec4 k1 = vec4(kernels[n * 8 * 9 + 8 * i + 4], kernels[n * 8 * 9 + 8 * i + 5], kernels[n * 8 * 9 + 8 * i + 6], kernels[n * 8 * 9 + 8 * i + 7]);
            sum[n] += (dot(k0, r[i][0]) + dot(k1, r[i][1]));
        }
    }

    return ACTIVE(vec4(sum[0], sum[1], sum[2], sum[3]));
}

//!HOOK LUMA
//!DESC ARNet b16 Layer7 L1
//!WHEN OUTPUT.w LUMA.w / 1.2 > OUTPUT.h LUMA.h / 1.2 > *
//!BIND TMP2_L0
//!BIND TMP2_L1
//!SAVE TMP1_L1
//!COMPONENTS 4

#define ACTIVE(v) (max(v, v * 0.2000000f))

#define TEX_BIND_L0_TEXOFF TMP2_L0_texOff
#define TEX_BIND_L0_TEX TMP2_L0_tex
#define TEX_BIND_L0_POS TMP2_L0_pos
#define TEX_BIND_L0_SIZE TMP2_L0_size
#define TEX_BIND_L0_PT TMP2_L0_pt

#define TEX_BIND_L1_TEXOFF TMP2_L1_texOff
#define TEX_BIND_L1_TEX TMP2_L1_tex
#define TEX_BIND_L1_POS TMP2_L1_pos
#define TEX_BIND_L1_SIZE TMP2_L1_size
#define TEX_BIND_L1_PT TMP2_L1_pt

const float kernels[288] = float[288](
  +0.1757997f, +0.0815035f, +0.0242189f, -0.1755637f, -0.0800245f, +0.1473661f, -0.1852529f, -0.1022839f,
  +0.1958425f, +0.2111031f, +0.0100482f, +0.2107284f, -0.0549628f, +0.0545822f, +0.0635828f, +0.0560377f,
  -0.2023913f, +0.0252183f, -0.0724903f, +0.0248787f, +0.0362546f, -0.2051586f, +0.0537741f, -0.0150911f,
  -0.0097270f, +0.1372791f, -0.1047188f, +0.0794012f, -0.1563744f, +0.5350614f, -0.1992488f, -0.5662870f,
  +0.3452501f, -0.0978292f, +0.0867248f, +0.3657635f, -0.3334881f, +0.0962997f, +0.5480426f, -0.0350162f,
  +0.2011537f, +0.0208447f, +0.0467181f, -0.0338992f, -0.1159789f, -0.2295710f, +0.0754471f, +0.1268131f,
  +0.1860339f, -0.4609041f, +0.2344479f, +0.1326438f, +0.0341859f, -0.0082636f, -0.1952295f, -0.5359434f,
  -0.1205550f, +0.2327735f, -0.1442623f, +0.2053121f, +0.3668684f, +0.0269693f, +0.1560048f, -0.0762560f,
  +0.0450565f, -0.0084115f, -0.0072556f, +0.1267373f, -0.1764118f, -0.2563501f, -0.0059822f, +0.0655320f,
  -0.1708578f, -0.0681986f, -0.3755260f, +0.1290065f, +0.1110781f, +0.0545423f, +0.0308993f, +0.1823660f,
  +0.1413602f, +0.0123215f, -0.3191586f, +0.1842290f, +0.1103848f, +0.3959107f, -0.2309514f, -0.0066476f,
  -0.0630597f, +0.1357251f, +0.0000934f, +0.1403401f, +0.1070633f, +0.0550447f, -0.0718338f, +0.0022758f,
  +0.1734402f, +0.3333846f, +0.0156501f, -0.7176061f, -0.4850414f, +0.2249939f, -0.0782296f, -0.5315562f,
  +0.9333358f, +0.6776081f, +0.1850127f, -0.4700223f, +0.6108375f, +0.3622279f, -0.5292982f, -0.2340277f,
  +0.1810047f, +0.1090771f, +0.1730329f, -0.3438835f, -0.1058987f, +0.2197483f, -0.2317970f, +0.0410098f,
  +0.4664470f, +0.1019405f, -0.2410811f, -0.2449040f, +0.2807770f, -0.0779048f, +0.0460246f, -0.0195081f,
  -0.4737185f, +0.4568047f, -0.1717872f, -0.5063229f, +0.3977194f, -0.0128693f, +0.3658871f, +0.0380458f,
  +0.0590152f, -0.0537841f, -0.0156830f, -0.0870306f, -0.1710504f, +0.1284733f, -0.0506257f, +0.0799133f,
  -0.2320724f, +0.3393216f, -0.0574768f, -0.1244472f, -0.2761411f, -0.0431833f, +0.0918575f, -0.0413326f,
  +0.1907278f, +0.0805572f, +0.2063234f, -0.2132225f, +0.0941389f, -0.3258168f, -0.2090197f, +0.3466813f,
  +0.2075579f, -0.2078050f, +0.1461647f, -0.2146611f, -0.0595698f, +0.2086571f, -0.0958385f, -0.0131427f,
  +0.0007220f, -0.1863628f, +0.3774951f, +0.1896708f, +0.3851102f, +0.0670114f, -0.1884950f, +0.1628650f,
  -0.2732490f, +0.1366878f, -0.2876064f, -0.2976597f, +0.0552958f, -0.2387853f, +0.1771047f, +0.3491945f,
  +0.4272013f, -0.3215235f, +0.0377807f, +0.5274055f, -0.2015538f, +0.0318698f, +0.2616578f, -0.0906717f,
  -0.0723700f, -0.1335203f, -0.0540025f, -0.0091695f, +0.0668161f, -0.0367412f, -0.0472260f, -0.0636631f,
  -0.0053832f, -0.1428555f, +0.1142592f, +0.1496180f, +0.0008652f, +0.1025225f, -0.0145749f, +0.0041140f,
  +0.0748184f, +0.0224007f, -0.0175189f, +0.0251448f, -0.1029179f, +0.0424207f, +0.1393472f, +0.1374377f,
  -0.1870411f, +0.1262341f, +0.0124493f, -0.3065292f, -0.1125490f, -0.2057165f, +0.0207957f, -0.0889095f,
  +0.2989739f, +0.2216151f, -0.1273860f, +0.3869373f, +0.2497531f, +0.2199728f, +0.1417124f, -0.0390708f,
  -0.0666628f, -0.3348085f, +0.1024073f, +0.5585853f, -0.0294435f, -0.3437484f, +0.8472028f, -0.3068188f,
  +0.3584831f, +0.0731086f, -0.1129189f, -0.1190254f, -0.2576751f, +0.2089550f, +0.4108246f, -0.3117460f,
  -0.1918278f, +0.2810615f, -0.4721325f, +0.1562444f, +0.3168435f, +0.0619401f, +0.1938876f, +0.4285670f,
  +0.4510418f, -0.2971656f, +0.0198806f, +0.0453071f, +0.0566409f, +0.3545627f, -0.1802933f, -0.0143638f,
  -0.0172107f, +0.2378900f, -0.2209970f, +0.0054545f, +0.1532927f, +0.0221529f, +0.1069986f, +0.1567129f,
  -0.3812209f, -0.1285491f, +0.4176919f, +0.4326589f, -0.2566616f, -0.0532023f, -0.2538881f, +0.1394299f,
  +0.3560480f, -0.0786094f, +0.0993160f, -0.0042030f, -0.0476698f, -0.1354292f, +0.2222136f, -0.0159203f
);

const float biases[4] = float[4](
  -0.0241676f, -0.0318679f, +0.0149201f, -0.0337315f
);

vec4 hook() {
    const vec4 r[9][2] = vec4[9][2](
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 1.0f)))
    );

    float sum[4] = biases;
    for (int n = 0; n < 4; n++) {
        for (int i = 0; i < 9; i++) {
            const vec4 k0 = vec4(kernels[n * 8 * 9 + 8 * i + 0], kernels[n * 8 * 9 + 8 * i + 1], kernels[n * 8 * 9 + 8 * i + 2], kernels[n * 8 * 9 + 8 * i + 3]);
            const vec4 k1 = vec4(kernels[n * 8 * 9 + 8 * i + 4], kernels[n * 8 * 9 + 8 * i + 5], kernels[n * 8 * 9 + 8 * i + 6], kernels[n * 8 * 9 + 8 * i + 7]);
            sum[n] += (dot(k0, r[i][0]) + dot(k1, r[i][1]));
        }
    }

    return ACTIVE(vec4(sum[0], sum[1], sum[2], sum[3]));
}

//!HOOK LUMA
//!DESC ARNet b16 Layer8 L0
//!WHEN OUTPUT.w LUMA.w / 1.2 > OUTPUT.h LUMA.h / 1.2 > *
//!BIND TMP1_L0
//!BIND TMP1_L1
//!BIND TMP2_L0
//!SAVE TMP2_L0
//!COMPONENTS 4

#define ACTIVE(v) (v)

#define TEX_BIND_L0_TEXOFF TMP1_L0_texOff
#define TEX_BIND_L0_TEX TMP1_L0_tex
#define TEX_BIND_L0_POS TMP1_L0_pos
#define TEX_BIND_L0_SIZE TMP1_L0_size
#define TEX_BIND_L0_PT TMP1_L0_pt

#define TEX_BIND_L1_TEXOFF TMP1_L1_texOff
#define TEX_BIND_L1_TEX TMP1_L1_tex
#define TEX_BIND_L1_POS TMP1_L1_pos
#define TEX_BIND_L1_SIZE TMP1_L1_size
#define TEX_BIND_L1_PT TMP1_L1_pt

#define TEX_BIND_L2_TEXOFF TMP2_L0_texOff
#define TEX_BIND_L2_TEX TMP2_L0_tex
#define TEX_BIND_L2_POS TMP2_L0_pos
#define TEX_BIND_L2_SIZE TMP2_L0_size
#define TEX_BIND_L2_PT TMP2_L0_pt

const float kernels[288] = float[288](
  -0.1084920f, +0.1049914f, -0.0765276f, -0.2338634f, -0.1321248f, +0.3099718f, +0.0000464f, -0.0006996f,
  +0.0147614f, +0.3036748f, +0.1630803f, -0.0083421f, +0.0704283f, -0.1019647f, +0.1444753f, +0.0727725f,
  +0.3334980f, -0.1067527f, +0.0995169f, +0.1311041f, -0.2821779f, -0.1169583f, -0.0939058f, -0.0714100f,
  -0.2063980f, -0.2488051f, -0.6039209f, -0.2215357f, -0.2066537f, +0.1580716f, -0.0340907f, +0.2628676f,
  -0.1207600f, -0.1856045f, +0.3118499f, +0.3462938f, -0.3934111f, -0.0755119f, -0.5190336f, -0.2439375f,
  +0.1183830f, +0.1293528f, +0.2944932f, -0.1872174f, -0.4980861f, -0.4440217f, +0.0825101f, -0.1876329f,
  -0.1548841f, -0.1325031f, -0.2877412f, +0.1337336f, -0.0887823f, +0.0601813f, -0.0890451f, -0.4898401f,
  +0.1239292f, -0.6838976f, +0.0870403f, +0.6296035f, -0.1253791f, -0.4289501f, +0.1325438f, -0.1709277f,
  +0.3180454f, +0.0596978f, -0.2258080f, +0.0787244f, -0.0572092f, -0.2502674f, +0.3773428f, -0.2637348f,
  +0.2879993f, +0.2325938f, +0.1306222f, +0.3672679f, +0.1829144f, -0.0110293f, -0.0353881f, +0.1206753f,
  +0.3197382f, -0.0391881f, +0.3886520f, +0.1914566f, +0.1793188f, -0.3601759f, -0.3709644f, -0.0165992f,
  +0.0084663f, -0.0633619f, -0.1025857f, +0.1699814f, -0.0689696f, -0.2230229f, -0.0574585f, -0.0995425f,
  +0.1068487f, +0.1547440f, +0.3100614f, +0.0111275f, -0.2313886f, +0.0641520f, +0.3447304f, -0.2664325f,
  +0.1023596f, -0.3017610f, +0.5677093f, +0.4018205f, -0.1836635f, -0.4442112f, +0.1129973f, -0.1567200f,
  +0.1482709f, -0.0771358f, +0.0338417f, +0.2194055f, +0.1100634f, -0.1025320f, +0.1159916f, +0.1339018f,
  -0.0260196f, +0.3896514f, -0.1779382f, -0.4083758f, +0.0604921f, +0.0700464f, +0.3772066f, +0.2079432f,
  +0.0558289f, +0.7571902f, -0.5912817f, -0.2821578f, +0.0288839f, +0.1696071f, +0.1013668f, -0.3813688f,
  -0.0588477f, -0.0508395f, -0.1186360f, -0.0222196f, -0.1783023f, +0.2036654f, +0.0539775f, +0.5290340f,
  -0.0971024f, -0.0740046f, +0.0405073f, +0.3025449f, +0.2594305f, +0.1190154f, -0.0413445f, -0.1513581f,
  +0.1965518f, -0.0822435f, +0.2512586f, +0.1030880f, -0.5289020f, -0.1130152f, +0.0683895f, +0.0174988f,
  +0.1213653f, +0.0948641f, +0.0534583f, +0.0319604f, +0.0481842f, -0.0656179f, +0.2764515f, -0.2308397f,
  -0.4239367f, -0.0517514f, +0.2569624f, -0.0520502f, +0.0818510f, -0.1449027f, -0.1030509f, +0.1159871f,
  -0.3574959f, -0.1732895f, +0.3464068f, +0.0492807f, -0.1490001f, -0.8024698f, +0.0939707f, +0.3309319f,
  -0.0273982f, -0.0652258f, +0.2493201f, +0.1638820f, -0.1118987f, +0.1345530f, +0.1450068f, +0.2951591f,
  -0.0091919f, -0.1034265f, +0.1996380f, -0.1285286f, +0.0128078f, +0.1127486f, -0.2385927f, +0.5731153f,
  -0.1240547f, +0.3444058f, -0.2927718f, +0.3900062f, -0.1505159f, -0.0672357f, +0.2179419f, +0.2803790f,
  -0.0598388f, +0.1489309f, +0.0670678f, +0.0380212f, -0.1841903f, +0.0317794f, +0.3848315f, +0.1993302f,
  +0.1107685f, -0.1152475f, -0.0051493f, -0.1389802f, -0.3365285f, +0.1418849f, +0.0922346f, -0.0756630f,
  +0.2624936f, +0.3213100f, -0.3024659f, +0.1467264f, +0.1990407f, -0.3306331f, +0.2355815f, -0.0494804f,
  +0.2477157f, -0.1115665f, +0.2515484f, +0.0389327f, +0.0162268f, +0.8829970f, -0.2352619f, +0.0966306f,
  +0.0987063f, +0.3723606f, -0.1297880f, +0.2876226f, -0.3393518f, -0.0291726f, +0.1223567f, +0.0795873f,
  -0.1970776f, +0.3705318f, +0.0215263f, -0.2567029f, +0.2566792f, +0.6632953f, +0.2305563f, -0.0954790f,
  +0.1178999f, -0.0406828f, +0.1857200f, +0.1251430f, -0.0989904f, +0.8098608f, -0.4485783f, +0.4351574f,
  +0.1347798f, -0.1380381f, -0.5599556f, -0.4675715f, -0.1628134f, -0.1379838f, +0.0543734f, +0.4334445f,
  +0.0817568f, +0.6925954f, -0.1445429f, +0.2071053f, -0.0675049f, -0.0003988f, +0.1356521f, +0.1355980f,
  +0.1075692f, +0.2777295f, -0.2238169f, -0.0458281f, +0.0114043f, -0.2298766f, -0.1267359f, -0.1544949f
);

const float biases[4] = float[4](
  -0.0575522f, +0.0435412f, +0.0063835f, +0.0628122f
);

vec4 hook() {
    const vec4 r[9][2] = vec4[9][2](
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 1.0f)))
    );

    float sum[4] = biases;
    for (int n = 0; n < 4; n++) {
        for (int i = 0; i < 9; i++) {
            const vec4 k0 = vec4(kernels[n * 8 * 9 + 8 * i + 0], kernels[n * 8 * 9 + 8 * i + 1], kernels[n * 8 * 9 + 8 * i + 2], kernels[n * 8 * 9 + 8 * i + 3]);
            const vec4 k1 = vec4(kernels[n * 8 * 9 + 8 * i + 4], kernels[n * 8 * 9 + 8 * i + 5], kernels[n * 8 * 9 + 8 * i + 6], kernels[n * 8 * 9 + 8 * i + 7]);
            sum[n] += (dot(k0, r[i][0]) + dot(k1, r[i][1]));
        }
    }

    return ACTIVE(vec4(sum[0], sum[1], sum[2], sum[3]) * 0.2000000f + TEX_BIND_L2_TEXOFF(vec2(0.0f, 0.0f)));
}

//!HOOK LUMA
//!DESC ARNet b16 Layer8 L1
//!WHEN OUTPUT.w LUMA.w / 1.2 > OUTPUT.h LUMA.h / 1.2 > *
//!BIND TMP1_L0
//!BIND TMP1_L1
//!BIND TMP2_L1
//!SAVE TMP2_L1
//!COMPONENTS 4

#define ACTIVE(v) (v)

#define TEX_BIND_L0_TEXOFF TMP1_L0_texOff
#define TEX_BIND_L0_TEX TMP1_L0_tex
#define TEX_BIND_L0_POS TMP1_L0_pos
#define TEX_BIND_L0_SIZE TMP1_L0_size
#define TEX_BIND_L0_PT TMP1_L0_pt

#define TEX_BIND_L1_TEXOFF TMP1_L1_texOff
#define TEX_BIND_L1_TEX TMP1_L1_tex
#define TEX_BIND_L1_POS TMP1_L1_pos
#define TEX_BIND_L1_SIZE TMP1_L1_size
#define TEX_BIND_L1_PT TMP1_L1_pt

#define TEX_BIND_L2_TEXOFF TMP2_L1_texOff
#define TEX_BIND_L2_TEX TMP2_L1_tex
#define TEX_BIND_L2_POS TMP2_L1_pos
#define TEX_BIND_L2_SIZE TMP2_L1_size
#define TEX_BIND_L2_PT TMP2_L1_pt

const float kernels[288] = float[288](
  +0.1492845f, +0.3057302f, +0.2509779f, +0.3702246f, +0.0127641f, +0.0616726f, +0.1222294f, +0.4476523f,
  -0.0303361f, -0.1259369f, -0.0106801f, +0.1841343f, +0.0010733f, -0.3580602f, -0.1802057f, -0.3316892f,
  +0.0577039f, +0.0011223f, +0.0772850f, -0.0127903f, +0.0036773f, +0.3128929f, +0.0947010f, -0.2397209f,
  -0.1617024f, +0.2574809f, +0.3767356f, -0.2015677f, -0.2012419f, +0.2011807f, +0.0686472f, +0.0931317f,
  -0.1168452f, -0.0015021f, +0.0865754f, -0.5367606f, +0.0090683f, -0.0633584f, -0.1633365f, -0.2467382f,
  -0.2801751f, -0.1277215f, +0.0742959f, +0.0654173f, +0.3649716f, +0.3263094f, -0.1792542f, -0.0067636f,
  -0.0496639f, +0.0396285f, -0.0015545f, -0.4916568f, -0.1460805f, +0.1088445f, +0.2411940f, -0.1223766f,
  -0.0393988f, -0.1670944f, +0.4439692f, +0.2989502f, -0.0902097f, +0.1277521f, +0.1997438f, -0.2184705f,
  -0.0400141f, -0.0119334f, +0.0190375f, +0.1479503f, +0.0167502f, -0.0820105f, +0.3232276f, -0.1555164f,
  -0.0834807f, +0.0381926f, -0.0892472f, +0.0767602f, -0.1694914f, -0.0312161f, +0.0595014f, +0.3119051f,
  -0.4070268f, +0.0158258f, -0.1559076f, +0.0066809f, +0.0632964f, -0.1291073f, +0.0370887f, -0.0275138f,
  -0.2028432f, -0.1497075f, -0.1056163f, -0.0465098f, +0.1197010f, +0.1508874f, -0.0354893f, -0.0636568f,
  +0.1798113f, -0.0152079f, -0.0208009f, -0.0570391f, -0.1976973f, -0.1547158f, +0.1632691f, +0.1840647f,
  +0.4577201f, -0.1393850f, -0.2463324f, -0.3245625f, -0.2808508f, -0.2445656f, -0.4056656f, -0.1438570f,
  -0.0348436f, +0.0064410f, -0.1578748f, -0.0325560f, +0.0137081f, -0.1659109f, -0.0325313f, -0.0054141f,
  +0.0238845f, -0.0261183f, -0.1004824f, -0.0456206f, -0.0207429f, -0.0661292f, +0.0708915f, -0.0969323f,
  +0.1333744f, -0.0431576f, -0.0107393f, +0.3612903f, -0.0198377f, +0.1155317f, -0.2756472f, +0.1329784f,
  -0.0385301f, -0.0472853f, -0.1750101f, +0.0886026f, -0.1820332f, -0.1450611f, -0.0427403f, +0.3000482f,
  -0.3633840f, +0.2639452f, +0.0605594f, +0.1827465f, +0.0334977f, +0.1112101f, +0.2064102f, +0.0849309f,
  +0.0193201f, -0.2193383f, +0.1592615f, -0.0631576f, -0.2204051f, +0.1414078f, -0.0449216f, +0.1336378f,
  -0.1542080f, -0.0973284f, -0.0440928f, -0.0599156f, +0.0131956f, -0.0314288f, -0.1852989f, -0.0405616f,
  -0.5532863f, -0.0630374f, -0.0969234f, -0.5016066f, -0.2195671f, +0.1389261f, -0.2174637f, -0.2419504f,
  -0.5118191f, +0.0160361f, -0.0560255f, -0.5210245f, -0.2701567f, -0.2557538f, -0.0822004f, +0.2493310f,
  -0.1093758f, +0.0384674f, -0.0863006f, +0.0229925f, -0.0931187f, -0.0679901f, -0.4825631f, -0.1774107f,
  -0.0070280f, -0.1599229f, -0.0500750f, +0.2493540f, +0.0806036f, +0.1051773f, -0.1359372f, +0.2483855f,
  -0.1603288f, -0.1042543f, +0.0516993f, -0.1298034f, -0.1156210f, -0.1491020f, +0.3314579f, +0.4375897f,
  -0.1102058f, +0.0326055f, -0.0738621f, +0.0698794f, -0.0564851f, +0.3790731f, -0.2732532f, +0.1179447f,
  +0.2652376f, +0.0539143f, +0.0055848f, +0.1358803f, -0.0686125f, -0.1332438f, -0.2409810f, -0.1508581f,
  +0.1855414f, +0.2264819f, -0.0287044f, +0.0288147f, +0.3335962f, -0.0926311f, +0.0975936f, -0.1815480f,
  +0.2211681f, +0.0327512f, +0.1028075f, +0.0595408f, +0.1424176f, +0.0277029f, +0.0352410f, +0.0024190f,
  +0.2914297f, +0.0546057f, +0.0116983f, +0.1709111f, +0.1489884f, +0.1387756f, +0.1631380f, +0.2769621f,
  +0.0108691f, +0.0293527f, +0.1632289f, +0.2465224f, +0.2159833f, +0.4084014f, +0.2987005f, -0.0774631f,
  -0.0326670f, +0.0058206f, +0.1980094f, -0.0313236f, +0.1248344f, +0.5895475f, -0.0820848f, +0.1384508f,
  -0.1265838f, +0.2176768f, +0.2298559f, +0.3007545f, -0.1305235f, +0.0738080f, +0.0818057f, -0.1683986f,
  -0.0022110f, -0.0336306f, +0.0089431f, -0.1351707f, +0.0136139f, -0.1798230f, -0.0428380f, -0.5386835f,
  +0.1598335f, -0.0497743f, +0.1375517f, -0.0304608f, +0.2823824f, -0.2244079f, +0.0641257f, -0.1368431f
);

const float biases[4] = float[4](
  +0.0204174f, +0.1126961f, +0.0351825f, -0.0920669f
);

vec4 hook() {
    const vec4 r[9][2] = vec4[9][2](
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 1.0f)))
    );

    float sum[4] = biases;
    for (int n = 0; n < 4; n++) {
        for (int i = 0; i < 9; i++) {
            const vec4 k0 = vec4(kernels[n * 8 * 9 + 8 * i + 0], kernels[n * 8 * 9 + 8 * i + 1], kernels[n * 8 * 9 + 8 * i + 2], kernels[n * 8 * 9 + 8 * i + 3]);
            const vec4 k1 = vec4(kernels[n * 8 * 9 + 8 * i + 4], kernels[n * 8 * 9 + 8 * i + 5], kernels[n * 8 * 9 + 8 * i + 6], kernels[n * 8 * 9 + 8 * i + 7]);
            sum[n] += (dot(k0, r[i][0]) + dot(k1, r[i][1]));
        }
    }

    return ACTIVE(vec4(sum[0], sum[1], sum[2], sum[3]) * 0.2000000f + TEX_BIND_L2_TEXOFF(vec2(0.0f, 0.0f)));
}

//!HOOK LUMA
//!DESC ARNet b16 Layer9 L0
//!WHEN OUTPUT.w LUMA.w / 1.2 > OUTPUT.h LUMA.h / 1.2 > *
//!BIND TMP2_L0
//!BIND TMP2_L1
//!SAVE TMP1_L0
//!COMPONENTS 4

#define ACTIVE(v) (max(v, v * 0.2000000f))

#define TEX_BIND_L0_TEXOFF TMP2_L0_texOff
#define TEX_BIND_L0_TEX TMP2_L0_tex
#define TEX_BIND_L0_POS TMP2_L0_pos
#define TEX_BIND_L0_SIZE TMP2_L0_size
#define TEX_BIND_L0_PT TMP2_L0_pt

#define TEX_BIND_L1_TEXOFF TMP2_L1_texOff
#define TEX_BIND_L1_TEX TMP2_L1_tex
#define TEX_BIND_L1_POS TMP2_L1_pos
#define TEX_BIND_L1_SIZE TMP2_L1_size
#define TEX_BIND_L1_PT TMP2_L1_pt

const float kernels[288] = float[288](
  -0.4593949f, +0.0013617f, -0.0807357f, -0.0134823f, +0.1200003f, +0.0368943f, -0.1456748f, +0.0823802f,
  +0.1563317f, -0.3235137f, -0.3833432f, +0.0257824f, -0.0964707f, -0.0828742f, +0.3063640f, -0.1181804f,
  -0.3385589f, +0.1131777f, +0.0668544f, +0.1794848f, +0.1882432f, +0.0378125f, +0.1904813f, -0.1183580f,
  -0.0142396f, +0.2409646f, -0.2264989f, -0.2918106f, +0.1180069f, -0.0177540f, -0.3139802f, +0.2335044f,
  +0.0842274f, +0.2062456f, -0.4708799f, +0.1412639f, -0.4396648f, -0.0071296f, -0.0729629f, -0.1700962f,
  -0.1903004f, +0.4319717f, -0.0521454f, -0.3031040f, +0.3540933f, +0.1799338f, -0.0293809f, -0.2392078f,
  -0.0301960f, +0.2653845f, -0.2879480f, -0.0504880f, -0.3777128f, +0.2403509f, -0.1938005f, +0.3369738f,
  -0.4094529f, +0.4202272f, -0.1010390f, -0.1375095f, +0.3179338f, +0.0259179f, +0.0277281f, +0.3136936f,
  -0.1526024f, -0.0352504f, +0.0100612f, -0.1210568f, -0.1551530f, +0.0186305f, +0.1468127f, -0.1270548f,
  +0.2031773f, -0.0146970f, +0.2149139f, -0.1253562f, +0.0902209f, -0.0211904f, -0.0612505f, -0.0864310f,
  +0.2656998f, -0.1578564f, +0.5207446f, -0.1967824f, +0.0029984f, -0.0977700f, +0.1318113f, -0.0910598f,
  -0.1900184f, +0.2543409f, -0.1521658f, -0.1007576f, -0.0146852f, +0.0395198f, -0.1959008f, +0.1867168f,
  +0.6829636f, +0.2611085f, +0.0342782f, +0.1466461f, -0.2409656f, +0.3305971f, +0.1526161f, -0.6011958f,
  +0.5944777f, -0.2329684f, +0.3495609f, +0.2133121f, -0.0682748f, +0.4167267f, +0.4649416f, -0.5053736f,
  -0.3223877f, -0.4548514f, +0.1902326f, -0.0111121f, -0.1120808f, +0.0840755f, +0.2925935f, +0.0080920f,
  +0.1423199f, +0.2213991f, -0.0157479f, +0.0800409f, -0.0541917f, +0.1041334f, -0.0094370f, -0.2042130f,
  +0.1883475f, +0.0671118f, +0.0257646f, +0.4571585f, -0.0877462f, +0.3429777f, +0.1630809f, -0.5082323f,
  -0.0416974f, -0.1764796f, -0.1348393f, -0.0678592f, -0.1023294f, -0.6036488f, -0.0089388f, -0.1392999f,
  +0.1065109f, +0.0756076f, -0.2656407f, -0.1712746f, -0.1518282f, +0.1185307f, +0.2931390f, -0.2284427f,
  +0.0423960f, +0.0646783f, +0.1735212f, -0.0451794f, +0.3777609f, +0.0435492f, -0.0093100f, -0.1771956f,
  -0.1841821f, -0.0073282f, -0.0476111f, +0.1573241f, +0.0054075f, +0.3205440f, -0.0390855f, -0.1111951f,
  -0.1419299f, +0.0496295f, -0.2342495f, -0.2686227f, +0.2276298f, +0.1263404f, -0.1934106f, -0.0814357f,
  +0.1231934f, -0.1262729f, -0.1937401f, -0.4784482f, +0.6662481f, -0.0753680f, -0.0321788f, +0.0504686f,
  -0.0406189f, -0.0974188f, +0.1245244f, -0.0627553f, +0.6023428f, -0.5133433f, -0.1237272f, +0.3651649f,
  +0.1159998f, +0.0915155f, +0.1180453f, -0.1196795f, -0.2584634f, -0.0642223f, +0.0169493f, +0.1322834f,
  -0.1698331f, +0.0248135f, +0.3873425f, -0.0222762f, -0.3559024f, -0.5398494f, -0.2795673f, -0.0838376f,
  +0.0407593f, +0.0167764f, +0.4625699f, +0.0610077f, +0.5595616f, -0.2651525f, +0.0202236f, -0.0950527f,
  +0.0220387f, +0.0908093f, +0.0942388f, +0.1373475f, +0.0556270f, -0.0099925f, -0.0878242f, +0.1613383f,
  -0.0705312f, +0.1435853f, -0.2350325f, +0.1924719f, -0.2577192f, +0.0203336f, +0.2461785f, -0.1951811f,
  +0.2195406f, +0.0062634f, -0.1688902f, +0.0891988f, -0.0436960f, +0.1050303f, -0.2242229f, +0.3033801f,
  +0.1240962f, -0.1017251f, -0.0363991f, +0.1924358f, -0.0739530f, -0.0483203f, -0.0416395f, +0.0927651f,
  +0.3441487f, +0.2269523f, +0.3101223f, +0.0172306f, +0.4063423f, +0.0039297f, -0.0851466f, -0.0389190f,
  -0.4121649f, -0.5973880f, -0.5640343f, +0.1173723f, -0.4865164f, -0.2929783f, +0.4058158f, +0.2989605f,
  -0.0741865f, +0.0207497f, -0.0823729f, +0.1026762f, -0.1787109f, +0.0662670f, -0.0329893f, -0.0304325f,
  -0.2749368f, +0.2016743f, -0.3251655f, +0.0090041f, +0.0169900f, +0.3220094f, +0.0313272f, +0.2526887f,
  -0.2769310f, -0.1102017f, -0.7486467f, +0.5068625f, -0.3256562f, -0.0042700f, +0.3292369f, +0.2681025f
);

const float biases[4] = float[4](
  +0.0676264f, -0.0399624f, +0.0569496f, -0.0079475f
);

vec4 hook() {
    const vec4 r[9][2] = vec4[9][2](
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 1.0f)))
    );

    float sum[4] = biases;
    for (int n = 0; n < 4; n++) {
        for (int i = 0; i < 9; i++) {
            const vec4 k0 = vec4(kernels[n * 8 * 9 + 8 * i + 0], kernels[n * 8 * 9 + 8 * i + 1], kernels[n * 8 * 9 + 8 * i + 2], kernels[n * 8 * 9 + 8 * i + 3]);
            const vec4 k1 = vec4(kernels[n * 8 * 9 + 8 * i + 4], kernels[n * 8 * 9 + 8 * i + 5], kernels[n * 8 * 9 + 8 * i + 6], kernels[n * 8 * 9 + 8 * i + 7]);
            sum[n] += (dot(k0, r[i][0]) + dot(k1, r[i][1]));
        }
    }

    return ACTIVE(vec4(sum[0], sum[1], sum[2], sum[3]));
}

//!HOOK LUMA
//!DESC ARNet b16 Layer9 L1
//!WHEN OUTPUT.w LUMA.w / 1.2 > OUTPUT.h LUMA.h / 1.2 > *
//!BIND TMP2_L0
//!BIND TMP2_L1
//!SAVE TMP1_L1
//!COMPONENTS 4

#define ACTIVE(v) (max(v, v * 0.2000000f))

#define TEX_BIND_L0_TEXOFF TMP2_L0_texOff
#define TEX_BIND_L0_TEX TMP2_L0_tex
#define TEX_BIND_L0_POS TMP2_L0_pos
#define TEX_BIND_L0_SIZE TMP2_L0_size
#define TEX_BIND_L0_PT TMP2_L0_pt

#define TEX_BIND_L1_TEXOFF TMP2_L1_texOff
#define TEX_BIND_L1_TEX TMP2_L1_tex
#define TEX_BIND_L1_POS TMP2_L1_pos
#define TEX_BIND_L1_SIZE TMP2_L1_size
#define TEX_BIND_L1_PT TMP2_L1_pt

const float kernels[288] = float[288](
  -0.0496073f, -0.0057743f, -0.0942370f, +0.0336778f, -0.1787699f, -0.2479857f, -0.0225820f, -0.0891802f,
  -0.0622006f, +0.1536205f, +0.0579297f, -0.0795098f, +0.5327575f, -0.0667826f, -0.1805666f, +0.2005893f,
  -0.1132726f, -0.0058167f, +0.0102633f, -0.2404565f, -0.0641713f, -0.0024247f, -0.0418835f, +0.0502311f,
  -0.0000195f, +0.1930549f, -0.0848050f, +0.2038158f, -0.6262442f, +0.2679905f, +0.2485623f, -0.1010469f,
  -0.3467900f, +0.0621492f, -0.3285591f, +0.7697390f, -0.2816916f, +0.0260369f, +0.5698284f, +0.0873414f,
  -0.1845720f, -0.1126081f, -0.0464650f, -0.0147261f, +0.2277762f, -0.5172270f, +0.3235263f, -0.1454072f,
  -0.0427074f, -0.0516221f, +0.1132910f, -0.1212036f, +0.2112876f, +0.1685340f, -0.3239751f, -0.0102918f,
  -0.3934225f, -0.0993448f, +0.1742031f, -0.0123764f, -0.3503151f, +0.0361892f, -0.0674081f, -0.0121488f,
  -0.0787357f, -0.1361812f, +0.0187114f, +0.0722028f, -0.1403738f, +0.0517787f, +0.0954558f, -0.0001361f,
  -0.4945899f, -0.0284282f, -0.1831959f, +0.2480001f, +0.0985990f, +0.3707276f, -0.0467258f, -0.6893608f,
  -0.1965028f, +0.5910912f, +0.1275490f, -0.3012875f, +0.1670366f, +0.3007546f, +0.1173655f, -0.6607739f,
  -0.0765731f, +0.2658599f, -0.3221347f, +0.1346957f, -0.2134994f, +0.3726064f, +0.1954501f, -0.0852196f,
  +0.0292102f, -0.3305964f, -0.4329422f, +0.2265038f, +0.1646912f, +0.1667556f, +0.2450251f, -0.4140356f,
  +0.6327778f, +0.2774979f, -0.1252320f, +0.2363219f, +0.1122879f, +0.5157383f, -0.0232546f, -0.1717932f,
  -0.1093827f, +0.0676932f, -0.1105901f, +0.1534595f, -0.5735859f, +0.0914095f, +0.3821582f, -0.1781767f,
  +0.0659439f, -0.0608778f, -0.6004750f, +0.1586961f, -0.5445498f, +0.2935549f, -0.2133099f, -0.1272564f,
  +0.8185951f, -0.0348870f, -0.3530237f, +0.2327545f, -0.1417472f, +0.0410963f, -0.2578256f, -0.1331940f,
  +0.3927514f, -0.3459865f, -0.3647037f, +0.3110309f, -0.1550162f, +0.1936170f, -0.0918447f, +0.3340078f,
  -0.2103920f, +0.1156471f, -0.1199393f, -0.1119212f, -0.2975999f, -0.0912096f, +0.0392447f, +0.0276286f,
  +0.2897338f, +0.3833629f, +0.0110833f, +0.1066716f, -0.0500124f, +0.0976856f, -0.0204489f, -0.0938739f,
  +0.3095790f, -0.2785377f, -0.1065760f, -0.0205561f, -0.2315295f, -0.2884426f, +0.0785312f, +0.0064429f,
  -0.0043257f, +0.0124699f, +0.1581086f, +0.3608855f, +0.3595254f, -0.1677410f, -0.1252404f, +0.5028509f,
  -0.2840225f, -0.1054006f, +0.2620998f, +0.8804605f, +0.1151107f, +0.0671121f, +0.1951981f, +0.2829731f,
  -0.0871003f, -0.0664114f, +0.2171153f, +0.0684369f, -0.3477688f, -0.3672743f, -0.0918551f, +0.0647955f,
  -0.0123644f, -0.0420857f, -0.2203471f, +0.2014021f, -0.0590823f, +0.1347514f, -0.0366714f, +0.0501644f,
  -0.1433149f, +0.0271044f, -0.0891323f, +0.1006474f, +0.0905089f, +0.1901871f, +0.0066585f, +0.1904402f,
  -0.1530974f, -0.0025101f, +0.0675450f, -0.0797355f, -0.0692839f, -0.0700234f, -0.2350538f, +0.2700681f,
  -0.0068787f, -0.0003084f, -0.0689207f, +0.0088958f, +0.1851511f, -0.0182357f, -0.0273909f, +0.1502660f,
  -0.0564491f, -0.1818481f, -0.0638897f, -0.0685512f, -0.1245088f, -0.4121465f, +0.2515367f, +0.2307082f,
  +0.2827726f, -0.0441879f, +0.2345158f, -0.1768323f, -0.0265758f, -0.3586524f, +0.1713861f, +0.0348321f,
  +0.0468755f, -0.3243262f, -0.0078282f, -0.3231575f, +0.2228394f, +0.2336577f, -0.1622735f, -0.3046284f,
  +0.2454925f, -0.5792722f, -0.5069413f, +0.6973473f, +0.0674248f, +0.3658891f, -0.1768638f, -0.3627833f,
  +0.1067280f, -0.1024143f, -0.0564684f, +0.2070047f, +0.1516240f, -0.1201839f, +0.2836702f, -0.1300637f,
  +0.0122830f, +0.4330881f, +0.0552198f, -0.0508684f, +0.1144815f, -0.1299652f, +0.0070259f, -0.0790729f,
  -0.1686330f, +0.1155791f, +0.0192717f, -0.0644152f, -0.2097974f, +0.0293363f, +0.0364205f, +0.1218295f,
  +0.0601585f, +0.1092139f, -0.1079400f, -0.1311577f, -0.0072693f, -0.1257404f, -0.0294142f, -0.1304857f
);

const float biases[4] = float[4](
  +0.0561644f, -0.1500038f, +0.0323222f, -0.0463067f
);

vec4 hook() {
    const vec4 r[9][2] = vec4[9][2](
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 1.0f)))
    );

    float sum[4] = biases;
    for (int n = 0; n < 4; n++) {
        for (int i = 0; i < 9; i++) {
            const vec4 k0 = vec4(kernels[n * 8 * 9 + 8 * i + 0], kernels[n * 8 * 9 + 8 * i + 1], kernels[n * 8 * 9 + 8 * i + 2], kernels[n * 8 * 9 + 8 * i + 3]);
            const vec4 k1 = vec4(kernels[n * 8 * 9 + 8 * i + 4], kernels[n * 8 * 9 + 8 * i + 5], kernels[n * 8 * 9 + 8 * i + 6], kernels[n * 8 * 9 + 8 * i + 7]);
            sum[n] += (dot(k0, r[i][0]) + dot(k1, r[i][1]));
        }
    }

    return ACTIVE(vec4(sum[0], sum[1], sum[2], sum[3]));
}

//!HOOK LUMA
//!DESC ARNet b16 Layer10 L0
//!WHEN OUTPUT.w LUMA.w / 1.2 > OUTPUT.h LUMA.h / 1.2 > *
//!BIND TMP1_L0
//!BIND TMP1_L1
//!BIND TMP2_L0
//!SAVE TMP2_L0
//!COMPONENTS 4

#define ACTIVE(v) (v)

#define TEX_BIND_L0_TEXOFF TMP1_L0_texOff
#define TEX_BIND_L0_TEX TMP1_L0_tex
#define TEX_BIND_L0_POS TMP1_L0_pos
#define TEX_BIND_L0_SIZE TMP1_L0_size
#define TEX_BIND_L0_PT TMP1_L0_pt

#define TEX_BIND_L1_TEXOFF TMP1_L1_texOff
#define TEX_BIND_L1_TEX TMP1_L1_tex
#define TEX_BIND_L1_POS TMP1_L1_pos
#define TEX_BIND_L1_SIZE TMP1_L1_size
#define TEX_BIND_L1_PT TMP1_L1_pt

#define TEX_BIND_L2_TEXOFF TMP2_L0_texOff
#define TEX_BIND_L2_TEX TMP2_L0_tex
#define TEX_BIND_L2_POS TMP2_L0_pos
#define TEX_BIND_L2_SIZE TMP2_L0_size
#define TEX_BIND_L2_PT TMP2_L0_pt

const float kernels[288] = float[288](
  -0.0444951f, -0.0444116f, -0.2667500f, -0.6105476f, +0.1929605f, +0.1498322f, +0.2803074f, +0.0918579f,
  +0.4429863f, -0.2786261f, +0.1285425f, +0.1292466f, +0.4192528f, -0.5414392f, -0.3144574f, -0.1644810f,
  -0.0024051f, +0.1347601f, -0.1741709f, +0.0656072f, -0.0881078f, -0.5622313f, +0.0637649f, +0.0015871f,
  +0.0122620f, -0.1095316f, +0.0801930f, -0.2928568f, +0.1621080f, +0.3193507f, -0.0662209f, -0.3383912f,
  -0.1219020f, -0.1124157f, -0.0685159f, -0.3366412f, +0.2650093f, +0.0048777f, +0.6391453f, +0.1184116f,
  -0.0247042f, +0.2108304f, +0.0176139f, -0.0843665f, +0.0319692f, -0.0144150f, +0.2533368f, +0.4007219f,
  +0.3037344f, +0.1004689f, -0.0879537f, +0.0437099f, +0.2458877f, +0.3012153f, -0.0519625f, -0.3807568f,
  -0.0183146f, -0.1065207f, -0.3165162f, -0.2161392f, +0.0348183f, +0.3723015f, -0.1256017f, -0.7445021f,
  +0.2369440f, -0.2777061f, -0.2627467f, +0.1446041f, +0.1040112f, +0.2773324f, +0.0816622f, -0.2481551f,
  +0.4439476f, +0.1496565f, -0.0619309f, +0.5166037f, +0.0574582f, -0.5397601f, -0.1200358f, +0.0648548f,
  +0.0227303f, +0.4049661f, +0.2423836f, -0.1696364f, -0.6338492f, -0.3452031f, -0.4101585f, +0.2689190f,
  +0.0543386f, +0.0220801f, -0.1664285f, +0.0530877f, -0.4713638f, -0.3403441f, +0.0939344f, -0.0047124f,
  +0.0753297f, +0.3208727f, -0.2576484f, -0.0188018f, -0.1860183f, -0.0036664f, -0.4016466f, +0.2031974f,
  +0.0052451f, +0.3767574f, -0.0796638f, +0.1713753f, -0.1389739f, -0.0238207f, -0.3231676f, +0.6965120f,
  +0.1134108f, -0.3110805f, -0.1354440f, +0.1266298f, +0.0044685f, -0.0948230f, -0.0595502f, +0.1759966f,
  -0.1376852f, -0.0572578f, +0.1883407f, +0.0448715f, -0.0224741f, -0.3961326f, +0.1282681f, +0.2335332f,
  +0.1899169f, +0.1082417f, +0.0525967f, -0.0575898f, -0.2880663f, +0.0439473f, +0.0974883f, +0.2576266f,
  +0.0982517f, +0.0614135f, +0.1062882f, -0.1236272f, -0.2873451f, +0.1919241f, +0.0017712f, -0.1215054f,
  +0.0266554f, -0.1797182f, -0.2826542f, -0.3955116f, -0.0237644f, +0.5456286f, -0.3066460f, -0.1674721f,
  +0.3892765f, -0.7568594f, -0.2161507f, +0.1255552f, -0.4198641f, +0.2409227f, -0.4644324f, +0.1233142f,
  +0.1229966f, -0.6835927f, -0.0818037f, +0.0466176f, -0.0785208f, +0.2147569f, -0.2297579f, -0.0831459f,
  -0.0988996f, -0.0283278f, -0.1178704f, -0.4133275f, -0.0626115f, +0.0900890f, -0.2895986f, -0.0453698f,
  -0.1843095f, -0.1659635f, +0.1801987f, +0.3022979f, -0.0417703f, +0.1977877f, -0.2364963f, +0.0742663f,
  -0.0482738f, -0.7014990f, +0.2873404f, -0.0925348f, +0.0976561f, +0.2870344f, -0.1375184f, -0.0253049f,
  -0.0695284f, -0.0186105f, +0.1425644f, -0.1188989f, -0.0680581f, +0.3433631f, -0.1293168f, +0.1410633f,
  +0.2005332f, -0.0047435f, +0.1791075f, +0.0599157f, -0.0600792f, -0.0110257f, -0.0884823f, -0.0114559f,
  +0.1007767f, +0.1534936f, -0.0635445f, -0.0579376f, -0.1656720f, -0.1506133f, -0.0344187f, -0.1745961f,
  -0.1678317f, -0.1412946f, +0.3027479f, +0.0338062f, +0.1303134f, -0.0599488f, +0.3341682f, +0.0828852f,
  -0.1050049f, -0.4625970f, -0.3784185f, +0.7193387f, -0.3541446f, -0.2129505f, -0.2065994f, -0.0932323f,
  -0.5476769f, -0.3949107f, +0.1701202f, -0.0878009f, +0.0047999f, +0.3290707f, -0.4698638f, -0.0865447f,
  +0.1470365f, -0.1096665f, -0.1516358f, -0.1008795f, +0.2084194f, -0.3178546f, -0.0443857f, +0.2828830f,
  -0.3238425f, -0.2641981f, -0.0375898f, +0.6257953f, -0.3626578f, -0.5078607f, -0.1836291f, +0.6712658f,
  -0.2025052f, -0.1643447f, -0.0430617f, -0.0781966f, +0.0809850f, +0.0127173f, -0.2371867f, +0.1228161f,
  +0.0647365f, -0.0230202f, -0.1333596f, +0.2501693f, +0.1863348f, -0.1222581f, -0.0602203f, -0.1185861f,
  -0.0970354f, -0.1247348f, -0.1190135f, +0.1020168f, -0.0213402f, -0.2519371f, +0.3313311f, +0.2080491f,
  +0.2649094f, +0.1169316f, +0.2320307f, +0.0036375f, -0.4178063f, +0.5135634f, -0.1423231f, +0.1946466f
);

const float biases[4] = float[4](
  -0.0155708f, +0.0441722f, +0.0492539f, +0.0896092f
);

vec4 hook() {
    const vec4 r[9][2] = vec4[9][2](
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 1.0f)))
    );

    float sum[4] = biases;
    for (int n = 0; n < 4; n++) {
        for (int i = 0; i < 9; i++) {
            const vec4 k0 = vec4(kernels[n * 8 * 9 + 8 * i + 0], kernels[n * 8 * 9 + 8 * i + 1], kernels[n * 8 * 9 + 8 * i + 2], kernels[n * 8 * 9 + 8 * i + 3]);
            const vec4 k1 = vec4(kernels[n * 8 * 9 + 8 * i + 4], kernels[n * 8 * 9 + 8 * i + 5], kernels[n * 8 * 9 + 8 * i + 6], kernels[n * 8 * 9 + 8 * i + 7]);
            sum[n] += (dot(k0, r[i][0]) + dot(k1, r[i][1]));
        }
    }

    return ACTIVE(vec4(sum[0], sum[1], sum[2], sum[3]) * 0.2000000f + TEX_BIND_L2_TEXOFF(vec2(0.0f, 0.0f)));
}

//!HOOK LUMA
//!DESC ARNet b16 Layer10 L1
//!WHEN OUTPUT.w LUMA.w / 1.2 > OUTPUT.h LUMA.h / 1.2 > *
//!BIND TMP1_L0
//!BIND TMP1_L1
//!BIND TMP2_L1
//!SAVE TMP2_L1
//!COMPONENTS 4

#define ACTIVE(v) (v)

#define TEX_BIND_L0_TEXOFF TMP1_L0_texOff
#define TEX_BIND_L0_TEX TMP1_L0_tex
#define TEX_BIND_L0_POS TMP1_L0_pos
#define TEX_BIND_L0_SIZE TMP1_L0_size
#define TEX_BIND_L0_PT TMP1_L0_pt

#define TEX_BIND_L1_TEXOFF TMP1_L1_texOff
#define TEX_BIND_L1_TEX TMP1_L1_tex
#define TEX_BIND_L1_POS TMP1_L1_pos
#define TEX_BIND_L1_SIZE TMP1_L1_size
#define TEX_BIND_L1_PT TMP1_L1_pt

#define TEX_BIND_L2_TEXOFF TMP2_L1_texOff
#define TEX_BIND_L2_TEX TMP2_L1_tex
#define TEX_BIND_L2_POS TMP2_L1_pos
#define TEX_BIND_L2_SIZE TMP2_L1_size
#define TEX_BIND_L2_PT TMP2_L1_pt

const float kernels[288] = float[288](
  +0.3448132f, +0.2172740f, -0.4152694f, -0.2092692f, +0.1884944f, -0.5376842f, -0.2348615f, +0.1670183f,
  -0.1320652f, +0.1319976f, +0.1941476f, -0.3022651f, +0.0271460f, -0.1449344f, +0.1127821f, +0.4342977f,
  +0.0105092f, +0.2830883f, +0.2324721f, -0.0245397f, +0.2187921f, -0.5090028f, -0.1746231f, +0.2761388f,
  +0.0577111f, +0.1796613f, -0.1227396f, -0.1200591f, -0.1720216f, +0.1850847f, -0.1649143f, +0.1671320f,
  +0.0981095f, +0.6935945f, +0.2952435f, -0.6096207f, +0.0694961f, -0.0994942f, -0.1552082f, +0.4666148f,
  +0.3733653f, -0.0706333f, -0.3037971f, +0.0519105f, -0.0462433f, -0.3619605f, +0.1094045f, -0.3686933f,
  -0.1126512f, +0.1873754f, +0.0196297f, -0.0949207f, +0.1319253f, -0.2070697f, -0.1121181f, +0.1211981f,
  +0.1039092f, +0.1040087f, -0.1009106f, +0.0208560f, +0.0279945f, +0.1184609f, -0.0411016f, +0.4666980f,
  -0.1817936f, +0.2747102f, -0.1744790f, +0.0018797f, +0.1571523f, -0.2841465f, +0.1139939f, +0.3048678f,
  +0.0843738f, +0.2242584f, +0.1818785f, +0.2843159f, +0.0224933f, +0.1076924f, +0.0084612f, -0.0164894f,
  +0.0874990f, +0.2613623f, +0.3318251f, -0.1845269f, -0.0235039f, +0.2492782f, +0.1098637f, -0.0085788f,
  +0.0328727f, +0.2512942f, +0.0626699f, +0.0318113f, +0.0928728f, +0.0652051f, +0.1623216f, +0.1985550f,
  +0.0080955f, +0.2433862f, +0.1467995f, +0.2858248f, +0.1568914f, +0.2288417f, -0.1258780f, -0.0434479f,
  +0.0058531f, +0.0573518f, +0.1258188f, -0.1432853f, -0.0627442f, -0.2290045f, -0.2154521f, -0.2203324f,
  +0.2291422f, -0.1283862f, -0.2690559f, +0.1716699f, -0.1818022f, -0.3670270f, -0.0645445f, -0.2082189f,
  -0.0560496f, -0.0585477f, +0.1169336f, +0.1135711f, -0.1612214f, -0.0024153f, +0.0822568f, -0.0590614f,
  +0.0477214f, -0.0026666f, +0.1384749f, -0.0917990f, -0.2151241f, +0.2960250f, -0.0379755f, +0.3613751f,
  -0.1039386f, +0.0041934f, -0.0521758f, -0.0229678f, +0.1715517f, +0.1627404f, -0.0129871f, +0.0481752f,
  -0.0289343f, +0.4973141f, +0.0638885f, -0.1667278f, -0.1149515f, +0.0554752f, +0.0646211f, -0.1256687f,
  -0.0312519f, +0.0397946f, +0.4243991f, +0.1304568f, -0.3590899f, +0.0697207f, -0.3745225f, +0.2845296f,
  -0.2207587f, -0.0388510f, +0.1380560f, -0.0143736f, +0.0384348f, -0.0424101f, -0.0893080f, +0.0279533f,
  -0.0133573f, +0.0884777f, +0.0689446f, -0.1827277f, -0.1560398f, +0.1133684f, +0.0161762f, -0.0058620f,
  +0.0437885f, -0.2907202f, +0.1323045f, +0.1250501f, -0.1508005f, +0.3486148f, -0.2466573f, +0.0804913f,
  +0.0024467f, -0.1958773f, +0.0707712f, -0.0566502f, -0.0980518f, -0.0255704f, +0.1032141f, +0.4059487f,
  -0.0819595f, +0.2514369f, +0.1869224f, -0.1782118f, +0.3359632f, +0.3963205f, -0.3021469f, -0.0114370f,
  +0.1127545f, +0.1613995f, +0.0695967f, -0.0367577f, +0.1371204f, +0.1549693f, -0.0773081f, +0.0738987f,
  -0.0272057f, +0.0819742f, -0.0046259f, -0.0533178f, +0.0910946f, +0.3402394f, +0.0358097f, +0.4176623f,
  +0.0428036f, -0.2821999f, -0.2128485f, -0.0228907f, +0.0806699f, -0.1841483f, +0.0420933f, +0.1306235f,
  -0.2732913f, +0.0738220f, -0.0176253f, +0.0164166f, -0.0535757f, -0.0968650f, +0.1628040f, +0.0034606f,
  -0.0365572f, +0.0700390f, +0.0486568f, +0.0199589f, -0.1783107f, +0.1376598f, -0.0190966f, +0.2073134f,
  +0.0612327f, -0.0921018f, -0.2384011f, -0.0474161f, +0.1063762f, -0.0952839f, -0.1096677f, +0.0782089f,
  +0.1075682f, +0.0629255f, -0.2194319f, -0.2410560f, +0.3000502f, -0.1852708f, +0.2932536f, +0.2426547f,
  -0.2204430f, +0.3364926f, -0.1008586f, +0.0627976f, +0.0827444f, +0.0984094f, +0.0812447f, +0.1498125f,
  +0.1404925f, +0.0016620f, -0.1698787f, +0.0192963f, +0.0345355f, -0.0204910f, +0.0551147f, +0.1255952f,
  -0.0554832f, +0.0531168f, -0.2215041f, -0.0381228f, -0.0424639f, -0.1610665f, -0.0816383f, -0.2395614f,
  +0.1792873f, -0.0464371f, +0.1000523f, +0.0680029f, +0.0008003f, +0.2114426f, +0.0643839f, -0.1532060f
);

const float biases[4] = float[4](
  -0.0640714f, -0.0051311f, -0.0187591f, -0.0019891f
);

vec4 hook() {
    const vec4 r[9][2] = vec4[9][2](
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 1.0f)))
    );

    float sum[4] = biases;
    for (int n = 0; n < 4; n++) {
        for (int i = 0; i < 9; i++) {
            const vec4 k0 = vec4(kernels[n * 8 * 9 + 8 * i + 0], kernels[n * 8 * 9 + 8 * i + 1], kernels[n * 8 * 9 + 8 * i + 2], kernels[n * 8 * 9 + 8 * i + 3]);
            const vec4 k1 = vec4(kernels[n * 8 * 9 + 8 * i + 4], kernels[n * 8 * 9 + 8 * i + 5], kernels[n * 8 * 9 + 8 * i + 6], kernels[n * 8 * 9 + 8 * i + 7]);
            sum[n] += (dot(k0, r[i][0]) + dot(k1, r[i][1]));
        }
    }

    return ACTIVE(vec4(sum[0], sum[1], sum[2], sum[3]) * 0.2000000f + TEX_BIND_L2_TEXOFF(vec2(0.0f, 0.0f)));
}

//!HOOK LUMA
//!DESC ARNet b16 Layer11 L0
//!WHEN OUTPUT.w LUMA.w / 1.2 > OUTPUT.h LUMA.h / 1.2 > *
//!BIND TMP2_L0
//!BIND TMP2_L1
//!SAVE TMP1_L0
//!COMPONENTS 4

#define ACTIVE(v) (max(v, v * 0.2000000f))

#define TEX_BIND_L0_TEXOFF TMP2_L0_texOff
#define TEX_BIND_L0_TEX TMP2_L0_tex
#define TEX_BIND_L0_POS TMP2_L0_pos
#define TEX_BIND_L0_SIZE TMP2_L0_size
#define TEX_BIND_L0_PT TMP2_L0_pt

#define TEX_BIND_L1_TEXOFF TMP2_L1_texOff
#define TEX_BIND_L1_TEX TMP2_L1_tex
#define TEX_BIND_L1_POS TMP2_L1_pos
#define TEX_BIND_L1_SIZE TMP2_L1_size
#define TEX_BIND_L1_PT TMP2_L1_pt

const float kernels[288] = float[288](
  +0.2671572f, +0.1102831f, +0.0438638f, -0.3437929f, -0.1726165f, +0.1677082f, +0.1860646f, -0.1954340f,
  +0.0592160f, +0.4338931f, +0.1849628f, -0.0165754f, -0.1874245f, +0.5814728f, -0.1239050f, -0.6091964f,
  -0.2975733f, -0.2494751f, -0.2026142f, +0.1383592f, -0.1639765f, +0.2746574f, +0.0571467f, -0.0861075f,
  -0.3166435f, +0.2674917f, -0.1991087f, -0.0931671f, +0.7172538f, +0.2170968f, +0.2778604f, -0.1624226f,
  -0.2739635f, +0.0635465f, +0.5274140f, -0.3818074f, +0.1790422f, -0.0829504f, +0.1815277f, +0.2588663f,
  -0.1200576f, +0.2596043f, +0.1535144f, -0.2315819f, +0.1636183f, +0.0248476f, -0.1055616f, -0.0082520f,
  -0.2168625f, +0.3260661f, +0.0752328f, +0.1519776f, -0.0410457f, -0.0328136f, +0.3804216f, +0.0343401f,
  -0.3366003f, +0.4852945f, +0.0619528f, -0.2844650f, +0.2757498f, -0.1691057f, +0.5950453f, +0.0195029f,
  -0.1497135f, -0.0138560f, +0.0770402f, +0.2552215f, -0.0183561f, -0.1847334f, +0.3005434f, +0.0386436f,
  +0.0198014f, +0.1128541f, -0.2393335f, +0.2170431f, +0.0624239f, +0.3165127f, +0.0097663f, +0.0434102f,
  +0.0887682f, -0.1787977f, -0.1083071f, -0.2863992f, -0.1843113f, +0.3494819f, -0.4098867f, -0.2345692f,
  +0.0576908f, +0.3984268f, -0.3510652f, +0.1009859f, +0.1364435f, +0.4605909f, -0.0696041f, -0.1693035f,
  -0.1740052f, -0.2377215f, +0.0808857f, -0.1789054f, -0.0797697f, -0.0696471f, -0.2213491f, -0.0329482f,
  +0.2838023f, -0.0478061f, -0.6085666f, -0.2313296f, -0.6861124f, -0.1288296f, +0.1628978f, -0.0195806f,
  +0.1900721f, -0.0982000f, -0.2837040f, -0.0840033f, -0.0823507f, +0.0124125f, -0.0577722f, +0.1572794f,
  +0.1228182f, +0.1281002f, +0.1467679f, +0.1490090f, +0.0648782f, -0.1314142f, +0.0446439f, -0.0014104f,
  -0.2131923f, +0.2706392f, +0.1113346f, -0.1156483f, -0.3044542f, -0.0533690f, -0.4042837f, +0.1746063f,
  -0.2099609f, -0.1131296f, +0.1378865f, +0.1772064f, -0.0295354f, -0.1978520f, +0.2003074f, -0.1307236f,
  -0.2169349f, +0.1853381f, +0.2937386f, -0.3382695f, +0.0385788f, -0.0182309f, +0.0166779f, -0.0698446f,
  -0.4142360f, -0.7486795f, -0.2218008f, +0.0143751f, +0.1478872f, -0.0434253f, +0.0448639f, -0.0863531f,
  +0.1926117f, +0.0793415f, +0.2506850f, +0.1187465f, -0.1347692f, +0.0520707f, +0.3368540f, -0.1420546f,
  +0.1707125f, +0.2621839f, +0.5440425f, -0.2299591f, +0.2633989f, +0.2305934f, +0.3598376f, +0.2056204f,
  +0.2246367f, -0.1627833f, -0.0259332f, -0.5049325f, +0.3763183f, -0.0013994f, -0.5391484f, -0.3919843f,
  -0.2650686f, -0.1226381f, +0.0640866f, +0.2226886f, -0.1328004f, -0.4170415f, +0.4019603f, -0.0049051f,
  -0.2079546f, +0.3321860f, -0.4192287f, +0.2752882f, +0.5414289f, +0.1297849f, +0.4764982f, -0.1382380f,
  -0.3387354f, -0.2568211f, +0.8674692f, -0.4214746f, -0.2347797f, +0.1832446f, +0.0103389f, +0.1573801f,
  -0.1482299f, -0.1337564f, +0.3067535f, -0.0335094f, -0.0906021f, -0.2090288f, -0.0447926f, -0.0020003f,
  +0.3996337f, +0.3016383f, +0.3141324f, +0.0710192f, +0.0405208f, -0.1426972f, -0.1104305f, +0.1595614f,
  -0.0098310f, -0.4010782f, +0.2107759f, -0.1940733f, +0.1281030f, -0.2820249f, +0.0153176f, +0.0847246f,
  -0.0118580f, -0.3353000f, -0.0273264f, -0.3335333f, +0.0944384f, -0.0690306f, +0.0745987f, +0.0102235f,
  -0.0744434f, +0.3036743f, -0.0194388f, +0.1801815f, +0.1139942f, -0.0408460f, +0.0561812f, +0.2888331f,
  +0.2908135f, -0.3157306f, -0.1776642f, -0.1783025f, -0.1523574f, -0.1529236f, +0.2592855f, -0.4187047f,
  +0.0956282f, -0.6481810f, +0.0782034f, +0.4994776f, -0.0596893f, -0.1496120f, -0.1287646f, -0.0531297f,
  -0.0325224f, +0.0967124f, +0.0887315f, +0.0286533f, -0.0500866f, +0.0608794f, -0.0477646f, +0.1050504f,
  -0.2506246f, -0.1280993f, +0.0221935f, +0.2432452f, -0.2167520f, +0.0924004f, -0.1676925f, +0.1561769f,
  -0.3202342f, +0.2448071f, +0.2006448f, -0.1684020f, +0.0498362f, -0.1708039f, -0.0752237f, +0.0760913f
);

const float biases[4] = float[4](
  +0.0015089f, +0.0239044f, -0.0167243f, +0.0438745f
);

vec4 hook() {
    const vec4 r[9][2] = vec4[9][2](
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 1.0f)))
    );

    float sum[4] = biases;
    for (int n = 0; n < 4; n++) {
        for (int i = 0; i < 9; i++) {
            const vec4 k0 = vec4(kernels[n * 8 * 9 + 8 * i + 0], kernels[n * 8 * 9 + 8 * i + 1], kernels[n * 8 * 9 + 8 * i + 2], kernels[n * 8 * 9 + 8 * i + 3]);
            const vec4 k1 = vec4(kernels[n * 8 * 9 + 8 * i + 4], kernels[n * 8 * 9 + 8 * i + 5], kernels[n * 8 * 9 + 8 * i + 6], kernels[n * 8 * 9 + 8 * i + 7]);
            sum[n] += (dot(k0, r[i][0]) + dot(k1, r[i][1]));
        }
    }

    return ACTIVE(vec4(sum[0], sum[1], sum[2], sum[3]));
}

//!HOOK LUMA
//!DESC ARNet b16 Layer11 L1
//!WHEN OUTPUT.w LUMA.w / 1.2 > OUTPUT.h LUMA.h / 1.2 > *
//!BIND TMP2_L0
//!BIND TMP2_L1
//!SAVE TMP1_L1
//!COMPONENTS 4

#define ACTIVE(v) (max(v, v * 0.2000000f))

#define TEX_BIND_L0_TEXOFF TMP2_L0_texOff
#define TEX_BIND_L0_TEX TMP2_L0_tex
#define TEX_BIND_L0_POS TMP2_L0_pos
#define TEX_BIND_L0_SIZE TMP2_L0_size
#define TEX_BIND_L0_PT TMP2_L0_pt

#define TEX_BIND_L1_TEXOFF TMP2_L1_texOff
#define TEX_BIND_L1_TEX TMP2_L1_tex
#define TEX_BIND_L1_POS TMP2_L1_pos
#define TEX_BIND_L1_SIZE TMP2_L1_size
#define TEX_BIND_L1_PT TMP2_L1_pt

const float kernels[288] = float[288](
  +0.0749860f, +0.1018991f, -0.0366894f, -0.2629363f, -0.0005061f, -0.0781822f, -0.0419105f, -0.0730810f,
  +0.2325600f, -0.0940817f, -0.0853537f, -0.1947984f, +0.3254217f, +0.0232921f, +0.0435481f, -0.0724449f,
  +0.0924973f, -0.0230363f, -0.0015900f, -0.1442857f, -0.0279522f, +0.0679627f, +0.3054749f, -0.0074983f,
  +0.3375306f, +0.1066280f, +0.1214990f, +0.0070289f, +0.5357372f, -0.0205640f, -0.1436410f, +0.1770594f,
  -0.0244946f, -0.0146483f, -0.0831211f, -0.2219819f, +0.2524594f, -0.2430930f, +0.2051391f, +0.3958442f,
  -0.1106936f, -0.2007097f, -0.0732677f, +0.2254823f, -0.0467484f, +0.0293627f, -0.0942374f, -0.0809185f,
  +0.0113587f, +0.0565198f, -0.2742970f, -0.5615931f, +0.0578174f, +0.0148123f, -0.1022142f, +0.2330430f,
  -0.2444185f, -0.4654882f, +0.6031011f, +0.5949820f, -0.1414567f, -0.4352935f, -0.3025692f, -0.0270272f,
  +0.1899845f, +0.1877830f, -0.2036979f, -0.2227711f, +0.1628356f, +0.0554995f, -0.2018185f, -0.1222189f,
  -0.6764404f, -0.0577611f, -0.7004619f, -0.4590501f, -0.2443575f, -0.1646303f, +0.5158720f, -0.2510622f,
  +0.2954188f, +0.2774146f, -0.1326684f, +1.1056591f, -0.2843403f, -0.1054225f, -0.1268468f, +0.3525224f,
  -0.1405089f, +0.2579093f, +0.0349454f, +0.2764810f, +0.1528620f, -0.0874984f, +0.0648499f, -0.0082350f,
  -0.0708597f, -0.7533700f, +0.1334134f, +0.5859100f, -0.7411583f, +0.0263869f, -0.3653121f, -0.0909003f,
  +0.8718560f, -0.2361445f, +0.4523468f, -0.0460747f, +0.1791669f, +0.5614795f, +0.3164681f, -0.1868585f,
  -0.1916419f, +0.1595819f, +0.1337347f, -0.2269813f, -0.2085118f, +0.0648269f, +0.0386088f, +0.0988377f,
  -0.0071351f, -0.1519169f, +0.0806199f, +0.4931312f, -0.3384717f, +0.0270629f, +0.0260656f, -0.0281225f,
  -0.0184492f, +0.3100887f, +0.1364054f, -0.2430521f, +0.0572301f, +0.0760096f, -0.3170728f, +0.1747238f,
  -0.0207522f, -0.1501776f, -0.1959909f, +0.0488973f, -0.1294398f, -0.0582420f, +0.0192560f, -0.1452057f,
  -0.1935557f, -0.0012349f, +0.1405642f, +0.0370315f, +0.0463104f, -0.1288221f, +0.0125686f, -0.0449208f,
  +0.3809028f, +0.1339513f, -0.1966064f, +0.1941278f, -0.0399091f, -0.1120898f, +0.3517509f, +0.4010904f,
  -0.0657872f, -0.1932017f, -0.1598174f, -0.3986087f, +0.2338417f, +0.2324187f, -0.4225964f, -0.1740808f,
  -0.1555100f, -0.2383851f, +0.3384912f, +0.2063426f, +0.0385693f, +0.0033789f, -0.1606335f, -0.0441704f,
  -0.0574976f, -0.3005600f, +0.1083781f, -0.1631054f, -0.3152518f, -0.0305204f, -0.2123946f, -0.0064200f,
  +0.0871461f, +0.6070423f, +0.0883928f, -0.0658298f, -0.1137292f, -0.1634246f, +0.1648023f, +0.1214247f,
  +0.0590295f, +0.3144686f, +0.0177510f, +0.2758125f, +0.2641426f, +0.0072874f, +0.2158566f, +0.3036332f,
  -0.1577045f, -0.4330337f, -0.2008220f, -0.3509877f, -0.1666467f, +0.0011112f, -0.4761904f, -0.4349853f,
  +0.0518980f, +0.1309545f, -0.1201826f, +0.3960869f, -0.1217888f, +0.1013322f, +0.3964718f, +0.0114266f,
  -0.2438598f, +0.1242612f, -0.1946706f, +0.0826217f, -0.1608090f, +0.2249415f, -0.0039845f, -0.3060203f,
  -0.4614984f, +0.0466919f, +0.4313616f, -0.1421254f, -0.2354416f, -0.0803922f, -0.2234440f, +0.0381338f,
  +0.1638123f, -0.3160169f, +0.1571752f, -0.1486126f, +0.0962220f, +0.2852286f, -0.0088307f, -0.0750998f,
  -0.1286970f, -0.1335738f, +0.2211528f, -0.3468699f, +0.0209708f, -0.0179616f, -0.2916600f, +0.1468084f,
  -0.1240899f, +0.1166737f, -0.5635704f, -0.0932438f, -0.3305489f, +0.1935547f, +0.2468058f, -0.1558946f,
  -0.3411452f, -0.0624542f, -0.0137181f, -0.0555080f, +0.1017268f, -0.1084546f, -0.0830902f, -0.2282216f,
  -0.1431163f, +0.1028194f, -0.0639246f, +0.0642225f, -0.0786643f, +0.0456666f, +0.0687433f, -0.0026485f,
  +0.0879987f, +0.2618229f, -0.2367138f, -0.1033116f, +0.0198804f, -0.0271845f, +0.0755628f, -0.0113104f,
  -0.2598985f, -0.0694878f, +0.0721937f, -0.3199887f, +0.0637865f, -0.0484566f, -0.1464669f, +0.0796950f
);

const float biases[4] = float[4](
  +0.0427935f, -0.0516787f, +0.0136282f, +0.0442197f
);

vec4 hook() {
    const vec4 r[9][2] = vec4[9][2](
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 1.0f)))
    );

    float sum[4] = biases;
    for (int n = 0; n < 4; n++) {
        for (int i = 0; i < 9; i++) {
            const vec4 k0 = vec4(kernels[n * 8 * 9 + 8 * i + 0], kernels[n * 8 * 9 + 8 * i + 1], kernels[n * 8 * 9 + 8 * i + 2], kernels[n * 8 * 9 + 8 * i + 3]);
            const vec4 k1 = vec4(kernels[n * 8 * 9 + 8 * i + 4], kernels[n * 8 * 9 + 8 * i + 5], kernels[n * 8 * 9 + 8 * i + 6], kernels[n * 8 * 9 + 8 * i + 7]);
            sum[n] += (dot(k0, r[i][0]) + dot(k1, r[i][1]));
        }
    }

    return ACTIVE(vec4(sum[0], sum[1], sum[2], sum[3]));
}

//!HOOK LUMA
//!DESC ARNet b16 Layer12 L0
//!WHEN OUTPUT.w LUMA.w / 1.2 > OUTPUT.h LUMA.h / 1.2 > *
//!BIND TMP1_L0
//!BIND TMP1_L1
//!BIND TMP2_L0
//!SAVE TMP2_L0
//!COMPONENTS 4

#define ACTIVE(v) (v)

#define TEX_BIND_L0_TEXOFF TMP1_L0_texOff
#define TEX_BIND_L0_TEX TMP1_L0_tex
#define TEX_BIND_L0_POS TMP1_L0_pos
#define TEX_BIND_L0_SIZE TMP1_L0_size
#define TEX_BIND_L0_PT TMP1_L0_pt

#define TEX_BIND_L1_TEXOFF TMP1_L1_texOff
#define TEX_BIND_L1_TEX TMP1_L1_tex
#define TEX_BIND_L1_POS TMP1_L1_pos
#define TEX_BIND_L1_SIZE TMP1_L1_size
#define TEX_BIND_L1_PT TMP1_L1_pt

#define TEX_BIND_L2_TEXOFF TMP2_L0_texOff
#define TEX_BIND_L2_TEX TMP2_L0_tex
#define TEX_BIND_L2_POS TMP2_L0_pos
#define TEX_BIND_L2_SIZE TMP2_L0_size
#define TEX_BIND_L2_PT TMP2_L0_pt

const float kernels[288] = float[288](
  +0.1083302f, -0.0270028f, -0.0234276f, +0.0549852f, +0.0922448f, +0.0450065f, -0.0767124f, -0.0646475f,
  +0.0165293f, -0.2430503f, +0.1443400f, -0.1390087f, -0.0365224f, -0.1912612f, -0.2179599f, +0.2696023f,
  +0.0015750f, -0.2870604f, -0.1660515f, -0.1566089f, +0.1945445f, +0.1118542f, -0.0776356f, -0.2631860f,
  +0.0635519f, +0.0497871f, -0.2173091f, -0.0660663f, +0.2989859f, +0.0929620f, -0.2092705f, -0.1869539f,
  +0.1890972f, +0.1543606f, -0.1141094f, -0.0868098f, +0.0763258f, +0.3981553f, +0.2054683f, +0.2399867f,
  -0.2220052f, +0.2723278f, +0.0684321f, -0.0521537f, -0.2560342f, +0.2169963f, +0.1544434f, -0.1238891f,
  +0.0974013f, -0.1586641f, -0.0717459f, -0.2039340f, +0.0240792f, -0.1863557f, -0.2166172f, -0.3700326f,
  +0.3426971f, +0.0659078f, +0.0715393f, -0.0362578f, -0.3643963f, -1.1837548f, -0.3726221f, +0.4277704f,
  +0.0542106f, -0.1215150f, -0.7857155f, -0.4188394f, -0.0547805f, -0.2096684f, -0.1164853f, +0.0467915f,
  +0.1055397f, +0.0728163f, +0.0812718f, -0.0318210f, -0.0991051f, -0.1955030f, +0.2070635f, -0.1545199f,
  -0.0159499f, -0.5568275f, +0.6003161f, -0.0129477f, -0.1942291f, -0.0993999f, +0.1933604f, +0.0059813f,
  -0.0807800f, -0.1352066f, +0.1060470f, +0.0294661f, +0.0724661f, +0.0081773f, -0.0228533f, -0.0432857f,
  -0.1540694f, -0.0555825f, +0.0730553f, +0.3686488f, -0.1381823f, +0.1143252f, -0.1429857f, +0.1873157f,
  -0.1571955f, +0.6731118f, -0.2480729f, +0.1165152f, -0.3314466f, -0.0801801f, -0.1660784f, -0.1977674f,
  +0.0510150f, -0.0551380f, +0.0166438f, +0.2629492f, +0.1143979f, +0.3593659f, +0.0314312f, -0.0414423f,
  +0.0591505f, -0.1617028f, -0.0144796f, -0.0732069f, -0.0081450f, +0.0560471f, +0.0974639f, -0.0752750f,
  +0.1840515f, -0.1141578f, +0.3008634f, +0.1266977f, -0.0656794f, +0.0679482f, +0.0426181f, +0.1145914f,
  +0.2065150f, -0.2196980f, +0.1948921f, +0.2827333f, -0.2498709f, +0.0605715f, -0.0555218f, -0.4232420f,
  +0.0176641f, +0.1545792f, -0.0966574f, +0.1649968f, +0.1742936f, +0.1327240f, +0.3270764f, +0.0220088f,
  -0.0927065f, -0.4502435f, +0.0490212f, +0.2869770f, -0.6161533f, +0.0370159f, -0.0891244f, +0.0453720f,
  +0.1424833f, -0.2032771f, -0.7444973f, +0.1170819f, +0.5465661f, +0.1533187f, +0.0768488f, -0.1347997f,
  -0.2920445f, +0.0857943f, -0.0146690f, +0.1933696f, +0.3616972f, -0.0131796f, +0.1498945f, +0.0657926f,
  -0.5084064f, +0.5553384f, -0.2599510f, -0.3581854f, +0.2003208f, -0.4809021f, +0.3438681f, +0.5809946f,
  -0.4832992f, -0.3940924f, +0.1760514f, +0.3357188f, -0.5215126f, +0.5718508f, +0.1770655f, -0.0582198f,
  -0.3067805f, +0.2320207f, +0.1647826f, +0.0909288f, -0.0343570f, +0.1804778f, +0.0303811f, -0.1607043f,
  -0.2816584f, -0.0216008f, -0.0589111f, +0.0403667f, -0.1428248f, +0.1456621f, +0.3397799f, -0.1348728f,
  -0.3236783f, +0.3722327f, +0.2537176f, -0.2617848f, -0.2157315f, -0.8219303f, +0.0124367f, +0.2491036f,
  -0.1612940f, -0.1642294f, -0.0727222f, +0.2754592f, -0.2057861f, -0.0103339f, +0.3804131f, +0.3749171f,
  -0.0942675f, -0.5144856f, -0.0561733f, -0.1351821f, -0.5052845f, -0.1251948f, -0.1026397f, -0.0814019f,
  +0.0603636f, +0.1445149f, -0.3425483f, +0.0484491f, +0.4125494f, +0.0299532f, -0.0509360f, -0.1439392f,
  -0.0104696f, +0.1841563f, -0.0849157f, -0.2297578f, -0.4422177f, -0.0620469f, +0.6833372f, -0.0026229f,
  +0.6083177f, -0.6209264f, +0.3774625f, +0.1735189f, +0.4390674f, -0.5126164f, +0.3093955f, +0.3889762f,
  +0.0382397f, +0.2259224f, +0.1446042f, +0.3239549f, -0.3388086f, +0.1678727f, -0.0955747f, -0.0204279f,
  +0.2401551f, +0.0333670f, -0.3343808f, +0.2906306f, -0.1434240f, -0.1761930f, +0.4171687f, -0.1147253f,
  +0.0816359f, -0.0095332f, +0.0478497f, +0.3479160f, +0.1297953f, +0.4467319f, +0.3700194f, +0.2374989f,
  -0.0233472f, -0.2666467f, +0.0874538f, +0.3356163f, +0.0487512f, -0.3869662f, -0.0483171f, -0.3131818f
);

const float biases[4] = float[4](
  -0.0133857f, +0.0031100f, -0.0202312f, -0.0667645f
);

vec4 hook() {
    const vec4 r[9][2] = vec4[9][2](
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 1.0f)))
    );

    float sum[4] = biases;
    for (int n = 0; n < 4; n++) {
        for (int i = 0; i < 9; i++) {
            const vec4 k0 = vec4(kernels[n * 8 * 9 + 8 * i + 0], kernels[n * 8 * 9 + 8 * i + 1], kernels[n * 8 * 9 + 8 * i + 2], kernels[n * 8 * 9 + 8 * i + 3]);
            const vec4 k1 = vec4(kernels[n * 8 * 9 + 8 * i + 4], kernels[n * 8 * 9 + 8 * i + 5], kernels[n * 8 * 9 + 8 * i + 6], kernels[n * 8 * 9 + 8 * i + 7]);
            sum[n] += (dot(k0, r[i][0]) + dot(k1, r[i][1]));
        }
    }

    return ACTIVE(vec4(sum[0], sum[1], sum[2], sum[3]) * 0.2000000f + TEX_BIND_L2_TEXOFF(vec2(0.0f, 0.0f)));
}

//!HOOK LUMA
//!DESC ARNet b16 Layer12 L1
//!WHEN OUTPUT.w LUMA.w / 1.2 > OUTPUT.h LUMA.h / 1.2 > *
//!BIND TMP1_L0
//!BIND TMP1_L1
//!BIND TMP2_L1
//!SAVE TMP2_L1
//!COMPONENTS 4

#define ACTIVE(v) (v)

#define TEX_BIND_L0_TEXOFF TMP1_L0_texOff
#define TEX_BIND_L0_TEX TMP1_L0_tex
#define TEX_BIND_L0_POS TMP1_L0_pos
#define TEX_BIND_L0_SIZE TMP1_L0_size
#define TEX_BIND_L0_PT TMP1_L0_pt

#define TEX_BIND_L1_TEXOFF TMP1_L1_texOff
#define TEX_BIND_L1_TEX TMP1_L1_tex
#define TEX_BIND_L1_POS TMP1_L1_pos
#define TEX_BIND_L1_SIZE TMP1_L1_size
#define TEX_BIND_L1_PT TMP1_L1_pt

#define TEX_BIND_L2_TEXOFF TMP2_L1_texOff
#define TEX_BIND_L2_TEX TMP2_L1_tex
#define TEX_BIND_L2_POS TMP2_L1_pos
#define TEX_BIND_L2_SIZE TMP2_L1_size
#define TEX_BIND_L2_PT TMP2_L1_pt

const float kernels[288] = float[288](
  +0.1972883f, -0.0308777f, -0.0338807f, -0.1192335f, +0.0955782f, -0.0971082f, +0.2219869f, +0.1994534f,
  -0.2046500f, +0.0094576f, +0.5079339f, -0.1956312f, +0.0703111f, +0.1383417f, -0.2335430f, -0.0984219f,
  +0.3384331f, -0.0230347f, +0.1760601f, -0.0184344f, +0.1227042f, -0.1941455f, +0.0822653f, -0.0637122f,
  +0.1080950f, +0.0447474f, -0.2138204f, -0.0789308f, -0.0198246f, -0.0876998f, +0.1133621f, +0.0131288f,
  -0.0709039f, +0.3213853f, +0.2465064f, +0.1291442f, +0.2631660f, +0.4514657f, -0.4642979f, +0.1395037f,
  +0.2870141f, -0.0626605f, -0.7100126f, +0.0503681f, -0.0792275f, +0.1500613f, +0.2952108f, +0.0531507f,
  +0.0592936f, -0.0633967f, -0.1234537f, -0.2462919f, -0.0426198f, -0.1556711f, +0.0341255f, -0.0495745f,
  +0.3900924f, -0.1508970f, +0.3095954f, -0.2402441f, -0.0182107f, +0.3050418f, -0.0871876f, +0.0062661f,
  +0.0595119f, +0.0393682f, -0.2639857f, -0.3038912f, +0.1144897f, -0.0545708f, +0.1862690f, +0.2306421f,
  +0.0403211f, +0.1014344f, -0.0042702f, -0.0220261f, -0.0635520f, -0.0281055f, +0.0823406f, -0.1244486f,
  +0.0098777f, +0.0876139f, -0.0361462f, -0.1003428f, +0.1111070f, +0.0496237f, +0.1304860f, -0.2016548f,
  +0.0630401f, +0.1465465f, +0.2348214f, +0.0295748f, -0.0791833f, -0.0028237f, +0.2121184f, +0.0673506f,
  -0.0571561f, -0.0721181f, +0.1126595f, +0.0847472f, -0.2002224f, +0.0222581f, +0.1428269f, -0.0972372f,
  -0.2010843f, -0.1672186f, -0.2932116f, +0.1929959f, -0.1326814f, -0.2406453f, -0.1543625f, -0.2882169f,
  +0.0429304f, +0.0376485f, -0.3409709f, +0.0050416f, -0.0008177f, -0.1891752f, +0.0447459f, -0.0809022f,
  +0.0306166f, -0.2116479f, -0.1393906f, -0.2671681f, -0.1162241f, -0.0371053f, -0.0116778f, -0.2765175f,
  -0.0844740f, +0.3019615f, +0.2526687f, -0.0005852f, -0.1274551f, +0.3938768f, +0.2164316f, +0.0584588f,
  -0.2702864f, -0.1851011f, +0.1736373f, +0.0590295f, +0.1108394f, +0.0834030f, +0.2198956f, -0.0133663f,
  -0.1122553f, +0.0955818f, +0.1309191f, -0.0363010f, +0.1559621f, +0.1066522f, +0.2877814f, +0.2467491f,
  -0.0458672f, +0.2080482f, +0.1653295f, +0.0817654f, -0.0619617f, -0.1652082f, +0.1516297f, -0.2036377f,
  +0.1776787f, -0.0861930f, -0.2387551f, +0.1749929f, +0.3015140f, -0.0256549f, +0.2353165f, +0.1435000f,
  +0.0313493f, +0.0616241f, -0.0621704f, -0.1136018f, +0.1851451f, -0.0200845f, +0.0082824f, -0.0316644f,
  -0.2295721f, -0.0369610f, -0.9810475f, -0.2469609f, -0.2675905f, -0.7867318f, +0.3792292f, -0.0632095f,
  -0.2963183f, +0.1107053f, +0.1867972f, +0.2225045f, +0.0454489f, +0.3025219f, +0.3090523f, +0.1246316f,
  +0.1987700f, -0.3984695f, -0.2444727f, +0.2178156f, +0.1501850f, +0.1320077f, +0.3082911f, +0.0642632f,
  -0.4762369f, +0.0146322f, +0.0593367f, -0.0021631f, +0.1051055f, -0.2046785f, +0.2506966f, +0.5301720f,
  -0.3521211f, +0.1174141f, -0.3576066f, +0.1055030f, +0.0484571f, +0.0114415f, +0.1405988f, -0.0005231f,
  +0.0822186f, -0.1038247f, -0.0406286f, -0.0774019f, -0.0889864f, -0.0906174f, -0.2419479f, -0.0825960f,
  +0.0910447f, -0.2382352f, +0.1521565f, -0.2491136f, +0.2106173f, -0.0737804f, -0.0423952f, +0.1960028f,
  -0.0792006f, -0.0038558f, -0.0070141f, -0.2487368f, -0.0016073f, +0.0364083f, -0.2468968f, +0.0097246f,
  +0.1238929f, -0.0043127f, -0.0188072f, +0.1025169f, -0.0454751f, -0.0419052f, -0.2010461f, +0.0496274f,
  +0.3680786f, +0.3774759f, +0.2882521f, +0.0947746f, +0.0939232f, +0.8333735f, -0.1355369f, +0.0607358f,
  +0.2428847f, +0.1381516f, -0.0083234f, -0.1398563f, -0.0819061f, -0.1327336f, -0.0816614f, -0.0695383f,
  +0.0074805f, +0.2078100f, +0.1289532f, -0.0868608f, +0.0874174f, -0.1231072f, -0.1216789f, -0.0264080f,
  +0.2568742f, -0.1098453f, +0.0544746f, -0.0616373f, +0.1084406f, -0.4511379f, -0.2695326f, -0.1687892f,
  +0.4504443f, -0.1179142f, -0.2093036f, -0.0249154f, -0.0773057f, -0.0796459f, -0.1732802f, -0.0561337f
);

const float biases[4] = float[4](
  -0.0815197f, +0.0412240f, -0.0543488f, -0.0264959f
);

vec4 hook() {
    const vec4 r[9][2] = vec4[9][2](
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 1.0f)))
    );

    float sum[4] = biases;
    for (int n = 0; n < 4; n++) {
        for (int i = 0; i < 9; i++) {
            const vec4 k0 = vec4(kernels[n * 8 * 9 + 8 * i + 0], kernels[n * 8 * 9 + 8 * i + 1], kernels[n * 8 * 9 + 8 * i + 2], kernels[n * 8 * 9 + 8 * i + 3]);
            const vec4 k1 = vec4(kernels[n * 8 * 9 + 8 * i + 4], kernels[n * 8 * 9 + 8 * i + 5], kernels[n * 8 * 9 + 8 * i + 6], kernels[n * 8 * 9 + 8 * i + 7]);
            sum[n] += (dot(k0, r[i][0]) + dot(k1, r[i][1]));
        }
    }

    return ACTIVE(vec4(sum[0], sum[1], sum[2], sum[3]) * 0.2000000f + TEX_BIND_L2_TEXOFF(vec2(0.0f, 0.0f)));
}

//!HOOK LUMA
//!DESC ARNet b16 Layer13 L0
//!WHEN OUTPUT.w LUMA.w / 1.2 > OUTPUT.h LUMA.h / 1.2 > *
//!BIND TMP2_L0
//!BIND TMP2_L1
//!SAVE TMP1_L0
//!COMPONENTS 4

#define ACTIVE(v) (max(v, v * 0.2000000f))

#define TEX_BIND_L0_TEXOFF TMP2_L0_texOff
#define TEX_BIND_L0_TEX TMP2_L0_tex
#define TEX_BIND_L0_POS TMP2_L0_pos
#define TEX_BIND_L0_SIZE TMP2_L0_size
#define TEX_BIND_L0_PT TMP2_L0_pt

#define TEX_BIND_L1_TEXOFF TMP2_L1_texOff
#define TEX_BIND_L1_TEX TMP2_L1_tex
#define TEX_BIND_L1_POS TMP2_L1_pos
#define TEX_BIND_L1_SIZE TMP2_L1_size
#define TEX_BIND_L1_PT TMP2_L1_pt

const float kernels[288] = float[288](
  +0.5543005f, +0.3385632f, +0.2950533f, +0.2586498f, +0.0780806f, +0.0964639f, +0.1676685f, -0.1553633f,
  +0.8298019f, -0.1885716f, +0.6738107f, -0.4486513f, -0.1425495f, +0.1921090f, +0.8937699f, -0.6781082f,
  -0.0056158f, -0.2656154f, +0.1260973f, +0.0423002f, +0.0261889f, +0.3161061f, +0.5158508f, -0.2458104f,
  +0.1006635f, +0.3404931f, +0.4442126f, +0.0172630f, +0.3766363f, +0.0001654f, -0.0556622f, +0.3348071f,
  +0.1413366f, -0.2302973f, +0.7959728f, -0.5502492f, -0.0095421f, -0.1289957f, +0.5190301f, -0.5183334f,
  -0.1121900f, -0.3302365f, +0.5109019f, -0.0800463f, -0.0319336f, +0.3709657f, +0.2067860f, -0.1372795f,
  -0.0912455f, +0.2183981f, +0.1875909f, +0.1229084f, -0.1904103f, -0.0605898f, -0.1100291f, +0.2755060f,
  -0.4408356f, +0.4077738f, -0.0452078f, +0.4397152f, +0.2211214f, -0.2014802f, +0.1616391f, +0.0629774f,
  -0.3293980f, +0.2679702f, -0.2420859f, +0.2621872f, +0.2242105f, +0.1897999f, +0.3807368f, -0.1966162f,
  +0.0002757f, -0.1644178f, -0.2675179f, -0.0159270f, -0.2772247f, -0.1734109f, -0.0241082f, +0.1664113f,
  -0.3955391f, -0.0304106f, -0.0949695f, -0.2191683f, -0.1851320f, -0.1575301f, -0.2189396f, +0.0621734f,
  -0.2403413f, +0.3549702f, -0.1373292f, +0.5516475f, -0.4824141f, -0.1899861f, -0.0958386f, +0.0629331f,
  +0.2541236f, -0.4449509f, -0.0653432f, -0.1265220f, -0.1733835f, -0.1479446f, -0.1838104f, +0.0829248f,
  -0.4106957f, -0.4168312f, -0.7562385f, -0.0146826f, +0.2057653f, +0.1431148f, -0.0047310f, +0.1267274f,
  -0.2424753f, +0.0218970f, +0.1047205f, +0.5423302f, -0.0497524f, +0.0483468f, -0.0176395f, +0.1346704f,
  +0.0346993f, -0.1320105f, -0.3698714f, +0.3712052f, -0.2104807f, +0.0260862f, -0.1147073f, -0.0328148f,
  -0.3137091f, +0.1258577f, -0.0059515f, +0.0348188f, -0.1902774f, +0.0709453f, +0.0934563f, -0.0999974f,
  -0.1871047f, +0.2177519f, -0.0253448f, -0.2796845f, -0.1521922f, +0.0107529f, -0.2103041f, +0.1122392f,
  -0.7933095f, -0.0694236f, +0.1389787f, +0.6010317f, -0.0090828f, +0.1175061f, -0.2071145f, -0.1007517f,
  +0.5547985f, +0.4407749f, +0.4609070f, +0.1225303f, -0.0982305f, -0.3043598f, -0.0654473f, +0.3056560f,
  +0.2689836f, +0.3652650f, +0.0453545f, -0.2542911f, -0.0992846f, +0.0626535f, +0.1633321f, -0.1049065f,
  -0.4232833f, +0.1296719f, +0.0816506f, +0.5282967f, +0.3767347f, +0.2543573f, -0.0519378f, -0.1611665f,
  -0.1857263f, +0.0173354f, +0.4914154f, -0.6671789f, -0.2083776f, -0.1388047f, -0.0406822f, -0.3083018f,
  -0.1369778f, +0.0402511f, -0.0331005f, -0.1514349f, -0.3397269f, +0.0256563f, +0.2490428f, -0.0767926f,
  +0.0889255f, +0.2223680f, -0.0212099f, +0.0790370f, -0.2090794f, +0.3364495f, +0.2963682f, -0.1004869f,
  -0.3392466f, -0.0030969f, +0.1196304f, -0.1378969f, +0.1935292f, +0.1163494f, -0.0918464f, +0.1174635f,
  -0.0205317f, -0.1163098f, -0.0581571f, -0.0755713f, -0.3462992f, +0.1273582f, -0.1116589f, -0.1119341f,
  -0.3015569f, +0.1276826f, -0.1197152f, +0.2722088f, -0.2476320f, +0.1251503f, -0.1067607f, +0.0679036f,
  -0.1911009f, +0.4445986f, -0.2192587f, +0.0686037f, +0.3865155f, +0.0207366f, -0.3601450f, +0.0891874f,
  +0.0751806f, +0.0401427f, +0.0825789f, -0.1774076f, +0.2768072f, -0.0557480f, -0.1409300f, +0.0877982f,
  +0.2553288f, +0.1475433f, +0.0328488f, +0.0601531f, -0.3934215f, -0.0294543f, +0.0782308f, -0.1709399f,
  +0.3227677f, +0.5422496f, -0.4517293f, +0.1765427f, -0.1436285f, -0.1511995f, +0.4889501f, +0.0579005f,
  +0.0147501f, +0.2648376f, -0.0005203f, +0.0577959f, +0.0406552f, -0.1699049f, +0.1876468f, -0.0866129f,
  -0.1396538f, +0.0022724f, +0.3081886f, +0.1007644f, +0.6771588f, -0.0840069f, +0.0502970f, +0.0485031f,
  +0.1928485f, -0.4180058f, +0.3111831f, -0.2220351f, +0.1730237f, +0.0268371f, -0.1404370f, -0.0365568f,
  +0.0369585f, -0.0098864f, -0.1375729f, -0.0626488f, -0.3611461f, +0.1485257f, -0.0795533f, +0.1043601f
);

const float biases[4] = float[4](
  -0.0429631f, +0.0271332f, -0.0106395f, +0.0367359f
);

vec4 hook() {
    const vec4 r[9][2] = vec4[9][2](
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 1.0f)))
    );

    float sum[4] = biases;
    for (int n = 0; n < 4; n++) {
        for (int i = 0; i < 9; i++) {
            const vec4 k0 = vec4(kernels[n * 8 * 9 + 8 * i + 0], kernels[n * 8 * 9 + 8 * i + 1], kernels[n * 8 * 9 + 8 * i + 2], kernels[n * 8 * 9 + 8 * i + 3]);
            const vec4 k1 = vec4(kernels[n * 8 * 9 + 8 * i + 4], kernels[n * 8 * 9 + 8 * i + 5], kernels[n * 8 * 9 + 8 * i + 6], kernels[n * 8 * 9 + 8 * i + 7]);
            sum[n] += (dot(k0, r[i][0]) + dot(k1, r[i][1]));
        }
    }

    return ACTIVE(vec4(sum[0], sum[1], sum[2], sum[3]));
}

//!HOOK LUMA
//!DESC ARNet b16 Layer13 L1
//!WHEN OUTPUT.w LUMA.w / 1.2 > OUTPUT.h LUMA.h / 1.2 > *
//!BIND TMP2_L0
//!BIND TMP2_L1
//!SAVE TMP1_L1
//!COMPONENTS 4

#define ACTIVE(v) (max(v, v * 0.2000000f))

#define TEX_BIND_L0_TEXOFF TMP2_L0_texOff
#define TEX_BIND_L0_TEX TMP2_L0_tex
#define TEX_BIND_L0_POS TMP2_L0_pos
#define TEX_BIND_L0_SIZE TMP2_L0_size
#define TEX_BIND_L0_PT TMP2_L0_pt

#define TEX_BIND_L1_TEXOFF TMP2_L1_texOff
#define TEX_BIND_L1_TEX TMP2_L1_tex
#define TEX_BIND_L1_POS TMP2_L1_pos
#define TEX_BIND_L1_SIZE TMP2_L1_size
#define TEX_BIND_L1_PT TMP2_L1_pt

const float kernels[288] = float[288](
  +0.0686618f, -0.0287912f, +0.0055515f, +0.1569409f, +0.0132410f, -0.0138349f, +0.1031418f, -0.0429416f,
  -0.4069881f, -0.2543702f, -0.1238437f, +0.0996386f, +0.2908508f, -0.2044609f, -0.0688643f, +0.1702621f,
  -0.0518727f, +0.1087326f, +0.0655885f, +0.0016542f, -0.0487956f, -0.1869662f, -0.0588428f, +0.1481143f,
  +0.2180823f, +0.0246425f, +0.3352129f, -0.2734351f, +0.2550966f, +0.0079356f, -0.1635006f, -0.0240302f,
  +0.4873086f, -0.3448793f, +0.5005246f, -0.0750927f, +0.0424246f, +0.5358960f, -0.0738128f, +0.2444419f,
  +0.4162627f, -0.2824890f, +0.0216027f, -0.6237027f, -0.0165685f, -0.0083353f, +0.2591638f, -0.2696206f,
  -0.2820794f, +0.0528482f, -0.0972324f, +0.0550376f, +0.1705327f, -0.0515261f, +0.0335005f, +0.1447763f,
  +0.2940372f, -0.1331732f, +0.1673805f, -0.6373704f, +0.1132387f, -0.3547182f, -0.2943767f, -0.2514933f,
  +0.0466550f, -0.2527790f, -0.0911848f, +0.2215334f, -0.1188079f, +0.2335160f, +0.1349886f, -0.2351607f,
  -0.0903312f, +0.0733684f, +0.2789126f, +0.0146573f, -0.0660593f, +0.1660021f, -0.3943822f, +0.0155291f,
  -0.0379142f, +0.1349240f, +0.0933426f, +0.0123276f, -0.0464366f, +0.6158255f, -0.0472576f, -0.3285122f,
  -0.4042991f, +0.1081828f, +0.0718063f, -0.1001540f, +0.0419751f, +0.2928076f, -0.1320204f, -0.1180081f,
  -0.1228724f, +0.5397967f, +0.2641348f, -0.0446793f, -0.2711210f, -0.1098249f, -0.2749738f, -0.3317518f,
  +0.0909256f, +0.6944686f, +0.6702942f, -0.5605726f, +0.0320624f, +0.3354978f, +0.1476872f, -0.2106323f,
  -0.2648809f, +0.3164466f, -0.0707853f, -0.3906788f, -0.1216844f, +0.1853046f, -0.1521285f, -0.0956456f,
  +0.0154040f, +0.2285647f, +0.0460704f, +0.1689836f, -0.2929694f, +0.2918824f, +0.1482934f, +0.2969219f,
  -0.6287512f, +0.8411341f, -0.0163627f, -0.3586075f, +0.4614002f, -0.1358050f, +0.7495652f, -0.0104792f,
  -0.3943953f, -0.0436414f, +0.0559217f, -0.1122624f, -0.2424167f, +0.0710206f, +0.2288882f, +0.0648562f,
  -0.1258809f, -0.0806163f, -0.2292745f, +0.0612679f, +0.0868735f, -0.0801891f, +0.1241004f, +0.0454092f,
  +0.5475421f, -0.1265960f, +0.0948755f, +0.1327799f, +0.1823206f, -0.0719722f, -0.0442931f, +0.2851076f,
  -0.2749317f, +0.2190617f, +0.1771909f, +0.1980285f, -0.3217201f, -0.2358250f, -0.2156097f, +0.0486528f,
  -0.1114958f, -0.2316009f, -0.2711494f, -0.1342532f, +0.2479722f, -0.0574079f, -0.0876373f, +0.1427696f,
  +0.6931760f, -0.0012801f, -0.4952859f, +0.0156271f, +0.0685719f, +0.2217783f, +0.0538756f, -0.3004012f,
  -0.1767250f, +0.2225757f, +0.0907855f, -0.5107776f, -0.3516815f, +0.0629818f, -0.3046556f, +0.0907827f,
  -0.0262584f, +0.0936678f, -0.1196691f, +0.1928841f, +0.0172957f, -0.0798405f, +0.0248023f, -0.0130021f,
  -0.2755034f, +0.3796618f, +0.1432946f, +0.0153843f, +0.1239104f, -0.0442089f, +0.2720871f, +0.1593989f,
  -0.3313664f, +0.1465927f, -0.2738177f, -0.0914267f, -0.2142660f, -0.1696596f, +0.0977064f, -0.0486235f,
  +0.3189320f, -0.2134202f, -0.2031322f, -0.0227788f, +0.0825584f, +0.0276373f, +0.2310847f, +0.0944022f,
  -0.1630637f, -0.3521884f, +0.1635840f, +0.0481211f, +0.0453433f, +0.2333879f, -0.1633932f, -0.1360929f,
  +0.0328492f, +0.0455919f, +0.0220821f, -0.2215848f, +0.1106364f, +0.2275889f, -0.1303477f, -0.0575387f,
  +0.2817611f, +0.0879112f, -0.1726825f, -0.3162338f, +0.7648807f, -0.0888305f, +0.4602117f, -0.0471746f,
  -0.0680477f, -0.3455686f, +0.4565932f, +0.9916675f, -0.0334743f, +0.1162704f, +0.1105380f, -0.3583540f,
  +0.6983488f, -0.5650946f, +0.0524862f, -0.1847237f, +0.4230362f, +0.1869614f, -0.6135609f, +0.0975702f,
  -0.0120186f, +0.0249695f, -0.1109729f, -0.2962603f, +0.1258829f, -0.0333088f, +0.0137316f, +0.0197638f,
  +0.0830042f, -0.1570175f, +0.1672886f, +0.1714105f, +0.1454021f, +0.0322110f, +0.0820446f, +0.0939222f,
  -0.2810280f, -0.1109333f, +0.2158434f, +0.0324793f, +0.3655309f, +0.2498256f, +0.0811425f, +0.0578653f
);

const float biases[4] = float[4](
  -0.0034525f, +0.0375090f, +0.0824376f, -0.1077771f
);

vec4 hook() {
    const vec4 r[9][2] = vec4[9][2](
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 1.0f)))
    );

    float sum[4] = biases;
    for (int n = 0; n < 4; n++) {
        for (int i = 0; i < 9; i++) {
            const vec4 k0 = vec4(kernels[n * 8 * 9 + 8 * i + 0], kernels[n * 8 * 9 + 8 * i + 1], kernels[n * 8 * 9 + 8 * i + 2], kernels[n * 8 * 9 + 8 * i + 3]);
            const vec4 k1 = vec4(kernels[n * 8 * 9 + 8 * i + 4], kernels[n * 8 * 9 + 8 * i + 5], kernels[n * 8 * 9 + 8 * i + 6], kernels[n * 8 * 9 + 8 * i + 7]);
            sum[n] += (dot(k0, r[i][0]) + dot(k1, r[i][1]));
        }
    }

    return ACTIVE(vec4(sum[0], sum[1], sum[2], sum[3]));
}

//!HOOK LUMA
//!DESC ARNet b16 Layer14 L0
//!WHEN OUTPUT.w LUMA.w / 1.2 > OUTPUT.h LUMA.h / 1.2 > *
//!BIND TMP1_L0
//!BIND TMP1_L1
//!BIND TMP2_L0
//!SAVE TMP2_L0
//!COMPONENTS 4

#define ACTIVE(v) (v)

#define TEX_BIND_L0_TEXOFF TMP1_L0_texOff
#define TEX_BIND_L0_TEX TMP1_L0_tex
#define TEX_BIND_L0_POS TMP1_L0_pos
#define TEX_BIND_L0_SIZE TMP1_L0_size
#define TEX_BIND_L0_PT TMP1_L0_pt

#define TEX_BIND_L1_TEXOFF TMP1_L1_texOff
#define TEX_BIND_L1_TEX TMP1_L1_tex
#define TEX_BIND_L1_POS TMP1_L1_pos
#define TEX_BIND_L1_SIZE TMP1_L1_size
#define TEX_BIND_L1_PT TMP1_L1_pt

#define TEX_BIND_L2_TEXOFF TMP2_L0_texOff
#define TEX_BIND_L2_TEX TMP2_L0_tex
#define TEX_BIND_L2_POS TMP2_L0_pos
#define TEX_BIND_L2_SIZE TMP2_L0_size
#define TEX_BIND_L2_PT TMP2_L0_pt

const float kernels[288] = float[288](
  +0.4978271f, +0.1311250f, +0.1996082f, +0.0969659f, -0.1123371f, +0.2018259f, +0.1108399f, +0.0994615f,
  +0.5281478f, +0.3085073f, +0.2288557f, +0.3356224f, -0.2186643f, +0.4241416f, +0.4776756f, +0.1015255f,
  +0.5304849f, +0.2944643f, +0.1762481f, +0.2306014f, +0.0249637f, +0.1392731f, +0.1931379f, +0.1497422f,
  +0.2807050f, +0.0898689f, +0.1669960f, +0.0175791f, -0.0427621f, +0.0636010f, -0.1748484f, -0.5012136f,
  +0.3273173f, +0.2466103f, +0.2203989f, -0.2073703f, +0.2729912f, +0.0087997f, -0.2521743f, +0.1357667f,
  +0.2476653f, +0.3780098f, +0.4565794f, +0.0495780f, -0.1372146f, +0.0779176f, +0.0927887f, +0.0169757f,
  +0.2729718f, +0.1585907f, +0.0899543f, +0.0676418f, -0.1508282f, +0.1830695f, -0.1135349f, -0.2616587f,
  +0.1992170f, +0.2554510f, +0.5550377f, +0.3429976f, +0.2765532f, -0.0780256f, -0.4902168f, +0.4562387f,
  +0.3992869f, +0.0753300f, +0.4051148f, +0.2933666f, -0.1413605f, +0.1591361f, -0.0809752f, +0.0670275f,
  -0.2226156f, -0.0678267f, -0.2156449f, +0.0094208f, -0.0593527f, -0.1422817f, +0.2455095f, -0.0346042f,
  +0.2202274f, -0.0341786f, -0.0205381f, -0.0711323f, -0.0667215f, +0.1830288f, +0.4084028f, +0.2430215f,
  +0.0334254f, -0.0149293f, +0.0043141f, -0.0447364f, -0.1165070f, +0.1025741f, +0.0463095f, -0.0209193f,
  +0.6557932f, +0.0041674f, +0.0335135f, -0.2648725f, +0.5494938f, -0.1847869f, -0.4426999f, +0.1815922f,
  +0.4499627f, +0.0541050f, +0.1133749f, -0.7357057f, +0.2341264f, +0.4956859f, -0.0582705f, +0.2281546f,
  -0.0968118f, +0.0893127f, +0.0674042f, -0.3925858f, +0.0346871f, -0.5980024f, +0.0180557f, +0.1072859f,
  -0.1606163f, -0.0469671f, +0.4540991f, -0.1058488f, +0.1493614f, -0.3386387f, +0.1429043f, +0.3592207f,
  +0.3214096f, +0.1050865f, +0.1673357f, -0.1344598f, +0.3897950f, -0.2804819f, +0.2871073f, +0.1793007f,
  -0.0022667f, -0.1465763f, +0.0910778f, -0.0897142f, +0.0781395f, -0.5170969f, +0.0627911f, +0.1448849f,
  -0.3372586f, -0.0602834f, -0.2054944f, -0.0540049f, -0.2427346f, -0.1554607f, +0.0358352f, -0.1228093f,
  -0.2085142f, -0.2240004f, +0.0588798f, -0.1497355f, +0.0088850f, +0.7716160f, +0.3087148f, +0.3721919f,
  +0.1624335f, +0.0888518f, +0.0356417f, -0.1568786f, +0.3586446f, +0.0813952f, -0.1478063f, +0.0675624f,
  -0.4153828f, -0.1796836f, -0.6412675f, +0.0399197f, -0.4332815f, +0.2768232f, +0.0498828f, -0.6070010f,
  -0.6610067f, -0.0834588f, -0.1617410f, -0.3269041f, +0.0214489f, +0.7364350f, +0.0547628f, -0.5178879f,
  -0.2532219f, +0.0662663f, +0.3364545f, -0.1654714f, -0.1580980f, -0.1175264f, -0.2463189f, +0.0364533f,
  -0.7505852f, -0.1220930f, -0.2895057f, -0.1692393f, +0.1871875f, -0.0115080f, -0.0836144f, -0.1415928f,
  -0.6842135f, +0.0160082f, -0.0306180f, -0.0823930f, +0.2901669f, +0.0853813f, +0.2005031f, -0.1542026f,
  -0.3032276f, -0.1013076f, +0.1088829f, +0.0134579f, +0.0428060f, +0.0381030f, -0.0932258f, -0.0887575f,
  -0.0356975f, +0.1892195f, +0.1905047f, +0.0752534f, -0.4043223f, +0.2474940f, +0.1723200f, +0.0023129f,
  -0.4637997f, +0.1393846f, -0.1732038f, +0.1298870f, -0.0201074f, +0.2955880f, +0.0518897f, -0.2345608f,
  -0.2117407f, -0.1430135f, -0.1197072f, -0.1300329f, -0.0074262f, -0.2771692f, +0.1869577f, +0.0570549f,
  -0.0923222f, -0.3467959f, +0.1073693f, -0.0812140f, +0.0558784f, -0.0985883f, +0.3321150f, -0.2156139f,
  +0.1128156f, -0.3991704f, -0.3647483f, -0.2510501f, -0.2051192f, +0.3638423f, +0.1354396f, -0.8033895f,
  -0.2101458f, +0.0977961f, +0.1439176f, +0.2482296f, +0.2681352f, +0.0672161f, -0.0467745f, +0.1697079f,
  -0.2765841f, -0.2251819f, +0.0426265f, -0.0217006f, -0.1146368f, -0.1027123f, +0.3324292f, -0.0489054f,
  -0.2299215f, -0.1736999f, -0.0171942f, +0.1991262f, -0.1632194f, +0.3809021f, -0.1109966f, -0.3228511f,
  -0.0381733f, +0.1779042f, +0.0599956f, -0.0728069f, -0.3433317f, +0.4576354f, +0.1425875f, +0.2968774f
);

const float biases[4] = float[4](
  -0.0631588f, +0.0162877f, -0.0726338f, -0.1067716f
);

vec4 hook() {
    const vec4 r[9][2] = vec4[9][2](
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 1.0f)))
    );

    float sum[4] = biases;
    for (int n = 0; n < 4; n++) {
        for (int i = 0; i < 9; i++) {
            const vec4 k0 = vec4(kernels[n * 8 * 9 + 8 * i + 0], kernels[n * 8 * 9 + 8 * i + 1], kernels[n * 8 * 9 + 8 * i + 2], kernels[n * 8 * 9 + 8 * i + 3]);
            const vec4 k1 = vec4(kernels[n * 8 * 9 + 8 * i + 4], kernels[n * 8 * 9 + 8 * i + 5], kernels[n * 8 * 9 + 8 * i + 6], kernels[n * 8 * 9 + 8 * i + 7]);
            sum[n] += (dot(k0, r[i][0]) + dot(k1, r[i][1]));
        }
    }

    return ACTIVE(vec4(sum[0], sum[1], sum[2], sum[3]) * 0.2000000f + TEX_BIND_L2_TEXOFF(vec2(0.0f, 0.0f)));
}

//!HOOK LUMA
//!DESC ARNet b16 Layer14 L1
//!WHEN OUTPUT.w LUMA.w / 1.2 > OUTPUT.h LUMA.h / 1.2 > *
//!BIND TMP1_L0
//!BIND TMP1_L1
//!BIND TMP2_L1
//!SAVE TMP2_L1
//!COMPONENTS 4

#define ACTIVE(v) (v)

#define TEX_BIND_L0_TEXOFF TMP1_L0_texOff
#define TEX_BIND_L0_TEX TMP1_L0_tex
#define TEX_BIND_L0_POS TMP1_L0_pos
#define TEX_BIND_L0_SIZE TMP1_L0_size
#define TEX_BIND_L0_PT TMP1_L0_pt

#define TEX_BIND_L1_TEXOFF TMP1_L1_texOff
#define TEX_BIND_L1_TEX TMP1_L1_tex
#define TEX_BIND_L1_POS TMP1_L1_pos
#define TEX_BIND_L1_SIZE TMP1_L1_size
#define TEX_BIND_L1_PT TMP1_L1_pt

#define TEX_BIND_L2_TEXOFF TMP2_L1_texOff
#define TEX_BIND_L2_TEX TMP2_L1_tex
#define TEX_BIND_L2_POS TMP2_L1_pos
#define TEX_BIND_L2_SIZE TMP2_L1_size
#define TEX_BIND_L2_PT TMP2_L1_pt

const float kernels[288] = float[288](
  +0.1192343f, -0.0649649f, -0.2503254f, +0.0670166f, -0.0516932f, +0.2355447f, +0.3261307f, -0.3200075f,
  +0.0347163f, +0.1103849f, +0.1493164f, -0.0137146f, +0.1513988f, +0.2601887f, +0.3330621f, +0.3087211f,
  -0.1569730f, -0.0142960f, +0.0137300f, -0.3436738f, -0.2907033f, -0.3727826f, -0.0406792f, +0.0232642f,
  +0.4513199f, -0.0506658f, -0.0448231f, -0.1123175f, +0.2849313f, -0.1207076f, +0.1379393f, -0.5596564f,
  +0.3412374f, +0.1820533f, +0.1060230f, -0.0732747f, +0.2913588f, +0.2307699f, +0.0271266f, +0.3532732f,
  +0.1437166f, -0.0815676f, -0.0212895f, -0.1341244f, +0.0588483f, -0.2605794f, -0.3268065f, -0.0220267f,
  +0.3063624f, +0.1799900f, +0.3640394f, -0.1465632f, +0.2863290f, -0.0983288f, -0.1519224f, +0.0047841f,
  -0.0230032f, -0.0214038f, -0.0427859f, -0.2920469f, +0.1182750f, -0.2608458f, +0.1662139f, +0.0823429f,
  +0.2824536f, +0.1906772f, -0.1340398f, +0.1261334f, +0.1285239f, +0.2371617f, -0.2461344f, -0.1259351f,
  -0.0633700f, -0.0283772f, +0.1083358f, -0.0736678f, +0.0556060f, -0.1197815f, -0.1850406f, -0.1145172f,
  -0.0937142f, -0.0079019f, +0.0109839f, -0.0198419f, +0.0535489f, -0.3771941f, -0.2708259f, -0.1535220f,
  -0.1759828f, -0.0708042f, -0.0494197f, +0.0002157f, -0.0327684f, -0.3183135f, -0.0943642f, -0.1409931f,
  -0.0845968f, +0.0617631f, +0.1038370f, -0.0598950f, +0.0588370f, -0.1435797f, +0.0844553f, +0.3178876f,
  -0.2047729f, -0.1290429f, +0.1532459f, +0.1976418f, -0.2388225f, +0.1295524f, +0.0744345f, +0.3547311f,
  -0.1186455f, +0.0890802f, -0.1187681f, -0.0559262f, -0.1004174f, -0.1183644f, +0.1412956f, +0.0952373f,
  +0.0114526f, +0.1949705f, +0.4879246f, -0.0707959f, +0.1636158f, -0.1624323f, -0.1497010f, -0.0355853f,
  -0.0478921f, +0.4264978f, -0.0105371f, +0.1271358f, +0.1773360f, -0.3178949f, +0.0134766f, +0.1774424f,
  +0.1551425f, +0.1168130f, +0.0799314f, -0.0171213f, +0.0344884f, +0.1164362f, -0.2106864f, +0.1298353f,
  -0.4732553f, +0.2118022f, -0.2199963f, +0.1704985f, -0.6839547f, -0.0676309f, -0.0221411f, -0.2366749f,
  -0.7847857f, -0.3584037f, -0.1788325f, -0.0907231f, -0.5506555f, -0.2739356f, -0.2031190f, -0.1722567f,
  -0.6356979f, -0.2157851f, -0.1431714f, -0.3100004f, +0.1031751f, -0.2919374f, +0.0348911f, -0.1763132f,
  -0.7265344f, -0.4164748f, -0.5364020f, +0.0646814f, -0.1839324f, -0.0286954f, +0.0413898f, +0.1525902f,
  -0.5655078f, -0.4140598f, -0.3284736f, -0.0847711f, -0.3132439f, +0.4424112f, +0.0020879f, -0.3744023f,
  -0.5260001f, -0.0837874f, -0.2195818f, -0.2981617f, +0.3421474f, +0.0648428f, -0.3082418f, -0.2823576f,
  -0.7275357f, +0.0853756f, -0.1410276f, +0.1081516f, -0.0826276f, +0.1428511f, -0.1167598f, -0.1211026f,
  -0.5354928f, -0.0213618f, +0.0400422f, +0.2479974f, -0.1011127f, +0.7799076f, -0.2124431f, +0.2576920f,
  -0.4098873f, +0.2030528f, +0.1249193f, -0.1084564f, -0.0438028f, -0.1850912f, +0.0892420f, -0.0652953f,
  +0.3933257f, -0.0075344f, +0.1696305f, +0.0327397f, +0.3441958f, +0.0806868f, +0.1206752f, +0.2157657f,
  +0.4633704f, +0.3552378f, +0.0511337f, +0.1347768f, +0.0712278f, -0.0290088f, +0.0673907f, -0.1064590f,
  +0.3214445f, +0.0953717f, +0.0456919f, +0.1439222f, -0.2185735f, +0.2439947f, +0.1773309f, +0.0462585f,
  +0.4711277f, +0.1512062f, +0.4198924f, +0.0587228f, +0.1660018f, -0.0123549f, -0.1757749f, -0.0067164f,
  +0.7828559f, +0.1587937f, +0.1147237f, +0.0182668f, +0.1394354f, -0.4246716f, +0.2583695f, +0.1777453f,
  +0.2849562f, -0.0101375f, +0.0029782f, +0.1322663f, -0.0138456f, -0.0242531f, +0.1055564f, -0.0414790f,
  +0.5595726f, +0.1261495f, -0.1073848f, +0.0289532f, -0.2691917f, +0.0634398f, +0.1091328f, -0.1206459f,
  +0.6718882f, -0.0959431f, +0.2105541f, +0.1499726f, -0.0895335f, +0.0599481f, -0.3869869f, +0.1252920f,
  +0.2338915f, +0.0150367f, +0.0187057f, +0.1340793f, -0.0245230f, -0.0376771f, +0.1397034f, +0.1262563f
);

const float biases[4] = float[4](
  -0.0347528f, -0.0470631f, +0.0755913f, +0.0343392f
);

vec4 hook() {
    const vec4 r[9][2] = vec4[9][2](
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 1.0f)))
    );

    float sum[4] = biases;
    for (int n = 0; n < 4; n++) {
        for (int i = 0; i < 9; i++) {
            const vec4 k0 = vec4(kernels[n * 8 * 9 + 8 * i + 0], kernels[n * 8 * 9 + 8 * i + 1], kernels[n * 8 * 9 + 8 * i + 2], kernels[n * 8 * 9 + 8 * i + 3]);
            const vec4 k1 = vec4(kernels[n * 8 * 9 + 8 * i + 4], kernels[n * 8 * 9 + 8 * i + 5], kernels[n * 8 * 9 + 8 * i + 6], kernels[n * 8 * 9 + 8 * i + 7]);
            sum[n] += (dot(k0, r[i][0]) + dot(k1, r[i][1]));
        }
    }

    return ACTIVE(vec4(sum[0], sum[1], sum[2], sum[3]) * 0.2000000f + TEX_BIND_L2_TEXOFF(vec2(0.0f, 0.0f)));
}

//!HOOK LUMA
//!DESC ARNet b16 Layer15 L0
//!WHEN OUTPUT.w LUMA.w / 1.2 > OUTPUT.h LUMA.h / 1.2 > *
//!BIND TMP2_L0
//!BIND TMP2_L1
//!SAVE TMP1_L0
//!COMPONENTS 4

#define ACTIVE(v) (max(v, v * 0.2000000f))

#define TEX_BIND_L0_TEXOFF TMP2_L0_texOff
#define TEX_BIND_L0_TEX TMP2_L0_tex
#define TEX_BIND_L0_POS TMP2_L0_pos
#define TEX_BIND_L0_SIZE TMP2_L0_size
#define TEX_BIND_L0_PT TMP2_L0_pt

#define TEX_BIND_L1_TEXOFF TMP2_L1_texOff
#define TEX_BIND_L1_TEX TMP2_L1_tex
#define TEX_BIND_L1_POS TMP2_L1_pos
#define TEX_BIND_L1_SIZE TMP2_L1_size
#define TEX_BIND_L1_PT TMP2_L1_pt

const float kernels[288] = float[288](
  +0.0385550f, +0.0960244f, -0.0777552f, -0.0641616f, -0.2959582f, +0.4380342f, -0.1955525f, -0.2285696f,
  +0.0902696f, -0.1288252f, -0.0913491f, +0.1310355f, +0.0209149f, +0.3787277f, -0.0826870f, -0.1398081f,
  +0.1657514f, +0.1012367f, -0.0204087f, +0.0957725f, -0.1012696f, +0.1295691f, +0.2624621f, -0.0586735f,
  +0.3690273f, -0.1998360f, +0.4398405f, +0.5584067f, -0.1950196f, +0.0721541f, +0.4787847f, -0.5357167f,
  +0.3102236f, -0.4801311f, +0.3830735f, +0.2709391f, -0.0375133f, -0.3202949f, +0.7216538f, -0.0183191f,
  -0.0816795f, -0.0116575f, +0.1715481f, +0.0304901f, -0.3055147f, -0.1443536f, +0.1166313f, -0.0989738f,
  -0.4555711f, +0.0172669f, -0.1659696f, +0.3218919f, +0.3580950f, -0.0603459f, +0.4332471f, +0.1454005f,
  -0.1071796f, +0.5340666f, -0.1934488f, +0.1719202f, +0.0382352f, +0.0566220f, +0.3311010f, -0.1975342f,
  +0.2244964f, -0.0775645f, +0.0082561f, +0.0357975f, -0.0747915f, -0.0054580f, -0.0581246f, +0.0853108f,
  -0.1380657f, -0.0288992f, -0.0701344f, +0.2348748f, +0.0384578f, +0.0290700f, -0.1299454f, +0.0336223f,
  -0.0423378f, -0.0447009f, +0.1134118f, -0.0843248f, -0.0405817f, +0.0802436f, +0.0133700f, -0.0305586f,
  -0.3640590f, +0.2222623f, -0.0351298f, +0.2005268f, -0.1130271f, +0.0865278f, -0.1660255f, -0.1013576f,
  -0.4524739f, -0.0891524f, -0.0993832f, -0.1846861f, -0.4266654f, -0.0999803f, -0.0386185f, -0.0159064f,
  +0.3070983f, -0.0697783f, -0.4674886f, +0.4307075f, -0.8559350f, +0.3915167f, -0.1225368f, -0.2774952f,
  +0.4912518f, -0.2828383f, -0.0357153f, -0.0767060f, -0.3759269f, +0.1206530f, +0.0559884f, +0.2341135f,
  -0.0655372f, -0.3181795f, -0.0102479f, +0.3958373f, -0.0059609f, +0.0528505f, +0.2129908f, -0.0080414f,
  -0.1440863f, +0.3359859f, +0.3697064f, +0.3288965f, +0.7898787f, -0.1335666f, +0.8428337f, -0.0111174f,
  +0.0820792f, +0.1577037f, +0.5422093f, +0.1049413f, +0.2950071f, -0.2904362f, +0.3975750f, -0.0771132f,
  -0.0186736f, +0.0144537f, -0.0768659f, +0.2332037f, +0.0802756f, +0.0350976f, +0.3010111f, -0.0958763f,
  -0.1911001f, +0.4922043f, +0.1918036f, +0.4957728f, +0.1183049f, -0.0484893f, +0.2813144f, -0.1280772f,
  -0.1461332f, -0.0535586f, -0.2647748f, +0.0329285f, +0.0050031f, +0.1999510f, -0.0198083f, -0.0217023f,
  -0.3513223f, -0.0492719f, -0.0574326f, -0.0894599f, -0.4610173f, -0.1007945f, +0.0684230f, +0.0327515f,
  -0.2807461f, +0.3668575f, +0.8295829f, +0.4573762f, +0.0105732f, -0.1754960f, +0.7449598f, +0.0992964f,
  -0.3385256f, +0.0662693f, +0.4010855f, +0.1848875f, +0.2692655f, -0.0991352f, +0.2499386f, -0.0841133f,
  +0.0161294f, -0.1376515f, -0.1581992f, -0.1687813f, -0.0690718f, +0.0614924f, +0.0052801f, -0.1136970f,
  +0.1042226f, +0.0356127f, -0.2807650f, +0.1077778f, -0.1224990f, +0.1741848f, -0.1036923f, +0.0969502f,
  -0.3029932f, +0.1655879f, +0.1191695f, +0.1601394f, +0.2026249f, -0.0440748f, +0.1473781f, +0.0291978f,
  -0.1717042f, +0.1504577f, -0.0709641f, -0.1442692f, +0.0445898f, +0.1380801f, -0.2885085f, -0.0140878f,
  -0.1548698f, -0.0763535f, -0.1094343f, -0.1060860f, +0.4250491f, +0.0425061f, -0.0979770f, +0.1021435f,
  -0.2610361f, -0.0852438f, +0.1706429f, -0.0989250f, +0.1543837f, -0.3243419f, +0.2275753f, +0.0082700f,
  -0.3289515f, -0.0941297f, +0.1566319f, -0.0565640f, +0.3517523f, -0.1196702f, +0.1248948f, +0.0534793f,
  +0.4642229f, +0.2004178f, +0.1628097f, -0.2649842f, +0.1495675f, -0.1908924f, -0.1168395f, +0.4757481f,
  +0.4292879f, +0.0065933f, -0.1475702f, +0.0623609f, +0.1960855f, +0.0080977f, -0.3630362f, +0.1507370f,
  -0.1289656f, -0.0769719f, +0.0122022f, +0.0384352f, -0.0943466f, -0.0408668f, -0.0856340f, -0.1205614f,
  +0.1225533f, +0.0072570f, +0.0116857f, -0.2342314f, -0.3376313f, -0.1272390f, -0.4185961f, +0.1840501f,
  +0.0572204f, +0.0574234f, +0.0838886f, -0.0659829f, +0.0189543f, -0.0467573f, +0.1639231f, -0.0565786f
);

const float biases[4] = float[4](
  -0.0584696f, -0.0469029f, +0.0044839f, +0.0540322f
);

vec4 hook() {
    const vec4 r[9][2] = vec4[9][2](
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 1.0f)))
    );

    float sum[4] = biases;
    for (int n = 0; n < 4; n++) {
        for (int i = 0; i < 9; i++) {
            const vec4 k0 = vec4(kernels[n * 8 * 9 + 8 * i + 0], kernels[n * 8 * 9 + 8 * i + 1], kernels[n * 8 * 9 + 8 * i + 2], kernels[n * 8 * 9 + 8 * i + 3]);
            const vec4 k1 = vec4(kernels[n * 8 * 9 + 8 * i + 4], kernels[n * 8 * 9 + 8 * i + 5], kernels[n * 8 * 9 + 8 * i + 6], kernels[n * 8 * 9 + 8 * i + 7]);
            sum[n] += (dot(k0, r[i][0]) + dot(k1, r[i][1]));
        }
    }

    return ACTIVE(vec4(sum[0], sum[1], sum[2], sum[3]));
}

//!HOOK LUMA
//!DESC ARNet b16 Layer15 L1
//!WHEN OUTPUT.w LUMA.w / 1.2 > OUTPUT.h LUMA.h / 1.2 > *
//!BIND TMP2_L0
//!BIND TMP2_L1
//!SAVE TMP1_L1
//!COMPONENTS 4

#define ACTIVE(v) (max(v, v * 0.2000000f))

#define TEX_BIND_L0_TEXOFF TMP2_L0_texOff
#define TEX_BIND_L0_TEX TMP2_L0_tex
#define TEX_BIND_L0_POS TMP2_L0_pos
#define TEX_BIND_L0_SIZE TMP2_L0_size
#define TEX_BIND_L0_PT TMP2_L0_pt

#define TEX_BIND_L1_TEXOFF TMP2_L1_texOff
#define TEX_BIND_L1_TEX TMP2_L1_tex
#define TEX_BIND_L1_POS TMP2_L1_pos
#define TEX_BIND_L1_SIZE TMP2_L1_size
#define TEX_BIND_L1_PT TMP2_L1_pt

const float kernels[288] = float[288](
  -0.5996998f, -0.2072439f, -0.0020392f, -0.3249141f, +0.1598558f, -0.3466341f, +0.0044418f, -0.2248484f,
  -0.3797740f, +0.1060232f, -0.0438390f, -0.0803662f, +0.0533774f, -0.1808797f, +0.0426751f, +0.0728193f,
  -0.1655425f, +0.0437059f, +0.0843211f, +0.0436500f, -0.1035008f, -0.2513150f, +0.1127087f, +0.0481745f,
  -1.0130501f, -0.3675906f, +0.1992839f, +0.5515140f, -0.1150541f, -0.0478136f, -0.0869580f, +0.0176640f,
  -0.7920463f, -0.2069908f, -0.0359495f, +0.1882760f, -0.1453013f, +0.3694434f, -0.2749119f, -0.2027773f,
  -0.0893105f, +0.1996646f, -0.0041562f, -0.0435138f, -0.0513050f, -0.2486768f, +0.3054036f, -0.0653728f,
  -0.3883392f, -0.0334846f, +0.2819933f, +0.2936085f, -0.2233085f, +0.1181141f, +0.0336217f, +0.1393158f,
  -0.0814781f, +0.3298672f, +0.2071689f, -0.2190515f, +0.1102316f, +0.1307946f, -0.0740618f, +0.0272780f,
  -0.2418637f, -0.0134981f, -0.0379932f, +0.0727737f, -0.1278650f, -0.2343030f, +0.0478871f, -0.1173746f,
  +0.0637654f, +0.0566482f, +0.0657259f, -0.2766369f, +0.1990343f, -0.1024632f, +0.1977913f, -0.1343563f,
  +0.1490445f, -0.2966953f, +0.1543366f, -0.2005686f, +0.0748580f, +0.0637895f, +0.2216168f, -0.1666510f,
  -0.0052715f, -0.2144155f, +0.1674278f, -0.1260248f, -0.1394963f, +0.1012793f, +0.1241560f, -0.0601476f,
  +0.5352393f, +0.0929921f, -0.3803550f, -0.5029522f, +0.0463886f, +0.1661127f, +0.4385725f, -0.1130838f,
  -0.7025054f, -0.0039858f, -0.0993963f, -0.1345129f, +0.0544259f, +0.3241779f, +0.0537155f, -0.8726003f,
  -0.2965440f, +0.0844497f, -0.1872985f, +0.0056090f, +0.1642934f, +0.0854696f, +0.2301151f, -0.1245427f,
  +0.1569324f, +0.3729980f, +0.0530842f, +0.1632539f, +0.2705712f, +0.0493987f, +0.0034726f, +0.1332065f,
  -0.1290227f, -0.0043501f, +0.1383264f, +0.2127521f, -0.6409326f, -0.0128209f, +0.2523623f, -0.0422845f,
  -0.1610814f, +0.0584493f, -0.2541822f, +0.0019887f, +0.0039981f, -0.2908556f, +0.1122361f, -0.3471755f,
  +0.0344588f, +0.2268241f, -0.1752626f, +0.0588171f, -0.0029919f, +0.1658221f, +0.1044140f, +0.0493008f,
  +0.2480401f, -0.1266069f, +0.2438353f, +0.3453282f, +0.2077582f, +0.5739419f, -0.3457538f, -0.2144883f,
  +0.4529220f, -0.0690874f, -0.0589479f, +0.0553540f, -0.1362401f, -0.2961148f, +0.2784913f, +0.1040877f,
  -0.1202755f, -0.0755293f, +0.2003374f, -0.1206547f, +0.0516396f, +0.0110381f, -0.2367745f, -0.0076040f,
  +0.5992090f, -0.4191604f, -0.4878110f, +0.1384792f, +0.0365104f, -0.1619755f, -0.5442175f, -0.3556051f,
  -0.1526752f, +0.1090253f, -0.6899424f, +0.0920645f, -0.1284799f, -0.3591147f, +0.2293593f, -0.1197153f,
  +0.0071278f, +0.0294603f, -0.0430528f, -0.0372832f, -0.1317330f, -0.0290341f, -0.0628551f, +0.0499249f,
  +0.0762097f, -0.0498305f, +0.0203182f, -0.0764723f, -0.2226001f, +0.0460652f, +0.0431879f, -0.0416939f,
  +0.3135140f, -0.0109108f, -0.0794581f, -0.0343353f, +0.0457731f, -0.2546597f, -0.2166710f, -0.0982370f,
  +0.1369959f, -0.1289509f, -0.0205121f, -0.1316931f, -0.0198652f, +0.0425921f, -0.0572352f, +0.0568588f,
  +0.1850085f, -0.1120076f, -0.1402615f, +0.0536234f, +0.0788534f, -0.0115284f, +0.0740607f, +0.1496980f,
  +0.1229363f, -0.1903893f, +0.0306361f, -0.0995295f, -0.0145902f, -0.0654265f, -0.0281342f, +0.0300491f,
  +0.0516843f, -0.3190295f, -0.4355379f, -0.1577017f, +0.0299128f, -0.8045222f, +0.4220161f, +0.6274344f,
  +0.1582468f, +0.1187972f, +0.0202030f, -0.2322636f, +0.4114896f, +0.6803842f, -0.5213197f, -0.1416778f,
  +0.0722338f, +0.1190472f, -0.0846117f, -0.0770427f, -0.0113994f, +0.1497185f, +0.0105148f, -0.0904643f,
  -0.0143742f, +0.4657747f, -0.1294924f, -0.2076477f, +0.1413145f, +0.0608710f, +0.3258497f, +0.3849849f,
  +0.2847792f, -0.1903722f, -0.1470373f, +0.0146745f, -0.0120795f, +0.2514493f, -0.3076635f, +0.1785270f,
  -0.0277492f, -0.0425721f, -0.0982407f, +0.0475758f, -0.0296132f, -0.0454232f, -0.0120180f, -0.0608699f
);

const float biases[4] = float[4](
  +0.0771769f, -0.0350032f, -0.0152946f, -0.0075623f
);

vec4 hook() {
    const vec4 r[9][2] = vec4[9][2](
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 1.0f)))
    );

    float sum[4] = biases;
    for (int n = 0; n < 4; n++) {
        for (int i = 0; i < 9; i++) {
            const vec4 k0 = vec4(kernels[n * 8 * 9 + 8 * i + 0], kernels[n * 8 * 9 + 8 * i + 1], kernels[n * 8 * 9 + 8 * i + 2], kernels[n * 8 * 9 + 8 * i + 3]);
            const vec4 k1 = vec4(kernels[n * 8 * 9 + 8 * i + 4], kernels[n * 8 * 9 + 8 * i + 5], kernels[n * 8 * 9 + 8 * i + 6], kernels[n * 8 * 9 + 8 * i + 7]);
            sum[n] += (dot(k0, r[i][0]) + dot(k1, r[i][1]));
        }
    }

    return ACTIVE(vec4(sum[0], sum[1], sum[2], sum[3]));
}

//!HOOK LUMA
//!DESC ARNet b16 Layer16 L0
//!WHEN OUTPUT.w LUMA.w / 1.2 > OUTPUT.h LUMA.h / 1.2 > *
//!BIND TMP1_L0
//!BIND TMP1_L1
//!BIND TMP2_L0
//!SAVE TMP2_L0
//!COMPONENTS 4

#define ACTIVE(v) (v)

#define TEX_BIND_L0_TEXOFF TMP1_L0_texOff
#define TEX_BIND_L0_TEX TMP1_L0_tex
#define TEX_BIND_L0_POS TMP1_L0_pos
#define TEX_BIND_L0_SIZE TMP1_L0_size
#define TEX_BIND_L0_PT TMP1_L0_pt

#define TEX_BIND_L1_TEXOFF TMP1_L1_texOff
#define TEX_BIND_L1_TEX TMP1_L1_tex
#define TEX_BIND_L1_POS TMP1_L1_pos
#define TEX_BIND_L1_SIZE TMP1_L1_size
#define TEX_BIND_L1_PT TMP1_L1_pt

#define TEX_BIND_L2_TEXOFF TMP2_L0_texOff
#define TEX_BIND_L2_TEX TMP2_L0_tex
#define TEX_BIND_L2_POS TMP2_L0_pos
#define TEX_BIND_L2_SIZE TMP2_L0_size
#define TEX_BIND_L2_PT TMP2_L0_pt

const float kernels[288] = float[288](
  -0.0452811f, -0.1229642f, +0.1529568f, +0.1281578f, -0.1624529f, +0.1081231f, -0.1010829f, +0.0710197f,
  +0.1491882f, -0.0593748f, +0.0718921f, -0.2078777f, -0.0650965f, -0.3134510f, +0.0288220f, -0.2747879f,
  -0.0324162f, +0.0582359f, -0.1107580f, -0.0138887f, -0.1760758f, +0.0220900f, +0.1328900f, +0.4781155f,
  +0.1943678f, -0.0461169f, +0.0882388f, +0.1454429f, -0.1280543f, +0.1606985f, +0.0744601f, +0.1119117f,
  +0.3700024f, -0.4150085f, -0.7078635f, -0.4428125f, +0.2269456f, +0.5935628f, -0.6034647f, -0.1184087f,
  -0.0391260f, +0.3137131f, -0.2792117f, +0.4701681f, +0.7017056f, +0.0029304f, -0.2092644f, -0.1654915f,
  +0.0280899f, +0.3327751f, -0.0879254f, +0.1531502f, -0.0922039f, +0.0801197f, +0.2157233f, +0.0562599f,
  -0.2499967f, +0.3275320f, -0.0099051f, +0.2164741f, +0.0436547f, -0.1855826f, +0.1085342f, -0.1356902f,
  +0.2140711f, -0.0334299f, -0.0496338f, +0.1684529f, -0.0232259f, -0.1718013f, -0.0606269f, +0.0518073f,
  -0.0547781f, -0.1696258f, -0.0321435f, -0.0070768f, +0.0737366f, -0.0545159f, +0.1896262f, -0.0118551f,
  -0.0353406f, -0.4832908f, +0.0084104f, +0.0059715f, -0.3169271f, -0.0785722f, +0.0335754f, -0.2161378f,
  -0.2087070f, -0.2739102f, +0.0445310f, +0.1324217f, +0.2498477f, +0.1444588f, -0.0010137f, -0.6689640f,
  -0.0660625f, -0.2026402f, +0.1220767f, +0.0083511f, -0.0682992f, -0.4066906f, -0.0529401f, -0.2476273f,
  -0.0431736f, +0.2170983f, -0.2084294f, -0.3549188f, +0.4981001f, +0.1284997f, +0.5143857f, -0.0675540f,
  -0.5117320f, +0.0779898f, +0.2959533f, +0.0883740f, +0.3830872f, -0.0053817f, -0.0914023f, +0.0591454f,
  +0.0753904f, -0.1971940f, +0.1869969f, +0.2676667f, -0.0825288f, +0.0330366f, +0.4957848f, +0.0700578f,
  +0.2815984f, -0.1950809f, +0.0631914f, -0.0209185f, -0.0707995f, +0.1634979f, +0.1639281f, +0.0274052f,
  -0.2490336f, -0.1012306f, +0.2520878f, -0.1210757f, -0.0318947f, +0.1369684f, -0.0035938f, +0.1127415f,
  +0.0825073f, +0.2531816f, +0.1711372f, -0.0229550f, +0.1442820f, -0.0355755f, -0.2124127f, +0.0811120f,
  +0.3445937f, -0.7796599f, -0.0027105f, -0.3387991f, -0.0406286f, -0.2374735f, -0.1323992f, +0.2449088f,
  -0.1876618f, +0.2898476f, +0.2026960f, -0.1455730f, +0.3160077f, +0.0511877f, +0.0458241f, +0.0069795f,
  +0.1468900f, -0.0986490f, -0.1639082f, -0.0842972f, +0.0432921f, -0.3306737f, -0.0942609f, +0.0851350f,
  -0.0645042f, +0.4359575f, -0.8466650f, -0.2220941f, -0.3659696f, -0.1128196f, -0.0759426f, +0.5407510f,
  +0.6648384f, +0.0426881f, -0.1562584f, +0.0012418f, +0.1260216f, -0.0652188f, -0.1487533f, +0.8992026f,
  +0.2346988f, -0.0641538f, -0.1054623f, -0.3870978f, +0.2681268f, +0.0578245f, -0.1555450f, -0.1268639f,
  +0.0980362f, +0.0268912f, +0.2250165f, +0.0042027f, -0.0482920f, +0.1438851f, -0.1450991f, -0.0093445f,
  +0.1381236f, +0.0920837f, -0.1194949f, -0.1424431f, +0.1243804f, +0.0473930f, -0.0295538f, +0.0583740f,
  -0.0202581f, -0.1083464f, -0.2477979f, +0.3146866f, -0.1709576f, +0.2034077f, +0.0332984f, +0.1368281f,
  +0.3224974f, -0.7952395f, -0.0361002f, +0.1623666f, -0.0965357f, +0.3217621f, +0.1544491f, -0.1530237f,
  -0.2212570f, +0.0239974f, +0.0053943f, -0.1114419f, -0.2977659f, -0.1280284f, +0.0213462f, +0.2292636f,
  +0.0954123f, +0.2465082f, -0.4574379f, +0.0720152f, -0.2117430f, +0.2659808f, +0.1866481f, +0.0813722f,
  -0.1735645f, +0.2814370f, -0.0783041f, +0.1962703f, +0.1935863f, +0.1242382f, -0.1846323f, +0.2305671f,
  +0.9737557f, -0.1505197f, +0.0182650f, +0.1368847f, -0.8205596f, +0.1600612f, +0.5972014f, +0.3710532f,
  -0.1351443f, +0.1300362f, +0.0372781f, +0.0722306f, -0.0612116f, -0.1096808f, +0.0340651f, +0.0351379f,
  -0.2641225f, +0.1015015f, -0.2838389f, +0.0831875f, +0.1924634f, +0.3457269f, -0.1775383f, -0.0588696f,
  -0.7021186f, -0.1696772f, +0.1569635f, +0.1815495f, +0.5273369f, +0.0279603f, +0.0381373f, +0.0347239f
);

const float biases[4] = float[4](
  +0.0171459f, -0.0250187f, +0.0838398f, -0.0741490f
);

vec4 hook() {
    const vec4 r[9][2] = vec4[9][2](
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 1.0f)))
    );

    float sum[4] = biases;
    for (int n = 0; n < 4; n++) {
        for (int i = 0; i < 9; i++) {
            const vec4 k0 = vec4(kernels[n * 8 * 9 + 8 * i + 0], kernels[n * 8 * 9 + 8 * i + 1], kernels[n * 8 * 9 + 8 * i + 2], kernels[n * 8 * 9 + 8 * i + 3]);
            const vec4 k1 = vec4(kernels[n * 8 * 9 + 8 * i + 4], kernels[n * 8 * 9 + 8 * i + 5], kernels[n * 8 * 9 + 8 * i + 6], kernels[n * 8 * 9 + 8 * i + 7]);
            sum[n] += (dot(k0, r[i][0]) + dot(k1, r[i][1]));
        }
    }

    return ACTIVE(vec4(sum[0], sum[1], sum[2], sum[3]) * 0.2000000f + TEX_BIND_L2_TEXOFF(vec2(0.0f, 0.0f)));
}

//!HOOK LUMA
//!DESC ARNet b16 Layer16 L1
//!WHEN OUTPUT.w LUMA.w / 1.2 > OUTPUT.h LUMA.h / 1.2 > *
//!BIND TMP1_L0
//!BIND TMP1_L1
//!BIND TMP2_L1
//!SAVE TMP2_L1
//!COMPONENTS 4

#define ACTIVE(v) (v)

#define TEX_BIND_L0_TEXOFF TMP1_L0_texOff
#define TEX_BIND_L0_TEX TMP1_L0_tex
#define TEX_BIND_L0_POS TMP1_L0_pos
#define TEX_BIND_L0_SIZE TMP1_L0_size
#define TEX_BIND_L0_PT TMP1_L0_pt

#define TEX_BIND_L1_TEXOFF TMP1_L1_texOff
#define TEX_BIND_L1_TEX TMP1_L1_tex
#define TEX_BIND_L1_POS TMP1_L1_pos
#define TEX_BIND_L1_SIZE TMP1_L1_size
#define TEX_BIND_L1_PT TMP1_L1_pt

#define TEX_BIND_L2_TEXOFF TMP2_L1_texOff
#define TEX_BIND_L2_TEX TMP2_L1_tex
#define TEX_BIND_L2_POS TMP2_L1_pos
#define TEX_BIND_L2_SIZE TMP2_L1_size
#define TEX_BIND_L2_PT TMP2_L1_pt

const float kernels[288] = float[288](
  -0.1157443f, -0.2736170f, -0.1846356f, -0.1384979f, +0.0243189f, -0.1135791f, +0.0380430f, +0.0521779f,
  -0.2509037f, +0.2313603f, +0.1367227f, +0.1026801f, -0.1672824f, +0.0343539f, +0.0700203f, -0.2936272f,
  -0.1355314f, +0.2556127f, +0.0125195f, -0.0151357f, +0.2179194f, -0.0058483f, -0.1199960f, -0.1671913f,
  +0.1760719f, +0.1118550f, -0.2463201f, -0.0794668f, -0.1944961f, -0.0662303f, -0.0182777f, +0.1147496f,
  -0.4269262f, -0.1765565f, +0.0659920f, -0.0087575f, +0.2915989f, -0.2289162f, +0.2007461f, -0.4845428f,
  +0.0056554f, +0.2011447f, +0.4157370f, -0.0282626f, +0.0365826f, -0.0140017f, -0.1181158f, +0.0926967f,
  +0.1062182f, -0.0250716f, -0.0624628f, +0.0412264f, -0.0696125f, +0.0365978f, +0.2255011f, +0.0779932f,
  +0.2861041f, +0.0470669f, -0.8966836f, -0.2743389f, -0.1105355f, +0.1271986f, -0.6142689f, +0.0270088f,
  +0.4871430f, -0.0990861f, -0.1535800f, -0.2008035f, +0.0971909f, -0.2234411f, -0.1187426f, +0.0269853f,
  +0.0416416f, +0.1741745f, -0.1194840f, +0.0679960f, -0.1241541f, -0.0408069f, -0.1077752f, -0.0324466f,
  +0.0706059f, +0.4583613f, -0.0819384f, +0.1263983f, -0.1129280f, +0.0042397f, -0.0765368f, +0.1703601f,
  +0.0879795f, +0.0569021f, -0.0871505f, +0.2219686f, -0.1153397f, +0.0337764f, -0.1183801f, -0.0463032f,
  +0.0268041f, -0.0715645f, +0.1166294f, +0.4442788f, +0.1152050f, +0.1164633f, -0.2313422f, -0.0842325f,
  +0.0418024f, -0.1861533f, +0.2395924f, +0.1536956f, +0.2232942f, -0.3515923f, -0.0813143f, -0.4719121f,
  -0.3544565f, -0.0455544f, +0.1400573f, +0.1205171f, -0.1313549f, +0.0233177f, +0.0244678f, -0.0973109f,
  -0.0005146f, +0.0222831f, +0.2386984f, +0.1902528f, -0.2039731f, -0.0668233f, +0.4752453f, +0.0655268f,
  -0.1074699f, -0.1922245f, -0.2591891f, -0.0209129f, +0.3661084f, +0.0153711f, -0.1413355f, -0.0998150f,
  -0.2047547f, +0.0274028f, +0.0779364f, -0.0710922f, +0.0793080f, -0.0399588f, -0.0483560f, -0.0814560f,
  -0.0260142f, +0.1731680f, -0.0422784f, +0.0775922f, -0.0662849f, -0.0960413f, -0.1433632f, -0.1355801f,
  +0.0211299f, -0.0566309f, -0.3322454f, -0.0440748f, -0.2487009f, -0.5242040f, +0.0615668f, -0.0154617f,
  -0.4553239f, +0.1521182f, +0.0714899f, +0.0360679f, -0.2215952f, -0.1328254f, -0.0281515f, -0.4310963f,
  -0.0361255f, +0.3918573f, -0.1351849f, +0.2155381f, -0.1915904f, +0.3288575f, +0.1102564f, +0.0682520f,
  -0.4006011f, -0.1185304f, +0.1664873f, +0.0665819f, -0.1910187f, -0.1276234f, +0.6247826f, +0.2065274f,
  -0.1828108f, +0.2673110f, +0.1162927f, -0.1039183f, +0.0834219f, -0.1756747f, +0.2092138f, -0.5113847f,
  -0.0272319f, +0.2294401f, +0.1263357f, -0.0647363f, -0.0193235f, +0.0377725f, -0.3075225f, +0.0450177f,
  -0.1083003f, +0.1607367f, -0.0870665f, +0.1926391f, +0.1931109f, -0.3011670f, +0.1396485f, -0.0878868f,
  +0.1330797f, +0.1230036f, -0.0565379f, +0.2668237f, +0.0419193f, -0.1906039f, -0.1056809f, -0.0553356f,
  -0.0883673f, -0.1828404f, -0.0815330f, -0.0171080f, -0.0293181f, +0.1678543f, +0.1822461f, +0.0493659f,
  -0.2585635f, -0.1009221f, +0.2126081f, -0.1194949f, +0.2759712f, +0.1299740f, +0.1665937f, -0.1604691f,
  +0.1293687f, -0.0837880f, -0.1476570f, -0.0032427f, -0.0852285f, -0.0765706f, -0.0054759f, +0.1819431f,
  -0.0662254f, -0.1291327f, +0.0410008f, -0.1412152f, -0.0679690f, +0.0028764f, -0.1000830f, +0.0256556f,
  +0.3935362f, -0.3724904f, -0.0370366f, -0.4479577f, -0.1230962f, +0.5769582f, -0.2628366f, +0.1320881f,
  +0.1445470f, +0.1518545f, -0.1172231f, +0.2484163f, +0.0310646f, +0.0064311f, +0.0002266f, -0.1424637f,
  -0.0533873f, +0.0032786f, -0.3130599f, +0.0271548f, +0.0322777f, +0.0634054f, -0.1583271f, +0.0348575f,
  -0.1156600f, +0.3532951f, +0.0950062f, +0.0947352f, -0.1792039f, +0.0602747f, +0.2036697f, +0.0333397f,
  +0.0547110f, -0.1969930f, +0.1401369f, +0.1132450f, -0.0642047f, -0.0422275f, +0.0489982f, +0.1100279f
);

const float biases[4] = float[4](
  -0.0037434f, -0.0264048f, +0.1061923f, +0.0682368f
);

vec4 hook() {
    const vec4 r[9][2] = vec4[9][2](
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 1.0f)))
    );

    float sum[4] = biases;
    for (int n = 0; n < 4; n++) {
        for (int i = 0; i < 9; i++) {
            const vec4 k0 = vec4(kernels[n * 8 * 9 + 8 * i + 0], kernels[n * 8 * 9 + 8 * i + 1], kernels[n * 8 * 9 + 8 * i + 2], kernels[n * 8 * 9 + 8 * i + 3]);
            const vec4 k1 = vec4(kernels[n * 8 * 9 + 8 * i + 4], kernels[n * 8 * 9 + 8 * i + 5], kernels[n * 8 * 9 + 8 * i + 6], kernels[n * 8 * 9 + 8 * i + 7]);
            sum[n] += (dot(k0, r[i][0]) + dot(k1, r[i][1]));
        }
    }

    return ACTIVE(vec4(sum[0], sum[1], sum[2], sum[3]) * 0.2000000f + TEX_BIND_L2_TEXOFF(vec2(0.0f, 0.0f)));
}

//!HOOK LUMA
//!DESC ARNet b16 Layer17 L0
//!WHEN OUTPUT.w LUMA.w / 1.2 > OUTPUT.h LUMA.h / 1.2 > *
//!BIND TMP2_L0
//!BIND TMP2_L1
//!SAVE TMP1_L0
//!COMPONENTS 4

#define ACTIVE(v) (max(v, v * 0.2000000f))

#define TEX_BIND_L0_TEXOFF TMP2_L0_texOff
#define TEX_BIND_L0_TEX TMP2_L0_tex
#define TEX_BIND_L0_POS TMP2_L0_pos
#define TEX_BIND_L0_SIZE TMP2_L0_size
#define TEX_BIND_L0_PT TMP2_L0_pt

#define TEX_BIND_L1_TEXOFF TMP2_L1_texOff
#define TEX_BIND_L1_TEX TMP2_L1_tex
#define TEX_BIND_L1_POS TMP2_L1_pos
#define TEX_BIND_L1_SIZE TMP2_L1_size
#define TEX_BIND_L1_PT TMP2_L1_pt

const float kernels[288] = float[288](
  -0.0365549f, -0.1610292f, -0.2028972f, +0.2318827f, +0.1016415f, +0.0937209f, +0.0044926f, +0.0264211f,
  +0.4781348f, -0.2044566f, -0.0859043f, -0.0553808f, -0.2045306f, -0.0022591f, +0.0939125f, +0.1593927f,
  +0.5146137f, +0.2497343f, +0.0672972f, -0.0600721f, -0.0917592f, -0.3233241f, +0.2727337f, +0.0284804f,
  -0.0095909f, +0.0573858f, -0.1022024f, +0.1562598f, -0.3177918f, +0.1654687f, -0.1432323f, +0.0047659f,
  +0.2705388f, -0.0728364f, +0.2598659f, +0.0090500f, -0.5826382f, -0.0255091f, -0.2309274f, +0.2700463f,
  +0.2150039f, -0.2940571f, +0.1342894f, +0.0131533f, +0.0713650f, -0.1852446f, +0.0554794f, +0.1383831f,
  +0.1028578f, -0.2504329f, +0.1851331f, +0.1079336f, +0.0288786f, +0.0446876f, -0.0336280f, -0.1077955f,
  +0.1825207f, -0.5619001f, +0.0134348f, -0.3482676f, +0.3330692f, -0.2389433f, -0.5183315f, -0.2021427f,
  -0.1181879f, -0.2445224f, -0.1225872f, +0.1310798f, -0.1117166f, -0.0078284f, -0.0530049f, -0.0681588f,
  -0.0318008f, -0.3292687f, +0.4835329f, -0.0298829f, +0.3631184f, -0.2413826f, -0.1875006f, -0.2191732f,
  -0.3965787f, +0.2910364f, -0.0463422f, -0.5039991f, -0.1765655f, +0.2007669f, +0.0230975f, -0.2277075f,
  -0.2978140f, +0.0783060f, -0.2457307f, -0.2960715f, -0.2502375f, +0.1632600f, +0.0953711f, -0.3437853f,
  -0.2170189f, +0.0937402f, -0.0560370f, +0.0611920f, -0.1881972f, +0.1036823f, +0.2736021f, -0.2042998f,
  +0.2818680f, +0.2063621f, +0.1581090f, +0.0466579f, -0.1599947f, +0.5499188f, +0.1122075f, -0.5153854f,
  -0.1996338f, -0.3326502f, +0.2531215f, +0.2975084f, +0.1073375f, +0.7745993f, -0.2215799f, -0.2642143f,
  -0.0731166f, +0.1354264f, +0.1874161f, +0.4606155f, -0.0726415f, +0.1358092f, +0.6259944f, -0.0891983f,
  +0.0084487f, -0.2030290f, +0.1535854f, +0.1564239f, +0.2459297f, +0.1694925f, -0.3515988f, -0.1794349f,
  -0.5041990f, -0.1343870f, +0.1215604f, -0.0343955f, +0.4552396f, +0.0983488f, -0.1671461f, +0.1931861f,
  +0.1063513f, +0.0674925f, +0.1456377f, +0.2397393f, -0.0191762f, +0.1662320f, -0.0081195f, -0.0957759f,
  +0.4083326f, -0.0878385f, +0.0270844f, +0.0800759f, -0.2501294f, -0.7672747f, +0.2688563f, +0.5430872f,
  +0.1594411f, +0.0350571f, -0.1423685f, +0.3182734f, -0.0275914f, -0.0889422f, +0.0934515f, +0.1908426f,
  +0.1135713f, -0.3477017f, -0.1381690f, +0.0376313f, +0.3864100f, +0.2628447f, -0.3213204f, +0.0636573f,
  -0.0381079f, +0.0896750f, +0.0632818f, -0.3023634f, +0.1290187f, +0.2132808f, +0.0357630f, +0.5992913f,
  -0.0244206f, -0.0218050f, +0.1030625f, +0.0057524f, +0.2077847f, +0.0459623f, -0.0792310f, -0.0499867f,
  +0.0761124f, -0.2523725f, -0.1503184f, -0.1103690f, -0.0196795f, -0.2128763f, -0.1097926f, -0.1200254f,
  +0.3880053f, -0.4328883f, -0.2512174f, +0.0349985f, -0.2384613f, -0.1840180f, -0.5590404f, -0.1072822f,
  +0.0829364f, -0.1855352f, +0.0940698f, -0.0785585f, -0.0587252f, +0.1687550f, -0.1581325f, -0.0094752f,
  -0.3799708f, -0.0147583f, -0.0578527f, +0.2009547f, -0.1643565f, -0.0862700f, -0.0886721f, +0.0234942f,
  +0.1458229f, -0.0765097f, -0.1736497f, +0.2385745f, +0.0094831f, +0.0906495f, -0.0332051f, +0.2403947f,
  +0.2750600f, +0.0317414f, -0.0999997f, -0.0117677f, -0.0849102f, -0.2891326f, +0.0266285f, +0.1734524f,
  +0.2321679f, +0.5414257f, +0.2245126f, +0.3093433f, -0.0629937f, -0.0591705f, +0.0126954f, +0.3905036f,
  +0.5655223f, +0.0335516f, +0.5988309f, +0.1411760f, -0.2560290f, +0.1371877f, -0.2109818f, +0.2255672f,
  -0.2836451f, +0.0524702f, -0.1375172f, +0.1069542f, -0.2374492f, -0.1089962f, +0.0523212f, +0.0461824f,
  +0.0601345f, +0.4793279f, +0.1514731f, +0.1199018f, -0.1325266f, -0.1289471f, -0.0527791f, +0.2277139f,
  -0.1240135f, +0.1733854f, -0.5109126f, -0.1452104f, -0.0266403f, -0.1655570f, +0.1093845f, -0.0023692f,
  +0.0220500f, -0.1000289f, -0.0543168f, +0.1329951f, -0.1055439f, +0.0711583f, -0.2359496f, +0.0529542f
);

const float biases[4] = float[4](
  +0.0615180f, -0.0438178f, -0.0085801f, +0.0472756f
);

vec4 hook() {
    const vec4 r[9][2] = vec4[9][2](
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 1.0f)))
    );

    float sum[4] = biases;
    for (int n = 0; n < 4; n++) {
        for (int i = 0; i < 9; i++) {
            const vec4 k0 = vec4(kernels[n * 8 * 9 + 8 * i + 0], kernels[n * 8 * 9 + 8 * i + 1], kernels[n * 8 * 9 + 8 * i + 2], kernels[n * 8 * 9 + 8 * i + 3]);
            const vec4 k1 = vec4(kernels[n * 8 * 9 + 8 * i + 4], kernels[n * 8 * 9 + 8 * i + 5], kernels[n * 8 * 9 + 8 * i + 6], kernels[n * 8 * 9 + 8 * i + 7]);
            sum[n] += (dot(k0, r[i][0]) + dot(k1, r[i][1]));
        }
    }

    return ACTIVE(vec4(sum[0], sum[1], sum[2], sum[3]));
}

//!HOOK LUMA
//!DESC ARNet b16 Layer17 L1
//!WHEN OUTPUT.w LUMA.w / 1.2 > OUTPUT.h LUMA.h / 1.2 > *
//!BIND TMP2_L0
//!BIND TMP2_L1
//!SAVE TMP1_L1
//!COMPONENTS 4

#define ACTIVE(v) (max(v, v * 0.2000000f))

#define TEX_BIND_L0_TEXOFF TMP2_L0_texOff
#define TEX_BIND_L0_TEX TMP2_L0_tex
#define TEX_BIND_L0_POS TMP2_L0_pos
#define TEX_BIND_L0_SIZE TMP2_L0_size
#define TEX_BIND_L0_PT TMP2_L0_pt

#define TEX_BIND_L1_TEXOFF TMP2_L1_texOff
#define TEX_BIND_L1_TEX TMP2_L1_tex
#define TEX_BIND_L1_POS TMP2_L1_pos
#define TEX_BIND_L1_SIZE TMP2_L1_size
#define TEX_BIND_L1_PT TMP2_L1_pt

const float kernels[288] = float[288](
  -0.1483608f, -0.0817535f, -0.1933527f, +0.0468523f, -0.2290137f, +0.1313348f, +0.0659385f, +0.0586294f,
  -0.0418165f, -0.1416553f, -0.1296605f, +0.4211348f, +0.0959685f, +0.6327702f, -0.3926649f, +0.0360416f,
  +0.2661321f, +0.1823646f, -0.1418252f, +0.1626677f, +0.1283428f, +0.3074855f, -0.2727715f, +0.0341451f,
  +0.5615394f, -0.0671952f, +0.0692725f, -0.0469234f, +0.1078454f, -0.2275356f, +0.2765243f, +0.2132836f,
  +0.7837413f, +0.2220906f, -1.1183848f, +0.3515438f, +0.4609590f, -0.2969846f, +0.0454146f, +0.4681939f,
  +0.3657905f, +0.1680891f, -0.1364016f, +0.1514256f, +0.1821951f, +0.0016784f, -0.0154557f, +0.1879371f,
  -0.2870643f, +0.4750912f, -0.2196569f, -0.3023663f, +0.0138289f, -0.1555878f, -0.0294181f, +0.2864357f,
  +0.1983891f, +0.3314486f, -0.2691947f, -0.0932499f, +0.3014512f, -0.1035434f, -0.0228786f, +0.1337061f,
  +0.0532018f, +0.0241048f, -0.0647083f, +0.1316818f, -0.0080295f, -0.1420602f, +0.1650445f, +0.0784767f,
  -0.1118753f, +0.0618001f, +0.0179683f, +0.0474821f, -0.2911053f, +0.1229087f, -0.0588149f, +0.1274738f,
  +0.2368844f, +0.3285400f, -0.0541329f, +0.2891428f, +0.2253256f, +1.0582269f, -0.6009880f, -0.1909825f,
  -0.0046573f, +0.2145691f, -0.0790062f, +0.0927635f, -0.0095021f, +0.3243263f, -0.2467492f, -0.0037500f,
  +0.5901011f, +0.2968189f, +0.2330412f, +0.0730554f, -0.2469591f, -0.1657848f, +0.2479575f, -0.1660126f,
  +0.4673775f, +0.1591238f, -0.7619147f, +0.1196192f, +0.6275173f, -0.3639888f, +0.0556875f, +0.4780253f,
  +0.0951726f, +0.2206089f, -0.2601615f, +0.1076873f, -0.1371121f, -0.0450307f, +0.0859500f, +0.1956175f,
  -0.1066738f, +0.3058298f, -0.0478689f, -0.0799394f, -0.0957970f, -0.0656607f, +0.2196279f, +0.1734669f,
  -0.1410710f, +0.6944129f, -0.1396369f, -0.1342619f, +0.5610211f, -0.2413994f, +0.3941352f, +0.0554539f,
  +0.1012604f, +0.1297386f, +0.1192672f, +0.0892321f, +0.0397013f, +0.0084485f, +0.0498474f, +0.1288104f,
  -0.4120606f, -0.1293506f, -0.5400214f, +0.0815666f, -0.4685785f, +0.0874691f, +0.1407479f, -0.1866905f,
  -1.3123981f, -0.4945376f, -0.4483422f, +0.0410376f, -0.4265908f, +0.2461452f, -0.2559437f, -0.5752159f,
  -0.0344875f, +0.1729730f, -0.1245571f, +0.0222638f, -0.3695236f, +0.2363429f, +0.2917099f, -0.2954871f,
  -0.5371303f, -0.0026503f, +0.1835257f, +0.0308195f, +0.7790219f, +0.1836461f, +0.4727530f, -0.0494052f,
  +0.6911545f, -0.0852782f, +0.3350088f, +0.3493032f, +0.0476181f, -0.0373281f, +0.5981004f, +0.0851362f,
  +0.2950613f, -0.1024404f, +0.0404882f, +0.1693959f, -0.3200853f, +0.3248852f, -0.1162911f, +0.3027077f,
  +0.1656291f, +0.2840517f, -0.3606599f, -0.0464496f, -0.3110543f, -0.0562117f, +0.0458603f, +0.2918037f,
  -0.1359567f, +0.5226458f, -0.0384783f, -0.1612179f, +0.4194685f, -0.1187431f, +0.2375740f, +0.0784767f,
  +0.0662424f, +0.3373252f, +0.2337501f, +0.0128047f, +0.4394206f, -0.0490292f, +0.3007267f, -0.0928236f,
  -0.0509805f, -0.1715053f, -0.0532630f, +0.0514175f, -0.0669134f, +0.2524587f, -0.1624952f, -0.1083878f,
  +0.1849209f, -0.2221297f, -0.2792529f, -0.0272139f, +0.6162580f, +0.2115294f, +0.0467865f, +0.0258171f,
  -0.1891756f, -0.0796335f, -0.1000633f, +0.0710093f, +0.1589001f, +0.1315471f, -0.0500733f, -0.1438976f,
  +0.2634380f, +0.2219188f, +0.2958412f, -0.0327055f, -0.1235889f, -0.4619861f, +0.0421813f, -0.4707097f,
  +0.2125568f, -0.4854420f, +0.1903909f, -0.6824782f, -0.3343065f, -0.1299012f, +0.5219861f, +0.3075578f,
  +0.1237312f, -0.1267044f, -0.2722944f, -0.1100413f, +0.1608829f, -0.0974610f, -0.0888543f, -0.0227409f,
  -0.0711929f, +0.0739960f, +0.2358922f, +0.3918203f, +0.0699156f, +0.5519934f, -0.3732523f, +0.0431219f,
  -0.3714362f, +0.2883005f, +0.1088668f, -0.4786551f, +0.6413101f, +0.0064945f, -0.0082112f, -0.1133480f,
  -0.2641320f, -0.1201694f, +0.2545438f, -0.2837792f, +0.7039118f, -0.3181465f, -0.0807732f, -0.3080425f
);

const float biases[4] = float[4](
  +0.0338361f, +0.0194938f, -0.0648229f, -0.0232154f
);

vec4 hook() {
    const vec4 r[9][2] = vec4[9][2](
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 1.0f)))
    );

    float sum[4] = biases;
    for (int n = 0; n < 4; n++) {
        for (int i = 0; i < 9; i++) {
            const vec4 k0 = vec4(kernels[n * 8 * 9 + 8 * i + 0], kernels[n * 8 * 9 + 8 * i + 1], kernels[n * 8 * 9 + 8 * i + 2], kernels[n * 8 * 9 + 8 * i + 3]);
            const vec4 k1 = vec4(kernels[n * 8 * 9 + 8 * i + 4], kernels[n * 8 * 9 + 8 * i + 5], kernels[n * 8 * 9 + 8 * i + 6], kernels[n * 8 * 9 + 8 * i + 7]);
            sum[n] += (dot(k0, r[i][0]) + dot(k1, r[i][1]));
        }
    }

    return ACTIVE(vec4(sum[0], sum[1], sum[2], sum[3]));
}

//!HOOK LUMA
//!DESC ARNet b16 Layer18 L0
//!WHEN OUTPUT.w LUMA.w / 1.2 > OUTPUT.h LUMA.h / 1.2 > *
//!BIND TMP1_L0
//!BIND TMP1_L1
//!BIND TMP2_L0
//!SAVE TMP2_L0
//!COMPONENTS 4

#define ACTIVE(v) (v)

#define TEX_BIND_L0_TEXOFF TMP1_L0_texOff
#define TEX_BIND_L0_TEX TMP1_L0_tex
#define TEX_BIND_L0_POS TMP1_L0_pos
#define TEX_BIND_L0_SIZE TMP1_L0_size
#define TEX_BIND_L0_PT TMP1_L0_pt

#define TEX_BIND_L1_TEXOFF TMP1_L1_texOff
#define TEX_BIND_L1_TEX TMP1_L1_tex
#define TEX_BIND_L1_POS TMP1_L1_pos
#define TEX_BIND_L1_SIZE TMP1_L1_size
#define TEX_BIND_L1_PT TMP1_L1_pt

#define TEX_BIND_L2_TEXOFF TMP2_L0_texOff
#define TEX_BIND_L2_TEX TMP2_L0_tex
#define TEX_BIND_L2_POS TMP2_L0_pos
#define TEX_BIND_L2_SIZE TMP2_L0_size
#define TEX_BIND_L2_PT TMP2_L0_pt

const float kernels[288] = float[288](
  -0.0265956f, +0.2226335f, -0.1720603f, +0.0521977f, +0.0239902f, +0.0410468f, +0.0726130f, +0.2774183f,
  +0.0054211f, -0.1510185f, +0.1300638f, +0.0041164f, -0.0783356f, +0.0910122f, -0.0943053f, +0.0963885f,
  +0.0798301f, +0.0343603f, -0.2392655f, +0.1818659f, +0.1354600f, -0.1837947f, +0.2782863f, +0.1606716f,
  -0.2763824f, -0.1650101f, -0.0724525f, +0.1262398f, +0.0532988f, -0.0177243f, +0.0050956f, -0.3413034f,
  +0.0894913f, +0.3125298f, +0.0481496f, -0.6012100f, +0.1749807f, -0.1130730f, +0.2700676f, +0.4706052f,
  +0.3283209f, +0.2362269f, -0.2031307f, -0.3432207f, -0.1184555f, -0.7302115f, -0.1168724f, -0.0393490f,
  -0.2306930f, +0.4345740f, -0.1417776f, -0.4379469f, +0.0346587f, +0.1616716f, +0.2047882f, -0.2408037f,
  -0.1547988f, +0.1472877f, -0.0684987f, -0.4102438f, +0.3625385f, +0.2875972f, +0.0858045f, -0.2474073f,
  +0.1572704f, +0.1331834f, -0.0764775f, +0.0350749f, +0.0854213f, +0.0890850f, +0.0709731f, -0.1110118f,
  +0.1706129f, -0.2526664f, +0.0651157f, -0.1083264f, -0.0355313f, +0.1298980f, -0.0223130f, -0.1101205f,
  +0.1643129f, -0.1318009f, +0.0471072f, -0.1597347f, +0.2827185f, +0.1867763f, +0.1911118f, +0.3227619f,
  +0.0806294f, +0.0517415f, +0.0066667f, -0.2396593f, -0.3977840f, +0.1837296f, -0.2961678f, -0.3264413f,
  +0.1503698f, +0.4192033f, +0.0589013f, +0.0405724f, +0.0090843f, +0.5213268f, -0.2635517f, -0.2545528f,
  +0.5031551f, -0.2503934f, -0.0634135f, +0.0030830f, +0.2109856f, +0.6455970f, -0.0386047f, +0.0266176f,
  -0.1542910f, +0.1611309f, +0.6279694f, -0.3192124f, +0.2792681f, +0.2008372f, -0.3529182f, -0.0672452f,
  +0.1486558f, +0.2582066f, -0.3560879f, +0.0365153f, -0.0017520f, -0.0508702f, -0.2328470f, -0.1765825f,
  +0.1927020f, +0.3524330f, -0.1315901f, +0.1659412f, +0.2301962f, -0.0070807f, +0.2429796f, +0.0461468f,
  +0.1877181f, +0.3343632f, +0.2951229f, -0.1855761f, -0.1067864f, +0.1792276f, +0.3080301f, +0.2047601f,
  -0.1184256f, +0.0085351f, -0.1171682f, +0.0918846f, -0.0017305f, -0.1565813f, +0.0234885f, -0.3766919f,
  -0.1729533f, +0.4502987f, +0.0611351f, +0.4209552f, +0.3100013f, +0.0200813f, -0.1269929f, -0.3790521f,
  -0.2791736f, +0.0658606f, -0.0628424f, +0.4199442f, +0.2711265f, -0.0337610f, +0.2366471f, -0.2330275f,
  +0.1411549f, -0.2755538f, -0.3209479f, -0.3569981f, -0.0252541f, -0.1260551f, +0.2226340f, -0.1060189f,
  +0.0605086f, -0.0037353f, -0.0030032f, -0.4404033f, +0.7923418f, +0.5244743f, +0.2673037f, +0.0397550f,
  -0.0664309f, +0.0624086f, -0.1319207f, +0.0316986f, +0.2550012f, -0.6056566f, -0.0024810f, -0.0626138f,
  -0.0573240f, +0.0138746f, +0.0299146f, +0.1307989f, +0.0551228f, -0.1202457f, -0.0371052f, +0.1533456f,
  -0.0346882f, +0.2401747f, -0.0522752f, +0.1399981f, +0.2380630f, -0.2021555f, -0.1697243f, -0.2562128f,
  -0.1318486f, +0.0028064f, +0.1192956f, +0.0060484f, +0.2082407f, -0.2883813f, +0.3425395f, +0.1233786f,
  +0.1075302f, -0.0597512f, +0.3629759f, -0.3253390f, +0.0986203f, +0.0916278f, +0.1103874f, +0.8980108f,
  +0.0909748f, +0.0816454f, +0.1264167f, +0.1245325f, -0.4219348f, +0.3966304f, -0.0353299f, +0.8529722f,
  +0.2224557f, -0.1472154f, +0.2440789f, -0.5762301f, +0.0817085f, +0.1112573f, +0.1855651f, +0.3455267f,
  +0.0520614f, -0.7328424f, +0.5324011f, -0.2526335f, -0.3580306f, +0.5741006f, +0.0957010f, +0.5169200f,
  -0.4168918f, -0.5822491f, -0.2044397f, -0.1559613f, -0.4317843f, +0.1213228f, +0.6430413f, -0.0651477f,
  +0.1869234f, -0.0803481f, -0.7994639f, +0.1778951f, -0.4446961f, -0.2804937f, -0.1499738f, +0.0080273f,
  +0.0612651f, +0.2088839f, -0.1665968f, -0.0421864f, -0.4858304f, +0.4217861f, -0.2414204f, -0.1765675f,
  +0.2655584f, -0.0625549f, +0.2197960f, -0.1435875f, +0.0304459f, +0.5404633f, -0.8968507f, +0.0353004f,
  +0.1314497f, +0.5462846f, +0.0387789f, -0.0520973f, -0.1890036f, +0.0897772f, -0.7529302f, -0.1150917f
);

const float biases[4] = float[4](
  +0.0268889f, +0.0530915f, -0.0090380f, +0.0620165f
);

vec4 hook() {
    const vec4 r[9][2] = vec4[9][2](
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 1.0f)))
    );

    float sum[4] = biases;
    for (int n = 0; n < 4; n++) {
        for (int i = 0; i < 9; i++) {
            const vec4 k0 = vec4(kernels[n * 8 * 9 + 8 * i + 0], kernels[n * 8 * 9 + 8 * i + 1], kernels[n * 8 * 9 + 8 * i + 2], kernels[n * 8 * 9 + 8 * i + 3]);
            const vec4 k1 = vec4(kernels[n * 8 * 9 + 8 * i + 4], kernels[n * 8 * 9 + 8 * i + 5], kernels[n * 8 * 9 + 8 * i + 6], kernels[n * 8 * 9 + 8 * i + 7]);
            sum[n] += (dot(k0, r[i][0]) + dot(k1, r[i][1]));
        }
    }

    return ACTIVE(vec4(sum[0], sum[1], sum[2], sum[3]) * 0.2000000f + TEX_BIND_L2_TEXOFF(vec2(0.0f, 0.0f)));
}

//!HOOK LUMA
//!DESC ARNet b16 Layer18 L1
//!WHEN OUTPUT.w LUMA.w / 1.2 > OUTPUT.h LUMA.h / 1.2 > *
//!BIND TMP1_L0
//!BIND TMP1_L1
//!BIND TMP2_L1
//!SAVE TMP2_L1
//!COMPONENTS 4

#define ACTIVE(v) (v)

#define TEX_BIND_L0_TEXOFF TMP1_L0_texOff
#define TEX_BIND_L0_TEX TMP1_L0_tex
#define TEX_BIND_L0_POS TMP1_L0_pos
#define TEX_BIND_L0_SIZE TMP1_L0_size
#define TEX_BIND_L0_PT TMP1_L0_pt

#define TEX_BIND_L1_TEXOFF TMP1_L1_texOff
#define TEX_BIND_L1_TEX TMP1_L1_tex
#define TEX_BIND_L1_POS TMP1_L1_pos
#define TEX_BIND_L1_SIZE TMP1_L1_size
#define TEX_BIND_L1_PT TMP1_L1_pt

#define TEX_BIND_L2_TEXOFF TMP2_L1_texOff
#define TEX_BIND_L2_TEX TMP2_L1_tex
#define TEX_BIND_L2_POS TMP2_L1_pos
#define TEX_BIND_L2_SIZE TMP2_L1_size
#define TEX_BIND_L2_PT TMP2_L1_pt

const float kernels[288] = float[288](
  +0.3590734f, -0.3485586f, +0.1779039f, -0.2058097f, -0.0490438f, +0.0558925f, +0.1710583f, -0.0469987f,
  -0.1134485f, -0.2863004f, -0.0016595f, +0.3571106f, +0.2662669f, -0.0097398f, -0.2652683f, +0.4582117f,
  +0.0754396f, -0.3084517f, -0.1377875f, -0.0934541f, -0.0501533f, +0.1011064f, -0.2726344f, -0.2295209f,
  -0.0163751f, -0.7100608f, +0.2795744f, -0.0433723f, -0.6615136f, +0.3699553f, +0.3479889f, -0.7077184f,
  +0.7161677f, +0.0222841f, -0.1213347f, -0.1092571f, +0.4048122f, -0.1164627f, -0.7995073f, +0.6421414f,
  +0.2084759f, -0.2758037f, +0.4036755f, +0.3455184f, -0.3229921f, +0.4595152f, +0.4705987f, +0.4470591f,
  +0.2415566f, -0.0057565f, -0.0045877f, -0.1355162f, -0.0396195f, +0.0764223f, +0.1747931f, -0.0658190f,
  -0.1187009f, +0.0473905f, -0.1545238f, -0.3720053f, +0.5681657f, -0.7295687f, +1.2619785f, -0.1895901f,
  +0.1148405f, -0.2080343f, -0.0153118f, -0.1484158f, +0.3802291f, -0.1184021f, +0.3321239f, +0.1372184f,
  -0.2159745f, +0.1270658f, +0.0312134f, -0.1309533f, -0.0512194f, -0.0384030f, +0.0651030f, +0.1031038f,
  +0.0012462f, -0.1862709f, -0.0594461f, -0.0825429f, -0.2365008f, -0.2530641f, -0.0861851f, +0.0811134f,
  +0.0272709f, -0.1384066f, +0.1036269f, -0.3067334f, -0.2148914f, -0.1883749f, -0.0881299f, -0.0575726f,
  -0.1956207f, +0.0214158f, +0.0403444f, +0.1245315f, +0.3141863f, -0.0085602f, -0.3391412f, +0.0023290f,
  -0.2273382f, -0.3037272f, -0.2042350f, +0.1839274f, -0.0973965f, -0.0627175f, -0.0327849f, +0.0615693f,
  -0.1615411f, -0.0717007f, +0.1354142f, -0.1055827f, -0.2298930f, +0.1504495f, +0.0974940f, +0.0313794f,
  +0.1053799f, +0.3777915f, -0.0334876f, +0.0123539f, +0.2758127f, -0.1129885f, +0.1060349f, +0.2536670f,
  -0.4312005f, +0.3594702f, -0.0025731f, -0.0598617f, +0.3517933f, -0.5025661f, +0.3075021f, +0.5258602f,
  -0.0708719f, +0.1541595f, +0.2714529f, -0.0894071f, +0.1018721f, +0.1779113f, -0.1858734f, -0.2480845f,
  -0.1266403f, +0.1826382f, +0.0427134f, -0.2820434f, -0.0954186f, -0.1126826f, +0.1040000f, -0.0575821f,
  +0.2175093f, -0.3374603f, -0.1719066f, -0.1371217f, -0.5830610f, +0.4469178f, -0.8288504f, +0.2422946f,
  +0.1435109f, -0.1780824f, +0.3163481f, -0.1111474f, -0.2027035f, +0.2582207f, +0.2468347f, +0.5040025f,
  -0.0279357f, +0.0678023f, -0.0310580f, +0.1056227f, +0.0717191f, +0.0751176f, +0.0498018f, +0.0317571f,
  -0.0264088f, -0.0843389f, -0.1058351f, -0.2068031f, -0.1540054f, +0.5659323f, +0.5632764f, -0.2844938f,
  +0.3068362f, +0.1125446f, -0.7344573f, +0.2841182f, -0.5294356f, +0.1587499f, +0.5033088f, -0.0211327f,
  -0.0662004f, +0.0079127f, -0.3561083f, -0.2018772f, +0.1025833f, -0.0307664f, +0.1220110f, -0.3143096f,
  -0.1221754f, -0.1467987f, -0.0432808f, -0.0678628f, +0.0808867f, +0.4424990f, -0.1144265f, +0.0848779f,
  +0.0660934f, +0.2066106f, -0.2555482f, +0.2328117f, -0.4003746f, +0.2454973f, -0.2934282f, +0.0721366f,
  +0.1560954f, -0.0763051f, -0.0256381f, +0.1358926f, -0.0031018f, +0.0949784f, -0.0438389f, -0.0676020f,
  +0.1793567f, -0.0804376f, +0.1409154f, +0.1007605f, +0.1685434f, -0.0657428f, +0.1682903f, +0.0579630f,
  +0.0493387f, -0.0440925f, -0.2839142f, -0.1167736f, -0.1280087f, +0.1954676f, -0.1113150f, -0.1282039f,
  -0.0414906f, -0.3862209f, +0.1628251f, +0.1412425f, -0.0536930f, -0.1240099f, +0.0009087f, +0.2640958f,
  -0.1047491f, +0.1484563f, +0.0974466f, -0.1978818f, -0.2185535f, -0.3764581f, +0.1695240f, +0.4795220f,
  +0.1098521f, -0.2236694f, +0.1404990f, -0.1909353f, -0.1076653f, +0.0567986f, -0.3448841f, +0.1215114f,
  -0.0393133f, -0.2638097f, +0.0247074f, -0.1791930f, -0.2070413f, +0.1619372f, +0.1783213f, -0.1363632f,
  +0.2327441f, -0.1222425f, -0.0181620f, -0.1607093f, -0.0993234f, +0.3785155f, -0.2082792f, -0.3541304f,
  +0.1875067f, +0.0050676f, -0.0805460f, +0.0415303f, -0.0203193f, +0.0980682f, +0.2009676f, +0.2534270f
);

const float biases[4] = float[4](
  -0.2208646f, +0.0567473f, +0.0157334f, -0.0464161f
);

vec4 hook() {
    const vec4 r[9][2] = vec4[9][2](
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 1.0f)))
    );

    float sum[4] = biases;
    for (int n = 0; n < 4; n++) {
        for (int i = 0; i < 9; i++) {
            const vec4 k0 = vec4(kernels[n * 8 * 9 + 8 * i + 0], kernels[n * 8 * 9 + 8 * i + 1], kernels[n * 8 * 9 + 8 * i + 2], kernels[n * 8 * 9 + 8 * i + 3]);
            const vec4 k1 = vec4(kernels[n * 8 * 9 + 8 * i + 4], kernels[n * 8 * 9 + 8 * i + 5], kernels[n * 8 * 9 + 8 * i + 6], kernels[n * 8 * 9 + 8 * i + 7]);
            sum[n] += (dot(k0, r[i][0]) + dot(k1, r[i][1]));
        }
    }

    return ACTIVE(vec4(sum[0], sum[1], sum[2], sum[3]) * 0.2000000f + TEX_BIND_L2_TEXOFF(vec2(0.0f, 0.0f)));
}

//!HOOK LUMA
//!DESC ARNet b16 Layer19 L0
//!WHEN OUTPUT.w LUMA.w / 1.2 > OUTPUT.h LUMA.h / 1.2 > *
//!BIND TMP2_L0
//!BIND TMP2_L1
//!SAVE TMP1_L0
//!COMPONENTS 4

#define ACTIVE(v) (max(v, v * 0.2000000f))

#define TEX_BIND_L0_TEXOFF TMP2_L0_texOff
#define TEX_BIND_L0_TEX TMP2_L0_tex
#define TEX_BIND_L0_POS TMP2_L0_pos
#define TEX_BIND_L0_SIZE TMP2_L0_size
#define TEX_BIND_L0_PT TMP2_L0_pt

#define TEX_BIND_L1_TEXOFF TMP2_L1_texOff
#define TEX_BIND_L1_TEX TMP2_L1_tex
#define TEX_BIND_L1_POS TMP2_L1_pos
#define TEX_BIND_L1_SIZE TMP2_L1_size
#define TEX_BIND_L1_PT TMP2_L1_pt

const float kernels[288] = float[288](
  +0.0352820f, -0.0287078f, +0.1716791f, -0.0905351f, +0.0436272f, -0.0114448f, -0.0891432f, +0.0157293f,
  -0.1337152f, +0.1897487f, +0.0652865f, +0.0870972f, +0.1132909f, -0.0702253f, -0.1773117f, -0.0382605f,
  -0.1749806f, -0.1179044f, -0.0881827f, -0.0741199f, -0.2660713f, -0.3061420f, +0.2205174f, +0.1789066f,
  +0.2404821f, +0.1371418f, +0.0084996f, -0.0851804f, +0.0345102f, +0.1480030f, -0.2139069f, +0.0106506f,
  -0.2213512f, +0.0299133f, +0.5989136f, +0.0020891f, -0.1138737f, -0.5266173f, -0.1750393f, -0.1591325f,
  -0.5165084f, +0.0942689f, -0.1792710f, -0.2663000f, -0.3211280f, -0.3156373f, +0.4131681f, +0.0848012f,
  +0.1004363f, -0.1887842f, +0.2072604f, -0.0318161f, +0.0673299f, -0.0307750f, -0.0382608f, -0.1382791f,
  +0.0914976f, -0.2268838f, +0.6436605f, +0.6324642f, +0.4830554f, +0.0841320f, -0.8586614f, -0.0631254f,
  +0.0573854f, -0.4184289f, +0.3575305f, +0.0429222f, +0.3062952f, -0.0802192f, +0.0858440f, -0.2944196f,
  -0.0169205f, +0.2068660f, +0.1325870f, +0.0801023f, -0.1829663f, +0.1061722f, -0.2795346f, -0.0650063f,
  -0.1540681f, -0.3039970f, -0.3888609f, +0.3118348f, -0.1010100f, -0.0820644f, +0.2577604f, -0.0018712f,
  -0.1144532f, -0.1424604f, +0.0302447f, -0.0902874f, -0.1479633f, -0.4026330f, +0.2188631f, +0.1365276f,
  +0.2754596f, -0.0148857f, +0.1770591f, -0.0537508f, -0.0727841f, +0.1127677f, -0.4132854f, -0.0582628f,
  -0.3619949f, -0.2643326f, -0.8668116f, +0.7572182f, -0.1738672f, -0.2929693f, +0.9775611f, +0.3403586f,
  -0.0622716f, -0.2855583f, +0.6940709f, -0.0674331f, +0.1394669f, +0.4334700f, -0.1430482f, -0.3670637f,
  -0.0169875f, +0.1403921f, +0.0943069f, -0.1549375f, +0.1306634f, +0.0657810f, -0.1206381f, +0.0229129f,
  +0.3761308f, -0.2401289f, -0.1587649f, +0.4433744f, -0.3423787f, +0.2360516f, -0.0360871f, +0.1694464f,
  -0.2403463f, +0.0492529f, +0.0396939f, -0.1192027f, +0.0932729f, -0.1075744f, +0.3216011f, +0.0299297f,
  +0.1410103f, -0.0904504f, +0.2352592f, +0.0968726f, +0.1189742f, -0.0594803f, -0.0730913f, +0.0784205f,
  +0.1476084f, +0.3196990f, -0.2913150f, +0.1645040f, -0.0161052f, +0.3457623f, +0.0510713f, +0.2195641f,
  -0.0105954f, +0.0220658f, -0.1773342f, +0.1378788f, +0.1937219f, -0.2002088f, -0.1042651f, +0.0024703f,
  -0.2867293f, -0.1619954f, +0.2305426f, +0.0608924f, +0.1079632f, -0.3406011f, -0.2105565f, +0.1102098f,
  +0.4635223f, -0.2908073f, -0.3358920f, +0.2357388f, -0.5350881f, +0.0464049f, +0.3313886f, -0.0203970f,
  +0.0999138f, +0.0776348f, +0.1134253f, +0.2122727f, -0.0987088f, +0.1959486f, +0.1674437f, +0.0515224f,
  -0.0269019f, -0.1571619f, +0.3122119f, +0.0009440f, -0.0927133f, -0.2420744f, -0.3716830f, +0.1221732f,
  +0.3627175f, +0.2482938f, -0.6668979f, +0.4681031f, -0.0239181f, -0.1610023f, +0.0115935f, +0.1907904f,
  -0.1192296f, +0.0675295f, -0.3434386f, +0.2620328f, -0.0505722f, -0.1330879f, +0.0229727f, +0.2116758f,
  -0.0414095f, +0.0682666f, -0.0532759f, -0.0336841f, -0.2162262f, +0.0888793f, -0.1013938f, +0.0410220f,
  -0.2672540f, -0.0769475f, -0.1337069f, +0.1580142f, -0.1742792f, -0.3951049f, +0.0798647f, +0.0273693f,
  -0.2331663f, -0.1100086f, -0.0522860f, -0.0101436f, -0.0770550f, -0.0509803f, -0.0369778f, +0.0226779f,
  -0.1861779f, -0.3743624f, -0.4381804f, +0.1014788f, -0.2327590f, -0.7176332f, +0.5048158f, +0.2874369f,
  -0.6668348f, -0.0830629f, +0.0869047f, +0.0416849f, +0.0469201f, +0.0250484f, -0.1990076f, -0.0085625f,
  +0.0623132f, +0.1858844f, -0.0207310f, +0.2763153f, -0.0427884f, +0.3901745f, -0.1291975f, -0.0737027f,
  +0.0438415f, -0.2588519f, -0.3602294f, +0.4181316f, -0.0073938f, +0.1060206f, +0.2079614f, +0.4317884f,
  -0.0649471f, -0.1942314f, -0.2827781f, +0.3489767f, -0.2388384f, +0.4565261f, -0.0832358f, -0.0349293f,
  +0.2565560f, +0.0078527f, +0.0291626f, +0.1802330f, +0.1776040f, +0.0667805f, +0.0986698f, +0.0181992f
);

const float biases[4] = float[4](
  +0.0888456f, -0.0441265f, +0.0385731f, -0.0094475f
);

vec4 hook() {
    const vec4 r[9][2] = vec4[9][2](
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 1.0f)))
    );

    float sum[4] = biases;
    for (int n = 0; n < 4; n++) {
        for (int i = 0; i < 9; i++) {
            const vec4 k0 = vec4(kernels[n * 8 * 9 + 8 * i + 0], kernels[n * 8 * 9 + 8 * i + 1], kernels[n * 8 * 9 + 8 * i + 2], kernels[n * 8 * 9 + 8 * i + 3]);
            const vec4 k1 = vec4(kernels[n * 8 * 9 + 8 * i + 4], kernels[n * 8 * 9 + 8 * i + 5], kernels[n * 8 * 9 + 8 * i + 6], kernels[n * 8 * 9 + 8 * i + 7]);
            sum[n] += (dot(k0, r[i][0]) + dot(k1, r[i][1]));
        }
    }

    return ACTIVE(vec4(sum[0], sum[1], sum[2], sum[3]));
}

//!HOOK LUMA
//!DESC ARNet b16 Layer19 L1
//!WHEN OUTPUT.w LUMA.w / 1.2 > OUTPUT.h LUMA.h / 1.2 > *
//!BIND TMP2_L0
//!BIND TMP2_L1
//!SAVE TMP1_L1
//!COMPONENTS 4

#define ACTIVE(v) (max(v, v * 0.2000000f))

#define TEX_BIND_L0_TEXOFF TMP2_L0_texOff
#define TEX_BIND_L0_TEX TMP2_L0_tex
#define TEX_BIND_L0_POS TMP2_L0_pos
#define TEX_BIND_L0_SIZE TMP2_L0_size
#define TEX_BIND_L0_PT TMP2_L0_pt

#define TEX_BIND_L1_TEXOFF TMP2_L1_texOff
#define TEX_BIND_L1_TEX TMP2_L1_tex
#define TEX_BIND_L1_POS TMP2_L1_pos
#define TEX_BIND_L1_SIZE TMP2_L1_size
#define TEX_BIND_L1_PT TMP2_L1_pt

const float kernels[288] = float[288](
  -0.0683485f, -0.1388778f, -0.1087908f, +0.0115775f, -0.0728704f, +0.1283633f, -0.1505331f, -0.0524042f,
  +0.0017262f, +0.0706539f, -0.2278249f, -0.0020659f, +0.0771706f, -0.3127328f, -0.0795906f, +0.4796914f,
  +0.3397481f, +0.4070226f, +0.1341114f, +0.1741870f, +0.2742455f, +0.4138249f, -0.3594086f, -0.0583459f,
  +0.1791039f, +0.1311474f, -0.0767042f, -0.1583125f, +0.2804285f, -0.0086227f, +0.2220618f, -0.1382252f,
  -0.1872764f, +0.1163127f, +0.1534498f, -0.3889174f, +0.0806678f, -0.2768502f, -0.0697139f, +0.4349150f,
  +0.4225820f, +0.0217721f, +0.1361958f, +0.0999655f, +0.4955055f, -0.1733803f, -0.4075589f, -0.0534387f,
  -0.1134854f, +0.0149555f, -0.0745341f, -0.1823346f, +0.0213346f, -0.0160722f, -0.0041866f, +0.0634770f,
  +0.0982306f, -0.0592054f, +0.3310499f, -0.0420913f, -0.1358417f, +0.0049485f, -0.0617519f, -0.1232173f,
  -0.0412807f, +0.1122835f, -0.2677484f, -0.2297199f, -0.2836756f, -0.1054170f, +0.3268129f, +0.1197350f,
  +0.4172758f, +0.1911520f, +0.0444734f, +0.2047495f, +0.0859452f, +0.3704894f, -0.2058428f, -0.0998463f,
  +0.1582948f, +0.1473661f, +0.1359888f, -0.2446575f, -0.1453059f, -0.4850262f, +0.2130566f, +0.1968618f,
  -0.0612564f, -0.0391591f, -0.1366355f, +0.1229532f, -0.0489775f, -0.1614361f, +0.0371708f, +0.1728477f,
  +0.1183684f, +0.0842267f, -0.0196509f, +0.5171927f, +0.4475564f, +0.2138105f, -0.3246441f, -0.1555517f,
  -0.3266293f, -0.2774050f, +0.4055027f, -0.2872474f, -1.4304833f, -0.2022864f, +0.3441106f, +0.2483938f,
  +0.1995464f, +0.0949724f, -0.0705716f, +0.0272304f, +0.1663882f, -0.0210700f, -0.1264614f, +0.0693236f,
  +0.3168785f, -0.0753065f, -0.0995636f, +0.5211425f, +0.4501521f, +0.0750435f, -0.0281772f, +0.1016202f,
  -0.0844754f, -0.3182701f, +0.1665828f, +0.0263529f, -0.7458117f, +0.3842951f, +0.0902336f, -0.1157155f,
  -0.0234264f, +0.0928437f, -0.3947779f, -0.2854337f, -0.1041959f, -0.0847569f, +0.3044319f, -0.0993169f,
  +0.0067783f, -0.0333877f, +0.0615043f, +0.0346766f, +0.0701715f, +0.0165000f, -0.0371915f, +0.2803984f,
  +0.3311475f, +0.2600240f, -0.0160687f, +0.3914359f, +0.0565122f, +0.4698021f, -0.0654678f, +0.2044921f,
  -0.0169211f, -0.2467322f, -0.0103939f, -0.0113046f, +0.3237010f, +0.0078297f, -0.2054482f, -0.1497554f,
  +0.0928830f, +0.2232250f, -0.0835016f, -0.3706493f, -0.0836225f, -0.4013399f, +0.0145123f, +0.0890790f,
  +0.4403276f, +0.3711255f, -0.3564515f, +0.5142891f, +0.5144240f, +0.0586012f, +0.2120667f, +0.1701121f,
  -0.0527125f, -0.0421869f, -0.1408081f, +0.1188239f, +0.0993327f, +0.0342364f, -0.0028482f, +0.0756799f,
  -0.3169324f, -0.0440539f, -0.1564793f, -0.0114528f, -0.2907001f, -0.1018212f, +0.4190869f, +0.2048933f,
  +0.1213810f, +0.1013710f, -0.3452589f, -0.2996714f, -0.3589182f, -0.1600507f, -1.0163583f, +0.0204772f,
  +0.0015790f, +0.1786194f, -0.2783737f, +0.0303606f, -0.0765689f, -0.0842576f, -0.0636750f, -0.0355329f,
  +0.1540483f, +0.0430973f, +0.1824553f, +0.1203642f, +0.1311570f, +0.0954879f, -0.0090075f, -0.1260960f,
  -0.1074447f, -0.3393369f, -0.2273978f, +0.0473212f, +0.7110674f, -0.2986548f, +0.1155142f, +0.3313910f,
  -0.2455814f, -0.3322967f, -0.2221762f, -0.2486791f, +0.0460043f, -0.7327310f, +0.3784544f, +0.0816264f,
  -0.0140902f, -0.0424130f, -0.0653025f, +0.1768629f, -0.1226916f, -0.1000098f, +0.0152062f, +0.1111500f,
  -0.3837996f, -0.2478137f, -0.5892103f, +0.3891318f, -0.6329579f, +0.2458225f, +0.5761072f, -0.2161910f,
  +0.3114399f, -0.1937998f, -0.1186783f, +0.1848678f, -0.0080233f, +0.7204226f, +0.0942308f, -0.4729248f,
  -0.0264460f, +0.0370772f, +0.0835734f, +0.1063241f, +0.1136601f, +0.1347699f, +0.0911273f, -0.0120222f,
  +0.1366048f, +0.2491394f, +0.1811471f, -0.1658632f, +0.1980183f, +0.0918543f, -0.1524822f, -0.0404321f,
  -0.0819038f, -0.1557943f, +0.1762871f, -0.2394615f, +0.1318761f, -0.1252454f, -0.0118233f, -0.0103757f
);

const float biases[4] = float[4](
  +0.0273920f, -0.0950271f, +0.0273233f, -0.0090841f
);

vec4 hook() {
    const vec4 r[9][2] = vec4[9][2](
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 1.0f)))
    );

    float sum[4] = biases;
    for (int n = 0; n < 4; n++) {
        for (int i = 0; i < 9; i++) {
            const vec4 k0 = vec4(kernels[n * 8 * 9 + 8 * i + 0], kernels[n * 8 * 9 + 8 * i + 1], kernels[n * 8 * 9 + 8 * i + 2], kernels[n * 8 * 9 + 8 * i + 3]);
            const vec4 k1 = vec4(kernels[n * 8 * 9 + 8 * i + 4], kernels[n * 8 * 9 + 8 * i + 5], kernels[n * 8 * 9 + 8 * i + 6], kernels[n * 8 * 9 + 8 * i + 7]);
            sum[n] += (dot(k0, r[i][0]) + dot(k1, r[i][1]));
        }
    }

    return ACTIVE(vec4(sum[0], sum[1], sum[2], sum[3]));
}

//!HOOK LUMA
//!DESC ARNet b16 Layer20 L0
//!WHEN OUTPUT.w LUMA.w / 1.2 > OUTPUT.h LUMA.h / 1.2 > *
//!BIND TMP1_L0
//!BIND TMP1_L1
//!BIND TMP2_L0
//!SAVE TMP2_L0
//!COMPONENTS 4

#define ACTIVE(v) (v)

#define TEX_BIND_L0_TEXOFF TMP1_L0_texOff
#define TEX_BIND_L0_TEX TMP1_L0_tex
#define TEX_BIND_L0_POS TMP1_L0_pos
#define TEX_BIND_L0_SIZE TMP1_L0_size
#define TEX_BIND_L0_PT TMP1_L0_pt

#define TEX_BIND_L1_TEXOFF TMP1_L1_texOff
#define TEX_BIND_L1_TEX TMP1_L1_tex
#define TEX_BIND_L1_POS TMP1_L1_pos
#define TEX_BIND_L1_SIZE TMP1_L1_size
#define TEX_BIND_L1_PT TMP1_L1_pt

#define TEX_BIND_L2_TEXOFF TMP2_L0_texOff
#define TEX_BIND_L2_TEX TMP2_L0_tex
#define TEX_BIND_L2_POS TMP2_L0_pos
#define TEX_BIND_L2_SIZE TMP2_L0_size
#define TEX_BIND_L2_PT TMP2_L0_pt

const float kernels[288] = float[288](
  -0.1046349f, +0.1856549f, -0.1636776f, +0.0353685f, +0.1637464f, +0.3006366f, +0.2406880f, -0.1378554f,
  +0.1158417f, -0.0842090f, -0.1240867f, -0.0576840f, -0.1757576f, -0.0984228f, -0.0630077f, +0.1078875f,
  +0.0167943f, +0.2153919f, -0.1478753f, -0.6731171f, +0.0669253f, -0.1185694f, +0.1280656f, +0.0509779f,
  +0.1553904f, +0.0146783f, -0.0244471f, +0.0814399f, +0.1524912f, +0.1817447f, +0.0780707f, +0.0567834f,
  -0.5404736f, -0.1898809f, -0.2148979f, +0.3750347f, +0.4844975f, +0.2755990f, +0.3015207f, +0.0827487f,
  -0.3143616f, +0.0848902f, -0.2110487f, +0.0566520f, -0.2447320f, +0.2682008f, +0.0180894f, -0.0030995f,
  +0.0240113f, -0.0383267f, -0.0527336f, -0.0325262f, -0.2155073f, +0.3314466f, +0.1219955f, +0.4280372f,
  +0.1245729f, +0.2587080f, -0.1327334f, +0.2403292f, +0.1886990f, -0.1396620f, +0.0177519f, +0.0217960f,
  +0.1110185f, +0.2252350f, -0.1155930f, +0.4615363f, +0.0555937f, -0.1671721f, +0.1088503f, -0.0237262f,
  +0.2360731f, +0.2524194f, +0.0406096f, +0.1611350f, +0.1169746f, -0.1631624f, -0.0418735f, -0.1080714f,
  -0.2187832f, +0.2040482f, +0.1275706f, +0.4299431f, +0.0987189f, +0.7161763f, -0.0539880f, +0.0261707f,
  -0.1246059f, -0.2393914f, +0.0947332f, +0.6852790f, +0.1519335f, +0.3001198f, +0.1507722f, +0.0232889f,
  -0.6883951f, +0.4712721f, -0.2598712f, +0.1376562f, -0.0900271f, +0.1892084f, +0.1733535f, -0.4093411f,
  -0.4301974f, +0.2647908f, +0.3807869f, +0.0454590f, +0.2510250f, +0.1925350f, -0.1843982f, +0.1473656f,
  -0.0971581f, -0.0033087f, -0.0393060f, +0.1833749f, +0.1052514f, -0.0616378f, -0.2929408f, -0.2596718f,
  -0.1495577f, +0.2721161f, -0.1073112f, -0.0111044f, -0.4201730f, +0.2897907f, +0.2539648f, +0.0026922f,
  -0.1791238f, +0.4387789f, -0.2512049f, +0.1316727f, -0.2419553f, +0.1848496f, -0.2125236f, -0.1441820f,
  -0.0712915f, +0.0427007f, +0.0893496f, -0.0743608f, +0.1789607f, +0.0443967f, -0.0298167f, +0.0150671f,
  -0.4534016f, -0.2110289f, +0.1993505f, +0.0625112f, +0.2787235f, -0.1940894f, -0.1692767f, -0.1933177f,
  -0.7145767f, -0.1169939f, +0.0100542f, +0.4747776f, -0.4811149f, +0.5752454f, -0.1644180f, +0.2336722f,
  -0.0416032f, -0.2473631f, -0.0899472f, -0.0399061f, +0.1057562f, +0.0115103f, +0.2127673f, -0.0498203f,
  +0.0097209f, -0.4973682f, +0.1742593f, +0.0010123f, +0.4089743f, -0.1656404f, -0.0750594f, +0.2582431f,
  -0.3439984f, -0.8404784f, -0.2406666f, +0.1400337f, +0.0555001f, +0.8934265f, +0.6319553f, +0.8737497f,
  -0.1385255f, +0.1067752f, -0.0430659f, +0.0865149f, +0.0433572f, +0.2977962f, +0.0073536f, -0.1075890f,
  -0.0971270f, -0.1014274f, +0.0455765f, +0.0680516f, +0.2220179f, -0.0519421f, -0.0287675f, +0.2472447f,
  -0.0923946f, +0.0110827f, +0.1503449f, +0.1094671f, +0.2541721f, +0.4206491f, +0.1734590f, -0.0277912f,
  +0.0222106f, +0.0557673f, +0.0533724f, +0.0130622f, +0.0798553f, +0.0665525f, -0.0158871f, +0.0770953f,
  -0.1117048f, -0.2693433f, -0.0301056f, -0.0929718f, +0.0799553f, -0.1582821f, +0.2058695f, +0.2075626f,
  -0.2821509f, +0.1170293f, -0.1959876f, +0.3304806f, +0.0971707f, +0.7042668f, +0.1694144f, +0.0762033f,
  +0.2683390f, +0.2597667f, -0.1663820f, -0.3814215f, +0.0369946f, -0.3029884f, -0.3383069f, +0.0140723f,
  -0.1759725f, +0.4380546f, -0.0997036f, -0.0184088f, +0.3201932f, -0.4028816f, -0.1800921f, +0.8754780f,
  +0.4445677f, -0.5461285f, +0.1246675f, -0.2300546f, +0.1372302f, -0.8556846f, -1.0535576f, +0.2765440f,
  -0.1414056f, +0.3555636f, -0.0819879f, -0.5084773f, -0.2569482f, -0.0829374f, +0.0317996f, -0.0465856f,
  +0.0234038f, +0.1633094f, -0.0691780f, +0.1513364f, -0.0527343f, -0.0830985f, +0.2106421f, +0.1512252f,
  -0.0842337f, +0.2115409f, -0.2644731f, +0.0625714f, +0.1198810f, -0.0750071f, -0.0998207f, +0.5462752f,
  -0.0101601f, +0.0677821f, -0.0727113f, -0.1675961f, +0.0665368f, -0.1889740f, -0.1702525f, +0.0509646f
);

const float biases[4] = float[4](
  +0.0935091f, +0.0751676f, +0.0068989f, +0.1919623f
);

vec4 hook() {
    const vec4 r[9][2] = vec4[9][2](
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 1.0f)))
    );

    float sum[4] = biases;
    for (int n = 0; n < 4; n++) {
        for (int i = 0; i < 9; i++) {
            const vec4 k0 = vec4(kernels[n * 8 * 9 + 8 * i + 0], kernels[n * 8 * 9 + 8 * i + 1], kernels[n * 8 * 9 + 8 * i + 2], kernels[n * 8 * 9 + 8 * i + 3]);
            const vec4 k1 = vec4(kernels[n * 8 * 9 + 8 * i + 4], kernels[n * 8 * 9 + 8 * i + 5], kernels[n * 8 * 9 + 8 * i + 6], kernels[n * 8 * 9 + 8 * i + 7]);
            sum[n] += (dot(k0, r[i][0]) + dot(k1, r[i][1]));
        }
    }

    return ACTIVE(vec4(sum[0], sum[1], sum[2], sum[3]) * 0.2000000f + TEX_BIND_L2_TEXOFF(vec2(0.0f, 0.0f)));
}

//!HOOK LUMA
//!DESC ARNet b16 Layer20 L1
//!WHEN OUTPUT.w LUMA.w / 1.2 > OUTPUT.h LUMA.h / 1.2 > *
//!BIND TMP1_L0
//!BIND TMP1_L1
//!BIND TMP2_L1
//!SAVE TMP2_L1
//!COMPONENTS 4

#define ACTIVE(v) (v)

#define TEX_BIND_L0_TEXOFF TMP1_L0_texOff
#define TEX_BIND_L0_TEX TMP1_L0_tex
#define TEX_BIND_L0_POS TMP1_L0_pos
#define TEX_BIND_L0_SIZE TMP1_L0_size
#define TEX_BIND_L0_PT TMP1_L0_pt

#define TEX_BIND_L1_TEXOFF TMP1_L1_texOff
#define TEX_BIND_L1_TEX TMP1_L1_tex
#define TEX_BIND_L1_POS TMP1_L1_pos
#define TEX_BIND_L1_SIZE TMP1_L1_size
#define TEX_BIND_L1_PT TMP1_L1_pt

#define TEX_BIND_L2_TEXOFF TMP2_L1_texOff
#define TEX_BIND_L2_TEX TMP2_L1_tex
#define TEX_BIND_L2_POS TMP2_L1_pos
#define TEX_BIND_L2_SIZE TMP2_L1_size
#define TEX_BIND_L2_PT TMP2_L1_pt

const float kernels[288] = float[288](
  -0.2632464f, +0.0304638f, +0.1334917f, -0.0813478f, +0.2699610f, -0.0757656f, -0.0892963f, -0.0336699f,
  -0.2748802f, +0.1207983f, +0.3712114f, +0.2452004f, +0.1041376f, -0.3555570f, +0.0392520f, +0.0420290f,
  +0.0858573f, -0.2378456f, +0.1014365f, +0.3211914f, -0.0777963f, +0.3859039f, +0.1624445f, -0.1008220f,
  -0.1143923f, +0.3491447f, +0.0493951f, -0.2180146f, -0.5271266f, +0.3378662f, +0.1920175f, -0.0361628f,
  -0.0821456f, +0.2704486f, +0.5611385f, +0.1838810f, -0.1722856f, +0.1145197f, -0.0249701f, -0.6158731f,
  +0.0505193f, -0.3468370f, +0.0645854f, -0.0018309f, +0.3496165f, +0.4727021f, +0.1979841f, +0.1945895f,
  +0.1396875f, +0.0220013f, +0.0771010f, -0.1505629f, -0.3104192f, +0.1751876f, -0.0315487f, +0.0711182f,
  -0.0673335f, -0.3857398f, +0.1698236f, -0.0173606f, -0.1028595f, -0.1869496f, +0.1870694f, -0.0899536f,
  +0.0342487f, -0.0450984f, -0.0939990f, +0.2193305f, +0.0862375f, +0.0989247f, +0.0652299f, -0.0836084f,
  +0.1436018f, +0.0630124f, -0.0098769f, -0.0580329f, -0.3540514f, +0.1023445f, +0.0352041f, +0.1219901f,
  +0.4869961f, +0.0548284f, -0.0147545f, -0.3473619f, +0.1005506f, -0.3088651f, +0.3419488f, -0.1683814f,
  +0.1298245f, +0.0043270f, +0.0590755f, +0.0011834f, -0.0734489f, +0.0005260f, +0.0070373f, -0.1206706f,
  +0.1669349f, -0.2943889f, -0.2595760f, -0.0428223f, -0.0002969f, -0.2708648f, +0.1440019f, -0.6821796f,
  +0.2167109f, +0.4313904f, -0.1881057f, +0.3617882f, -0.0061964f, -0.0819915f, -0.2808090f, -0.6034676f,
  -0.2228839f, -0.0707957f, -0.1322883f, +0.0607480f, -0.3238958f, +0.0852919f, -0.0892123f, -0.1391607f,
  +0.0301174f, +0.1311888f, +0.1369415f, -0.0983627f, -0.3502528f, +0.2238279f, +0.0138409f, +0.4174641f,
  -0.0313938f, +0.3519384f, -0.0047701f, -0.0305014f, +0.2465164f, -0.1861718f, -0.1529747f, -0.2091662f,
  +0.0239173f, -0.0086810f, +0.0898373f, +0.3580988f, +0.0838811f, -0.0365539f, -0.0694686f, +0.0501646f,
  +0.0146384f, +0.1103976f, +0.1369946f, +0.0830633f, -0.3784575f, +0.0626305f, -0.0839405f, -0.2052083f,
  +0.5948368f, +0.3145445f, -0.1464369f, -0.0169915f, -0.1370365f, -0.0822818f, +0.4814298f, -0.1003817f,
  +0.0213899f, +0.0903439f, -0.4032896f, +0.2511947f, -0.3277087f, -0.2638636f, -0.2417565f, -0.1763255f,
  -0.3380749f, -0.6104615f, +0.0664582f, -0.0033729f, +0.0682613f, +0.2217422f, -0.0009166f, -0.2705681f,
  +0.0072376f, +0.0667348f, -0.1347512f, -0.0487237f, +0.1101658f, +0.0122261f, -0.7104580f, -0.1824886f,
  -0.0748205f, +0.2532228f, -0.0463901f, +0.4144610f, -0.1027107f, -0.4641577f, +0.0143313f, +0.0583685f,
  +0.0719667f, -0.0300080f, +0.0405930f, +0.0369817f, +0.1537380f, +0.1143315f, -0.0530413f, +0.2732446f,
  +0.2373156f, +0.0136128f, -0.0613625f, +0.2565123f, +0.3722105f, -0.0585579f, -0.1462122f, -0.1204016f,
  +0.1125567f, +0.1074895f, +0.0477007f, +0.1401143f, -0.0354439f, -0.1594501f, +0.1383198f, -0.0838341f,
  +0.0079522f, +0.1348506f, -0.0534093f, +0.0590805f, +0.2186359f, +0.1988567f, +0.0960998f, +0.1536712f,
  -0.0544891f, -0.2080266f, +0.1833079f, -0.1634551f, +0.0845224f, -0.0960840f, -0.3267414f, +0.2042683f,
  +0.2796741f, +0.1033648f, -0.1247833f, -0.3217014f, +0.0633601f, +0.0886018f, +0.1625150f, +0.0395764f,
  +0.1257201f, +0.0882517f, +0.1173052f, -0.0165758f, +0.0805738f, +0.2259661f, +0.0890271f, +0.4440877f,
  -0.1647227f, -0.1822148f, +0.3612994f, -0.2112778f, -0.0496633f, -0.0303690f, -0.0712128f, -0.1977592f,
  +0.1279013f, -0.1028925f, +0.1470990f, -0.0596426f, +0.0633157f, -0.0092754f, +0.0527836f, +0.0177755f,
  -0.0657149f, +0.0058448f, -0.0265881f, -0.0168585f, +0.0276649f, +0.0022351f, +0.1095666f, +0.1386275f,
  +0.0575926f, -0.1324382f, -0.1732018f, +0.0907954f, -0.2911125f, -0.1387732f, -0.0802228f, +0.2068865f,
  -0.0071881f, +0.0580037f, -0.0882367f, -0.1414603f, -0.0167019f, +0.0038791f, +0.0038581f, -0.1074287f
);

const float biases[4] = float[4](
  -0.0573395f, -0.0040646f, -0.0508315f, -0.0450080f
);

vec4 hook() {
    const vec4 r[9][2] = vec4[9][2](
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 1.0f)))
    );

    float sum[4] = biases;
    for (int n = 0; n < 4; n++) {
        for (int i = 0; i < 9; i++) {
            const vec4 k0 = vec4(kernels[n * 8 * 9 + 8 * i + 0], kernels[n * 8 * 9 + 8 * i + 1], kernels[n * 8 * 9 + 8 * i + 2], kernels[n * 8 * 9 + 8 * i + 3]);
            const vec4 k1 = vec4(kernels[n * 8 * 9 + 8 * i + 4], kernels[n * 8 * 9 + 8 * i + 5], kernels[n * 8 * 9 + 8 * i + 6], kernels[n * 8 * 9 + 8 * i + 7]);
            sum[n] += (dot(k0, r[i][0]) + dot(k1, r[i][1]));
        }
    }

    return ACTIVE(vec4(sum[0], sum[1], sum[2], sum[3]) * 0.2000000f + TEX_BIND_L2_TEXOFF(vec2(0.0f, 0.0f)));
}

//!HOOK LUMA
//!DESC ARNet b16 Layer21 L0
//!WHEN OUTPUT.w LUMA.w / 1.2 > OUTPUT.h LUMA.h / 1.2 > *
//!BIND TMP2_L0
//!BIND TMP2_L1
//!SAVE TMP1_L0
//!COMPONENTS 4

#define ACTIVE(v) (max(v, v * 0.2000000f))

#define TEX_BIND_L0_TEXOFF TMP2_L0_texOff
#define TEX_BIND_L0_TEX TMP2_L0_tex
#define TEX_BIND_L0_POS TMP2_L0_pos
#define TEX_BIND_L0_SIZE TMP2_L0_size
#define TEX_BIND_L0_PT TMP2_L0_pt

#define TEX_BIND_L1_TEXOFF TMP2_L1_texOff
#define TEX_BIND_L1_TEX TMP2_L1_tex
#define TEX_BIND_L1_POS TMP2_L1_pos
#define TEX_BIND_L1_SIZE TMP2_L1_size
#define TEX_BIND_L1_PT TMP2_L1_pt

const float kernels[288] = float[288](
  -0.0383239f, -0.1313397f, -0.1287142f, -0.0204291f, -0.0236602f, +0.0131839f, +0.1731583f, -0.0136533f,
  +0.1038277f, -0.1658991f, +0.1909469f, -0.1331503f, +0.1129254f, +0.1636358f, -0.2193670f, -0.1139204f,
  +0.4566831f, +0.5232214f, +0.1426369f, +0.1257444f, -0.1084347f, +0.1359221f, +0.0198270f, +0.1343876f,
  +0.0138617f, -0.1138247f, -0.1485888f, -0.1442083f, +0.0944634f, +0.0340248f, +0.2713245f, +0.0742954f,
  -0.5213830f, -0.0407112f, +0.2412100f, +0.2581534f, -0.0933155f, -0.0233921f, -0.3446375f, -0.5945354f,
  +0.0126318f, +0.6292686f, -0.7199094f, -0.2474112f, +0.7255599f, -0.2629177f, +0.4169588f, -0.3893131f,
  -0.3056130f, -0.0394097f, -0.1348936f, -0.0592756f, +0.3034785f, +0.1205344f, +0.1105034f, +0.0761565f,
  -0.2797897f, -0.3381522f, -0.0083314f, +0.3066359f, +0.0295322f, +0.0537007f, +0.4777626f, -0.2189033f,
  +0.1612443f, +0.2844814f, -0.1229876f, -0.3169136f, -0.0324629f, -0.4016842f, -0.1428380f, -0.2919303f,
  -0.0142377f, -0.1113265f, -0.0147803f, +0.1082401f, +0.1012594f, -0.2186997f, +0.0352692f, +0.2641594f,
  +0.4068564f, +0.0100366f, -0.1605856f, -0.3822511f, +0.1318841f, -0.2582348f, -0.1232160f, -0.0731332f,
  -0.0963758f, +0.1516836f, +0.0678629f, +0.0799996f, -0.1944269f, +0.0578987f, +0.0788279f, +0.0766625f,
  +0.1331017f, -0.3798394f, -0.2163957f, +0.2959321f, -0.0602472f, +0.0983839f, +0.1011291f, -0.0953301f,
  -0.0649555f, -0.1311050f, +0.1234315f, -0.1737058f, +0.0485064f, -0.1158390f, -0.0958397f, +0.1175588f,
  -0.1937763f, -0.2054999f, -0.0769509f, -0.0513177f, +0.2226139f, -0.1841553f, +0.2253194f, -0.0818491f,
  -0.1710504f, +0.2836310f, -0.0660547f, -0.1160537f, +0.0791347f, -0.1770789f, -0.2762828f, +0.1715405f,
  -0.4594502f, +0.3838770f, -0.2599471f, -0.1969070f, +0.2552712f, +0.0926401f, +0.3212557f, +0.1632947f,
  -0.1907553f, +0.0640737f, +0.1910786f, -0.1249775f, +0.1251496f, +0.0131187f, +0.1370664f, +0.0453427f,
  -0.1382418f, +0.2054932f, +0.2879913f, -0.3813649f, -0.2441207f, +0.0987321f, -0.1912081f, -0.3280602f,
  +0.7360573f, -0.0588562f, -0.0630224f, +0.1000036f, -0.4425301f, -0.1659414f, +0.0483447f, +0.5976242f,
  +0.1618310f, +0.1354074f, +0.0175124f, +0.2530340f, +0.0995960f, +0.2079253f, -0.0394433f, +0.0276368f,
  -0.1553514f, +0.3155743f, -0.0235267f, +0.1020423f, -0.9229571f, +0.3452051f, +0.5760760f, -0.0519177f,
  +0.5310781f, -0.2883634f, -0.2032432f, +0.0846974f, +0.8247388f, +0.1280926f, -0.0285167f, -0.0540234f,
  +0.2812085f, +0.2663519f, -0.0603819f, +0.0851495f, -0.0755961f, -0.3471287f, +0.0359732f, +0.0043121f,
  -0.4061337f, -0.3740714f, -0.2193383f, +0.4360679f, +0.1324337f, +0.2848885f, +0.5109103f, +0.1249971f,
  -0.0340694f, +0.4354509f, -0.4112587f, -0.6783483f, -0.3579998f, +0.0466844f, -0.8684053f, -0.2533571f,
  +0.2848852f, -0.0598645f, +0.1500287f, +0.1550931f, -0.2662680f, -0.2316647f, +0.4291988f, +0.0800707f,
  +0.1852500f, -0.0146401f, -0.0040727f, -0.0211541f, +0.1100029f, -0.0051770f, +0.1301699f, -0.0267078f,
  +0.2086794f, +0.1872408f, -0.0152791f, -0.0210917f, -0.2830329f, +0.1731861f, -0.0199410f, +0.3541025f,
  +0.1485128f, +0.3757879f, +0.2503932f, +0.2477262f, +0.4160494f, +0.0681544f, -0.0448478f, -0.3177004f,
  +0.4861607f, +0.0722061f, -0.1652220f, -0.1835180f, +0.6235918f, -0.0907446f, -0.1713531f, +0.2694719f,
  -0.3791885f, +0.0206355f, -0.2979977f, -0.1501192f, -1.4371462f, +0.3481880f, +0.5402347f, -0.4732805f,
  +0.2489145f, +0.2790966f, +0.0929012f, +0.0899282f, +0.9664590f, -0.6351431f, +0.6398217f, -0.1038339f,
  -0.0195103f, +0.2050250f, +0.1436360f, -0.2023105f, +0.3745914f, +0.1504194f, -0.0265191f, +0.0342194f,
  +0.0761500f, -0.1277402f, -0.1378763f, +0.2956328f, -0.2147305f, +0.1368558f, +0.0339459f, +0.0600830f,
  -0.1650721f, +0.4838368f, +0.5506380f, -0.1097672f, +0.6247411f, -0.2952959f, +0.6753339f, -0.2041670f
);

const float biases[4] = float[4](
  -0.0109276f, +0.0666369f, -0.0984017f, -0.0756965f
);

vec4 hook() {
    const vec4 r[9][2] = vec4[9][2](
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 1.0f)))
    );

    float sum[4] = biases;
    for (int n = 0; n < 4; n++) {
        for (int i = 0; i < 9; i++) {
            const vec4 k0 = vec4(kernels[n * 8 * 9 + 8 * i + 0], kernels[n * 8 * 9 + 8 * i + 1], kernels[n * 8 * 9 + 8 * i + 2], kernels[n * 8 * 9 + 8 * i + 3]);
            const vec4 k1 = vec4(kernels[n * 8 * 9 + 8 * i + 4], kernels[n * 8 * 9 + 8 * i + 5], kernels[n * 8 * 9 + 8 * i + 6], kernels[n * 8 * 9 + 8 * i + 7]);
            sum[n] += (dot(k0, r[i][0]) + dot(k1, r[i][1]));
        }
    }

    return ACTIVE(vec4(sum[0], sum[1], sum[2], sum[3]));
}

//!HOOK LUMA
//!DESC ARNet b16 Layer21 L1
//!WHEN OUTPUT.w LUMA.w / 1.2 > OUTPUT.h LUMA.h / 1.2 > *
//!BIND TMP2_L0
//!BIND TMP2_L1
//!SAVE TMP1_L1
//!COMPONENTS 4

#define ACTIVE(v) (max(v, v * 0.2000000f))

#define TEX_BIND_L0_TEXOFF TMP2_L0_texOff
#define TEX_BIND_L0_TEX TMP2_L0_tex
#define TEX_BIND_L0_POS TMP2_L0_pos
#define TEX_BIND_L0_SIZE TMP2_L0_size
#define TEX_BIND_L0_PT TMP2_L0_pt

#define TEX_BIND_L1_TEXOFF TMP2_L1_texOff
#define TEX_BIND_L1_TEX TMP2_L1_tex
#define TEX_BIND_L1_POS TMP2_L1_pos
#define TEX_BIND_L1_SIZE TMP2_L1_size
#define TEX_BIND_L1_PT TMP2_L1_pt

const float kernels[288] = float[288](
  -0.0353499f, +0.1304787f, +0.0137794f, -0.0359721f, +0.2604667f, +0.0277827f, +0.0225127f, -0.0726942f,
  +0.0266513f, +0.4327841f, -0.0464752f, -0.1103458f, -0.0451773f, +0.3926223f, -0.0175591f, +0.0351341f,
  +0.4658204f, +0.0924117f, +0.0678270f, +0.2621250f, +0.0510010f, -0.4674443f, -0.0205255f, +0.2337919f,
  +0.1950605f, +0.0254141f, -0.0624443f, -0.2877023f, +0.1904082f, +0.0630786f, -0.1558519f, +0.0748551f,
  -0.6095737f, +0.3091272f, -0.2648087f, +0.3823804f, -0.5090066f, +0.4384078f, +0.5585588f, -0.4026556f,
  +0.6343134f, +0.1681686f, +0.2888551f, -0.4762327f, -0.4215562f, -0.6899436f, +0.7251965f, +0.1509321f,
  +0.0464215f, +0.2194727f, -0.1374561f, +0.0841124f, +0.2380436f, +0.0622058f, -0.0417581f, +0.2423059f,
  -0.2999673f, +0.2152749f, +0.0620232f, -0.0474874f, +0.2455373f, +0.3343610f, +0.0236257f, -0.3275447f,
  +0.5391356f, -0.4200644f, +0.2151046f, +0.0421407f, -0.0187661f, -0.1548591f, -0.1825330f, +0.0734014f,
  +0.0007257f, -0.0384314f, -0.1479349f, -0.1945028f, -0.1313833f, +0.0422023f, -0.2155127f, +0.1380036f,
  +0.2442897f, +0.0067186f, -0.2036332f, +0.2113194f, +0.0441950f, +0.3435796f, -0.1309205f, -0.0685650f,
  +0.0707047f, +0.0952752f, +0.0102354f, +0.1900077f, +0.1664712f, -0.1296010f, +0.2119456f, +0.0190122f,
  -0.4827698f, -0.0804247f, +0.1641679f, +0.3412434f, -0.1302993f, -0.0821908f, +0.3035724f, -0.4636672f,
  -0.2090786f, +0.0647349f, +0.5054377f, +0.3400063f, +0.3358969f, -0.2833188f, +0.7782485f, -0.3228469f,
  -0.4076518f, -0.3306623f, +0.2251872f, -0.0974207f, +0.0818537f, -0.2134734f, +0.5459502f, -0.0602280f,
  +0.0481172f, +0.0175975f, +0.0715224f, +0.2371643f, +0.2386729f, -0.0125274f, +0.0268508f, +0.0932774f,
  -0.7020228f, +0.3653885f, +0.5616257f, -0.0994988f, +1.0097754f, -0.0304073f, +0.4869272f, -0.2334557f,
  -0.1731229f, +0.1540159f, +0.0744283f, +0.0730481f, +0.4016039f, -0.1073671f, +0.0998878f, -0.1499573f,
  -0.0165489f, -0.0930969f, -0.0374636f, -0.0361176f, +0.0248245f, -0.0300335f, +0.0858257f, +0.0030895f,
  +0.0798856f, -0.0746304f, +0.2144455f, +0.0244465f, +0.0169261f, -0.1001044f, -0.2119314f, +0.0899001f,
  +0.6060769f, +0.4770524f, +0.1768090f, +0.1311419f, -0.0051059f, +0.4529109f, -0.0621630f, +0.0384743f,
  -0.2122377f, -0.0013599f, -0.1599783f, -0.0886625f, -0.0112553f, -0.0766349f, +0.2064638f, +0.0540824f,
  -0.0547777f, -0.1499939f, +0.5480232f, -0.0524013f, -0.3195144f, -0.2537228f, -0.6684129f, -0.5476887f,
  +0.4190617f, +0.4873197f, -0.7556491f, -0.2099254f, +0.6508810f, -0.5621070f, +0.1554719f, -0.2910609f,
  -0.2713605f, -0.0021331f, +0.0148714f, -0.1121432f, +0.2732676f, +0.1069457f, -0.0724906f, +0.0282926f,
  -0.2226687f, -0.5962418f, +0.2606393f, +0.4748838f, +0.0213280f, -0.1096746f, +0.3312532f, -0.2388237f,
  +0.3041548f, +0.2633247f, -0.2021236f, -0.2135061f, -0.1335881f, -0.3105510f, -0.3805303f, -0.0593400f,
  -0.0733580f, +0.0348189f, +0.0591089f, +0.0906853f, +0.2119412f, -0.0161628f, -0.2029998f, +0.2685329f,
  -0.1423243f, -0.2151471f, -0.4612171f, -0.1325118f, +0.7001098f, +0.2123924f, -0.3319667f, -0.2542381f,
  -0.1083454f, -0.2209300f, -0.0722650f, -0.1617250f, -0.2300241f, -0.2193832f, -0.0140843f, +0.0908327f,
  +0.0840370f, -0.0935256f, +0.0086553f, -0.1172489f, -0.5062255f, -0.1690149f, -0.0513557f, -0.2419598f,
  +0.1669049f, +0.4226502f, +0.3355846f, -0.0055857f, +1.0796832f, -0.1165675f, +0.0508856f, +0.4647445f,
  -0.2293081f, -0.0380091f, -0.0275870f, +0.0608276f, -0.1985909f, +0.1346440f, -0.0357287f, +0.2927588f,
  +0.1736707f, -0.1417854f, -0.0116824f, +0.0919412f, -0.0183001f, -0.1783884f, -0.1341437f, +0.0778975f,
  +0.0409849f, -0.0050884f, +0.2922898f, +0.1123625f, +0.2052489f, -0.2987669f, +0.0442682f, -0.0528530f,
  -0.0025867f, +0.0415697f, -0.3060136f, +0.0124651f, -0.0623219f, -0.0801915f, -0.1969056f, +0.0052357f
);

const float biases[4] = float[4](
  -0.0877731f, +0.0128796f, +0.0160173f, +0.0907498f
);

vec4 hook() {
    const vec4 r[9][2] = vec4[9][2](
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 1.0f)))
    );

    float sum[4] = biases;
    for (int n = 0; n < 4; n++) {
        for (int i = 0; i < 9; i++) {
            const vec4 k0 = vec4(kernels[n * 8 * 9 + 8 * i + 0], kernels[n * 8 * 9 + 8 * i + 1], kernels[n * 8 * 9 + 8 * i + 2], kernels[n * 8 * 9 + 8 * i + 3]);
            const vec4 k1 = vec4(kernels[n * 8 * 9 + 8 * i + 4], kernels[n * 8 * 9 + 8 * i + 5], kernels[n * 8 * 9 + 8 * i + 6], kernels[n * 8 * 9 + 8 * i + 7]);
            sum[n] += (dot(k0, r[i][0]) + dot(k1, r[i][1]));
        }
    }

    return ACTIVE(vec4(sum[0], sum[1], sum[2], sum[3]));
}

//!HOOK LUMA
//!DESC ARNet b16 Layer22 L0
//!WHEN OUTPUT.w LUMA.w / 1.2 > OUTPUT.h LUMA.h / 1.2 > *
//!BIND TMP1_L0
//!BIND TMP1_L1
//!BIND TMP2_L0
//!SAVE TMP2_L0
//!COMPONENTS 4

#define ACTIVE(v) (v)

#define TEX_BIND_L0_TEXOFF TMP1_L0_texOff
#define TEX_BIND_L0_TEX TMP1_L0_tex
#define TEX_BIND_L0_POS TMP1_L0_pos
#define TEX_BIND_L0_SIZE TMP1_L0_size
#define TEX_BIND_L0_PT TMP1_L0_pt

#define TEX_BIND_L1_TEXOFF TMP1_L1_texOff
#define TEX_BIND_L1_TEX TMP1_L1_tex
#define TEX_BIND_L1_POS TMP1_L1_pos
#define TEX_BIND_L1_SIZE TMP1_L1_size
#define TEX_BIND_L1_PT TMP1_L1_pt

#define TEX_BIND_L2_TEXOFF TMP2_L0_texOff
#define TEX_BIND_L2_TEX TMP2_L0_tex
#define TEX_BIND_L2_POS TMP2_L0_pos
#define TEX_BIND_L2_SIZE TMP2_L0_size
#define TEX_BIND_L2_PT TMP2_L0_pt

const float kernels[288] = float[288](
  -0.0732968f, +0.2147385f, +0.0560237f, +0.0355876f, -0.0269264f, -0.1799303f, +0.2106058f, -0.0220851f,
  -0.1043469f, +0.1159458f, +0.0566046f, +0.0379702f, -0.1851217f, -0.2914039f, +0.1732756f, -0.0500973f,
  -0.0401709f, +0.0821659f, +0.2443788f, -0.1354152f, -0.0006047f, -0.2029774f, +0.0750844f, -0.1069145f,
  -0.1879267f, -0.0058898f, -0.0951403f, -0.0713315f, -0.0512500f, -0.0218681f, +0.3088492f, -0.0508714f,
  +0.7837965f, +0.0016159f, -0.5371530f, +0.6998085f, +0.2367672f, +0.0460212f, -0.4793805f, -0.1218159f,
  -0.0106614f, -0.1555929f, +0.3953733f, -0.0354666f, -0.1199374f, +0.3890065f, +0.0221213f, -0.2766967f,
  -0.0133746f, +0.1069181f, -0.1867659f, -0.2415846f, -0.5544275f, -0.0570157f, +0.0842194f, -0.3024712f,
  -0.1579921f, -0.0106670f, +0.0202766f, -0.0981029f, -0.3422008f, +0.0972596f, +0.2036941f, +0.1740120f,
  -0.0133356f, +0.2843028f, -0.1148855f, -0.0417771f, +0.1088640f, -0.4103177f, +0.0972987f, +0.0065044f,
  -0.0646053f, -0.0672943f, +0.0677714f, +0.1047149f, -0.0966439f, -0.1609764f, -0.1132962f, -0.0271663f,
  -0.0269981f, -0.4115198f, -0.2952331f, -0.2394568f, +0.0038147f, -0.3422396f, +0.0656367f, +0.0560654f,
  +0.2133872f, -0.2089336f, -0.2891260f, +0.1073605f, -0.1906341f, +0.1472564f, -0.1071556f, -0.0183662f,
  -0.2401971f, +0.2163996f, -0.1881037f, -0.0320017f, -0.6189849f, +0.3288233f, +0.2702752f, -0.4220400f,
  -0.2265095f, +0.3525458f, -0.7047461f, -0.5337367f, -0.4523250f, +0.0522222f, +0.3734079f, -0.2617885f,
  -0.0326539f, +0.2029938f, +0.2081193f, -0.1223298f, +0.0881722f, +0.3207637f, +0.0275482f, +0.3266204f,
  -0.0409552f, -0.0944255f, -0.1816171f, -0.1087174f, -0.4047562f, +0.1492590f, +0.0431040f, -0.1409939f,
  -0.3410452f, +0.2126068f, -0.2799912f, -0.2030268f, -0.6388139f, -0.3091833f, +0.3042959f, -0.2401481f,
  +0.0909966f, +0.1777094f, -0.0301319f, -0.0989034f, -0.3468718f, +0.2618552f, -0.0226339f, -0.2232828f,
  -0.0462030f, -0.2049258f, -0.0028381f, -0.1151611f, +0.3920432f, +0.0551668f, +0.2757723f, +0.1562475f,
  +0.2193973f, +0.0373741f, -0.3798040f, +0.2654874f, -0.1387208f, -0.3183926f, -0.4344940f, -0.0604819f,
  -0.2611344f, +0.2497990f, +0.0227778f, -0.2000988f, -0.0202835f, +0.1908754f, +0.1883877f, -0.1415268f,
  -0.5704973f, -0.0919979f, -0.3105465f, -0.6544526f, +0.5259128f, -0.1812627f, +0.6719091f, -0.2887733f,
  +0.8243510f, -0.2216805f, -0.2528889f, +0.8665609f, +0.2734184f, -0.5882258f, -0.9665349f, -0.0019496f,
  -0.1820664f, +0.2142670f, +1.2573975f, +0.1658743f, -0.1992255f, +0.4025505f, +0.0404925f, +0.1022679f,
  +0.1461615f, -0.1640042f, -0.0550196f, -0.2662451f, -0.2144451f, +0.0301698f, -0.0760283f, -0.2406561f,
  +0.0130966f, -0.0251772f, -0.0576113f, -0.0590530f, -0.0946703f, +0.2358789f, -0.1003132f, +0.0694671f,
  -0.1283461f, +0.0664038f, +0.3487854f, -0.1513593f, -0.0143953f, +0.1228791f, +0.0815136f, -0.0417087f,
  -0.1126961f, +0.2296977f, +0.0574970f, +0.0779246f, +0.8429710f, -0.2036694f, -0.0879487f, +0.0792677f,
  +0.2179911f, +0.2130169f, +0.1203159f, +0.4830475f, -0.0466541f, -0.5254712f, -0.4142453f, +0.0138238f,
  -0.3973635f, +0.0733088f, +0.3943390f, -0.2719331f, +0.4197142f, -0.0916209f, +0.2663595f, +0.1461476f,
  -0.1585539f, +0.0954450f, +0.2024625f, +0.1694245f, -0.3585542f, +0.2173143f, +0.2361586f, -0.0296349f,
  +0.5755743f, +0.5231999f, +0.2240925f, -0.5744431f, -0.6208782f, +0.8411189f, +0.0026267f, -0.2793212f,
  -0.0835721f, -0.1282859f, -0.2358999f, +0.1197537f, -0.3098131f, +0.3698959f, +0.1137566f, +0.0224171f,
  +0.0662479f, +0.1019459f, -0.0677743f, +0.2957878f, -0.3040289f, -0.1643533f, -0.2876729f, +0.1154292f,
  +0.3992434f, +0.3371199f, -0.2326280f, +0.0109310f, -0.2802930f, -0.8603535f, -0.3560439f, -0.0312062f,
  -0.1338458f, -0.4744390f, +0.4843197f, -0.0665258f, +0.3047708f, +0.0973017f, +0.0696255f, -0.0385111f
);

const float biases[4] = float[4](
  +0.0603027f, +0.0499483f, +0.0209764f, +0.0741813f
);

vec4 hook() {
    const vec4 r[9][2] = vec4[9][2](
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 1.0f)))
    );

    float sum[4] = biases;
    for (int n = 0; n < 4; n++) {
        for (int i = 0; i < 9; i++) {
            const vec4 k0 = vec4(kernels[n * 8 * 9 + 8 * i + 0], kernels[n * 8 * 9 + 8 * i + 1], kernels[n * 8 * 9 + 8 * i + 2], kernels[n * 8 * 9 + 8 * i + 3]);
            const vec4 k1 = vec4(kernels[n * 8 * 9 + 8 * i + 4], kernels[n * 8 * 9 + 8 * i + 5], kernels[n * 8 * 9 + 8 * i + 6], kernels[n * 8 * 9 + 8 * i + 7]);
            sum[n] += (dot(k0, r[i][0]) + dot(k1, r[i][1]));
        }
    }

    return ACTIVE(vec4(sum[0], sum[1], sum[2], sum[3]) * 0.2000000f + TEX_BIND_L2_TEXOFF(vec2(0.0f, 0.0f)));
}

//!HOOK LUMA
//!DESC ARNet b16 Layer22 L1
//!WHEN OUTPUT.w LUMA.w / 1.2 > OUTPUT.h LUMA.h / 1.2 > *
//!BIND TMP1_L0
//!BIND TMP1_L1
//!BIND TMP2_L1
//!SAVE TMP2_L1
//!COMPONENTS 4

#define ACTIVE(v) (v)

#define TEX_BIND_L0_TEXOFF TMP1_L0_texOff
#define TEX_BIND_L0_TEX TMP1_L0_tex
#define TEX_BIND_L0_POS TMP1_L0_pos
#define TEX_BIND_L0_SIZE TMP1_L0_size
#define TEX_BIND_L0_PT TMP1_L0_pt

#define TEX_BIND_L1_TEXOFF TMP1_L1_texOff
#define TEX_BIND_L1_TEX TMP1_L1_tex
#define TEX_BIND_L1_POS TMP1_L1_pos
#define TEX_BIND_L1_SIZE TMP1_L1_size
#define TEX_BIND_L1_PT TMP1_L1_pt

#define TEX_BIND_L2_TEXOFF TMP2_L1_texOff
#define TEX_BIND_L2_TEX TMP2_L1_tex
#define TEX_BIND_L2_POS TMP2_L1_pos
#define TEX_BIND_L2_SIZE TMP2_L1_size
#define TEX_BIND_L2_PT TMP2_L1_pt

const float kernels[288] = float[288](
  -0.2359647f, -0.0091434f, +0.0265911f, -0.0727076f, -0.0476436f, -0.3167007f, +0.1465951f, -0.0606011f,
  +0.1232403f, -0.3407450f, +0.4967883f, +0.1990528f, +0.2945337f, -0.5042517f, -0.0604989f, -0.1030461f,
  +0.0838420f, -0.2359454f, +0.1920122f, +0.1026141f, +0.0558347f, -0.0829638f, -0.0068693f, -0.1792922f,
  +0.2063931f, -0.0324581f, -0.2485061f, -0.1048533f, -0.5620730f, -0.0376935f, -0.2194997f, +0.0195014f,
  -0.1604413f, +0.1635384f, -0.2007130f, -0.1916727f, +0.3379601f, +0.6669585f, +0.0733106f, -0.7848146f,
  +0.2978703f, +0.0904520f, -0.3378485f, -0.0492886f, -0.1016149f, +0.2144128f, -0.2470018f, +0.2291401f,
  +0.0640472f, +0.0746001f, -0.0508004f, +0.1253370f, +0.1888279f, -0.0579497f, -0.0169657f, -0.0240705f,
  -0.2333097f, -0.4970607f, -0.2286728f, -0.1713319f, +0.6197717f, -0.0324874f, +0.1604093f, -0.4648184f,
  +0.1126584f, -0.0806760f, -0.0764193f, +0.1553209f, +0.0578330f, -0.1795467f, -0.1596841f, -0.1981588f,
  -0.0264348f, -0.0174325f, -0.0739151f, +0.1992119f, -0.2474261f, +0.1317926f, +0.0541306f, +0.0276628f,
  -0.1750364f, -0.1220650f, -0.0233348f, -0.1053718f, -0.0099140f, +0.4753914f, +0.3412887f, -0.0081539f,
  +0.0789644f, -0.0314421f, +0.0062446f, +0.0060372f, -0.0470509f, +0.1703877f, +0.0362285f, +0.0019753f,
  +0.2581062f, +0.2032024f, +0.1402659f, -0.1794217f, +0.1941877f, -0.3189368f, -0.1156187f, +0.0469699f,
  -0.1958680f, +0.1719023f, +0.5047304f, +0.1137721f, -0.0631400f, -0.3958679f, +0.2873464f, -0.1245371f,
  -0.0247588f, +0.0097899f, -0.3120378f, +0.1085724f, -0.1361162f, -0.1628410f, +0.0420063f, -0.0258019f,
  +0.0684555f, -0.2425196f, +0.0701482f, +0.5814599f, -0.2448221f, +0.0073064f, +0.0324222f, +0.2770283f,
  -0.4817266f, -0.0548816f, +0.3535906f, -0.5091690f, -0.1828343f, +0.3305787f, +0.5394805f, +0.0272944f,
  +0.1793407f, +0.3886717f, -0.2906804f, -0.1875970f, +0.1621131f, -0.2718988f, -0.0816591f, +0.0125408f,
  -0.3374927f, -0.2982334f, -0.0895464f, -0.0032530f, +0.1573506f, -0.1369901f, +0.7200313f, +0.1497207f,
  +0.1273000f, +0.0119655f, -0.3530258f, +0.0731809f, -0.2527971f, -0.2494317f, -0.0803989f, -0.3878524f,
  -0.1815854f, -0.0590211f, +0.2747304f, -0.0110334f, -0.0981231f, -0.0412323f, +0.1561652f, +0.0135934f,
  +0.1316312f, -0.2204631f, -0.4037071f, -0.2294241f, +0.1190087f, -0.0758908f, +0.4078341f, +0.1514022f,
  -0.4635981f, +0.2867437f, +0.0862390f, +0.4216588f, -0.2515514f, -0.5504338f, +0.7885067f, -0.0043906f,
  -0.0477841f, +0.0659361f, +0.4806932f, -0.2694041f, -0.3176927f, +0.1694311f, +0.2202511f, -0.2823257f,
  -0.0350627f, -0.1150118f, +0.0421416f, -0.2502882f, +0.1533031f, -0.2252209f, +0.0232041f, +0.0276459f,
  -0.0482218f, +0.2074490f, +0.3546515f, +0.2273229f, +0.1545573f, -0.2214031f, +0.1313923f, +0.6494334f,
  -0.0402639f, -0.0843187f, -0.0878400f, -0.0696621f, +0.1241701f, -0.1806943f, +0.1381600f, -0.1198791f,
  -0.0428760f, +0.0934389f, +0.1833195f, -0.0056534f, -0.0707647f, -0.0897764f, -0.0921317f, -0.0452263f,
  +0.1289342f, -0.1728545f, +0.1938139f, -0.0191553f, +0.2526548f, -0.2006877f, -0.1308871f, +0.1852302f,
  +0.0152526f, -0.3062344f, +0.0512373f, +0.0252598f, +0.1528333f, -0.2815124f, -0.0441295f, +0.0684482f,
  +0.1240532f, -0.2916195f, +0.1747703f, +0.1216626f, +0.0298675f, +0.2763291f, -0.2021684f, +0.0570452f,
  -0.2405214f, -0.0089747f, -0.1708474f, -0.1297915f, +0.3907340f, +0.7254466f, +0.1929956f, -0.2752048f,
  +0.1680567f, +0.0964701f, -0.1566252f, -0.0308427f, +0.2140354f, +0.0968851f, -0.0479929f, +0.2258950f,
  +0.0491991f, +0.1605121f, +0.0076269f, -0.2981893f, -0.0104595f, +0.1453747f, -0.2315360f, -0.2525549f,
  +0.2374075f, +0.1277283f, -0.1952909f, +0.1377851f, -0.0549243f, -0.2420656f, -0.2135459f, -0.0045064f,
  -0.1016873f, -0.2159841f, -0.2106952f, +0.1441706f, -0.0167362f, -0.0268178f, +0.0778160f, -0.0443479f
);

const float biases[4] = float[4](
  +0.0428883f, +0.0601713f, -0.1020197f, -0.0712034f
);

vec4 hook() {
    const vec4 r[9][2] = vec4[9][2](
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 1.0f)))
    );

    float sum[4] = biases;
    for (int n = 0; n < 4; n++) {
        for (int i = 0; i < 9; i++) {
            const vec4 k0 = vec4(kernels[n * 8 * 9 + 8 * i + 0], kernels[n * 8 * 9 + 8 * i + 1], kernels[n * 8 * 9 + 8 * i + 2], kernels[n * 8 * 9 + 8 * i + 3]);
            const vec4 k1 = vec4(kernels[n * 8 * 9 + 8 * i + 4], kernels[n * 8 * 9 + 8 * i + 5], kernels[n * 8 * 9 + 8 * i + 6], kernels[n * 8 * 9 + 8 * i + 7]);
            sum[n] += (dot(k0, r[i][0]) + dot(k1, r[i][1]));
        }
    }

    return ACTIVE(vec4(sum[0], sum[1], sum[2], sum[3]) * 0.2000000f + TEX_BIND_L2_TEXOFF(vec2(0.0f, 0.0f)));
}

//!HOOK LUMA
//!DESC ARNet b16 Layer23 L0
//!WHEN OUTPUT.w LUMA.w / 1.2 > OUTPUT.h LUMA.h / 1.2 > *
//!BIND TMP2_L0
//!BIND TMP2_L1
//!SAVE TMP1_L0
//!COMPONENTS 4

#define ACTIVE(v) (max(v, v * 0.2000000f))

#define TEX_BIND_L0_TEXOFF TMP2_L0_texOff
#define TEX_BIND_L0_TEX TMP2_L0_tex
#define TEX_BIND_L0_POS TMP2_L0_pos
#define TEX_BIND_L0_SIZE TMP2_L0_size
#define TEX_BIND_L0_PT TMP2_L0_pt

#define TEX_BIND_L1_TEXOFF TMP2_L1_texOff
#define TEX_BIND_L1_TEX TMP2_L1_tex
#define TEX_BIND_L1_POS TMP2_L1_pos
#define TEX_BIND_L1_SIZE TMP2_L1_size
#define TEX_BIND_L1_PT TMP2_L1_pt

const float kernels[288] = float[288](
  -0.4031993f, +0.2492138f, -0.1041314f, +0.0055542f, -0.3104285f, +0.0109199f, +0.0637188f, -0.0863272f,
  -0.0151100f, +0.3325324f, +0.3504137f, -0.1110336f, +0.7677255f, +0.5100192f, -0.0962225f, -0.5365388f,
  +0.1540162f, +0.4461454f, +0.0629938f, -0.0536053f, +0.0077958f, -0.3790417f, +0.2170751f, +0.3100972f,
  -0.1129501f, -0.0564190f, -0.0077357f, +0.1530117f, +0.0805588f, +0.0442945f, +0.0003625f, +0.1091245f,
  -0.1539680f, +0.1222814f, -0.0614416f, +0.0245738f, +0.0603281f, -0.0957361f, +0.2359794f, -0.5421384f,
  +0.0648535f, +0.3026160f, -0.3170136f, -0.1513305f, +0.1331705f, -0.5589134f, +0.3160304f, -0.1904487f,
  -0.0386380f, +0.1915465f, -0.1255325f, +0.0024954f, +0.1724923f, +0.1011942f, +0.0597757f, +0.1553072f,
  +0.1057035f, -0.1394240f, -0.0405305f, +0.0637570f, +0.0287861f, +0.1127744f, +0.1285418f, -0.0579218f,
  +0.0658876f, +0.1158713f, +0.0055453f, -0.0418356f, -0.1416920f, -0.2080821f, -0.0379536f, +0.0080816f,
  -0.6191043f, -0.1887373f, +0.1515816f, +0.2381030f, -0.2083570f, +0.1301925f, +0.0852799f, -0.3233047f,
  -0.2313884f, +0.3502643f, +0.0120123f, +0.2317583f, +0.1117567f, +0.4943769f, +0.5920277f, +0.1822672f,
  +0.2622209f, -0.2879688f, +0.6383404f, -0.1107834f, +0.4644018f, -0.2304818f, -0.2358172f, +0.0542258f,
  +0.1996164f, -0.2621850f, -0.0482944f, +0.1557019f, +0.4185402f, -0.3147696f, +0.0283273f, -0.0841929f,
  +0.2415093f, +0.8074017f, +0.1410448f, +0.2093686f, +0.0859411f, +0.4814281f, +1.0222937f, +0.0786471f,
  +0.3926574f, -0.3407589f, +0.1716572f, -0.0403232f, +0.6038476f, +0.0018772f, +0.5960845f, -0.2020441f,
  -0.0624816f, -0.1684205f, +0.3289317f, +0.0255746f, +0.4769343f, -0.0809525f, -0.0146791f, +0.1277010f,
  +0.5224089f, +0.1847092f, +0.3673808f, +0.2263060f, -0.0860245f, -0.0965052f, -0.1332748f, -0.2905159f,
  +0.7626863f, -0.8609985f, +0.2507700f, -0.0407301f, +0.5246410f, -0.0904788f, -0.3726414f, -0.2576335f,
  -0.0301922f, -0.0410506f, -0.2149622f, -0.4034477f, -0.1072676f, -0.3379934f, -0.0698793f, +0.2266831f,
  +0.0409316f, +0.0534032f, -0.2337635f, +0.0629840f, +0.0082659f, -0.1648954f, -0.2112714f, +0.3192950f,
  +0.1360301f, +0.1952280f, +0.0908482f, -0.0437567f, -0.2483076f, +0.1116917f, -0.0793091f, -0.1816156f,
  -0.1262258f, -0.0265449f, -0.3665435f, -0.2124879f, +0.0208222f, +0.2895505f, -0.3290832f, +0.2351216f,
  +0.1378581f, -0.6686795f, -0.5675938f, +0.4873542f, -0.5704467f, +0.0568196f, -0.3348362f, +0.0417722f,
  +0.0257903f, +0.1930048f, -0.1678759f, +0.0019921f, -0.1211209f, +0.2775345f, -0.0399401f, +0.0554313f,
  -0.0244454f, +0.2109827f, -0.1570654f, -0.0546645f, -0.0512718f, -0.1368742f, -0.1508282f, -0.0249010f,
  +0.0235529f, -0.0095795f, -0.0990727f, -0.0341788f, +0.3123576f, +0.0812432f, -0.1326015f, -0.1386928f,
  +0.0561258f, +0.0047561f, -0.0457817f, -0.0107817f, -0.0907216f, -0.1984768f, +0.0681351f, -0.1376301f,
  -0.2495222f, +0.0387114f, -0.2751294f, -0.0880364f, -0.1986625f, -0.0375174f, +0.1161788f, +0.1605732f,
  +0.2179522f, -0.0988002f, -0.1056505f, -0.3529505f, +0.0310468f, +0.1210103f, -0.4224961f, +0.1029227f,
  -0.1043936f, +0.1943032f, -0.0257838f, +0.1715816f, -0.2471214f, -0.1485843f, -0.1691110f, +0.1443193f,
  -0.1815438f, +0.3250868f, +0.2218034f, +0.0637930f, +0.1728088f, +0.0127236f, +0.2669777f, +0.4169892f,
  +0.7192810f, +0.6501880f, -0.0473504f, -0.7434760f, -0.1518286f, -0.0531648f, -0.1359994f, +0.2160283f,
  -0.0861529f, +0.2743161f, -0.0536852f, +0.0863104f, +0.0879021f, -0.1523894f, -0.1299466f, +0.0377511f,
  -0.1480518f, +0.1673702f, -0.1720773f, +0.0647091f, -0.0110091f, -0.0837561f, +0.0460932f, +0.0661899f,
  +0.0498841f, +0.2285540f, -0.1395144f, -0.1364689f, -0.3671872f, -0.0182373f, +0.0995439f, +0.2130738f,
  +0.0952647f, +0.0914639f, -0.1359220f, -0.0132651f, -0.0061738f, -0.2128953f, +0.0492538f, +0.0011005f
);

const float biases[4] = float[4](
  -0.0350027f, -0.0331373f, +0.0582619f, +0.1286933f
);

vec4 hook() {
    const vec4 r[9][2] = vec4[9][2](
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 1.0f)))
    );

    float sum[4] = biases;
    for (int n = 0; n < 4; n++) {
        for (int i = 0; i < 9; i++) {
            const vec4 k0 = vec4(kernels[n * 8 * 9 + 8 * i + 0], kernels[n * 8 * 9 + 8 * i + 1], kernels[n * 8 * 9 + 8 * i + 2], kernels[n * 8 * 9 + 8 * i + 3]);
            const vec4 k1 = vec4(kernels[n * 8 * 9 + 8 * i + 4], kernels[n * 8 * 9 + 8 * i + 5], kernels[n * 8 * 9 + 8 * i + 6], kernels[n * 8 * 9 + 8 * i + 7]);
            sum[n] += (dot(k0, r[i][0]) + dot(k1, r[i][1]));
        }
    }

    return ACTIVE(vec4(sum[0], sum[1], sum[2], sum[3]));
}

//!HOOK LUMA
//!DESC ARNet b16 Layer23 L1
//!WHEN OUTPUT.w LUMA.w / 1.2 > OUTPUT.h LUMA.h / 1.2 > *
//!BIND TMP2_L0
//!BIND TMP2_L1
//!SAVE TMP1_L1
//!COMPONENTS 4

#define ACTIVE(v) (max(v, v * 0.2000000f))

#define TEX_BIND_L0_TEXOFF TMP2_L0_texOff
#define TEX_BIND_L0_TEX TMP2_L0_tex
#define TEX_BIND_L0_POS TMP2_L0_pos
#define TEX_BIND_L0_SIZE TMP2_L0_size
#define TEX_BIND_L0_PT TMP2_L0_pt

#define TEX_BIND_L1_TEXOFF TMP2_L1_texOff
#define TEX_BIND_L1_TEX TMP2_L1_tex
#define TEX_BIND_L1_POS TMP2_L1_pos
#define TEX_BIND_L1_SIZE TMP2_L1_size
#define TEX_BIND_L1_PT TMP2_L1_pt

const float kernels[288] = float[288](
  +0.0053946f, +0.0006358f, -0.2190463f, -0.1578810f, +0.0264614f, -0.1227267f, -0.0498159f, +0.1166859f,
  +0.1056831f, -0.1281274f, -0.1722714f, +0.1896878f, -0.0624947f, -0.1559117f, -0.1461068f, +0.3288592f,
  +0.0841994f, +0.1301313f, +0.0913297f, -0.0392078f, -0.1209844f, -0.1435619f, +0.0316812f, +0.0511690f,
  -0.2307717f, +0.1268817f, -0.0747489f, -0.1531813f, +0.1316050f, -0.0432651f, +0.1168602f, +0.1598313f,
  +0.5117871f, +0.7569111f, +0.3396807f, -0.3608429f, -0.2652316f, +0.1062289f, +0.0437673f, -0.4881341f,
  -0.3466074f, +0.3719400f, -0.0706792f, -0.0215572f, +0.0138046f, +0.1468084f, -0.0706176f, -0.1026111f,
  +0.0165603f, +0.1348026f, -0.3424410f, -0.0180347f, +0.2789835f, +0.0437657f, -0.0524430f, +0.3414050f,
  -0.2297493f, +0.1092084f, -0.4924576f, -0.1316658f, -0.0639153f, +0.3807684f, +0.1235339f, +0.1944012f,
  +0.2415588f, +0.1403182f, -0.4609536f, +0.1739883f, -0.3368396f, -0.0333960f, -0.4352170f, +0.1386522f,
  -0.1417161f, +0.3842880f, -0.4565755f, +0.1445775f, +0.0338596f, +0.2788391f, +0.1818566f, +0.2546443f,
  +0.6679831f, +0.2444566f, +0.3192984f, +0.1030807f, +0.2584167f, +0.0506250f, +0.0110595f, -0.2479062f,
  +0.1972039f, -0.4192059f, -0.0630529f, +0.2567792f, +0.3632900f, +0.1208217f, +0.3653012f, +0.0122779f,
  +0.2291533f, -0.1164811f, +0.3438306f, -0.0974677f, +0.8595775f, -0.1072035f, +0.3595500f, -0.0844735f,
  +0.6682199f, -0.1591301f, -0.6458494f, +0.3429962f, +0.4822038f, +0.1128625f, -0.0264163f, +0.0109058f,
  +0.2670780f, -0.7101516f, +0.2172322f, +0.1444673f, +0.5934830f, +0.3602702f, -0.2016000f, +0.1090985f,
  +0.0542760f, -0.6517146f, -0.1750806f, +0.0941809f, -0.0648600f, +0.1649655f, -0.2642898f, +0.0796788f,
  +0.8021695f, -0.5369208f, +0.4291541f, +0.2200623f, +0.9625311f, +0.4532757f, +0.0441124f, -0.1198299f,
  -0.2742592f, -0.6958441f, +0.5957084f, +0.1480044f, +0.5272217f, +0.9832777f, -0.1450554f, +0.0884190f,
  +0.2162538f, +0.1418860f, +0.0773624f, -0.0832338f, -0.2598067f, +0.0137706f, +0.1305548f, +0.0363018f,
  -0.0679085f, -0.0695067f, +0.3288516f, +0.0194333f, -0.1443545f, -0.4070085f, +0.1513948f, +0.1111479f,
  -0.1301092f, +0.1134893f, +0.0835886f, -0.1734154f, +0.2885583f, -0.3575872f, +0.1844872f, -0.1504938f,
  +0.4151993f, +0.1874408f, +0.0309177f, -0.0292758f, +0.2285463f, -0.1216895f, +0.0439619f, -0.0057799f,
  +0.6179907f, +0.1694744f, +0.2638570f, -0.6465364f, -0.6416492f, -0.0211466f, +0.0621751f, -0.2805780f,
  -0.1994309f, +0.2164755f, -0.1801366f, +0.0835676f, +0.9568679f, +0.2175591f, -0.2113890f, -0.1565186f,
  +0.1000117f, -0.1009106f, +0.3251645f, -0.1236178f, +0.3064958f, -0.0745176f, -0.1688392f, +0.0203482f,
  -0.1446333f, +0.1498764f, +0.6722720f, +0.4081303f, -0.0833407f, +0.2466163f, +0.2202725f, +0.2594146f,
  +0.0676768f, +0.1231992f, -0.0776752f, +0.0879239f, -0.0187817f, -0.2277156f, +0.0345104f, -0.2316167f,
  -0.2697315f, -0.0263776f, -0.1492305f, +0.0671550f, -0.1048362f, +0.0876518f, +0.3120613f, +0.1167625f,
  -0.2309471f, -0.2444855f, -0.1239276f, -0.1463938f, -0.0566658f, +0.1079092f, +0.0630661f, -0.2048115f,
  -0.5849603f, +0.0987894f, +0.1052564f, -0.1255387f, -0.2131419f, +0.0632579f, +0.0786633f, -0.1488462f,
  +0.1758606f, +0.4310303f, +0.0225619f, +0.0923084f, +0.0172358f, +0.2236165f, -0.0444661f, +0.0877881f,
  -0.2588289f, +0.0012118f, -0.0158209f, -0.2287812f, +0.5366742f, -0.4146061f, -0.0515022f, +0.1415520f,
  -0.5006083f, -0.1858266f, -0.3465906f, +0.0848318f, -0.1589065f, +0.5304222f, -0.4932709f, -0.1695022f,
  -0.2268836f, +0.3462436f, -0.2512253f, -0.1750080f, -0.1339431f, -0.0315167f, -0.3404167f, +0.2026424f,
  -0.0566667f, +0.0732811f, -0.2973192f, +0.1271064f, -0.1592900f, -0.0162052f, -0.1369672f, -0.0997835f,
  -0.0730088f, +0.3552844f, -0.1996706f, -0.0331774f, -0.0301689f, +0.0552610f, -0.0027472f, +0.0391002f
);

const float biases[4] = float[4](
  -0.0386581f, -0.1394819f, -0.0071024f, +0.0715969f
);

vec4 hook() {
    const vec4 r[9][2] = vec4[9][2](
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 1.0f)))
    );

    float sum[4] = biases;
    for (int n = 0; n < 4; n++) {
        for (int i = 0; i < 9; i++) {
            const vec4 k0 = vec4(kernels[n * 8 * 9 + 8 * i + 0], kernels[n * 8 * 9 + 8 * i + 1], kernels[n * 8 * 9 + 8 * i + 2], kernels[n * 8 * 9 + 8 * i + 3]);
            const vec4 k1 = vec4(kernels[n * 8 * 9 + 8 * i + 4], kernels[n * 8 * 9 + 8 * i + 5], kernels[n * 8 * 9 + 8 * i + 6], kernels[n * 8 * 9 + 8 * i + 7]);
            sum[n] += (dot(k0, r[i][0]) + dot(k1, r[i][1]));
        }
    }

    return ACTIVE(vec4(sum[0], sum[1], sum[2], sum[3]));
}

//!HOOK LUMA
//!DESC ARNet b16 Layer24 L0
//!WHEN OUTPUT.w LUMA.w / 1.2 > OUTPUT.h LUMA.h / 1.2 > *
//!BIND TMP1_L0
//!BIND TMP1_L1
//!BIND TMP2_L0
//!SAVE TMP2_L0
//!COMPONENTS 4

#define ACTIVE(v) (v)

#define TEX_BIND_L0_TEXOFF TMP1_L0_texOff
#define TEX_BIND_L0_TEX TMP1_L0_tex
#define TEX_BIND_L0_POS TMP1_L0_pos
#define TEX_BIND_L0_SIZE TMP1_L0_size
#define TEX_BIND_L0_PT TMP1_L0_pt

#define TEX_BIND_L1_TEXOFF TMP1_L1_texOff
#define TEX_BIND_L1_TEX TMP1_L1_tex
#define TEX_BIND_L1_POS TMP1_L1_pos
#define TEX_BIND_L1_SIZE TMP1_L1_size
#define TEX_BIND_L1_PT TMP1_L1_pt

#define TEX_BIND_L2_TEXOFF TMP2_L0_texOff
#define TEX_BIND_L2_TEX TMP2_L0_tex
#define TEX_BIND_L2_POS TMP2_L0_pos
#define TEX_BIND_L2_SIZE TMP2_L0_size
#define TEX_BIND_L2_PT TMP2_L0_pt

const float kernels[288] = float[288](
  -0.0591795f, -0.2453635f, +0.1626381f, -0.0262888f, -0.0991937f, +0.3100696f, -0.1721532f, -0.1815684f,
  -0.1701943f, -0.3288695f, +0.0470561f, -0.1258503f, +0.0365568f, -0.2445947f, -0.2881940f, +0.0873280f,
  -0.0370182f, +0.0072648f, +0.0699949f, +0.1721560f, -0.1377430f, +0.2450632f, +0.0086918f, +0.0505523f,
  +0.1685477f, -0.3722406f, -0.1393730f, -0.0533833f, -0.1606302f, +0.6595141f, +0.0446472f, +0.0406818f,
  +0.4406379f, -0.5860093f, -0.2407034f, -0.7364995f, -0.4618426f, -0.4069786f, -0.1371003f, +0.5686301f,
  +0.2192408f, -0.2289421f, +0.2703687f, -0.2005700f, +0.0236983f, +0.2766968f, -0.0327519f, -0.1922119f,
  -0.0279888f, +0.0653447f, +0.0033535f, -0.0053327f, -0.1410570f, +0.1592286f, -0.0346401f, +0.3117215f,
  +0.0836763f, +0.4120442f, -0.1708553f, +0.1367185f, -0.1981771f, +0.0126130f, -0.0660217f, +0.0120621f,
  -0.0861955f, +0.1197920f, +0.1374729f, +0.1675226f, -0.0383596f, +0.1116775f, -0.1233485f, -0.2602508f,
  -0.0514658f, +0.2338245f, -0.1498300f, +0.1953951f, +0.0603370f, +0.1851356f, +0.1332220f, +0.0357507f,
  +0.0117645f, +0.0704619f, +0.0994981f, -0.0824079f, -0.4667533f, +0.3884286f, -0.2456720f, +0.2948868f,
  +0.0400458f, +0.0355092f, +0.0790893f, -0.0009191f, -0.0158510f, +0.1214709f, -0.1637578f, -0.3546469f,
  +0.0058705f, +0.0127308f, +0.0942777f, -0.0964990f, +0.2998030f, +0.5336303f, +0.3952807f, +0.2059797f,
  -0.1335675f, +0.2235764f, +0.6312618f, -0.7834833f, -0.0188472f, +0.0586437f, +0.2158318f, +0.3833838f,
  -0.1703317f, +0.0309681f, -0.1892952f, +0.0513047f, +0.0790441f, -0.3781558f, +0.0853301f, -0.0720307f,
  -0.1009276f, -0.5322595f, +0.1156562f, -0.0050858f, +0.0100218f, +0.3168824f, +0.2340529f, +0.1283663f,
  +0.0581541f, -0.2212532f, +0.1234602f, -0.0008939f, -0.1269627f, -0.0542629f, +0.3362168f, +0.4450576f,
  -0.0316597f, +0.0108162f, +0.0646231f, -0.3104937f, +0.0587492f, -0.4325895f, +0.2162915f, -0.1112150f,
  +0.1112577f, +0.0269450f, -0.0013652f, -0.0668921f, +0.0064399f, -0.7540437f, +0.1751487f, +0.1066888f,
  -0.0476291f, -0.1109241f, +0.0549746f, -0.2392754f, +0.3818108f, -0.0333385f, -0.3749707f, +0.1368831f,
  -0.0401461f, +0.0131835f, -0.0417317f, +0.1354412f, +0.0457661f, +0.3308843f, +0.2174750f, +0.0419541f,
  -0.0389681f, +0.0694870f, +0.0986198f, -0.1579629f, +0.0439994f, +0.1227526f, +0.2532822f, +0.0491554f,
  +0.2105272f, +0.0663927f, +0.6333058f, -0.2180080f, -0.5095872f, +0.1695256f, -0.2847332f, +0.1623733f,
  +0.5735414f, +0.0068891f, +0.1864227f, -0.1405646f, -0.1768590f, +0.2338560f, +0.2816116f, +0.0636258f,
  +0.0585960f, -0.7071803f, -0.1239052f, +0.0815643f, -0.0047360f, +0.3465286f, -0.1439387f, -0.0989250f,
  +0.1627012f, -0.5152882f, +0.1780149f, -0.2004395f, +0.1227148f, -0.0659154f, -0.1651985f, -0.0543685f,
  +0.1757274f, -0.1101715f, +0.3654523f, +0.1552013f, -0.1469876f, +0.2697517f, +0.0895151f, -0.1146969f,
  +0.1024922f, +0.2857245f, -0.1262586f, -0.0096731f, +0.2651490f, -0.2440601f, -0.3848580f, +0.1351082f,
  -0.0666758f, +0.3197396f, -0.1818813f, +0.0940191f, +0.3281867f, +0.1031833f, -0.4430969f, -0.0439715f,
  -0.0084978f, +0.2148259f, -0.0517273f, +0.1140935f, +0.0966792f, +0.3356000f, +0.1677111f, -0.2092414f,
  -0.4102152f, +0.0777281f, -0.0521117f, -0.1275477f, +0.3603998f, -0.0728363f, -0.1903119f, +0.0477413f,
  -0.0682914f, -0.6595959f, -0.5716345f, +0.3630060f, +0.4463691f, +0.2009586f, +0.2777853f, -0.1721686f,
  +0.3510404f, -0.5732687f, +0.3470971f, +0.2615540f, +0.0593372f, +0.3321747f, +0.0195855f, -0.4516854f,
  -0.0637234f, +0.4338337f, +0.0133391f, -0.1568002f, +0.3557672f, +0.0144669f, -0.1753928f, +0.1271397f,
  +0.0187520f, -0.3188367f, -0.0928956f, +0.2038959f, -0.1334698f, +0.3583937f, -0.2940336f, -0.1256102f,
  -0.0824011f, -0.0086184f, +0.2006440f, -0.2420278f, +0.1919474f, -0.2954418f, +0.0152360f, -0.4751127f
);

const float biases[4] = float[4](
  +0.0980193f, -0.0404373f, +0.0511546f, -0.0581533f
);

vec4 hook() {
    const vec4 r[9][2] = vec4[9][2](
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 1.0f)))
    );

    float sum[4] = biases;
    for (int n = 0; n < 4; n++) {
        for (int i = 0; i < 9; i++) {
            const vec4 k0 = vec4(kernels[n * 8 * 9 + 8 * i + 0], kernels[n * 8 * 9 + 8 * i + 1], kernels[n * 8 * 9 + 8 * i + 2], kernels[n * 8 * 9 + 8 * i + 3]);
            const vec4 k1 = vec4(kernels[n * 8 * 9 + 8 * i + 4], kernels[n * 8 * 9 + 8 * i + 5], kernels[n * 8 * 9 + 8 * i + 6], kernels[n * 8 * 9 + 8 * i + 7]);
            sum[n] += (dot(k0, r[i][0]) + dot(k1, r[i][1]));
        }
    }

    return ACTIVE(vec4(sum[0], sum[1], sum[2], sum[3]) * 0.2000000f + TEX_BIND_L2_TEXOFF(vec2(0.0f, 0.0f)));
}

//!HOOK LUMA
//!DESC ARNet b16 Layer24 L1
//!WHEN OUTPUT.w LUMA.w / 1.2 > OUTPUT.h LUMA.h / 1.2 > *
//!BIND TMP1_L0
//!BIND TMP1_L1
//!BIND TMP2_L1
//!SAVE TMP2_L1
//!COMPONENTS 4

#define ACTIVE(v) (v)

#define TEX_BIND_L0_TEXOFF TMP1_L0_texOff
#define TEX_BIND_L0_TEX TMP1_L0_tex
#define TEX_BIND_L0_POS TMP1_L0_pos
#define TEX_BIND_L0_SIZE TMP1_L0_size
#define TEX_BIND_L0_PT TMP1_L0_pt

#define TEX_BIND_L1_TEXOFF TMP1_L1_texOff
#define TEX_BIND_L1_TEX TMP1_L1_tex
#define TEX_BIND_L1_POS TMP1_L1_pos
#define TEX_BIND_L1_SIZE TMP1_L1_size
#define TEX_BIND_L1_PT TMP1_L1_pt

#define TEX_BIND_L2_TEXOFF TMP2_L1_texOff
#define TEX_BIND_L2_TEX TMP2_L1_tex
#define TEX_BIND_L2_POS TMP2_L1_pos
#define TEX_BIND_L2_SIZE TMP2_L1_size
#define TEX_BIND_L2_PT TMP2_L1_pt

const float kernels[288] = float[288](
  -0.0534590f, -0.3217303f, -0.0723285f, -0.0176871f, +0.0851152f, -0.2787009f, -0.0098619f, +0.0033494f,
  +0.2505493f, -0.3044358f, -0.4782861f, +0.3742748f, -0.3370294f, -0.4124501f, -0.0420355f, +0.0307024f,
  +0.1854708f, -0.1019570f, -0.1832272f, -0.1491210f, -0.1050779f, +0.1345304f, -0.1000320f, +0.0136267f,
  -0.1159582f, +0.0521765f, +0.0338558f, -0.0387058f, +0.3928593f, -0.1250399f, -0.4257318f, +0.1134822f,
  -0.4615207f, -0.0530753f, +0.2214042f, +0.1756067f, +0.2449998f, -0.1727395f, -0.2555519f, -0.5030205f,
  -0.0850333f, -0.3176560f, +0.2152482f, +0.0064169f, -0.2944592f, -0.6069551f, -0.1671330f, -0.2822417f,
  -0.3246048f, +0.4393358f, -0.1256465f, -0.0449742f, -0.1292058f, -0.2418921f, +0.0140799f, +0.2141828f,
  +0.1255093f, +0.1576467f, -0.0321710f, -0.3612768f, +0.0219070f, -0.3331248f, +0.1350621f, +0.0850684f,
  -0.0200221f, +0.0837777f, -0.1830240f, +0.2873947f, -0.0503282f, -0.2485017f, -0.1779664f, +0.1474815f,
  -0.1196460f, -0.0657540f, +0.0540056f, -0.0145896f, -0.1193844f, -0.0455074f, +0.0714084f, +0.0044253f,
  +0.0972122f, -0.1198773f, -0.0522132f, -0.0391364f, -0.2324014f, -0.2270437f, +0.0047066f, +0.0217556f,
  -0.1077465f, -0.0962517f, +0.0467149f, -0.0678290f, +0.0110149f, +0.0040942f, -0.1287283f, +0.1309188f,
  +0.2633931f, -0.5344403f, +0.0497580f, -0.1452813f, -0.3196405f, +0.1371339f, -0.0768313f, -0.2695007f,
  +0.1770509f, -0.2392944f, +0.0532022f, -0.2185362f, +0.2388424f, +0.1520046f, -0.3523801f, +0.5826173f,
  -0.2766145f, +0.2811098f, -0.1102668f, -0.2387866f, +0.3242470f, +0.1914548f, -0.1856248f, +0.0680655f,
  -0.1163235f, +0.1182435f, -0.0291826f, +0.2413804f, -0.0529840f, +0.2172682f, +0.1255752f, -0.2333826f,
  +0.4695578f, +0.3070503f, -0.0281978f, -0.1272896f, +0.0127767f, +0.0478629f, +0.2262580f, -0.2731888f,
  -0.0376563f, -0.1759488f, +0.0530486f, -0.2972711f, +0.1346195f, -0.1540070f, -0.0780750f, -0.1896674f,
  -0.0569323f, +0.1623397f, +0.1024438f, -0.2813547f, +0.2291808f, +0.6781861f, -0.1877182f, +0.1174285f,
  -0.1091126f, -0.0295984f, +0.1732320f, +0.1950311f, +0.3047670f, -0.2225734f, -0.3975928f, -0.0864267f,
  -0.1382299f, +0.0265111f, +0.0751970f, +0.1042555f, +0.0554744f, +0.2072095f, -0.0709551f, +0.0811398f,
  -0.0676349f, -0.0016444f, -0.2166836f, -0.1115085f, -0.5579040f, +0.2491284f, +0.2935467f, +0.2111306f,
  -0.5585712f, -1.0077724f, +0.1831854f, +0.0240868f, -0.3637677f, +0.2958132f, -0.1363006f, +0.1230757f,
  +0.2302032f, -0.0002198f, +0.3063890f, -0.0612524f, -0.1936415f, -0.1241927f, -0.1692677f, -0.4712608f,
  +0.3977673f, -0.3265297f, +0.0419415f, +0.1620187f, -0.1928089f, +0.0075271f, -0.1772660f, -0.0500950f,
  -0.2416207f, +0.0303890f, -0.2026970f, +0.0894598f, +0.0656458f, -0.0921165f, -0.4021617f, +0.0391744f,
  -0.1159185f, -0.3419318f, -0.1243109f, -0.1414776f, -0.0293131f, -0.0719810f, -0.1248998f, -0.1055966f,
  -0.0377837f, +0.1692181f, +0.0208739f, +0.0816303f, -0.0164572f, +0.2656391f, +0.0649728f, +0.0234104f,
  -0.1123012f, +0.0443833f, -0.2384738f, -0.1200622f, +0.1146275f, -0.1557043f, +0.0103724f, +0.2002162f,
  +0.1357672f, -0.0557984f, +0.0039886f, +0.0355795f, -0.1719300f, -0.2049395f, -0.1405066f, -0.2267393f,
  -0.1169321f, +0.7087906f, +0.0257347f, -0.1626125f, +0.3392612f, -0.1765784f, +0.0018161f, +0.0832804f,
  -0.1316655f, +0.0699320f, -0.1478857f, +0.2443289f, +0.2575604f, +0.1111229f, +0.2990851f, -0.4354494f,
  -0.0315527f, -0.2084635f, -0.0678682f, -0.0914297f, -0.1403788f, -0.3174091f, -0.0369778f, -0.0898311f,
  +0.3472216f, -0.1545942f, +0.1256653f, -0.3101440f, +0.1035959f, -0.3952293f, +0.0148541f, +0.1745322f,
  -0.3096305f, -0.0758127f, -0.3966496f, +0.2619942f, -0.1803426f, +0.2477579f, -0.0712666f, +0.2865532f,
  -0.2343868f, +0.1180308f, -0.2542984f, +0.1038375f, +0.0091678f, -0.3853911f, -0.0018197f, -0.0847233f
);

const float biases[4] = float[4](
  +0.0161695f, -0.0133205f, +0.0207755f, -0.1382454f
);

vec4 hook() {
    const vec4 r[9][2] = vec4[9][2](
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 1.0f)))
    );

    float sum[4] = biases;
    for (int n = 0; n < 4; n++) {
        for (int i = 0; i < 9; i++) {
            const vec4 k0 = vec4(kernels[n * 8 * 9 + 8 * i + 0], kernels[n * 8 * 9 + 8 * i + 1], kernels[n * 8 * 9 + 8 * i + 2], kernels[n * 8 * 9 + 8 * i + 3]);
            const vec4 k1 = vec4(kernels[n * 8 * 9 + 8 * i + 4], kernels[n * 8 * 9 + 8 * i + 5], kernels[n * 8 * 9 + 8 * i + 6], kernels[n * 8 * 9 + 8 * i + 7]);
            sum[n] += (dot(k0, r[i][0]) + dot(k1, r[i][1]));
        }
    }

    return ACTIVE(vec4(sum[0], sum[1], sum[2], sum[3]) * 0.2000000f + TEX_BIND_L2_TEXOFF(vec2(0.0f, 0.0f)));
}

//!HOOK LUMA
//!DESC ARNet b16 Layer25 L0
//!WHEN OUTPUT.w LUMA.w / 1.2 > OUTPUT.h LUMA.h / 1.2 > *
//!BIND TMP2_L0
//!BIND TMP2_L1
//!SAVE TMP1_L0
//!COMPONENTS 4

#define ACTIVE(v) (max(v, v * 0.2000000f))

#define TEX_BIND_L0_TEXOFF TMP2_L0_texOff
#define TEX_BIND_L0_TEX TMP2_L0_tex
#define TEX_BIND_L0_POS TMP2_L0_pos
#define TEX_BIND_L0_SIZE TMP2_L0_size
#define TEX_BIND_L0_PT TMP2_L0_pt

#define TEX_BIND_L1_TEXOFF TMP2_L1_texOff
#define TEX_BIND_L1_TEX TMP2_L1_tex
#define TEX_BIND_L1_POS TMP2_L1_pos
#define TEX_BIND_L1_SIZE TMP2_L1_size
#define TEX_BIND_L1_PT TMP2_L1_pt

const float kernels[288] = float[288](
  -0.0862170f, +0.1826950f, +0.0243011f, +0.0079659f, -0.0695841f, +0.1246755f, +0.2447606f, +0.0801791f,
  +0.2256140f, +0.0775372f, +0.1874838f, -0.1208697f, -0.1440009f, -0.1574557f, -0.0625814f, +0.0670004f,
  -0.2156621f, +0.3209183f, -0.0168025f, -0.0517209f, -0.0675880f, -0.0949333f, +0.0801386f, -0.1655256f,
  +0.1499271f, -0.1127624f, +0.1657788f, -0.0114752f, +0.1172002f, -0.1125146f, -0.0091500f, -0.2218643f,
  +0.3920516f, -0.1716475f, -0.4362981f, +0.0905398f, -1.0217949f, -0.3404253f, -0.3195911f, +0.6472417f,
  -0.2706008f, +0.4143524f, +0.0046516f, -0.0129739f, -0.2912535f, -0.2299348f, +0.1185136f, +0.2252785f,
  +0.1712283f, +0.1707003f, -0.0739461f, -0.0357624f, -0.2689738f, +0.0860198f, -0.2269253f, +0.2548570f,
  -0.0360603f, -0.2296125f, +0.0560767f, +0.0581775f, -0.7969690f, +0.1215627f, -0.2113948f, -0.1202819f,
  +0.0137653f, -0.2459404f, -0.1946596f, +0.1856410f, -0.3245078f, -0.0254916f, -0.1706000f, -0.1088763f,
  +0.0268033f, +0.0050187f, +0.1985249f, -0.0950038f, +0.1165886f, -0.0265633f, -0.2190305f, -0.0451811f,
  +0.1685069f, +0.4816811f, +0.0712240f, -0.1128992f, -0.2374246f, -0.1841764f, +0.0018012f, +0.1391671f,
  +0.2754518f, +0.1188319f, -0.0615482f, +0.0481775f, -0.5853823f, +0.1653246f, -0.2340605f, +0.1564383f,
  -0.0626610f, -0.0511645f, +0.0065984f, -0.1071326f, +0.1121752f, -0.0078127f, -0.1146507f, -0.1193011f,
  -0.3289454f, -0.1303701f, -0.1349865f, -0.3365102f, +0.5452793f, -0.0054488f, -0.9484144f, +0.1485047f,
  -0.4254213f, +0.0115773f, +0.3264321f, -0.1405942f, +0.5543980f, -0.1600123f, +0.0559854f, -0.1892111f,
  -0.1135639f, -0.0396326f, -0.1038393f, -0.0360768f, -0.0637205f, -0.0667184f, +0.0095209f, -0.0476210f,
  +0.1681884f, -0.0540210f, -0.1061925f, +0.1732589f, +0.1089472f, -0.1191159f, +0.1512652f, -0.0189617f,
  -0.1427302f, +0.1749980f, -0.2957428f, -0.0630107f, +0.0684072f, +0.0267751f, -0.0732865f, +0.0218406f,
  -0.1482964f, +0.2868686f, +0.0234694f, -0.0180208f, -0.3420776f, +0.0673824f, +0.0987782f, +0.1428845f,
  +0.0638080f, +0.1404760f, -0.2278668f, -0.0103124f, +0.0521241f, -0.1347547f, +0.0016760f, +0.1752078f,
  +0.0202092f, +0.1732901f, +0.0484314f, +0.0347413f, -0.1133894f, -0.1358028f, -0.0038735f, -0.0437286f,
  -0.3326666f, -0.2780154f, +0.1463206f, +0.1807399f, +0.2794541f, +0.0048792f, +0.3082340f, -0.3482089f,
  +0.0163484f, -0.5067446f, -0.0931318f, +0.3245377f, -0.5081407f, +0.3225807f, -0.3000284f, +0.2435543f,
  -0.2161697f, +0.2545114f, -0.1602768f, -0.0799008f, -0.2520169f, -0.2614875f, +0.0781352f, -0.0042816f,
  -0.1915197f, -0.2023865f, -0.0472320f, -0.0465529f, +0.0846758f, +0.0344746f, -0.0634890f, -0.2012538f,
  +0.0108005f, -0.1546378f, -0.0971450f, -0.1151047f, -0.1290400f, -0.1501288f, -0.2213243f, -0.3095889f,
  -0.0252127f, +0.0498006f, +0.1210029f, +0.0589931f, -0.3132592f, -0.1273112f, +0.0080117f, -0.0768934f,
  -0.0189396f, -0.0461588f, +0.1586441f, -0.1660849f, +0.0257930f, +0.0574275f, -0.1873773f, -0.0579052f,
  +0.0850618f, +0.2460689f, -0.2420332f, +0.1882127f, +0.1666502f, -0.5107410f, +0.0971066f, +0.2736375f,
  +0.0669476f, -0.2954191f, -0.1314440f, +0.2481678f, +0.1239008f, -0.0594294f, +0.0791724f, +0.1319109f,
  +0.0248841f, -0.0270241f, -0.1559588f, +0.1911650f, +0.2211248f, -0.0560921f, +0.0425569f, -0.1614840f,
  +0.1945476f, -0.5427631f, -0.5270155f, -0.2168245f, +0.0666496f, +0.5659816f, -0.1666063f, +0.3928365f,
  +0.3428209f, -0.0475376f, -0.6455728f, +0.5797929f, +0.5586132f, +0.0547758f, +0.2511243f, +0.0075489f,
  -0.1432978f, -0.0133280f, +0.1884669f, +0.0431875f, +0.4133904f, +0.0470900f, +0.2294350f, -0.1540977f,
  -0.1444221f, +0.6379926f, +0.0978147f, +0.1104943f, +0.3116090f, -0.0635529f, -0.2588536f, +0.1680986f,
  -0.0236050f, -0.1697204f, +0.1250188f, -0.0058474f, -0.1950013f, -0.1387409f, -0.0942810f, -0.3320751f
);

const float biases[4] = float[4](
  +0.0264846f, +0.0442937f, +0.0731880f, -0.0097610f
);

vec4 hook() {
    const vec4 r[9][2] = vec4[9][2](
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 1.0f)))
    );

    float sum[4] = biases;
    for (int n = 0; n < 4; n++) {
        for (int i = 0; i < 9; i++) {
            const vec4 k0 = vec4(kernels[n * 8 * 9 + 8 * i + 0], kernels[n * 8 * 9 + 8 * i + 1], kernels[n * 8 * 9 + 8 * i + 2], kernels[n * 8 * 9 + 8 * i + 3]);
            const vec4 k1 = vec4(kernels[n * 8 * 9 + 8 * i + 4], kernels[n * 8 * 9 + 8 * i + 5], kernels[n * 8 * 9 + 8 * i + 6], kernels[n * 8 * 9 + 8 * i + 7]);
            sum[n] += (dot(k0, r[i][0]) + dot(k1, r[i][1]));
        }
    }

    return ACTIVE(vec4(sum[0], sum[1], sum[2], sum[3]));
}

//!HOOK LUMA
//!DESC ARNet b16 Layer25 L1
//!WHEN OUTPUT.w LUMA.w / 1.2 > OUTPUT.h LUMA.h / 1.2 > *
//!BIND TMP2_L0
//!BIND TMP2_L1
//!SAVE TMP1_L1
//!COMPONENTS 4

#define ACTIVE(v) (max(v, v * 0.2000000f))

#define TEX_BIND_L0_TEXOFF TMP2_L0_texOff
#define TEX_BIND_L0_TEX TMP2_L0_tex
#define TEX_BIND_L0_POS TMP2_L0_pos
#define TEX_BIND_L0_SIZE TMP2_L0_size
#define TEX_BIND_L0_PT TMP2_L0_pt

#define TEX_BIND_L1_TEXOFF TMP2_L1_texOff
#define TEX_BIND_L1_TEX TMP2_L1_tex
#define TEX_BIND_L1_POS TMP2_L1_pos
#define TEX_BIND_L1_SIZE TMP2_L1_size
#define TEX_BIND_L1_PT TMP2_L1_pt

const float kernels[288] = float[288](
  -0.1884249f, -0.0566239f, +0.0656314f, -0.0795245f, -0.2214327f, -0.1010701f, +0.1139664f, +0.0971776f,
  -0.0354592f, +0.4847888f, +0.1453914f, -0.1834913f, +0.0166500f, -0.3933814f, -0.0065499f, +0.1720620f,
  +0.1271616f, +0.1629421f, -0.2533565f, +0.2612961f, +0.1368524f, +0.1891611f, -0.1583963f, +0.1062889f,
  +0.0270416f, -0.0539220f, -0.2765737f, -0.2946544f, +0.0680712f, +0.0366014f, -0.2596713f, -0.0003091f,
  +0.0645402f, -0.2400044f, -0.3124440f, -0.9203299f, -0.2788293f, +0.2543048f, -0.6163703f, -0.3934891f,
  -0.1167039f, +0.2576538f, +0.1719329f, -0.0730765f, -0.1593441f, -0.0800186f, -0.1436723f, -0.1031235f,
  -0.1337918f, +0.0935164f, +0.0846929f, +0.1686382f, +0.4105002f, -0.2068465f, +0.1902791f, +0.0049051f,
  +0.1913694f, +0.0597902f, +0.0513328f, +0.1078381f, +0.1269871f, -0.0190995f, +0.3063365f, +0.3229108f,
  -0.0838765f, +0.1542169f, -0.0914381f, -0.0159941f, -0.2314951f, +0.1142187f, +0.2752579f, -0.0818418f,
  -0.0250468f, -0.2625711f, -0.2910736f, +0.2484484f, +0.2264690f, +0.0795445f, -0.0244354f, +0.0030138f,
  +0.0424776f, +0.2606905f, +0.2320513f, -0.0740319f, -0.3181461f, -0.0312270f, +0.1439395f, +0.0844374f,
  +0.0091306f, -0.1870502f, -0.0840389f, -0.0822182f, +0.0923543f, -0.1352944f, +0.3417607f, -0.0680208f,
  +0.3381797f, +0.0258389f, -0.2851921f, +0.2124945f, +0.3307495f, -0.0621457f, -0.0151308f, +0.1011368f,
  -0.2574739f, +1.0831550f, +0.5298080f, -0.0956814f, -0.5176290f, +0.4442911f, +0.9201600f, +0.2037212f,
  -0.5086967f, -0.8045807f, -0.4310310f, +0.0214874f, -0.0263688f, +0.0843422f, -0.0433673f, -0.2278195f,
  +0.3285067f, +0.0627381f, +0.1287769f, +0.0710051f, -0.0062201f, +0.0586550f, -0.0221348f, +0.0291324f,
  -0.3162445f, +0.1131599f, +0.1717798f, +0.1711650f, +0.0883117f, +0.1195692f, +0.3093462f, -0.0005791f,
  -0.1010369f, -0.3643720f, -0.1293994f, -0.0369466f, +0.1012078f, +0.1831546f, -0.1255631f, -0.2091213f,
  +0.2514273f, -0.1213364f, +0.2473074f, -0.1072235f, +0.1091977f, -0.1246764f, -0.1305416f, -0.0711953f,
  -0.3292852f, -0.1443838f, +0.2529317f, -0.0337677f, -0.0534526f, -0.0730015f, -0.0842059f, -0.4579260f,
  -0.3656027f, +0.2652271f, +0.1713584f, -0.2758643f, -0.0273747f, -0.0420318f, +0.2267035f, -0.3176741f,
  +0.0634371f, +0.2494735f, -0.2913355f, -0.1945172f, -0.5117281f, +0.2231905f, -0.4743113f, +0.2732866f,
  -0.5080479f, -0.2023297f, -0.1536771f, +0.4622625f, +0.6956466f, -0.1014761f, +0.2961631f, -0.0699141f,
  -0.2360909f, +0.2113181f, +0.1976983f, -0.2071041f, -0.1509691f, +0.1996248f, +0.0850797f, +0.1116417f,
  +0.0244263f, -0.0967566f, -0.0591407f, -0.0058493f, +0.1302816f, -0.0995294f, +0.0321948f, -0.0260910f,
  +0.0482026f, +0.1385310f, -0.0156187f, -0.0235909f, +0.1942306f, -0.0548535f, +0.0035634f, -0.1094686f,
  -0.0811484f, +0.0291891f, +0.0641077f, -0.0339290f, +0.0979678f, +0.0811504f, -0.1557695f, +0.1523978f,
  +0.2824527f, +0.0389177f, -0.0048256f, -0.1259098f, +0.2782530f, -0.1424782f, -0.1480052f, -0.0323853f,
  -0.0838778f, +0.0098940f, +0.0497095f, -0.2829331f, -0.3759149f, -0.8508462f, -0.0787142f, +0.2555967f,
  +0.0814111f, -0.0149622f, -0.0752323f, +0.0005364f, +0.1579091f, +0.3616443f, -0.1129408f, -0.0431308f,
  +0.2690727f, +0.0579014f, +0.1305621f, -0.0657053f, +0.2223226f, -0.1208755f, -0.2494575f, +0.1385166f,
  +0.5042329f, +0.0463840f, +0.6862255f, -0.4049069f, -0.5276710f, -0.0067438f, +0.1058769f, +0.1206452f,
  -0.5755838f, -0.1839138f, -0.0283020f, +0.0211424f, -0.0633245f, +0.1850752f, -0.1725324f, -0.1881536f,
  +0.0588413f, -0.0012903f, -0.1210053f, -0.0496837f, -0.1634747f, -0.0439142f, -0.1325332f, +0.0588016f,
  +0.0342854f, -0.0443835f, +0.1922626f, +0.0358857f, -0.0577949f, +0.0563671f, -0.0869367f, +0.3502989f,
  -0.1328644f, -0.1693584f, -0.2078649f, +0.0887095f, +0.0032067f, +0.2091918f, -0.0745260f, -0.1479814f
);

const float biases[4] = float[4](
  +0.0525495f, -0.0211650f, +0.0332662f, +0.0527511f
);

vec4 hook() {
    const vec4 r[9][2] = vec4[9][2](
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 1.0f)))
    );

    float sum[4] = biases;
    for (int n = 0; n < 4; n++) {
        for (int i = 0; i < 9; i++) {
            const vec4 k0 = vec4(kernels[n * 8 * 9 + 8 * i + 0], kernels[n * 8 * 9 + 8 * i + 1], kernels[n * 8 * 9 + 8 * i + 2], kernels[n * 8 * 9 + 8 * i + 3]);
            const vec4 k1 = vec4(kernels[n * 8 * 9 + 8 * i + 4], kernels[n * 8 * 9 + 8 * i + 5], kernels[n * 8 * 9 + 8 * i + 6], kernels[n * 8 * 9 + 8 * i + 7]);
            sum[n] += (dot(k0, r[i][0]) + dot(k1, r[i][1]));
        }
    }

    return ACTIVE(vec4(sum[0], sum[1], sum[2], sum[3]));
}

//!HOOK LUMA
//!DESC ARNet b16 Layer26 L0
//!WHEN OUTPUT.w LUMA.w / 1.2 > OUTPUT.h LUMA.h / 1.2 > *
//!BIND TMP1_L0
//!BIND TMP1_L1
//!BIND TMP2_L0
//!SAVE TMP2_L0
//!COMPONENTS 4

#define ACTIVE(v) (v)

#define TEX_BIND_L0_TEXOFF TMP1_L0_texOff
#define TEX_BIND_L0_TEX TMP1_L0_tex
#define TEX_BIND_L0_POS TMP1_L0_pos
#define TEX_BIND_L0_SIZE TMP1_L0_size
#define TEX_BIND_L0_PT TMP1_L0_pt

#define TEX_BIND_L1_TEXOFF TMP1_L1_texOff
#define TEX_BIND_L1_TEX TMP1_L1_tex
#define TEX_BIND_L1_POS TMP1_L1_pos
#define TEX_BIND_L1_SIZE TMP1_L1_size
#define TEX_BIND_L1_PT TMP1_L1_pt

#define TEX_BIND_L2_TEXOFF TMP2_L0_texOff
#define TEX_BIND_L2_TEX TMP2_L0_tex
#define TEX_BIND_L2_POS TMP2_L0_pos
#define TEX_BIND_L2_SIZE TMP2_L0_size
#define TEX_BIND_L2_PT TMP2_L0_pt

const float kernels[288] = float[288](
  +0.0460836f, -0.1209024f, +0.0044238f, -0.0093832f, +0.0787525f, -0.0149661f, +0.1077150f, -0.0560029f,
  +0.0934464f, -0.0441251f, -0.4798289f, +0.3835084f, -0.1849176f, +0.1763082f, -0.0064716f, -0.1845928f,
  -0.0603087f, +0.0332005f, +0.0807664f, -0.0328066f, +0.1356702f, +0.3444210f, +0.1067446f, -0.0132119f,
  +0.2104844f, +0.0349951f, -0.0740439f, -0.6728353f, -0.0376721f, -0.3725997f, +0.1292842f, +0.3207483f,
  -0.3210852f, -0.0135402f, +0.0672336f, -0.0766855f, -0.0577595f, -0.1039286f, +0.2451336f, -0.1778568f,
  -0.1847727f, +0.0143168f, +0.0438357f, -0.0382677f, -0.2123628f, -0.0431356f, -0.0321930f, +0.2863599f,
  -0.1133248f, -0.2266070f, +0.1753626f, -0.0862081f, -0.0175820f, +0.1321137f, -0.0955561f, -0.2789599f,
  -0.1482532f, -0.1241461f, +0.1657505f, +0.2910831f, -0.0286285f, -0.0691534f, -0.0146928f, +0.3888987f,
  -0.0287446f, -0.0352878f, -0.1674651f, +0.0262981f, -0.0681719f, +0.0889097f, -0.1388836f, +0.0656911f,
  +0.1099460f, -0.0267008f, +0.1373187f, +0.0578276f, +0.0360869f, +0.0517855f, -0.0535712f, +0.0659243f,
  +0.0951792f, +0.2038842f, -0.0145417f, -0.2029517f, -0.3492947f, -0.0351295f, -0.2270926f, -0.1650786f,
  -0.2328093f, +0.0410944f, +0.1172578f, -0.0065684f, +0.0051753f, -0.0679627f, +0.0708164f, +0.1397679f,
  -0.1163597f, -0.2469083f, -0.1372851f, +0.4178396f, -0.1344260f, +0.2376160f, -0.3490875f, +0.1498529f,
  -0.0608320f, +0.4124885f, +0.5443650f, +0.0682064f, -0.0995340f, -0.1051965f, +0.2599943f, +0.2976438f,
  +0.2246143f, -0.1248792f, +0.1664252f, +0.0662930f, -0.1998535f, -0.0063770f, -0.2875394f, +0.0368630f,
  -0.3749133f, -0.1967938f, -0.0932778f, +0.2984601f, -0.1613303f, +0.5188853f, -0.5479661f, -0.0741617f,
  +0.1538806f, -0.2917337f, -0.0767354f, +0.2718255f, -0.2730167f, -0.7403092f, +0.0032636f, +0.0537502f,
  -0.0524104f, +0.0380110f, -0.2462810f, +0.0075002f, -0.2835205f, -0.2468773f, +0.0834230f, +0.1939992f,
  -0.0619869f, +0.0823164f, -0.0962302f, -0.4659322f, -0.0220905f, +0.0019426f, -0.0117915f, +0.0189798f,
  -0.3278727f, -0.1877990f, -0.1021638f, +0.1242964f, +0.2097294f, +0.0421138f, -0.1785204f, -0.1532939f,
  -0.2254738f, +0.0784963f, +0.1407302f, -0.0537107f, -0.0771077f, +0.2355695f, +0.2106277f, +0.0293957f,
  -0.3660185f, -0.0319710f, +0.0016510f, +0.1415413f, -0.1345075f, -0.2461524f, -0.1700444f, -0.1761458f,
  +0.6231906f, +0.2089998f, +0.1224175f, -0.4852607f, +0.5226930f, +0.6400178f, +0.1025732f, -0.8907211f,
  +0.0868722f, +0.0638080f, -0.0626117f, +0.1436878f, +0.0671494f, -0.1084764f, +0.0081831f, -0.0028242f,
  -0.2524736f, +0.1774193f, +0.0447374f, +0.0653603f, +0.0394965f, +0.1752366f, -0.0587835f, +0.2635615f,
  -0.1413021f, +0.0444700f, +0.2383369f, -0.0799339f, -0.0305008f, +0.2932595f, -0.2426104f, -0.0659373f,
  +0.0068758f, -0.0205610f, -0.2664453f, -0.0813424f, -0.1061989f, -0.2812943f, -0.2354884f, -0.0976570f,
  -0.1549456f, +0.0457955f, -0.1213777f, -1.0098455f, +0.1070288f, +0.0143945f, -0.2382463f, +0.1541680f,
  +0.2027227f, -0.1481374f, -0.1674408f, +0.3834101f, -0.1215877f, +0.0024131f, -0.0833283f, -0.2044138f,
  -0.1381226f, -0.1614840f, +0.2004296f, -0.1328539f, -0.1030419f, +0.0344001f, +0.0875926f, +0.1921526f,
  +0.1541026f, -0.0088880f, +0.2210001f, +0.1942119f, +0.1751138f, +0.3335576f, -0.0894518f, -0.0051185f,
  -0.2715393f, +0.4886582f, -0.2127429f, -0.3285573f, +0.8124096f, -0.2485967f, -0.5655962f, +0.0134869f,
  +0.0613210f, -0.2452082f, +0.0166406f, +0.2033865f, +0.2635980f, -0.2710215f, +0.0742607f, +0.1862789f,
  -0.0656687f, +0.0308436f, +0.1129995f, -0.0664097f, -0.0469089f, +0.0404422f, -0.0661355f, +0.0009841f,
  +0.1341799f, +0.0276303f, +0.1526116f, +0.0029637f, +0.1562705f, -0.3399467f, +0.2330325f, +0.2112653f,
  -0.0449462f, +0.2627223f, -0.2111506f, -0.1750049f, -0.1240208f, -0.1155566f, -0.1964840f, +0.1893210f
);

const float biases[4] = float[4](
  +0.0492897f, +0.0116982f, +0.0230777f, -0.1833140f
);

vec4 hook() {
    const vec4 r[9][2] = vec4[9][2](
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 1.0f)))
    );

    float sum[4] = biases;
    for (int n = 0; n < 4; n++) {
        for (int i = 0; i < 9; i++) {
            const vec4 k0 = vec4(kernels[n * 8 * 9 + 8 * i + 0], kernels[n * 8 * 9 + 8 * i + 1], kernels[n * 8 * 9 + 8 * i + 2], kernels[n * 8 * 9 + 8 * i + 3]);
            const vec4 k1 = vec4(kernels[n * 8 * 9 + 8 * i + 4], kernels[n * 8 * 9 + 8 * i + 5], kernels[n * 8 * 9 + 8 * i + 6], kernels[n * 8 * 9 + 8 * i + 7]);
            sum[n] += (dot(k0, r[i][0]) + dot(k1, r[i][1]));
        }
    }

    return ACTIVE(vec4(sum[0], sum[1], sum[2], sum[3]) * 0.2000000f + TEX_BIND_L2_TEXOFF(vec2(0.0f, 0.0f)));
}

//!HOOK LUMA
//!DESC ARNet b16 Layer26 L1
//!WHEN OUTPUT.w LUMA.w / 1.2 > OUTPUT.h LUMA.h / 1.2 > *
//!BIND TMP1_L0
//!BIND TMP1_L1
//!BIND TMP2_L1
//!SAVE TMP2_L1
//!COMPONENTS 4

#define ACTIVE(v) (v)

#define TEX_BIND_L0_TEXOFF TMP1_L0_texOff
#define TEX_BIND_L0_TEX TMP1_L0_tex
#define TEX_BIND_L0_POS TMP1_L0_pos
#define TEX_BIND_L0_SIZE TMP1_L0_size
#define TEX_BIND_L0_PT TMP1_L0_pt

#define TEX_BIND_L1_TEXOFF TMP1_L1_texOff
#define TEX_BIND_L1_TEX TMP1_L1_tex
#define TEX_BIND_L1_POS TMP1_L1_pos
#define TEX_BIND_L1_SIZE TMP1_L1_size
#define TEX_BIND_L1_PT TMP1_L1_pt

#define TEX_BIND_L2_TEXOFF TMP2_L1_texOff
#define TEX_BIND_L2_TEX TMP2_L1_tex
#define TEX_BIND_L2_POS TMP2_L1_pos
#define TEX_BIND_L2_SIZE TMP2_L1_size
#define TEX_BIND_L2_PT TMP2_L1_pt

const float kernels[288] = float[288](
  +0.1214049f, +0.1538882f, +0.1137257f, -0.3893743f, +0.1834797f, +0.0978667f, -0.0531841f, +0.1072679f,
  +0.4477760f, -0.1074967f, +0.0699541f, +0.3420703f, -0.1898722f, -0.3657517f, -0.1718878f, +0.0904297f,
  +0.2676670f, +0.0205721f, -0.3107965f, -0.1346017f, -0.2487574f, -0.1091318f, -0.1154730f, -0.0456080f,
  -0.0885449f, -0.3129672f, +0.3294869f, -0.1781185f, +0.1067815f, -0.1482410f, -0.0627282f, -0.0345018f,
  +0.3179814f, -0.6347253f, +0.1470246f, +0.3675791f, +0.1103197f, -0.3743418f, -0.4067422f, +0.5319824f,
  -0.2727386f, -0.0572882f, +0.0730689f, +0.0579547f, -0.0823046f, +0.1290758f, +0.4126040f, -0.0439929f,
  -0.0573905f, -0.0278495f, +0.0743253f, -0.0247331f, -0.1292242f, +0.0067119f, +0.0580176f, -0.0290322f,
  +0.0636049f, +0.1591813f, -0.2020582f, -0.0589401f, +0.0208204f, +0.0818857f, -0.1628530f, +0.0409952f,
  +0.1603330f, +0.0942016f, +0.0743790f, +0.1058332f, +0.0648258f, +0.1969268f, +0.1158502f, -0.1726459f,
  +0.0839871f, +0.0119009f, -0.0612628f, +0.5605597f, -0.0892066f, +0.0021233f, +0.0140495f, -0.1681868f,
  -0.2202667f, +0.0891522f, +0.0773098f, -0.1378084f, +0.0426340f, +0.2262020f, +0.0383981f, -0.0726286f,
  -0.0473491f, +0.0749479f, +0.0458537f, +0.0637932f, +0.0347538f, +0.0913293f, -0.0017197f, -0.0380471f,
  +0.1524476f, -0.1148188f, -0.0747356f, -0.2295861f, -0.0799779f, -0.0581432f, +0.2182883f, -0.1448292f,
  +0.0721021f, -0.0012968f, -0.3926950f, +0.3490790f, -0.3539188f, +0.1217566f, +0.2090444f, +0.0858175f,
  +0.1419341f, +0.0525955f, +0.0802828f, -0.0234912f, -0.0521610f, -0.1255616f, -0.0992554f, +0.0817654f,
  +0.3339865f, +0.2049710f, -0.1166248f, -0.1580243f, -0.1870766f, -0.4002056f, +0.0077294f, -0.2271297f,
  +0.1418990f, +0.1304662f, +0.1776086f, +0.3453909f, +0.1174313f, -0.1563305f, +0.2168750f, +0.6679178f,
  -0.0363593f, +0.1100082f, -0.0214210f, -0.1060972f, -0.1138463f, +0.1515898f, -0.0197859f, +0.2907381f,
  +0.2941845f, +0.1414919f, -0.1347963f, -0.1166134f, -0.0113784f, -0.2100711f, +0.1160605f, +0.0862312f,
  -0.0297301f, -0.0756128f, +0.0111131f, +0.2400524f, -0.1375931f, +0.1606333f, -0.2368479f, -0.0186843f,
  +0.1228992f, -0.0298309f, -0.1979925f, -0.0754344f, +0.0633474f, +0.2700671f, +0.0316523f, -0.0979526f,
  -0.0426907f, -0.2707177f, -0.0883626f, -0.7306474f, +0.0578978f, -0.0776000f, -0.0932815f, +0.0228538f,
  +0.0575447f, +0.6025499f, -0.1813008f, +0.3957680f, +0.1859511f, +0.7161366f, -0.3067333f, -0.4724183f,
  -0.1083549f, +0.1290008f, -0.2659637f, -0.1936815f, +0.0902860f, -0.4630517f, +0.2447800f, +0.3472026f,
  +0.0317262f, +0.2287427f, +0.2057269f, +0.0822480f, +0.1643340f, +0.0786683f, -0.1959247f, -0.0786571f,
  -0.0291569f, -0.0028344f, +0.0733548f, +0.2418053f, +0.1206538f, +0.0029275f, -0.2502042f, +0.0907534f,
  -0.1798054f, +0.0688304f, +0.2371134f, +0.0460098f, -0.0379031f, -0.0377443f, -0.1262331f, +0.0626375f,
  -0.0323171f, +0.0725705f, +0.0756726f, +0.2234358f, -0.0167996f, +0.1995459f, +0.0338629f, -0.0201846f,
  +0.0187587f, +0.1031124f, +0.2403961f, -0.1284811f, +0.1610955f, -0.1333982f, -0.0119488f, -0.0002635f,
  -0.0963988f, -0.0272550f, +0.2555663f, +0.0165063f, -0.1575560f, -0.1240237f, -0.1197004f, -0.0364002f,
  -0.0111568f, -0.0612410f, +0.1285836f, -0.6080837f, +0.0990128f, -0.1261003f, -0.0378877f, +0.2570637f,
  +0.0227829f, -0.2590100f, -0.0661953f, +0.2028028f, +0.5184861f, -0.2759301f, +0.3083878f, -0.0905774f,
  -0.0237494f, +0.1576403f, +0.1420922f, -0.0416795f, -0.1770090f, +0.1698998f, -0.0710469f, -0.0937572f,
  +0.0724620f, -0.0851973f, +0.3061184f, -0.1256477f, +0.1159633f, -0.0261751f, +0.1840806f, +0.0119206f,
  -0.1919248f, -0.3807444f, -0.2498035f, -0.0548925f, +0.1425830f, +0.2548829f, +0.3545302f, -0.1356794f,
  -0.0100252f, -0.0486772f, +0.1971856f, +0.0355467f, -0.0303095f, -0.0642898f, -0.0068972f, -0.1525898f
);

const float biases[4] = float[4](
  -0.0294770f, +0.0764372f, -0.0734185f, -0.0548438f
);

vec4 hook() {
    const vec4 r[9][2] = vec4[9][2](
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 1.0f)))
    );

    float sum[4] = biases;
    for (int n = 0; n < 4; n++) {
        for (int i = 0; i < 9; i++) {
            const vec4 k0 = vec4(kernels[n * 8 * 9 + 8 * i + 0], kernels[n * 8 * 9 + 8 * i + 1], kernels[n * 8 * 9 + 8 * i + 2], kernels[n * 8 * 9 + 8 * i + 3]);
            const vec4 k1 = vec4(kernels[n * 8 * 9 + 8 * i + 4], kernels[n * 8 * 9 + 8 * i + 5], kernels[n * 8 * 9 + 8 * i + 6], kernels[n * 8 * 9 + 8 * i + 7]);
            sum[n] += (dot(k0, r[i][0]) + dot(k1, r[i][1]));
        }
    }

    return ACTIVE(vec4(sum[0], sum[1], sum[2], sum[3]) * 0.2000000f + TEX_BIND_L2_TEXOFF(vec2(0.0f, 0.0f)));
}

//!HOOK LUMA
//!DESC ARNet b16 Layer27 L0
//!WHEN OUTPUT.w LUMA.w / 1.2 > OUTPUT.h LUMA.h / 1.2 > *
//!BIND TMP2_L0
//!BIND TMP2_L1
//!SAVE TMP1_L0
//!COMPONENTS 4

#define ACTIVE(v) (max(v, v * 0.2000000f))

#define TEX_BIND_L0_TEXOFF TMP2_L0_texOff
#define TEX_BIND_L0_TEX TMP2_L0_tex
#define TEX_BIND_L0_POS TMP2_L0_pos
#define TEX_BIND_L0_SIZE TMP2_L0_size
#define TEX_BIND_L0_PT TMP2_L0_pt

#define TEX_BIND_L1_TEXOFF TMP2_L1_texOff
#define TEX_BIND_L1_TEX TMP2_L1_tex
#define TEX_BIND_L1_POS TMP2_L1_pos
#define TEX_BIND_L1_SIZE TMP2_L1_size
#define TEX_BIND_L1_PT TMP2_L1_pt

const float kernels[288] = float[288](
  +0.0344352f, +0.0640002f, +0.0933243f, -0.2279507f, +0.0639124f, -0.2990744f, -0.0788022f, -0.0077604f,
  -0.0028298f, -0.1285346f, +0.1077000f, +0.0097835f, +0.0517479f, -0.1193636f, -0.2486035f, +0.0583679f,
  -0.0146388f, +0.3150238f, -0.0252812f, -0.0882630f, -0.1891742f, -0.0873079f, +0.1073095f, -0.0846827f,
  -0.1603106f, +0.0081724f, +0.0256116f, -0.3304093f, +0.5648253f, -0.0458871f, -0.4007998f, -0.0369236f,
  +0.4110455f, -0.2691023f, +0.5958184f, -0.0653709f, -0.7997167f, -0.3210439f, -0.2235533f, +0.1301418f,
  -0.3220250f, -0.0011362f, -0.1579631f, +0.1904496f, -0.3426558f, +0.3835378f, -0.3809432f, +0.0661779f,
  -0.0439471f, -0.0840895f, +0.1322808f, +0.0004514f, +0.1422252f, +0.0103788f, +0.1281678f, -0.1971728f,
  +0.0406866f, -0.2070878f, -0.2076182f, -0.0926597f, +0.0540538f, -0.3055292f, -0.4743713f, +0.1457473f,
  -0.0924183f, +0.0089791f, +0.1729813f, +0.0407752f, +0.0787231f, +0.2242270f, -0.1105276f, +0.0852154f,
  +0.4696647f, +0.7439969f, -0.0648017f, +0.3087582f, -0.0778150f, +0.6472492f, +0.1307469f, +0.0950805f,
  +0.2634715f, +0.3883276f, -0.0723111f, -0.0560181f, -0.7370009f, -0.1788492f, +0.3547547f, -0.1439986f,
  +0.2210240f, -0.1175013f, +0.1974540f, -0.1822078f, +0.0523199f, -0.0401948f, -0.0694920f, +0.1190504f,
  +0.3499866f, +0.9730260f, +0.2503151f, +0.0886666f, +0.2952934f, -0.0096375f, +0.5132747f, +0.0349071f,
  -1.0524479f, +0.4665844f, +0.2905044f, +0.3481581f, +0.5063614f, +0.4162458f, +0.5402658f, -0.1721457f,
  +0.2009509f, +0.0900012f, -0.2673258f, +0.0509934f, -0.3551829f, -0.0890315f, -0.2107370f, +0.0614066f,
  -0.2089228f, +0.4097751f, +0.2180157f, +0.0046713f, -0.0380960f, -0.0170012f, +0.0955858f, +0.2512599f,
  -0.3483004f, +0.0469134f, +0.0396265f, -0.0765091f, +0.0000033f, +0.0892698f, +0.0951106f, -0.0065363f,
  +0.4597193f, +0.2899845f, +0.1108497f, -0.0875144f, +0.8200668f, +0.3585616f, -0.1277995f, -0.0826644f,
  -0.1665216f, -0.1473547f, +0.1039653f, -0.0419823f, -0.0147048f, -0.1791542f, -0.1552495f, -0.0820514f,
  -0.2010361f, +0.4163223f, -0.0247391f, -0.1045522f, -0.0212171f, +0.0253598f, +0.0875879f, -0.0761178f,
  +0.1242548f, +0.1100479f, -0.1151990f, -0.1600240f, +0.2284666f, +0.5413661f, -0.3871935f, -0.1182467f,
  -0.2022633f, -0.1419383f, -0.0330851f, -0.1232159f, +0.2709175f, -0.0819112f, -0.2372709f, -0.1446819f,
  -0.1234477f, +0.0064200f, -0.0970128f, -0.0112102f, +0.3049699f, -0.2616064f, -0.2694403f, +0.3535188f,
  +0.3751749f, -0.1753349f, +0.2502578f, -0.0559507f, +0.0055228f, +0.3328771f, -0.5405852f, +0.1358635f,
  -0.1313966f, -0.0806736f, +0.0621968f, +0.0463154f, +0.1441907f, -0.0163825f, +0.2094384f, -0.2619947f,
  +0.0601363f, -0.0471010f, -0.3333388f, -0.0834262f, -0.3055675f, -0.3889042f, -0.4514061f, +0.0559356f,
  -0.1330974f, -0.0077014f, +0.1543015f, +0.0028359f, +0.4497643f, -0.0380976f, +0.0204509f, +0.1103640f,
  -0.0008162f, +0.0292576f, +0.1492303f, +0.0154624f, -0.0512867f, -0.0442284f, +0.1264658f, -0.0658494f,
  +0.1205922f, +0.1161549f, +0.0852335f, -0.0696825f, -0.1756326f, -0.3234590f, +0.0744292f, +0.1398120f,
  -0.0066313f, +0.2875085f, +0.0362642f, -0.0661815f, +0.0163522f, -0.0387102f, +0.1233686f, -0.0435990f,
  +0.1014768f, +0.2024247f, -0.0185560f, -0.0396794f, +0.0577563f, +0.2686315f, +0.0441950f, -0.2899666f,
  -0.0222560f, -0.3050362f, +0.0698348f, -0.4099576f, -0.0622245f, -0.0455097f, -0.2632263f, -0.0893407f,
  -0.1740425f, +0.0241509f, -0.0474195f, -0.1990325f, +0.1908505f, -0.0351975f, -0.2067853f, -0.0153615f,
  -0.2091940f, +0.0394296f, +0.2955148f, +0.0454772f, +0.7024809f, -0.0940107f, +0.3274352f, -0.0186496f,
  -0.0478297f, -0.0963518f, +0.8565360f, +0.3700662f, -0.1393212f, +0.0800907f, +1.1198305f, +0.5420981f,
  -0.0637783f, -0.2750267f, -0.0335111f, +0.1831704f, -0.0328852f, +0.2657160f, +0.0841823f, -0.0427778f
);

const float biases[4] = float[4](
  +0.0139520f, -0.1741800f, -0.0035312f, +0.0376354f
);

vec4 hook() {
    const vec4 r[9][2] = vec4[9][2](
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 1.0f)))
    );

    float sum[4] = biases;
    for (int n = 0; n < 4; n++) {
        for (int i = 0; i < 9; i++) {
            const vec4 k0 = vec4(kernels[n * 8 * 9 + 8 * i + 0], kernels[n * 8 * 9 + 8 * i + 1], kernels[n * 8 * 9 + 8 * i + 2], kernels[n * 8 * 9 + 8 * i + 3]);
            const vec4 k1 = vec4(kernels[n * 8 * 9 + 8 * i + 4], kernels[n * 8 * 9 + 8 * i + 5], kernels[n * 8 * 9 + 8 * i + 6], kernels[n * 8 * 9 + 8 * i + 7]);
            sum[n] += (dot(k0, r[i][0]) + dot(k1, r[i][1]));
        }
    }

    return ACTIVE(vec4(sum[0], sum[1], sum[2], sum[3]));
}

//!HOOK LUMA
//!DESC ARNet b16 Layer27 L1
//!WHEN OUTPUT.w LUMA.w / 1.2 > OUTPUT.h LUMA.h / 1.2 > *
//!BIND TMP2_L0
//!BIND TMP2_L1
//!SAVE TMP1_L1
//!COMPONENTS 4

#define ACTIVE(v) (max(v, v * 0.2000000f))

#define TEX_BIND_L0_TEXOFF TMP2_L0_texOff
#define TEX_BIND_L0_TEX TMP2_L0_tex
#define TEX_BIND_L0_POS TMP2_L0_pos
#define TEX_BIND_L0_SIZE TMP2_L0_size
#define TEX_BIND_L0_PT TMP2_L0_pt

#define TEX_BIND_L1_TEXOFF TMP2_L1_texOff
#define TEX_BIND_L1_TEX TMP2_L1_tex
#define TEX_BIND_L1_POS TMP2_L1_pos
#define TEX_BIND_L1_SIZE TMP2_L1_size
#define TEX_BIND_L1_PT TMP2_L1_pt

const float kernels[288] = float[288](
  -0.2613319f, -0.1173505f, -0.1616379f, +0.0321040f, -0.0514267f, +0.1150955f, -0.1025366f, -0.0517866f,
  -0.0363972f, +0.1259897f, -0.0847245f, +0.0929327f, +0.2593139f, +0.4111128f, +0.0418906f, -0.1723605f,
  -0.1768132f, +0.0614253f, -0.1780142f, +0.1166073f, +0.1754837f, +0.3787247f, +0.0167354f, -0.0340232f,
  -0.2705550f, +0.1531995f, -0.0992501f, -0.2122573f, -0.1302878f, -0.0790887f, -0.1531507f, -0.0480307f,
  -0.2638785f, +0.2932661f, +0.0280710f, -0.1793168f, -0.6467492f, -0.1300658f, -0.1232248f, +0.1969110f,
  +0.0276995f, -0.1000069f, +0.1425813f, -0.1968040f, -0.8532656f, -0.2283504f, -0.1066825f, -0.0509569f,
  +0.1123734f, -0.1764457f, -0.0746457f, -0.0333714f, +0.4072139f, -0.0716699f, -0.0770060f, -0.1201600f,
  +0.1259347f, -0.1633694f, -0.2320988f, +0.3418610f, -0.3635336f, -0.1507258f, -0.4042661f, +0.2288014f,
  +0.0789832f, +0.3182555f, -0.2044542f, +0.0066978f, -0.1452954f, -0.0573679f, -0.0830211f, +0.0008622f,
  +0.0905834f, +0.1207263f, +0.1261025f, -0.0172457f, -0.1821572f, -0.0634918f, +0.2201327f, +0.0276455f,
  +0.0835787f, +0.0294912f, +0.4463974f, +0.0176381f, +0.2536612f, +0.0875784f, +0.5004581f, -0.2544226f,
  -0.3474624f, +0.2944596f, +0.3278681f, -0.0908964f, +0.5698904f, +0.6134288f, +0.2294402f, -0.1919818f,
  +0.0396485f, +0.1070191f, +0.0201006f, -0.1290638f, +0.1666791f, +0.2039580f, -0.1460464f, -0.0023880f,
  -0.0557953f, -0.0989152f, +0.0730014f, +0.3709019f, -0.0857088f, +0.0295331f, +0.0915949f, +0.0262645f,
  +0.4040016f, +0.0246141f, -0.0254999f, -0.1341393f, +0.7806519f, +0.4761049f, +0.2422778f, +0.1592074f,
  -0.5046340f, +0.0973059f, +0.1374552f, +0.0147149f, +0.3415810f, -0.2847005f, +0.3106222f, -0.1058636f,
  -0.0617224f, +0.0936705f, +0.0103989f, +0.2092410f, +0.3757650f, +0.0010324f, +0.5879049f, -0.2792842f,
  +0.1291881f, +0.5875038f, +0.3694375f, -0.4199588f, +0.5676470f, +0.3376207f, +0.0852413f, +0.2078214f,
  +0.4968133f, +0.2513751f, +0.0014479f, -0.3514706f, +0.1493122f, +0.1253836f, +0.1262329f, +0.2575366f,
  +0.2028309f, +0.3448308f, +0.0884069f, -0.2784680f, +1.0578494f, +0.8857476f, -0.1908851f, -0.2620381f,
  -0.1465918f, +0.1925351f, -0.1546400f, +0.4393245f, +0.8580254f, +0.0062586f, -0.0540456f, -0.0501932f,
  -0.5049208f, +0.2963963f, +0.1351243f, +0.5129205f, +0.0419685f, -0.0287326f, +0.2839653f, +0.1080417f,
  -0.1198653f, -0.5356607f, -0.3597459f, +0.7899730f, +0.2008555f, -0.7144101f, +0.6556023f, -0.0397660f,
  -0.1542117f, +0.0718695f, +0.0058771f, -0.1960437f, +0.1477932f, +0.1676898f, +0.0872165f, -0.1028325f,
  +0.0981814f, -0.2039090f, -0.2964137f, +0.1013196f, -0.0450966f, -0.0712343f, -0.1675332f, -0.0224969f,
  +0.0695831f, +0.1476762f, +0.0419261f, -0.0930330f, -0.1358308f, +0.0823533f, -0.1574372f, -0.1929010f,
  +0.1473705f, -0.1821079f, +0.0353330f, +0.1038698f, +0.0092928f, -0.1074516f, -0.0783983f, +0.1043799f,
  -0.1867972f, -0.0454460f, -0.3142474f, +0.2596125f, -0.1542221f, +0.0737803f, +0.2171125f, +0.4816006f,
  +0.1994181f, +0.0391001f, +0.3063249f, -0.0392744f, +0.5967115f, +0.1792422f, -0.1840178f, -0.3194980f,
  -0.0868608f, +0.0046162f, -0.0941293f, +0.1587189f, +0.3731890f, +0.0297303f, +0.0073068f, -0.0189890f,
  +0.8696137f, -0.4205501f, -0.1287787f, +0.1576256f, -0.8307599f, +0.2227397f, +0.1113187f, +0.0654391f,
  +0.2823116f, +0.4758517f, +0.0062633f, -0.2366105f, -0.8422998f, -0.4614001f, +0.1187646f, -0.1263111f,
  -0.0571950f, -0.4251214f, +0.3402737f, +0.0690610f, +0.0386843f, +0.1617020f, +0.0252590f, -0.0116129f,
  +0.0597391f, +0.3755815f, -0.1364992f, -0.1263879f, -0.4316957f, -0.2669895f, -0.3774564f, +0.3839922f,
  -0.2266885f, +0.1703537f, -0.0021869f, +0.0714040f, +0.0144963f, -0.2065030f, +0.2229521f, -0.1400421f,
  +0.0183984f, -0.1425554f, -0.0718151f, -0.0057427f, -0.0772361f, +0.1304054f, -0.1375518f, +0.0683597f
);

const float biases[4] = float[4](
  +0.0006606f, -0.0355224f, -0.0241916f, -0.0319466f
);

vec4 hook() {
    const vec4 r[9][2] = vec4[9][2](
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 1.0f)))
    );

    float sum[4] = biases;
    for (int n = 0; n < 4; n++) {
        for (int i = 0; i < 9; i++) {
            const vec4 k0 = vec4(kernels[n * 8 * 9 + 8 * i + 0], kernels[n * 8 * 9 + 8 * i + 1], kernels[n * 8 * 9 + 8 * i + 2], kernels[n * 8 * 9 + 8 * i + 3]);
            const vec4 k1 = vec4(kernels[n * 8 * 9 + 8 * i + 4], kernels[n * 8 * 9 + 8 * i + 5], kernels[n * 8 * 9 + 8 * i + 6], kernels[n * 8 * 9 + 8 * i + 7]);
            sum[n] += (dot(k0, r[i][0]) + dot(k1, r[i][1]));
        }
    }

    return ACTIVE(vec4(sum[0], sum[1], sum[2], sum[3]));
}

//!HOOK LUMA
//!DESC ARNet b16 Layer28 L0
//!WHEN OUTPUT.w LUMA.w / 1.2 > OUTPUT.h LUMA.h / 1.2 > *
//!BIND TMP1_L0
//!BIND TMP1_L1
//!BIND TMP2_L0
//!SAVE TMP2_L0
//!COMPONENTS 4

#define ACTIVE(v) (v)

#define TEX_BIND_L0_TEXOFF TMP1_L0_texOff
#define TEX_BIND_L0_TEX TMP1_L0_tex
#define TEX_BIND_L0_POS TMP1_L0_pos
#define TEX_BIND_L0_SIZE TMP1_L0_size
#define TEX_BIND_L0_PT TMP1_L0_pt

#define TEX_BIND_L1_TEXOFF TMP1_L1_texOff
#define TEX_BIND_L1_TEX TMP1_L1_tex
#define TEX_BIND_L1_POS TMP1_L1_pos
#define TEX_BIND_L1_SIZE TMP1_L1_size
#define TEX_BIND_L1_PT TMP1_L1_pt

#define TEX_BIND_L2_TEXOFF TMP2_L0_texOff
#define TEX_BIND_L2_TEX TMP2_L0_tex
#define TEX_BIND_L2_POS TMP2_L0_pos
#define TEX_BIND_L2_SIZE TMP2_L0_size
#define TEX_BIND_L2_PT TMP2_L0_pt

const float kernels[288] = float[288](
  -0.1092679f, -0.0840615f, -0.0359452f, -0.1847557f, -0.1179359f, -0.2618779f, +0.1473340f, +0.0250688f,
  +0.0486951f, +0.2602624f, +0.0693399f, -0.2126841f, +0.0881117f, +0.3209324f, -0.0781055f, +0.3166685f,
  -0.1867301f, +0.3412844f, +0.0535324f, +0.1022799f, +0.0892519f, +0.0868459f, -0.2296379f, -0.1957196f,
  +0.2924923f, +0.3857869f, -0.2064922f, -0.0818646f, +0.3751591f, +0.0063006f, -0.0941690f, +0.1777326f,
  -0.1053292f, +0.5576770f, +0.4161473f, +0.0078919f, +0.1204729f, +0.1125045f, -0.1437953f, -0.0569350f,
  -0.2989888f, +0.1789028f, -0.0055572f, +0.0248018f, +0.1624582f, +0.0343210f, +0.0501619f, -0.3126816f,
  +0.2609275f, -0.4670764f, -0.2671513f, +0.2427771f, +0.1445127f, +0.2207803f, -0.1046980f, +0.2759664f,
  -0.2217925f, +0.0481969f, +0.1318714f, -0.1358622f, -0.0896822f, -0.0250193f, +0.1336091f, +0.0837800f,
  +0.0869207f, -0.3027425f, -0.0214117f, -0.0114104f, +0.1171447f, -0.0326364f, -0.0040193f, -0.4074239f,
  -0.0206829f, -0.0787019f, +0.0251696f, +0.0221256f, +0.1561332f, +0.1538316f, -0.2161206f, -0.0052854f,
  -0.0005901f, -0.3516340f, +0.1674342f, +0.3074493f, -0.1518764f, -0.2179891f, +0.1754259f, +0.0572707f,
  +0.0888963f, +0.1409056f, -0.0026468f, -0.1764160f, +0.1124790f, +0.0316167f, +0.1052041f, +0.2158410f,
  +0.0567213f, -0.3483794f, -0.0880071f, -0.1305956f, +0.3497582f, -0.0114255f, -0.2833178f, +0.0662305f,
  +0.0225459f, -0.4592947f, -0.0227339f, +0.0499022f, +0.2204488f, +0.3673452f, +0.0813362f, +0.0600851f,
  +0.1029860f, -0.2299199f, +0.2749884f, +0.1619347f, +0.2152185f, -0.0395136f, -0.1003425f, +0.3783403f,
  -0.1932386f, +0.0687270f, -0.1057108f, -0.0546841f, -0.0711671f, -0.3033721f, +0.1042223f, +0.0827007f,
  +0.4731694f, -0.2118222f, -0.1523512f, -0.1540066f, +0.0115821f, +0.3094803f, -0.0008869f, +0.9001554f,
  -0.0126340f, -0.7929362f, -0.1107063f, -0.0749151f, +0.1668961f, +0.0838664f, -0.0337983f, +0.4640942f,
  +0.0734535f, +0.1007855f, +0.0249010f, -0.0349873f, -0.0276258f, -0.3082763f, +0.0768108f, +0.2831394f,
  +0.2446729f, -0.1366841f, +0.3263535f, +0.7187807f, -0.2265603f, +0.1100770f, +0.1392522f, +0.0396724f,
  +0.0837006f, +0.1548548f, +0.0289416f, +0.0144631f, -0.0592741f, +0.2039925f, -0.1615756f, +0.0566068f,
  +0.0522826f, +0.2750580f, +0.1869841f, -0.0181136f, -0.0409557f, -0.4089010f, -0.2567758f, +0.3782689f,
  -0.4165484f, -0.2051950f, +0.6769044f, -0.0922058f, -0.3207214f, -0.0036629f, +0.3697554f, +0.0165153f,
  -0.1034600f, +0.2102266f, -0.0163156f, -0.1550199f, +0.1841061f, +0.1256956f, +0.2661894f, +0.2389892f,
  -0.2051101f, +0.2145902f, +0.3576523f, -0.0077128f, +0.1995746f, -0.5817766f, +0.0289695f, +0.0971427f,
  +0.1455437f, +0.1991544f, +0.3879817f, +0.1444826f, +0.2070989f, -0.0792516f, -0.3843184f, -0.4265366f,
  -0.1099842f, +0.4687794f, +0.1791915f, -0.0900847f, +0.0899467f, +0.0462490f, +0.0978997f, -0.0394084f,
  +0.1157484f, -0.1645484f, +0.1888764f, +0.4401071f, -0.2616612f, +0.1744983f, -0.2072630f, -0.1141463f,
  -0.2811867f, -0.4425214f, +0.4131822f, +0.2414074f, -0.2691617f, +0.2112501f, +0.7657385f, +0.0442898f,
  -0.4101499f, +0.2449810f, -0.0653055f, -0.1819991f, -0.0541426f, +0.1321508f, +0.0011049f, -0.0683763f,
  -0.1991323f, -0.5781762f, -0.2658195f, -0.2869122f, -0.0917025f, -0.3824700f, -0.5890222f, -0.3509617f,
  +0.1630758f, -0.1991951f, -0.2034570f, +0.1878154f, -0.4510986f, -0.1794931f, +1.0619918f, -0.3662616f,
  +0.3692987f, -0.5717548f, +0.3063240f, -0.0291157f, -0.0713627f, -0.1888243f, +0.0051406f, +0.2452236f,
  +0.0383783f, +0.7262252f, -0.1449904f, +0.0353233f, +0.1009875f, -0.3245259f, -0.1024240f, -0.4633260f,
  +0.1307251f, +0.2507153f, +0.5156574f, -0.0256663f, +0.1725350f, -0.0883577f, -0.9761532f, +0.8189589f,
  +0.0546990f, +0.1310138f, -0.1827600f, +0.0753116f, -0.1514280f, +0.0349799f, -0.0107431f, -0.5648221f
);

const float biases[4] = float[4](
  +0.0491790f, -0.0445176f, +0.1296759f, -0.0087843f
);

vec4 hook() {
    const vec4 r[9][2] = vec4[9][2](
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 1.0f)))
    );

    float sum[4] = biases;
    for (int n = 0; n < 4; n++) {
        for (int i = 0; i < 9; i++) {
            const vec4 k0 = vec4(kernels[n * 8 * 9 + 8 * i + 0], kernels[n * 8 * 9 + 8 * i + 1], kernels[n * 8 * 9 + 8 * i + 2], kernels[n * 8 * 9 + 8 * i + 3]);
            const vec4 k1 = vec4(kernels[n * 8 * 9 + 8 * i + 4], kernels[n * 8 * 9 + 8 * i + 5], kernels[n * 8 * 9 + 8 * i + 6], kernels[n * 8 * 9 + 8 * i + 7]);
            sum[n] += (dot(k0, r[i][0]) + dot(k1, r[i][1]));
        }
    }

    return ACTIVE(vec4(sum[0], sum[1], sum[2], sum[3]) * 0.2000000f + TEX_BIND_L2_TEXOFF(vec2(0.0f, 0.0f)));
}

//!HOOK LUMA
//!DESC ARNet b16 Layer28 L1
//!WHEN OUTPUT.w LUMA.w / 1.2 > OUTPUT.h LUMA.h / 1.2 > *
//!BIND TMP1_L0
//!BIND TMP1_L1
//!BIND TMP2_L1
//!SAVE TMP2_L1
//!COMPONENTS 4

#define ACTIVE(v) (v)

#define TEX_BIND_L0_TEXOFF TMP1_L0_texOff
#define TEX_BIND_L0_TEX TMP1_L0_tex
#define TEX_BIND_L0_POS TMP1_L0_pos
#define TEX_BIND_L0_SIZE TMP1_L0_size
#define TEX_BIND_L0_PT TMP1_L0_pt

#define TEX_BIND_L1_TEXOFF TMP1_L1_texOff
#define TEX_BIND_L1_TEX TMP1_L1_tex
#define TEX_BIND_L1_POS TMP1_L1_pos
#define TEX_BIND_L1_SIZE TMP1_L1_size
#define TEX_BIND_L1_PT TMP1_L1_pt

#define TEX_BIND_L2_TEXOFF TMP2_L1_texOff
#define TEX_BIND_L2_TEX TMP2_L1_tex
#define TEX_BIND_L2_POS TMP2_L1_pos
#define TEX_BIND_L2_SIZE TMP2_L1_size
#define TEX_BIND_L2_PT TMP2_L1_pt

const float kernels[288] = float[288](
  -0.0201488f, -0.1178736f, -0.2401661f, -0.0162370f, +0.0087082f, +0.3814026f, -0.0383701f, +0.0248414f,
  -0.1127571f, -0.1253613f, +0.0998835f, -0.4524874f, +0.4501439f, +0.0149521f, -0.1144651f, -0.1869092f,
  +0.0690661f, +0.0309724f, +0.0473417f, +0.1673599f, -0.1107759f, +0.0488521f, -0.0176593f, +0.1383851f,
  +0.1535903f, +0.1966022f, -0.2303952f, -0.0239924f, +0.2816453f, -0.3045631f, -0.1760980f, -0.1891078f,
  +0.3869471f, +0.0951470f, -0.2741631f, +0.0372378f, +0.1268677f, +0.0605728f, +0.4953852f, -0.0625834f,
  -0.2309766f, -0.3117642f, -0.0354193f, -0.0243795f, -0.0282420f, -0.0654412f, -0.0791217f, +0.1960391f,
  +0.1731735f, +0.2378042f, -0.1757517f, -0.0428402f, +0.0821234f, +0.0925127f, +0.0479708f, -0.1585795f,
  -0.2610355f, +0.2977058f, +0.0369782f, -0.0444334f, -0.1575046f, -0.1948766f, -0.1876291f, -0.3322852f,
  +0.2112517f, -0.1861696f, +0.0500366f, +0.0680520f, -0.0771393f, -0.0596514f, -0.0295362f, +0.5050706f,
  -0.0549252f, +0.1220466f, -0.0494488f, -0.1439000f, +0.0341050f, -0.1750220f, +0.0527664f, +0.0136859f,
  +0.0024683f, -0.1269613f, -0.0345173f, -0.0838552f, -0.0178422f, +0.0370583f, -0.2793901f, -0.1250726f,
  -0.1110216f, -0.1550324f, +0.0369195f, -0.1298946f, +0.0732142f, -0.0683934f, +0.0630914f, -0.0778514f,
  -0.1662901f, +0.0781571f, +0.0330986f, +0.0109720f, -0.0576292f, +0.3376795f, +0.3066054f, -0.0632956f,
  +0.0833324f, -0.0126894f, -0.2067839f, +0.1423460f, -0.2300715f, +0.2863973f, -0.5771320f, -0.1703984f,
  +0.1847012f, +0.0810396f, -0.0682671f, +0.2419093f, -0.0071161f, -0.0660387f, +0.1912794f, -0.2931251f,
  +0.2370287f, +0.1267436f, -0.3009647f, +0.1254346f, -0.2666160f, -0.1609447f, -0.3623687f, +0.2837080f,
  +0.0490238f, +0.3294519f, -0.1259143f, -0.1127453f, -0.2334487f, +0.0180745f, +0.4407479f, -0.0474521f,
  -0.0583832f, -0.1147563f, +0.0135534f, +0.0038727f, +0.1088749f, +0.0235676f, -0.1358942f, +0.0098225f,
  +0.1255854f, +0.0320025f, -0.0507141f, -0.4421886f, +0.1727331f, -0.1816128f, -0.0020912f, +0.2743604f,
  +0.1005938f, -0.3787663f, +0.5851988f, +0.6335351f, +0.1304802f, +0.1133987f, -0.1340370f, +0.1790473f,
  -0.4779738f, +0.0985627f, +0.1216364f, +0.0239748f, -0.0628700f, -0.2201746f, +0.0766216f, -0.1596865f,
  +0.3171202f, +0.1891222f, +0.1161356f, +0.2408828f, +0.0373011f, +0.2573405f, -0.0151243f, +0.2945521f,
  -0.0382739f, -0.5417216f, -0.1251471f, -0.0444911f, -0.1113623f, +0.2105487f, +0.0864351f, +0.3446558f,
  +0.1876848f, -0.5210092f, -0.0380370f, -0.0212731f, +0.0071464f, -0.0255335f, -0.0400406f, -0.1799286f,
  -0.1277072f, -0.0712829f, +0.2486240f, +0.1663938f, -0.0217924f, +0.3028539f, -0.0079419f, +0.3522528f,
  -0.0717864f, +0.1420224f, +0.0242755f, -0.0273455f, +0.0715197f, +0.1095785f, +0.4278169f, -0.0022619f,
  -0.1165824f, -0.1145092f, +0.0095687f, +0.0794746f, +0.0950435f, +0.0101784f, -0.0330474f, -0.3061236f,
  -0.1601996f, +0.0695820f, -0.0051160f, -0.0649499f, -0.0071797f, -0.6108293f, +0.1351013f, -0.0216349f,
  -0.0869948f, -0.3138144f, -0.0835353f, +0.0766666f, -0.0617044f, -0.1298725f, -0.3123709f, -0.3516351f,
  +0.0893529f, -0.4213905f, +0.0850981f, +0.1403761f, -0.0611760f, +0.0508763f, +0.1032638f, +0.0869408f,
  -0.0101881f, -0.1858500f, -0.1073973f, -0.2911779f, -0.0771957f, -0.0467559f, -0.1682141f, -0.3418470f,
  -0.1953171f, +0.0115558f, -0.1176446f, -0.2979806f, -0.3990709f, -0.1656177f, +0.3875905f, -0.4261915f,
  +0.1247487f, -0.5315405f, +0.0570206f, -0.1390922f, +0.0190224f, -0.0420026f, +0.0124225f, -0.2878636f,
  +0.0005643f, +0.1843490f, -0.0394326f, +0.0528925f, +0.0766402f, +0.4614221f, +0.0134282f, -0.1243133f,
  -0.2616659f, +0.0013594f, +0.1052379f, -0.1725358f, +0.1237310f, +0.2830590f, -0.2315371f, -0.2882199f,
  +0.1200960f, +0.1012322f, +0.0055765f, +0.0646965f, +0.0202051f, -0.0844079f, -0.1352254f, -0.1798382f
);

const float biases[4] = float[4](
  +0.0232242f, +0.0257131f, +0.0016563f, +0.0371776f
);

vec4 hook() {
    const vec4 r[9][2] = vec4[9][2](
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 1.0f)))
    );

    float sum[4] = biases;
    for (int n = 0; n < 4; n++) {
        for (int i = 0; i < 9; i++) {
            const vec4 k0 = vec4(kernels[n * 8 * 9 + 8 * i + 0], kernels[n * 8 * 9 + 8 * i + 1], kernels[n * 8 * 9 + 8 * i + 2], kernels[n * 8 * 9 + 8 * i + 3]);
            const vec4 k1 = vec4(kernels[n * 8 * 9 + 8 * i + 4], kernels[n * 8 * 9 + 8 * i + 5], kernels[n * 8 * 9 + 8 * i + 6], kernels[n * 8 * 9 + 8 * i + 7]);
            sum[n] += (dot(k0, r[i][0]) + dot(k1, r[i][1]));
        }
    }

    return ACTIVE(vec4(sum[0], sum[1], sum[2], sum[3]) * 0.2000000f + TEX_BIND_L2_TEXOFF(vec2(0.0f, 0.0f)));
}

//!HOOK LUMA
//!DESC ARNet b16 Layer29 L0
//!WHEN OUTPUT.w LUMA.w / 1.2 > OUTPUT.h LUMA.h / 1.2 > *
//!BIND TMP2_L0
//!BIND TMP2_L1
//!SAVE TMP1_L0
//!COMPONENTS 4

#define ACTIVE(v) (max(v, v * 0.2000000f))

#define TEX_BIND_L0_TEXOFF TMP2_L0_texOff
#define TEX_BIND_L0_TEX TMP2_L0_tex
#define TEX_BIND_L0_POS TMP2_L0_pos
#define TEX_BIND_L0_SIZE TMP2_L0_size
#define TEX_BIND_L0_PT TMP2_L0_pt

#define TEX_BIND_L1_TEXOFF TMP2_L1_texOff
#define TEX_BIND_L1_TEX TMP2_L1_tex
#define TEX_BIND_L1_POS TMP2_L1_pos
#define TEX_BIND_L1_SIZE TMP2_L1_size
#define TEX_BIND_L1_PT TMP2_L1_pt

const float kernels[288] = float[288](
  -0.4356906f, +0.0789251f, -0.0201823f, -0.1361009f, -0.1803992f, -0.0129193f, -0.0568370f, -0.1634494f,
  -0.1774438f, +0.3446538f, -0.1213425f, -0.1561403f, -0.2124692f, +0.0392674f, -0.2109157f, -0.0148878f,
  -0.0447425f, -0.0214803f, +0.0736453f, +0.0640907f, -0.2977327f, +0.0475252f, -0.0665702f, +0.0007363f,
  -0.2731380f, +0.2042713f, +0.0987387f, -0.2762096f, -0.0426258f, -0.3190849f, -0.1476347f, -0.0485270f,
  -0.0161969f, +0.0712419f, +0.0322136f, -0.2094812f, -0.6458408f, -0.3645776f, -0.3690238f, -0.2042962f,
  -0.5594850f, +0.2088950f, -0.1087344f, +0.2643209f, -0.4083239f, +0.3279636f, +0.2510338f, +0.1691320f,
  +0.0355192f, +0.1459510f, -0.0228445f, +0.0254068f, -0.4368532f, +0.1191171f, +0.0898832f, +0.2880445f,
  +0.1131595f, +0.2545847f, +0.0569514f, -0.2721924f, -0.3806105f, -0.0255618f, +0.1536070f, +0.0139497f,
  -0.0161626f, +0.1045402f, +0.2831148f, +0.0655204f, +0.1139034f, +0.1795188f, +0.1326350f, -0.0331085f,
  -0.1453191f, -0.0566240f, -0.0772322f, +0.2619600f, -0.2342515f, -0.0043176f, +0.2593575f, +0.0611096f,
  +0.0182268f, +0.0772006f, -0.0140973f, +0.0615689f, -0.1759278f, -0.1617226f, +0.4245967f, -0.1801210f,
  -0.0363043f, -0.2541350f, +0.1221967f, +0.0607145f, +0.1702756f, -0.1824932f, +0.1218372f, +0.0801461f,
  +0.0326575f, +0.1997944f, -0.2444574f, +0.2608315f, -0.5767831f, +0.0870770f, +0.4884774f, +0.0681898f,
  -0.3486958f, +0.6146175f, -0.8761041f, -0.2412247f, +1.3779387f, +0.3375660f, -0.3497086f, -0.3746606f,
  +0.0943110f, -0.0564345f, +0.0913874f, -0.0737127f, +0.3095347f, -0.2184111f, +0.3452480f, -0.0680044f,
  +0.0258023f, -0.0651291f, +0.0073216f, +0.0465447f, +0.0863764f, +0.4074044f, +0.0115729f, +0.1095759f,
  +0.4241402f, -0.1014766f, +0.1669040f, +0.0055592f, -0.2767599f, +0.2019286f, +0.1072592f, -0.2178069f,
  +0.0699076f, -0.1573692f, +0.0559268f, -0.0676058f, -0.2869190f, -0.1077063f, -0.0732226f, +0.0180234f,
  -0.1814609f, -0.3713095f, +0.1667965f, +0.2053127f, +0.0938644f, +0.3190271f, -0.0518491f, -0.0036768f,
  -0.2957467f, +0.0422520f, -0.1202691f, +0.1134420f, +0.0864541f, +0.1417812f, -0.0433298f, -0.0280924f,
  +0.1795834f, -0.0916271f, -0.1538322f, +0.1356971f, -0.0886311f, +0.0617415f, +0.0166376f, +0.1008636f,
  -0.0593726f, -0.3059533f, -0.0029624f, +0.3347748f, +0.4081898f, -0.0649265f, -0.0364105f, -0.3805246f,
  +0.0046667f, -0.3358406f, -0.1790213f, -0.0976797f, +0.5328905f, -0.0435996f, -0.6293142f, -0.0025309f,
  +0.0884207f, -0.6597242f, -0.2312303f, +0.1931770f, +0.2975813f, +0.0701626f, -0.5180209f, +0.1321143f,
  +0.4179631f, -0.2650093f, +0.2768532f, -0.0555304f, +0.1861137f, +0.3831772f, +0.0922016f, -0.3909643f,
  -0.2239721f, +0.2523839f, +0.1402135f, -0.0726823f, -0.0342261f, +0.1575562f, -0.4025133f, +0.0637643f,
  -0.0893392f, -0.4861027f, -0.1419871f, +0.0358795f, -0.2886532f, +0.1665469f, -0.4378231f, +0.0370366f,
  +0.2626992f, -0.1631709f, +0.1489290f, -0.0965165f, +0.0532232f, -0.0016372f, -0.0870114f, +0.1445710f,
  -0.0232270f, +0.2195529f, +0.0516742f, +0.1250346f, +0.0809520f, +0.0029089f, +0.4049539f, -0.0057407f,
  +0.0604477f, +0.3116052f, +0.0158223f, -0.0321883f, -0.2570902f, +0.0503499f, +0.1013076f, -0.1030194f,
  -0.2973931f, +0.0214057f, -0.0098705f, -0.0380629f, -0.2921315f, -0.0872050f, +0.0297997f, -0.0826797f,
  -0.0498631f, +0.3326168f, +0.0608315f, +0.0870134f, +0.1038282f, -0.2145988f, +0.4384134f, -0.1103068f,
  -0.1465220f, +0.5614572f, +0.1304918f, -0.2065545f, -0.1669168f, -0.1577527f, +0.5754850f, -0.1704695f,
  -0.0225301f, +0.0317766f, -0.1770699f, +0.0494659f, -0.2118914f, -0.1637872f, +0.1973554f, +0.2468482f,
  -0.0932523f, +0.5103939f, -0.0511818f, -0.0145211f, -0.2246691f, +0.0546627f, +0.4112247f, +0.0245747f,
  +0.0144317f, +0.3349176f, +0.1416965f, -0.1796583f, -0.2834329f, -0.0293579f, +0.3003731f, +0.0089425f
);

const float biases[4] = float[4](
  +0.0317596f, -0.0069270f, -0.0696640f, -0.0009246f
);

vec4 hook() {
    const vec4 r[9][2] = vec4[9][2](
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 1.0f)))
    );

    float sum[4] = biases;
    for (int n = 0; n < 4; n++) {
        for (int i = 0; i < 9; i++) {
            const vec4 k0 = vec4(kernels[n * 8 * 9 + 8 * i + 0], kernels[n * 8 * 9 + 8 * i + 1], kernels[n * 8 * 9 + 8 * i + 2], kernels[n * 8 * 9 + 8 * i + 3]);
            const vec4 k1 = vec4(kernels[n * 8 * 9 + 8 * i + 4], kernels[n * 8 * 9 + 8 * i + 5], kernels[n * 8 * 9 + 8 * i + 6], kernels[n * 8 * 9 + 8 * i + 7]);
            sum[n] += (dot(k0, r[i][0]) + dot(k1, r[i][1]));
        }
    }

    return ACTIVE(vec4(sum[0], sum[1], sum[2], sum[3]));
}

//!HOOK LUMA
//!DESC ARNet b16 Layer29 L1
//!WHEN OUTPUT.w LUMA.w / 1.2 > OUTPUT.h LUMA.h / 1.2 > *
//!BIND TMP2_L0
//!BIND TMP2_L1
//!SAVE TMP1_L1
//!COMPONENTS 4

#define ACTIVE(v) (max(v, v * 0.2000000f))

#define TEX_BIND_L0_TEXOFF TMP2_L0_texOff
#define TEX_BIND_L0_TEX TMP2_L0_tex
#define TEX_BIND_L0_POS TMP2_L0_pos
#define TEX_BIND_L0_SIZE TMP2_L0_size
#define TEX_BIND_L0_PT TMP2_L0_pt

#define TEX_BIND_L1_TEXOFF TMP2_L1_texOff
#define TEX_BIND_L1_TEX TMP2_L1_tex
#define TEX_BIND_L1_POS TMP2_L1_pos
#define TEX_BIND_L1_SIZE TMP2_L1_size
#define TEX_BIND_L1_PT TMP2_L1_pt

const float kernels[288] = float[288](
  -0.0072931f, -0.3662763f, -0.1781067f, +0.2881106f, +0.0251420f, +0.5308880f, -0.6955678f, +0.1329442f,
  +0.2819876f, -0.3786633f, +0.1770866f, +0.3566657f, -0.0566124f, +0.2097417f, +0.2219536f, +0.1601645f,
  -0.3134582f, -0.3050876f, -0.2946820f, -0.0974453f, -0.0031220f, -0.1031489f, -0.3183135f, -0.0614047f,
  +0.2675473f, -0.6002374f, +0.1851625f, +0.0932614f, +0.1119150f, -0.0865095f, -0.2440592f, -0.1216766f,
  +0.8715802f, -0.6996257f, -0.4302717f, +0.2244441f, +0.8773606f, +0.0100948f, -0.9069007f, -0.0348712f,
  +0.3929751f, +0.0958974f, +0.0810695f, -0.0312336f, -0.1154879f, -0.1221777f, -0.0586747f, +0.3934138f,
  +0.2172484f, -0.2503741f, +0.0610967f, -0.1038785f, -0.3399612f, -0.3254378f, -0.2067581f, -0.2814592f,
  +0.3299640f, +0.1491362f, +0.4425081f, -0.1018166f, -0.1088083f, -0.0628719f, +0.1278923f, +0.0439852f,
  +0.2819413f, -0.2010300f, -0.0990252f, +0.0125873f, +0.4560862f, -0.2339499f, -0.0888542f, -0.2248238f,
  -0.0297735f, +0.1265155f, -0.1558871f, -0.2515361f, -0.0493004f, +0.0493666f, -0.3031681f, +0.0432604f,
  +0.0291421f, +0.0974488f, -0.1707069f, +0.0886849f, -0.1369036f, -0.0243372f, -0.0488146f, +0.1162483f,
  +0.0720210f, +0.1175715f, -0.0383473f, -0.0934638f, -0.1741763f, -0.0097959f, -0.1213408f, +0.1638851f,
  +0.0942704f, +0.0766239f, +0.1718279f, -0.2361601f, -0.2208280f, -0.2279341f, +0.0151996f, +0.0332648f,
  +0.2473356f, -0.1252954f, +0.3461388f, -0.3881471f, -0.6137597f, +0.1507175f, -0.1782924f, -0.0106349f,
  -0.2874922f, -0.2512194f, +0.1420228f, -0.2927732f, -0.4273022f, -0.0719766f, -0.1586635f, -0.1808722f,
  -0.1810237f, +0.1115335f, -0.0729000f, -0.0250965f, -0.2408103f, -0.0532249f, +0.2709498f, +0.2934533f,
  +0.2546524f, +0.3591573f, -0.0759017f, -0.1377220f, -0.1547149f, -0.0840159f, +0.2344611f, +0.1147082f,
  +0.0290403f, +0.1999657f, -0.1609483f, +0.1261193f, -0.2595063f, -0.1075466f, +0.3695473f, +0.0234159f,
  -0.3069507f, -0.1687322f, +0.1249496f, -0.3196073f, +0.2326149f, -0.2106685f, -0.4458117f, -0.2492985f,
  +0.0293656f, -0.1234466f, -0.0448453f, +0.2822856f, -0.1388207f, -0.0885502f, +0.2335944f, +0.0317956f,
  +0.0320154f, +0.0881191f, -0.0573666f, -0.1800778f, -0.1878741f, +0.1066729f, -0.0378859f, +0.0505624f,
  +0.1656801f, +0.0889528f, +0.2433134f, -0.2372727f, -0.3178970f, -0.0592806f, -0.3916077f, -0.0537190f,
  +0.1473878f, +0.3950271f, +0.3575982f, +0.0100715f, -0.0891369f, -0.2699984f, +0.3075704f, -0.0731459f,
  -0.5692754f, -0.3279617f, -0.1242609f, -0.0080974f, -0.4524361f, +0.1852477f, -0.1419658f, -0.0940346f,
  -0.0920903f, -0.1597821f, -0.0098318f, -0.1391901f, -0.4094146f, -0.1473642f, -0.6021916f, +0.0630328f,
  -0.0861319f, -0.0477385f, +0.2739758f, +0.2180725f, +0.2564753f, -0.1141269f, +0.1626567f, +0.0359063f,
  -0.1181739f, -0.2341667f, -0.0678763f, +0.2007107f, +0.3255335f, +0.3007204f, -0.0960462f, -0.1610544f,
  -0.1037504f, +0.1020876f, -0.0344011f, -0.1060099f, +0.0942536f, -0.1383147f, +0.0079391f, -0.1019632f,
  -0.0123184f, +0.0423284f, +0.2017886f, -0.0712586f, -0.1807544f, +0.1033332f, -0.1811958f, -0.0643362f,
  +0.1155130f, +0.1495340f, -0.0019385f, -0.0023634f, -0.0681274f, +0.1230579f, +0.0057612f, -0.0206893f,
  +0.0632024f, +0.2410109f, +0.0956386f, -0.2466590f, -0.5644450f, -0.1780552f, -0.5575817f, +0.2950929f,
  -0.0661644f, -0.0065172f, -0.1790787f, +0.2319382f, -0.1113836f, -0.1720321f, -0.1968659f, +0.0501203f,
  +0.0891001f, +0.3712935f, +0.0399675f, +0.0612760f, -0.1567619f, +0.0581090f, +0.1656095f, -0.0860546f,
  -0.2612050f, -0.1143055f, +0.0069109f, -0.1905148f, +0.1578481f, +0.0020935f, -0.1245269f, -0.1255214f,
  -0.1136896f, -0.1522535f, -0.1265106f, -0.0697264f, -0.2151160f, +0.0580270f, -0.1226593f, +0.1143903f,
  -0.1693174f, +0.3666246f, +0.1836352f, -0.2771616f, -0.0270517f, +0.1388355f, -0.0086771f, +0.0954340f
);

const float biases[4] = float[4](
  -0.0579595f, +0.0151877f, +0.0198714f, +0.0142356f
);

vec4 hook() {
    const vec4 r[9][2] = vec4[9][2](
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 1.0f)))
    );

    float sum[4] = biases;
    for (int n = 0; n < 4; n++) {
        for (int i = 0; i < 9; i++) {
            const vec4 k0 = vec4(kernels[n * 8 * 9 + 8 * i + 0], kernels[n * 8 * 9 + 8 * i + 1], kernels[n * 8 * 9 + 8 * i + 2], kernels[n * 8 * 9 + 8 * i + 3]);
            const vec4 k1 = vec4(kernels[n * 8 * 9 + 8 * i + 4], kernels[n * 8 * 9 + 8 * i + 5], kernels[n * 8 * 9 + 8 * i + 6], kernels[n * 8 * 9 + 8 * i + 7]);
            sum[n] += (dot(k0, r[i][0]) + dot(k1, r[i][1]));
        }
    }

    return ACTIVE(vec4(sum[0], sum[1], sum[2], sum[3]));
}

//!HOOK LUMA
//!DESC ARNet b16 Layer30 L0
//!WHEN OUTPUT.w LUMA.w / 1.2 > OUTPUT.h LUMA.h / 1.2 > *
//!BIND TMP1_L0
//!BIND TMP1_L1
//!BIND TMP2_L0
//!SAVE TMP2_L0
//!COMPONENTS 4

#define ACTIVE(v) (v)

#define TEX_BIND_L0_TEXOFF TMP1_L0_texOff
#define TEX_BIND_L0_TEX TMP1_L0_tex
#define TEX_BIND_L0_POS TMP1_L0_pos
#define TEX_BIND_L0_SIZE TMP1_L0_size
#define TEX_BIND_L0_PT TMP1_L0_pt

#define TEX_BIND_L1_TEXOFF TMP1_L1_texOff
#define TEX_BIND_L1_TEX TMP1_L1_tex
#define TEX_BIND_L1_POS TMP1_L1_pos
#define TEX_BIND_L1_SIZE TMP1_L1_size
#define TEX_BIND_L1_PT TMP1_L1_pt

#define TEX_BIND_L2_TEXOFF TMP2_L0_texOff
#define TEX_BIND_L2_TEX TMP2_L0_tex
#define TEX_BIND_L2_POS TMP2_L0_pos
#define TEX_BIND_L2_SIZE TMP2_L0_size
#define TEX_BIND_L2_PT TMP2_L0_pt

const float kernels[288] = float[288](
  +0.0236810f, -0.0459634f, -0.2734767f, -0.0280700f, -0.2706438f, -0.0014182f, -0.0481604f, +0.0735575f,
  +0.1804565f, -0.0314826f, +0.2636478f, +0.0571248f, -0.1435254f, -0.2153896f, -0.0006447f, +0.0952081f,
  -0.1338601f, -0.0092875f, +0.2839963f, -0.0214278f, -0.0953083f, -0.0290080f, +0.2165573f, -0.0086930f,
  +0.3280883f, +0.2338901f, +0.2116192f, -0.1598977f, +0.2585614f, +0.0463085f, +0.0968000f, -0.2347651f,
  +0.0808321f, +0.3455593f, +0.1821072f, +0.1481803f, -0.0536796f, -0.2381528f, +0.0329725f, +0.0190642f,
  -0.2411554f, +0.3567653f, +0.3041834f, +0.0114163f, -0.2610534f, -0.1406386f, -0.2632445f, +0.1504236f,
  +0.3642606f, +0.0062507f, +0.3093340f, -0.2186172f, +0.1619767f, -0.0038309f, -0.0814739f, -0.1547748f,
  -0.0419949f, -0.2477777f, +0.1653349f, -0.0245804f, -0.1184748f, -0.0219962f, +0.0031925f, -0.1115560f,
  +0.1417419f, -0.1784771f, +0.2893667f, -0.2462928f, -0.1407841f, +0.1707522f, +0.0228911f, +0.2621672f,
  -0.0820896f, +0.2274663f, +0.0394827f, -0.1322881f, +0.2077177f, +0.2533040f, -0.0004492f, +0.1053975f,
  +0.0868959f, +0.0055250f, -0.4496255f, -0.1646620f, -0.0502870f, -0.0009566f, -0.0094309f, -0.4445331f,
  +0.0582517f, +0.1938999f, +0.1239620f, -0.0612109f, -0.0911414f, -0.0092857f, -0.0227024f, -0.2410665f,
  +0.2441678f, +0.2039534f, +0.1278467f, -0.1934803f, -0.2395426f, +0.1042306f, +0.1815156f, -0.0672207f,
  -0.2413840f, -0.2041123f, +0.3230782f, -0.2939569f, +0.3317055f, +0.0004000f, +0.0913574f, -0.0174108f,
  -0.2126805f, +0.1414382f, +0.0833728f, +0.0038049f, +0.1814122f, +0.0468798f, +0.1239341f, -0.2021332f,
  -0.1535164f, -0.0573215f, -0.1548973f, +0.0658025f, +0.0689686f, +0.0515567f, -0.0298685f, -0.1331498f,
  -0.1825011f, +0.1616009f, +0.0645637f, -0.1151097f, +0.0568647f, +0.0318404f, +0.2657669f, +0.1165755f,
  -0.2698365f, -0.0610598f, +0.0665157f, +0.1678974f, +0.3515047f, -0.0840246f, +0.2194090f, -0.1927737f,
  -0.0265522f, -0.0677854f, -0.6215959f, +0.0201260f, -0.2581273f, -0.0158341f, +0.0683893f, -0.1500498f,
  +0.3472083f, -0.0166475f, +0.1964009f, +0.1999996f, +0.2667854f, +0.2363287f, -0.0973391f, +0.3187507f,
  -0.0573227f, -0.2166127f, -0.0232606f, +0.2197120f, -0.2185868f, +0.0853568f, -0.2713092f, -0.3263368f,
  -0.1198994f, +0.0929006f, +0.0169597f, -0.0277948f, +0.5589504f, +0.0370928f, -0.0011653f, +0.0161458f,
  +0.6463094f, -1.1406304f, +0.2203405f, -0.0999432f, -0.4701568f, -0.0473576f, -0.4244984f, -0.3410377f,
  -0.2795978f, +0.0904491f, +0.1514058f, +0.2259258f, +0.4996714f, -0.2552767f, -0.5867505f, -0.2421723f,
  -0.0734284f, +0.1026877f, +0.2526602f, -0.0350050f, -0.1773297f, +0.2039742f, +0.0355168f, +0.1099084f,
  +0.3448291f, +0.0933489f, +0.1714229f, -0.1727190f, +0.6708965f, +0.2724628f, +0.1028410f, -0.2482665f,
  +0.1165320f, +0.0986253f, +0.3645895f, -0.2713310f, +0.5892612f, +0.2014290f, -0.2722614f, +0.0072680f,
  +0.2949856f, +0.2663319f, -0.1000879f, -0.0319105f, +0.1529272f, +0.2129830f, -0.0154767f, -0.1910527f,
  +0.0943778f, +0.0719222f, -0.0559162f, +0.0487645f, +0.2282941f, +0.0062668f, +0.0091973f, -0.0978316f,
  -0.1586872f, +0.1628981f, +0.2575377f, -0.2047607f, +0.0108441f, +0.0068573f, +0.0721160f, -0.0321476f,
  -0.1032977f, -0.2639683f, +0.0660504f, +0.0696683f, -0.1424708f, +0.2043352f, +0.1210304f, -0.0315712f,
  -0.0848591f, -0.7296048f, +0.2805721f, -0.0532768f, -0.0261113f, +0.1846366f, +0.0272813f, +0.0757477f,
  +0.0767827f, +0.1467776f, +0.0298932f, -0.1624760f, +0.1615153f, +0.0720717f, +0.3022562f, +0.0585261f,
  -0.0353772f, +0.1935920f, -0.2682820f, -0.2585255f, +0.5181802f, +0.2344962f, -0.0713598f, -0.1941092f,
  +0.0994369f, +0.0200716f, -0.1929311f, -0.1536169f, -0.3581852f, +0.4048216f, +0.1751741f, +0.0999398f,
  +0.0923090f, +0.0203579f, -0.3318805f, -0.4531400f, -0.3574880f, +0.1401848f, -0.0755411f, +0.0154542f
);

const float biases[4] = float[4](
  -0.0519251f, +0.0078568f, +0.0521306f, +0.0274298f
);

vec4 hook() {
    const vec4 r[9][2] = vec4[9][2](
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 1.0f)))
    );

    float sum[4] = biases;
    for (int n = 0; n < 4; n++) {
        for (int i = 0; i < 9; i++) {
            const vec4 k0 = vec4(kernels[n * 8 * 9 + 8 * i + 0], kernels[n * 8 * 9 + 8 * i + 1], kernels[n * 8 * 9 + 8 * i + 2], kernels[n * 8 * 9 + 8 * i + 3]);
            const vec4 k1 = vec4(kernels[n * 8 * 9 + 8 * i + 4], kernels[n * 8 * 9 + 8 * i + 5], kernels[n * 8 * 9 + 8 * i + 6], kernels[n * 8 * 9 + 8 * i + 7]);
            sum[n] += (dot(k0, r[i][0]) + dot(k1, r[i][1]));
        }
    }

    return ACTIVE(vec4(sum[0], sum[1], sum[2], sum[3]) * 0.2000000f + TEX_BIND_L2_TEXOFF(vec2(0.0f, 0.0f)));
}

//!HOOK LUMA
//!DESC ARNet b16 Layer30 L1
//!WHEN OUTPUT.w LUMA.w / 1.2 > OUTPUT.h LUMA.h / 1.2 > *
//!BIND TMP1_L0
//!BIND TMP1_L1
//!BIND TMP2_L1
//!SAVE TMP2_L1
//!COMPONENTS 4

#define ACTIVE(v) (v)

#define TEX_BIND_L0_TEXOFF TMP1_L0_texOff
#define TEX_BIND_L0_TEX TMP1_L0_tex
#define TEX_BIND_L0_POS TMP1_L0_pos
#define TEX_BIND_L0_SIZE TMP1_L0_size
#define TEX_BIND_L0_PT TMP1_L0_pt

#define TEX_BIND_L1_TEXOFF TMP1_L1_texOff
#define TEX_BIND_L1_TEX TMP1_L1_tex
#define TEX_BIND_L1_POS TMP1_L1_pos
#define TEX_BIND_L1_SIZE TMP1_L1_size
#define TEX_BIND_L1_PT TMP1_L1_pt

#define TEX_BIND_L2_TEXOFF TMP2_L1_texOff
#define TEX_BIND_L2_TEX TMP2_L1_tex
#define TEX_BIND_L2_POS TMP2_L1_pos
#define TEX_BIND_L2_SIZE TMP2_L1_size
#define TEX_BIND_L2_PT TMP2_L1_pt

const float kernels[288] = float[288](
  +0.0486380f, +0.0679068f, +0.2410198f, -0.0927355f, +0.0634392f, +0.1242815f, -0.0118654f, -0.1200118f,
  -0.1717273f, +0.0100437f, +0.1371542f, +0.1179676f, -0.0914785f, +0.0339848f, +0.1417194f, -0.0048787f,
  -0.0296563f, +0.1083916f, -0.0455853f, +0.0257443f, +0.0579259f, +0.1135944f, -0.0371685f, +0.0891150f,
  +0.1699905f, +0.0595185f, +0.1294499f, -0.0002551f, -0.0533422f, +0.0489502f, +0.1086860f, -0.0912419f,
  +0.0035460f, +0.2477341f, -0.2211200f, +0.0996595f, -0.0778537f, +0.0674308f, +0.2135112f, -0.1313014f,
  -0.0331769f, -0.1406513f, -0.3087058f, -0.0177018f, +0.2482535f, +0.1033423f, +0.1109410f, +0.1144003f,
  +0.0528775f, +0.0521687f, +0.2171472f, +0.1177194f, -0.2185006f, +0.0629486f, -0.0278955f, -0.0549860f,
  -0.3092284f, -0.1690152f, +0.0535534f, +0.1257739f, -0.1338061f, +0.0972768f, -0.1220476f, +0.0056578f,
  +0.2181882f, +0.0280125f, -0.1873545f, -0.0929802f, -0.1243435f, +0.0049417f, -0.0859255f, +0.0961494f,
  -0.0840267f, -0.2235953f, -0.2408973f, +0.1095033f, +0.0161013f, -0.0888622f, -0.0583068f, +0.0800591f,
  +0.1109539f, +0.0279093f, -0.0701137f, +0.0091825f, +0.0730942f, -0.2536384f, +0.0671283f, +0.1199596f,
  -0.0729322f, -0.1386677f, -0.2626132f, -0.0003128f, +0.1288125f, +0.0197754f, -0.0475053f, +0.1319298f,
  -0.2086416f, +0.2081468f, -0.1143959f, +0.0589513f, -0.1941167f, -0.0462895f, -0.0335769f, +0.1725867f,
  +0.0006034f, +0.4443539f, -0.2058345f, -0.0798027f, -0.2696173f, -0.2234392f, -0.0189351f, +0.1483670f,
  +0.0776247f, +0.2605385f, +0.1944309f, -0.0421864f, +0.2709631f, -0.0260316f, +0.0184667f, +0.2308908f,
  +0.2396780f, -0.1616216f, +0.0524311f, -0.0280218f, +0.2371905f, -0.2444291f, -0.1185896f, -0.0415507f,
  +0.0635809f, -0.1212568f, -0.2551789f, -0.2437812f, +0.1000751f, -0.1247730f, -0.0050548f, +0.0127949f,
  -0.1417605f, -0.1950834f, -0.1962845f, +0.0593039f, -0.2489520f, -0.1320817f, +0.1937851f, -0.1482260f,
  -0.2220393f, -0.1622351f, +0.1094661f, -0.0059823f, -0.4527372f, -0.1933118f, +0.0928167f, +0.2318698f,
  +0.1562591f, +0.0852533f, +0.2005259f, +0.0246822f, +0.1259424f, -0.0060532f, +0.0247323f, +0.3152397f,
  -0.1916983f, -0.0315693f, +0.1139492f, -0.0462969f, -0.0442893f, -0.1524076f, +0.0736428f, +0.2448570f,
  +0.2376161f, +0.1658009f, +0.1771536f, -0.3046726f, +0.0212577f, +0.0650136f, -0.0484388f, -0.2922605f,
  +0.0482144f, -0.5711085f, +0.2399711f, -0.2077892f, -0.1723890f, +0.0642653f, -0.4621266f, +0.1867779f,
  +0.1377602f, +0.0690701f, -0.0545808f, -0.1328217f, +0.2236865f, +0.0159742f, +0.1125094f, +0.3094962f,
  +0.3175881f, -0.0843449f, +0.1278494f, -0.2400830f, -0.1417504f, -0.0916527f, -0.0361269f, +0.0173524f,
  +0.0507201f, +0.1226130f, -0.0417025f, -0.1221248f, +0.0321996f, +0.0788181f, -0.1726740f, +0.0410498f,
  +0.2406134f, +0.0591224f, +0.1527853f, +0.0247389f, +0.1997324f, +0.0184858f, +0.0170853f, +0.1075976f,
  -0.2930053f, -0.1233560f, -0.0477441f, +0.0598169f, +0.2186953f, -0.0770194f, +0.0063626f, -0.0363156f,
  -0.0914004f, -0.1845383f, -0.0790989f, +0.1507753f, -0.3508151f, +0.0234837f, +0.1266358f, +0.1517666f,
  -0.0115193f, -0.0268125f, +0.4879344f, +0.1199758f, +0.3479014f, +0.1044402f, -0.1549529f, +0.1123764f,
  -0.0829565f, +0.0539726f, +0.2051336f, +0.0787191f, -0.5960790f, +0.1331851f, +0.1751288f, -0.0058081f,
  +0.0681932f, -0.2058185f, -0.4844678f, +0.1101996f, +0.5015713f, -0.0990384f, +0.0115090f, -0.0599374f,
  -0.0446902f, -0.4214085f, +0.2389024f, +0.1311658f, -0.2815741f, -0.1937405f, -0.0089195f, -0.2324036f,
  +0.0722932f, +0.1677248f, +0.1175209f, -0.1205915f, -0.1230974f, +0.1070642f, +0.0841078f, -0.0654187f,
  -0.3949320f, +0.1486189f, +0.2727132f, +0.0482363f, -0.3825787f, +0.1071036f, -0.0328995f, -0.0101034f,
  +0.0720964f, +0.1411716f, -0.5472450f, +0.1604493f, -0.0896368f, +0.0206730f, -0.0097595f, +0.0520605f
);

const float biases[4] = float[4](
  +0.0350809f, -0.0187441f, -0.0194930f, -0.0426770f
);

vec4 hook() {
    const vec4 r[9][2] = vec4[9][2](
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 1.0f)))
    );

    float sum[4] = biases;
    for (int n = 0; n < 4; n++) {
        for (int i = 0; i < 9; i++) {
            const vec4 k0 = vec4(kernels[n * 8 * 9 + 8 * i + 0], kernels[n * 8 * 9 + 8 * i + 1], kernels[n * 8 * 9 + 8 * i + 2], kernels[n * 8 * 9 + 8 * i + 3]);
            const vec4 k1 = vec4(kernels[n * 8 * 9 + 8 * i + 4], kernels[n * 8 * 9 + 8 * i + 5], kernels[n * 8 * 9 + 8 * i + 6], kernels[n * 8 * 9 + 8 * i + 7]);
            sum[n] += (dot(k0, r[i][0]) + dot(k1, r[i][1]));
        }
    }

    return ACTIVE(vec4(sum[0], sum[1], sum[2], sum[3]) * 0.2000000f + TEX_BIND_L2_TEXOFF(vec2(0.0f, 0.0f)));
}

//!HOOK LUMA
//!DESC ARNet b16 Layer31 L0
//!WHEN OUTPUT.w LUMA.w / 1.2 > OUTPUT.h LUMA.h / 1.2 > *
//!BIND TMP2_L0
//!BIND TMP2_L1
//!SAVE TMP1_L0
//!COMPONENTS 4

#define ACTIVE(v) (max(v, v * 0.2000000f))

#define TEX_BIND_L0_TEXOFF TMP2_L0_texOff
#define TEX_BIND_L0_TEX TMP2_L0_tex
#define TEX_BIND_L0_POS TMP2_L0_pos
#define TEX_BIND_L0_SIZE TMP2_L0_size
#define TEX_BIND_L0_PT TMP2_L0_pt

#define TEX_BIND_L1_TEXOFF TMP2_L1_texOff
#define TEX_BIND_L1_TEX TMP2_L1_tex
#define TEX_BIND_L1_POS TMP2_L1_pos
#define TEX_BIND_L1_SIZE TMP2_L1_size
#define TEX_BIND_L1_PT TMP2_L1_pt

const float kernels[288] = float[288](
  -0.4005769f, -0.2052385f, +0.0674032f, -0.0017062f, -0.0377346f, -0.1380215f, +0.0189304f, -0.1206985f,
  -0.1127462f, +0.0200553f, +0.0624945f, +0.0920588f, +0.1779794f, +0.5284579f, -0.1533281f, -0.1458607f,
  -0.1428717f, +0.1555798f, +0.0972713f, -0.0510090f, -0.0488847f, -0.0770982f, +0.2289542f, -0.1366077f,
  -0.1149310f, +0.0656347f, +0.1702988f, +0.1403873f, +0.1117603f, +0.2616226f, -0.0236392f, -0.3980097f,
  +0.0391357f, +0.1180789f, -0.0547082f, +0.0250465f, -0.1090477f, -0.5037637f, +0.1114764f, +0.0617636f,
  +0.0653841f, -0.0354518f, +0.0585990f, -0.1821120f, +0.0873072f, +0.0215936f, +0.0935948f, -0.0130090f,
  -0.2552545f, +0.0402570f, -0.1834489f, +0.1360042f, +0.1462305f, -0.0891089f, +0.3938442f, -0.1242200f,
  -0.1295304f, +0.0564592f, +0.0673849f, -0.1063948f, +0.3244441f, +0.2406460f, +0.2850423f, +0.0322412f,
  +0.0776818f, +0.0195406f, -0.0315432f, -0.1341387f, -0.2840437f, -0.1214720f, +0.0532254f, +0.0631850f,
  +0.3333125f, +0.1981281f, -0.0330827f, +0.1023141f, -0.4347008f, -0.0875719f, +0.0329351f, +0.3059307f,
  +0.2577368f, +0.0020080f, +0.3570095f, -0.3275223f, -0.1934213f, -0.1974846f, -0.2857404f, -0.1303398f,
  -0.0323692f, -0.2057740f, +0.1020408f, -0.0518037f, -0.0367803f, -0.1376684f, -0.0767037f, -0.0827277f,
  +0.3043598f, +0.1521032f, -0.3258561f, +0.4022114f, -0.5172637f, +0.1609092f, +0.4184216f, +0.4155527f,
  -0.0357050f, +0.6051113f, -0.4239477f, +0.0905321f, -0.4983207f, -0.1608807f, +0.8174145f, +0.2182026f,
  -0.0810908f, +0.1310366f, -0.0111047f, -0.0203951f, +0.0075170f, -0.0556995f, +0.3770091f, +0.0848802f,
  -0.0701452f, +0.1459401f, +0.1032029f, +0.0166204f, -0.1376644f, +0.1758811f, -0.1409846f, +0.0534011f,
  -0.0597062f, +0.1517920f, -0.0001051f, -0.0054382f, -0.0068402f, -0.1950427f, +0.0472580f, -0.2185869f,
  +0.1255514f, -0.2276839f, +0.0332440f, +0.0488448f, -0.2329751f, -0.1059541f, -0.0827785f, -0.0370766f,
  +0.1794928f, +0.4632941f, +0.0793728f, -0.0119402f, -0.2993659f, -0.2269593f, +0.0501638f, +0.0544355f,
  +0.1997622f, -0.4729973f, +0.1412670f, -0.0417976f, -0.1559045f, -0.4342626f, +0.0804176f, +0.0839198f,
  -0.1390888f, -0.0733803f, -0.0332001f, +0.0415338f, -0.0450548f, -0.0749607f, -0.0247599f, -0.0067056f,
  +0.1170164f, -0.0824269f, -0.0138607f, +0.1444433f, +0.0218099f, +0.3497746f, -0.2444791f, +0.3706514f,
  +0.1765129f, +0.0230958f, -0.1994984f, +0.5799624f, +0.0135923f, +0.3411898f, +0.0646986f, +0.1515371f,
  +0.2015628f, +0.1352805f, -0.2554427f, +0.5433286f, +0.1221297f, -0.0068422f, +0.2250902f, +0.1243540f,
  +0.0488666f, +0.0678555f, +0.0610195f, -0.0966243f, -0.0013480f, -0.0299097f, -0.2453601f, -0.1039108f,
  -0.0104984f, -0.3237956f, -0.0702130f, +0.0588932f, +0.0113847f, -0.0986958f, -0.3885809f, -0.1649694f,
  -0.0134880f, -0.1307974f, +0.1485947f, +0.0232683f, +0.2227826f, -0.0179334f, -0.1760473f, -0.1992169f,
  +0.4652019f, +0.1562461f, -0.0528796f, +0.0043358f, +0.0122102f, -0.0218983f, -0.0686578f, +0.1593611f,
  +0.1278959f, -0.2461363f, +0.0127284f, -0.1948356f, +0.0209896f, -0.5805322f, -0.0130446f, +0.1538763f,
  -0.0529874f, +0.1247909f, -0.1707489f, +0.1765901f, +0.0618157f, +0.1431381f, -0.1783569f, +0.1904749f,
  +0.5871305f, -0.0845681f, +0.0184590f, +0.1591412f, +0.0159127f, +0.3327453f, -0.1964041f, +0.1857382f,
  +0.0816275f, -0.3414878f, +0.3127472f, -0.5975621f, -0.2990226f, -0.8537723f, +0.2494362f, +0.2849475f,
  -0.0280377f, +0.2539744f, -0.2169603f, +0.0769362f, +0.2844870f, -0.1369433f, -0.4090140f, +0.0097314f,
  +0.5457056f, -0.2345483f, -0.2014152f, +0.2291518f, -0.0237605f, +0.3364771f, -0.1987155f, +0.3284692f,
  +0.2695224f, -0.3393271f, +0.5888069f, -0.1701872f, -0.8354702f, +0.2817121f, +0.2083371f, +0.0494017f,
  -0.2363871f, +0.4653651f, -0.0418050f, -0.1403212f, -0.3227510f, -0.0874521f, -0.1101351f, +0.1509660f
);

const float biases[4] = float[4](
  -0.0115715f, +0.0365823f, -0.0251867f, +0.0265850f
);

vec4 hook() {
    const vec4 r[9][2] = vec4[9][2](
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 1.0f)))
    );

    float sum[4] = biases;
    for (int n = 0; n < 4; n++) {
        for (int i = 0; i < 9; i++) {
            const vec4 k0 = vec4(kernels[n * 8 * 9 + 8 * i + 0], kernels[n * 8 * 9 + 8 * i + 1], kernels[n * 8 * 9 + 8 * i + 2], kernels[n * 8 * 9 + 8 * i + 3]);
            const vec4 k1 = vec4(kernels[n * 8 * 9 + 8 * i + 4], kernels[n * 8 * 9 + 8 * i + 5], kernels[n * 8 * 9 + 8 * i + 6], kernels[n * 8 * 9 + 8 * i + 7]);
            sum[n] += (dot(k0, r[i][0]) + dot(k1, r[i][1]));
        }
    }

    return ACTIVE(vec4(sum[0], sum[1], sum[2], sum[3]));
}

//!HOOK LUMA
//!DESC ARNet b16 Layer31 L1
//!WHEN OUTPUT.w LUMA.w / 1.2 > OUTPUT.h LUMA.h / 1.2 > *
//!BIND TMP2_L0
//!BIND TMP2_L1
//!SAVE TMP1_L1
//!COMPONENTS 4

#define ACTIVE(v) (max(v, v * 0.2000000f))

#define TEX_BIND_L0_TEXOFF TMP2_L0_texOff
#define TEX_BIND_L0_TEX TMP2_L0_tex
#define TEX_BIND_L0_POS TMP2_L0_pos
#define TEX_BIND_L0_SIZE TMP2_L0_size
#define TEX_BIND_L0_PT TMP2_L0_pt

#define TEX_BIND_L1_TEXOFF TMP2_L1_texOff
#define TEX_BIND_L1_TEX TMP2_L1_tex
#define TEX_BIND_L1_POS TMP2_L1_pos
#define TEX_BIND_L1_SIZE TMP2_L1_size
#define TEX_BIND_L1_PT TMP2_L1_pt

const float kernels[288] = float[288](
  -0.1056644f, -0.2179829f, +0.0471606f, +0.0424051f, +0.4100164f, +0.1310913f, -0.0845948f, -0.2527503f,
  +0.0309635f, -0.1633360f, -0.0523513f, +0.0388939f, +0.1118234f, -0.1628495f, +0.0442895f, +0.1382281f,
  -0.0526706f, -0.2464949f, +0.0141048f, +0.1433619f, +0.0990564f, +0.0651900f, -0.0189835f, +0.0368660f,
  -0.0145893f, +0.1291965f, -0.0964642f, -0.0441957f, +0.2730083f, +0.1194963f, -0.1069572f, -0.1033354f,
  +0.0150426f, -0.3701988f, +0.5891446f, -0.0114436f, +0.2512051f, -0.1746165f, -0.0704997f, -0.1386741f,
  +0.2472045f, +0.0901708f, +0.0940645f, -0.0901231f, +0.1941207f, -0.3544286f, +0.2865593f, -0.3838838f,
  -0.1365500f, +0.0599676f, -0.1225580f, -0.0148451f, -0.0927889f, +0.0319849f, -0.0931935f, +0.0069290f,
  -0.1052467f, +0.0285956f, -0.0264843f, +0.2659554f, -0.1380540f, +0.0746573f, +0.2034552f, +0.2387965f,
  +0.0269556f, +0.2574053f, +0.0704549f, -0.0539023f, +0.0585805f, +0.1531430f, +0.2474810f, +0.0142044f,
  +0.2153624f, +0.2410877f, -0.0694551f, +0.0348425f, -0.1194420f, -0.1543805f, -0.1866478f, +0.2141788f,
  +0.1468345f, -0.3816539f, -0.0936986f, +0.1371888f, -0.1973477f, -0.6626626f, -0.1062741f, +0.2590257f,
  +0.1165887f, -0.3012928f, -0.3155488f, +0.2118791f, +0.0200909f, -0.0675666f, -0.1520305f, +0.3193039f,
  +0.2792295f, -0.2007066f, +0.0642674f, -0.4238399f, +0.3631789f, -0.0718327f, -0.2868914f, +0.3330893f,
  +0.1824095f, +0.5855152f, -0.1357117f, -0.8642079f, +1.0028641f, +0.3575951f, -0.6518050f, -0.0314239f,
  +0.3929668f, -0.1208377f, -0.0570622f, +0.1769662f, +0.2469807f, +0.2223637f, -0.5005802f, -0.0076383f,
  +0.0031142f, +0.1846623f, +0.0134443f, +0.0561631f, -0.4995920f, -0.0472519f, +0.0785063f, +0.0116395f,
  +0.3543165f, -0.2912987f, +0.1308729f, +0.0775790f, -1.0871832f, +0.0901804f, +0.0670483f, +0.0409595f,
  -0.1526006f, -0.0018573f, +0.1837627f, +0.0069392f, -0.3695632f, +0.0146371f, -0.0530204f, -0.0093273f,
  -0.1518609f, -0.2771639f, +0.0084245f, +0.0361622f, +0.0836340f, +0.1936713f, -0.0857669f, -0.2249568f,
  -0.1871666f, +0.0033878f, +0.0481144f, +0.0215874f, -0.0548397f, +0.0182659f, +0.2397168f, -0.0364906f,
  -0.1021497f, +0.3564297f, -0.1546163f, -0.1496778f, -0.3809715f, -0.1739121f, -0.0844410f, +0.1366869f,
  -0.0981878f, -0.2350960f, -0.0756756f, +0.1071335f, +0.3695278f, +0.0856518f, +0.1270814f, -0.1542482f,
  +0.1172686f, +0.2302067f, +0.3411853f, -0.1872750f, +0.4302227f, +0.0797946f, +0.4485445f, -0.1386575f,
  -0.2350864f, +0.0913272f, +0.0089326f, -0.2420287f, -0.3446137f, -0.1340586f, -0.0781811f, +0.0077555f,
  +0.0276353f, -0.2215736f, +0.1344716f, +0.0411637f, +0.4588107f, -0.0406481f, +0.0666466f, -0.3332683f,
  -0.0963957f, -0.0380698f, +0.1531419f, -0.0584947f, -0.2181005f, +0.0918782f, -0.1631626f, +0.3035325f,
  -0.0273076f, +0.0428346f, -0.1372290f, +0.0274933f, +0.0951546f, +0.1359091f, +0.0925988f, -0.0341496f,
  +0.0408556f, +0.0413458f, -0.0265639f, -0.1110869f, -0.1350340f, -0.0780239f, -0.1263779f, +0.0781515f,
  +0.0677878f, +0.1212873f, -0.0243443f, +0.0170301f, +0.0221411f, +0.0776021f, +0.0194270f, +0.0907198f,
  -0.0609432f, +0.3716434f, -0.1312558f, -0.0601226f, -0.2327744f, -0.1424304f, +0.1228007f, +0.0922899f,
  +0.1487685f, +0.0287852f, -0.0342123f, -0.1058964f, -0.2606582f, -0.2522948f, -0.1728589f, +0.1084039f,
  -0.0582532f, -0.0253898f, +0.0125720f, -0.1372988f, -0.0926186f, -0.2688780f, +0.3438816f, +0.0288783f,
  +0.0721307f, +0.1527203f, +0.0866110f, -0.2968807f, +0.0435525f, -0.1828333f, +0.2101463f, -0.1730479f,
  -0.0784907f, +0.1630245f, -0.0202594f, -0.1030619f, -0.2131330f, -0.1337880f, +0.0258275f, +0.2069157f,
  -0.0305767f, +0.0806543f, +0.0351669f, +0.0012006f, -0.1181173f, +0.1173832f, +0.1474878f, +0.0564863f,
  +0.0749011f, -0.0932746f, -0.0940718f, -0.0465803f, -0.3137270f, -0.1082455f, +0.1707354f, -0.1293663f
);

const float biases[4] = float[4](
  -0.0195355f, +0.0016840f, +0.0190729f, +0.0878291f
);

vec4 hook() {
    const vec4 r[9][2] = vec4[9][2](
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 1.0f)))
    );

    float sum[4] = biases;
    for (int n = 0; n < 4; n++) {
        for (int i = 0; i < 9; i++) {
            const vec4 k0 = vec4(kernels[n * 8 * 9 + 8 * i + 0], kernels[n * 8 * 9 + 8 * i + 1], kernels[n * 8 * 9 + 8 * i + 2], kernels[n * 8 * 9 + 8 * i + 3]);
            const vec4 k1 = vec4(kernels[n * 8 * 9 + 8 * i + 4], kernels[n * 8 * 9 + 8 * i + 5], kernels[n * 8 * 9 + 8 * i + 6], kernels[n * 8 * 9 + 8 * i + 7]);
            sum[n] += (dot(k0, r[i][0]) + dot(k1, r[i][1]));
        }
    }

    return ACTIVE(vec4(sum[0], sum[1], sum[2], sum[3]));
}

//!HOOK LUMA
//!DESC ARNet b16 Layer32 L0
//!WHEN OUTPUT.w LUMA.w / 1.2 > OUTPUT.h LUMA.h / 1.2 > *
//!BIND TMP1_L0
//!BIND TMP1_L1
//!BIND TMP2_L0
//!BIND FEAT_L0
//!SAVE TMP2_L0
//!COMPONENTS 4

#define ACTIVE(v) (v)

#define TEX_BIND_L0_TEXOFF TMP1_L0_texOff
#define TEX_BIND_L0_TEX TMP1_L0_tex
#define TEX_BIND_L0_POS TMP1_L0_pos
#define TEX_BIND_L0_SIZE TMP1_L0_size
#define TEX_BIND_L0_PT TMP1_L0_pt

#define TEX_BIND_L1_TEXOFF TMP1_L1_texOff
#define TEX_BIND_L1_TEX TMP1_L1_tex
#define TEX_BIND_L1_POS TMP1_L1_pos
#define TEX_BIND_L1_SIZE TMP1_L1_size
#define TEX_BIND_L1_PT TMP1_L1_pt

#define TEX_BIND_L2_TEXOFF TMP2_L0_texOff
#define TEX_BIND_L2_TEX TMP2_L0_tex
#define TEX_BIND_L2_POS TMP2_L0_pos
#define TEX_BIND_L2_SIZE TMP2_L0_size
#define TEX_BIND_L2_PT TMP2_L0_pt

#define TEX_BIND_L3_TEXOFF FEAT_L0_texOff
#define TEX_BIND_L3_TEX FEAT_L0_tex
#define TEX_BIND_L3_POS FEAT_L0_pos
#define TEX_BIND_L3_SIZE FEAT_L0_size
#define TEX_BIND_L3_PT FEAT_L0_pt

const float kernels[288] = float[288](
  +0.0509024f, +0.1319750f, +0.2166792f, -0.2395208f, -0.0236556f, -0.3233714f, -0.0160905f, -0.3348291f,
  -0.1390264f, +0.4022898f, -0.3792468f, +0.5730367f, +0.0239460f, +0.0644149f, -0.1826249f, -0.2611530f,
  +0.0865750f, +0.2579625f, -0.1056863f, -0.7441373f, +0.2221978f, -0.0779045f, +0.0286833f, -0.0685076f,
  -0.1653079f, +0.0064513f, +0.2970416f, +0.1371047f, -0.0774949f, +0.0786983f, -0.0074317f, +0.1292145f,
  -0.2776659f, +0.0730568f, +0.2415342f, -0.3047658f, +0.0655942f, +0.0584078f, +0.2354558f, -0.3080954f,
  -0.2118312f, -0.3260781f, +0.1264640f, -0.0761215f, -0.0291012f, -0.0206357f, +0.1322309f, -0.0102336f,
  +0.2955507f, -0.3130268f, +0.0979534f, -0.1581370f, -0.0990247f, +0.3987049f, +0.0627278f, -0.0898043f,
  -0.2788088f, +0.7969946f, +0.0652371f, +0.1508346f, +0.1466236f, -0.1914893f, +0.0750703f, -0.0357544f,
  -0.0278767f, +0.4886172f, -0.1712152f, +0.1418597f, +0.1217934f, -0.1910019f, -0.1722951f, -0.1383692f,
  -0.1971265f, -0.0818392f, -0.1004472f, +0.0377438f, +0.0824862f, -0.1300056f, +0.1141548f, -0.0957177f,
  -0.0900392f, -0.0486113f, +0.0371403f, -0.0885044f, +0.0148233f, +0.1947753f, +0.2866058f, +0.0617358f,
  +0.1549420f, -0.2056482f, -0.0147800f, -0.0957624f, -0.1408795f, -0.0389624f, +0.3639130f, -0.1313629f,
  -0.0886699f, -0.0198796f, -0.1165991f, +0.0523873f, +0.0772897f, +0.3933127f, +0.0357181f, -0.0534554f,
  -0.1273678f, +0.0592064f, -0.3028544f, -0.4426654f, -0.0835787f, -0.1061703f, -0.0430396f, +0.0437895f,
  +0.1547440f, +0.0717587f, +0.0506536f, -0.1531079f, +0.1211958f, -0.0533077f, -0.1002220f, -0.0040610f,
  -0.1415917f, +0.0209965f, -0.2254883f, +0.1100269f, +0.2924697f, +0.0289224f, +0.1270794f, -0.1107811f,
  +0.1306709f, -0.1161481f, -0.1089736f, +0.0441943f, +0.1075713f, +0.1655847f, +0.1108237f, +0.0658324f,
  +0.1244864f, -0.0358139f, +0.1005611f, -0.1164824f, +0.1098548f, +0.1754400f, -0.1787917f, -0.1577710f,
  -0.0379041f, +0.0485525f, -0.0643080f, +0.2133921f, -0.0884576f, +0.0783920f, -0.1411160f, -0.0040722f,
  +0.1730386f, -0.3224526f, -0.1250855f, +0.7927762f, -0.4183893f, +0.1111075f, -0.2914571f, -0.2850078f,
  +0.0430400f, -0.0400952f, -0.0258774f, -0.2694523f, +0.0634354f, -0.0173706f, -0.0837172f, -0.2266352f,
  +0.3576753f, -0.3822124f, +0.3092900f, -0.2677018f, -0.2261912f, -0.1824583f, -0.0999736f, +0.0176109f,
  +0.1174316f, -0.1993475f, +0.3841771f, +0.5341362f, -0.7993574f, -0.4779150f, -1.3134277f, -0.0361287f,
  -0.6685277f, +0.0772555f, +0.0532553f, -0.1365191f, -0.4707989f, -0.0679722f, +0.1191280f, -0.2300867f,
  -0.0849142f, +0.0602465f, -0.2764316f, +0.1993490f, -0.0025841f, +0.1379514f, -0.0215927f, -0.1478285f,
  +0.0959231f, -0.5407693f, +0.1040558f, -0.1479107f, -0.1112333f, +0.4946842f, +0.1441890f, +0.0214955f,
  -0.1924663f, -0.2761301f, +0.2148015f, +0.1255225f, -0.0049728f, +0.1179168f, +0.0850463f, +0.1394957f,
  -0.1097281f, -0.0061742f, -0.0782300f, +0.1255555f, -0.0055425f, -0.0193733f, -0.1031020f, +0.1252401f,
  +0.0878024f, -0.0533607f, -0.2463466f, +0.5113019f, -0.1469779f, +0.0354910f, +0.0679286f, +0.0677544f,
  -0.0549813f, -0.3018196f, -0.0288706f, -0.5482440f, +0.1135788f, -0.1781542f, +0.0472384f, +0.1724223f,
  +0.2544529f, -0.4220046f, +0.4129218f, -0.0807808f, +0.2801432f, +0.0527746f, +0.1121608f, +0.4135153f,
  -0.2051398f, -0.3507609f, +0.1842906f, -0.1302656f, +0.4073108f, -1.3251100f, +0.0424781f, -0.0662214f,
  +0.0326985f, -0.1952817f, +0.2244946f, +0.1471138f, +0.1921298f, -0.4089165f, -0.2327877f, +0.1207645f,
  +0.0860167f, -0.1072445f, -0.0835181f, +0.1461045f, +0.0374095f, +0.1583443f, +0.0426945f, +0.0212428f,
  -0.1683373f, +0.6530141f, +0.1988353f, +0.1463504f, +0.0762646f, +0.0495957f, +0.1109713f, -0.1147597f,
  +0.0127799f, -0.0131679f, +0.2553943f, -0.2028037f, -0.0327085f, +0.2712418f, +0.0110386f, +0.1757732f
);

const float biases[4] = float[4](
  -0.0162073f, -0.0081280f, +0.0295866f, +0.0733679f
);

vec4 hook() {
    const vec4 r[9][2] = vec4[9][2](
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 1.0f)))
    );

    float sum[4] = biases;
    for (int n = 0; n < 4; n++) {
        for (int i = 0; i < 9; i++) {
            const vec4 k0 = vec4(kernels[n * 8 * 9 + 8 * i + 0], kernels[n * 8 * 9 + 8 * i + 1], kernels[n * 8 * 9 + 8 * i + 2], kernels[n * 8 * 9 + 8 * i + 3]);
            const vec4 k1 = vec4(kernels[n * 8 * 9 + 8 * i + 4], kernels[n * 8 * 9 + 8 * i + 5], kernels[n * 8 * 9 + 8 * i + 6], kernels[n * 8 * 9 + 8 * i + 7]);
            sum[n] += (dot(k0, r[i][0]) + dot(k1, r[i][1]));
        }
    }

    return ACTIVE(vec4(sum[0], sum[1], sum[2], sum[3]) * 0.2000000f + TEX_BIND_L2_TEXOFF(vec2(0.0f, 0.0f)) + TEX_BIND_L3_TEXOFF(vec2(0.0f, 0.0f)));
}

//!HOOK LUMA
//!DESC ARNet b16 Layer32 L1
//!WHEN OUTPUT.w LUMA.w / 1.2 > OUTPUT.h LUMA.h / 1.2 > *
//!BIND TMP1_L0
//!BIND TMP1_L1
//!BIND TMP2_L1
//!BIND FEAT_L1
//!SAVE TMP2_L1
//!COMPONENTS 4

#define ACTIVE(v) (v)

#define TEX_BIND_L0_TEXOFF TMP1_L0_texOff
#define TEX_BIND_L0_TEX TMP1_L0_tex
#define TEX_BIND_L0_POS TMP1_L0_pos
#define TEX_BIND_L0_SIZE TMP1_L0_size
#define TEX_BIND_L0_PT TMP1_L0_pt

#define TEX_BIND_L1_TEXOFF TMP1_L1_texOff
#define TEX_BIND_L1_TEX TMP1_L1_tex
#define TEX_BIND_L1_POS TMP1_L1_pos
#define TEX_BIND_L1_SIZE TMP1_L1_size
#define TEX_BIND_L1_PT TMP1_L1_pt

#define TEX_BIND_L2_TEXOFF TMP2_L1_texOff
#define TEX_BIND_L2_TEX TMP2_L1_tex
#define TEX_BIND_L2_POS TMP2_L1_pos
#define TEX_BIND_L2_SIZE TMP2_L1_size
#define TEX_BIND_L2_PT TMP2_L1_pt

#define TEX_BIND_L3_TEXOFF FEAT_L1_texOff
#define TEX_BIND_L3_TEX FEAT_L1_tex
#define TEX_BIND_L3_POS FEAT_L1_pos
#define TEX_BIND_L3_SIZE FEAT_L1_size
#define TEX_BIND_L3_PT FEAT_L1_pt

const float kernels[288] = float[288](
  +0.0102786f, -0.1646933f, +0.0884847f, +0.0299887f, -0.1071298f, +0.0284882f, +0.1283576f, +0.1887081f,
  -0.0910093f, +0.1131443f, -0.0218055f, -0.1729903f, +0.2149780f, -0.1760908f, +0.2107005f, -0.0249637f,
  -0.0772326f, -0.0893000f, +0.0913157f, +0.1507670f, +0.0801576f, +0.1706774f, +0.0012961f, +0.2412039f,
  +0.0414237f, -0.3420543f, +0.0815855f, +0.0295166f, -0.0081461f, +0.1676634f, +0.1412254f, +0.1821753f,
  -0.0997638f, +0.1664644f, -0.2114778f, -0.2544300f, +0.0741434f, -0.1849842f, -0.1489811f, +0.0018819f,
  +0.2438048f, +0.5153356f, -0.2344647f, +0.0947160f, +0.0150149f, -0.1118776f, -0.1868946f, -0.0788115f,
  +0.0105281f, -0.0315964f, -0.0703291f, -0.0497680f, -0.0192001f, +0.0812286f, +0.2661787f, +0.1671847f,
  -0.0716284f, -0.0376156f, +0.2219184f, -0.0000851f, -0.0380599f, -0.1341517f, -0.0927808f, -0.0833990f,
  -0.0033884f, +0.3621251f, -0.1007105f, +0.0092191f, -0.0228963f, +0.0936574f, +0.1443811f, +0.1888251f,
  +0.0922766f, +0.1372725f, -0.0002445f, +0.0154205f, -0.0219152f, -0.1265971f, -0.0365539f, -0.1087910f,
  -0.0495801f, +0.1432939f, +0.0475630f, +0.0203872f, +0.1260506f, -0.0578164f, -0.2601830f, +0.2579818f,
  +0.1198907f, +0.1754173f, -0.0926415f, +0.0115247f, -0.0394837f, -0.0821613f, +0.0259846f, -0.2031695f,
  -0.0440585f, +0.3263447f, -0.0840633f, -0.1545125f, +0.1202709f, -0.0004136f, -0.3104684f, +0.0185552f,
  +0.5444956f, +0.1932316f, +0.1456115f, -0.5694072f, +0.0647229f, +0.4789522f, -0.1823236f, -0.0799167f,
  -0.1761933f, -0.1345619f, -0.1092112f, -0.1808521f, -0.0705808f, +0.1374279f, -0.0410707f, +0.1156146f,
  +0.0354112f, +0.2264168f, -0.0693057f, +0.0609502f, -0.0400960f, +0.0310116f, +0.1780729f, -0.0372939f,
  -0.4400795f, +0.4670991f, -0.4121104f, +0.1418516f, +0.2275239f, +0.1091162f, +0.2007026f, -0.0299595f,
  +0.0733125f, -0.0620702f, +0.0012313f, +0.0519253f, -0.0270052f, +0.0012830f, -0.2156448f, +0.0360639f,
  +0.1408985f, +0.1866476f, +0.0960195f, -0.0784028f, -0.0440791f, +0.0326660f, +0.0045127f, +0.1822322f,
  +0.0279688f, -0.0296590f, +0.0159442f, +0.3211197f, -0.0576934f, +0.0424824f, -0.2556427f, +0.1688696f,
  -0.0919229f, +0.0787071f, +0.0811770f, -0.1880438f, +0.2798352f, -0.1513170f, -0.0501258f, +0.0763220f,
  +0.0751708f, +0.2461186f, -0.0037731f, -0.3008256f, -0.2418577f, -0.1116620f, -0.1341277f, -0.2600473f,
  +0.1141241f, +0.2928069f, -0.0299216f, +0.4555632f, -0.1002981f, +0.0894730f, -0.1302171f, -0.1895786f,
  -0.1378142f, -0.4065353f, +0.1051185f, -0.0257329f, +0.1544245f, -0.1081290f, +0.1579814f, -0.0082174f,
  -0.0621585f, +0.0635033f, +0.0244797f, -0.0903639f, -0.1829523f, -0.0032262f, -0.1665153f, -0.0860674f,
  +0.0681551f, +0.1134155f, -0.0035348f, +0.0109058f, -0.0294859f, -0.0473855f, -0.1697198f, -0.0066823f,
  -0.0179220f, -0.1810504f, -0.0971676f, +0.0987445f, +0.0302834f, -0.2394575f, +0.0370345f, +0.0146064f,
  +0.1240227f, +0.1043258f, -0.0258123f, +0.1397119f, -0.1040712f, +0.0585391f, +0.0502379f, +0.1732880f,
  +0.0248940f, -0.0142362f, +0.0022771f, +0.0598430f, +0.1636356f, -0.1712145f, -0.0159136f, +0.1243130f,
  +0.0837592f, -0.0028536f, +0.1128542f, +0.1482510f, +0.0418819f, +0.0447910f, -0.1225714f, +0.0775751f,
  -0.1428863f, +0.2235443f, +0.4886308f, -0.1849203f, +0.2200838f, -0.4628095f, +0.1836923f, +0.3793241f,
  -0.1996213f, +0.4808379f, +0.3612819f, +0.1374640f, +0.0870488f, -0.8881758f, +0.1076245f, +0.0826720f,
  +0.3554765f, +0.5715269f, -0.0418347f, +0.1469171f, +0.0084440f, -0.1062881f, +0.1983002f, -0.2143813f,
  +0.1241051f, -0.3326135f, +0.3590022f, -0.2483102f, -0.1275599f, +0.0539281f, -0.0074153f, +0.0503316f,
  +0.1479754f, -0.2364345f, +0.6297570f, -0.0976223f, +0.0253737f, -0.3515994f, -0.3442707f, -0.0128121f,
  +0.2287861f, -0.2112456f, -0.0997073f, -0.0452044f, +0.1066203f, -0.0738220f, +0.0657455f, +0.0564445f
);

const float biases[4] = float[4](
  +0.0384450f, -0.0264234f, -0.0366073f, +0.0230661f
);

vec4 hook() {
    const vec4 r[9][2] = vec4[9][2](
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 1.0f)))
    );

    float sum[4] = biases;
    for (int n = 0; n < 4; n++) {
        for (int i = 0; i < 9; i++) {
            const vec4 k0 = vec4(kernels[n * 8 * 9 + 8 * i + 0], kernels[n * 8 * 9 + 8 * i + 1], kernels[n * 8 * 9 + 8 * i + 2], kernels[n * 8 * 9 + 8 * i + 3]);
            const vec4 k1 = vec4(kernels[n * 8 * 9 + 8 * i + 4], kernels[n * 8 * 9 + 8 * i + 5], kernels[n * 8 * 9 + 8 * i + 6], kernels[n * 8 * 9 + 8 * i + 7]);
            sum[n] += (dot(k0, r[i][0]) + dot(k1, r[i][1]));
        }
    }

    return ACTIVE(vec4(sum[0], sum[1], sum[2], sum[3]) * 0.2000000f + TEX_BIND_L2_TEXOFF(vec2(0.0f, 0.0f)) + TEX_BIND_L3_TEXOFF(vec2(0.0f, 0.0f)));
}

//!HOOK LUMA
//!DESC ARNet b16 Layer33 L0
//!WHEN OUTPUT.w LUMA.w / 1.2 > OUTPUT.h LUMA.h / 1.2 > *
//!BIND TMP2_L0
//!BIND TMP2_L1
//!SAVE TMP1_L0
//!COMPONENTS 4

#define ACTIVE(v) (v)

#define TEX_BIND_L0_TEXOFF TMP2_L0_texOff
#define TEX_BIND_L0_TEX TMP2_L0_tex
#define TEX_BIND_L0_POS TMP2_L0_pos
#define TEX_BIND_L0_SIZE TMP2_L0_size
#define TEX_BIND_L0_PT TMP2_L0_pt

#define TEX_BIND_L1_TEXOFF TMP2_L1_texOff
#define TEX_BIND_L1_TEX TMP2_L1_tex
#define TEX_BIND_L1_POS TMP2_L1_pos
#define TEX_BIND_L1_SIZE TMP2_L1_size
#define TEX_BIND_L1_PT TMP2_L1_pt

const float kernels[288] = float[288](
  +0.0315489f, +0.0386041f, +0.1144864f, -0.0272824f, +0.0028344f, +0.1167805f, -0.1450538f, +0.0577040f,
  +0.0764475f, +0.2364019f, +0.0042557f, -0.1294886f, -0.1542243f, -0.6051428f, +0.1486147f, +0.1702016f,
  +0.1581650f, -0.0266894f, -0.0783823f, -0.0064914f, -0.0111563f, +0.0977638f, -0.1704776f, +0.0676652f,
  -0.0697204f, +0.0043375f, +0.1072922f, -0.2080727f, +0.1392122f, -0.0524468f, -0.1154618f, +0.0207957f,
  -0.1363328f, +0.0506282f, +0.1135946f, -0.2598327f, -0.2445002f, +0.0147446f, +0.3625350f, -0.1442838f,
  -0.1382248f, -0.0117150f, +0.0055627f, +0.0002005f, -0.2571824f, +0.0105845f, +0.0082183f, -0.1158603f,
  +0.0238422f, -0.0845242f, -0.0074118f, +0.0607248f, +0.0317566f, +0.0525539f, +0.0317121f, -0.1175449f,
  +0.0867585f, +0.1501385f, -0.0576712f, -0.0116396f, -0.3430667f, -0.1803152f, -0.0979763f, +0.1711475f,
  -0.0932245f, -0.0928861f, +0.0090666f, +0.1024145f, +0.2209667f, +0.1536021f, +0.0742691f, -0.0527376f,
  +0.0665806f, +0.1758429f, +0.0975256f, -0.0392927f, -0.0986711f, -0.1947643f, +0.0603291f, +0.0806857f,
  +0.0711626f, +0.2716368f, +0.0926875f, -0.0935599f, -0.0381642f, -0.0405398f, +0.0588138f, +0.0115487f,
  +0.0274521f, +0.1117240f, +0.0921747f, +0.0103898f, +0.0901853f, +0.1360202f, +0.0449042f, +0.0503844f,
  +0.0528633f, -0.0626568f, +0.0484604f, +0.0483772f, -0.2432481f, +0.0211854f, -0.0488958f, +0.0320489f,
  -0.2367811f, -0.0263464f, -0.5170082f, -0.0613431f, -0.0173205f, -0.0854485f, +0.2284262f, -0.0625297f,
  -0.0596396f, +0.1743448f, +0.0886733f, -0.1081861f, +0.1480177f, +0.0967624f, +0.1898772f, +0.0385037f,
  -0.0416857f, -0.0101630f, -0.0892057f, +0.0614917f, -0.1037465f, -0.0061373f, +0.0023708f, +0.0065546f,
  +0.1766992f, +0.0565187f, -0.0052722f, -0.0004669f, +0.1768673f, -0.1301304f, +0.0381014f, -0.2051737f,
  -0.0264858f, -0.0013867f, +0.0321512f, -0.0304110f, -0.0733391f, -0.1131888f, -0.0303171f, +0.0006045f,
  +0.0265146f, -0.0958393f, +0.0655507f, -0.0440990f, +0.1684677f, +0.0734929f, -0.1017015f, -0.1499187f,
  -0.0980042f, +0.0307581f, -0.1379174f, +0.1550631f, -0.0869489f, +0.0773883f, +0.1844414f, +0.0274919f,
  +0.0515945f, +0.1505176f, -0.0609571f, -0.0834771f, -0.1048314f, -0.0736785f, +0.1054011f, -0.0101529f,
  +0.1414645f, -0.0782935f, +0.0298188f, +0.0191655f, +0.0740785f, +0.0389121f, -0.1644709f, +0.1104297f,
  -0.0748433f, +0.1784110f, +0.3733729f, -0.0743102f, -0.0135703f, -0.2197385f, +0.3256495f, +0.3348740f,
  -0.0385287f, -0.1322569f, +0.0092189f, -0.0690254f, -0.1117980f, +0.0025337f, -0.0586494f, -0.1217365f,
  +0.0699109f, -0.1088969f, -0.0317275f, -0.0282083f, -0.3121684f, -0.0669419f, -0.1361741f, -0.0416975f,
  -0.0431817f, +0.0673749f, -0.1229354f, +0.1367564f, -0.2198868f, -0.1770130f, +0.2767865f, -0.0512411f,
  -0.0276596f, +0.2305948f, +0.0353480f, -0.0516578f, +0.1282932f, +0.0947776f, +0.2259715f, +0.0102608f,
  -0.1256673f, +0.0321475f, +0.0548566f, +0.0199382f, -0.1367695f, -0.0541895f, +0.0365881f, -0.0183314f,
  -0.0061711f, +0.2515030f, -0.0313998f, +0.0669085f, +0.0464916f, +0.4241069f, +0.1009578f, -0.0359796f,
  +0.0079852f, +0.1997301f, +0.0540061f, -0.1403843f, -0.0495237f, -0.0666801f, +0.1333892f, -0.0862082f,
  -0.0489355f, -0.0022273f, +0.0722737f, -0.0280757f, +0.0869842f, -0.0889969f, -0.0361369f, -0.1179250f,
  -0.1414125f, +0.0726451f, -0.3530190f, +0.1790581f, -0.1294800f, -0.0716939f, +0.1136410f, +0.4620511f,
  +0.0595883f, -0.0649124f, -0.0679151f, +0.0476541f, -0.1606079f, +0.2730197f, -0.1129041f, +0.4016936f,
  +0.0666935f, -0.0680438f, -0.0641504f, +0.1287080f, -0.0201066f, -0.0765066f, +0.2563002f, -0.1631068f,
  +0.1437926f, +0.0325277f, -0.0188180f, -0.2618540f, -0.2722632f, -0.0897544f, -0.2489351f, +0.0101241f,
  +0.0687782f, -0.0474782f, +0.0499144f, -0.0183994f, -0.0013513f, -0.2318722f, -0.0561501f, -0.1411118f
);

const float biases[4] = float[4](
  +0.0893852f, +0.0492418f, +0.0700875f, +0.0512413f
);

vec4 hook() {
    const vec4 r[9][2] = vec4[9][2](
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 1.0f)))
    );

    float sum[4] = biases;
    for (int n = 0; n < 4; n++) {
        for (int i = 0; i < 9; i++) {
            const vec4 k0 = vec4(kernels[n * 8 * 9 + 8 * i + 0], kernels[n * 8 * 9 + 8 * i + 1], kernels[n * 8 * 9 + 8 * i + 2], kernels[n * 8 * 9 + 8 * i + 3]);
            const vec4 k1 = vec4(kernels[n * 8 * 9 + 8 * i + 4], kernels[n * 8 * 9 + 8 * i + 5], kernels[n * 8 * 9 + 8 * i + 6], kernels[n * 8 * 9 + 8 * i + 7]);
            sum[n] += (dot(k0, r[i][0]) + dot(k1, r[i][1]));
        }
    }

    return ACTIVE(vec4(sum[0], sum[1], sum[2], sum[3]));
}

//!HOOK LUMA
//!DESC ACNet b16 Layer34 L0
//!WIDTH LUMA.w 2 *
//!HEIGHT LUMA.h 2 *
//!BIND TMP1_L0
//!COMPONENTS 1

#define TEX_BIND_L0_TEXOFF TMP1_L0_texOff
#define TEX_BIND_L0_TEX TMP1_L0_tex
#define TEX_BIND_L0_POS TMP1_L0_pos
#define TEX_BIND_L0_SIZE TMP1_L0_size
#define TEX_BIND_L0_PT TMP1_L0_pt

vec4 hook() {
    vec2 fcoord = fract(TEX_BIND_L0_POS * TEX_BIND_L0_SIZE);
    vec2 pos = TEX_BIND_L0_POS + (vec2(0.5f) - fcoord) * TEX_BIND_L0_PT;

    ivec2 icoord = ivec2(fcoord * vec2(2.0f));
    int index = icoord.y * 2 + icoord.x;

    vec4 r = TEX_BIND_L0_TEX(pos);

    return vec4(clamp(float[4](r.x, r.y, r.z, r.w)[index], 0.0f, 1.0f), 0.0f, 0.0f, 1.0f);
}
