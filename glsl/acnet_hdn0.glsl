//!HOOK LUMA
//!DESC ACNet Layer0 L0
//!WHEN OUTPUT.w LUMA.w / 1.2 > OUTPUT.h LUMA.h / 1.2 > *
//!BIND LUMA
//!SAVE TMP1_L0
//!COMPONENTS 4

#define ACTIVE(v) (max(v, 0.0f))

#define TEX_BIND_L0_TEXOFF LUMA_texOff
#define TEX_BIND_L0_TEX LUMA_tex
#define TEX_BIND_L0_POS LUMA_pos
#define TEX_BIND_L0_SIZE LUMA_size
#define TEX_BIND_L0_PT LUMA_pt

const float kernels[36] = float[36](
  +0.0609167f, +0.1026869f, -0.0446562f, -0.1422654f, +0.7196311f, +0.1803083f, +0.0841538f, +0.0696245f,
  +0.0081500f, +0.0088709f, +0.1539806f, -0.8588956f, +0.0447586f, +0.8659100f, -0.2420293f, -0.0364230f,
  +0.0584637f, +0.0124604f, -0.1937400f, +0.7258638f, +0.0118686f, -0.8265947f, +0.4147095f, +0.0087535f,
  -0.0452930f, -0.0451417f, -0.0181979f, +0.0263619f, -0.9421819f, +0.1257891f, -0.0542900f, +0.1281520f,
  +0.7101893f, -0.0105978f, +0.0385919f, -0.0140545f
);

const float biases[4] = float[4](
  -0.7576970f, -0.0209786f, +0.0291682f, -0.0188724f
);

vec4 hook() {
    const vec4 r0 = vec4(
        TEX_BIND_L0_TEXOFF(vec2(-1.0f,-1.0f)).x,
        TEX_BIND_L0_TEXOFF(vec2( 0.0f,-1.0f)).x,
        TEX_BIND_L0_TEXOFF(vec2( 1.0f,-1.0f)).x,
        TEX_BIND_L0_TEXOFF(vec2(-1.0f, 0.0f)).x
    );
    const vec4 r4 = vec4(
        TEX_BIND_L0_TEXOFF(vec2( 0.0f, 0.0f)).x,
        TEX_BIND_L0_TEXOFF(vec2( 1.0f, 0.0f)).x,
        TEX_BIND_L0_TEXOFF(vec2(-1.0f, 1.0f)).x,
        TEX_BIND_L0_TEXOFF(vec2( 0.0f, 1.0f)).x
    );
    const float r8 = TEX_BIND_L0_TEXOFF(vec2( 1.0f, 1.0f)).x;

    float sum[4] = biases;
    for(int n = 0; n < 4; n++) {
        const vec4 k0 = vec4(kernels[n * 9 + 0], kernels[n * 9 + 1], kernels[n * 9 + 2], kernels[n * 9 + 3]);
        const vec4 k4 = vec4(kernels[n * 9 + 4], kernels[n * 9 + 5], kernels[n * 9 + 6], kernels[n * 9 + 7]);
        const float k8 = kernels[n * 9 + 8];
        sum[n] += (dot(r0, k0) + dot(r4, k4) + r8 * k8);
    }

    return ACTIVE(vec4(sum[0], sum[1], sum[2], sum[3]));
}

//!HOOK LUMA
//!DESC ACNet Layer0 L1
//!WHEN OUTPUT.w LUMA.w / 1.2 > OUTPUT.h LUMA.h / 1.2 > *
//!BIND LUMA
//!SAVE TMP1_L1
//!COMPONENTS 4

#define ACTIVE(v) (max(v, 0.0f))

#define TEX_BIND_L0_TEXOFF LUMA_texOff
#define TEX_BIND_L0_TEX LUMA_tex
#define TEX_BIND_L0_POS LUMA_pos
#define TEX_BIND_L0_SIZE LUMA_size
#define TEX_BIND_L0_PT LUMA_pt

const float kernels[36] = float[36](
  +0.2054345f, -0.0392909f, +0.1494267f, +0.3106026f, +0.5721686f, +0.2640297f, +0.1708098f, -0.1640398f,
  -0.0212399f, +0.0558480f, -0.2887183f, -0.1666377f, +0.3122742f, -0.3097007f, -0.2281357f, +0.2879600f,
  +0.3001047f, +0.0526150f, -0.0319790f, +0.0583938f, -0.0193412f, -0.0135322f, +1.0649008f, -0.1245574f,
  +0.0282651f, -0.3030245f, -0.6377528f, -0.0039509f, -0.9121528f, +0.0181378f, +0.0365112f, +0.8946607f,
  -0.0419530f, -0.0199097f, +0.0217237f, +0.0060134f
);

const float biases[4] = float[4](
  +0.0222594f, +0.0339571f, +0.0150339f, -0.0044279f
);

vec4 hook() {
    const vec4 r0 = vec4(
        TEX_BIND_L0_TEXOFF(vec2(-1.0f,-1.0f)).x,
        TEX_BIND_L0_TEXOFF(vec2( 0.0f,-1.0f)).x,
        TEX_BIND_L0_TEXOFF(vec2( 1.0f,-1.0f)).x,
        TEX_BIND_L0_TEXOFF(vec2(-1.0f, 0.0f)).x
    );
    const vec4 r4 = vec4(
        TEX_BIND_L0_TEXOFF(vec2( 0.0f, 0.0f)).x,
        TEX_BIND_L0_TEXOFF(vec2( 1.0f, 0.0f)).x,
        TEX_BIND_L0_TEXOFF(vec2(-1.0f, 1.0f)).x,
        TEX_BIND_L0_TEXOFF(vec2( 0.0f, 1.0f)).x
    );
    const float r8 = TEX_BIND_L0_TEXOFF(vec2( 1.0f, 1.0f)).x;

    float sum[4] = biases;
    for(int n = 0; n < 4; n++) {
        const vec4 k0 = vec4(kernels[n * 9 + 0], kernels[n * 9 + 1], kernels[n * 9 + 2], kernels[n * 9 + 3]);
        const vec4 k4 = vec4(kernels[n * 9 + 4], kernels[n * 9 + 5], kernels[n * 9 + 6], kernels[n * 9 + 7]);
        const float k8 = kernels[n * 9 + 8];
        sum[n] += (dot(r0, k0) + dot(r4, k4) + r8 * k8);
    }

    return ACTIVE(vec4(sum[0], sum[1], sum[2], sum[3]));
}

//!HOOK LUMA
//!DESC ACNet Layer1 L0
//!WHEN OUTPUT.w LUMA.w / 1.2 > OUTPUT.h LUMA.h / 1.2 > *
//!BIND TMP1_L0
//!BIND TMP1_L1
//!SAVE TMP2_L0
//!COMPONENTS 4

#define ACTIVE(v) (max(v, 0.0f))

#define TEX_BIND_L0_TEXOFF TMP1_L0_texOff
#define TEX_BIND_L0_TEX TMP1_L0_tex
#define TEX_BIND_L0_POS TMP1_L0_pos
#define TEX_BIND_L0_SIZE TMP1_L0_size
#define TEX_BIND_L0_PT TMP1_L0_pt

#define TEX_BIND_L1_TEXOFF TMP1_L1_texOff
#define TEX_BIND_L1_TEX TMP1_L1_tex
#define TEX_BIND_L1_POS TMP1_L1_pos
#define TEX_BIND_L1_SIZE TMP1_L1_size
#define TEX_BIND_L1_PT TMP1_L1_pt

const float kernels[288] = float[288](
  +0.2061127f, -0.1130811f, +0.0216141f, +0.3371021f, +0.0194948f, -0.1074388f, +0.3642107f, +0.0766090f,
  +0.0668646f, -0.0642275f, -0.0688703f, +0.0921263f, +0.2693967f, -0.1591485f, +0.3025189f, -0.1012123f,
  -0.0991234f, -0.0880814f, -0.2470747f, +0.0368798f, -0.1405008f, -0.0115281f, -0.1356234f, +0.0363185f,
  +0.0852787f, +0.0278103f, +0.0968675f, +0.0570042f, +0.0503255f, -0.1147005f, +0.1523823f, +0.0935365f,
  -0.0455485f, -0.1605354f, -0.1656092f, +0.0401749f, -0.0459201f, +0.0634549f, -0.1986791f, +0.0603863f,
  -0.0294912f, -0.1198532f, +0.0282810f, +0.1611605f, -0.1358576f, -0.0555577f, -0.0326437f, +0.1008619f,
  -0.1035786f, -0.2867883f, -0.0824692f, +0.2562884f, +0.0594584f, -0.0699204f, -0.0428491f, -0.2663021f,
  -0.0248444f, -0.0177845f, -0.0985540f, +0.5115377f, +0.1385984f, -0.0301419f, +0.0136766f, +0.0258747f,
  -0.0081539f, +0.1155948f, -0.0171470f, +0.0241193f, -0.2106537f, -0.0490588f, +0.0738544f, -0.1922525f,
  +0.0406875f, -0.0357386f, +0.0034954f, +0.0547854f, +0.0199614f, -0.0086109f, -0.0876095f, -0.0286541f,
  +0.1100523f, -0.0752998f, -0.0667069f, -0.0145026f, -0.0810146f, +0.0749773f, -0.0771919f, -0.0641658f,
  +0.0099578f, -0.0167881f, +0.1455051f, -0.0015188f, -0.0322638f, +0.0940786f, +0.0509187f, +0.0548889f,
  +0.1693908f, +0.0303159f, +0.0762580f, +0.1674794f, +0.1054426f, -0.1272593f, -0.1402104f, +0.0826894f,
  +0.5087154f, +0.1594250f, +0.1489269f, -0.0052731f, +0.1884385f, -0.2966362f, +0.3569587f, +0.0844632f,
  +0.0898761f, -0.0908780f, -0.1525522f, -0.0198997f, +0.0074274f, +0.0078153f, +0.0120791f, +0.0223389f,
  +0.0695613f, -0.0637367f, +0.0624417f, +0.0447860f, +0.0667286f, -0.0484126f, -0.0203177f, +0.1080454f,
  +0.1191030f, +0.0261410f, +0.2216566f, -0.1066935f, -0.0783177f, -0.1845000f, -0.0188274f, -0.1256644f,
  -0.0180911f, +0.0088040f, +0.0753265f, +0.1319231f, +0.0307753f, -0.0710653f, +0.0390836f, +0.1710867f,
  -0.0613377f, +0.0490080f, -0.0311812f, -0.0808811f, -0.0855375f, -0.0223841f, -0.0528792f, -0.0326072f,
  -0.0340428f, -0.0436776f, +0.0323478f, -0.0296428f, -0.1445596f, -0.0197877f, +0.1548627f, +0.0733283f,
  +0.0404731f, +0.0223624f, -0.0490810f, -0.0796268f, -0.0756644f, -0.0405475f, +0.0108291f, -0.0064738f,
  +0.0638214f, -0.0779028f, -0.0679660f, +0.1401997f, -0.0399205f, +0.1006971f, +0.1471590f, -0.1003142f,
  +0.1762638f, -0.0382517f, -0.0248957f, +0.2157509f, +0.0406595f, +0.2958096f, +0.3425673f, -0.1769770f,
  -0.0581120f, -0.0522708f, -0.0653235f, +0.0081244f, +0.1781189f, +0.1993633f, -0.0032058f, -0.0942011f,
  -0.0950018f, -0.0188835f, +0.0807425f, +0.2156125f, +0.1157952f, -0.1195689f, -0.0216870f, -0.0336437f,
  +0.0133265f, -0.1285883f, +0.2609259f, -0.2930524f, +0.0566285f, -0.0865076f, +0.0586408f, -0.3586015f,
  +0.1224184f, +0.0411722f, -0.2463788f, -0.0255350f, +0.0900078f, -0.0008254f, -0.0638061f, -0.0932000f,
  -0.0741421f, -0.1058807f, -0.0201005f, +0.0033562f, -0.0332937f, +0.0289095f, +0.1205190f, -0.0904059f,
  +0.0550008f, -0.2300022f, +0.1069953f, +0.0766525f, -0.1300552f, +0.1222908f, -0.0219822f, -0.1417437f,
  +0.0437415f, -0.0115573f, +0.1610846f, +0.0459735f, -0.1011095f, +0.1843883f, -0.1308807f, +0.0989692f,
  -0.0022447f, -0.0902543f, +0.0284224f, -0.0136171f, +0.0558127f, +0.0164130f, +0.0286645f, -0.0665728f,
  +0.1194072f, +0.2335181f, +0.2790861f, -0.1401439f, +0.2112661f, +0.1587045f, -0.0506701f, -0.2442466f,
  -0.0161349f, -0.1362242f, +0.3834232f, -0.0192531f, +0.0202479f, -0.1161570f, +0.2292672f, -0.0351255f,
  -0.0147642f, -0.0019256f, +0.0140255f, +0.1102037f, -0.0009639f, -0.0016032f, +0.0204606f, +0.0938594f,
  -0.0101937f, -0.0533722f, +0.0909654f, -0.1967753f, -0.0052497f, -0.0068258f, +0.0077250f, +0.1905764f,
  +0.0325401f, +0.1031442f, +0.2021758f, +0.0671234f, +0.1113364f, -0.0218828f, -0.0266303f, -0.1656950f
);

const float biases[4] = float[4](
  +0.0271619f, -0.5743008f, -0.0332987f, -0.0334286f
);

vec4 hook() {
    const vec4 r[9][2] = vec4[9][2](
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 1.0f)))
    );

    float sum[4] = biases;
    for (int n = 0; n < 4; n++) {
        for (int i = 0; i < 9; i++) {
            const vec4 k0 = vec4(kernels[n * 8 * 9 + 8 * i + 0], kernels[n * 8 * 9 + 8 * i + 1], kernels[n * 8 * 9 + 8 * i + 2], kernels[n * 8 * 9 + 8 * i + 3]);
            const vec4 k1 = vec4(kernels[n * 8 * 9 + 8 * i + 4], kernels[n * 8 * 9 + 8 * i + 5], kernels[n * 8 * 9 + 8 * i + 6], kernels[n * 8 * 9 + 8 * i + 7]);
            sum[n] += (dot(k0, r[i][0]) + dot(k1, r[i][1]));
        }
    }

    return ACTIVE(vec4(sum[0], sum[1], sum[2], sum[3]));
}

//!HOOK LUMA
//!DESC ACNet Layer1 L1
//!WHEN OUTPUT.w LUMA.w / 1.2 > OUTPUT.h LUMA.h / 1.2 > *
//!BIND TMP1_L0
//!BIND TMP1_L1
//!SAVE TMP2_L1
//!COMPONENTS 4

#define ACTIVE(v) (max(v, 0.0f))

#define TEX_BIND_L0_TEXOFF TMP1_L0_texOff
#define TEX_BIND_L0_TEX TMP1_L0_tex
#define TEX_BIND_L0_POS TMP1_L0_pos
#define TEX_BIND_L0_SIZE TMP1_L0_size
#define TEX_BIND_L0_PT TMP1_L0_pt

#define TEX_BIND_L1_TEXOFF TMP1_L1_texOff
#define TEX_BIND_L1_TEX TMP1_L1_tex
#define TEX_BIND_L1_POS TMP1_L1_pos
#define TEX_BIND_L1_SIZE TMP1_L1_size
#define TEX_BIND_L1_PT TMP1_L1_pt

const float kernels[288] = float[288](
  -0.0049163f, +0.0048031f, -0.0607415f, +0.0368567f, +0.0147175f, +0.0868448f, -0.1152136f, +0.0028548f,
  +0.0741487f, +0.2520573f, +0.0357587f, -0.0202114f, +0.1899021f, -0.1241020f, +0.1438934f, -0.0028078f,
  +0.0633453f, +0.0803160f, -0.1882852f, -0.0933415f, +0.1178950f, -0.4466892f, +0.0505074f, +0.0811286f,
  -0.0178883f, +0.1510174f, -0.0011295f, +0.0208273f, -0.1501848f, +0.0279296f, -0.0166181f, -0.0459734f,
  -0.0918756f, +0.0412356f, -0.0623221f, +0.0688742f, -0.2307086f, -0.0547133f, -0.2515041f, +0.0036740f,
  +0.1372786f, +0.2233899f, +0.8497391f, -0.0602869f, +0.1751117f, -0.0779225f, -0.0497595f, +0.2074586f,
  -0.0960981f, +0.2850030f, -0.0398173f, -0.0697239f, -0.0776048f, +0.0860002f, +0.0771664f, -0.0981911f,
  -0.0348141f, +0.1510564f, -0.2066601f, +0.1442298f, +0.0506210f, -0.0263714f, +0.0045033f, +0.1280711f,
  -0.0108625f, +0.0009632f, +0.2296067f, -0.0760167f, -0.1038060f, -0.0865414f, -0.0546491f, +0.0081950f,
  +0.1423995f, -0.0318289f, -0.0041567f, +0.0854751f, +0.0721500f, -0.0408863f, -0.3623587f, +0.0011104f,
  +0.1510428f, +0.1520745f, +0.0667526f, +0.0178544f, +0.1756981f, +0.0188329f, -0.2532564f, +0.0171475f,
  +0.0696238f, +0.0205749f, -0.1576676f, -0.0640787f, +0.1671632f, -0.0082903f, +0.0563313f, +0.0331154f,
  +0.2230899f, -0.1250596f, +0.0637683f, +0.1876021f, +0.0624314f, +0.0139944f, +0.0987615f, -0.0336632f,
  +0.2568780f, +0.2927439f, +0.0830080f, +0.1528506f, +0.2375460f, -0.1084596f, +0.3804929f, +0.0746147f,
  +0.0947663f, +0.0947123f, -0.3563912f, -0.0356145f, +0.2855378f, +0.0353146f, +0.0598850f, +0.0642114f,
  +0.0625603f, -0.2051989f, +0.0446601f, +0.0107470f, +0.0357906f, -0.0626736f, -0.0305409f, -0.0734409f,
  +0.0713465f, +0.0004989f, +0.2699645f, -0.3133025f, +0.2818473f, +0.0628056f, +0.0798549f, -0.1556753f,
  +0.0414324f, +0.0561713f, -0.0640141f, -0.0486639f, +0.1581031f, +0.0221678f, -0.0586393f, +0.0765460f,
  +0.0618021f, -0.0552940f, -0.0026139f, -0.1029207f, +0.0082944f, +0.0907230f, +0.2378931f, +0.0482364f,
  -0.1529997f, -0.1183887f, -0.0169071f, -0.1208429f, -0.1467959f, +0.0554693f, -0.0023687f, +0.1694494f,
  -0.0182095f, +0.0038867f, +0.1169325f, -0.0966755f, -0.0173707f, -0.1409121f, -0.0053264f, +0.1367304f,
  -0.0092786f, +0.1726193f, -0.0094871f, +0.0181027f, -0.1653403f, +0.0834040f, -0.1116114f, +0.1123567f,
  +0.1662243f, +0.4274291f, +0.0384877f, +0.3065773f, +0.2575176f, +0.1374066f, +0.0193513f, +0.7231783f,
  +0.1135421f, +0.0689698f, -0.0483509f, -0.0777546f, +0.1112866f, -0.0354384f, +0.0508315f, -0.0416176f,
  +0.0095865f, -0.2023236f, -0.0921713f, -0.0243616f, -0.0941509f, +0.0326811f, +0.0082246f, +0.2749392f,
  -0.0242256f, -0.1456361f, +0.0482267f, -0.1986169f, -0.1322492f, +0.0284913f, +0.0298917f, +0.1008117f,
  -0.0014750f, +0.0230253f, +0.0973784f, -0.0696653f, +0.1593271f, +0.0142776f, -0.0371973f, -0.0085399f,
  -0.0561509f, -0.0516397f, -0.0199563f, -0.0317811f, -0.0367813f, +0.0222288f, +0.0951729f, -0.0265033f,
  +0.0812119f, +0.0021028f, +0.0793283f, +0.1468558f, -0.1391193f, -0.0058568f, -0.0303299f, -0.1113276f,
  -0.0757702f, +0.0158254f, -0.0170019f, -0.0075718f, -0.0491724f, -0.0501862f, -0.0376516f, -0.0220291f,
  +0.0278719f, -0.1100442f, -0.0055930f, +0.0110359f, +0.0330637f, +0.0196477f, -0.0026097f, -0.1910110f,
  +0.0946444f, +0.2315336f, +0.0520145f, +0.2461771f, +0.5058210f, -0.1130203f, +0.7472292f, -0.2110799f,
  +0.0111746f, -0.0616531f, +0.0007795f, +0.0859506f, +0.0107126f, +0.0156288f, -0.0076234f, -0.0743708f,
  -0.0615390f, -0.0264971f, +0.0101355f, +0.0347751f, -0.0129339f, -0.0350150f, -0.0388261f, -0.0793493f,
  +0.0773953f, +0.5946118f, -0.0901107f, -0.1218350f, -0.1769682f, +0.0950320f, +0.1019137f, -0.1040506f,
  -0.0324946f, +0.0408654f, -0.1117532f, +0.1801026f, -0.1495352f, -0.0296770f, +0.0036589f, +0.0503147f
);

const float biases[4] = float[4](
  +0.0081869f, -0.0263129f, -0.0047610f, -0.0166656f
);

vec4 hook() {
    const vec4 r[9][2] = vec4[9][2](
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 1.0f)))
    );

    float sum[4] = biases;
    for (int n = 0; n < 4; n++) {
        for (int i = 0; i < 9; i++) {
            const vec4 k0 = vec4(kernels[n * 8 * 9 + 8 * i + 0], kernels[n * 8 * 9 + 8 * i + 1], kernels[n * 8 * 9 + 8 * i + 2], kernels[n * 8 * 9 + 8 * i + 3]);
            const vec4 k1 = vec4(kernels[n * 8 * 9 + 8 * i + 4], kernels[n * 8 * 9 + 8 * i + 5], kernels[n * 8 * 9 + 8 * i + 6], kernels[n * 8 * 9 + 8 * i + 7]);
            sum[n] += (dot(k0, r[i][0]) + dot(k1, r[i][1]));
        }
    }

    return ACTIVE(vec4(sum[0], sum[1], sum[2], sum[3]));
}

//!HOOK LUMA
//!DESC ACNet Layer2 L0
//!WHEN OUTPUT.w LUMA.w / 1.2 > OUTPUT.h LUMA.h / 1.2 > *
//!BIND TMP2_L0
//!BIND TMP2_L1
//!SAVE TMP1_L0
//!COMPONENTS 4

#define ACTIVE(v) (max(v, 0.0f))

#define TEX_BIND_L0_TEXOFF TMP2_L0_texOff
#define TEX_BIND_L0_TEX TMP2_L0_tex
#define TEX_BIND_L0_POS TMP2_L0_pos
#define TEX_BIND_L0_SIZE TMP2_L0_size
#define TEX_BIND_L0_PT TMP2_L0_pt

#define TEX_BIND_L1_TEXOFF TMP2_L1_texOff
#define TEX_BIND_L1_TEX TMP2_L1_tex
#define TEX_BIND_L1_POS TMP2_L1_pos
#define TEX_BIND_L1_SIZE TMP2_L1_size
#define TEX_BIND_L1_PT TMP2_L1_pt

const float kernels[288] = float[288](
  -0.0426064f, +0.1077864f, +0.0409267f, -0.0089260f, +0.0581728f, -0.0288594f, -0.0872924f, +0.0498458f,
  -0.0890008f, +0.2183661f, +0.0503106f, +0.0185067f, +0.0599905f, -0.1223744f, -0.0212548f, +0.3339540f,
  -0.0640064f, +0.1809357f, +0.1164811f, +0.0790691f, -0.0313981f, -0.1062519f, +0.0368296f, -0.0315606f,
  +0.1113206f, -0.0263065f, +0.2242886f, -0.1941078f, +0.1581829f, +0.0316751f, -0.0544168f, -0.0131910f,
  +0.0766091f, -0.1245217f, +0.2075706f, -0.0868466f, +0.3086093f, +0.1417202f, +0.3050061f, +0.4266284f,
  +0.0864166f, +0.0126616f, +0.0043662f, -0.0036639f, -0.0238179f, -0.1437258f, +0.1689653f, -0.0697266f,
  +0.0076477f, +0.0316326f, +0.0363406f, +0.0403283f, +0.1217564f, +0.0146534f, -0.0221868f, +0.0145696f,
  -0.0164159f, +0.0187175f, -0.0476375f, -0.0368209f, +0.0675198f, +0.1020549f, -0.0896089f, -0.0400025f,
  -0.0820939f, +0.0310425f, +0.0836451f, -0.0853871f, +0.0894012f, +0.0625565f, -0.0228302f, +0.0563939f,
  -0.0825469f, -0.0562600f, -0.1405859f, +0.0798835f, -0.0898199f, -0.1119265f, -0.2052080f, +0.1721148f,
  +0.1924914f, -0.2704319f, -0.5733899f, +0.0524614f, -0.1699428f, -0.2570538f, +0.2190062f, +0.2021424f,
  +0.1559069f, +0.0153917f, -0.0390734f, +0.1031791f, -0.1598626f, +0.1199541f, +0.1595689f, +0.1382090f,
  +0.1453642f, -0.0143046f, -0.1170059f, +0.0400544f, +0.2343617f, +0.0579294f, +0.2106155f, -0.0715200f,
  -0.1040902f, +0.1113075f, -0.0318058f, +0.1469520f, -0.1534573f, +0.2498768f, -0.1415734f, +0.1484717f,
  +0.1238158f, -0.0859131f, +0.0777264f, +0.1257717f, +0.0150140f, -0.0049406f, -0.3434035f, -0.1381980f,
  +0.1818896f, +0.0779142f, +0.0216877f, -0.0018790f, -0.0391388f, -0.0393631f, +0.0385204f, -0.0247118f,
  +0.0929170f, -0.0065484f, +0.0992975f, -0.0494205f, -0.0793876f, -0.0116908f, -0.2082017f, -0.0159252f,
  -0.1439416f, -0.1837545f, +0.0382238f, +0.0232353f, -0.0490570f, -0.0012236f, +0.0024570f, +0.0174027f,
  -0.0375146f, -0.0217064f, -0.0139088f, -0.0113330f, -0.0086472f, -0.0476064f, -0.0062664f, +0.0915499f,
  +0.0304611f, -0.0224058f, -0.0201660f, +0.0147472f, -0.0696887f, +0.1391537f, +0.0917544f, -0.0540075f,
  -0.0275427f, +0.0267689f, -0.1002918f, -0.0789584f, +0.0056846f, +0.1165313f, -0.0057244f, +0.0674823f,
  +0.0861484f, -0.0369651f, +0.0763595f, -0.0315351f, +0.0579138f, +0.0960503f, +0.1353757f, -0.1868705f,
  -0.0614864f, +0.2217975f, +0.0808189f, +0.1740340f, -0.1981809f, +0.4009936f, +0.1536616f, +0.3211960f,
  +0.0126100f, -0.0409288f, -0.1093338f, +0.0139462f, -0.0753210f, +0.1563114f, +0.0949160f, +0.0051031f,
  +0.0029748f, -0.0032629f, -0.0589193f, -0.0320376f, +0.0874529f, +0.0314923f, -0.0421146f, -0.0612054f,
  +0.1177800f, +0.0834192f, +0.0247449f, +0.0511513f, +0.0783540f, +0.2479715f, -0.3658470f, -0.0517804f,
  +0.0290318f, -0.1458734f, +0.0373753f, -0.0610634f, +0.0219973f, +0.0687159f, -0.1455858f, +0.0164416f,
  -0.0123157f, -0.1539335f, -0.0985716f, +0.0289366f, +0.0627758f, -0.0618801f, +0.0702437f, -0.2125632f,
  -0.1390703f, -0.0427809f, -0.1403540f, -0.1348319f, +0.1384517f, -0.0881920f, -0.0295508f, -0.0417672f,
  -0.1444577f, -0.2095145f, -0.0194315f, -0.0416551f, +0.0458337f, -0.0601719f, +0.0164806f, +0.0846647f,
  -0.2789905f, +0.2032777f, +0.0255416f, +0.2017207f, -0.2385446f, +0.2500171f, -0.0310358f, -0.4023540f,
  -0.0859690f, +0.4531694f, +0.3260861f, +0.0142832f, -0.0402673f, +0.1514805f, -0.2002638f, +0.1060366f,
  -0.1087046f, -0.0304668f, +0.0017983f, +0.0962003f, +0.0156342f, +0.0644593f, -0.0847485f, -0.0318273f,
  -0.2615737f, -0.0613460f, -0.1080042f, +0.0190272f, -0.1924590f, -0.2102240f, -0.1310756f, -0.0498246f,
  +0.0895321f, +0.1038116f, -0.0290219f, +0.3123986f, -0.0323324f, -0.0838931f, -0.1378394f, -0.0009127f,
  +0.0309584f, -0.1371856f, +0.0062691f, -0.0295531f, +0.0032442f, +0.0069554f, +0.0948997f, +0.0155274f
);

const float biases[4] = float[4](
  -0.0238534f, -0.0385347f, +0.0026002f, +0.0288215f
);

vec4 hook() {
    const vec4 r[9][2] = vec4[9][2](
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 1.0f)))
    );

    float sum[4] = biases;
    for (int n = 0; n < 4; n++) {
        for (int i = 0; i < 9; i++) {
            const vec4 k0 = vec4(kernels[n * 8 * 9 + 8 * i + 0], kernels[n * 8 * 9 + 8 * i + 1], kernels[n * 8 * 9 + 8 * i + 2], kernels[n * 8 * 9 + 8 * i + 3]);
            const vec4 k1 = vec4(kernels[n * 8 * 9 + 8 * i + 4], kernels[n * 8 * 9 + 8 * i + 5], kernels[n * 8 * 9 + 8 * i + 6], kernels[n * 8 * 9 + 8 * i + 7]);
            sum[n] += (dot(k0, r[i][0]) + dot(k1, r[i][1]));
        }
    }

    return ACTIVE(vec4(sum[0], sum[1], sum[2], sum[3]));
}

//!HOOK LUMA
//!DESC ACNet Layer2 L1
//!WHEN OUTPUT.w LUMA.w / 1.2 > OUTPUT.h LUMA.h / 1.2 > *
//!BIND TMP2_L0
//!BIND TMP2_L1
//!SAVE TMP1_L1
//!COMPONENTS 4

#define ACTIVE(v) (max(v, 0.0f))

#define TEX_BIND_L0_TEXOFF TMP2_L0_texOff
#define TEX_BIND_L0_TEX TMP2_L0_tex
#define TEX_BIND_L0_POS TMP2_L0_pos
#define TEX_BIND_L0_SIZE TMP2_L0_size
#define TEX_BIND_L0_PT TMP2_L0_pt

#define TEX_BIND_L1_TEXOFF TMP2_L1_texOff
#define TEX_BIND_L1_TEX TMP2_L1_tex
#define TEX_BIND_L1_POS TMP2_L1_pos
#define TEX_BIND_L1_SIZE TMP2_L1_size
#define TEX_BIND_L1_PT TMP2_L1_pt

const float kernels[288] = float[288](
  -0.0065729f, +0.0088329f, +0.0229950f, -0.0022829f, +0.0186611f, -0.0295059f, -0.0586184f, -0.0076565f,
  -0.0189319f, -0.0216058f, +0.0179168f, +0.0865770f, +0.0244614f, +0.0950196f, +0.0640823f, -0.0968542f,
  -0.0345910f, -0.0408779f, -0.0914042f, -0.1190882f, +0.0360604f, -0.0664646f, +0.0048461f, +0.0076121f,
  +0.1106606f, -0.0155807f, -0.1232601f, -0.1806145f, -0.0452242f, -0.0726273f, -0.0594052f, +0.1479149f,
  +0.0939785f, -0.0148292f, +0.1458199f, +0.1116577f, -0.1767153f, +0.3123589f, +0.3264355f, +0.4561245f,
  +0.0260592f, -0.0159588f, -0.0709592f, -0.0822548f, +0.1608033f, +0.0557641f, -0.0712779f, +0.0198887f,
  -0.1239517f, -0.0001046f, -0.0180580f, -0.1318963f, -0.4217493f, -0.2878893f, -0.1808408f, -0.0554984f,
  -0.2476818f, -0.0042903f, -0.0852279f, +0.0771234f, -0.2255665f, -0.1891547f, +0.0208579f, -0.1126613f,
  -0.1630395f, -0.0466567f, +0.0427989f, +0.0232242f, -0.1071906f, +0.0908246f, -0.0093690f, +0.0227904f,
  -0.0388215f, +0.0502074f, +0.1011308f, -0.0901233f, +0.0037723f, -0.0243329f, -0.0265953f, +0.0362319f,
  -0.0157801f, +0.1518880f, -0.1836176f, +0.0779961f, -0.0375802f, +0.2797665f, +0.1227831f, -0.1109146f,
  +0.0125488f, +0.1253260f, +0.0326417f, +0.0362969f, -0.0664101f, +0.0569611f, -0.0316591f, +0.1284081f,
  -0.0382317f, +0.1829769f, +0.1703386f, -0.3438851f, +0.0525006f, -0.0030605f, -0.0101026f, +0.1927680f,
  -0.2887002f, -0.1286970f, -0.3107710f, +0.1184130f, -0.1252975f, +0.0836844f, +0.4776311f, +0.2932156f,
  +0.0262164f, +0.3068087f, -0.0487372f, -0.0209005f, +0.0359436f, +0.0044848f, +0.0253588f, -0.1673975f,
  +0.1037457f, -0.0195711f, +0.0591440f, +0.0949300f, +0.0383780f, -0.0789346f, +0.0813966f, +0.1210747f,
  -0.0296207f, -0.0863021f, +0.0056052f, -0.0915043f, +0.0951885f, -0.1954379f, +0.3054804f, -0.0628833f,
  +0.0018479f, +0.0911211f, +0.0323599f, -0.0453078f, +0.0021952f, -0.0533114f, +0.0970974f, +0.0406031f,
  -0.1574971f, +0.0861563f, +0.0911706f, -0.1833391f, +0.1750952f, -0.1315908f, -0.0131482f, +0.3252737f,
  -0.0861829f, +0.0214992f, -0.3110177f, -0.0536995f, +0.1789673f, +0.1563822f, +0.0686595f, +0.3208675f,
  -0.1419403f, +0.2207977f, +0.1242485f, +0.2333605f, -0.2651841f, +0.1248014f, -0.0074230f, -0.0000944f,
  +0.1193192f, +0.0557030f, +0.1027778f, -0.1446373f, +0.2363845f, -0.0621637f, +0.0297020f, +0.1355628f,
  -0.3917491f, -0.3630733f, -0.3101417f, -0.5031984f, +0.5026963f, +0.0794581f, +0.1203598f, -0.0704126f,
  -0.0544953f, +0.0831294f, -0.0691378f, -0.0298365f, -0.0049731f, -0.0948039f, +0.0955036f, +0.0293825f,
  -0.0140007f, +0.0892804f, +0.0808391f, -0.1722471f, +0.2260253f, +0.0085690f, -0.0032694f, +0.0206169f,
  -0.2059372f, -0.0358973f, -0.0361830f, -0.3949877f, +0.2531734f, +0.0074971f, +0.0867223f, +0.0332178f,
  -0.0826827f, +0.1610623f, +0.1034092f, -0.1732057f, +0.2407878f, +0.0866299f, -0.0624331f, +0.0448978f,
  -0.4825964f, +0.0697073f, -0.0992766f, -0.1359157f, +0.1801524f, +0.1401771f, +0.0017744f, +0.0797820f,
  -0.2132876f, -0.0447001f, -0.3143665f, -0.1357487f, +0.2138951f, -0.0928237f, +0.0317358f, -0.1553340f,
  +0.0158902f, +0.0655702f, +0.0407304f, -0.0745460f, +0.0086923f, -0.0227952f, +0.0458820f, -0.0146192f,
  -0.2659990f, +0.2399208f, +0.0242080f, +0.1467031f, +0.2883330f, +0.1236045f, -0.0252217f, -0.1222302f,
  -0.0885188f, +0.1507754f, -0.0883222f, -0.1336592f, +0.0663449f, +0.2252681f, +0.2429799f, -0.0018631f,
  -0.0438005f, +0.0287129f, -0.1624516f, +0.0021553f, +0.1457841f, -0.1181700f, -0.0385960f, -0.0988320f,
  -0.1729914f, -0.0911967f, +0.0130372f, +0.0081235f, +0.2233778f, -0.0388725f, +0.0125448f, -0.0168152f,
  -0.2075661f, +0.0197653f, -0.0347076f, -0.1206824f, +0.2645274f, -0.0199825f, +0.0318722f, -0.0814399f,
  -0.2665814f, -0.0187509f, -0.0442851f, -0.0572869f, -0.0291125f, -0.0775137f, +0.0719252f, +0.0680380f
);

const float biases[4] = float[4](
  -0.0224528f, +0.0082199f, -0.0191096f, -0.0184995f
);

vec4 hook() {
    const vec4 r[9][2] = vec4[9][2](
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 1.0f)))
    );

    float sum[4] = biases;
    for (int n = 0; n < 4; n++) {
        for (int i = 0; i < 9; i++) {
            const vec4 k0 = vec4(kernels[n * 8 * 9 + 8 * i + 0], kernels[n * 8 * 9 + 8 * i + 1], kernels[n * 8 * 9 + 8 * i + 2], kernels[n * 8 * 9 + 8 * i + 3]);
            const vec4 k1 = vec4(kernels[n * 8 * 9 + 8 * i + 4], kernels[n * 8 * 9 + 8 * i + 5], kernels[n * 8 * 9 + 8 * i + 6], kernels[n * 8 * 9 + 8 * i + 7]);
            sum[n] += (dot(k0, r[i][0]) + dot(k1, r[i][1]));
        }
    }

    return ACTIVE(vec4(sum[0], sum[1], sum[2], sum[3]));
}

//!HOOK LUMA
//!DESC ACNet Layer3 L0
//!WHEN OUTPUT.w LUMA.w / 1.2 > OUTPUT.h LUMA.h / 1.2 > *
//!BIND TMP1_L0
//!BIND TMP1_L1
//!SAVE TMP2_L0
//!COMPONENTS 4

#define ACTIVE(v) (max(v, 0.0f))

#define TEX_BIND_L0_TEXOFF TMP1_L0_texOff
#define TEX_BIND_L0_TEX TMP1_L0_tex
#define TEX_BIND_L0_POS TMP1_L0_pos
#define TEX_BIND_L0_SIZE TMP1_L0_size
#define TEX_BIND_L0_PT TMP1_L0_pt

#define TEX_BIND_L1_TEXOFF TMP1_L1_texOff
#define TEX_BIND_L1_TEX TMP1_L1_tex
#define TEX_BIND_L1_POS TMP1_L1_pos
#define TEX_BIND_L1_SIZE TMP1_L1_size
#define TEX_BIND_L1_PT TMP1_L1_pt

const float kernels[288] = float[288](
  +0.0238978f, -0.0938485f, -0.0720996f, +0.1586491f, +0.1361657f, -0.1435705f, +0.0369962f, +0.0447574f,
  +0.0124106f, +0.0203252f, +0.1335735f, +0.0709502f, +0.1422950f, -0.0976080f, +0.0212907f, -0.0048053f,
  -0.0327704f, +0.0263093f, -0.1370181f, -0.0633359f, -0.0107066f, +0.1464641f, +0.0321497f, -0.0672538f,
  -0.2602856f, +0.0122661f, +0.2252708f, +0.2266131f, -0.0109863f, -0.0538557f, +0.0983748f, -0.0483700f,
  +0.3269013f, +0.1769812f, +0.1582138f, -0.4299698f, +0.2881644f, +0.3389771f, +0.2447591f, -0.0789745f,
  -0.1824604f, +0.2704863f, -0.2310429f, -0.4201277f, -0.3623906f, -0.2493591f, +0.2289574f, -0.3600744f,
  +0.0112239f, +0.1291808f, +0.0101818f, +0.0175490f, +0.0225791f, -0.0295003f, +0.1839177f, -0.0381596f,
  +0.0801934f, +0.2018953f, -0.1549903f, -0.1314243f, -0.0143317f, +0.0217991f, -0.0745098f, +0.0877066f,
  -0.0504120f, +0.2735224f, +0.0719061f, -0.3166265f, +0.0071339f, +0.0119009f, -0.1015233f, -0.1498624f,
  -0.0087544f, -0.0291922f, -0.0823154f, +0.0693773f, +0.0480579f, -0.0070546f, +0.0211409f, +0.0304086f,
  -0.0435221f, -0.1097456f, -0.0201815f, +0.2364201f, -0.1872545f, +0.0794811f, -0.0668262f, -0.0476134f,
  +0.0738223f, -0.0509428f, -0.0128244f, +0.1271328f, -0.0067048f, +0.0121460f, -0.1852602f, -0.1773653f,
  -0.1452345f, -0.1121458f, -0.0048007f, +0.0278776f, -0.1393195f, +0.0426658f, +0.1330884f, -0.0166780f,
  +0.1143339f, +0.1990663f, +0.1265525f, -0.1532474f, -0.0607680f, +0.3538332f, +0.3345168f, -0.0786443f,
  +0.0441087f, +0.0799340f, -0.0251574f, -0.1487141f, -0.1697611f, +0.1438132f, +0.0110577f, +0.1174259f,
  -0.0016025f, +0.0370660f, +0.0277963f, +0.0158001f, -0.0211894f, +0.0543840f, -0.0169671f, +0.0733220f,
  +0.0254588f, +0.3079630f, -0.0430318f, -0.0459348f, +0.0103106f, -0.0938625f, +0.1109351f, -0.1135418f,
  -0.0935617f, -0.1403448f, +0.0253970f, +0.1736962f, -0.0229698f, +0.0048870f, +0.0532296f, -0.0157371f,
  -0.0012397f, +0.1742440f, +0.1035674f, -0.1035832f, -0.0230717f, +0.0435933f, +0.0226420f, -0.0670903f,
  -0.0146851f, +0.1068796f, +0.0576725f, +0.2063112f, -0.0323416f, -0.0067373f, +0.0821318f, +0.1179688f,
  -0.0101921f, +0.1426291f, +0.0103555f, -0.0091445f, +0.0145030f, +0.0127603f, -0.0238641f, +0.1531525f,
  +0.1604540f, +0.0899416f, -0.2086380f, -0.1760184f, -0.0370523f, +0.0032896f, -0.2972608f, +0.0778291f,
  +0.0363309f, -0.0271413f, -0.1940466f, +0.1020027f, -0.1220566f, -0.2400725f, +0.0804053f, -0.1449420f,
  +0.1221937f, +0.0312377f, +0.2509429f, +0.0300318f, +0.0553947f, -0.0529198f, -0.0131899f, +0.1023323f,
  +0.1312261f, -0.0402399f, -0.0048277f, -0.0114945f, +0.0283307f, +0.0251926f, -0.1131017f, +0.0970589f,
  +0.0575784f, -0.1092994f, -0.1375813f, -0.0450767f, -0.0042812f, -0.2148000f, -0.4434234f, +0.1277192f,
  +0.1029091f, -0.2127585f, +0.1156211f, -0.0647476f, +0.0698067f, +0.0846537f, -0.0635355f, -0.0243939f,
  -0.0261789f, -0.0027451f, -0.1694300f, -0.1810963f, -0.0582591f, +0.1291030f, +0.0374930f, -0.1086110f,
  +0.0267206f, +0.0719588f, -0.2022053f, -0.2614312f, -0.1365630f, +0.2400836f, -0.0358770f, -0.2582397f,
  +0.0117067f, +0.0447063f, -0.1636871f, -0.1010861f, -0.0139357f, +0.1890825f, -0.0099651f, +0.0664546f,
  -0.0480245f, -0.1990000f, +0.1388180f, +0.0558443f, -0.0083429f, -0.0587762f, +0.1586430f, +0.0922383f,
  -0.2336566f, +0.2135340f, +0.2171684f, -0.1217473f, +0.2302563f, +0.3812131f, +0.1361138f, -0.2344848f,
  -0.1697839f, +0.1062537f, -0.1358078f, +0.0344467f, +0.1230238f, +0.0813123f, +0.0678796f, -0.3405662f,
  -0.2440175f, +0.4024558f, +0.1397523f, +0.0896885f, -0.0229689f, +0.0911748f, +0.2221592f, -0.2965831f,
  -0.2857159f, +0.4232324f, +0.1198005f, +0.2464143f, +0.0609322f, -0.0187295f, +0.0936973f, +0.0094698f,
  -0.0240528f, +0.0340458f, +0.0188879f, +0.2328709f, +0.0347488f, -0.0461563f, +0.0747823f, +0.1931526f
);

const float biases[4] = float[4](
  -0.0058305f, -0.0865735f, +0.0422284f, -0.0434998f
);

vec4 hook() {
    const vec4 r[9][2] = vec4[9][2](
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 1.0f)))
    );

    float sum[4] = biases;
    for (int n = 0; n < 4; n++) {
        for (int i = 0; i < 9; i++) {
            const vec4 k0 = vec4(kernels[n * 8 * 9 + 8 * i + 0], kernels[n * 8 * 9 + 8 * i + 1], kernels[n * 8 * 9 + 8 * i + 2], kernels[n * 8 * 9 + 8 * i + 3]);
            const vec4 k1 = vec4(kernels[n * 8 * 9 + 8 * i + 4], kernels[n * 8 * 9 + 8 * i + 5], kernels[n * 8 * 9 + 8 * i + 6], kernels[n * 8 * 9 + 8 * i + 7]);
            sum[n] += (dot(k0, r[i][0]) + dot(k1, r[i][1]));
        }
    }

    return ACTIVE(vec4(sum[0], sum[1], sum[2], sum[3]));
}

//!HOOK LUMA
//!DESC ACNet Layer3 L1
//!WHEN OUTPUT.w LUMA.w / 1.2 > OUTPUT.h LUMA.h / 1.2 > *
//!BIND TMP1_L0
//!BIND TMP1_L1
//!SAVE TMP2_L1
//!COMPONENTS 4

#define ACTIVE(v) (max(v, 0.0f))

#define TEX_BIND_L0_TEXOFF TMP1_L0_texOff
#define TEX_BIND_L0_TEX TMP1_L0_tex
#define TEX_BIND_L0_POS TMP1_L0_pos
#define TEX_BIND_L0_SIZE TMP1_L0_size
#define TEX_BIND_L0_PT TMP1_L0_pt

#define TEX_BIND_L1_TEXOFF TMP1_L1_texOff
#define TEX_BIND_L1_TEX TMP1_L1_tex
#define TEX_BIND_L1_POS TMP1_L1_pos
#define TEX_BIND_L1_SIZE TMP1_L1_size
#define TEX_BIND_L1_PT TMP1_L1_pt

const float kernels[288] = float[288](
  -0.0523959f, +0.0465504f, -0.0445295f, -0.1341841f, +0.0307582f, +0.0445685f, +0.1979103f, -0.0218695f,
  +0.1230961f, +0.0341188f, -0.1862318f, -0.1495990f, +0.0334763f, +0.1222993f, +0.0790026f, -0.1837842f,
  -0.0529173f, +0.0609774f, -0.0845567f, +0.1629238f, +0.0069837f, -0.1441742f, +0.0311632f, -0.2889326f,
  -0.0043708f, -0.0100537f, +0.0959618f, -0.1727519f, -0.0610886f, -0.0128251f, +0.1096854f, -0.0825228f,
  +0.1956043f, +0.1441078f, +0.2649098f, -0.0601810f, -0.0960210f, +0.3197994f, +0.1683937f, -0.0304749f,
  -0.0243090f, +0.1562151f, +0.1785414f, -0.0270336f, +0.0071716f, -0.3590452f, -0.2581578f, +0.0960071f,
  -0.0673881f, +0.0174012f, -0.0205474f, -0.0741886f, +0.1038879f, -0.1255654f, -0.1261672f, +0.1066864f,
  -0.0888389f, +0.2568505f, -0.1202341f, -0.0355661f, +0.0479632f, -0.0752829f, +0.1368598f, -0.0014581f,
  -0.0209071f, -0.0091853f, -0.0768969f, +0.1399487f, +0.0959209f, -0.1234273f, -0.2107849f, +0.3244126f,
  -0.0081872f, -0.0091530f, -0.0466088f, -0.0548314f, +0.0238002f, -0.0894796f, +0.0186092f, +0.0076576f,
  +0.0116903f, +0.0354322f, +0.1711368f, +0.0975738f, -0.0240459f, -0.1620718f, +0.1124337f, -0.0359571f,
  -0.0401788f, +0.0439496f, -0.0782837f, +0.0328389f, -0.0570442f, -0.0894184f, +0.0525991f, +0.0319241f,
  -0.1083544f, -0.0868594f, +0.1761148f, +0.0384753f, +0.0272800f, -0.0355888f, -0.0133739f, -0.0700884f,
  +0.3611175f, +0.1588703f, +0.4120405f, -0.0602466f, +0.7857327f, +0.3590282f, -0.3309682f, +0.0912410f,
  -0.0459901f, +0.0127962f, +0.0932812f, -0.0296272f, +0.0100793f, -0.1838086f, +0.0653460f, +0.0128268f,
  -0.1235462f, +0.0135538f, +0.1142026f, -0.0243671f, +0.0640998f, +0.0923556f, +0.2675968f, +0.0371645f,
  -0.1337246f, -0.1566926f, +0.1295073f, +0.0131434f, +0.0515843f, +0.0880464f, -0.1028089f, +0.0070273f,
  +0.0381363f, -0.0143711f, -0.0760246f, +0.0470173f, +0.0079653f, -0.0502287f, +0.0116070f, -0.0007394f,
  -0.0065406f, -0.0302410f, -0.0098463f, +0.0885294f, -0.0273503f, +0.0701019f, -0.0796243f, +0.0840550f,
  +0.0726659f, -0.0074310f, -0.0696178f, +0.0983479f, +0.1070197f, -0.1094547f, +0.1997636f, -0.0073187f,
  -0.0573484f, -0.0876819f, -0.2609482f, +0.0211357f, +0.0162201f, -0.1664027f, +0.1958179f, -0.0988081f,
  -0.1910036f, -0.0224788f, +0.0999502f, -0.0090337f, +0.0109116f, -0.0039916f, +0.2137699f, +0.0505897f,
  -0.0744488f, +0.0960082f, +0.5053353f, +0.1367907f, +0.1095287f, -0.0266579f, +0.3583497f, -0.0892911f,
  -0.1249589f, -0.0845393f, -0.1881195f, -0.1211458f, +0.0867617f, -0.0970310f, +0.1701226f, -0.0668566f,
  +0.1529856f, -0.0289150f, -0.1198635f, -0.0062478f, +0.0029348f, -0.0300470f, -0.0977514f, +0.0967373f,
  -0.0880467f, +0.1753819f, +0.0711658f, +0.1143553f, -0.0220346f, +0.0016631f, +0.4914340f, -0.3069940f,
  -0.0218102f, -0.0377350f, -0.0247685f, -0.0346098f, +0.1237603f, -0.0550308f, +0.1098752f, +0.2288864f,
  +0.0000000f, -0.0000000f, -0.0000000f, -0.0000000f, +0.0000000f, -0.0000000f, +0.0000000f, +0.0000000f,
  -0.0000000f, -0.0000000f, -0.0000000f, +0.0000000f, -0.0000000f, -0.0000000f, +0.0000000f, -0.0000000f,
  -0.0000000f, +0.0000000f, -0.0000000f, +0.0000000f, +0.0000000f, -0.0000000f, -0.0000000f, +0.0000000f,
  -0.0000000f, +0.0000000f, -0.0000000f, -0.0000000f, -0.0000000f, +0.0000000f, +0.0000000f, +0.0000000f,
  +0.0000000f, -0.0000000f, -0.0000000f, +0.0000000f, +0.0000000f, -0.0000000f, -0.0000000f, -0.0000000f,
  -0.0000000f, -0.0000000f, -0.0000000f, -0.0000000f, +0.0000000f, +0.0000000f, -0.0000000f, -0.0000000f,
  -0.0000000f, +0.0000000f, +0.0000000f, +0.0000000f, +0.0000000f, +0.0000000f, +0.0000000f, +0.0000000f,
  -0.0000000f, +0.0000000f, -0.0000000f, +0.0000000f, +0.0000000f, -0.0000000f, +0.0000000f, +0.0000000f,
  +0.0000000f, -0.0000000f, -0.0000000f, +0.0000000f, +0.0000000f, -0.0000000f, +0.0000000f, -0.0000000f
);

const float biases[4] = float[4](
  -0.0008189f, +0.0033171f, -0.0115818f, -0.0000000f
);

vec4 hook() {
    const vec4 r[9][2] = vec4[9][2](
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 1.0f)))
    );

    float sum[4] = biases;
    for (int n = 0; n < 4; n++) {
        for (int i = 0; i < 9; i++) {
            const vec4 k0 = vec4(kernels[n * 8 * 9 + 8 * i + 0], kernels[n * 8 * 9 + 8 * i + 1], kernels[n * 8 * 9 + 8 * i + 2], kernels[n * 8 * 9 + 8 * i + 3]);
            const vec4 k1 = vec4(kernels[n * 8 * 9 + 8 * i + 4], kernels[n * 8 * 9 + 8 * i + 5], kernels[n * 8 * 9 + 8 * i + 6], kernels[n * 8 * 9 + 8 * i + 7]);
            sum[n] += (dot(k0, r[i][0]) + dot(k1, r[i][1]));
        }
    }

    return ACTIVE(vec4(sum[0], sum[1], sum[2], sum[3]));
}

//!HOOK LUMA
//!DESC ACNet Layer4 L0
//!WHEN OUTPUT.w LUMA.w / 1.2 > OUTPUT.h LUMA.h / 1.2 > *
//!BIND TMP2_L0
//!BIND TMP2_L1
//!SAVE TMP1_L0
//!COMPONENTS 4

#define ACTIVE(v) (max(v, 0.0f))

#define TEX_BIND_L0_TEXOFF TMP2_L0_texOff
#define TEX_BIND_L0_TEX TMP2_L0_tex
#define TEX_BIND_L0_POS TMP2_L0_pos
#define TEX_BIND_L0_SIZE TMP2_L0_size
#define TEX_BIND_L0_PT TMP2_L0_pt

#define TEX_BIND_L1_TEXOFF TMP2_L1_texOff
#define TEX_BIND_L1_TEX TMP2_L1_tex
#define TEX_BIND_L1_POS TMP2_L1_pos
#define TEX_BIND_L1_SIZE TMP2_L1_size
#define TEX_BIND_L1_PT TMP2_L1_pt

const float kernels[288] = float[288](
  +0.0136252f, +0.0281949f, -0.0185827f, +0.0465954f, -0.0930803f, -0.0519379f, +0.2105377f, -0.0000000f,
  -0.0855938f, +0.0731017f, +0.0301355f, +0.0220523f, +0.0980687f, +0.0030932f, +0.1562957f, +0.0000000f,
  -0.1990140f, -0.0933314f, +0.0081094f, -0.1586699f, -0.0701541f, +0.1812575f, -0.1958717f, -0.0000000f,
  -0.0646357f, +0.0770931f, -0.1283519f, -0.0109370f, -0.0660633f, +0.0367013f, +0.0501455f, +0.0000000f,
  -0.0190301f, +0.1780046f, -0.1804145f, +0.1003023f, -0.2214223f, -0.3034925f, -0.0188443f, -0.0000000f,
  +0.0419628f, -0.0764511f, -0.0890196f, -0.1301791f, +0.4105836f, +0.0998388f, +0.3667502f, +0.0000000f,
  -0.0755073f, +0.0285653f, -0.0827311f, -0.0918435f, -0.0659472f, +0.0258102f, -0.0040389f, +0.0000000f,
  -0.2447436f, -0.1354017f, +0.0378612f, -0.1750825f, -0.0546624f, +0.2364412f, +0.3159584f, +0.0000000f,
  -0.0426215f, -0.1916851f, -0.0940140f, +0.2208718f, +0.0994122f, -0.2446110f, +0.0036771f, -0.0000000f,
  +0.2268655f, -0.0472349f, -0.2344008f, -0.1041826f, +0.1915153f, -0.1493416f, -0.0613912f, -0.0000000f,
  -0.0589922f, +0.0517725f, -0.0323735f, -0.0784067f, -0.0196090f, -0.0683826f, +0.0129756f, +0.0000000f,
  +0.0047796f, -0.0485863f, -0.0679110f, -0.0184129f, +0.0273637f, +0.0279572f, -0.0321518f, +0.0000000f,
  +0.6060305f, -0.1450969f, -0.1625613f, +0.0828337f, +0.0104577f, -0.3684581f, +0.0757675f, -0.0000000f,
  +0.2796123f, -0.1733631f, +0.1231606f, +0.2312846f, -0.1250708f, +0.4876558f, +0.1293093f, -0.0000000f,
  +0.0159734f, +0.1098104f, +0.0278589f, +0.0329828f, +0.0413337f, +0.0639996f, -0.0234984f, -0.0000000f,
  +0.2303474f, -0.2030283f, +0.0008509f, +0.0310990f, -0.0462148f, -0.0396213f, +0.0403202f, -0.0000000f,
  +0.1303064f, -0.0160080f, -0.0374006f, -0.0644850f, +0.0569440f, -0.0081667f, +0.0138764f, -0.0000000f,
  -0.0099280f, -0.0018524f, -0.0186716f, -0.0816587f, +0.0214769f, +0.0459968f, +0.0110221f, +0.0000000f,
  -0.0429689f, -0.1069015f, +0.1657389f, +0.0635937f, +0.0749364f, +0.0243948f, -0.2234357f, +0.0000000f,
  -0.1099511f, -0.1436967f, -0.0568938f, -0.0933145f, +0.0231040f, -0.0335763f, +0.1333455f, -0.0000000f,
  +0.1302085f, -0.1263192f, -0.2085101f, +0.0782471f, +0.0639276f, +0.0555078f, -0.1168840f, +0.0000000f,
  +0.1014241f, +0.0287539f, +0.0081498f, +0.0467947f, -0.0131175f, -0.0408724f, -0.2423154f, -0.0000000f,
  +0.5222536f, +0.1166155f, -0.2544114f, -0.2277388f, +0.0675445f, +0.0545015f, +0.3331896f, +0.0000000f,
  -0.0554860f, +0.0565151f, -0.1441201f, +0.0710408f, +0.0795137f, -0.0570509f, -0.1258020f, -0.0000000f,
  -0.0723486f, -0.1572612f, -0.0109586f, +0.1483005f, +0.0223353f, +0.0086621f, -0.0221686f, +0.0000000f,
  +0.0854705f, -0.1494548f, -0.0258107f, +0.1991093f, -0.0994425f, -0.1536054f, +0.2059428f, -0.0000000f,
  +0.0234384f, -0.0449561f, +0.0889340f, +0.0519775f, +0.0068070f, +0.1262979f, +0.0265212f, +0.0000000f,
  +0.1798918f, +0.0786567f, +0.0531405f, +0.0808344f, -0.0060928f, -0.0667714f, +0.0175830f, -0.0000000f,
  +0.0237873f, -0.0711347f, -0.1290434f, -0.2432124f, +0.0871446f, -0.2058556f, +0.0332216f, +0.0000000f,
  +0.0057447f, -0.0582927f, -0.0151055f, -0.0010282f, +0.0620309f, +0.0477215f, -0.0570699f, -0.0000000f,
  +0.4874752f, -0.1421989f, +0.0545246f, +0.0031276f, -0.5391938f, -0.3496816f, -0.2325004f, +0.0000000f,
  +0.3015186f, +0.0160041f, -0.1541760f, +0.3249532f, -0.0688101f, +0.3091190f, +0.1447028f, -0.0000000f,
  +0.0355165f, -0.0251801f, +0.0665065f, -0.0132377f, -0.1075455f, +0.2448685f, -0.0498952f, +0.0000000f,
  +0.2215453f, -0.1681057f, +0.0839470f, +0.0452848f, -0.0225709f, -0.0495368f, +0.0331469f, +0.0000000f,
  +0.1881213f, -0.2344063f, -0.1197511f, +0.0587766f, +0.0262366f, -0.0005278f, +0.0863194f, +0.0000000f,
  +0.0309940f, +0.0148100f, +0.0539015f, -0.1323097f, -0.0068731f, +0.0678397f, +0.0447189f, +0.0000000f
);

const float biases[4] = float[4](
  -0.0053108f, +0.0052781f, -0.0114067f, -0.0127344f
);

vec4 hook() {
    const vec4 r[9][2] = vec4[9][2](
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 1.0f)))
    );

    float sum[4] = biases;
    for (int n = 0; n < 4; n++) {
        for (int i = 0; i < 9; i++) {
            const vec4 k0 = vec4(kernels[n * 8 * 9 + 8 * i + 0], kernels[n * 8 * 9 + 8 * i + 1], kernels[n * 8 * 9 + 8 * i + 2], kernels[n * 8 * 9 + 8 * i + 3]);
            const vec4 k1 = vec4(kernels[n * 8 * 9 + 8 * i + 4], kernels[n * 8 * 9 + 8 * i + 5], kernels[n * 8 * 9 + 8 * i + 6], kernels[n * 8 * 9 + 8 * i + 7]);
            sum[n] += (dot(k0, r[i][0]) + dot(k1, r[i][1]));
        }
    }

    return ACTIVE(vec4(sum[0], sum[1], sum[2], sum[3]));
}

//!HOOK LUMA
//!DESC ACNet Layer4 L1
//!WHEN OUTPUT.w LUMA.w / 1.2 > OUTPUT.h LUMA.h / 1.2 > *
//!BIND TMP2_L0
//!BIND TMP2_L1
//!SAVE TMP1_L1
//!COMPONENTS 4

#define ACTIVE(v) (max(v, 0.0f))

#define TEX_BIND_L0_TEXOFF TMP2_L0_texOff
#define TEX_BIND_L0_TEX TMP2_L0_tex
#define TEX_BIND_L0_POS TMP2_L0_pos
#define TEX_BIND_L0_SIZE TMP2_L0_size
#define TEX_BIND_L0_PT TMP2_L0_pt

#define TEX_BIND_L1_TEXOFF TMP2_L1_texOff
#define TEX_BIND_L1_TEX TMP2_L1_tex
#define TEX_BIND_L1_POS TMP2_L1_pos
#define TEX_BIND_L1_SIZE TMP2_L1_size
#define TEX_BIND_L1_PT TMP2_L1_pt

const float kernels[288] = float[288](
  -0.0402945f, +0.0637369f, +0.0759992f, +0.0096844f, -0.0242391f, +0.0766011f, +0.0091783f, +0.0000000f,
  -0.0091437f, -0.0901810f, -0.0513066f, +0.0469802f, -0.0086317f, +0.1365386f, -0.0595467f, -0.0000000f,
  -0.0249265f, +0.0707158f, +0.0024326f, +0.0385524f, -0.0023295f, +0.0021458f, -0.0182337f, -0.0000000f,
  -0.2126876f, +0.0700614f, -0.0317158f, -0.0571100f, -0.0230647f, +0.1454216f, -0.0533985f, +0.0000000f,
  +0.1160245f, +0.0790458f, -0.1256683f, +0.0321634f, +0.1007579f, +0.3631044f, +0.1921782f, -0.0000000f,
  +0.0143825f, -0.0439249f, -0.0338977f, +0.0152189f, +0.0021562f, +0.1626631f, -0.0462376f, -0.0000000f,
  +0.0514559f, +0.0743956f, +0.0849250f, +0.0669055f, -0.0136474f, -0.0584654f, -0.1905169f, +0.0000000f,
  +0.0690473f, -0.0527969f, -0.0524040f, -0.0279342f, -0.0342617f, +0.0437510f, +0.0146347f, -0.0000000f,
  +0.0165187f, +0.0381252f, +0.0285347f, +0.0014184f, +0.0257767f, +0.0192271f, +0.0295360f, -0.0000000f,
  +0.0931258f, +0.2265430f, +0.1205852f, -0.0552757f, +0.0585593f, +0.0419897f, -0.1426234f, -0.0000000f,
  -0.1323643f, -0.1254584f, -0.1056939f, -0.0978671f, +0.0611167f, -0.1328338f, -0.0012810f, +0.0000000f,
  +0.0993501f, -0.1235407f, -0.0711962f, +0.0355502f, +0.0803337f, +0.0490473f, -0.1206006f, -0.0000000f,
  -0.1330754f, -0.1645695f, -0.0929909f, -0.0602639f, -0.0044582f, -0.0495320f, -0.0835954f, -0.0000000f,
  +0.3503010f, -0.0607396f, -0.1758720f, +0.0477596f, -0.1202839f, +0.2768839f, +0.0565317f, -0.0000000f,
  +0.0922213f, -0.0310692f, +0.0013100f, +0.0602422f, +0.0873942f, -0.0046064f, -0.0775562f, -0.0000000f,
  +0.1178329f, -0.0832033f, -0.1549156f, -0.0054096f, -0.0258802f, -0.0028812f, -0.1336449f, +0.0000000f,
  +0.1664758f, -0.1806429f, -0.1384950f, +0.2464607f, -0.1220561f, -0.2440420f, -0.1388343f, +0.0000000f,
  -0.0791497f, +0.0468999f, +0.1224530f, +0.6359168f, +0.1219853f, +0.0586145f, -0.1233483f, -0.0000000f,
  -0.0088844f, +0.1020539f, -0.0816929f, +0.0195761f, +0.0167955f, -0.0815715f, +0.3446482f, +0.0000000f,
  +0.0010101f, +0.0678502f, -0.0704319f, -0.1595334f, -0.0068125f, -0.1027557f, -0.0083286f, -0.0000000f,
  -0.0601905f, -0.1091103f, +0.1698991f, -0.1034838f, +0.0470284f, +0.1909219f, -0.0619355f, +0.0000000f,
  -0.1885125f, -0.1284585f, -0.1732874f, +0.0660140f, -0.3342144f, +0.2111230f, +0.2740552f, +0.0000000f,
  -0.0766621f, -0.0546054f, -0.2208433f, +0.6009351f, -0.2298736f, +0.0268371f, -0.0683566f, +0.0000000f,
  -0.1456153f, +0.0621821f, -0.0309767f, -0.0006989f, +0.0429356f, -0.2582206f, +0.1742581f, +0.0000000f,
  +0.0299830f, -0.1079659f, +0.0827708f, +0.0749694f, +0.0009398f, -0.1328951f, -0.0908723f, -0.0000000f,
  -0.0815334f, -0.0512810f, -0.3308946f, -0.1425012f, +0.0908271f, +0.1613534f, +0.1299895f, -0.0000000f,
  +0.0112560f, -0.0120365f, -0.1484218f, +0.0432206f, +0.2421062f, -0.0276716f, +0.0723657f, +0.0000000f,
  -0.0919355f, +0.0255113f, -0.0698963f, -0.0164616f, +0.0212417f, +0.0200384f, -0.0048248f, +0.0000000f,
  -0.0002267f, -0.0933941f, -0.1164523f, +0.0807946f, -0.1251403f, +0.1808398f, -0.1296986f, -0.0000000f,
  -0.0628207f, +0.0148097f, -0.0598702f, +0.0362225f, +0.1006595f, +0.0132442f, -0.0186795f, -0.0000000f,
  -0.1860474f, -0.0629063f, -0.0280365f, +0.0803920f, -0.0476759f, +0.0102799f, +0.1845807f, -0.0000000f,
  +0.3023755f, +0.0924716f, -0.2264887f, +0.3011776f, -0.0207360f, +0.2873987f, +0.0565091f, +0.0000000f,
  +0.0327585f, +0.0128447f, +0.0517810f, +0.2002069f, -0.0056951f, +0.0089837f, +0.1273432f, +0.0000000f,
  -0.0507714f, -0.2904139f, -0.0145885f, +0.1039363f, -0.0830210f, -0.0294365f, +0.1942286f, +0.0000000f,
  +0.0145851f, -0.0096489f, +0.0487533f, +0.6419581f, +0.0467633f, -0.3736561f, -0.3695994f, +0.0000000f,
  -0.1087180f, -0.0272770f, -0.0282560f, +0.4954513f, +0.1755084f, -0.1186129f, -0.0255547f, -0.0000000f
);

const float biases[4] = float[4](
  -0.0038591f, -0.0426398f, +0.0052785f, -0.0017417f
);

vec4 hook() {
    const vec4 r[9][2] = vec4[9][2](
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 1.0f)))
    );

    float sum[4] = biases;
    for (int n = 0; n < 4; n++) {
        for (int i = 0; i < 9; i++) {
            const vec4 k0 = vec4(kernels[n * 8 * 9 + 8 * i + 0], kernels[n * 8 * 9 + 8 * i + 1], kernels[n * 8 * 9 + 8 * i + 2], kernels[n * 8 * 9 + 8 * i + 3]);
            const vec4 k1 = vec4(kernels[n * 8 * 9 + 8 * i + 4], kernels[n * 8 * 9 + 8 * i + 5], kernels[n * 8 * 9 + 8 * i + 6], kernels[n * 8 * 9 + 8 * i + 7]);
            sum[n] += (dot(k0, r[i][0]) + dot(k1, r[i][1]));
        }
    }

    return ACTIVE(vec4(sum[0], sum[1], sum[2], sum[3]));
}

//!HOOK LUMA
//!DESC ACNet Layer5 L0
//!WHEN OUTPUT.w LUMA.w / 1.2 > OUTPUT.h LUMA.h / 1.2 > *
//!BIND TMP1_L0
//!BIND TMP1_L1
//!SAVE TMP2_L0
//!COMPONENTS 4

#define ACTIVE(v) (max(v, 0.0f))

#define TEX_BIND_L0_TEXOFF TMP1_L0_texOff
#define TEX_BIND_L0_TEX TMP1_L0_tex
#define TEX_BIND_L0_POS TMP1_L0_pos
#define TEX_BIND_L0_SIZE TMP1_L0_size
#define TEX_BIND_L0_PT TMP1_L0_pt

#define TEX_BIND_L1_TEXOFF TMP1_L1_texOff
#define TEX_BIND_L1_TEX TMP1_L1_tex
#define TEX_BIND_L1_POS TMP1_L1_pos
#define TEX_BIND_L1_SIZE TMP1_L1_size
#define TEX_BIND_L1_PT TMP1_L1_pt

const float kernels[288] = float[288](
  +0.0562528f, -0.0790902f, +0.1116465f, -0.0259073f, -0.1213027f, +0.3468941f, -0.0842637f, +0.1633011f,
  +0.0101180f, -0.2922309f, +0.0502110f, -0.1420054f, -0.5177289f, -0.1238934f, +0.1019153f, +0.6613029f,
  -0.0827487f, +0.1575871f, -0.1033763f, +0.0844672f, -0.0803934f, -0.2066596f, -0.0642556f, +0.1549667f,
  -0.0640736f, +0.0687558f, -0.0005236f, +0.0111379f, +0.0302037f, -0.0296502f, +0.0229501f, +0.1710266f,
  +0.0407226f, +0.1573840f, +0.1765983f, +0.2176942f, +0.3595208f, +0.1110212f, -0.0665105f, +0.1507257f,
  +0.0116566f, +0.1541331f, -0.0022504f, -0.4242234f, +0.1668072f, -0.1478228f, -0.0638142f, +0.1740045f,
  -0.1156043f, -0.0612879f, -0.1769731f, +0.0650464f, -0.0009472f, +0.0321927f, +0.0437441f, +0.0009099f,
  -0.0035596f, -0.1253567f, +0.0184999f, +0.0268341f, +0.0772907f, -0.0398615f, -0.1055693f, +0.0109171f,
  -0.0267128f, -0.1596590f, +0.0206925f, +0.0029047f, +0.0830391f, +0.0164401f, -0.0120447f, -0.0133224f,
  -0.0642728f, -0.0525663f, -0.2799875f, +0.0886018f, -0.0224883f, +0.1464236f, -0.0287624f, +0.2398860f,
  -0.0621776f, +0.0620905f, -0.0047415f, +0.2933680f, +0.1347353f, +0.1232123f, -0.0126104f, +0.3981928f,
  -0.0772232f, -0.0156135f, +0.0564193f, +0.1375341f, -0.1141875f, -0.2493595f, -0.0837662f, +0.1845140f,
  -0.1033155f, +0.0145702f, +0.0705653f, +0.0100631f, +0.0285764f, +0.0226093f, -0.0509920f, +0.0368884f,
  -0.2107225f, -0.1024324f, -0.4927282f, +0.0163482f, -0.0747941f, -0.2817075f, -0.0057269f, +0.1102319f,
  -0.0022843f, +0.1309054f, -0.1293596f, +0.1006262f, -0.0772611f, +0.1150979f, -0.0709813f, +0.0044804f,
  +0.0327166f, -0.0299879f, +0.0556850f, +0.0362303f, +0.0588737f, +0.0260561f, -0.0961912f, -0.0044140f,
  -0.0637542f, -0.0758968f, -0.0058924f, +0.0179680f, -0.0029448f, -0.0275319f, -0.0923840f, -0.0048275f,
  +0.0503593f, -0.0009454f, -0.0319673f, -0.1162433f, +0.0602074f, -0.0475050f, -0.0533283f, +0.0200182f,
  -0.0243462f, +0.0364562f, +0.0995100f, -0.0084753f, +0.0833828f, -0.4663331f, -0.0426547f, -0.1604776f,
  -0.0655463f, -0.0155184f, +0.0279742f, +0.0806757f, +0.0458481f, +0.1450375f, +0.0924705f, +0.0987422f,
  -0.0046065f, +0.0644899f, -0.0667163f, +0.1577079f, -0.0117324f, +0.1499885f, -0.0772417f, +0.0442821f,
  +0.2229838f, +0.0469826f, +0.3704201f, -0.1146658f, +0.0454940f, +0.2964232f, -0.2102138f, -0.0601873f,
  +0.2881043f, +0.0527434f, +0.2081268f, +0.0562691f, -0.2140595f, -0.4880660f, +0.1242281f, +0.1949533f,
  +0.0140707f, +0.3080191f, -0.0315814f, +0.1136890f, +0.0605912f, -0.1601155f, +0.0149666f, +0.0832909f,
  -0.1731495f, +0.0679401f, +0.0790644f, -0.0147273f, +0.0465031f, +0.1670811f, -0.0541291f, -0.0751900f,
  -0.0579613f, +0.0058777f, -0.1369915f, +0.0372634f, -0.1036219f, +0.0953128f, +0.0743551f, -0.0684290f,
  -0.0991357f, +0.3115456f, -0.0447224f, -0.2055431f, +0.0387941f, -0.0759811f, -0.0470685f, +0.0373906f,
  +0.0005141f, -0.0175279f, +0.0436757f, +0.0273237f, +0.0350841f, -0.0897859f, -0.0159259f, -0.0890287f,
  +0.1509845f, +0.0144079f, +0.0698946f, +0.0913423f, +0.0191234f, +0.1966662f, -0.0091200f, -0.0863393f,
  -0.1154895f, +0.0375000f, +0.0081063f, -0.0509684f, +0.0100731f, +0.0381108f, -0.0723283f, -0.0275458f,
  +0.1687486f, +0.0386465f, -0.2611667f, +0.1068942f, +0.1699501f, +0.0306073f, +0.1354777f, +0.0603781f,
  +0.1803973f, +0.1684959f, -0.1092040f, +0.5056503f, +0.3409897f, -0.0190841f, +0.7103997f, +0.2840106f,
  -0.1316240f, +0.0175354f, +0.0522088f, +0.4600377f, -0.4084721f, -0.0651137f, -0.0942084f, -0.0665496f,
  +0.0771005f, -0.0282049f, -0.0527489f, -0.0066862f, -0.0055317f, +0.0853935f, +0.0025411f, -0.0304864f,
  +0.2081598f, +0.0102725f, -0.0170621f, +0.0034162f, +0.0402302f, -0.1399157f, -0.0721588f, +0.0503065f,
  +0.0762887f, +0.1668788f, -0.0968080f, +0.3355924f, -0.2030503f, +0.0149882f, +0.1084843f, -0.0110840f
);

const float biases[4] = float[4](
  -0.0045910f, -0.0104115f, -0.0086935f, -0.0039950f
);

vec4 hook() {
    const vec4 r[9][2] = vec4[9][2](
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 1.0f)))
    );

    float sum[4] = biases;
    for (int n = 0; n < 4; n++) {
        for (int i = 0; i < 9; i++) {
            const vec4 k0 = vec4(kernels[n * 8 * 9 + 8 * i + 0], kernels[n * 8 * 9 + 8 * i + 1], kernels[n * 8 * 9 + 8 * i + 2], kernels[n * 8 * 9 + 8 * i + 3]);
            const vec4 k1 = vec4(kernels[n * 8 * 9 + 8 * i + 4], kernels[n * 8 * 9 + 8 * i + 5], kernels[n * 8 * 9 + 8 * i + 6], kernels[n * 8 * 9 + 8 * i + 7]);
            sum[n] += (dot(k0, r[i][0]) + dot(k1, r[i][1]));
        }
    }

    return ACTIVE(vec4(sum[0], sum[1], sum[2], sum[3]));
}

//!HOOK LUMA
//!DESC ACNet Layer5 L1
//!WHEN OUTPUT.w LUMA.w / 1.2 > OUTPUT.h LUMA.h / 1.2 > *
//!BIND TMP1_L0
//!BIND TMP1_L1
//!SAVE TMP2_L1
//!COMPONENTS 4

#define ACTIVE(v) (max(v, 0.0f))

#define TEX_BIND_L0_TEXOFF TMP1_L0_texOff
#define TEX_BIND_L0_TEX TMP1_L0_tex
#define TEX_BIND_L0_POS TMP1_L0_pos
#define TEX_BIND_L0_SIZE TMP1_L0_size
#define TEX_BIND_L0_PT TMP1_L0_pt

#define TEX_BIND_L1_TEXOFF TMP1_L1_texOff
#define TEX_BIND_L1_TEX TMP1_L1_tex
#define TEX_BIND_L1_POS TMP1_L1_pos
#define TEX_BIND_L1_SIZE TMP1_L1_size
#define TEX_BIND_L1_PT TMP1_L1_pt

const float kernels[288] = float[288](
  +0.0297320f, -0.0104175f, -0.0732357f, +0.0667744f, +0.0353547f, -0.0801635f, +0.0732902f, -0.0537319f,
  +0.0999601f, +0.1093072f, -0.0459077f, +0.2016793f, +0.1867138f, -0.0243866f, +0.0225464f, -0.2461772f,
  -0.0774079f, -0.0616087f, +0.0227052f, -0.0750831f, -0.0401673f, -0.0050309f, -0.0290151f, -0.0128898f,
  +0.3493990f, +0.0360569f, -0.0151480f, +0.0566084f, +0.1287054f, +0.1008906f, +0.0799442f, +0.0861334f,
  -0.5604817f, +0.0938658f, +0.2173488f, +0.2279905f, +0.3505047f, -0.0300075f, -0.2697154f, +0.1950328f,
  +0.0290530f, -0.1033942f, +0.0224770f, -0.3747334f, +0.1809046f, +0.0172513f, +0.0713491f, +0.0822023f,
  -0.0269906f, -0.0185715f, -0.0341529f, -0.0723358f, -0.0624287f, -0.0094662f, -0.0170258f, -0.0010060f,
  +0.0496371f, -0.0208892f, -0.0269393f, +0.0443292f, +0.0621844f, -0.0147605f, +0.1146093f, -0.0004593f,
  -0.0393224f, -0.0745312f, -0.0050167f, -0.0367469f, +0.0688035f, +0.0073434f, -0.0412878f, -0.0187892f,
  -0.0408434f, +0.0536200f, -0.0715541f, -0.0004537f, +0.0945261f, +0.0370793f, -0.1340165f, -0.1488569f,
  -0.0078149f, +0.1419760f, +0.1060765f, +0.1082649f, +0.0144325f, -0.0391690f, -0.3380919f, +0.0405982f,
  -0.0614637f, +0.0065651f, +0.0589724f, -0.0641410f, +0.1593719f, -0.0377518f, -0.0443695f, -0.1421940f,
  -0.0793637f, +0.0235119f, +0.1863753f, -0.0238740f, +0.1129157f, -0.0790214f, +0.1426204f, +0.0020223f,
  -0.0596467f, -0.0266093f, -0.2105329f, -0.0463067f, -0.3427356f, +0.0859777f, +0.0652536f, -0.2867261f,
  -0.0054059f, -0.0464355f, -0.0640089f, -0.0278125f, -0.1081317f, +0.0109583f, -0.3336609f, -0.3362187f,
  +0.1955340f, +0.0124990f, +0.1085117f, +0.0183851f, -0.0074636f, -0.0585756f, +0.0124156f, +0.0191915f,
  -0.2407914f, +0.0510792f, +0.0721872f, +0.0946872f, +0.0371007f, +0.0559312f, -0.0904924f, -0.0221042f,
  -0.0079538f, -0.0227127f, +0.0897223f, +0.0683745f, +0.0372258f, +0.0483009f, -0.0582051f, +0.0190479f,
  +0.0600213f, +0.1113746f, +0.0568470f, -0.0332608f, +0.1114257f, -0.0501032f, +0.1126380f, -0.0845798f,
  +0.2252023f, -0.0193003f, -0.0746960f, +0.1328701f, +0.0496248f, +0.0617401f, -0.0446909f, -0.1074709f,
  -0.0539717f, -0.0549835f, -0.0113540f, +0.0198314f, -0.0543690f, +0.0042922f, -0.0535754f, -0.0656953f,
  +0.1622560f, -0.1833821f, +0.1054395f, -0.1390719f, -0.3924669f, +0.1766863f, +0.0346915f, +0.1538555f,
  -0.2191805f, +0.6251143f, -0.1491847f, -0.1618001f, +0.2341222f, -0.0081250f, -0.0122006f, +0.1404120f,
  -0.0521174f, -0.1790852f, +0.0482079f, -0.0072323f, -0.0367264f, +0.0063694f, -0.0842208f, +0.0069961f,
  -0.0062363f, +0.1700324f, -0.0562616f, -0.0516891f, -0.0114684f, -0.0677230f, +0.2367725f, +0.0261378f,
  +0.2026623f, +0.1790159f, -0.2330301f, +0.0631209f, +0.0340453f, +0.0745763f, +0.3907282f, +0.0231491f,
  -0.0073323f, +0.0544624f, -0.0299160f, -0.1447989f, +0.0664541f, +0.0101127f, +0.0247105f, -0.0188196f,
  -0.0335406f, +0.0235236f, -0.0466492f, +0.0504188f, +0.0048819f, +0.0222819f, -0.0253021f, -0.0549836f,
  +0.0320892f, -0.0642963f, +0.0812773f, +0.0093091f, -0.0295194f, -0.0334395f, -0.0114177f, +0.1477328f,
  -0.0189158f, +0.0589498f, -0.0599177f, -0.0280543f, +0.0377398f, +0.0190476f, +0.0482279f, -0.0255456f,
  +0.1056387f, -0.0031415f, +0.0815223f, -0.0309789f, +0.0645464f, +0.0232749f, +0.0583672f, +0.0330249f,
  -0.0753193f, -0.0412028f, -0.0920375f, -0.0253659f, -0.3727158f, -0.0211532f, -0.0430622f, -0.1013838f,
  -0.0542819f, +0.1078100f, +0.0081039f, +0.0352653f, -0.0853929f, -0.0203854f, +0.0228138f, +0.0638864f,
  -0.0069388f, +0.0178485f, -0.0655408f, -0.0377301f, -0.0302234f, -0.0462445f, -0.0462790f, +0.0124025f,
  -0.0208732f, -0.0295347f, +0.0518108f, +0.0575744f, -0.0778995f, +0.0224433f, +0.0500521f, +0.0162153f,
  +0.0560996f, -0.0164120f, -0.0014380f, +0.0346835f, +0.0027365f, -0.0302057f, +0.0229607f, +0.0107834f
);

const float biases[4] = float[4](
  +0.1076636f, +0.0347268f, -0.0165118f, +0.7296443f
);

vec4 hook() {
    const vec4 r[9][2] = vec4[9][2](
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 1.0f)))
    );

    float sum[4] = biases;
    for (int n = 0; n < 4; n++) {
        for (int i = 0; i < 9; i++) {
            const vec4 k0 = vec4(kernels[n * 8 * 9 + 8 * i + 0], kernels[n * 8 * 9 + 8 * i + 1], kernels[n * 8 * 9 + 8 * i + 2], kernels[n * 8 * 9 + 8 * i + 3]);
            const vec4 k1 = vec4(kernels[n * 8 * 9 + 8 * i + 4], kernels[n * 8 * 9 + 8 * i + 5], kernels[n * 8 * 9 + 8 * i + 6], kernels[n * 8 * 9 + 8 * i + 7]);
            sum[n] += (dot(k0, r[i][0]) + dot(k1, r[i][1]));
        }
    }

    return ACTIVE(vec4(sum[0], sum[1], sum[2], sum[3]));
}

//!HOOK LUMA
//!DESC ACNet Layer6 L0
//!WHEN OUTPUT.w LUMA.w / 1.2 > OUTPUT.h LUMA.h / 1.2 > *
//!BIND TMP2_L0
//!BIND TMP2_L1
//!SAVE TMP1_L0
//!COMPONENTS 4

#define ACTIVE(v) (max(v, 0.0f))

#define TEX_BIND_L0_TEXOFF TMP2_L0_texOff
#define TEX_BIND_L0_TEX TMP2_L0_tex
#define TEX_BIND_L0_POS TMP2_L0_pos
#define TEX_BIND_L0_SIZE TMP2_L0_size
#define TEX_BIND_L0_PT TMP2_L0_pt

#define TEX_BIND_L1_TEXOFF TMP2_L1_texOff
#define TEX_BIND_L1_TEX TMP2_L1_tex
#define TEX_BIND_L1_POS TMP2_L1_pos
#define TEX_BIND_L1_SIZE TMP2_L1_size
#define TEX_BIND_L1_PT TMP2_L1_pt

const float kernels[288] = float[288](
  +0.0250418f, -0.0192031f, +0.0405776f, -0.0646137f, +0.0380019f, -0.0006021f, +0.0520043f, +0.0009444f,
  -0.0532658f, +0.0162560f, +0.0240041f, -0.0017301f, -0.0276916f, +0.1602441f, +0.3148897f, +0.0279643f,
  +0.0384841f, +0.0042906f, +0.0034044f, -0.0334440f, -0.0177574f, -0.0064591f, +0.5971602f, +0.0176717f,
  +0.0037189f, -0.0316370f, +0.0759158f, -0.2794958f, +0.1935647f, +0.0317789f, -0.0722379f, -0.0860220f,
  +0.1049272f, +0.5028667f, -0.1356383f, +0.7135067f, +0.0195983f, -0.3104899f, +0.3433204f, -0.0382802f,
  +0.1445869f, -0.0695042f, -0.0902960f, +0.0428254f, -0.1086239f, +0.0126842f, -0.2065506f, +0.0002802f,
  -0.0374419f, +0.0014677f, +0.0341560f, +0.0247966f, +0.0257342f, -0.1009753f, +0.0011013f, +0.0338245f,
  -0.1574445f, -0.0899839f, +0.0724937f, +0.0005416f, +0.0117025f, -0.1883863f, -0.0503281f, -0.0678827f,
  +0.1995656f, -0.0903755f, -0.0200371f, -0.0896763f, -0.0739124f, +0.0513872f, -0.0461180f, +0.0105289f,
  -0.0659821f, +0.0320064f, +0.0713670f, +0.1048148f, -0.0506570f, -0.0591098f, +0.0702792f, +0.1035730f,
  +0.1138496f, -0.0020627f, +0.0982834f, +0.0307342f, +0.0877015f, -0.0742516f, +0.1706484f, -0.1888466f,
  +0.0030091f, -0.0690435f, +0.1042479f, +0.0104313f, +0.0702345f, +0.0098241f, -0.2515007f, +0.0237800f,
  +0.1232997f, +0.0722194f, +0.2228613f, -0.2131406f, +0.0903490f, -0.1200573f, -0.0262893f, -0.1888396f,
  +0.6187584f, -0.3239258f, -0.5937381f, -0.0728174f, +0.1490474f, +0.1387851f, +0.3842146f, -0.4332559f,
  +0.0571447f, -0.0266571f, +0.1001425f, +0.1203605f, +0.1161219f, -0.0143221f, -0.2205132f, -0.1146546f,
  -0.0438351f, +0.0135230f, +0.0656995f, -0.0541799f, +0.0599240f, -0.0754626f, -0.0289175f, +0.0334970f,
  -0.6818569f, +0.1809945f, +0.0136181f, +0.1050012f, +0.2492825f, +0.0144066f, +0.0400739f, -0.1346179f,
  -0.1091700f, +0.0491677f, -0.0740453f, +0.0278215f, +0.1707783f, -0.0069202f, -0.0712963f, -0.0341265f,
  -0.0127305f, +0.0228905f, -0.0335469f, +0.0130276f, +0.0096714f, +0.0094233f, +0.0548821f, +0.0121021f,
  +0.0543260f, +0.0614215f, -0.2899306f, +0.1471598f, -0.0055842f, -0.0112962f, +0.1511858f, -0.0181767f,
  -0.0265814f, +0.0528321f, +0.0700799f, +0.0204343f, +0.0079155f, -0.1092709f, +0.1836308f, -0.0031643f,
  +0.0517529f, -0.0983687f, +0.0824777f, -0.4407084f, +0.1452466f, +0.0792997f, -0.0882233f, -0.0690645f,
  +0.0068200f, -0.1145165f, -0.1988066f, +0.3835900f, -0.3222803f, +0.0552861f, -0.0900834f, +0.0003185f,
  +0.0043246f, +0.1741951f, +0.1284882f, -0.0016655f, +0.1145392f, -0.1155823f, +0.4822110f, -0.0701128f,
  -0.0699627f, +0.2039213f, -0.2780228f, -0.2029720f, +0.1452656f, +0.3817256f, +0.0408900f, +0.0973082f,
  -0.1561751f, -0.1132169f, -0.1562150f, +0.1563095f, -0.0303989f, -0.0543515f, +0.0564288f, +0.1069075f,
  +0.2519246f, +0.0984617f, +0.0627124f, +0.0770857f, -0.0670427f, -0.1788990f, -0.2853751f, -0.0659190f,
  -0.0000000f, +0.0000000f, +0.0000000f, +0.0000000f, +0.0000000f, -0.0000000f, -0.0000000f, -0.0000000f,
  -0.0000000f, +0.0000000f, +0.0000000f, +0.0000000f, +0.0000000f, +0.0000000f, -0.0000000f, +0.0000000f,
  -0.0000000f, -0.0000000f, -0.0000000f, -0.0000000f, +0.0000000f, +0.0000000f, -0.0000000f, -0.0000000f,
  +0.0000000f, +0.0000000f, +0.0000000f, +0.0000000f, -0.0000000f, +0.0000000f, +0.0000000f, -0.0000000f,
  +0.0000000f, -0.0000000f, -0.0000000f, +0.0000000f, +0.0000000f, -0.0000000f, +0.0000000f, -0.0000000f,
  +0.0000000f, -0.0000000f, +0.0000000f, -0.0000000f, -0.0000000f, -0.0000000f, +0.0000000f, -0.0000000f,
  -0.0000000f, -0.0000000f, -0.0000000f, -0.0000000f, +0.0000000f, +0.0000000f, +0.0000000f, +0.0000000f,
  -0.0000000f, -0.0000000f, -0.0000000f, +0.0000000f, -0.0000000f, -0.0000000f, +0.0000000f, -0.0000000f,
  -0.0000000f, -0.0000000f, -0.0000000f, -0.0000000f, -0.0000000f, +0.0000000f, +0.0000000f, -0.0000000f
);

const float biases[4] = float[4](
  +0.0876115f, +0.5912559f, +0.0046709f, -0.0000000f
);

vec4 hook() {
    const vec4 r[9][2] = vec4[9][2](
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 1.0f)))
    );

    float sum[4] = biases;
    for (int n = 0; n < 4; n++) {
        for (int i = 0; i < 9; i++) {
            const vec4 k0 = vec4(kernels[n * 8 * 9 + 8 * i + 0], kernels[n * 8 * 9 + 8 * i + 1], kernels[n * 8 * 9 + 8 * i + 2], kernels[n * 8 * 9 + 8 * i + 3]);
            const vec4 k1 = vec4(kernels[n * 8 * 9 + 8 * i + 4], kernels[n * 8 * 9 + 8 * i + 5], kernels[n * 8 * 9 + 8 * i + 6], kernels[n * 8 * 9 + 8 * i + 7]);
            sum[n] += (dot(k0, r[i][0]) + dot(k1, r[i][1]));
        }
    }

    return ACTIVE(vec4(sum[0], sum[1], sum[2], sum[3]));
}

//!HOOK LUMA
//!DESC ACNet Layer6 L1
//!WHEN OUTPUT.w LUMA.w / 1.2 > OUTPUT.h LUMA.h / 1.2 > *
//!BIND TMP2_L0
//!BIND TMP2_L1
//!SAVE TMP1_L1
//!COMPONENTS 4

#define ACTIVE(v) (max(v, 0.0f))

#define TEX_BIND_L0_TEXOFF TMP2_L0_texOff
#define TEX_BIND_L0_TEX TMP2_L0_tex
#define TEX_BIND_L0_POS TMP2_L0_pos
#define TEX_BIND_L0_SIZE TMP2_L0_size
#define TEX_BIND_L0_PT TMP2_L0_pt

#define TEX_BIND_L1_TEXOFF TMP2_L1_texOff
#define TEX_BIND_L1_TEX TMP2_L1_tex
#define TEX_BIND_L1_POS TMP2_L1_pos
#define TEX_BIND_L1_SIZE TMP2_L1_size
#define TEX_BIND_L1_PT TMP2_L1_pt

const float kernels[288] = float[288](
  +0.0251520f, -0.0318236f, -0.0144600f, -0.0583341f, +0.0030101f, -0.1139969f, +0.0321817f, -0.0428286f,
  -0.0328780f, -0.0550948f, -0.0878343f, +0.1888613f, +0.0963795f, -0.1922080f, -0.0563464f, +0.1077753f,
  +0.0216264f, +0.0313381f, -0.0323429f, +0.0615468f, +0.0661398f, -0.0341584f, +0.0326553f, -0.0681295f,
  +0.1987923f, -0.0321989f, +0.2402344f, -0.2615182f, +0.1020125f, +0.0228712f, -0.0169122f, +0.0058156f,
  +0.0290801f, -0.4381959f, +0.7191647f, +0.6672177f, -0.2323958f, -0.6868364f, +0.0842643f, -0.2399779f,
  -0.0030331f, +0.0413911f, -0.1855926f, -0.1248608f, -0.1835558f, -0.0108563f, -0.0795205f, +0.1905177f,
  -0.2338014f, -0.0412075f, -0.0067635f, -0.0481283f, +0.0400188f, +0.0263114f, +0.0012788f, -0.0418547f,
  -0.0235777f, +0.3747549f, -0.0944095f, +0.1051003f, +0.2298510f, +0.0254218f, -0.0711096f, +0.1014030f,
  +0.1187059f, -0.1854832f, -0.0178905f, -0.0426193f, -0.1297966f, -0.0151899f, +0.0865851f, -0.0171390f,
  +0.0000000f, +0.0000000f, +0.0000000f, +0.0000000f, -0.0000000f, +0.0000000f, +0.0000000f, -0.0000000f,
  -0.0000000f, +0.0000000f, +0.0000000f, -0.0000000f, -0.0000000f, +0.0000000f, +0.0000000f, -0.0000000f,
  +0.0000000f, +0.0000000f, -0.0000000f, -0.0000000f, -0.0000000f, +0.0000000f, -0.0000000f, -0.0000000f,
  +0.0000000f, -0.0000000f, -0.0000000f, -0.0000000f, -0.0000000f, +0.0000000f, -0.0000000f, +0.0000000f,
  +0.0000000f, +0.0000000f, -0.0000000f, -0.0000000f, -0.0000000f, -0.0000000f, +0.0000000f, +0.0000000f,
  +0.0000000f, +0.0000000f, -0.0000000f, +0.0000000f, +0.0000000f, +0.0000000f, +0.0000000f, -0.0000000f,
  -0.0000000f, -0.0000000f, +0.0000000f, -0.0000000f, -0.0000000f, +0.0000000f, +0.0000000f, -0.0000000f,
  +0.0000000f, +0.0000000f, +0.0000000f, -0.0000000f, -0.0000000f, +0.0000000f, +0.0000000f, +0.0000000f,
  -0.0000000f, +0.0000000f, -0.0000000f, +0.0000000f, -0.0000000f, +0.0000000f, -0.0000000f, -0.0000000f,
  -0.0000000f, +0.0000000f, +0.0000000f, +0.0000000f, +0.0000000f, -0.0000000f, +0.0000000f, +0.0000000f,
  +0.0000000f, -0.0000000f, +0.0000000f, -0.0000000f, +0.0000000f, +0.0000000f, -0.0000000f, -0.0000000f,
  -0.0000000f, -0.0000000f, +0.0000000f, -0.0000000f, +0.0000000f, -0.0000000f, +0.0000000f, -0.0000000f,
  -0.0000000f, +0.0000000f, +0.0000000f, +0.0000000f, -0.0000000f, -0.0000000f, +0.0000000f, -0.0000000f,
  -0.0000000f, +0.0000000f, -0.0000000f, +0.0000000f, -0.0000000f, -0.0000000f, +0.0000000f, -0.0000000f,
  +0.0000000f, -0.0000000f, +0.0000000f, -0.0000000f, +0.0000000f, -0.0000000f, -0.0000000f, +0.0000000f,
  +0.0000000f, -0.0000000f, +0.0000000f, -0.0000000f, -0.0000000f, +0.0000000f, +0.0000000f, -0.0000000f,
  -0.0000000f, -0.0000000f, +0.0000000f, +0.0000000f, -0.0000000f, +0.0000000f, -0.0000000f, -0.0000000f,
  +0.0000000f, +0.0000000f, +0.0000000f, +0.0000000f, +0.0000000f, -0.0000000f, -0.0000000f, +0.0000000f,
  -0.0351565f, +0.0640427f, +0.0715942f, +0.0552962f, -0.0236856f, -0.0880297f, +0.0238288f, -0.0039768f,
  +0.0683369f, -0.0102533f, +0.0398601f, +0.0551992f, +0.1227150f, -0.0258527f, -0.0050078f, +0.0205796f,
  +0.0161492f, -0.0006281f, +0.0810884f, -0.0212532f, -0.0160093f, -0.0170867f, +0.0538543f, -0.0419308f,
  -0.0058650f, +0.0468279f, +0.1775032f, +0.1721413f, -0.2017609f, -0.2053282f, -0.0096934f, +0.0695771f,
  +0.6060491f, -0.3961851f, -0.1238102f, +0.2054208f, +0.7475662f, +0.1521441f, +0.0370473f, -0.1041573f,
  +0.0317385f, -0.0092633f, +0.1447643f, -0.0037859f, -0.0345259f, -0.0018639f, +0.4732462f, -0.0025037f,
  +0.0933056f, -0.0817516f, +0.0234164f, +0.1283125f, -0.0470551f, -0.1123609f, +0.0056975f, -0.0191978f,
  +0.2149854f, +0.0990826f, +0.1281894f, +0.0320870f, -0.3709867f, -0.2461188f, -0.0861075f, +0.0620269f,
  +0.1360900f, +0.0044296f, +0.0108157f, -0.0518514f, -0.1921577f, +0.0630941f, +0.0655686f, -0.0108326f
);

const float biases[4] = float[4](
  +0.0233807f, -0.0000000f, -0.0000000f, +0.0370998f
);

vec4 hook() {
    const vec4 r[9][2] = vec4[9][2](
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 1.0f)))
    );

    float sum[4] = biases;
    for (int n = 0; n < 4; n++) {
        for (int i = 0; i < 9; i++) {
            const vec4 k0 = vec4(kernels[n * 8 * 9 + 8 * i + 0], kernels[n * 8 * 9 + 8 * i + 1], kernels[n * 8 * 9 + 8 * i + 2], kernels[n * 8 * 9 + 8 * i + 3]);
            const vec4 k1 = vec4(kernels[n * 8 * 9 + 8 * i + 4], kernels[n * 8 * 9 + 8 * i + 5], kernels[n * 8 * 9 + 8 * i + 6], kernels[n * 8 * 9 + 8 * i + 7]);
            sum[n] += (dot(k0, r[i][0]) + dot(k1, r[i][1]));
        }
    }

    return ACTIVE(vec4(sum[0], sum[1], sum[2], sum[3]));
}

//!HOOK LUMA
//!DESC ACNet Layer7 L0
//!WHEN OUTPUT.w LUMA.w / 1.2 > OUTPUT.h LUMA.h / 1.2 > *
//!BIND TMP1_L0
//!BIND TMP1_L1
//!SAVE TMP2_L0
//!COMPONENTS 4

#define ACTIVE(v) (max(v, 0.0f))

#define TEX_BIND_L0_TEXOFF TMP1_L0_texOff
#define TEX_BIND_L0_TEX TMP1_L0_tex
#define TEX_BIND_L0_POS TMP1_L0_pos
#define TEX_BIND_L0_SIZE TMP1_L0_size
#define TEX_BIND_L0_PT TMP1_L0_pt

#define TEX_BIND_L1_TEXOFF TMP1_L1_texOff
#define TEX_BIND_L1_TEX TMP1_L1_tex
#define TEX_BIND_L1_POS TMP1_L1_pos
#define TEX_BIND_L1_SIZE TMP1_L1_size
#define TEX_BIND_L1_PT TMP1_L1_pt

const float kernels[288] = float[288](
  -0.0000000f, +0.0000000f, +0.0000000f, -0.0000000f, +0.0000000f, +0.0000000f, +0.0000000f, +0.0000000f,
  +0.0000000f, -0.0000000f, -0.0000000f, -0.0000000f, +0.0000000f, -0.0000000f, -0.0000000f, -0.0000000f,
  +0.0000000f, -0.0000000f, -0.0000000f, -0.0000000f, +0.0000000f, +0.0000000f, +0.0000000f, -0.0000000f,
  +0.0000000f, +0.0000000f, -0.0000000f, -0.0000000f, +0.0000000f, +0.0000000f, +0.0000000f, -0.0000000f,
  +0.0000000f, +0.0000000f, -0.0000000f, +0.0000000f, +0.0000000f, -0.0000000f, +0.0000000f, +0.0000000f,
  -0.0000000f, +0.0000000f, +0.0000000f, -0.0000000f, -0.0000000f, +0.0000000f, +0.0000000f, +0.0000000f,
  -0.0000000f, +0.0000000f, +0.0000000f, +0.0000000f, -0.0000000f, +0.0000000f, -0.0000000f, -0.0000000f,
  +0.0000000f, +0.0000000f, -0.0000000f, -0.0000000f, -0.0000000f, +0.0000000f, +0.0000000f, -0.0000000f,
  +0.0000000f, +0.0000000f, -0.0000000f, -0.0000000f, +0.0000000f, +0.0000000f, +0.0000000f, -0.0000000f,
  -0.0591076f, +0.0479723f, -0.6108360f, +0.0000000f, -0.0360265f, +0.0000000f, +0.0000000f, +0.0698755f,
  +0.0354680f, +0.0116228f, -0.0085679f, +0.0000000f, -0.0063004f, -0.0000000f, +0.0000000f, -0.0292903f,
  -0.0287715f, -0.0021687f, +0.0094956f, -0.0000000f, +0.0152372f, -0.0000000f, -0.0000000f, +0.0032294f,
  +0.6860188f, -0.4974448f, -0.4524553f, +0.0000000f, +0.6074302f, +0.0000000f, +0.0000000f, -0.4263183f,
  +0.1423218f, +0.2775143f, -0.1212562f, -0.0000000f, +0.0925227f, -0.0000000f, +0.0000000f, +0.1578878f,
  +0.0119539f, +0.0178619f, -0.0373681f, +0.0000000f, -0.0047370f, -0.0000000f, -0.0000000f, +0.0368093f,
  -0.0382338f, +0.0742864f, +0.0256244f, +0.0000000f, +0.0344066f, +0.0000000f, +0.0000000f, +0.0212204f,
  +0.0718371f, +0.0031309f, +0.0120867f, +0.0000000f, -0.0838229f, +0.0000000f, -0.0000000f, +0.0001653f,
  -0.0188324f, +0.0011030f, -0.0154306f, +0.0000000f, +0.0168976f, -0.0000000f, +0.0000000f, +0.0068502f,
  -0.0652205f, +0.1068451f, -0.0039718f, +0.0000000f, +0.0235594f, -0.0000000f, -0.0000000f, -0.1242916f,
  +0.0880593f, +0.2276259f, +0.0464159f, -0.0000000f, -0.0869490f, -0.0000000f, -0.0000000f, -0.3506177f,
  +0.0057934f, +0.0337963f, +0.0473571f, +0.0000000f, -0.0383500f, -0.0000000f, -0.0000000f, -0.1141800f,
  -0.1728005f, +0.1762909f, +0.0736939f, -0.0000000f, -0.2954701f, +0.0000000f, -0.0000000f, -0.0407867f,
  +0.1530335f, +0.3888151f, -0.1644373f, +0.0000000f, +0.7018700f, +0.0000000f, -0.0000000f, +0.6168983f,
  +0.1766276f, +0.0635398f, +0.0247843f, -0.0000000f, -0.0839788f, -0.0000000f, -0.0000000f, -0.1008539f,
  -0.1290763f, +0.0647066f, -0.0030808f, +0.0000000f, -0.0285764f, -0.0000000f, -0.0000000f, +0.0160976f,
  -0.1174891f, +0.1004563f, +0.0273985f, -0.0000000f, -0.1653785f, -0.0000000f, -0.0000000f, +0.0850995f,
  +0.0578872f, -0.0819106f, -0.0002922f, +0.0000000f, -0.0524648f, -0.0000000f, -0.0000000f, -0.0116210f,
  +0.0000000f, -0.0000000f, -0.0000000f, -0.0000000f, +0.0000000f, -0.0000000f, +0.0000000f, -0.0000000f,
  -0.0000000f, -0.0000000f, +0.0000000f, -0.0000000f, +0.0000000f, +0.0000000f, -0.0000000f, +0.0000000f,
  -0.0000000f, +0.0000000f, -0.0000000f, -0.0000000f, -0.0000000f, -0.0000000f, -0.0000000f, +0.0000000f,
  -0.0000000f, -0.0000000f, +0.0000000f, +0.0000000f, +0.0000000f, -0.0000000f, -0.0000000f, -0.0000000f,
  -0.0000000f, -0.0000000f, +0.0000000f, -0.0000000f, +0.0000000f, +0.0000000f, -0.0000000f, -0.0000000f,
  +0.0000000f, +0.0000000f, -0.0000000f, -0.0000000f, +0.0000000f, -0.0000000f, -0.0000000f, +0.0000000f,
  +0.0000000f, +0.0000000f, +0.0000000f, -0.0000000f, -0.0000000f, -0.0000000f, -0.0000000f, -0.0000000f,
  -0.0000000f, +0.0000000f, -0.0000000f, -0.0000000f, +0.0000000f, -0.0000000f, -0.0000000f, -0.0000000f,
  -0.0000000f, +0.0000000f, -0.0000000f, -0.0000000f, +0.0000000f, +0.0000000f, -0.0000000f, -0.0000000f
);

const float biases[4] = float[4](
  -0.0000000f, -0.0145360f, -0.0633624f, +0.0000000f
);

vec4 hook() {
    const vec4 r[9][2] = vec4[9][2](
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 1.0f)))
    );

    float sum[4] = biases;
    for (int n = 0; n < 4; n++) {
        for (int i = 0; i < 9; i++) {
            const vec4 k0 = vec4(kernels[n * 8 * 9 + 8 * i + 0], kernels[n * 8 * 9 + 8 * i + 1], kernels[n * 8 * 9 + 8 * i + 2], kernels[n * 8 * 9 + 8 * i + 3]);
            const vec4 k1 = vec4(kernels[n * 8 * 9 + 8 * i + 4], kernels[n * 8 * 9 + 8 * i + 5], kernels[n * 8 * 9 + 8 * i + 6], kernels[n * 8 * 9 + 8 * i + 7]);
            sum[n] += (dot(k0, r[i][0]) + dot(k1, r[i][1]));
        }
    }

    return ACTIVE(vec4(sum[0], sum[1], sum[2], sum[3]));
}

//!HOOK LUMA
//!DESC ACNet Layer7 L1
//!WHEN OUTPUT.w LUMA.w / 1.2 > OUTPUT.h LUMA.h / 1.2 > *
//!BIND TMP1_L0
//!BIND TMP1_L1
//!SAVE TMP2_L1
//!COMPONENTS 4

#define ACTIVE(v) (max(v, 0.0f))

#define TEX_BIND_L0_TEXOFF TMP1_L0_texOff
#define TEX_BIND_L0_TEX TMP1_L0_tex
#define TEX_BIND_L0_POS TMP1_L0_pos
#define TEX_BIND_L0_SIZE TMP1_L0_size
#define TEX_BIND_L0_PT TMP1_L0_pt

#define TEX_BIND_L1_TEXOFF TMP1_L1_texOff
#define TEX_BIND_L1_TEX TMP1_L1_tex
#define TEX_BIND_L1_POS TMP1_L1_pos
#define TEX_BIND_L1_SIZE TMP1_L1_size
#define TEX_BIND_L1_PT TMP1_L1_pt

const float kernels[288] = float[288](
  +0.0770375f, -0.0461412f, -0.0196223f, +0.0000000f, -0.0347074f, -0.0000000f, +0.0000000f, +0.0911797f,
  -0.0163173f, -0.0407498f, +0.0163483f, -0.0000000f, +0.0125176f, -0.0000000f, -0.0000000f, +0.0566647f,
  -0.0241183f, -0.0005641f, +0.0069859f, +0.0000000f, +0.0094679f, -0.0000000f, -0.0000000f, -0.0006544f,
  -0.0430858f, -0.1563993f, -0.0931420f, +0.0000000f, +0.1225353f, +0.0000000f, +0.0000000f, +0.1175903f,
  -0.2151233f, -0.3450557f, +0.0103677f, -0.0000000f, +0.1939445f, +0.0000000f, -0.0000000f, +0.2751727f,
  +0.1228839f, -0.0144407f, -0.0565853f, -0.0000000f, +0.0265300f, -0.0000000f, -0.0000000f, +0.1914341f,
  +0.1823683f, -0.2027753f, +0.0842127f, +0.0000000f, +0.2241319f, +0.0000000f, +0.0000000f, +0.0979048f,
  -0.1543834f, -0.3140258f, +0.1077551f, -0.0000000f, -0.1629820f, +0.0000000f, -0.0000000f, +0.0667070f,
  -0.1134636f, -0.0625423f, -0.1031478f, -0.0000000f, -0.0614457f, +0.0000000f, +0.0000000f, +0.0865351f,
  +0.0088717f, -0.0047094f, -0.2620690f, +0.0000000f, +0.0718501f, +0.0000000f, -0.0000000f, +0.0256228f,
  +0.0309127f, +0.0347688f, -0.0461498f, +0.0000000f, +0.0487699f, +0.0000000f, -0.0000000f, +0.0269416f,
  +0.0066909f, -0.0132913f, -0.0640991f, +0.0000000f, -0.0150811f, +0.0000000f, -0.0000000f, +0.0243424f,
  -0.0817905f, -0.0085570f, -0.3262305f, +0.0000000f, +0.4807151f, +0.0000000f, -0.0000000f, -0.0990837f,
  -0.4788326f, -0.4003829f, -0.1898445f, -0.0000000f, +0.2547725f, +0.0000000f, -0.0000000f, +0.5297357f,
  +0.0749196f, +0.1841762f, -0.0578911f, -0.0000000f, +0.0381971f, -0.0000000f, -0.0000000f, -0.0679828f,
  +0.4584253f, -0.1469574f, -0.2208756f, +0.0000000f, +0.2601138f, +0.0000000f, -0.0000000f, -0.2245445f,
  -0.1040975f, +0.3227905f, -0.0420420f, +0.0000000f, +0.2460958f, +0.0000000f, -0.0000000f, +0.1150700f,
  +0.1665523f, +0.0257124f, -0.0253070f, -0.0000000f, -0.0361667f, -0.0000000f, -0.0000000f, +0.0203642f,
  +0.3485181f, -0.0457526f, +0.0941135f, +0.0000000f, -0.0379199f, -0.0000000f, +0.0000000f, -0.1207818f,
  -0.3109071f, -0.5009706f, -0.5681245f, +0.0000000f, +0.2469772f, +0.0000000f, -0.0000000f, +0.3194847f,
  +0.0811542f, +0.1750314f, -0.1208142f, -0.0000000f, +0.0500190f, +0.0000000f, -0.0000000f, +0.0100819f,
  -0.3220532f, +0.1405800f, -0.0858087f, +0.0000000f, -0.0142460f, +0.0000000f, -0.0000000f, -0.0107814f,
  +0.1710295f, +0.1131138f, -0.0098661f, -0.0000000f, +0.2873884f, -0.0000000f, -0.0000000f, +0.0807203f,
  +0.2416166f, +0.1594457f, -0.0230644f, -0.0000000f, -0.0547041f, -0.0000000f, -0.0000000f, -0.0463298f,
  -0.0026892f, -0.0539751f, -0.0016453f, +0.0000000f, +0.0794364f, -0.0000000f, -0.0000000f, -0.0180845f,
  +0.0241417f, +0.0523256f, -0.0183275f, +0.0000000f, -0.0278377f, +0.0000000f, +0.0000000f, -0.0228459f,
  +0.0555400f, -0.0623820f, +0.0024282f, -0.0000000f, -0.0341906f, -0.0000000f, -0.0000000f, -0.0055861f,
  -0.0324000f, +0.0325939f, +0.0376849f, +0.0000000f, +0.0524511f, -0.0000000f, +0.0000000f, -0.0407161f,
  -0.1732883f, +0.1154374f, +0.0595943f, -0.0000000f, +0.1017915f, +0.0000000f, -0.0000000f, -0.2853079f,
  -0.0279947f, -0.0185014f, +0.0895267f, +0.0000000f, +0.0484869f, +0.0000000f, -0.0000000f, +0.0399809f,
  -0.0536798f, +0.0702480f, +0.2295654f, -0.0000000f, -0.2101971f, -0.0000000f, -0.0000000f, +0.0222775f,
  +0.4131030f, -0.0698379f, -0.2968123f, -0.0000000f, -0.4434452f, +0.0000000f, +0.0000000f, +0.5666130f,
  -0.0946912f, -0.0542781f, -0.1632875f, -0.0000000f, -0.0876419f, -0.0000000f, -0.0000000f, -0.0838905f,
  +0.0769380f, -0.0293171f, -0.1320644f, +0.0000000f, +0.0709583f, +0.0000000f, +0.0000000f, -0.0773310f,
  -0.0495965f, -0.1489041f, -0.0438077f, -0.0000000f, +0.1993425f, +0.0000000f, -0.0000000f, -0.0938430f,
  +0.1964933f, +0.0786614f, +0.0388539f, +0.0000000f, -0.0210900f, -0.0000000f, -0.0000000f, +0.0155836f
);

const float biases[4] = float[4](
  +0.0799564f, +0.0003068f, -0.0102570f, -0.0120371f
);

vec4 hook() {
    const vec4 r[9][2] = vec4[9][2](
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 1.0f)))
    );

    float sum[4] = biases;
    for (int n = 0; n < 4; n++) {
        for (int i = 0; i < 9; i++) {
            const vec4 k0 = vec4(kernels[n * 8 * 9 + 8 * i + 0], kernels[n * 8 * 9 + 8 * i + 1], kernels[n * 8 * 9 + 8 * i + 2], kernels[n * 8 * 9 + 8 * i + 3]);
            const vec4 k1 = vec4(kernels[n * 8 * 9 + 8 * i + 4], kernels[n * 8 * 9 + 8 * i + 5], kernels[n * 8 * 9 + 8 * i + 6], kernels[n * 8 * 9 + 8 * i + 7]);
            sum[n] += (dot(k0, r[i][0]) + dot(k1, r[i][1]));
        }
    }

    return ACTIVE(vec4(sum[0], sum[1], sum[2], sum[3]));
}

//!HOOK LUMA
//!DESC ACNet Layer8 L0
//!WHEN OUTPUT.w LUMA.w / 1.2 > OUTPUT.h LUMA.h / 1.2 > *
//!BIND TMP2_L0
//!BIND TMP2_L1
//!SAVE TMP1_L0
//!COMPONENTS 4

#define ACTIVE(v) (max(v, 0.0f))

#define TEX_BIND_L0_TEXOFF TMP2_L0_texOff
#define TEX_BIND_L0_TEX TMP2_L0_tex
#define TEX_BIND_L0_POS TMP2_L0_pos
#define TEX_BIND_L0_SIZE TMP2_L0_size
#define TEX_BIND_L0_PT TMP2_L0_pt

#define TEX_BIND_L1_TEXOFF TMP2_L1_texOff
#define TEX_BIND_L1_TEX TMP2_L1_tex
#define TEX_BIND_L1_POS TMP2_L1_pos
#define TEX_BIND_L1_SIZE TMP2_L1_size
#define TEX_BIND_L1_PT TMP2_L1_pt

const float kernels[288] = float[288](
  -0.0000000f, -0.0122200f, -0.0175052f, +0.0000000f, -0.0127521f, +0.0008003f, -0.0013049f, -0.1064709f,
  -0.0000000f, -0.0868862f, -0.0206910f, +0.0000000f, +0.0231500f, +0.3224250f, -0.0057771f, +0.0733280f,
  +0.0000000f, +0.0107142f, -0.0145072f, +0.0000000f, -0.0053355f, -0.0225663f, +0.0096437f, +0.0258715f,
  +0.0000000f, +0.0116560f, +0.0261571f, -0.0000000f, -0.0596669f, +0.0087850f, +0.0324767f, -0.0708829f,
  +0.0000000f, -0.0736347f, +0.0741085f, -0.0000000f, -0.3957975f, -0.2402468f, +0.2448199f, -0.0927253f,
  +0.0000000f, +0.0594269f, +0.0128223f, +0.0000000f, -0.0700327f, +0.0461230f, +0.0405799f, -0.0151848f,
  -0.0000000f, +0.0048518f, -0.0197373f, -0.0000000f, -0.0226121f, -0.0190383f, +0.0131942f, +0.0118037f,
  -0.0000000f, +0.1354344f, -0.0492809f, -0.0000000f, +0.0191760f, -0.0085750f, -0.4660191f, +0.0017784f,
  -0.0000000f, +0.0146677f, +0.0085962f, +0.0000000f, +0.0105884f, -0.0048153f, -0.0661630f, -0.0044099f,
  -0.0000000f, -0.0118802f, -0.0151026f, +0.0000000f, -0.0737648f, +0.0268617f, -0.0007096f, +0.0363543f,
  -0.0000000f, -0.0318841f, -0.0490744f, -0.0000000f, -0.0497232f, +0.1163408f, -0.0067877f, +0.0977943f,
  -0.0000000f, -0.0208498f, -0.0177016f, -0.0000000f, +0.0493573f, +0.0456662f, +0.0096674f, +0.0116868f,
  +0.0000000f, -0.0068633f, +0.0721191f, -0.0000000f, -0.0242069f, -0.0047351f, -0.0049952f, +0.0268468f,
  -0.0000000f, +0.1642177f, +0.0331993f, +0.0000000f, -0.1029073f, -0.4159268f, +0.0886641f, +0.3256473f,
  +0.0000000f, +1.0281119f, -0.0009708f, +0.0000000f, -0.0014001f, +0.0360816f, -0.0277074f, -0.0087710f,
  +0.0000000f, +0.0035887f, +0.0553833f, -0.0000000f, -0.0127507f, +0.0114458f, +0.0853092f, -0.0203716f,
  +0.0000000f, +0.2117956f, +0.1034323f, +0.0000000f, +0.0042805f, -0.0052026f, +0.0555130f, -0.0190902f,
  -0.0000000f, -0.1009402f, +0.0251564f, +0.0000000f, +0.0018934f, +0.0186725f, -0.0762301f, -0.0032566f,
  -0.0000000f, +0.0115004f, -0.1024094f, +0.0000000f, +0.1326941f, -0.0559225f, +0.0136770f, +0.0273569f,
  +0.0000000f, -0.3067490f, -0.0213119f, +0.0000000f, -0.3103053f, +0.7140408f, -0.0351832f, +0.5213277f,
  +0.0000000f, -0.0300795f, -0.0319991f, +0.0000000f, -0.0440909f, -0.0298522f, +0.0123909f, -0.0575705f,
  +0.0000000f, +0.0150800f, -0.0635981f, -0.0000000f, +0.0046385f, +0.0130406f, -0.0924050f, +0.0275802f,
  +0.0000000f, -0.2429201f, +0.1518682f, +0.0000000f, +0.0214112f, +0.0393728f, +0.2964964f, +0.1038117f,
  -0.0000000f, +0.1273621f, +0.1227872f, -0.0000000f, +0.0571409f, -0.2451482f, +0.0696949f, +0.0136776f,
  +0.0000000f, -0.0195132f, +0.0015695f, +0.0000000f, +0.0207243f, +0.0044278f, -0.0331253f, +0.0049260f,
  -0.0000000f, -0.0193761f, +0.1137604f, +0.0000000f, -0.0354058f, +0.0215570f, +0.3469994f, -0.0444194f,
  -0.0000000f, -0.0859595f, +0.0052648f, -0.0000000f, +0.0025717f, -0.0084940f, +0.1455178f, +0.0007065f,
  +0.0000000f, -0.0050427f, +0.0314798f, -0.0000000f, -0.1333690f, +0.0425297f, -0.0034601f, -0.0788544f,
  -0.0000000f, -0.0028247f, +0.0206650f, +0.0000000f, -0.4277692f, -0.0422987f, -0.0072087f, -0.2031557f,
  -0.0000000f, -0.0537345f, +0.0002781f, +0.0000000f, -0.1356905f, +0.1431967f, -0.0005551f, +0.0077746f,
  +0.0000000f, -0.0159182f, +0.0730849f, -0.0000000f, +0.0299150f, +0.0143705f, +0.0445680f, -0.0114368f,
  -0.0000000f, +0.1832458f, +0.7766001f, -0.0000000f, -0.2701593f, -0.1128948f, +0.1362083f, +0.2155746f,
  -0.0000000f, -0.1783434f, +0.1197915f, -0.0000000f, -0.0037454f, -0.0388293f, -0.0438113f, -0.0194785f,
  -0.0000000f, -0.0051774f, +0.0199791f, +0.0000000f, -0.0135742f, +0.0051689f, +0.0113502f, -0.0135106f,
  -0.0000000f, +0.0800088f, +0.1662949f, +0.0000000f, -0.0362979f, +0.0158038f, -0.2841653f, -0.0203389f,
  +0.0000000f, +0.0056296f, +0.0232158f, -0.0000000f, -0.0165711f, +0.0016125f, +0.0315533f, -0.0102758f
);

const float biases[4] = float[4](
  -0.0005618f, +0.0117194f, +0.0083430f, +0.0686088f
);

vec4 hook() {
    const vec4 r[9][2] = vec4[9][2](
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 1.0f)))
    );

    float sum[4] = biases;
    for (int n = 0; n < 4; n++) {
        for (int i = 0; i < 9; i++) {
            const vec4 k0 = vec4(kernels[n * 8 * 9 + 8 * i + 0], kernels[n * 8 * 9 + 8 * i + 1], kernels[n * 8 * 9 + 8 * i + 2], kernels[n * 8 * 9 + 8 * i + 3]);
            const vec4 k1 = vec4(kernels[n * 8 * 9 + 8 * i + 4], kernels[n * 8 * 9 + 8 * i + 5], kernels[n * 8 * 9 + 8 * i + 6], kernels[n * 8 * 9 + 8 * i + 7]);
            sum[n] += (dot(k0, r[i][0]) + dot(k1, r[i][1]));
        }
    }

    return ACTIVE(vec4(sum[0], sum[1], sum[2], sum[3]));
}

//!HOOK LUMA
//!DESC ACNet Layer8 L1
//!WHEN OUTPUT.w LUMA.w / 1.2 > OUTPUT.h LUMA.h / 1.2 > *
//!BIND TMP2_L0
//!BIND TMP2_L1
//!SAVE TMP1_L1
//!COMPONENTS 4

#define ACTIVE(v) (max(v, 0.0f))

#define TEX_BIND_L0_TEXOFF TMP2_L0_texOff
#define TEX_BIND_L0_TEX TMP2_L0_tex
#define TEX_BIND_L0_POS TMP2_L0_pos
#define TEX_BIND_L0_SIZE TMP2_L0_size
#define TEX_BIND_L0_PT TMP2_L0_pt

#define TEX_BIND_L1_TEXOFF TMP2_L1_texOff
#define TEX_BIND_L1_TEX TMP2_L1_tex
#define TEX_BIND_L1_POS TMP2_L1_pos
#define TEX_BIND_L1_SIZE TMP2_L1_size
#define TEX_BIND_L1_PT TMP2_L1_pt

const float kernels[288] = float[288](
  -0.0000000f, +0.0047864f, +0.0059537f, -0.0000000f, -0.0047530f, -0.0152686f, -0.0123857f, +0.0222867f,
  +0.0000000f, +0.0571246f, +0.0140504f, -0.0000000f, -0.1231540f, -0.0384298f, +0.0063762f, +0.0253597f,
  -0.0000000f, -0.0154685f, +0.0001980f, +0.0000000f, +0.0082373f, -0.0747173f, -0.0370472f, -0.0061253f,
  -0.0000000f, -0.0039614f, +0.0249645f, -0.0000000f, -0.0924119f, +0.0333613f, +0.0138392f, -0.0189917f,
  +0.0000000f, -0.0290423f, +0.1307745f, +0.0000000f, +0.1715614f, -0.1195597f, -0.0363580f, -0.4007761f,
  -0.0000000f, +0.2834741f, -0.0473142f, +0.0000000f, +0.0111763f, +0.4230377f, +0.0436095f, +0.0738208f,
  -0.0000000f, -0.0101332f, +0.0062744f, +0.0000000f, -0.0140814f, -0.0029924f, -0.0083692f, +0.0056517f,
  +0.0000000f, +0.0827446f, -0.1906765f, -0.0000000f, +0.0146939f, -0.0330353f, +0.4579446f, +0.0423485f,
  +0.0000000f, -0.1045024f, +0.0525933f, -0.0000000f, -0.0194746f, -0.0365604f, -0.3076082f, -0.0256416f,
  +0.0000000f, -0.0120742f, +0.0510470f, +0.0000000f, -0.0365983f, +0.0306667f, -0.0132841f, -0.1896647f,
  -0.0000000f, +0.1764669f, -0.0304569f, -0.0000000f, -0.0018520f, -0.2628740f, +0.0205380f, -0.1683350f,
  +0.0000000f, +0.0118816f, +0.0125310f, +0.0000000f, -0.1699875f, +0.0305918f, -0.0005448f, +0.0989342f,
  +0.0000000f, +0.0064764f, -0.1325232f, -0.0000000f, -0.0868058f, -0.0455591f, +0.0580961f, +0.0823262f,
  -0.0000000f, -0.2374215f, +0.1259337f, +0.0000000f, -0.0772656f, -0.1471566f, -0.0147898f, +0.0755845f,
  -0.0000000f, -0.1803348f, -0.0637169f, -0.0000000f, -0.0960422f, +0.2093178f, -0.0201581f, -0.0171878f,
  -0.0000000f, +0.0258664f, +0.0407939f, +0.0000000f, -0.0213416f, -0.0058472f, -0.0396540f, -0.0149849f,
  +0.0000000f, +0.0659845f, -0.0147865f, +0.0000000f, +0.0257929f, -0.0100229f, -0.2206906f, +0.0218233f,
  -0.0000000f, +0.0371914f, +0.0171389f, -0.0000000f, -0.0072541f, +0.0121342f, -0.1508910f, -0.0077015f,
  +0.0000000f, -0.0148839f, +0.0165924f, -0.0000000f, +0.0340525f, +0.0181289f, -0.0117656f, +0.0364732f,
  +0.0000000f, +0.0497672f, +0.0000305f, -0.0000000f, -0.0895602f, -0.1478487f, -0.0085959f, +0.1876148f,
  -0.0000000f, -0.0302882f, -0.0101795f, -0.0000000f, -0.0444790f, +0.1126679f, -0.0300460f, +0.0049495f,
  -0.0000000f, +0.0089874f, -0.0486825f, +0.0000000f, +0.0421278f, -0.0716374f, -0.0021081f, -0.0696405f,
  -0.0000000f, -0.1029024f, +0.1402500f, +0.0000000f, +0.0692529f, +0.5559484f, +0.1151779f, -0.2877456f,
  +0.0000000f, +0.3134378f, +0.0292372f, +0.0000000f, -0.0071096f, -0.0105695f, -0.0844195f, +0.0361486f,
  +0.0000000f, +0.0059735f, -0.0233337f, -0.0000000f, +0.0423584f, +0.0184810f, -0.0758289f, +0.0009635f,
  +0.0000000f, -0.2081340f, -0.0966380f, -0.0000000f, -0.0172148f, -0.0475562f, +0.1819852f, +0.0139668f,
  +0.0000000f, -0.0066145f, -0.0102679f, -0.0000000f, +0.0090389f, -0.0111852f, -0.0097726f, -0.0060015f,
  +0.0000000f, -0.0023464f, -0.0260334f, +0.0000000f, +0.0343247f, +0.0055059f, +0.0043618f, +0.0576245f,
  +0.0000000f, -0.0738884f, +0.0129727f, -0.0000000f, -0.1723956f, +0.1774420f, -0.0042793f, +0.4231443f,
  +0.0000000f, +0.0347014f, +0.0049147f, +0.0000000f, -0.0496452f, -0.0286811f, -0.0004782f, -0.0197322f,
  +0.0000000f, -0.0005226f, +0.0230052f, -0.0000000f, -0.0243408f, -0.0034868f, -0.0427952f, +0.0348112f,
  +0.0000000f, +0.0384443f, +0.1704471f, +0.0000000f, +0.0526521f, -0.1456853f, +0.2007010f, -0.2303268f,
  +0.0000000f, -0.5373517f, +0.0247155f, +0.0000000f, -0.0111885f, +0.0165076f, +0.0384021f, +0.0114768f,
  -0.0000000f, -0.0017970f, +0.0279808f, -0.0000000f, -0.0036336f, +0.0046766f, +0.0505858f, -0.0073744f,
  -0.0000000f, +0.0902985f, -0.0846619f, -0.0000000f, +0.0004215f, -0.0179627f, +0.2190951f, +0.0191121f,
  +0.0000000f, +0.0531510f, -0.0094778f, +0.0000000f, +0.0033086f, -0.0026397f, -0.0343812f, +0.0042251f
);

const float biases[4] = float[4](
  -0.0046424f, +0.0014692f, -0.0076037f, +0.0078869f
);

vec4 hook() {
    const vec4 r[9][2] = vec4[9][2](
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 1.0f)))
    );

    float sum[4] = biases;
    for (int n = 0; n < 4; n++) {
        for (int i = 0; i < 9; i++) {
            const vec4 k0 = vec4(kernels[n * 8 * 9 + 8 * i + 0], kernels[n * 8 * 9 + 8 * i + 1], kernels[n * 8 * 9 + 8 * i + 2], kernels[n * 8 * 9 + 8 * i + 3]);
            const vec4 k1 = vec4(kernels[n * 8 * 9 + 8 * i + 4], kernels[n * 8 * 9 + 8 * i + 5], kernels[n * 8 * 9 + 8 * i + 6], kernels[n * 8 * 9 + 8 * i + 7]);
            sum[n] += (dot(k0, r[i][0]) + dot(k1, r[i][1]));
        }
    }

    return ACTIVE(vec4(sum[0], sum[1], sum[2], sum[3]));
}

//!HOOK LUMA
//!DESC ACNet Layer9 L0
//!WIDTH LUMA.w 2 *
//!HEIGHT LUMA.h 2 *
//!BIND TMP1_L0
//!BIND TMP1_L1
//!COMPONENTS 1

#define ACTIVE(v) (max(v, 0.0f))

#define TEX_BIND_L0_TEXOFF TMP1_L0_texOff
#define TEX_BIND_L0_TEX TMP1_L0_tex
#define TEX_BIND_L0_POS TMP1_L0_pos
#define TEX_BIND_L0_SIZE TMP1_L0_size
#define TEX_BIND_L0_PT TMP1_L0_pt

#define TEX_BIND_L1_TEXOFF TMP1_L1_texOff
#define TEX_BIND_L1_TEX TMP1_L1_tex
#define TEX_BIND_L1_POS TMP1_L1_pos
#define TEX_BIND_L1_SIZE TMP1_L1_size
#define TEX_BIND_L1_PT TMP1_L1_pt

const float kernels[32] = float[32](
  +0.4907895f, -0.0014691f, -0.2980749f, +0.3330785f, +0.2363579f, -0.3714728f, +0.2377767f, -0.0850692f,
  -0.0456545f, -0.3152242f, +0.0912283f, +0.2853064f, +0.0792340f, +0.1403556f, +0.1570414f, +0.2770620f,
  -0.1715610f, +0.3044945f, +0.0121907f, +0.2210031f, +0.2885413f, -0.0260412f, -0.5734012f, +0.0414966f,
  -0.2114614f, +0.0329760f, +0.2280912f, +0.2610858f, -0.7122354f, +0.2143899f, +0.2076892f, -0.1857636f
);

vec4 hook() {
    vec2 fcoord = fract(TEX_BIND_L0_POS * TEX_BIND_L0_SIZE);
    vec2 pos = TEX_BIND_L0_POS + (vec2(0.5f) - fcoord) * TEX_BIND_L0_PT;

    ivec2 icoord = ivec2(fcoord * vec2(2.0f));
    int index = icoord.y * 2 + icoord.x;

    vec4 r0 = TEX_BIND_L0_TEX(pos);
    vec4 r1 = TEX_BIND_L1_TEX(pos);

    vec4 k0 = vec4(kernels[8 * index + 0], kernels[8 * index + 1], kernels[8 * index + 2], kernels[8 * index + 3]);
    vec4 k1 = vec4(kernels[8 * index + 4], kernels[8 * index + 5], kernels[8 * index + 6], kernels[8 * index + 7]);

    return vec4(clamp(dot(r0, k0) + dot(r1, k1), 0.0f, 1.0f), 0.0f, 0.0f, 1.0f);
}
