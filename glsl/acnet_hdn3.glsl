//!HOOK LUMA
//!DESC ACNet Layer0 L0
//!WHEN OUTPUT.w LUMA.w / 1.2 > OUTPUT.h LUMA.h / 1.2 > *
//!BIND LUMA
//!SAVE TMP1_L0
//!COMPONENTS 4

#define ACTIVE(v) (max(v, 0.0f))

#define TEX_BIND_L0_TEXOFF LUMA_texOff
#define TEX_BIND_L0_TEX LUMA_tex
#define TEX_BIND_L0_POS LUMA_pos
#define TEX_BIND_L0_SIZE LUMA_size
#define TEX_BIND_L0_PT LUMA_pt

const float kernels[36] = float[36](
  -0.0460532f, +0.1274178f, +0.2976153f, -0.0392854f, -0.1250755f, +0.2526721f, +0.0791400f, +0.0599901f,
  -0.0302737f, -0.0519700f, -0.5039056f, -0.3304785f, -0.0115114f, +0.0455821f, +0.4369715f, +0.0601103f,
  +0.0780323f, +0.3105793f, -0.0016930f, -0.0017574f, -0.0017152f, -0.0017367f, -0.0018000f, -0.0017564f,
  -0.0016834f, -0.0017469f, -0.0017052f, +0.2665958f, +0.1687175f, +0.2302501f, -0.1900863f, +0.3824937f,
  +0.3024489f, +0.1811211f, +0.0580730f, +0.2079533f
);

const float biases[4] = float[4](
  -0.1329426f, -0.0431460f, -0.0031026f, -0.0129482f
);

vec4 hook() {
    const vec4 r0 = vec4(
        TEX_BIND_L0_TEXOFF(vec2(-1.0f,-1.0f)).x,
        TEX_BIND_L0_TEXOFF(vec2( 0.0f,-1.0f)).x,
        TEX_BIND_L0_TEXOFF(vec2( 1.0f,-1.0f)).x,
        TEX_BIND_L0_TEXOFF(vec2(-1.0f, 0.0f)).x
    );
    const vec4 r4 = vec4(
        TEX_BIND_L0_TEXOFF(vec2( 0.0f, 0.0f)).x,
        TEX_BIND_L0_TEXOFF(vec2( 1.0f, 0.0f)).x,
        TEX_BIND_L0_TEXOFF(vec2(-1.0f, 1.0f)).x,
        TEX_BIND_L0_TEXOFF(vec2( 0.0f, 1.0f)).x
    );
    const float r8 = TEX_BIND_L0_TEXOFF(vec2( 1.0f, 1.0f)).x;

    float sum[4] = biases;
    for(int n = 0; n < 4; n++) {
        const vec4 k0 = vec4(kernels[n * 9 + 0], kernels[n * 9 + 1], kernels[n * 9 + 2], kernels[n * 9 + 3]);
        const vec4 k4 = vec4(kernels[n * 9 + 4], kernels[n * 9 + 5], kernels[n * 9 + 6], kernels[n * 9 + 7]);
        const float k8 = kernels[n * 9 + 8];
        sum[n] += (dot(r0, k0) + dot(r4, k4) + r8 * k8);
    }

    return ACTIVE(vec4(sum[0], sum[1], sum[2], sum[3]));
}

//!HOOK LUMA
//!DESC ACNet Layer0 L1
//!WHEN OUTPUT.w LUMA.w / 1.2 > OUTPUT.h LUMA.h / 1.2 > *
//!BIND LUMA
//!SAVE TMP1_L1
//!COMPONENTS 4

#define ACTIVE(v) (max(v, 0.0f))

#define TEX_BIND_L0_TEXOFF LUMA_texOff
#define TEX_BIND_L0_TEX LUMA_tex
#define TEX_BIND_L0_POS LUMA_pos
#define TEX_BIND_L0_SIZE LUMA_size
#define TEX_BIND_L0_PT LUMA_pt

const float kernels[36] = float[36](
  -0.1245805f, +0.0155449f, -0.4075426f, +0.1155955f, +0.5929422f, +0.1449133f, -0.1080233f, -0.0170551f,
  -0.0515923f, -0.0816623f, +0.2247184f, +0.0471810f, +0.0394054f, +0.1084713f, +0.1434929f, -0.0479870f,
  -0.0134975f, -0.0606006f, -0.0082794f, +0.2044855f, +0.1056317f, -0.2238755f, +0.2823044f, -0.1926087f,
  +0.2581359f, +0.1362070f, -0.1914028f, -0.0833500f, +0.0701557f, +0.0234473f, +0.3616089f, +0.3788595f,
  -0.1840291f, +0.0128328f, +0.1347087f, -0.0186821f
);

const float biases[4] = float[4](
  +0.2293561f, -0.2594860f, -0.2370029f, -0.0498955f
);

vec4 hook() {
    const vec4 r0 = vec4(
        TEX_BIND_L0_TEXOFF(vec2(-1.0f,-1.0f)).x,
        TEX_BIND_L0_TEXOFF(vec2( 0.0f,-1.0f)).x,
        TEX_BIND_L0_TEXOFF(vec2( 1.0f,-1.0f)).x,
        TEX_BIND_L0_TEXOFF(vec2(-1.0f, 0.0f)).x
    );
    const vec4 r4 = vec4(
        TEX_BIND_L0_TEXOFF(vec2( 0.0f, 0.0f)).x,
        TEX_BIND_L0_TEXOFF(vec2( 1.0f, 0.0f)).x,
        TEX_BIND_L0_TEXOFF(vec2(-1.0f, 1.0f)).x,
        TEX_BIND_L0_TEXOFF(vec2( 0.0f, 1.0f)).x
    );
    const float r8 = TEX_BIND_L0_TEXOFF(vec2( 1.0f, 1.0f)).x;

    float sum[4] = biases;
    for(int n = 0; n < 4; n++) {
        const vec4 k0 = vec4(kernels[n * 9 + 0], kernels[n * 9 + 1], kernels[n * 9 + 2], kernels[n * 9 + 3]);
        const vec4 k4 = vec4(kernels[n * 9 + 4], kernels[n * 9 + 5], kernels[n * 9 + 6], kernels[n * 9 + 7]);
        const float k8 = kernels[n * 9 + 8];
        sum[n] += (dot(r0, k0) + dot(r4, k4) + r8 * k8);
    }

    return ACTIVE(vec4(sum[0], sum[1], sum[2], sum[3]));
}

//!HOOK LUMA
//!DESC ACNet Layer1 L0
//!WHEN OUTPUT.w LUMA.w / 1.2 > OUTPUT.h LUMA.h / 1.2 > *
//!BIND TMP1_L0
//!BIND TMP1_L1
//!SAVE TMP2_L0
//!COMPONENTS 4

#define ACTIVE(v) (max(v, 0.0f))

#define TEX_BIND_L0_TEXOFF TMP1_L0_texOff
#define TEX_BIND_L0_TEX TMP1_L0_tex
#define TEX_BIND_L0_POS TMP1_L0_pos
#define TEX_BIND_L0_SIZE TMP1_L0_size
#define TEX_BIND_L0_PT TMP1_L0_pt

#define TEX_BIND_L1_TEXOFF TMP1_L1_texOff
#define TEX_BIND_L1_TEX TMP1_L1_tex
#define TEX_BIND_L1_POS TMP1_L1_pos
#define TEX_BIND_L1_SIZE TMP1_L1_size
#define TEX_BIND_L1_PT TMP1_L1_pt

const float kernels[288] = float[288](
  +0.1409026f, +0.2560573f, -0.0000000f, +0.1241280f, -0.0651604f, +0.0615375f, -0.0078384f, -0.0275384f,
  -0.0189852f, +0.2202708f, -0.0000000f, +0.1568160f, +0.0777478f, -0.0197457f, +0.0632769f, +0.1583614f,
  -0.0685890f, +0.2760267f, -0.0000000f, +0.1146495f, +0.0217728f, -0.0127850f, +0.0076751f, +0.1001419f,
  +0.0664912f, +0.1942356f, -0.0000000f, +0.0166825f, +0.0206519f, +0.0259309f, +0.0359558f, -0.0491133f,
  +0.0143601f, +0.0345368f, -0.0000000f, +0.0783825f, +0.2724471f, +0.1273960f, +0.1055541f, +0.1691065f,
  +0.0852225f, +0.0959751f, -0.0000000f, +0.1011016f, +0.1029702f, +0.0900330f, +0.0427281f, +0.2732860f,
  +0.1878176f, +0.0112228f, -0.0000000f, +0.1490217f, -0.0209535f, +0.0864476f, +0.0715779f, +0.0079170f,
  +0.0980420f, -0.4337699f, -0.0000000f, +0.1360796f, +0.0616852f, +0.2068387f, +0.1325274f, +0.0954399f,
  -0.0345578f, -0.1476005f, +0.0000000f, +0.1167380f, +0.0441276f, +0.0980628f, +0.1117088f, +0.1392209f,
  +0.0801515f, +0.0264986f, +0.0000000f, -0.0936899f, -0.1075602f, +0.0163238f, +0.0064559f, -0.0400808f,
  +0.0434384f, +0.3948974f, -0.0000000f, +0.1776480f, +0.0599428f, +0.1311163f, -0.0688845f, -0.0315486f,
  +0.0553142f, -0.0115819f, -0.0000000f, +0.1127465f, -0.0672735f, +0.0061679f, +0.1148149f, +0.2831134f,
  +0.0348959f, +0.3579014f, +0.0000000f, +0.0091159f, -0.1111686f, -0.0077703f, -0.1066546f, -0.1217754f,
  +0.1681616f, +0.1431669f, -0.0000000f, +0.1737543f, +0.1526671f, +0.2631113f, +0.0386126f, -0.1384759f,
  -0.0045783f, -0.2177461f, -0.0000000f, +0.1142670f, +0.1156332f, +0.0894272f, +0.0704103f, +0.1741581f,
  -0.0014579f, +0.0041794f, +0.0000000f, -0.0783853f, -0.1296375f, -0.0289483f, -0.0616804f, -0.0817558f,
  +0.2049319f, -0.3251281f, -0.0000000f, +0.1565751f, -0.0386035f, +0.1934062f, -0.0173745f, -0.1771835f,
  +0.0262382f, -0.1672879f, -0.0000000f, -0.0383989f, -0.0245316f, +0.0443393f, +0.0095475f, +0.0795333f,
  -0.0031299f, -0.0000366f, +0.0000000f, -0.0054972f, -0.0037940f, -0.0000723f, -0.0002388f, -0.0039853f,
  -0.0032305f, -0.0000367f, +0.0000000f, -0.0056409f, -0.0038853f, -0.0000787f, -0.0003797f, -0.0040748f,
  -0.0032094f, -0.0000313f, -0.0000000f, -0.0056919f, -0.0038693f, -0.0000477f, -0.0003945f, -0.0041134f,
  -0.0031548f, -0.0000149f, -0.0000000f, -0.0055818f, -0.0038995f, -0.0001113f, -0.0002411f, -0.0040685f,
  -0.0032553f, -0.0000144f, -0.0000000f, -0.0057079f, -0.0039616f, -0.0001192f, -0.0003840f, -0.0041456f,
  -0.0032453f, -0.0000122f, -0.0000000f, -0.0057542f, -0.0038945f, -0.0000789f, -0.0004019f, -0.0041548f,
  -0.0031459f, -0.0000000f, +0.0000000f, -0.0056338f, -0.0038438f, -0.0001164f, -0.0002345f, -0.0040547f,
  -0.0032278f, -0.0000000f, +0.0000000f, -0.0057437f, -0.0039156f, -0.0001242f, -0.0003752f, -0.0041388f,
  -0.0032076f, -0.0000000f, +0.0000000f, -0.0057600f, -0.0038269f, -0.0000823f, -0.0003922f, -0.0041357f,
  +0.0530083f, +0.0159808f, -0.0000000f, +0.0359197f, +0.0037657f, +0.0492894f, +0.1524346f, -0.0132639f,
  +0.0222521f, -0.0768324f, -0.0000000f, +0.0909554f, +0.0264407f, +0.0220879f, +0.1365917f, +0.2150804f,
  -0.0711585f, +0.0179081f, +0.0000000f, -0.0176255f, -0.2558534f, -0.0145884f, +0.0275534f, +0.0484303f,
  -0.0664109f, +0.2761820f, -0.0000000f, +0.0478259f, +0.1096901f, +0.1638378f, +0.1396627f, +0.0511492f,
  -0.0300147f, +0.0540539f, -0.0000000f, +0.1883156f, +0.2391432f, -0.0081421f, +0.1101893f, +0.2916476f,
  -0.0225256f, +0.0872821f, -0.0000000f, -0.0440434f, +0.0351201f, -0.0696132f, +0.0198174f, +0.2807651f,
  +0.1225913f, +0.0152124f, +0.0000000f, -0.0384052f, -0.1625191f, +0.1082039f, +0.1142031f, +0.0029288f,
  -0.0624879f, -0.1109681f, -0.0000000f, +0.0591755f, +0.0343712f, +0.1113707f, -0.0051386f, +0.0906113f,
  +0.0561904f, -0.0222654f, +0.0000000f, +0.0681823f, -0.2750092f, +0.0072648f, +0.0068617f, +0.0815379f
);

const float biases[4] = float[4](
  -0.1175099f, -0.0257945f, -0.0053253f, -0.0437105f
);

vec4 hook() {
    const vec4 r[9][2] = vec4[9][2](
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 1.0f)))
    );

    float sum[4] = biases;
    for (int n = 0; n < 4; n++) {
        for (int i = 0; i < 9; i++) {
            const vec4 k0 = vec4(kernels[n * 8 * 9 + 8 * i + 0], kernels[n * 8 * 9 + 8 * i + 1], kernels[n * 8 * 9 + 8 * i + 2], kernels[n * 8 * 9 + 8 * i + 3]);
            const vec4 k1 = vec4(kernels[n * 8 * 9 + 8 * i + 4], kernels[n * 8 * 9 + 8 * i + 5], kernels[n * 8 * 9 + 8 * i + 6], kernels[n * 8 * 9 + 8 * i + 7]);
            sum[n] += (dot(k0, r[i][0]) + dot(k1, r[i][1]));
        }
    }

    return ACTIVE(vec4(sum[0], sum[1], sum[2], sum[3]));
}

//!HOOK LUMA
//!DESC ACNet Layer1 L1
//!WHEN OUTPUT.w LUMA.w / 1.2 > OUTPUT.h LUMA.h / 1.2 > *
//!BIND TMP1_L0
//!BIND TMP1_L1
//!SAVE TMP2_L1
//!COMPONENTS 4

#define ACTIVE(v) (max(v, 0.0f))

#define TEX_BIND_L0_TEXOFF TMP1_L0_texOff
#define TEX_BIND_L0_TEX TMP1_L0_tex
#define TEX_BIND_L0_POS TMP1_L0_pos
#define TEX_BIND_L0_SIZE TMP1_L0_size
#define TEX_BIND_L0_PT TMP1_L0_pt

#define TEX_BIND_L1_TEXOFF TMP1_L1_texOff
#define TEX_BIND_L1_TEX TMP1_L1_tex
#define TEX_BIND_L1_POS TMP1_L1_pos
#define TEX_BIND_L1_SIZE TMP1_L1_size
#define TEX_BIND_L1_PT TMP1_L1_pt

const float kernels[288] = float[288](
  -0.1181185f, +0.1106438f, +0.0000000f, -0.0472602f, -0.1444865f, -0.1025486f, +0.0740256f, +0.0145959f,
  +0.0156033f, +0.1839699f, -0.0000000f, +0.0028518f, -0.0320433f, -0.0787660f, +0.0696316f, +0.0324421f,
  +0.1157105f, +0.0484488f, -0.0000000f, -0.2776429f, -0.0914658f, -0.1239503f, +0.1715626f, -0.1130834f,
  -0.0349582f, -0.0083336f, -0.0000000f, +0.0069182f, -0.0140216f, +0.0079894f, -0.0303850f, -0.0637343f,
  -0.0016688f, +0.1602899f, -0.0000000f, +0.1393787f, +0.3170339f, +0.0037079f, +0.2321846f, +0.2526973f,
  -0.0466191f, +0.0394900f, +0.0000000f, -0.1316178f, +0.0581656f, -0.0321336f, +0.0738547f, +0.0780814f,
  -0.0104170f, -0.4095900f, -0.0000000f, -0.0060901f, -0.0152431f, +0.1166266f, -0.0885304f, +0.0104684f,
  -0.0318019f, -0.2613386f, -0.0000000f, +0.1033866f, +0.1452126f, +0.1480840f, -0.0592238f, +0.1547270f,
  +0.0183567f, +0.0207655f, -0.0000000f, +0.0604189f, +0.0002079f, +0.2043053f, +0.0234309f, +0.0386762f,
  -0.1084232f, +0.2896500f, +0.0000000f, +0.1966199f, +0.0106202f, -0.0106591f, -0.0629038f, +0.1608354f,
  +0.0086778f, +0.1974769f, +0.0000000f, +0.2140235f, +0.2402368f, -0.0260509f, +0.1527501f, +0.3881875f,
  +0.1498497f, +0.0426512f, -0.0000000f, +0.0310409f, +0.1065684f, -0.0453893f, +0.0044282f, +0.1085450f,
  +0.0081757f, +0.1819632f, +0.0000000f, -0.1107938f, -0.0000799f, +0.0582608f, +0.1444591f, -0.0068126f,
  -0.0821092f, +0.3393229f, +0.0000000f, +0.1336126f, +0.2875984f, +0.0402880f, +0.1181426f, +0.3567298f,
  +0.0854709f, +0.3959361f, -0.0000000f, -0.2160842f, +0.0412315f, +0.0670495f, -0.0803492f, +0.1893752f,
  -0.2143748f, +0.3965740f, +0.0000000f, -0.1796160f, -0.0132614f, -0.2646216f, +0.0203309f, -0.1165954f,
  -0.0611729f, +0.4216696f, -0.0000000f, -0.0805760f, -0.1086763f, -0.1784598f, +0.0330143f, -0.0576942f,
  +0.0481634f, +0.2928984f, -0.0000000f, -0.3127673f, -0.1126722f, -0.1000237f, +0.1270996f, -0.2919374f,
  +0.0127747f, +0.1914708f, +0.0000000f, +0.0372889f, -0.0407514f, +0.1815171f, +0.0933423f, -0.0520174f,
  -0.0327689f, +0.1387499f, -0.0000000f, +0.0081769f, +0.1171014f, +0.1536396f, +0.2660650f, +0.1962792f,
  +0.0172282f, +0.1029786f, -0.0000000f, +0.0170587f, -0.1158633f, +0.1178055f, +0.1467934f, +0.1724291f,
  +0.1832396f, -0.2087070f, +0.0000000f, +0.0377349f, -0.1299931f, +0.2901005f, +0.1672914f, -0.0326671f,
  +0.1198286f, -0.1719659f, -0.0000000f, +0.0665715f, -0.0163837f, +0.2461170f, +0.2537423f, +0.1575621f,
  -0.0169436f, +0.1134187f, -0.0000000f, -0.0661374f, -0.2185763f, +0.1316966f, +0.1195449f, +0.1934655f,
  +0.1059274f, -0.1758086f, +0.0000000f, -0.0588896f, -0.2802795f, +0.1902238f, +0.0632578f, -0.0952518f,
  +0.1345108f, +0.0409720f, -0.0000000f, -0.0077019f, -0.0604431f, +0.1811652f, +0.1055668f, -0.0375254f,
  +0.0525359f, +0.2979595f, -0.0000000f, -0.0621280f, -0.1188003f, +0.1648303f, +0.0672208f, -0.0003454f,
  -0.0497589f, -0.0192151f, +0.0000000f, -0.0068701f, -0.0618378f, +0.0035047f, +0.0605699f, -0.0479851f,
  +0.0403827f, +0.0244273f, +0.0000000f, -0.0148487f, +0.0566671f, +0.0328976f, -0.0057139f, +0.0103035f,
  -0.0202312f, -0.0906383f, +0.0000000f, +0.0863318f, +0.0815843f, +0.0356215f, -0.0010883f, -0.0332363f,
  -0.1177558f, -0.1443772f, +0.0000000f, +0.1168578f, -0.0389002f, +0.0161699f, +0.0227010f, -0.0163345f,
  +0.0341815f, -0.2178509f, -0.0000000f, +0.1834564f, +0.0709266f, +0.0437209f, -0.0291132f, -0.0815384f,
  +0.0367203f, -0.0517890f, -0.0000000f, +0.1879682f, +0.0956057f, +0.0974963f, +0.0079178f, +0.0186287f,
  -0.0148223f, -0.2027894f, -0.0000000f, -0.0232512f, -0.0450983f, +0.0023445f, +0.0812145f, -0.0937201f,
  -0.0416577f, -0.3391756f, -0.0000000f, +0.0739731f, -0.1082880f, +0.0604168f, -0.0414080f, -0.1291956f,
  -0.0137292f, -0.1687115f, +0.0000000f, +0.1053219f, -0.1222356f, +0.1348237f, +0.0136165f, -0.0408359f
);

const float biases[4] = float[4](
  -0.0562847f, -0.1047087f, -0.3448743f, +0.0567839f
);

vec4 hook() {
    const vec4 r[9][2] = vec4[9][2](
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 1.0f)))
    );

    float sum[4] = biases;
    for (int n = 0; n < 4; n++) {
        for (int i = 0; i < 9; i++) {
            const vec4 k0 = vec4(kernels[n * 8 * 9 + 8 * i + 0], kernels[n * 8 * 9 + 8 * i + 1], kernels[n * 8 * 9 + 8 * i + 2], kernels[n * 8 * 9 + 8 * i + 3]);
            const vec4 k1 = vec4(kernels[n * 8 * 9 + 8 * i + 4], kernels[n * 8 * 9 + 8 * i + 5], kernels[n * 8 * 9 + 8 * i + 6], kernels[n * 8 * 9 + 8 * i + 7]);
            sum[n] += (dot(k0, r[i][0]) + dot(k1, r[i][1]));
        }
    }

    return ACTIVE(vec4(sum[0], sum[1], sum[2], sum[3]));
}

//!HOOK LUMA
//!DESC ACNet Layer2 L0
//!WHEN OUTPUT.w LUMA.w / 1.2 > OUTPUT.h LUMA.h / 1.2 > *
//!BIND TMP2_L0
//!BIND TMP2_L1
//!SAVE TMP1_L0
//!COMPONENTS 4

#define ACTIVE(v) (max(v, 0.0f))

#define TEX_BIND_L0_TEXOFF TMP2_L0_texOff
#define TEX_BIND_L0_TEX TMP2_L0_tex
#define TEX_BIND_L0_POS TMP2_L0_pos
#define TEX_BIND_L0_SIZE TMP2_L0_size
#define TEX_BIND_L0_PT TMP2_L0_pt

#define TEX_BIND_L1_TEXOFF TMP2_L1_texOff
#define TEX_BIND_L1_TEX TMP2_L1_tex
#define TEX_BIND_L1_POS TMP2_L1_pos
#define TEX_BIND_L1_SIZE TMP2_L1_size
#define TEX_BIND_L1_PT TMP2_L1_pt

const float kernels[288] = float[288](
  +0.1044330f, +0.1765882f, +0.0000000f, +0.0221265f, +0.1446583f, -0.2238486f, -0.0894988f, +0.0060740f,
  +0.1546141f, -0.0732791f, +0.0000000f, +0.0927147f, -0.0018552f, +0.0030066f, -0.0093821f, +0.0001224f,
  -0.1474338f, +0.0196265f, +0.0000000f, -0.1215044f, -0.1357458f, -0.0226590f, +0.0226748f, -0.1065874f,
  +0.1671595f, +0.1772108f, +0.0000000f, +0.0756515f, +0.2069909f, +0.0618274f, +0.1121308f, -0.0180717f,
  +0.1053183f, -0.1432886f, +0.0000000f, +0.1154751f, +0.0803960f, +0.0253305f, +0.1327581f, -0.0910825f,
  -0.2308787f, -0.1253346f, +0.0000000f, -0.1241986f, -0.1965105f, -0.0538979f, +0.0203676f, -0.0904138f,
  +0.1021761f, +0.1655079f, +0.0000002f, -0.0010693f, -0.0470752f, +0.2709136f, +0.0654076f, +0.0490521f,
  +0.1239338f, -0.3461555f, +0.0000000f, -0.0728393f, -0.0512594f, +0.1099083f, +0.0415975f, -0.1429847f,
  -0.0966459f, +0.0956180f, +0.0000000f, -0.1966439f, -0.0825930f, -0.3359975f, -0.0479170f, -0.0397211f,
  +0.1183990f, +0.1443081f, -0.0052264f, +0.0600078f, +0.0793236f, -0.2486540f, -0.0367525f, +0.1179184f,
  +0.2250287f, +0.0378848f, -0.0052641f, +0.2026781f, +0.0318832f, -0.1019901f, +0.0195231f, +0.0022135f,
  +0.0245868f, +0.0166922f, -0.0052727f, +0.1339608f, +0.0154833f, +0.0198861f, +0.0713212f, -0.0090963f,
  +0.0930226f, +0.1734523f, -0.0052809f, -0.0025202f, -0.0435366f, -0.0105190f, -0.0582948f, -0.0028356f,
  +0.0696505f, +0.0723151f, -0.0053125f, -0.0177498f, +0.0122045f, +0.0699724f, +0.0532422f, -0.0426608f,
  +0.1679771f, +0.0189425f, -0.0053153f, -0.0120188f, +0.0189048f, +0.0480122f, +0.1277322f, +0.0694974f,
  -0.0015640f, +0.1108146f, -0.0052915f, +0.1180640f, -0.0815808f, -0.0152820f, -0.0796705f, +0.0935607f,
  +0.0162996f, +0.0829734f, -0.0053251f, -0.0223056f, -0.1130675f, +0.1197940f, +0.0008325f, +0.1047529f,
  +0.0635849f, -0.0977169f, -0.0053231f, +0.0364636f, -0.0607185f, +0.0879678f, +0.0749036f, +0.0547452f,
  -0.0859006f, +0.1066415f, +0.0004538f, -0.0155001f, +0.1671297f, -0.0394744f, -0.1220173f, -0.1149344f,
  -0.2196905f, -0.2700477f, +0.0004209f, +0.0228651f, +0.0190885f, +0.1626199f, -0.0647347f, -0.0249363f,
  -0.1557198f, +0.1549176f, +0.0005685f, -0.3006951f, -0.2749383f, +0.1672590f, -0.1176215f, +0.0292123f,
  +0.0364733f, -0.0417705f, +0.0003495f, +0.1846660f, +0.1020168f, -0.0862218f, -0.0224269f, -0.0981120f,
  +0.1109734f, -0.1657987f, +0.0003735f, +0.2489863f, +0.2919961f, +0.2057270f, -0.1917133f, -0.0180215f,
  -0.0268298f, +0.0292342f, +0.0003279f, +0.0148121f, -0.0036055f, -0.7324697f, -0.1609242f, -0.1050708f,
  +0.0121989f, -0.0198539f, +0.0002079f, -0.1231808f, +0.1326461f, -0.0953907f, +0.3235556f, -0.1016802f,
  +0.1891731f, +0.2143553f, +0.0002861f, +0.2317483f, +0.2255123f, +0.3893338f, -0.2223372f, +0.1175870f,
  +0.1190635f, -0.1109989f, +0.0003241f, +0.0722437f, +0.1989668f, +0.1586135f, -0.1374262f, -0.0982029f,
  -0.0288707f, +0.0133432f, -0.0003275f, +0.1169198f, -0.2343771f, +0.0810940f, +0.1272308f, -0.2087867f,
  +0.1324926f, +0.1435775f, -0.0002847f, +0.4036569f, +0.0594234f, +0.0291175f, +0.1254059f, -0.0652779f,
  +0.0783776f, -0.0871419f, -0.0000635f, -0.0187094f, -0.1729968f, +0.1667724f, +0.0143193f, -0.0793270f,
  -0.1101211f, +0.1995202f, -0.0002238f, +0.0827002f, +0.0103425f, +0.1215470f, +0.1905493f, -0.1656376f,
  -0.0405958f, +0.0337079f, -0.0001805f, +0.1788388f, +0.0723071f, +0.6535777f, -0.0574405f, -0.1365869f,
  +0.0542016f, +0.0207215f, -0.0000192f, -0.1351963f, -0.4385170f, +0.2454416f, +0.1114562f, -0.2623132f,
  +0.0490216f, +0.0265269f, -0.0000421f, +0.0377583f, -0.0574290f, +0.0311631f, -0.0106895f, -0.3191628f,
  -0.1174400f, -0.2382244f, -0.0000221f, +0.0370476f, -0.0491361f, +0.0374627f, -0.1756718f, -0.2655292f,
  +0.0988884f, +0.2470600f, +0.0000005f, -0.2810866f, -0.0803271f, -0.2661288f, -0.1223839f, -0.0986468f
);

const float biases[4] = float[4](
  +0.0338571f, -0.1738079f, +0.0060786f, +0.1564790f
);

vec4 hook() {
    const vec4 r[9][2] = vec4[9][2](
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 1.0f)))
    );

    float sum[4] = biases;
    for (int n = 0; n < 4; n++) {
        for (int i = 0; i < 9; i++) {
            const vec4 k0 = vec4(kernels[n * 8 * 9 + 8 * i + 0], kernels[n * 8 * 9 + 8 * i + 1], kernels[n * 8 * 9 + 8 * i + 2], kernels[n * 8 * 9 + 8 * i + 3]);
            const vec4 k1 = vec4(kernels[n * 8 * 9 + 8 * i + 4], kernels[n * 8 * 9 + 8 * i + 5], kernels[n * 8 * 9 + 8 * i + 6], kernels[n * 8 * 9 + 8 * i + 7]);
            sum[n] += (dot(k0, r[i][0]) + dot(k1, r[i][1]));
        }
    }

    return ACTIVE(vec4(sum[0], sum[1], sum[2], sum[3]));
}

//!HOOK LUMA
//!DESC ACNet Layer2 L1
//!WHEN OUTPUT.w LUMA.w / 1.2 > OUTPUT.h LUMA.h / 1.2 > *
//!BIND TMP2_L0
//!BIND TMP2_L1
//!SAVE TMP1_L1
//!COMPONENTS 4

#define ACTIVE(v) (max(v, 0.0f))

#define TEX_BIND_L0_TEXOFF TMP2_L0_texOff
#define TEX_BIND_L0_TEX TMP2_L0_tex
#define TEX_BIND_L0_POS TMP2_L0_pos
#define TEX_BIND_L0_SIZE TMP2_L0_size
#define TEX_BIND_L0_PT TMP2_L0_pt

#define TEX_BIND_L1_TEXOFF TMP2_L1_texOff
#define TEX_BIND_L1_TEX TMP2_L1_tex
#define TEX_BIND_L1_POS TMP2_L1_pos
#define TEX_BIND_L1_SIZE TMP2_L1_size
#define TEX_BIND_L1_PT TMP2_L1_pt

const float kernels[288] = float[288](
  -0.1061690f, -0.0312196f, +0.0000014f, -0.1448453f, -0.0877124f, +0.1513908f, +0.0383430f, -0.0064678f,
  +0.1278156f, +0.0406148f, -0.0000169f, +0.1884067f, +0.0631759f, -0.1211596f, +0.1799240f, +0.2440131f,
  -0.0210529f, -0.1525053f, -0.0000847f, -0.1795429f, +0.1198348f, -0.3549742f, +0.3678952f, +0.1926640f,
  -0.1232862f, -0.2001747f, +0.0000196f, +0.2155113f, +0.1078973f, -0.0618890f, +0.3042565f, -0.1408856f,
  +0.1495158f, +0.2242083f, +0.0000030f, +0.2260103f, +0.0664183f, +0.3408843f, +0.1123468f, +0.1232320f,
  -0.0174661f, -0.0256821f, +0.0000030f, -0.0086689f, +0.0658495f, +0.1314842f, +0.4981481f, +0.0443402f,
  -0.1696926f, -0.0658734f, +0.0002077f, +0.0869259f, +0.1248333f, -0.1647830f, +0.2628997f, -0.0888557f,
  +0.0369797f, +0.1834638f, +0.0000147f, -0.0689892f, +0.1242791f, +0.0444773f, +0.1970304f, +0.0840360f,
  -0.0677319f, +0.0129815f, +0.0000030f, -0.1268337f, +0.0449944f, -0.1197873f, +0.1588110f, -0.0984876f,
  -0.0017377f, -0.0003038f, +0.0000000f, -0.0004046f, -0.0000000f, -0.0000000f, -0.0000000f, -0.0002947f,
  -0.0017654f, -0.0002930f, -0.0000000f, -0.0004326f, -0.0000000f, -0.0000000f, -0.0000000f, -0.0002908f,
  -0.0017223f, -0.0002484f, -0.0000000f, -0.0004162f, -0.0000000f, -0.0000000f, -0.0000000f, -0.0002596f,
  -0.0017651f, -0.0003296f, +0.0000000f, -0.0004227f, -0.0000000f, -0.0000000f, -0.0000000f, -0.0003229f,
  -0.0017919f, -0.0003168f, -0.0000000f, -0.0004512f, -0.0000000f, -0.0000000f, -0.0000000f, -0.0003181f,
  -0.0017491f, -0.0002701f, +0.0000000f, -0.0004341f, -0.0000000f, -0.0000000f, -0.0000000f, -0.0002846f,
  -0.0017172f, -0.0003167f, -0.0000000f, -0.0003945f, -0.0000000f, -0.0000000f, -0.0000000f, -0.0003179f,
  -0.0017446f, -0.0003049f, -0.0000000f, -0.0004220f, -0.0000000f, -0.0000000f, -0.0000000f, -0.0003136f,
  -0.0017041f, -0.0002612f, -0.0000000f, -0.0004065f, -0.0000000f, -0.0000000f, -0.0000000f, -0.0002812f,
  +0.0616232f, +0.0844339f, -0.0050985f, -0.0181855f, -0.0006268f, -0.1780712f, +0.0340050f, -0.0108504f,
  +0.1705725f, -0.0170686f, -0.0051407f, +0.0626801f, +0.0065026f, -0.0861956f, -0.0128327f, +0.0988754f,
  +0.0804776f, -0.0783180f, -0.0051687f, +0.0332354f, +0.0259478f, -0.0324084f, -0.1203844f, -0.0444392f,
  +0.1262381f, +0.0492438f, -0.0051185f, +0.0133984f, +0.0665417f, -0.0081946f, -0.0489497f, +0.0912193f,
  +0.1846805f, +0.0447823f, -0.0051511f, +0.1649654f, +0.1235238f, -0.0139572f, +0.0398571f, +0.0664002f,
  +0.0219009f, -0.0697466f, -0.0051712f, +0.0435229f, +0.0151549f, -0.1673333f, +0.0140484f, -0.0676931f,
  +0.0760334f, +0.1291512f, -0.0050986f, -0.0241007f, -0.0862368f, +0.0262688f, -0.0647584f, +0.0533179f,
  +0.1345481f, +0.1145300f, -0.0051272f, +0.1331649f, -0.0209074f, +0.1681659f, +0.0996033f, +0.0118377f,
  +0.0840367f, -0.0652435f, -0.0051409f, +0.0183733f, +0.0102373f, +0.0940290f, +0.1074819f, -0.1516416f,
  -0.0585684f, -0.1034253f, +0.0000241f, -0.1447106f, -0.2696592f, +0.0953048f, -0.1220329f, -0.1696230f,
  +0.1124941f, -0.0330248f, -0.0000118f, +0.0201115f, +0.1175082f, -0.0405511f, -0.0725669f, +0.1090463f,
  -0.0382864f, +0.0371863f, -0.0001418f, -0.1244919f, +0.0970722f, -0.1093587f, -0.2999970f, +0.1155743f,
  -0.0711223f, -0.0020769f, +0.0000352f, +0.0533684f, -0.1992871f, +0.0526873f, -0.0343562f, -0.1440507f,
  +0.0957985f, +0.1355758f, -0.0000064f, +0.3291846f, +0.0979863f, +0.4533997f, -0.1347123f, +0.0891914f,
  +0.0385215f, -0.1300930f, -0.0001224f, +0.1403371f, -0.0512405f, +0.2353088f, -0.0909955f, +0.1171506f,
  -0.1384591f, +0.0101668f, +0.0000855f, -0.1183269f, -0.0950730f, -0.0133854f, -0.2522977f, -0.1323741f,
  +0.1416715f, +0.0153582f, +0.0000022f, -0.0192245f, -0.0680695f, +0.1592158f, -0.2484633f, +0.0520922f,
  -0.0035500f, -0.0980089f, -0.0000533f, -0.1265839f, -0.2131794f, -0.1837139f, -0.1852882f, -0.1222687f
);

const float biases[4] = float[4](
  -0.0316066f, -0.0016496f, -0.0031892f, -0.0554371f
);

vec4 hook() {
    const vec4 r[9][2] = vec4[9][2](
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 1.0f)))
    );

    float sum[4] = biases;
    for (int n = 0; n < 4; n++) {
        for (int i = 0; i < 9; i++) {
            const vec4 k0 = vec4(kernels[n * 8 * 9 + 8 * i + 0], kernels[n * 8 * 9 + 8 * i + 1], kernels[n * 8 * 9 + 8 * i + 2], kernels[n * 8 * 9 + 8 * i + 3]);
            const vec4 k1 = vec4(kernels[n * 8 * 9 + 8 * i + 4], kernels[n * 8 * 9 + 8 * i + 5], kernels[n * 8 * 9 + 8 * i + 6], kernels[n * 8 * 9 + 8 * i + 7]);
            sum[n] += (dot(k0, r[i][0]) + dot(k1, r[i][1]));
        }
    }

    return ACTIVE(vec4(sum[0], sum[1], sum[2], sum[3]));
}

//!HOOK LUMA
//!DESC ACNet Layer3 L0
//!WHEN OUTPUT.w LUMA.w / 1.2 > OUTPUT.h LUMA.h / 1.2 > *
//!BIND TMP1_L0
//!BIND TMP1_L1
//!SAVE TMP2_L0
//!COMPONENTS 4

#define ACTIVE(v) (max(v, 0.0f))

#define TEX_BIND_L0_TEXOFF TMP1_L0_texOff
#define TEX_BIND_L0_TEX TMP1_L0_tex
#define TEX_BIND_L0_POS TMP1_L0_pos
#define TEX_BIND_L0_SIZE TMP1_L0_size
#define TEX_BIND_L0_PT TMP1_L0_pt

#define TEX_BIND_L1_TEXOFF TMP1_L1_texOff
#define TEX_BIND_L1_TEX TMP1_L1_tex
#define TEX_BIND_L1_POS TMP1_L1_pos
#define TEX_BIND_L1_SIZE TMP1_L1_size
#define TEX_BIND_L1_PT TMP1_L1_pt

const float kernels[288] = float[288](
  +0.2001337f, -0.2925380f, +0.0280082f, +0.2300356f, -0.2467436f, -0.0000000f, -0.1495681f, -0.0024402f,
  +0.2210503f, -0.0768150f, +0.3162549f, +0.0418343f, -0.1548280f, +0.0000000f, -0.0190875f, +0.1509664f,
  +0.1919646f, +0.0588119f, +0.0328771f, -0.0577902f, +0.0326535f, -0.0000000f, +0.0711705f, +0.0639576f,
  +0.0681584f, -0.0464664f, -0.0588354f, -0.2286103f, -0.2157383f, +0.0000000f, -0.1443548f, -0.1763023f,
  +0.1715431f, +0.0139413f, -0.1730490f, +0.2931360f, +0.3108319f, +0.0000000f, +0.0895601f, +0.3600886f,
  -0.0866768f, +0.2335312f, -0.0615579f, +0.1688450f, -0.0014025f, +0.0000000f, +0.1387919f, -0.2038333f,
  +0.0926522f, -0.1503262f, -0.1222719f, -0.0280091f, +0.0173536f, +0.0000000f, -0.0369917f, -0.0085106f,
  +0.1078909f, +0.0751670f, +0.0399310f, +0.0475503f, +0.0564174f, -0.0000000f, +0.0598225f, +0.0040863f,
  +0.1674507f, +0.1443338f, +0.0302996f, -0.0445417f, +0.1084437f, -0.0000000f, +0.0192412f, -0.0275754f,
  +0.0789419f, -0.0329281f, +0.0274776f, -0.1933009f, -0.0249055f, -0.0000000f, +0.0150250f, +0.0332969f,
  -0.1864038f, -0.0305828f, +0.1776795f, +0.0392379f, -0.1123460f, +0.0000000f, +0.0744185f, -0.0773737f,
  -0.0677153f, +0.0920610f, +0.2594514f, -0.0469440f, +0.0138225f, -0.0000000f, +0.0956515f, -0.1111416f,
  +0.0727774f, +0.1249329f, -0.3466182f, -0.1566785f, -0.0399884f, +0.0000000f, +0.0502974f, -0.0755863f,
  -0.1380361f, +0.1039956f, +0.0020330f, -0.0571041f, -0.0091882f, +0.0000000f, +0.0667042f, -0.0193382f,
  -0.0703320f, +0.1377952f, +0.0881177f, +0.1955787f, +0.0192036f, +0.0000000f, +0.0573155f, -0.0137392f,
  +0.1518513f, +0.1443832f, -0.2962780f, +0.0653050f, +0.1050412f, -0.0000000f, +0.0251015f, +0.0456159f,
  -0.0435296f, +0.0820505f, -0.1321181f, +0.0599327f, +0.0046820f, -0.0000000f, +0.1198506f, -0.0649455f,
  +0.1450184f, +0.0161590f, -0.0181445f, +0.0773371f, -0.0218360f, -0.0000000f, +0.0260433f, -0.0693724f,
  -0.0075874f, +0.1218359f, +0.1385742f, +0.0269274f, +0.0384337f, -0.0000000f, -0.0306921f, -0.0191291f,
  -0.1114148f, +0.1938639f, +0.2333807f, -0.2130423f, +0.1719761f, -0.0000000f, +0.1856887f, -0.0015663f,
  -0.0291348f, +0.1799476f, +0.2541040f, -0.1476227f, -0.0181221f, +0.0000000f, +0.2032687f, +0.0498952f,
  -0.0069436f, -0.0274515f, +0.2300154f, -0.0569979f, -0.1385732f, +0.0000000f, -0.0747563f, -0.0194409f,
  -0.0144177f, +0.0997365f, +0.1955073f, +0.2906365f, +0.1941773f, -0.0000000f, -0.0517652f, +0.0932369f,
  +0.0016436f, +0.1001985f, +0.1445189f, +0.1808452f, +0.1501903f, +0.0000000f, +0.0424745f, +0.1290986f,
  -0.1305087f, -0.0632903f, +0.4704023f, +0.0893926f, -0.0563370f, +0.0000000f, -0.0906746f, -0.0239187f,
  -0.1332359f, -0.0214470f, +0.2264655f, -0.1746331f, -0.5326532f, +0.0000000f, -0.3043779f, -0.4053892f,
  -0.0939339f, -0.1700505f, +0.1521515f, -0.2709464f, +0.3212233f, -0.0000000f, -0.3508821f, +0.0281672f,
  +0.2020347f, -0.0402759f, -0.1228179f, +0.1316448f, -0.0268157f, +0.0000000f, -0.0596921f, +0.0375826f,
  +0.0334237f, -0.0067792f, -0.0365627f, +0.4129387f, -0.0397671f, +0.0000000f, -0.0280473f, -0.0365976f,
  +0.0179268f, +0.0336985f, +0.0419756f, +0.1889698f, +0.1406106f, +0.0000000f, +0.0237952f, +0.1020604f,
  +0.0419225f, -0.0067044f, -0.0099622f, +0.2199128f, -0.1360294f, -0.0000000f, -0.0352843f, -0.0962292f,
  -0.1696693f, +0.0176855f, +0.0889807f, +0.0162470f, -0.2064942f, -0.0000000f, +0.0114483f, -0.1597687f,
  +0.0256558f, +0.0297855f, +0.0213636f, +0.1156942f, +0.0758365f, +0.0000000f, +0.0005030f, +0.0491565f,
  -0.1586915f, -0.0156229f, -0.0856680f, -0.0301424f, -0.0169836f, +0.0000000f, -0.0350658f, +0.0372931f,
  -0.1872712f, +0.0379040f, -0.1680283f, +0.0140688f, -0.0083800f, +0.0000000f, +0.0461849f, +0.0587662f,
  +0.0027860f, +0.0247365f, -0.0449740f, +0.0366455f, +0.0002365f, -0.0000000f, +0.0121674f, +0.0104479f
);

const float biases[4] = float[4](
  -0.0507861f, -0.0608809f, +0.0346931f, -0.0802134f
);

vec4 hook() {
    const vec4 r[9][2] = vec4[9][2](
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 1.0f)))
    );

    float sum[4] = biases;
    for (int n = 0; n < 4; n++) {
        for (int i = 0; i < 9; i++) {
            const vec4 k0 = vec4(kernels[n * 8 * 9 + 8 * i + 0], kernels[n * 8 * 9 + 8 * i + 1], kernels[n * 8 * 9 + 8 * i + 2], kernels[n * 8 * 9 + 8 * i + 3]);
            const vec4 k1 = vec4(kernels[n * 8 * 9 + 8 * i + 4], kernels[n * 8 * 9 + 8 * i + 5], kernels[n * 8 * 9 + 8 * i + 6], kernels[n * 8 * 9 + 8 * i + 7]);
            sum[n] += (dot(k0, r[i][0]) + dot(k1, r[i][1]));
        }
    }

    return ACTIVE(vec4(sum[0], sum[1], sum[2], sum[3]));
}

//!HOOK LUMA
//!DESC ACNet Layer3 L1
//!WHEN OUTPUT.w LUMA.w / 1.2 > OUTPUT.h LUMA.h / 1.2 > *
//!BIND TMP1_L0
//!BIND TMP1_L1
//!SAVE TMP2_L1
//!COMPONENTS 4

#define ACTIVE(v) (max(v, 0.0f))

#define TEX_BIND_L0_TEXOFF TMP1_L0_texOff
#define TEX_BIND_L0_TEX TMP1_L0_tex
#define TEX_BIND_L0_POS TMP1_L0_pos
#define TEX_BIND_L0_SIZE TMP1_L0_size
#define TEX_BIND_L0_PT TMP1_L0_pt

#define TEX_BIND_L1_TEXOFF TMP1_L1_texOff
#define TEX_BIND_L1_TEX TMP1_L1_tex
#define TEX_BIND_L1_POS TMP1_L1_pos
#define TEX_BIND_L1_SIZE TMP1_L1_size
#define TEX_BIND_L1_PT TMP1_L1_pt

const float kernels[288] = float[288](
  +0.1148991f, +0.0738160f, +0.0594228f, -0.6356714f, +0.1598228f, -0.0000000f, +0.0554229f, -0.1549042f,
  +0.1445948f, +0.0737938f, +0.1900875f, +0.2009818f, +0.1092341f, +0.0000000f, +0.0398428f, +0.1745746f,
  +0.0869355f, +0.0080970f, -0.2373528f, +0.1065259f, +0.2156580f, +0.0000000f, -0.1750933f, +0.2783208f,
  +0.2860864f, +0.0283067f, -0.2666983f, -0.2505558f, +0.2023932f, +0.0000000f, +0.0544799f, +0.1148213f,
  -0.0481084f, +0.0036635f, +0.5878932f, +0.6506523f, -0.0902215f, -0.0000000f, +0.0503313f, +0.2575877f,
  +0.0900226f, -0.1176914f, -0.2004783f, -0.4047105f, -0.4460601f, -0.0000000f, -0.1679345f, -0.2419862f,
  +0.0679411f, +0.0413739f, -0.3708159f, +0.0547153f, +0.1054980f, +0.0000000f, +0.0660933f, -0.0938909f,
  -0.0057148f, +0.0399327f, +0.1804508f, +0.2437463f, +0.0546664f, +0.0000000f, +0.0301628f, +0.0919213f,
  +0.1002107f, -0.0442915f, +0.0548200f, -0.2740184f, -0.2713403f, +0.0000000f, -0.0820227f, -0.0064480f,
  +0.1926589f, -0.1048296f, -0.0850213f, +0.1146825f, -0.0693036f, -0.0000000f, -0.1670188f, +0.0029938f,
  +0.0529071f, -0.0771344f, -0.0010621f, +0.1954394f, +0.1118397f, +0.0000000f, -0.2665373f, +0.1137827f,
  +0.0702894f, -0.0362044f, +0.0558506f, +0.0666375f, -0.0370145f, -0.0000000f, +0.0087902f, +0.0715979f,
  +0.1358214f, +0.0175902f, +0.2466606f, +0.0634302f, -0.1763426f, -0.0000000f, -0.2010759f, -0.1603094f,
  +0.0642462f, +0.0508436f, +0.0656520f, +0.2054177f, +0.1247474f, +0.0000000f, -0.3809296f, +0.1347532f,
  +0.1498870f, +0.1423387f, -0.0181803f, +0.0708756f, +0.0919466f, +0.0000000f, -0.0836997f, +0.1579973f,
  +0.0062013f, +0.0729134f, +0.1522522f, +0.0347790f, -0.0605497f, -0.0000000f, -0.0754326f, -0.0720188f,
  -0.0688842f, +0.0607264f, +0.1292801f, +0.0100370f, -0.1390401f, -0.0000000f, -0.2068899f, -0.1166326f,
  +0.0687343f, +0.0644141f, +0.0031578f, -0.0221343f, +0.0751919f, +0.0000000f, +0.0279507f, +0.0806925f,
  +0.1061036f, -0.0610855f, +0.1935023f, -0.1782870f, -0.0875428f, +0.0000000f, -0.0139854f, +0.0415311f,
  +0.0111629f, -0.0708507f, -0.0184582f, +0.0057083f, -0.1298161f, +0.0000000f, -0.1054978f, -0.1513906f,
  -0.1495879f, +0.0768506f, -0.0230399f, -0.0061680f, +0.1938584f, +0.0000000f, +0.0587722f, -0.1777282f,
  -0.1157554f, -0.0275951f, +0.0634768f, -0.1125567f, -0.0057157f, -0.0000000f, -0.0171081f, +0.0965483f,
  -0.0856454f, -0.0608900f, +0.1192327f, -0.0279513f, -0.1010790f, +0.0000000f, -0.0736441f, -0.1191427f,
  +0.0404143f, +0.0474718f, +0.0993190f, -0.2154365f, +0.1446728f, -0.0000000f, +0.0330141f, -0.0465357f,
  +0.0562452f, +0.0071059f, +0.0648389f, -0.0216136f, -0.0657418f, +0.0000000f, -0.0018224f, +0.0867537f,
  +0.1705606f, +0.0000609f, +0.2797326f, -0.0714679f, -0.0720537f, +0.0000000f, +0.0028931f, -0.0040057f,
  +0.2573434f, +0.0749155f, +0.1290224f, -0.0220536f, +0.1792409f, -0.0000000f, +0.0927618f, +0.1898278f,
  +0.1654512f, -0.0329431f, +0.1142046f, +0.1025853f, -0.0129551f, -0.0000000f, -0.1128429f, -0.2527641f,
  -0.0473115f, -0.0707698f, -0.0744560f, -0.0189175f, -0.1932945f, +0.0000000f, -0.0841715f, -0.1701754f,
  -0.0072455f, -0.1470016f, -0.0387630f, +0.0065902f, +0.0052074f, -0.0000000f, -0.1593538f, +0.0979007f,
  +0.3756714f, +0.0170435f, +0.1680737f, +0.0124210f, +0.0594456f, +0.0000000f, -0.0322994f, +0.1421794f,
  +0.1888253f, +0.0943306f, +0.0093636f, -0.0789600f, +0.1883185f, -0.0000000f, +0.1542664f, +0.3123607f,
  -0.0743251f, +0.0042857f, -0.1179582f, +0.0217663f, +0.2209406f, +0.0000000f, +0.0890286f, +0.2963613f,
  -0.0582524f, +0.0041247f, +0.1770308f, +0.1306213f, -0.1095446f, +0.0000000f, -0.0388153f, -0.0236132f,
  -0.0138110f, +0.1668962f, +0.0011386f, +0.0460012f, -0.0818668f, -0.0000000f, +0.1309844f, -0.0552580f,
  -0.0704699f, +0.0421462f, -0.0687074f, +0.2419939f, -0.0433237f, +0.0000000f, -0.0430650f, -0.2055045f
);

const float biases[4] = float[4](
  -0.0437770f, +0.2511877f, -0.0490860f, -0.0258796f
);

vec4 hook() {
    const vec4 r[9][2] = vec4[9][2](
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 1.0f)))
    );

    float sum[4] = biases;
    for (int n = 0; n < 4; n++) {
        for (int i = 0; i < 9; i++) {
            const vec4 k0 = vec4(kernels[n * 8 * 9 + 8 * i + 0], kernels[n * 8 * 9 + 8 * i + 1], kernels[n * 8 * 9 + 8 * i + 2], kernels[n * 8 * 9 + 8 * i + 3]);
            const vec4 k1 = vec4(kernels[n * 8 * 9 + 8 * i + 4], kernels[n * 8 * 9 + 8 * i + 5], kernels[n * 8 * 9 + 8 * i + 6], kernels[n * 8 * 9 + 8 * i + 7]);
            sum[n] += (dot(k0, r[i][0]) + dot(k1, r[i][1]));
        }
    }

    return ACTIVE(vec4(sum[0], sum[1], sum[2], sum[3]));
}

//!HOOK LUMA
//!DESC ACNet Layer4 L0
//!WHEN OUTPUT.w LUMA.w / 1.2 > OUTPUT.h LUMA.h / 1.2 > *
//!BIND TMP2_L0
//!BIND TMP2_L1
//!SAVE TMP1_L0
//!COMPONENTS 4

#define ACTIVE(v) (max(v, 0.0f))

#define TEX_BIND_L0_TEXOFF TMP2_L0_texOff
#define TEX_BIND_L0_TEX TMP2_L0_tex
#define TEX_BIND_L0_POS TMP2_L0_pos
#define TEX_BIND_L0_SIZE TMP2_L0_size
#define TEX_BIND_L0_PT TMP2_L0_pt

#define TEX_BIND_L1_TEXOFF TMP2_L1_texOff
#define TEX_BIND_L1_TEX TMP2_L1_tex
#define TEX_BIND_L1_POS TMP2_L1_pos
#define TEX_BIND_L1_SIZE TMP2_L1_size
#define TEX_BIND_L1_PT TMP2_L1_pt

const float kernels[288] = float[288](
  +0.0332512f, +0.0953821f, -0.0558033f, +0.0506744f, -0.0549363f, +0.0353900f, -0.0281222f, -0.1387003f,
  +0.1144757f, -0.0498937f, -0.1361662f, +0.1403939f, -0.1021705f, -0.0665926f, -0.1993149f, +0.1090909f,
  -0.0922465f, +0.0823551f, +0.0015111f, -0.0241307f, -0.0515011f, -0.2105477f, -0.0154218f, -0.1212406f,
  +0.1184658f, +0.1059220f, +0.1276854f, +0.0520105f, -0.0162989f, -0.0949765f, +0.0795763f, +0.1555639f,
  +0.4532943f, +0.0172937f, +0.1019988f, +0.1239081f, -0.1167302f, +0.1578470f, +0.0502909f, +0.3573092f,
  -0.2015087f, -0.0586280f, -0.1368977f, +0.0633269f, -0.0441584f, -0.0920344f, +0.0954456f, +0.0975632f,
  -0.0774433f, -0.0666097f, +0.0019626f, -0.0267627f, +0.0858284f, -0.1303129f, +0.0540416f, -0.0586837f,
  +0.1759263f, -0.0286521f, -0.0102517f, +0.0335105f, -0.0804440f, +0.0298580f, +0.0212018f, -0.2070488f,
  -0.0496390f, -0.0651634f, -0.0803903f, +0.0882987f, -0.0014018f, -0.0195122f, +0.0388575f, +0.2066552f,
  +0.0138133f, +0.1482465f, +0.0957386f, +0.0008246f, +0.2237016f, -0.0307453f, -0.0101118f, -0.0008482f,
  +0.0050829f, +0.0656904f, +0.0117442f, -0.0267334f, +0.0323696f, +0.0134091f, -0.0097075f, +0.0722348f,
  -0.1007976f, +0.0480050f, -0.1009587f, +0.0088846f, +0.0192172f, -0.0747087f, -0.0144170f, -0.0703837f,
  +0.2877173f, +0.1589600f, +0.1790414f, +0.0643825f, -0.0081798f, +0.0776075f, -0.0022052f, +0.0053454f,
  +0.1078600f, -0.0008919f, -0.0200482f, +0.0647155f, -0.0344591f, -0.1484840f, -0.0082562f, +0.0767169f,
  -0.0681056f, +0.1402433f, -0.0764799f, +0.0396556f, +0.0293588f, +0.0134799f, +0.0277114f, +0.0368302f,
  +0.0953421f, +0.0699678f, +0.0796582f, +0.0463382f, +0.0719324f, +0.0964615f, +0.0136313f, -0.0188624f,
  -0.0739481f, +0.0434571f, +0.1455099f, -0.0115806f, -0.0185019f, -0.0665153f, -0.0076000f, -0.1353606f,
  -0.2348709f, +0.1190159f, -0.0340150f, -0.0771148f, +0.1007904f, -0.1263243f, +0.0314139f, +0.0231134f,
  -0.1415523f, -0.0095615f, -0.0738988f, +0.2034589f, -0.1174238f, +0.0194750f, -0.0021932f, +0.0285563f,
  +0.1945458f, +0.0871332f, -0.2749138f, -0.0137580f, -0.1252129f, +0.0050164f, -0.0529116f, +0.0952089f,
  -0.1755809f, +0.0698750f, -0.2320277f, +0.0332354f, +0.1969354f, +0.0299819f, +0.1604486f, +0.1082185f,
  +0.2058149f, -0.0092289f, +0.1487732f, +0.0282490f, -0.1101432f, -0.0507969f, +0.0756485f, +0.0723735f,
  +0.0400841f, +0.0423231f, -0.2697516f, -0.2247242f, -0.2949627f, -0.0315726f, -0.2014961f, -0.0445550f,
  -0.1348312f, +0.0994551f, -0.1977225f, -0.0944719f, -0.2164354f, -0.0194378f, -0.2116858f, -0.1155827f,
  -0.0944633f, -0.0913837f, +0.1444935f, -0.0613680f, -0.0347867f, +0.0199360f, -0.0837365f, +0.0545458f,
  -0.2530020f, -0.0569563f, -0.1655286f, -0.2483807f, -0.0890638f, +0.0345036f, -0.1269671f, +0.0443810f,
  -0.3082110f, -0.0717603f, -0.0758320f, -0.0594734f, +0.1250383f, +0.0444400f, +0.1330257f, -0.0291232f,
  +0.0759470f, -0.0757009f, +0.2132158f, -0.0245781f, +0.2303899f, +0.1093550f, +0.0707536f, -0.0267691f,
  +0.1109712f, -0.0527353f, -0.3449489f, +0.1246667f, +0.2431466f, -0.0329483f, -0.1003069f, +0.0115722f,
  +0.0943512f, -0.1577880f, +0.0936257f, +0.0403220f, -0.0516931f, +0.0530260f, -0.1113245f, -0.1161487f,
  +0.1615423f, +0.0123491f, +0.2491185f, +0.0513089f, -0.1548019f, -0.0579589f, -0.0731739f, +0.0787346f,
  +0.4302476f, -0.0426760f, +0.0278698f, -0.0540609f, -0.0400875f, +0.1498834f, -0.1198873f, +0.3925400f,
  -0.1059643f, +0.1504083f, -0.0883826f, -0.1141149f, +0.2032487f, -0.0806161f, +0.0060364f, -0.0818972f,
  +0.0417589f, +0.0694008f, -0.0447464f, +0.0712252f, -0.0086674f, -0.0086151f, -0.0534066f, -0.0040849f,
  -0.0280899f, +0.0689912f, +0.1588629f, -0.1174066f, -0.1676029f, -0.1399779f, -0.0011125f, -0.0892138f,
  -0.1378191f, +0.0202860f, -0.0053912f, -0.0051460f, -0.0600465f, -0.0635817f, +0.0965289f, -0.2063070f
);

const float biases[4] = float[4](
  +0.0654580f, +0.0254565f, +0.0228204f, -0.0026888f
);

vec4 hook() {
    const vec4 r[9][2] = vec4[9][2](
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 1.0f)))
    );

    float sum[4] = biases;
    for (int n = 0; n < 4; n++) {
        for (int i = 0; i < 9; i++) {
            const vec4 k0 = vec4(kernels[n * 8 * 9 + 8 * i + 0], kernels[n * 8 * 9 + 8 * i + 1], kernels[n * 8 * 9 + 8 * i + 2], kernels[n * 8 * 9 + 8 * i + 3]);
            const vec4 k1 = vec4(kernels[n * 8 * 9 + 8 * i + 4], kernels[n * 8 * 9 + 8 * i + 5], kernels[n * 8 * 9 + 8 * i + 6], kernels[n * 8 * 9 + 8 * i + 7]);
            sum[n] += (dot(k0, r[i][0]) + dot(k1, r[i][1]));
        }
    }

    return ACTIVE(vec4(sum[0], sum[1], sum[2], sum[3]));
}

//!HOOK LUMA
//!DESC ACNet Layer4 L1
//!WHEN OUTPUT.w LUMA.w / 1.2 > OUTPUT.h LUMA.h / 1.2 > *
//!BIND TMP2_L0
//!BIND TMP2_L1
//!SAVE TMP1_L1
//!COMPONENTS 4

#define ACTIVE(v) (max(v, 0.0f))

#define TEX_BIND_L0_TEXOFF TMP2_L0_texOff
#define TEX_BIND_L0_TEX TMP2_L0_tex
#define TEX_BIND_L0_POS TMP2_L0_pos
#define TEX_BIND_L0_SIZE TMP2_L0_size
#define TEX_BIND_L0_PT TMP2_L0_pt

#define TEX_BIND_L1_TEXOFF TMP2_L1_texOff
#define TEX_BIND_L1_TEX TMP2_L1_tex
#define TEX_BIND_L1_POS TMP2_L1_pos
#define TEX_BIND_L1_SIZE TMP2_L1_size
#define TEX_BIND_L1_PT TMP2_L1_pt

const float kernels[288] = float[288](
  -0.1295718f, +0.0980431f, +0.0262490f, +0.1454407f, +0.2003036f, +0.0164266f, -0.0517612f, +0.1039484f,
  +0.0923914f, +0.0016184f, -0.0076858f, -0.1278205f, +0.3295888f, +0.0791404f, -0.1403934f, +0.1981989f,
  -0.0079170f, -0.1460722f, +0.0458874f, -0.0085267f, +0.0152874f, +0.1076857f, -0.1778100f, -0.0271576f,
  +0.5625070f, +0.1575749f, +0.2717905f, +0.1674312f, -0.0153730f, -0.0893403f, -0.0170111f, +0.0281693f,
  +0.4013030f, +0.0304823f, +0.0753990f, -0.0834322f, +0.5549614f, +0.1230887f, +0.1395394f, -0.1199423f,
  +0.1644969f, -0.1449956f, +0.2404132f, +0.1992781f, -0.0945322f, +0.0472617f, -0.0234014f, -0.2621633f,
  -0.0137092f, +0.1503492f, +0.1380916f, +0.0874422f, +0.0489190f, -0.0319170f, +0.0128231f, -0.0449328f,
  -0.1935424f, -0.0303470f, -0.1499249f, -0.0597796f, +0.0414555f, +0.1443606f, -0.0112411f, +0.0238897f,
  +0.2714396f, -0.1402671f, +0.0016422f, -0.0187561f, -0.0940478f, +0.1690285f, -0.0472037f, -0.1030427f,
  -0.0839536f, +0.0500166f, +0.1971986f, +0.0174831f, -0.2595719f, -0.0750874f, +0.2079008f, +0.0504630f,
  -0.1044040f, +0.1755683f, -0.3158488f, +0.0597832f, -0.1996686f, -0.2387950f, -0.1202055f, +0.1219927f,
  -0.0646107f, +0.0491239f, -0.0500081f, +0.0344820f, +0.0195233f, -0.0671509f, +0.0706718f, +0.0352298f,
  +0.0587765f, -0.1112772f, +0.1931897f, -0.0666724f, +0.0331960f, +0.0089676f, +0.0497699f, -0.0673716f,
  +0.1937020f, -0.0079337f, +0.3176928f, -0.1077898f, +0.4098390f, +0.0891320f, -0.1237398f, -0.1158900f,
  -0.2493705f, +0.0854499f, -0.0018003f, +0.0383531f, +0.1380682f, -0.0362386f, -0.0665395f, +0.0724110f,
  +0.0179939f, -0.1492507f, -0.0515878f, +0.0896766f, +0.1984754f, +0.1391829f, -0.0398085f, -0.0331225f,
  +0.0746801f, -0.0558946f, -0.1144422f, +0.2198327f, -0.0668962f, -0.0518027f, -0.1557233f, -0.1750602f,
  +0.1529865f, -0.0373056f, +0.0686133f, -0.0531144f, -0.1274734f, +0.2039455f, -0.0927734f, +0.0766024f,
  +0.0992214f, +0.0597700f, +0.2330820f, -0.1122546f, +0.1086457f, +0.0216630f, -0.0570114f, +0.0103276f,
  -0.0763051f, +0.0352601f, -0.1929334f, -0.0068955f, +0.1351078f, -0.0547558f, +0.1060211f, -0.0465838f,
  +0.0090267f, -0.1609791f, +0.0683865f, -0.0850989f, -0.0850753f, +0.0078415f, +0.1813982f, -0.0894847f,
  -0.1223490f, +0.0165071f, -0.0506503f, -0.0377166f, +0.0466393f, -0.0608824f, -0.2015430f, +0.0157738f,
  +0.2620532f, +0.0834661f, +0.1475870f, -0.0917428f, +0.2749749f, +0.1028774f, -0.1301238f, -0.0593973f,
  -0.2028657f, +0.0704061f, -0.0886321f, -0.0628824f, +0.0184895f, -0.1641366f, +0.1081999f, -0.1385702f,
  +0.0508943f, -0.0079478f, -0.0274768f, -0.0420305f, -0.0208418f, +0.1391617f, +0.2452499f, -0.0073100f,
  -0.0278916f, -0.0982405f, +0.1658131f, +0.0506286f, +0.2089916f, +0.0114771f, -0.1815182f, -0.0718731f,
  -0.1060519f, +0.0187500f, +0.0696724f, +0.1110825f, +0.0270888f, +0.0316894f, -0.0045577f, -0.0715508f,
  +0.1307896f, -0.0040811f, +0.0114772f, +0.1122646f, -0.0126908f, +0.0496083f, -0.1088115f, -0.0820592f,
  -0.0206169f, +0.0372848f, -0.1778104f, -0.0042732f, +0.1198160f, +0.2833810f, -0.1145902f, +0.0247038f,
  +0.0510878f, +0.0262174f, -0.0394885f, +0.0716486f, -0.0339228f, +0.0422554f, -0.1218722f, -0.1064737f,
  -0.0436645f, +0.0078261f, +0.1673430f, -0.0894150f, -0.0282755f, +0.1125931f, +0.1359923f, +0.1152603f,
  -0.0762749f, -0.0249176f, -0.0036177f, -0.1609393f, +0.1354020f, +0.3961543f, +0.1523708f, +0.2085440f,
  +0.0287389f, -0.0284387f, +0.2333655f, +0.0334003f, +0.1637195f, +0.1660331f, +0.0497750f, +0.0618027f,
  +0.0493401f, +0.0598005f, +0.0706297f, -0.0046215f, -0.1695598f, -0.0750145f, -0.1151098f, -0.0383046f,
  -0.1239460f, -0.0204947f, -0.0694249f, -0.2005621f, +0.0186636f, +0.1955484f, +0.0219147f, +0.0526576f,
  +0.0218573f, -0.0276228f, +0.0176897f, -0.0976856f, -0.2621059f, +0.0590431f, -0.0062770f, -0.2067294f
);

const float biases[4] = float[4](
  -0.0155498f, -0.0163407f, -0.0174200f, -0.1095136f
);

vec4 hook() {
    const vec4 r[9][2] = vec4[9][2](
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 1.0f)))
    );

    float sum[4] = biases;
    for (int n = 0; n < 4; n++) {
        for (int i = 0; i < 9; i++) {
            const vec4 k0 = vec4(kernels[n * 8 * 9 + 8 * i + 0], kernels[n * 8 * 9 + 8 * i + 1], kernels[n * 8 * 9 + 8 * i + 2], kernels[n * 8 * 9 + 8 * i + 3]);
            const vec4 k1 = vec4(kernels[n * 8 * 9 + 8 * i + 4], kernels[n * 8 * 9 + 8 * i + 5], kernels[n * 8 * 9 + 8 * i + 6], kernels[n * 8 * 9 + 8 * i + 7]);
            sum[n] += (dot(k0, r[i][0]) + dot(k1, r[i][1]));
        }
    }

    return ACTIVE(vec4(sum[0], sum[1], sum[2], sum[3]));
}

//!HOOK LUMA
//!DESC ACNet Layer5 L0
//!WHEN OUTPUT.w LUMA.w / 1.2 > OUTPUT.h LUMA.h / 1.2 > *
//!BIND TMP1_L0
//!BIND TMP1_L1
//!SAVE TMP2_L0
//!COMPONENTS 4

#define ACTIVE(v) (max(v, 0.0f))

#define TEX_BIND_L0_TEXOFF TMP1_L0_texOff
#define TEX_BIND_L0_TEX TMP1_L0_tex
#define TEX_BIND_L0_POS TMP1_L0_pos
#define TEX_BIND_L0_SIZE TMP1_L0_size
#define TEX_BIND_L0_PT TMP1_L0_pt

#define TEX_BIND_L1_TEXOFF TMP1_L1_texOff
#define TEX_BIND_L1_TEX TMP1_L1_tex
#define TEX_BIND_L1_POS TMP1_L1_pos
#define TEX_BIND_L1_SIZE TMP1_L1_size
#define TEX_BIND_L1_PT TMP1_L1_pt

const float kernels[288] = float[288](
  +0.1801380f, -0.0356793f, -0.0456863f, -0.0070394f, +0.0442964f, +0.1457463f, -0.0675333f, -0.0545566f,
  +0.2190831f, +0.0096072f, -0.0367326f, -0.1238672f, +0.0385719f, -0.0577706f, +0.0112894f, -0.0445986f,
  -0.0021088f, +0.0407209f, -0.0488734f, -0.0892434f, +0.0437536f, +0.0276194f, +0.0713157f, +0.0418345f,
  +0.1734518f, -0.0187711f, +0.0407519f, -0.1831217f, +0.1753760f, +0.0227571f, -0.0768469f, +0.0579637f,
  +0.2765357f, -0.0002348f, +0.0216147f, -0.1386776f, +0.0532838f, -0.4890961f, +0.0681285f, -0.0021246f,
  +0.0136067f, -0.0102303f, -0.0148222f, -0.0626184f, -0.0075663f, -0.2620052f, +0.0747169f, +0.1500718f,
  +0.1136262f, +0.0169651f, +0.1168931f, -0.0816272f, +0.1967024f, +0.0365129f, +0.1126929f, +0.1843192f,
  +0.0991050f, -0.0130320f, +0.0301527f, -0.2047973f, -0.1239690f, -0.2070371f, +0.0299778f, +0.1146275f,
  -0.0657300f, -0.0639061f, -0.0005016f, -0.3073965f, -0.1626649f, -0.1322523f, +0.0321320f, +0.2269141f,
  +0.0961661f, +0.1158837f, +0.1505947f, +0.0143611f, -0.1290633f, -0.0478021f, -0.0177536f, -0.0104063f,
  +0.0478873f, +0.1453992f, +0.0675933f, +0.1105896f, -0.0769723f, -0.1588878f, -0.0564426f, +0.0483131f,
  -0.0383990f, +0.1194784f, -0.0045843f, -0.0497204f, -0.0065449f, -0.1269285f, -0.0098661f, +0.0247172f,
  +0.0581534f, +0.1035984f, +0.0870314f, +0.0442704f, -0.1926928f, +0.0747172f, +0.0630401f, -0.0528509f,
  -0.0202555f, +0.0590832f, -0.0020926f, +0.0399953f, +0.2834948f, +0.2865457f, +0.0202493f, +0.0684960f,
  -0.1136224f, +0.1926292f, -0.0630558f, +0.0043101f, +0.1157343f, -0.0726365f, -0.0353683f, -0.0259328f,
  +0.0264023f, +0.1695279f, -0.0669602f, -0.1104235f, -0.1798293f, +0.0158372f, +0.0097756f, +0.0459324f,
  +0.0255624f, +0.0273904f, -0.0520559f, +0.0450284f, +0.0976148f, +0.0871254f, +0.0267600f, +0.0598923f,
  +0.0190960f, +0.0978829f, -0.0735701f, -0.0891238f, +0.0094003f, -0.1219791f, -0.0551722f, +0.0192002f,
  -0.0000000f, -0.0000000f, -0.0000000f, -0.0000000f, +0.0000000f, -0.0000000f, -0.0000000f, -0.0000000f,
  -0.0000000f, -0.0000000f, +0.0000000f, -0.0000000f, +0.0000000f, +0.0000000f, -0.0000000f, +0.0000000f,
  -0.0000000f, -0.0000000f, +0.0000000f, +0.0000000f, +0.0000000f, -0.0000000f, +0.0000000f, +0.0000000f,
  -0.0000000f, -0.0000000f, -0.0000000f, -0.0000000f, +0.0000000f, +0.0000000f, -0.0000000f, -0.0000000f,
  -0.0000000f, -0.0000000f, +0.0000000f, +0.0000000f, +0.0000000f, +0.0000000f, -0.0000000f, -0.0000000f,
  -0.0000000f, -0.0000000f, +0.0000000f, +0.0000000f, -0.0000000f, -0.0000000f, +0.0000000f, +0.0000000f,
  -0.0000000f, -0.0000000f, -0.0000000f, -0.0000000f, -0.0000000f, -0.0000000f, +0.0000000f, +0.0000000f,
  +0.0000000f, -0.0000000f, -0.0000000f, -0.0000000f, +0.0000000f, -0.0000000f, +0.0000000f, +0.0000000f,
  +0.0000000f, -0.0000000f, +0.0000000f, +0.0000000f, -0.0000000f, +0.0000000f, -0.0000000f, +0.0000000f,
  -0.0008484f, -0.0003471f, -0.0005245f, -0.0002448f, -0.0002850f, -0.0004011f, -0.0000758f, -0.0001780f,
  -0.0008440f, -0.0004464f, -0.0005458f, -0.0004074f, +0.0000973f, -0.0004257f, +0.0000040f, -0.0004538f,
  -0.0005864f, -0.0005235f, -0.0005627f, -0.0003119f, +0.0003121f, -0.0002430f, +0.0000622f, -0.0005185f,
  -0.0008351f, -0.0004452f, -0.0004239f, -0.0003492f, -0.0002746f, -0.0000994f, +0.0000232f, -0.0005069f,
  -0.0008019f, -0.0005337f, -0.0004464f, -0.0004017f, +0.0001870f, -0.0000655f, +0.0002559f, -0.0005584f,
  -0.0005390f, -0.0005273f, -0.0004894f, -0.0002504f, +0.0004435f, +0.0000329f, +0.0003404f, -0.0002592f,
  -0.0008354f, -0.0005878f, -0.0003588f, -0.0005709f, -0.0000914f, +0.0001158f, -0.0000139f, -0.0005399f,
  -0.0007807f, -0.0005873f, -0.0003789f, -0.0005266f, +0.0003260f, +0.0002342f, +0.0003030f, -0.0007137f,
  -0.0004872f, -0.0005436f, -0.0004200f, -0.0002329f, +0.0005757f, +0.0003443f, +0.0004417f, -0.0004873f
);

const float biases[4] = float[4](
  +0.0049947f, +0.0053372f, -0.0000000f, -0.0013756f
);

vec4 hook() {
    const vec4 r[9][2] = vec4[9][2](
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 1.0f)))
    );

    float sum[4] = biases;
    for (int n = 0; n < 4; n++) {
        for (int i = 0; i < 9; i++) {
            const vec4 k0 = vec4(kernels[n * 8 * 9 + 8 * i + 0], kernels[n * 8 * 9 + 8 * i + 1], kernels[n * 8 * 9 + 8 * i + 2], kernels[n * 8 * 9 + 8 * i + 3]);
            const vec4 k1 = vec4(kernels[n * 8 * 9 + 8 * i + 4], kernels[n * 8 * 9 + 8 * i + 5], kernels[n * 8 * 9 + 8 * i + 6], kernels[n * 8 * 9 + 8 * i + 7]);
            sum[n] += (dot(k0, r[i][0]) + dot(k1, r[i][1]));
        }
    }

    return ACTIVE(vec4(sum[0], sum[1], sum[2], sum[3]));
}

//!HOOK LUMA
//!DESC ACNet Layer5 L1
//!WHEN OUTPUT.w LUMA.w / 1.2 > OUTPUT.h LUMA.h / 1.2 > *
//!BIND TMP1_L0
//!BIND TMP1_L1
//!SAVE TMP2_L1
//!COMPONENTS 4

#define ACTIVE(v) (max(v, 0.0f))

#define TEX_BIND_L0_TEXOFF TMP1_L0_texOff
#define TEX_BIND_L0_TEX TMP1_L0_tex
#define TEX_BIND_L0_POS TMP1_L0_pos
#define TEX_BIND_L0_SIZE TMP1_L0_size
#define TEX_BIND_L0_PT TMP1_L0_pt

#define TEX_BIND_L1_TEXOFF TMP1_L1_texOff
#define TEX_BIND_L1_TEX TMP1_L1_tex
#define TEX_BIND_L1_POS TMP1_L1_pos
#define TEX_BIND_L1_SIZE TMP1_L1_size
#define TEX_BIND_L1_PT TMP1_L1_pt

const float kernels[288] = float[288](
  -0.1754259f, -0.0614198f, +0.0456823f, +0.0495394f, -0.0089635f, -0.2185139f, +0.0023256f, -0.1570721f,
  -0.3415099f, -0.1073508f, -0.1154307f, +0.0874064f, +0.0018236f, -0.0602258f, -0.1500383f, +0.0080277f,
  -0.0326187f, +0.1472996f, +0.0094035f, +0.0449512f, +0.0365612f, -0.1032639f, -0.0912477f, -0.0739551f,
  -0.0197007f, +0.0743861f, -0.3437625f, +0.1811143f, -0.0702807f, +0.0534405f, -0.0977060f, -0.1411093f,
  -0.1549439f, -0.1048653f, -0.1196080f, +0.2640571f, +0.2971728f, +0.1910259f, +0.1954940f, -0.1354784f,
  -0.1653414f, +0.0796462f, +0.1009922f, -0.0159244f, +0.0318358f, -0.0579995f, -0.1540306f, -0.1056345f,
  +0.0356320f, +0.0171300f, +0.1133464f, -0.1146441f, -0.1364664f, -0.0335117f, -0.1532703f, +0.2305353f,
  -0.1089711f, +0.0443914f, +0.0758403f, +0.0008458f, -0.0656273f, +0.1549559f, +0.0833346f, -0.0218215f,
  -0.0383789f, -0.0051959f, +0.1067511f, -0.0668107f, +0.0930635f, -0.1111132f, +0.0056111f, -0.0066938f,
  -0.1025920f, +0.1023596f, +0.0659393f, -0.0287523f, -0.0607315f, -0.1860954f, +0.0649400f, -0.0610956f,
  +0.0435769f, -0.0348195f, +0.0958116f, -0.0456134f, -0.0055917f, -0.0057743f, +0.1611419f, +0.0665106f,
  -0.1763036f, -0.0068818f, -0.0701565f, -0.0127176f, +0.0517156f, +0.0326493f, +0.0396967f, -0.1385829f,
  +0.1648422f, -0.1143391f, -0.0162490f, +0.3878064f, -0.1416813f, +0.1997465f, +0.1153029f, -0.0652753f,
  +0.4241332f, -0.3179986f, -0.0159266f, +0.2677648f, +0.1766085f, +0.1650755f, +0.2402054f, +0.1089139f,
  +0.0694755f, +0.0213374f, -0.1118936f, -0.0103727f, -0.0558931f, +0.0138080f, -0.2166867f, +0.0820476f,
  -0.2470541f, -0.1993884f, -0.0093936f, -0.0239269f, -0.3041891f, +0.1073267f, +0.0602196f, -0.0679072f,
  +0.2575719f, -0.2653212f, -0.1093336f, -0.0643981f, -0.3553675f, +0.1472160f, +0.2025678f, +0.0228628f,
  -0.0956112f, +0.0733613f, -0.0293988f, +0.0991174f, +0.2197836f, +0.0586708f, -0.1522666f, -0.1032235f,
  +0.1654227f, -0.1010201f, -0.2712485f, -0.0671335f, +0.1027344f, -0.0037242f, +0.1236971f, +0.0194339f,
  -0.1443554f, -0.0376989f, -0.0567303f, -0.2238515f, +0.1184370f, +0.2972312f, +0.0506677f, +0.3001791f,
  +0.0641245f, +0.0924723f, -0.2598939f, +0.2177606f, -0.1185160f, +0.1191840f, -0.0602457f, +0.2801763f,
  -0.1037796f, -0.0689718f, -0.3016333f, -0.0113513f, +0.0267584f, +0.0849943f, +0.0605619f, +0.1402054f,
  -0.3234628f, -0.0123075f, -0.1482648f, -0.3786102f, -0.0858065f, -0.3574747f, -0.3506823f, +0.2748103f,
  -0.0151232f, +0.1647799f, -0.3495465f, +0.1868674f, +0.0594441f, +0.0361485f, -0.3264454f, +0.2286788f,
  +0.0038758f, +0.0343513f, -0.1625915f, +0.0405515f, -0.0516266f, +0.0997054f, +0.0009102f, +0.0485396f,
  +0.1100605f, -0.0174607f, -0.1670800f, +0.0819427f, +0.0716362f, -0.1373554f, +0.0662034f, +0.1771871f,
  -0.0443252f, +0.1030095f, -0.2796393f, +0.1086552f, +0.2284074f, -0.0600801f, -0.1077029f, -0.0458338f,
  -0.0963494f, +0.0759935f, -0.0006159f, +0.0251126f, -0.0473917f, -0.0452919f, +0.0646554f, +0.1502345f,
  -0.0230083f, -0.0716094f, -0.0445562f, +0.0774901f, -0.0422258f, -0.0245376f, +0.0377033f, -0.0705939f,
  -0.1449678f, +0.0146245f, -0.0233730f, +0.0290244f, +0.0319677f, +0.1037690f, +0.0379698f, -0.1392440f,
  +0.0430529f, +0.0411103f, -0.0448833f, +0.1542645f, -0.2671692f, -0.0177802f, +0.0091864f, +0.0360157f,
  -0.1016090f, +0.0712581f, -0.0777221f, +0.2547237f, -0.0502060f, +0.2005806f, +0.1146771f, -0.0390775f,
  +0.0287500f, -0.0291095f, -0.0736349f, +0.0480567f, +0.0008195f, -0.0243433f, -0.0006276f, -0.0389505f,
  -0.1259372f, -0.0058698f, -0.0277502f, -0.1196901f, -0.0404262f, -0.0117141f, -0.1481237f, +0.0187345f,
  -0.0103883f, +0.1238854f, -0.0015117f, -0.1148724f, +0.1437348f, +0.1598378f, +0.0065670f, -0.1557338f,
  -0.0439655f, +0.0476479f, -0.0873678f, -0.1180158f, -0.0033121f, -0.1263782f, +0.1076476f, -0.1245582f
);

const float biases[4] = float[4](
  +0.0038858f, -0.0441971f, +0.0339698f, +0.0284112f
);

vec4 hook() {
    const vec4 r[9][2] = vec4[9][2](
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 1.0f)))
    );

    float sum[4] = biases;
    for (int n = 0; n < 4; n++) {
        for (int i = 0; i < 9; i++) {
            const vec4 k0 = vec4(kernels[n * 8 * 9 + 8 * i + 0], kernels[n * 8 * 9 + 8 * i + 1], kernels[n * 8 * 9 + 8 * i + 2], kernels[n * 8 * 9 + 8 * i + 3]);
            const vec4 k1 = vec4(kernels[n * 8 * 9 + 8 * i + 4], kernels[n * 8 * 9 + 8 * i + 5], kernels[n * 8 * 9 + 8 * i + 6], kernels[n * 8 * 9 + 8 * i + 7]);
            sum[n] += (dot(k0, r[i][0]) + dot(k1, r[i][1]));
        }
    }

    return ACTIVE(vec4(sum[0], sum[1], sum[2], sum[3]));
}

//!HOOK LUMA
//!DESC ACNet Layer6 L0
//!WHEN OUTPUT.w LUMA.w / 1.2 > OUTPUT.h LUMA.h / 1.2 > *
//!BIND TMP2_L0
//!BIND TMP2_L1
//!SAVE TMP1_L0
//!COMPONENTS 4

#define ACTIVE(v) (max(v, 0.0f))

#define TEX_BIND_L0_TEXOFF TMP2_L0_texOff
#define TEX_BIND_L0_TEX TMP2_L0_tex
#define TEX_BIND_L0_POS TMP2_L0_pos
#define TEX_BIND_L0_SIZE TMP2_L0_size
#define TEX_BIND_L0_PT TMP2_L0_pt

#define TEX_BIND_L1_TEXOFF TMP2_L1_texOff
#define TEX_BIND_L1_TEX TMP2_L1_tex
#define TEX_BIND_L1_POS TMP2_L1_pos
#define TEX_BIND_L1_SIZE TMP2_L1_size
#define TEX_BIND_L1_PT TMP2_L1_pt

const float kernels[288] = float[288](
  +0.0486343f, -0.0003602f, +0.0000000f, -0.0000862f, +0.0353749f, +0.0272671f, +0.0073023f, +0.0650735f,
  -0.1361685f, -0.0322728f, +0.0000000f, -0.0000598f, +0.0286601f, +0.0868191f, +0.0296307f, +0.3492188f,
  +0.0612307f, -0.0854854f, -0.0000000f, -0.0000406f, +0.0412775f, +0.0950703f, +0.0108201f, +0.1348274f,
  -0.0702347f, -0.0070804f, -0.0000000f, -0.0000750f, +0.1628905f, -0.0727002f, -0.0213998f, +0.1450644f,
  -0.6410982f, +0.2175088f, -0.0000000f, -0.0000471f, -0.3219851f, -0.2882550f, +0.5424405f, -0.2547241f,
  +0.1598515f, +0.0072575f, +0.0000000f, -0.0000317f, -0.0178447f, +0.0011750f, +0.1563853f, -0.0728936f,
  +0.0861505f, -0.0836061f, -0.0000000f, -0.0000984f, +0.2465895f, +0.0252592f, -0.1756148f, +0.0459447f,
  +0.1184651f, -0.1488479f, -0.0000000f, -0.0000668f, -0.0396178f, +0.0024681f, +0.4894729f, +0.1404007f,
  +0.1381925f, -0.1270225f, +0.0000000f, -0.0000477f, +0.0041065f, +0.0647372f, -0.0883050f, +0.1214845f,
  -0.2693153f, -0.0736913f, -0.0000000f, +0.0010179f, -0.0519981f, -0.0579439f, -0.0375147f, +0.0138881f,
  -0.1151841f, +0.0078186f, +0.0000000f, +0.0005154f, +0.0657678f, +0.1262443f, +0.0287034f, -0.2277523f,
  -0.0093158f, +0.0137612f, +0.0000000f, +0.0003808f, +0.0316030f, -0.1439579f, +0.0012382f, -0.0636924f,
  -0.2396110f, -0.1568919f, +0.0000000f, +0.0007351f, -0.0301982f, -0.0415418f, +0.3854159f, -0.1843022f,
  -0.1247937f, +0.0311379f, +0.0000000f, +0.0004543f, -0.0316917f, +0.6510989f, -0.0227543f, +0.0584516f,
  -0.0897956f, +0.0392314f, +0.0000000f, +0.0003741f, -0.0692994f, +0.1094206f, +0.0344585f, +0.0457635f,
  +0.0186877f, -0.0043607f, +0.0000000f, +0.0009301f, +0.0176723f, -0.1313311f, +0.3054512f, -0.0850445f,
  -0.0492668f, +0.2081327f, +0.0000000f, +0.0006737f, +0.2376614f, +0.0505380f, -0.5381685f, -0.1706010f,
  +0.0771886f, +0.0556350f, -0.0000000f, +0.0006005f, +0.0578766f, -0.0273708f, -0.0021389f, -0.0185648f,
  -0.0203844f, -0.0100330f, +0.0000000f, +0.0002630f, +0.0759328f, +0.0526832f, +0.1227054f, -0.0597250f,
  -0.0330179f, +0.0705298f, -0.0000000f, +0.0000700f, +0.0262951f, +0.3989137f, +0.1609748f, +0.1018476f,
  -0.0511352f, -0.0078012f, -0.0000000f, -0.0004098f, +0.0279843f, +0.0291503f, +0.0456438f, +0.0011363f,
  -0.0457895f, +0.0840421f, +0.0000000f, +0.0002626f, -0.0055914f, -0.0660905f, +0.0361006f, +0.0677908f,
  -0.1810495f, +0.1198188f, -0.0000000f, +0.0000428f, -0.0879809f, +0.2945511f, -0.0171744f, +0.0176965f,
  +0.0354192f, -0.0960457f, -0.0000000f, -0.0004995f, -0.0926183f, -0.1970974f, +0.0661099f, +0.0526379f,
  -0.0500811f, -0.0640087f, -0.0000000f, +0.0003980f, +0.0427250f, +0.0145464f, +0.1507803f, +0.0330514f,
  +0.0877193f, -0.1071090f, -0.0000000f, +0.0001262f, -0.3120988f, -0.0255723f, +0.4518045f, -0.0840486f,
  +0.1037285f, -0.1352296f, -0.0000000f, -0.0004766f, +0.1341222f, +0.0811251f, +0.0771538f, +0.1438003f,
  +0.0187439f, -0.0103616f, -0.0000000f, +0.0002716f, +0.0663103f, -0.0319970f, +0.0428206f, +0.1091468f,
  -0.2094032f, +0.0199546f, +0.0000000f, +0.0005998f, +0.0152405f, +0.0151715f, -0.1005490f, +0.1208843f,
  -0.2142420f, +0.0426393f, -0.0000000f, +0.0008689f, -0.0530437f, -0.0493718f, +0.0489272f, +0.1015067f,
  -0.2132895f, -0.0219515f, -0.0000000f, +0.0003012f, +0.1254453f, +0.0005461f, +0.1252425f, +0.0068449f,
  -0.1315379f, -0.0246817f, -0.0000000f, +0.0007011f, +0.0505823f, +0.1726208f, +0.0588588f, -0.1554575f,
  -0.3257189f, -0.0244532f, -0.0000000f, +0.0010248f, +0.0273575f, -0.2208070f, -0.0209800f, +0.1202432f,
  +0.1129178f, -0.0256060f, -0.0000000f, +0.0002918f, +0.1933833f, +0.0848710f, +0.2289675f, +0.0490358f,
  +0.0123605f, -0.0335800f, -0.0000000f, +0.0006475f, +0.1137656f, +0.0178237f, +0.1759373f, -0.1224534f,
  -0.1550584f, -0.0363400f, -0.0000000f, +0.0009482f, +0.0461101f, -0.0364289f, +0.0342388f, +0.0467134f
);

const float biases[4] = float[4](
  -0.0395957f, +0.0006791f, +0.1734742f, +0.0109483f
);

vec4 hook() {
    const vec4 r[9][2] = vec4[9][2](
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 1.0f)))
    );

    float sum[4] = biases;
    for (int n = 0; n < 4; n++) {
        for (int i = 0; i < 9; i++) {
            const vec4 k0 = vec4(kernels[n * 8 * 9 + 8 * i + 0], kernels[n * 8 * 9 + 8 * i + 1], kernels[n * 8 * 9 + 8 * i + 2], kernels[n * 8 * 9 + 8 * i + 3]);
            const vec4 k1 = vec4(kernels[n * 8 * 9 + 8 * i + 4], kernels[n * 8 * 9 + 8 * i + 5], kernels[n * 8 * 9 + 8 * i + 6], kernels[n * 8 * 9 + 8 * i + 7]);
            sum[n] += (dot(k0, r[i][0]) + dot(k1, r[i][1]));
        }
    }

    return ACTIVE(vec4(sum[0], sum[1], sum[2], sum[3]));
}

//!HOOK LUMA
//!DESC ACNet Layer6 L1
//!WHEN OUTPUT.w LUMA.w / 1.2 > OUTPUT.h LUMA.h / 1.2 > *
//!BIND TMP2_L0
//!BIND TMP2_L1
//!SAVE TMP1_L1
//!COMPONENTS 4

#define ACTIVE(v) (max(v, 0.0f))

#define TEX_BIND_L0_TEXOFF TMP2_L0_texOff
#define TEX_BIND_L0_TEX TMP2_L0_tex
#define TEX_BIND_L0_POS TMP2_L0_pos
#define TEX_BIND_L0_SIZE TMP2_L0_size
#define TEX_BIND_L0_PT TMP2_L0_pt

#define TEX_BIND_L1_TEXOFF TMP2_L1_texOff
#define TEX_BIND_L1_TEX TMP2_L1_tex
#define TEX_BIND_L1_POS TMP2_L1_pos
#define TEX_BIND_L1_SIZE TMP2_L1_size
#define TEX_BIND_L1_PT TMP2_L1_pt

const float kernels[288] = float[288](
  +0.0075083f, +0.0395186f, -0.0000000f, -0.0004554f, -0.0352568f, -0.0102554f, +0.0859958f, -0.0717808f,
  -0.0480844f, +0.0418670f, -0.0000000f, -0.0005238f, -0.0118663f, +0.1296121f, -0.0101762f, +0.0028376f,
  +0.0097731f, -0.0504853f, -0.0000000f, -0.0007076f, +0.0197169f, -0.0868232f, +0.0266288f, +0.0782980f,
  +0.0487794f, +0.0252570f, -0.0000000f, -0.0003381f, -0.0607768f, +0.1699354f, +0.0733617f, +0.1318259f,
  +0.0318481f, +0.1407059f, -0.0000000f, -0.0003812f, -0.0073127f, +0.4749145f, -0.0077525f, +0.0271490f,
  -0.0935167f, +0.1360649f, -0.0000000f, -0.0005322f, -0.0328253f, +0.2713541f, +0.0562611f, -0.0997864f,
  +0.0645954f, +0.1748117f, -0.0000000f, -0.0003177f, -0.1495238f, +0.0028538f, +0.1081922f, +0.0904908f,
  +0.0393369f, +0.2021002f, -0.0000000f, -0.0003459f, +0.3211662f, +0.1557230f, -0.2586251f, +0.0879382f,
  -0.0723434f, +0.1724079f, -0.0000000f, -0.0004878f, -0.0637860f, -0.0337364f, -0.0057146f, -0.0218821f,
  +0.0041396f, -0.0454094f, -0.0000000f, -0.0001273f, -0.0564283f, -0.0071232f, +0.0739789f, +0.1381433f,
  -0.0458161f, -0.0458768f, -0.0000000f, -0.0002658f, +0.1077115f, +0.1029720f, +0.0838749f, +0.1286976f,
  -0.0788916f, -0.0764137f, -0.0000000f, -0.0003552f, +0.1018502f, +0.1687152f, -0.0076372f, +0.0916260f,
  -0.0063855f, -0.0105732f, -0.0000000f, +0.0000343f, +0.2294797f, +0.1919363f, +0.1957696f, -0.0468899f,
  +0.1750223f, -0.1251703f, -0.0000000f, -0.0001681f, -0.0787445f, -0.1157756f, +0.2739054f, -0.0887338f,
  +0.1205275f, -0.0439909f, -0.0000000f, -0.0003168f, +0.0006077f, +0.1073217f, +0.0452746f, +0.0788658f,
  +0.1249247f, -0.0264472f, -0.0000000f, -0.0000554f, -0.0022355f, -0.0869521f, +0.1560952f, +0.1002657f,
  +0.0612582f, -0.0954782f, -0.0000000f, -0.0002992f, -0.0020128f, +0.0329010f, +0.2380230f, +0.2213902f,
  -0.0405157f, -0.0247353f, -0.0000000f, -0.0004369f, -0.0057317f, -0.0066658f, +0.0165549f, +0.1005035f,
  -0.0658452f, -0.0171141f, -0.0000000f, -0.0006263f, +0.0815504f, -0.0309390f, +0.0711953f, -0.0946145f,
  -0.1098968f, +0.0762948f, -0.0000000f, -0.0007273f, -0.0041817f, -0.1992142f, +0.1497951f, +0.0544147f,
  -0.0698959f, +0.0154389f, -0.0000000f, -0.0008167f, +0.0123008f, -0.0038689f, +0.0380786f, -0.0314845f,
  +0.0416870f, -0.0242712f, -0.0000000f, -0.0005658f, -0.0458001f, -0.0868028f, -0.1267765f, -0.0364508f,
  +0.0306311f, +0.0585382f, -0.0000000f, -0.0006119f, +0.0467077f, +0.3485710f, -0.0812735f, +0.1437941f,
  -0.0884412f, +0.0981900f, -0.0000000f, -0.0006958f, -0.0879717f, -0.1020099f, -0.0434446f, +0.0522908f,
  -0.1186761f, +0.0497417f, -0.0000000f, -0.0005628f, -0.2988003f, +0.0215968f, +0.0524823f, -0.0920690f,
  +0.0108360f, +0.0878068f, -0.0000000f, -0.0005855f, +0.2645601f, +0.0143801f, -0.1876330f, +0.0956751f,
  +0.0258725f, +0.0658705f, -0.0000000f, -0.0006355f, +0.0039363f, +0.0434484f, +0.1155654f, -0.0584334f,
  +0.0075768f, +0.0204917f, -0.0000000f, -0.0002920f, -0.0038007f, +0.0900831f, +0.0815039f, +0.0653814f,
  -0.0712803f, +0.0409099f, -0.0000000f, -0.0002199f, -0.0687652f, +0.2435202f, +0.0083226f, +0.0490752f,
  -0.1457573f, +0.0113789f, -0.0000000f, -0.0001950f, -0.0957162f, +0.0397077f, +0.0069013f, -0.0539312f,
  -0.1467076f, +0.0315820f, -0.0000000f, -0.0000265f, +0.0630915f, -0.0540512f, +0.0943930f, +0.0439612f,
  -0.1244574f, +0.0360389f, -0.0000000f, -0.0000126f, -0.0819710f, -0.0687483f, +0.0593222f, +0.0090223f,
  -0.1520703f, -0.0044040f, -0.0000000f, -0.0000843f, -0.0928954f, -0.1893718f, +0.0550225f, -0.0416779f,
  -0.0543682f, +0.0175395f, -0.0000000f, +0.0001676f, -0.0068353f, -0.0019808f, +0.1023585f, -0.0642621f,
  +0.0383027f, +0.0001410f, -0.0000000f, +0.0001127f, +0.0736387f, -0.0713372f, -0.0402055f, -0.0503036f,
  -0.0817936f, -0.0643670f, -0.0000000f, -0.0000545f, +0.1350539f, -0.0283162f, +0.0351717f, -0.0935970f
);

const float biases[4] = float[4](
  +0.1177280f, +0.0919033f, +0.0567295f, -0.0005332f
);

vec4 hook() {
    const vec4 r[9][2] = vec4[9][2](
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 1.0f)))
    );

    float sum[4] = biases;
    for (int n = 0; n < 4; n++) {
        for (int i = 0; i < 9; i++) {
            const vec4 k0 = vec4(kernels[n * 8 * 9 + 8 * i + 0], kernels[n * 8 * 9 + 8 * i + 1], kernels[n * 8 * 9 + 8 * i + 2], kernels[n * 8 * 9 + 8 * i + 3]);
            const vec4 k1 = vec4(kernels[n * 8 * 9 + 8 * i + 4], kernels[n * 8 * 9 + 8 * i + 5], kernels[n * 8 * 9 + 8 * i + 6], kernels[n * 8 * 9 + 8 * i + 7]);
            sum[n] += (dot(k0, r[i][0]) + dot(k1, r[i][1]));
        }
    }

    return ACTIVE(vec4(sum[0], sum[1], sum[2], sum[3]));
}

//!HOOK LUMA
//!DESC ACNet Layer7 L0
//!WHEN OUTPUT.w LUMA.w / 1.2 > OUTPUT.h LUMA.h / 1.2 > *
//!BIND TMP1_L0
//!BIND TMP1_L1
//!SAVE TMP2_L0
//!COMPONENTS 4

#define ACTIVE(v) (max(v, 0.0f))

#define TEX_BIND_L0_TEXOFF TMP1_L0_texOff
#define TEX_BIND_L0_TEX TMP1_L0_tex
#define TEX_BIND_L0_POS TMP1_L0_pos
#define TEX_BIND_L0_SIZE TMP1_L0_size
#define TEX_BIND_L0_PT TMP1_L0_pt

#define TEX_BIND_L1_TEXOFF TMP1_L1_texOff
#define TEX_BIND_L1_TEX TMP1_L1_tex
#define TEX_BIND_L1_POS TMP1_L1_pos
#define TEX_BIND_L1_SIZE TMP1_L1_size
#define TEX_BIND_L1_PT TMP1_L1_pt

const float kernels[288] = float[288](
  +0.3849606f, -0.1402040f, +0.0514706f, +0.0686898f, -0.0887022f, +0.1018398f, -0.1047786f, -0.0052358f,
  +0.1428694f, -0.0269144f, -0.4550677f, -0.0401249f, -0.1991118f, -0.0901015f, +0.0606521f, +0.0901008f,
  +0.0345304f, +0.0159149f, -0.0776197f, +0.0566572f, -0.1557048f, -0.0927699f, +0.0833992f, +0.0529731f,
  -0.5539755f, +0.1237080f, -0.0513284f, +0.0802076f, +0.0284009f, +0.0117129f, +0.1110438f, +0.0555271f,
  -0.0603806f, +0.2549595f, -0.0198081f, -0.0200747f, +0.0588023f, -0.3251351f, +0.2900775f, -0.0165986f,
  +0.0120778f, -0.0298667f, -0.0470515f, +0.1401892f, +0.1305045f, +0.1939279f, +0.0492084f, -0.0851672f,
  +0.0799832f, +0.0132686f, +0.0305729f, -0.0579591f, +0.0219046f, -0.0942272f, -0.0154142f, -0.0510184f,
  +0.2147759f, -0.0995957f, +0.0787621f, -0.0731522f, -0.0342976f, +0.2705340f, +0.0317178f, +0.0072243f,
  -0.0579150f, -0.2317349f, -0.0726272f, +0.0202015f, +0.0404465f, -0.0972326f, -0.0790827f, -0.0956839f,
  -0.0506075f, -0.0435089f, -0.0861299f, +0.0106046f, -0.0259557f, -0.0306680f, +0.0476051f, +0.0641959f,
  -0.0678640f, -0.2151110f, +0.0920689f, +0.0545984f, -0.3528473f, +0.0345560f, -0.2283353f, +0.0334599f,
  -0.0894962f, -0.0590701f, +0.0723031f, +0.0138263f, -0.2033844f, -0.0343214f, +0.0463829f, +0.0884729f,
  -0.2434839f, +0.1029254f, +0.0243655f, -0.0143419f, +0.2601132f, +0.0786945f, +0.1570127f, +0.0546632f,
  +0.2747665f, +0.4267840f, +0.2198770f, +0.1535256f, +0.2273735f, -0.2235675f, +0.3226400f, -0.0017665f,
  -0.1758793f, -0.0875271f, -0.0079408f, -0.0053974f, -0.1469274f, +0.0957331f, +0.0103340f, -0.0419346f,
  +0.1392676f, -0.0685463f, -0.0300629f, +0.1558316f, -0.0779642f, +0.1748269f, +0.0633515f, -0.0061346f,
  +0.0555023f, -0.0562958f, +0.1155441f, -0.0608887f, +0.1005338f, -0.1515349f, +0.1133969f, -0.0544633f,
  -0.0133697f, -0.0879621f, -0.0503106f, -0.0157716f, -0.0542778f, -0.0018262f, +0.0834776f, -0.0629595f,
  +0.0281594f, -0.0651286f, -0.0054266f, -0.0583685f, -0.0049708f, -0.0158072f, -0.0072252f, +0.1498289f,
  +0.0299035f, +0.1456832f, -0.0608039f, -0.0738127f, -0.0107753f, -0.0100009f, +0.0793243f, +0.0854467f,
  +0.0092429f, +0.0668431f, +0.0373255f, +0.0122403f, -0.0593740f, -0.0100593f, +0.0206623f, +0.0007209f,
  -0.0300409f, +0.1524056f, +0.0748438f, -0.0045106f, +0.0153585f, -0.0090493f, -0.0577105f, +0.1127542f,
  -0.0977828f, -0.0787364f, +0.0483397f, +0.0745796f, +0.0172775f, -0.0789535f, -0.0511422f, +0.0611310f,
  -0.0494997f, +0.1072089f, +0.1525101f, +0.1204183f, -0.1541192f, +0.0438910f, -0.1429642f, +0.0579554f,
  +0.0953502f, -0.0590146f, +0.0381583f, +0.0419591f, +0.0816465f, -0.0093815f, +0.0215009f, +0.0156243f,
  -0.0791426f, +0.1532031f, +0.1208702f, +0.1452942f, +0.0335032f, +0.0322406f, -0.0195177f, +0.2722476f,
  -0.1324395f, +0.3079608f, -0.0890027f, +0.0053636f, -0.0819337f, +0.0479617f, -0.0276579f, +0.1171605f,
  -0.0001632f, -0.0018015f, -0.0024082f, -0.0000239f, -0.0059760f, -0.0000328f, -0.0051999f, -0.0000031f,
  -0.0001337f, -0.0013733f, -0.0022576f, -0.0000159f, -0.0059998f, -0.0000296f, -0.0052334f, -0.0000092f,
  -0.0001557f, -0.0003915f, -0.0019231f, -0.0000058f, -0.0060295f, -0.0000280f, -0.0052847f, -0.0000162f,
  -0.0001053f, -0.0018453f, -0.0024913f, -0.0000152f, -0.0059962f, -0.0000108f, -0.0052057f, -0.0000016f,
  -0.0001077f, -0.0014238f, -0.0024136f, -0.0000124f, -0.0060100f, -0.0000116f, -0.0052283f, -0.0000070f,
  -0.0001531f, -0.0004416f, -0.0021678f, -0.0000061f, -0.0060277f, -0.0000143f, -0.0052713f, -0.0000142f,
  -0.0000897f, -0.0015511f, -0.0025057f, -0.0000131f, -0.0060003f, -0.0000016f, -0.0052195f, -0.0000011f,
  -0.0001086f, -0.0011131f, -0.0024650f, -0.0000111f, -0.0060059f, -0.0000026f, -0.0052321f, -0.0000066f,
  -0.0001732f, -0.0002009f, -0.0022732f, -0.0000058f, -0.0060148f, -0.0000048f, -0.0052633f, -0.0000149f
);

const float biases[4] = float[4](
  +0.0127082f, -0.0687597f, +0.1101508f, -0.0052465f
);

vec4 hook() {
    const vec4 r[9][2] = vec4[9][2](
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 1.0f)))
    );

    float sum[4] = biases;
    for (int n = 0; n < 4; n++) {
        for (int i = 0; i < 9; i++) {
            const vec4 k0 = vec4(kernels[n * 8 * 9 + 8 * i + 0], kernels[n * 8 * 9 + 8 * i + 1], kernels[n * 8 * 9 + 8 * i + 2], kernels[n * 8 * 9 + 8 * i + 3]);
            const vec4 k1 = vec4(kernels[n * 8 * 9 + 8 * i + 4], kernels[n * 8 * 9 + 8 * i + 5], kernels[n * 8 * 9 + 8 * i + 6], kernels[n * 8 * 9 + 8 * i + 7]);
            sum[n] += (dot(k0, r[i][0]) + dot(k1, r[i][1]));
        }
    }

    return ACTIVE(vec4(sum[0], sum[1], sum[2], sum[3]));
}

//!HOOK LUMA
//!DESC ACNet Layer7 L1
//!WHEN OUTPUT.w LUMA.w / 1.2 > OUTPUT.h LUMA.h / 1.2 > *
//!BIND TMP1_L0
//!BIND TMP1_L1
//!SAVE TMP2_L1
//!COMPONENTS 4

#define ACTIVE(v) (max(v, 0.0f))

#define TEX_BIND_L0_TEXOFF TMP1_L0_texOff
#define TEX_BIND_L0_TEX TMP1_L0_tex
#define TEX_BIND_L0_POS TMP1_L0_pos
#define TEX_BIND_L0_SIZE TMP1_L0_size
#define TEX_BIND_L0_PT TMP1_L0_pt

#define TEX_BIND_L1_TEXOFF TMP1_L1_texOff
#define TEX_BIND_L1_TEX TMP1_L1_tex
#define TEX_BIND_L1_POS TMP1_L1_pos
#define TEX_BIND_L1_SIZE TMP1_L1_size
#define TEX_BIND_L1_PT TMP1_L1_pt

const float kernels[288] = float[288](
  +0.0775736f, -0.0284710f, -0.0668694f, -0.0006773f, +0.0819362f, -0.0291893f, +0.0302375f, +0.0206344f,
  -0.0128659f, +0.1764707f, -0.1286668f, -0.0762689f, +0.1307286f, -0.0336147f, +0.1253365f, +0.0092825f,
  +0.0041348f, +0.0642318f, -0.0401946f, +0.0234698f, +0.1147664f, +0.0005562f, +0.0152556f, -0.0068027f,
  -0.0672982f, +0.1231592f, -0.0496508f, +0.0718689f, +0.1242873f, -0.0240589f, -0.0421183f, +0.0031335f,
  -0.1369105f, +0.3679961f, -0.0554996f, -0.1185497f, +0.1612921f, -0.0096181f, +0.1572347f, -0.0077443f,
  +0.0640788f, -0.1574045f, -0.0258789f, -0.0210672f, +0.1625073f, -0.0411750f, +0.0026929f, -0.0183067f,
  +0.0379623f, -0.0608389f, +0.0201793f, +0.1326251f, +0.0154762f, -0.0006368f, +0.0198730f, +0.0079974f,
  +0.0877367f, +0.0154488f, +0.0684669f, -0.0329575f, +0.0328617f, -0.0965590f, +0.0530498f, -0.0010283f,
  -0.0410461f, -0.1076085f, +0.0265753f, -0.0034365f, +0.0219988f, -0.0914483f, -0.0010153f, -0.0062520f,
  +0.0450498f, +0.0513893f, -0.1912260f, +0.0112403f, +0.0137210f, -0.0134696f, -0.0043689f, +0.0458958f,
  +0.0995035f, -0.0398104f, -0.0426130f, -0.0062254f, +0.1260668f, -0.0364461f, -0.0667031f, -0.0538713f,
  -0.1340404f, -0.0896998f, +0.0353713f, +0.1339863f, +0.0264257f, -0.0543790f, -0.2202504f, -0.1003676f,
  -0.6727098f, +0.0284447f, +0.1920702f, +0.1648280f, -0.2052932f, -0.1325707f, -0.0909613f, +0.1845733f,
  -0.0572902f, +0.3913600f, +0.0879161f, -0.3507940f, +0.2176829f, -0.0834120f, +0.1385535f, +0.1033788f,
  +0.0269190f, -0.1150798f, +0.0480891f, +0.0116116f, +0.2123241f, +0.0377452f, +0.0003457f, -0.0573064f,
  +0.2367319f, -0.1044934f, -0.0579121f, +0.2921546f, -0.0635743f, +0.0587780f, -0.2961299f, +0.0555099f,
  +0.0246878f, -0.0620047f, +0.1001404f, +0.0568754f, +0.0235044f, -0.2606003f, -0.0361384f, -0.0949381f,
  -0.0202270f, +0.0657210f, -0.0946593f, +0.0695054f, -0.1081142f, +0.0382624f, -0.1382680f, -0.0000565f,
  +0.1637164f, -0.0037833f, -0.1420521f, -0.0421370f, +0.0748012f, -0.0257698f, +0.0916683f, -0.0129435f,
  -0.0338543f, +0.1629296f, +0.0313124f, -0.0986998f, -0.1267139f, -0.0200405f, +0.0977218f, +0.0487964f,
  +0.0563325f, +0.0537842f, -0.0999280f, -0.1747857f, -0.0150072f, +0.0582425f, +0.1375361f, +0.0420068f,
  -0.4025102f, +0.1105250f, -0.1575474f, +0.0458364f, +0.2744030f, +0.0160546f, -0.0748166f, +0.0946681f,
  -0.0594277f, -0.1386722f, +0.4201600f, +0.0538928f, -0.3135138f, +0.0119712f, -0.4192261f, +0.0861487f,
  -0.0914695f, +0.0267716f, +0.0940650f, -0.1013848f, +0.0657872f, -0.0461117f, -0.1233694f, +0.1236213f,
  -0.0159208f, -0.0131335f, +0.0275355f, +0.0836093f, -0.0678202f, -0.1627641f, +0.1347208f, +0.0706368f,
  -0.0579480f, +0.3761362f, +0.1262035f, +0.0218485f, +0.1631222f, -0.0153132f, -0.0407450f, +0.2356491f,
  +0.0081682f, +0.0036361f, -0.1489383f, -0.1064802f, -0.0132544f, -0.0079826f, -0.0540551f, +0.1458179f,
  +0.0569036f, -0.0156988f, +0.0758756f, +0.0083390f, -0.0509547f, +0.0304013f, +0.0509445f, +0.0808003f,
  -0.0821663f, -0.0153031f, -0.2669933f, -0.0782908f, +0.0920928f, -0.0287570f, +0.0492463f, +0.0026680f,
  +0.1056293f, +0.1667102f, -0.0158908f, -0.2075395f, -0.0584769f, -0.0255626f, +0.1273800f, -0.0166601f,
  +0.0939687f, -0.0061947f, -0.0804259f, +0.0344904f, +0.0443247f, +0.0507407f, +0.0051440f, +0.1068406f,
  -0.2290874f, +0.2574930f, +0.1340567f, +0.2791339f, +0.0329729f, -0.3505611f, +0.1570336f, +0.1230760f,
  +0.0465371f, +0.1525687f, -0.0198812f, +0.0595661f, -0.1947739f, -0.2558353f, +0.0557434f, +0.0178824f,
  +0.0652575f, +0.0329081f, +0.0354722f, +0.0252879f, +0.0395819f, +0.0917094f, -0.0394917f, +0.0182804f,
  +0.1480381f, -0.0599070f, -0.0821396f, +0.1172458f, -0.0868774f, -0.0409324f, +0.1211365f, +0.1097175f,
  -0.0620917f, +0.1150176f, +0.0165094f, -0.1035641f, -0.1175332f, +0.2381250f, +0.0205309f, -0.0052912f
);

const float biases[4] = float[4](
  +0.1602221f, -0.0191405f, -0.0321571f, +0.0310538f
);

vec4 hook() {
    const vec4 r[9][2] = vec4[9][2](
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 1.0f)))
    );

    float sum[4] = biases;
    for (int n = 0; n < 4; n++) {
        for (int i = 0; i < 9; i++) {
            const vec4 k0 = vec4(kernels[n * 8 * 9 + 8 * i + 0], kernels[n * 8 * 9 + 8 * i + 1], kernels[n * 8 * 9 + 8 * i + 2], kernels[n * 8 * 9 + 8 * i + 3]);
            const vec4 k1 = vec4(kernels[n * 8 * 9 + 8 * i + 4], kernels[n * 8 * 9 + 8 * i + 5], kernels[n * 8 * 9 + 8 * i + 6], kernels[n * 8 * 9 + 8 * i + 7]);
            sum[n] += (dot(k0, r[i][0]) + dot(k1, r[i][1]));
        }
    }

    return ACTIVE(vec4(sum[0], sum[1], sum[2], sum[3]));
}

//!HOOK LUMA
//!DESC ACNet Layer8 L0
//!WHEN OUTPUT.w LUMA.w / 1.2 > OUTPUT.h LUMA.h / 1.2 > *
//!BIND TMP2_L0
//!BIND TMP2_L1
//!SAVE TMP1_L0
//!COMPONENTS 4

#define ACTIVE(v) (max(v, 0.0f))

#define TEX_BIND_L0_TEXOFF TMP2_L0_texOff
#define TEX_BIND_L0_TEX TMP2_L0_tex
#define TEX_BIND_L0_POS TMP2_L0_pos
#define TEX_BIND_L0_SIZE TMP2_L0_size
#define TEX_BIND_L0_PT TMP2_L0_pt

#define TEX_BIND_L1_TEXOFF TMP2_L1_texOff
#define TEX_BIND_L1_TEX TMP2_L1_tex
#define TEX_BIND_L1_POS TMP2_L1_pos
#define TEX_BIND_L1_SIZE TMP2_L1_size
#define TEX_BIND_L1_PT TMP2_L1_pt

const float kernels[288] = float[288](
  -0.0138122f, +0.0123667f, +0.0414819f, +0.0000119f, -0.0533402f, +0.0053520f, +0.0148470f, +0.0581633f,
  -0.0462715f, -0.0629231f, +0.0617953f, +0.0000190f, +0.0013108f, +0.0187663f, +0.2323719f, +0.1369466f,
  +0.0737897f, +0.0308436f, -0.0112929f, +0.0000207f, +0.0404360f, +0.4029705f, -0.0636871f, -0.0262566f,
  -0.0638009f, +0.0936225f, -0.0899439f, +0.0000101f, +0.0570682f, +0.0264734f, -0.0656720f, -0.1332798f,
  -0.3681743f, +0.1952717f, -0.1360827f, +0.0000168f, -0.0279227f, -0.0346750f, -0.2188818f, -0.3572961f,
  -0.0178802f, -0.0263660f, +0.0180675f, +0.0000194f, -0.0547814f, -0.1178345f, -0.0172334f, +0.0245071f,
  +0.0529857f, -0.0208369f, +0.0369738f, +0.0000065f, -0.0292925f, -0.0250377f, +0.0406077f, -0.0045611f,
  +0.1862617f, -0.0344244f, +0.0052530f, +0.0000110f, +0.0271446f, -0.0177023f, -0.0695798f, +0.2042449f,
  +0.0015645f, +0.0402562f, -0.0274741f, +0.0000135f, +0.0273397f, -0.0349085f, -0.0222005f, -0.0398208f,
  +0.0553000f, -0.0668690f, -0.0142634f, -0.0016548f, +0.0357260f, -0.0047375f, +0.1191753f, -0.1849562f,
  -0.1600619f, +0.1446873f, +0.0289140f, -0.0018796f, +0.1801274f, +0.0551153f, -0.2408112f, +0.0276984f,
  +0.1171655f, +0.0518052f, +0.0322394f, -0.0019883f, +0.0169134f, +0.6264216f, +0.1788920f, -0.0657683f,
  -0.0261068f, +0.0987599f, -0.0248709f, -0.0016186f, -0.1216771f, +0.0099776f, -0.1051406f, +0.2967699f,
  -0.0869945f, -0.1675853f, +0.0560143f, -0.0018494f, -0.0638476f, -0.2198783f, +0.2921990f, +0.0441635f,
  +0.0837202f, -0.1234958f, -0.0444690f, -0.0019670f, +0.0305553f, -0.2098390f, -0.1326309f, +0.0585304f,
  +0.0754939f, +0.0570054f, +0.0312087f, -0.0015841f, +0.0302690f, +0.0070470f, +0.0056091f, -0.1100973f,
  +0.3218887f, +0.0849042f, +0.0136769f, -0.0018173f, -0.1025976f, +0.0631783f, -0.0416227f, -0.0767870f,
  +0.1552747f, +0.0897133f, -0.0210516f, -0.0019345f, -0.0152589f, -0.0136069f, +0.0255894f, +0.0398436f,
  +0.0052113f, -0.0273907f, +0.0950551f, -0.0018377f, -0.0451219f, -0.0055105f, +0.1223853f, +0.0467172f,
  -0.0182017f, +0.0067917f, +0.0388552f, -0.0019231f, +0.0017027f, -0.1899025f, -0.1333723f, +0.0211219f,
  +0.0014129f, +0.0020496f, +0.0124459f, -0.0018930f, -0.0035534f, +0.0265275f, +0.0733914f, +0.0154908f,
  -0.0061402f, +0.0673329f, -0.1515247f, -0.0018058f, +0.0085222f, +0.0066140f, -0.1220468f, -0.1307711f,
  -0.2722224f, +0.0782623f, +0.0781245f, -0.0018841f, +0.1012979f, +0.2153717f, +0.1314532f, +0.1163483f,
  +0.0746897f, +0.0021110f, -0.0126165f, -0.0018678f, +0.0478935f, -0.0221831f, -0.0200632f, +0.0108489f,
  +0.0191315f, -0.0545193f, +0.0093100f, -0.0017387f, +0.0655744f, -0.0080628f, +0.0221684f, +0.0801130f,
  +0.2275254f, +0.0307631f, -0.0165279f, -0.0017966f, +0.0072150f, +0.0068398f, +0.0036097f, -0.0840277f,
  +0.0195868f, +0.0156275f, -0.0128725f, -0.0017781f, -0.0021820f, +0.0094474f, +0.0271459f, +0.0012863f,
  -0.0297959f, +0.0558943f, -0.0774775f, -0.0049916f, +0.0618188f, -0.0136050f, -0.0343323f, -0.0636283f,
  -0.0845372f, +0.1070606f, +0.0535888f, -0.0049986f, +0.1506111f, +0.0828959f, -0.1839167f, -0.0050303f,
  -0.0026766f, +0.0529652f, -0.0015710f, -0.0050660f, +0.0119845f, -0.4193115f, +0.0444710f, +0.0546169f,
  -0.0077771f, -0.0078731f, -0.1275250f, -0.0049770f, +0.1290541f, -0.0226568f, -0.0370733f, -0.0878021f,
  -0.0024274f, +0.5582526f, +0.2516569f, -0.0049840f, +0.2592117f, +0.2476782f, -0.0546200f, +0.2197696f,
  +0.0862736f, +0.1037313f, +0.0082205f, -0.0050543f, +0.1476826f, +0.2652805f, +0.1089928f, -0.0060249f,
  -0.0203539f, -0.1197498f, -0.0983493f, -0.0049997f, +0.0455477f, -0.0115660f, +0.0378913f, +0.0635538f,
  +0.0412446f, -0.0200707f, -0.0495392f, -0.0050114f, +0.1490176f, -0.0087819f, +0.0994869f, -0.0542910f,
  +0.0842270f, -0.0252859f, -0.0549406f, -0.0050809f, -0.0048961f, +0.0436179f, +0.0323831f, -0.0267092f
);

const float biases[4] = float[4](
  +0.0063028f, +0.0092698f, +0.0729448f, +0.3734172f
);

vec4 hook() {
    const vec4 r[9][2] = vec4[9][2](
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 1.0f)))
    );

    float sum[4] = biases;
    for (int n = 0; n < 4; n++) {
        for (int i = 0; i < 9; i++) {
            const vec4 k0 = vec4(kernels[n * 8 * 9 + 8 * i + 0], kernels[n * 8 * 9 + 8 * i + 1], kernels[n * 8 * 9 + 8 * i + 2], kernels[n * 8 * 9 + 8 * i + 3]);
            const vec4 k1 = vec4(kernels[n * 8 * 9 + 8 * i + 4], kernels[n * 8 * 9 + 8 * i + 5], kernels[n * 8 * 9 + 8 * i + 6], kernels[n * 8 * 9 + 8 * i + 7]);
            sum[n] += (dot(k0, r[i][0]) + dot(k1, r[i][1]));
        }
    }

    return ACTIVE(vec4(sum[0], sum[1], sum[2], sum[3]));
}

//!HOOK LUMA
//!DESC ACNet Layer8 L1
//!WHEN OUTPUT.w LUMA.w / 1.2 > OUTPUT.h LUMA.h / 1.2 > *
//!BIND TMP2_L0
//!BIND TMP2_L1
//!SAVE TMP1_L1
//!COMPONENTS 4

#define ACTIVE(v) (max(v, 0.0f))

#define TEX_BIND_L0_TEXOFF TMP2_L0_texOff
#define TEX_BIND_L0_TEX TMP2_L0_tex
#define TEX_BIND_L0_POS TMP2_L0_pos
#define TEX_BIND_L0_SIZE TMP2_L0_size
#define TEX_BIND_L0_PT TMP2_L0_pt

#define TEX_BIND_L1_TEXOFF TMP2_L1_texOff
#define TEX_BIND_L1_TEX TMP2_L1_tex
#define TEX_BIND_L1_POS TMP2_L1_pos
#define TEX_BIND_L1_SIZE TMP2_L1_size
#define TEX_BIND_L1_PT TMP2_L1_pt

const float kernels[288] = float[288](
  -0.0155053f, +0.0142655f, -0.0331137f, +0.0006723f, -0.0314961f, -0.0096037f, +0.0528992f, +0.0824788f,
  -0.0671041f, -0.0383377f, -0.0365884f, +0.0007286f, +0.0605139f, +0.0885215f, -0.0786678f, +0.0577660f,
  +0.0386073f, +0.0867799f, +0.0116347f, +0.0007391f, +0.0420126f, +0.0986162f, -0.0547980f, -0.1201941f,
  -0.1142725f, +0.1534108f, -0.0335205f, +0.0006534f, -0.0286170f, +0.0412973f, -0.2042849f, -0.3837341f,
  -0.3252378f, +0.1217410f, +0.1076730f, +0.0007070f, +0.0148457f, -0.3264452f, +0.0572376f, +0.0682715f,
  +0.0400766f, -0.0731597f, -0.0089125f, +0.0007123f, +0.0040016f, -0.0076144f, -0.0369370f, -0.0117584f,
  -0.0065144f, +0.0002633f, -0.0224308f, +0.0006154f, +0.0047006f, -0.0107110f, -0.0361027f, +0.0511293f,
  +0.1231291f, +0.0736903f, -0.0045655f, +0.0006729f, -0.0400170f, +0.0393242f, -0.0826828f, -0.2793150f,
  -0.0279236f, +0.0521873f, +0.0075531f, +0.0006780f, -0.0304109f, +0.0401436f, -0.0281007f, +0.0456075f,
  -0.0251511f, +0.0461378f, -0.0187503f, -0.0047840f, +0.0495110f, -0.0200796f, -0.0688730f, -0.0652614f,
  -0.0508164f, +0.0708424f, -0.0853185f, -0.0048359f, +0.1093459f, +0.1356111f, -0.0562209f, +0.0021426f,
  +0.0172312f, +0.0166728f, -0.0308578f, -0.0048727f, -0.0037430f, -0.1345520f, +0.0122547f, +0.0241915f,
  -0.0363758f, -0.0017243f, -0.0599814f, -0.0047882f, +0.1183434f, -0.0145048f, -0.0291975f, -0.0016073f,
  +0.1591589f, +0.2720346f, +0.1272910f, -0.0048380f, +0.0772425f, +0.2209998f, +0.0716118f, -0.0062222f,
  +0.0291921f, +0.0382625f, +0.0140944f, -0.0048755f, +0.0430744f, +0.0496349f, +0.0294020f, -0.0182947f,
  -0.0419475f, -0.1400038f, -0.0540883f, -0.0047859f, +0.0674464f, -0.0100403f, +0.0410359f, +0.0002495f,
  +0.0531827f, -0.0737925f, -0.0236939f, -0.0048321f, +0.0297340f, +0.0345600f, +0.0464167f, -0.0206230f,
  -0.0972890f, -0.0200496f, -0.0097485f, -0.0048633f, -0.0112761f, -0.0074607f, +0.0060284f, -0.0033064f,
  +0.0591876f, +0.0177423f, +0.0028777f, +0.0035869f, +0.0015454f, -0.0437205f, +0.0000195f, -0.0038667f,
  -0.0488394f, -0.0440594f, +0.0787953f, +0.0035891f, +0.0030582f, -0.0075722f, +0.3332616f, +0.1615916f,
  +0.0798405f, +0.0095374f, -0.0519020f, +0.0035923f, +0.0437367f, +0.2051049f, -0.0772412f, +0.1162660f,
  -0.0679516f, +0.3204930f, +0.1221234f, +0.0035746f, -0.0598330f, +0.0301326f, -0.1564803f, -0.2264566f,
  -0.4719130f, -0.1377884f, +0.1032118f, +0.0035840f, -0.1124681f, -0.4050581f, +0.1519513f, -0.0347577f,
  +0.1511685f, +0.0966084f, +0.0323597f, +0.0035967f, +0.0443805f, +0.2786692f, -0.1399509f, -0.0067956f,
  +0.1566826f, +0.0845796f, -0.0966174f, +0.0035785f, -0.1320598f, +0.0555859f, +0.0865195f, -0.3268940f,
  +0.2473318f, +0.1429251f, +0.0078941f, +0.0035932f, +0.0082778f, +0.0289255f, +0.1044652f, +0.1960608f,
  +0.1135394f, +0.0615740f, -0.0708761f, +0.0036080f, +0.0479631f, +0.0013360f, -0.0414128f, -0.0915233f,
  +0.0112384f, +0.0358918f, -0.0620156f, +0.0035760f, +0.0274695f, -0.0211973f, +0.0005814f, -0.0825875f,
  +0.0015084f, -0.0483037f, +0.2217516f, +0.0035540f, -0.0397521f, +0.0254257f, +0.2835354f, +0.1849806f,
  +0.0421131f, +0.0066142f, -0.0177635f, +0.0035692f, +0.0410627f, +0.1358461f, -0.0620158f, +0.1089104f,
  -0.0111543f, +0.1337357f, +0.0275416f, +0.0035664f, -0.0249849f, -0.0134596f, -0.1028861f, +0.1353802f,
  -0.3659621f, +0.2271986f, +0.1490454f, +0.0035490f, -0.1796876f, -0.1137677f, +0.1872388f, -0.4772827f,
  -0.0722519f, -0.0712240f, +0.0366374f, +0.0035689f, +0.0821861f, +0.1227788f, -0.0994754f, +0.1086814f,
  +0.0666209f, +0.0689523f, -0.0722306f, +0.0035671f, -0.0542507f, +0.0365332f, +0.0511930f, -0.0864150f,
  +0.1018775f, +0.2046653f, +0.0050271f, +0.0035619f, -0.0059651f, +0.0128432f, +0.0759861f, -0.1706131f,
  +0.4103184f, +0.0502507f, -0.0718229f, +0.0035864f, +0.0250791f, +0.0562194f, -0.0012951f, +0.0104567f
);

const float biases[4] = float[4](
  +0.0006403f, +0.1914893f, +0.3185646f, +0.2636234f
);

vec4 hook() {
    const vec4 r[9][2] = vec4[9][2](
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 1.0f)))
    );

    float sum[4] = biases;
    for (int n = 0; n < 4; n++) {
        for (int i = 0; i < 9; i++) {
            const vec4 k0 = vec4(kernels[n * 8 * 9 + 8 * i + 0], kernels[n * 8 * 9 + 8 * i + 1], kernels[n * 8 * 9 + 8 * i + 2], kernels[n * 8 * 9 + 8 * i + 3]);
            const vec4 k1 = vec4(kernels[n * 8 * 9 + 8 * i + 4], kernels[n * 8 * 9 + 8 * i + 5], kernels[n * 8 * 9 + 8 * i + 6], kernels[n * 8 * 9 + 8 * i + 7]);
            sum[n] += (dot(k0, r[i][0]) + dot(k1, r[i][1]));
        }
    }

    return ACTIVE(vec4(sum[0], sum[1], sum[2], sum[3]));
}

//!HOOK LUMA
//!DESC ACNet Layer9 L0
//!WIDTH LUMA.w 2 *
//!HEIGHT LUMA.h 2 *
//!BIND TMP1_L0
//!BIND TMP1_L1
//!COMPONENTS 1

#define ACTIVE(v) (max(v, 0.0f))

#define TEX_BIND_L0_TEXOFF TMP1_L0_texOff
#define TEX_BIND_L0_TEX TMP1_L0_tex
#define TEX_BIND_L0_POS TMP1_L0_pos
#define TEX_BIND_L0_SIZE TMP1_L0_size
#define TEX_BIND_L0_PT TMP1_L0_pt

#define TEX_BIND_L1_TEXOFF TMP1_L1_texOff
#define TEX_BIND_L1_TEX TMP1_L1_tex
#define TEX_BIND_L1_POS TMP1_L1_pos
#define TEX_BIND_L1_SIZE TMP1_L1_size
#define TEX_BIND_L1_PT TMP1_L1_pt

const float kernels[32] = float[32](
  -0.0966954f, +0.2546969f, -0.3012801f, +0.1564324f, -0.4854657f, +0.3743444f, -0.3577022f, +0.1052202f,
  -0.3093563f, +0.3359707f, -0.1602007f, +0.3772540f, -0.1972081f, -0.1155712f, +0.0753247f, -0.4180209f,
  +0.3537354f, -0.0718483f, +0.4519648f, -0.0216117f, -0.2025925f, +0.4407907f, -0.3396386f, +0.0799466f,
  +0.5704687f, -0.0699759f, +0.0495022f, +0.4366741f, -0.4389760f, -0.3122904f, +0.0335584f, -0.3587098f
);

vec4 hook() {
    vec2 fcoord = fract(TEX_BIND_L0_POS * TEX_BIND_L0_SIZE);
    vec2 pos = TEX_BIND_L0_POS + (vec2(0.5f) - fcoord) * TEX_BIND_L0_PT;

    ivec2 icoord = ivec2(fcoord * vec2(2.0f));
    int index = icoord.y * 2 + icoord.x;

    vec4 r0 = TEX_BIND_L0_TEX(pos);
    vec4 r1 = TEX_BIND_L1_TEX(pos);

    vec4 k0 = vec4(kernels[8 * index + 0], kernels[8 * index + 1], kernels[8 * index + 2], kernels[8 * index + 3]);
    vec4 k1 = vec4(kernels[8 * index + 4], kernels[8 * index + 5], kernels[8 * index + 6], kernels[8 * index + 7]);

    return vec4(clamp(dot(r0, k0) + dot(r1, k1), 0.0f, 1.0f), 0.0f, 0.0f, 1.0f);
}
