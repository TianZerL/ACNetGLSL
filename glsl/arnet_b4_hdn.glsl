//!HOOK LUMA
//!DESC ARNet b4 Layer0 L0
//!WHEN OUTPUT.w LUMA.w / 1.2 > OUTPUT.h LUMA.h / 1.2 > *
//!BIND LUMA
//!SAVE FEAT_L0
//!COMPONENTS 4

#define ACTIVE(v) (v)

#define TEX_BIND_L0_TEXOFF LUMA_texOff
#define TEX_BIND_L0_TEX LUMA_tex
#define TEX_BIND_L0_POS LUMA_pos
#define TEX_BIND_L0_SIZE LUMA_size
#define TEX_BIND_L0_PT LUMA_pt

const float kernels[36] = float[36](
  -0.7859905f, -0.0638668f, +0.2210974f, +0.0677404f, -0.1209411f, +0.1536184f, -0.1049050f, +0.4930893f,
  +0.1970585f, +0.1091990f, -0.2341093f, -0.2365887f, -0.1873759f, +0.0858795f, +0.0013426f, -0.0927139f,
  -0.6651050f, +0.4476755f, -0.2439733f, +0.1388763f, -0.4761823f, -0.1101417f, +0.6392620f, -0.1934031f,
  -0.6613441f, +0.5951046f, +0.3170519f, -0.4588659f, -0.2999188f, -0.3495430f, +0.2291308f, +0.4790110f,
  -0.4621115f, +0.4203224f, +0.6578947f, +0.0644806f
);

const float biases[4] = float[4](
  -0.0001333f, +0.0311861f, -0.0098706f, -0.0152415f
);

vec4 hook() {
    const vec4 r0 = vec4(
        TEX_BIND_L0_TEXOFF(vec2(-1.0f,-1.0f)).x,
        TEX_BIND_L0_TEXOFF(vec2( 0.0f,-1.0f)).x,
        TEX_BIND_L0_TEXOFF(vec2( 1.0f,-1.0f)).x,
        TEX_BIND_L0_TEXOFF(vec2(-1.0f, 0.0f)).x
    );
    const vec4 r4 = vec4(
        TEX_BIND_L0_TEXOFF(vec2( 0.0f, 0.0f)).x,
        TEX_BIND_L0_TEXOFF(vec2( 1.0f, 0.0f)).x,
        TEX_BIND_L0_TEXOFF(vec2(-1.0f, 1.0f)).x,
        TEX_BIND_L0_TEXOFF(vec2( 0.0f, 1.0f)).x
    );
    const float r8 = TEX_BIND_L0_TEXOFF(vec2( 1.0f, 1.0f)).x;

    float sum[4] = biases;
    for(int n = 0; n < 4; n++) {
        const vec4 k0 = vec4(kernels[n * 9 + 0], kernels[n * 9 + 1], kernels[n * 9 + 2], kernels[n * 9 + 3]);
        const vec4 k4 = vec4(kernels[n * 9 + 4], kernels[n * 9 + 5], kernels[n * 9 + 6], kernels[n * 9 + 7]);
        const float k8 = kernels[n * 9 + 8];
        sum[n] += (dot(r0, k0) + dot(r4, k4) + r8 * k8);
    }

    return ACTIVE(vec4(sum[0], sum[1], sum[2], sum[3]));
}

//!HOOK LUMA
//!DESC ARNet b4 Layer0 L1
//!WHEN OUTPUT.w LUMA.w / 1.2 > OUTPUT.h LUMA.h / 1.2 > *
//!BIND LUMA
//!SAVE FEAT_L1
//!COMPONENTS 4

#define ACTIVE(v) (v)

#define TEX_BIND_L0_TEXOFF LUMA_texOff
#define TEX_BIND_L0_TEX LUMA_tex
#define TEX_BIND_L0_POS LUMA_pos
#define TEX_BIND_L0_SIZE LUMA_size
#define TEX_BIND_L0_PT LUMA_pt

const float kernels[36] = float[36](
  -0.4864826f, -0.2821571f, -0.4533140f, -0.1673580f, -0.2315304f, +0.1335832f, +0.3673629f, +0.3913244f,
  -0.6552721f, +0.0407411f, -0.0905393f, +0.1285005f, -0.7655421f, +1.2718068f, -0.2636626f, -0.3657187f,
  -0.1570528f, +0.1464346f, -0.5037472f, +0.2361751f, -0.1696475f, +0.6316196f, -0.2777524f, +0.3264440f,
  +0.2665420f, +0.1029515f, -0.7580318f, -0.7818347f, +0.3003790f, +0.1516175f, -0.5121560f, +0.3941401f,
  +0.1928712f, -0.1210544f, +0.1778653f, +0.1813648f
);

const float biases[4] = float[4](
  +0.0103166f, -0.0008181f, -0.0061099f, -0.0097489f
);

vec4 hook() {
    const vec4 r0 = vec4(
        TEX_BIND_L0_TEXOFF(vec2(-1.0f,-1.0f)).x,
        TEX_BIND_L0_TEXOFF(vec2( 0.0f,-1.0f)).x,
        TEX_BIND_L0_TEXOFF(vec2( 1.0f,-1.0f)).x,
        TEX_BIND_L0_TEXOFF(vec2(-1.0f, 0.0f)).x
    );
    const vec4 r4 = vec4(
        TEX_BIND_L0_TEXOFF(vec2( 0.0f, 0.0f)).x,
        TEX_BIND_L0_TEXOFF(vec2( 1.0f, 0.0f)).x,
        TEX_BIND_L0_TEXOFF(vec2(-1.0f, 1.0f)).x,
        TEX_BIND_L0_TEXOFF(vec2( 0.0f, 1.0f)).x
    );
    const float r8 = TEX_BIND_L0_TEXOFF(vec2( 1.0f, 1.0f)).x;

    float sum[4] = biases;
    for(int n = 0; n < 4; n++) {
        const vec4 k0 = vec4(kernels[n * 9 + 0], kernels[n * 9 + 1], kernels[n * 9 + 2], kernels[n * 9 + 3]);
        const vec4 k4 = vec4(kernels[n * 9 + 4], kernels[n * 9 + 5], kernels[n * 9 + 6], kernels[n * 9 + 7]);
        const float k8 = kernels[n * 9 + 8];
        sum[n] += (dot(r0, k0) + dot(r4, k4) + r8 * k8);
    }

    return ACTIVE(vec4(sum[0], sum[1], sum[2], sum[3]));
}

//!HOOK LUMA
//!DESC ARNet b4 Layer1 L0
//!WHEN OUTPUT.w LUMA.w / 1.2 > OUTPUT.h LUMA.h / 1.2 > *
//!BIND FEAT_L0
//!BIND FEAT_L1
//!SAVE TMP1_L0
//!COMPONENTS 4

#define ACTIVE(v) (max(v, v * 0.2000000f))

#define TEX_BIND_L0_TEXOFF FEAT_L0_texOff
#define TEX_BIND_L0_TEX FEAT_L0_tex
#define TEX_BIND_L0_POS FEAT_L0_pos
#define TEX_BIND_L0_SIZE FEAT_L0_size
#define TEX_BIND_L0_PT FEAT_L0_pt

#define TEX_BIND_L1_TEXOFF FEAT_L1_texOff
#define TEX_BIND_L1_TEX FEAT_L1_tex
#define TEX_BIND_L1_POS FEAT_L1_pos
#define TEX_BIND_L1_SIZE FEAT_L1_size
#define TEX_BIND_L1_PT FEAT_L1_pt

const float kernels[288] = float[288](
  -0.1164546f, -0.1099012f, +0.2465308f, +0.0116580f, -0.2889438f, -0.3196897f, -0.2178988f, +0.2891290f,
  -0.1322607f, -0.1136399f, +0.0935737f, -0.3361007f, +0.1323134f, +0.0220410f, +0.0614446f, +0.2523549f,
  +0.2893431f, +0.0443534f, -0.2604700f, +0.2490542f, +0.1474054f, +0.0461863f, -0.1069158f, -0.0472161f,
  -0.1290125f, -0.2864269f, -0.1498014f, -0.1092429f, +0.0507471f, +0.1673688f, +0.0563756f, +0.0398938f,
  +0.1666581f, +0.1740837f, -0.2800103f, +0.0482442f, -0.0659746f, +0.4529901f, +0.2446423f, +0.0108673f,
  +0.2861765f, -0.3207931f, +0.1720544f, -0.1042953f, -0.1957929f, -0.1018998f, -0.0809954f, -0.5831490f,
  +0.1558632f, -0.2813401f, -0.3078012f, -0.0352266f, -0.0786602f, +0.1951695f, -0.2542518f, -0.1427916f,
  +0.2819057f, -0.3334494f, -0.0295193f, -0.3664719f, +0.0114464f, +0.0423694f, -0.0618812f, -0.3355591f,
  +0.3048378f, -0.3093237f, +0.0878434f, +0.0042092f, -0.0971213f, +0.0352436f, -0.1342325f, -0.5831928f,
  -0.2211587f, +0.1160772f, +0.0340238f, +0.1224075f, -0.1884177f, -0.0616495f, +0.1186902f, +0.1602506f,
  -0.1292411f, +0.2711479f, +0.0162848f, +0.0903796f, +0.0179114f, -0.0409394f, -0.0151556f, +0.2668923f,
  +0.1239077f, -0.0068697f, -0.0134962f, +0.0532804f, -0.1307369f, -0.1753380f, +0.0655455f, -0.1759848f,
  +0.1308306f, -0.0526944f, +0.3066827f, -0.0337630f, -0.3025309f, +0.2609330f, +0.2132392f, +0.0549034f,
  +0.0025804f, -0.0315457f, +0.1462898f, -0.2896056f, -0.0916840f, -0.3577399f, +0.0147163f, +0.2523966f,
  +0.2067623f, -0.1241642f, +0.1289568f, +0.3423824f, -0.1115808f, +0.4518935f, +0.1930381f, +0.2161801f,
  +0.0025088f, -0.0275212f, +0.3482736f, +0.1456302f, -0.0641451f, -0.1919068f, +0.3099256f, -0.3631044f,
  +0.1425363f, -0.0499982f, +0.2945549f, -0.1285115f, +0.0927469f, +0.3787382f, +0.2343926f, -0.3344500f,
  +0.1199242f, -0.0548630f, +0.1632598f, +0.1311893f, -0.0550504f, +0.0565466f, +0.1357987f, +0.0150905f,
  -0.3661066f, +0.1218259f, +0.2195469f, -0.1756922f, +0.0432695f, -0.1920251f, -0.2419463f, +0.4282586f,
  -0.3426925f, -0.1422670f, -0.3664270f, +0.1160264f, +0.1962065f, +0.1323674f, -0.2674647f, +0.5259297f,
  +0.0375903f, +0.2878445f, -0.3441822f, +0.1837758f, +0.0755079f, +0.0718913f, +0.0439619f, +0.0001767f,
  -0.4432004f, -0.1194943f, -0.0638622f, +0.0993117f, +0.0683766f, +0.4583475f, +0.5736887f, -0.3318443f,
  -0.0380231f, +0.3577601f, -0.2906018f, -0.1034109f, -0.1197058f, +0.1076190f, +0.2679491f, -0.1715681f,
  -0.3196011f, -0.0491952f, +0.3692833f, -0.2147870f, -0.1196690f, +0.2640873f, +0.0115415f, -0.2013073f,
  +0.0915070f, +0.1735082f, -0.0320904f, +0.3845199f, -0.2179527f, -0.0221894f, -0.2290859f, +0.0255064f,
  +0.2086403f, +0.0748710f, +0.1700206f, +0.2147782f, -0.0986250f, +0.0294652f, -0.3144478f, -0.5843525f,
  -0.1879043f, -0.0683699f, -0.5576877f, +0.3751287f, +0.0721027f, +0.0316705f, -0.0072429f, +1.0946549f,
  -0.0865208f, +0.1702090f, -0.0182034f, -0.0142886f, -0.1299307f, +0.0488332f, +0.5914153f, -0.0391201f,
  +0.1988796f, -0.1663164f, +0.4718544f, -0.1996447f, -0.2869260f, -0.2058832f, +0.1309509f, +0.0143684f,
  -0.2047465f, +0.2816013f, -0.2726415f, +0.1158316f, -0.1008560f, -0.0656672f, +0.2413875f, +0.1029623f,
  +0.0536718f, +0.0996023f, +0.2263658f, +0.0813864f, -0.1065742f, -0.3989513f, +0.0343324f, +0.1482908f,
  +0.0825526f, -0.0222610f, -0.0362168f, +0.2788590f, -0.0460525f, +0.1439632f, +0.2054055f, -0.3477691f,
  -0.1196449f, -0.1552858f, +0.0993296f, +0.1962831f, -0.2481026f, -0.0493243f, +0.3645649f, +0.2541751f,
  -0.1004164f, +0.0646235f, -0.0534151f, -0.0360009f, -0.0058660f, +0.4109358f, +0.5508284f, +0.3458771f,
  +0.1452063f, -0.0471189f, +0.1109322f, +0.4506815f, +0.0697615f, +0.1042676f, +0.3512371f, -0.3908139f,
  +0.3176682f, -0.0879445f, -0.0172430f, -0.1388407f, -0.2014780f, -0.0732900f, +0.3210549f, +0.2180730f
);

const float biases[4] = float[4](
  +0.0267312f, +0.0583385f, -0.0374799f, +0.0432310f
);

vec4 hook() {
    const vec4 r[9][2] = vec4[9][2](
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 1.0f)))
    );

    float sum[4] = biases;
    for (int n = 0; n < 4; n++) {
        for (int i = 0; i < 9; i++) {
            const vec4 k0 = vec4(kernels[n * 8 * 9 + 8 * i + 0], kernels[n * 8 * 9 + 8 * i + 1], kernels[n * 8 * 9 + 8 * i + 2], kernels[n * 8 * 9 + 8 * i + 3]);
            const vec4 k1 = vec4(kernels[n * 8 * 9 + 8 * i + 4], kernels[n * 8 * 9 + 8 * i + 5], kernels[n * 8 * 9 + 8 * i + 6], kernels[n * 8 * 9 + 8 * i + 7]);
            sum[n] += (dot(k0, r[i][0]) + dot(k1, r[i][1]));
        }
    }

    return ACTIVE(vec4(sum[0], sum[1], sum[2], sum[3]));
}

//!HOOK LUMA
//!DESC ARNet b4 Layer1 L1
//!WHEN OUTPUT.w LUMA.w / 1.2 > OUTPUT.h LUMA.h / 1.2 > *
//!BIND FEAT_L0
//!BIND FEAT_L1
//!SAVE TMP1_L1
//!COMPONENTS 4

#define ACTIVE(v) (max(v, v * 0.2000000f))

#define TEX_BIND_L0_TEXOFF FEAT_L0_texOff
#define TEX_BIND_L0_TEX FEAT_L0_tex
#define TEX_BIND_L0_POS FEAT_L0_pos
#define TEX_BIND_L0_SIZE FEAT_L0_size
#define TEX_BIND_L0_PT FEAT_L0_pt

#define TEX_BIND_L1_TEXOFF FEAT_L1_texOff
#define TEX_BIND_L1_TEX FEAT_L1_tex
#define TEX_BIND_L1_POS FEAT_L1_pos
#define TEX_BIND_L1_SIZE FEAT_L1_size
#define TEX_BIND_L1_PT FEAT_L1_pt

const float kernels[288] = float[288](
  -0.2217757f, -0.0106480f, +0.0467177f, +0.0132087f, +0.0808525f, +0.0199011f, -0.1656473f, +0.1740845f,
  +0.1818035f, -0.1397796f, -0.1461107f, +0.0441227f, -0.0177041f, -0.1290529f, +0.1473990f, -0.0944871f,
  -0.0192833f, +0.0492044f, +0.0699948f, +0.0929249f, -0.0102427f, +0.2365812f, -0.0506910f, +0.0760462f,
  +0.1951329f, -0.0142256f, -0.0849336f, -0.0767561f, -0.2107161f, -0.0612241f, -0.3281068f, -0.1807507f,
  +0.2724485f, -0.0095564f, -0.5553077f, +0.1626662f, +0.1027899f, -0.5228001f, +0.0290943f, -0.5918837f,
  -0.0248393f, -0.1566235f, -0.0552723f, -0.0254374f, +0.1397536f, +0.3410272f, -0.0215356f, +0.0540774f,
  +0.2871900f, -0.0957048f, +0.1686525f, -0.2056852f, +0.3435881f, +0.0597233f, +0.2592089f, -0.1155753f,
  +0.1023833f, +0.0359265f, +0.3579397f, +0.0207091f, -0.1202840f, +0.3261301f, -0.1469804f, +0.0217128f,
  +0.1575772f, +0.0894275f, +0.1577340f, -0.0938000f, -0.1688129f, -0.2854526f, +0.1244093f, -0.3197174f,
  +0.0172294f, -0.4752364f, +0.1674666f, +0.2741333f, +0.0548235f, -0.0575885f, -0.4610974f, -0.0243428f,
  +0.0668176f, -0.2445511f, +0.0749105f, +0.1738199f, -0.1964222f, +0.0224820f, -0.3183611f, -0.1541156f,
  -0.0904824f, -0.0031953f, -0.0301457f, +0.0201197f, +0.1718635f, -0.1497905f, +0.0955141f, +0.0056916f,
  -0.0746778f, +0.0017573f, +0.2085975f, +0.1804141f, -0.2874771f, +0.1765987f, +0.0243674f, -0.1901424f,
  -0.0539624f, -0.3444478f, -0.2193141f, -0.1418778f, -0.1871274f, -0.0333435f, -0.0041219f, +0.4168168f,
  +0.0669858f, -0.0401725f, -0.0317710f, -0.0308316f, -0.3016431f, -0.1876272f, +0.3866315f, +0.0224923f,
  -0.2155136f, +0.5529296f, +0.2719656f, -0.0614259f, +0.2272570f, -0.2185542f, +0.0806046f, -0.2088844f,
  +0.0394934f, +0.2729010f, -0.0951533f, +0.2681490f, +0.0974513f, -0.1460188f, -0.0014380f, +0.0639315f,
  +0.4360135f, +0.3368275f, -0.2364272f, +0.1442217f, +0.1462166f, +0.2086693f, +0.2668583f, +0.2861806f,
  -0.1757350f, -0.2289584f, +0.2507703f, -0.1591255f, +0.0726283f, +0.2408552f, +0.2467406f, -0.0163201f,
  -0.1912461f, +0.0991690f, +0.2761947f, -0.0582354f, +0.0485135f, +0.1560106f, +0.2274040f, +0.1333372f,
  +0.0764000f, -0.2348394f, +0.2443797f, -0.1988809f, +0.1214129f, +0.2849783f, +0.1217245f, +0.1460397f,
  +0.0402838f, +0.1553673f, +0.1146634f, -0.1349940f, +0.0707628f, +0.1241896f, -0.0502612f, -0.1572692f,
  +0.2686223f, -0.1341716f, +0.1095836f, -0.0195806f, +0.1675918f, -0.3245924f, +0.0551749f, +0.0560617f,
  -0.4942693f, -0.2745759f, +0.3777007f, -0.1262034f, -0.2460352f, +0.6175997f, +0.0700403f, -0.4295757f,
  +0.1705420f, -0.2280950f, +0.0453673f, -0.0529975f, -0.0108400f, -0.1570530f, -0.1816169f, -0.2717915f,
  +0.3236561f, -0.1869773f, +0.2681113f, -0.1101922f, -0.3771033f, +0.0122700f, +0.2388321f, -0.4199756f,
  +0.0693538f, -0.2581640f, +0.0856247f, -0.1345649f, -0.0189263f, +0.0030417f, +0.0547003f, +0.1073823f,
  -0.0263514f, -0.1247993f, +0.0112043f, -0.2700029f, +0.1252373f, +0.1746654f, +0.3856307f, -0.1282013f,
  -0.1044786f, -0.0916737f, +0.0566391f, +0.1150435f, -0.0783633f, +0.5008432f, +0.1881374f, +0.1199947f,
  +0.1867311f, -0.2704080f, -0.0578396f, -0.0153419f, +0.1176667f, +0.0423899f, +0.1093825f, -0.2227953f,
  +0.1286996f, -0.0160925f, +0.0444895f, +0.0942399f, +0.0140893f, +0.3701328f, +0.0371699f, -0.1305334f,
  +0.1959805f, +0.0738182f, +0.2313330f, -0.2929626f, -0.2784029f, -0.3187110f, -0.0529282f, -0.4923682f,
  +0.2099831f, -0.2504780f, +0.4144929f, +0.1065595f, -0.0801140f, +0.3792336f, +0.3434576f, +0.5428419f,
  -0.0450934f, +0.1873622f, +0.1066572f, +0.0421952f, +0.0702689f, -0.1135285f, -0.0413760f, -0.1239794f,
  +0.1787860f, -0.0521391f, +0.3031545f, -0.1168936f, +0.3589913f, -0.0432355f, +0.3080347f, -0.4151013f,
  -0.2989478f, -0.2329142f, +0.1732179f, +0.2286590f, -0.0556895f, +0.3114217f, +0.1534070f, +0.5048358f
);

const float biases[4] = float[4](
  +0.0253094f, +0.0172894f, +0.0279335f, +0.0759425f
);

vec4 hook() {
    const vec4 r[9][2] = vec4[9][2](
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 1.0f)))
    );

    float sum[4] = biases;
    for (int n = 0; n < 4; n++) {
        for (int i = 0; i < 9; i++) {
            const vec4 k0 = vec4(kernels[n * 8 * 9 + 8 * i + 0], kernels[n * 8 * 9 + 8 * i + 1], kernels[n * 8 * 9 + 8 * i + 2], kernels[n * 8 * 9 + 8 * i + 3]);
            const vec4 k1 = vec4(kernels[n * 8 * 9 + 8 * i + 4], kernels[n * 8 * 9 + 8 * i + 5], kernels[n * 8 * 9 + 8 * i + 6], kernels[n * 8 * 9 + 8 * i + 7]);
            sum[n] += (dot(k0, r[i][0]) + dot(k1, r[i][1]));
        }
    }

    return ACTIVE(vec4(sum[0], sum[1], sum[2], sum[3]));
}

//!HOOK LUMA
//!DESC ARNet b4 Layer2 L0
//!WHEN OUTPUT.w LUMA.w / 1.2 > OUTPUT.h LUMA.h / 1.2 > *
//!BIND TMP1_L0
//!BIND TMP1_L1
//!BIND FEAT_L0
//!SAVE TMP2_L0
//!COMPONENTS 4

#define ACTIVE(v) (v)

#define TEX_BIND_L0_TEXOFF TMP1_L0_texOff
#define TEX_BIND_L0_TEX TMP1_L0_tex
#define TEX_BIND_L0_POS TMP1_L0_pos
#define TEX_BIND_L0_SIZE TMP1_L0_size
#define TEX_BIND_L0_PT TMP1_L0_pt

#define TEX_BIND_L1_TEXOFF TMP1_L1_texOff
#define TEX_BIND_L1_TEX TMP1_L1_tex
#define TEX_BIND_L1_POS TMP1_L1_pos
#define TEX_BIND_L1_SIZE TMP1_L1_size
#define TEX_BIND_L1_PT TMP1_L1_pt

#define TEX_BIND_L2_TEXOFF FEAT_L0_texOff
#define TEX_BIND_L2_TEX FEAT_L0_tex
#define TEX_BIND_L2_POS FEAT_L0_pos
#define TEX_BIND_L2_SIZE FEAT_L0_size
#define TEX_BIND_L2_PT FEAT_L0_pt

const float kernels[288] = float[288](
  +0.4907544f, +0.1363201f, -0.0417589f, +0.0800097f, +0.1784891f, -0.0909664f, +0.0851713f, -0.1023155f,
  -0.1320687f, +0.0209427f, +0.1141434f, +0.2036740f, +0.5135680f, -0.3211998f, +0.0700736f, -0.1839062f,
  -0.0161631f, -0.1986691f, +0.3021228f, -0.0486975f, +0.3143102f, -0.0022653f, -0.0476633f, -0.0329113f,
  +0.0503803f, -0.1246492f, +0.2730827f, -0.1879019f, -0.2328698f, +0.5155046f, +0.2557569f, +0.0916594f,
  -0.1513513f, +0.0407887f, +0.3476158f, +0.0709132f, -0.0523982f, +0.6735116f, -0.1931728f, +0.0955105f,
  -0.0146824f, -0.1769609f, +0.2777190f, -0.2083068f, -0.0812414f, +0.2820747f, -0.0714260f, +0.3710928f,
  +0.1242941f, +0.1493223f, +0.2255237f, +0.1848019f, +0.0843130f, -0.3196318f, -0.1549963f, -0.1526441f,
  -0.2077088f, -0.2949874f, +0.3101763f, -0.0202396f, +0.0304207f, +0.1056218f, -0.1764487f, -0.0141397f,
  +0.1045830f, -0.2879733f, +0.1694352f, -0.0386330f, -0.0482605f, -0.2384235f, -0.1669946f, +0.0462706f,
  +0.1527130f, +0.0779544f, -0.2420615f, +0.2265797f, +0.0388974f, +0.0153483f, +0.0415916f, +0.0673634f,
  +0.2959601f, +0.6663791f, -0.3242045f, +0.1171618f, +0.1733667f, +0.0004776f, +0.1312243f, -0.3266381f,
  -0.0703906f, +0.0393229f, -0.0596118f, +0.2395447f, +0.0783716f, -0.0496905f, +0.1320447f, -0.1665831f,
  +0.1916629f, +0.1183001f, -0.2109128f, +0.1641802f, +0.0477123f, +0.3209063f, -0.1279425f, +0.0272203f,
  +0.0834090f, -0.3042520f, -0.1777933f, -0.0979785f, +0.2920326f, -0.0968794f, +0.4047761f, -0.5215641f,
  +0.0711457f, -0.2128988f, -0.0014816f, -0.3568130f, +0.1903200f, -0.2883439f, +0.1738885f, +0.0013203f,
  +0.1717950f, +0.0584661f, -0.1306915f, +0.0970123f, -0.2069279f, +0.0926368f, -0.0819378f, +0.1096712f,
  +0.2535838f, -0.3238764f, -0.0810522f, +0.1922065f, +0.1454903f, +0.1749422f, +0.1282112f, -0.1825248f,
  -0.0551915f, +0.0916251f, -0.0176336f, +0.0233880f, +0.1724328f, +0.1174544f, -0.1618383f, -0.0190622f,
  -0.1105550f, -0.2038949f, +0.5219251f, -0.0049081f, +0.0181712f, -0.0863383f, -0.0161815f, -0.4031689f,
  -0.3653883f, +0.1355174f, +0.5040460f, +0.0870763f, +0.0981302f, -0.2299765f, +0.2517247f, -0.0099806f,
  +0.1325560f, -0.0161676f, -0.0045284f, -0.1893260f, +0.1327952f, +0.0410679f, -0.2094345f, +0.1231440f,
  +0.2495379f, -0.0079366f, -0.0504877f, +0.2705135f, +0.1008527f, -0.0069609f, +0.3999346f, -0.7575792f,
  +0.2949587f, -0.2459648f, -0.1023222f, +0.5091566f, -0.2683133f, -0.3778322f, +0.1753657f, -0.3140783f,
  +0.2711009f, -0.1327175f, +0.0584672f, -0.2046682f, +0.2060458f, +0.2561455f, +0.2653822f, -0.1613292f,
  -0.0635875f, +0.2022433f, -0.0779822f, +0.0573953f, -0.2186316f, +0.0562185f, +0.3153837f, -0.2013921f,
  +0.0774821f, -0.2988759f, +0.0508963f, -0.0537024f, +0.1023764f, +0.1520312f, -0.0350140f, -0.2792598f,
  -0.2402196f, -0.2575644f, +0.0726303f, -0.1388763f, +0.2085693f, -0.0868590f, -0.1109943f, +0.1623673f,
  +0.2507313f, -0.2896694f, -0.2331833f, +0.1251636f, +0.0255410f, -0.0768535f, +0.1050781f, +0.1830504f,
  -0.1041901f, +0.4079316f, -0.4261200f, -0.1145552f, +0.0475006f, -0.1014024f, +0.0988065f, -0.0186191f,
  -0.1676312f, +0.1683142f, -0.1885306f, -0.0552999f, +0.0000414f, -0.0803402f, +0.0780548f, -0.1531126f,
  -0.3401137f, -0.2424090f, -0.1447604f, +0.0403017f, -0.1463702f, -0.0370730f, -0.4257570f, -0.1218580f,
  -0.2589765f, -0.3058801f, -0.0708467f, +0.0982253f, +0.2877691f, -0.0562339f, +0.1011246f, +0.1488776f,
  +0.3477834f, -0.0882904f, +0.0435196f, -0.3378389f, +0.1567816f, -0.0519989f, +0.0908018f, -0.0508570f,
  -0.0552290f, +0.1366960f, +0.0308427f, +0.0344503f, -0.0783089f, +0.1535994f, +0.0813856f, -0.1146273f,
  -0.0812265f, -0.0982126f, +0.0490392f, -0.3011799f, +0.0712873f, +0.4445368f, -0.0129631f, +0.0226627f,
  +0.1468481f, +0.0119393f, -0.0345518f, +0.0609288f, +0.0275895f, -0.3709693f, -0.0161489f, -0.0950675f
);

const float biases[4] = float[4](
  +0.0670244f, -0.0606961f, +0.0079177f, +0.0508173f
);

vec4 hook() {
    const vec4 r[9][2] = vec4[9][2](
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 1.0f)))
    );

    float sum[4] = biases;
    for (int n = 0; n < 4; n++) {
        for (int i = 0; i < 9; i++) {
            const vec4 k0 = vec4(kernels[n * 8 * 9 + 8 * i + 0], kernels[n * 8 * 9 + 8 * i + 1], kernels[n * 8 * 9 + 8 * i + 2], kernels[n * 8 * 9 + 8 * i + 3]);
            const vec4 k1 = vec4(kernels[n * 8 * 9 + 8 * i + 4], kernels[n * 8 * 9 + 8 * i + 5], kernels[n * 8 * 9 + 8 * i + 6], kernels[n * 8 * 9 + 8 * i + 7]);
            sum[n] += (dot(k0, r[i][0]) + dot(k1, r[i][1]));
        }
    }

    return ACTIVE(vec4(sum[0], sum[1], sum[2], sum[3]) * 0.2000000f + TEX_BIND_L2_TEXOFF(vec2(0.0f, 0.0f)));
}

//!HOOK LUMA
//!DESC ARNet b4 Layer2 L1
//!WHEN OUTPUT.w LUMA.w / 1.2 > OUTPUT.h LUMA.h / 1.2 > *
//!BIND TMP1_L0
//!BIND TMP1_L1
//!BIND FEAT_L1
//!SAVE TMP2_L1
//!COMPONENTS 4

#define ACTIVE(v) (v)

#define TEX_BIND_L0_TEXOFF TMP1_L0_texOff
#define TEX_BIND_L0_TEX TMP1_L0_tex
#define TEX_BIND_L0_POS TMP1_L0_pos
#define TEX_BIND_L0_SIZE TMP1_L0_size
#define TEX_BIND_L0_PT TMP1_L0_pt

#define TEX_BIND_L1_TEXOFF TMP1_L1_texOff
#define TEX_BIND_L1_TEX TMP1_L1_tex
#define TEX_BIND_L1_POS TMP1_L1_pos
#define TEX_BIND_L1_SIZE TMP1_L1_size
#define TEX_BIND_L1_PT TMP1_L1_pt

#define TEX_BIND_L2_TEXOFF FEAT_L1_texOff
#define TEX_BIND_L2_TEX FEAT_L1_tex
#define TEX_BIND_L2_POS FEAT_L1_pos
#define TEX_BIND_L2_SIZE FEAT_L1_size
#define TEX_BIND_L2_PT FEAT_L1_pt

const float kernels[288] = float[288](
  +0.1994450f, +0.1379317f, -0.1763521f, +0.1641108f, -0.0357392f, -0.2049026f, +0.2256702f, -0.4397838f,
  +0.1097154f, +0.2596892f, -0.2163688f, +0.1294644f, +0.3840782f, -0.0785286f, +0.1908504f, -0.0434724f,
  +0.1913289f, +0.0331685f, -0.2594315f, +0.3458588f, -0.2429908f, +0.0953679f, +0.1789650f, -0.0857008f,
  +0.3113638f, +0.0037317f, +0.0652659f, +0.0684055f, -0.0007655f, +0.4452377f, -0.0538501f, -0.1235388f,
  +0.6377530f, +0.1264334f, -0.2596258f, -0.4241567f, +0.2896520f, +0.1419851f, +0.1638951f, -0.0106163f,
  -0.0331667f, +0.2031578f, -0.4776452f, +0.0478140f, +0.1402006f, +0.2827680f, +0.1502591f, -0.3300973f,
  -0.1054454f, +0.1154206f, +0.1285948f, +0.0700707f, +0.0802829f, +0.0027081f, +0.1400073f, -0.1832439f,
  +0.3298976f, +0.0129925f, -0.0517288f, +0.2094675f, +0.2450107f, +0.2934477f, -0.4995261f, -0.2095751f,
  +0.2506691f, +0.3143052f, -0.1597243f, +0.1724096f, +0.1083193f, +0.1397563f, -0.0683700f, -0.0107344f,
  +0.2392961f, +0.0611726f, -0.2426641f, +0.2989401f, -0.0217669f, +0.2882885f, +0.0912290f, +0.0954959f,
  -0.1063412f, -0.2859719f, -0.0559253f, -0.0802742f, -0.4497912f, -0.0622072f, +0.1172007f, +0.0182517f,
  -0.1679202f, -0.0088394f, -0.1990354f, -0.2271283f, +0.0046683f, -0.0440435f, -0.0018832f, +0.0137164f,
  -0.1869511f, +0.1760337f, -0.4124499f, +0.2855887f, -0.2001480f, +0.0699903f, +0.2171341f, -0.0945854f,
  -0.1066729f, -0.4870207f, +0.0300075f, +0.4111214f, +0.2200648f, +0.0574722f, -0.0595162f, +0.2162050f,
  -0.0487035f, +0.1503330f, -0.3077500f, +0.0012036f, -0.2189541f, +0.2514482f, +0.0025164f, -0.1032719f,
  +0.2850908f, +0.0853785f, -0.2007463f, -0.0054391f, -0.1184254f, +0.1608133f, -0.0631791f, +0.2070712f,
  +0.0177909f, -0.0743722f, -0.1966213f, -0.0669861f, +0.0634123f, -0.1802821f, +0.0783767f, +0.1282333f,
  -0.2489059f, +0.1001073f, -0.1390546f, -0.0792065f, -0.2349690f, +0.2316447f, +0.0442874f, -0.0804323f,
  -0.0051612f, -0.0717190f, +0.0120202f, -0.1059364f, +0.0030685f, -0.1756589f, +0.0271589f, -0.2656228f,
  -0.0080755f, -0.3223092f, +0.1628604f, -0.0535665f, +0.2746485f, -0.3325011f, +0.0942968f, +0.1594449f,
  +0.1852425f, +0.1388144f, -0.1606291f, +0.2505523f, -0.1795862f, +0.3000695f, +0.2743829f, -0.1157597f,
  -0.1304729f, +0.1636012f, +0.3591163f, -0.1391639f, +0.0835955f, +0.0756334f, +0.0832963f, +0.0482306f,
  +0.2369668f, +0.2580831f, -0.1043247f, -0.0546374f, -0.0534864f, +0.7325855f, -0.3004943f, +0.0919274f,
  -0.1104716f, +0.1399546f, -0.3477128f, +0.2605133f, -0.0935820f, +0.0893845f, -0.0234320f, -0.2393817f,
  -0.0566829f, -0.0243433f, +0.1860087f, +0.1185265f, +0.3153641f, -0.2070329f, -0.2802499f, -0.2513888f,
  -0.5430506f, +0.2897564f, +0.0137733f, +0.0003161f, -0.0203105f, -0.1389377f, +0.0022435f, +0.0185353f,
  +0.1419410f, +0.2197383f, -0.1804339f, +0.2104242f, +0.0841950f, +0.0379532f, +0.0851251f, -0.0315202f,
  +0.1993136f, -0.1084962f, -0.0459264f, -0.1256271f, -0.0215020f, -0.0685601f, +0.1773578f, +0.1486571f,
  +0.2347281f, -0.1521522f, +0.1849594f, -0.0130913f, +0.0767873f, -0.1352567f, +0.1140189f, -0.0212458f,
  +0.0042637f, +0.1136255f, +0.2362717f, +0.1951735f, +0.0598485f, +0.0129088f, +0.0460040f, -0.1414718f,
  +0.1974059f, -0.0390423f, -0.1042810f, +0.0995210f, -0.0975630f, +0.0166123f, +0.2175481f, -0.3486917f,
  -0.1239920f, -0.2053792f, -0.4367374f, -0.3338903f, +0.2677543f, -0.0398821f, +0.2394180f, +0.0093003f,
  +0.0884231f, -0.2213584f, -0.0987360f, -0.2370119f, +0.0371897f, +0.2256187f, -0.0371159f, +0.0133904f,
  -0.0087706f, +0.0848886f, -0.0471327f, +0.0606515f, +0.0380854f, +0.0794418f, +0.0364527f, -0.0983068f,
  -0.1418979f, -0.1960568f, -0.1918628f, -0.1344117f, +0.1129713f, +0.1489588f, -0.0030053f, -0.0077672f,
  -0.0679380f, +0.1140584f, +0.0130813f, +0.1724166f, -0.0089934f, -0.0473387f, +0.0105386f, -0.0838224f
);

const float biases[4] = float[4](
  -0.0209272f, -0.0547443f, -0.0389659f, -0.0442719f
);

vec4 hook() {
    const vec4 r[9][2] = vec4[9][2](
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 1.0f)))
    );

    float sum[4] = biases;
    for (int n = 0; n < 4; n++) {
        for (int i = 0; i < 9; i++) {
            const vec4 k0 = vec4(kernels[n * 8 * 9 + 8 * i + 0], kernels[n * 8 * 9 + 8 * i + 1], kernels[n * 8 * 9 + 8 * i + 2], kernels[n * 8 * 9 + 8 * i + 3]);
            const vec4 k1 = vec4(kernels[n * 8 * 9 + 8 * i + 4], kernels[n * 8 * 9 + 8 * i + 5], kernels[n * 8 * 9 + 8 * i + 6], kernels[n * 8 * 9 + 8 * i + 7]);
            sum[n] += (dot(k0, r[i][0]) + dot(k1, r[i][1]));
        }
    }

    return ACTIVE(vec4(sum[0], sum[1], sum[2], sum[3]) * 0.2000000f + TEX_BIND_L2_TEXOFF(vec2(0.0f, 0.0f)));
}

//!HOOK LUMA
//!DESC ARNet b4 Layer3 L0
//!WHEN OUTPUT.w LUMA.w / 1.2 > OUTPUT.h LUMA.h / 1.2 > *
//!BIND TMP2_L0
//!BIND TMP2_L1
//!SAVE TMP1_L0
//!COMPONENTS 4

#define ACTIVE(v) (max(v, v * 0.2000000f))

#define TEX_BIND_L0_TEXOFF TMP2_L0_texOff
#define TEX_BIND_L0_TEX TMP2_L0_tex
#define TEX_BIND_L0_POS TMP2_L0_pos
#define TEX_BIND_L0_SIZE TMP2_L0_size
#define TEX_BIND_L0_PT TMP2_L0_pt

#define TEX_BIND_L1_TEXOFF TMP2_L1_texOff
#define TEX_BIND_L1_TEX TMP2_L1_tex
#define TEX_BIND_L1_POS TMP2_L1_pos
#define TEX_BIND_L1_SIZE TMP2_L1_size
#define TEX_BIND_L1_PT TMP2_L1_pt

const float kernels[288] = float[288](
  -0.1608732f, -0.3151892f, -0.0142047f, -0.2379599f, +0.2416186f, -0.1770693f, -0.0557807f, -0.0703106f,
  +0.0698914f, -0.0731130f, +0.6450166f, -0.4730085f, +0.0654336f, -0.5338295f, -0.1174917f, +0.0820074f,
  +0.2883287f, -0.1956740f, +0.2373573f, -0.0931187f, +0.0074246f, -0.0393162f, +0.0635882f, +0.0558747f,
  +0.1854441f, -0.3029200f, +0.5162131f, -0.3984278f, +0.1400695f, -0.0677180f, -0.2305604f, +0.1977624f,
  -0.0253694f, -0.3968548f, +0.3297859f, +0.0648253f, +0.1122678f, +0.1627667f, -0.0967637f, +0.1551075f,
  -0.0777239f, -0.3893622f, +0.1213020f, +0.0717731f, -0.0306611f, -0.1357002f, -0.2147537f, +0.1731919f,
  -0.0371460f, +0.2723772f, -0.0211428f, -0.1327494f, -0.0800774f, -0.2064654f, +0.0278308f, -0.2202676f,
  +0.0109759f, +0.0816135f, +0.0929019f, +0.4787876f, -0.2009619f, +0.1926376f, -0.1745735f, -0.3919762f,
  +0.3497529f, +0.1776954f, -0.0258894f, -0.0381888f, -0.0110552f, -0.0884409f, +0.0518155f, -0.1515257f,
  -0.2210490f, +0.3793653f, -0.1660352f, +0.1356862f, +0.1281626f, -0.0314935f, +0.2306145f, +0.1271646f,
  -0.1152133f, +0.3953908f, -0.4209546f, +0.4005983f, -0.2910706f, -0.3101774f, +0.1261877f, +0.1764522f,
  -0.4948272f, +0.0884551f, -0.0856505f, +0.1528975f, -0.0100719f, +0.5475304f, +0.0905047f, -0.0586297f,
  +0.6102685f, +0.2627892f, -0.0719076f, +0.0861630f, +0.1070775f, +0.4819811f, -0.3420576f, -0.1831786f,
  -0.6743878f, +0.7340468f, +0.2971283f, +0.2610276f, +0.1488441f, -0.6380018f, +0.1765612f, +0.3177830f,
  -0.3873219f, +0.0894041f, -0.6734134f, +0.2073751f, -0.5326775f, +0.1430989f, +0.7789807f, +0.0001202f,
  -0.3103700f, +0.1641428f, +0.2653269f, +0.0348154f, -0.1339424f, +0.1726725f, +0.4363260f, -0.0969249f,
  +0.3854249f, +0.8577021f, +0.0443365f, +0.1766128f, +0.0259454f, +0.6979554f, -0.3289209f, +0.2031793f,
  +0.8381840f, +1.0516714f, -0.2464644f, +0.2729478f, +0.4430731f, -0.1420833f, +0.1338094f, +0.1067546f,
  -0.2329065f, -0.2574780f, +0.1730854f, +0.1280146f, +0.1184371f, +0.2699926f, -0.0591788f, +0.2373378f,
  +0.0464330f, -0.0212516f, +0.2780050f, -0.2754775f, -0.3125598f, +0.3238091f, +0.0311602f, +0.0631439f,
  +0.1268469f, +0.4480991f, -0.0081824f, -0.1081137f, +0.2006408f, -0.1327017f, +0.2553650f, -0.1040929f,
  +0.2643349f, -0.1463596f, -0.3041078f, -0.0254131f, +0.0142990f, -0.2758793f, -0.7544273f, -0.3503982f,
  -0.2649094f, -0.2084153f, -0.8231774f, -0.3124065f, -0.1536472f, -0.2206854f, -0.5551437f, -0.1625238f,
  -1.2830621f, -0.2626907f, -0.7145237f, -0.0023339f, -0.0735820f, +0.6109734f, -0.2867529f, +0.3108757f,
  -0.5229572f, -0.2111832f, +0.1103589f, +0.0811641f, -0.0737632f, +0.0906251f, +0.3305622f, -0.0150729f,
  +0.0124963f, -0.1120043f, +0.0378728f, +0.0854519f, +0.2954976f, +0.3296395f, -0.0851533f, -0.1063980f,
  +0.4175052f, +0.3638516f, -0.0083855f, +0.1433194f, +0.3443874f, +0.6036915f, +0.0333916f, +0.2283077f,
  -0.1369856f, +0.3053702f, +0.1690221f, +0.1647504f, -0.0937479f, +0.1656133f, +0.0882926f, +0.0772263f,
  -0.0915391f, -0.0423834f, -0.3506793f, +0.1114073f, -0.0355628f, +0.3763088f, +0.1255040f, +0.0533137f,
  -0.1514784f, -0.2221822f, -0.0510110f, -0.0013022f, +0.0225319f, +0.2194843f, -0.1357903f, +0.0530125f,
  +0.2053749f, +0.0935229f, -0.1600446f, +0.0633692f, -0.3824741f, -0.2114976f, -0.4138345f, +0.0429830f,
  -0.0573058f, -0.2906005f, -0.1364545f, +0.6201295f, +0.2144512f, -0.3544674f, -1.0915538f, +0.2506310f,
  +0.2268609f, +0.2318272f, -0.5649591f, +0.0151249f, +0.3668728f, +0.1467517f, -0.1237471f, -0.1936188f,
  -0.1279143f, +0.1082322f, +0.1153113f, +0.0954226f, -0.0354416f, -0.0023016f, +0.0480007f, -0.2160942f,
  -0.3231640f, -0.1479704f, +0.2782531f, +0.1742907f, +0.2040946f, +0.6674067f, +0.1766778f, -0.4745946f,
  +0.2837405f, +0.0983331f, +0.3642847f, +0.1296036f, -0.0420086f, +0.1640289f, +0.3896225f, +0.3615471f
);

const float biases[4] = float[4](
  +0.0291110f, -0.0684870f, -0.0370110f, -0.0106820f
);

vec4 hook() {
    const vec4 r[9][2] = vec4[9][2](
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 1.0f)))
    );

    float sum[4] = biases;
    for (int n = 0; n < 4; n++) {
        for (int i = 0; i < 9; i++) {
            const vec4 k0 = vec4(kernels[n * 8 * 9 + 8 * i + 0], kernels[n * 8 * 9 + 8 * i + 1], kernels[n * 8 * 9 + 8 * i + 2], kernels[n * 8 * 9 + 8 * i + 3]);
            const vec4 k1 = vec4(kernels[n * 8 * 9 + 8 * i + 4], kernels[n * 8 * 9 + 8 * i + 5], kernels[n * 8 * 9 + 8 * i + 6], kernels[n * 8 * 9 + 8 * i + 7]);
            sum[n] += (dot(k0, r[i][0]) + dot(k1, r[i][1]));
        }
    }

    return ACTIVE(vec4(sum[0], sum[1], sum[2], sum[3]));
}

//!HOOK LUMA
//!DESC ARNet b4 Layer3 L1
//!WHEN OUTPUT.w LUMA.w / 1.2 > OUTPUT.h LUMA.h / 1.2 > *
//!BIND TMP2_L0
//!BIND TMP2_L1
//!SAVE TMP1_L1
//!COMPONENTS 4

#define ACTIVE(v) (max(v, v * 0.2000000f))

#define TEX_BIND_L0_TEXOFF TMP2_L0_texOff
#define TEX_BIND_L0_TEX TMP2_L0_tex
#define TEX_BIND_L0_POS TMP2_L0_pos
#define TEX_BIND_L0_SIZE TMP2_L0_size
#define TEX_BIND_L0_PT TMP2_L0_pt

#define TEX_BIND_L1_TEXOFF TMP2_L1_texOff
#define TEX_BIND_L1_TEX TMP2_L1_tex
#define TEX_BIND_L1_POS TMP2_L1_pos
#define TEX_BIND_L1_SIZE TMP2_L1_size
#define TEX_BIND_L1_PT TMP2_L1_pt

const float kernels[288] = float[288](
  -0.1861771f, +0.0854195f, +0.5905285f, -0.0650820f, +0.6390932f, +0.5388126f, -0.0052509f, -0.1450580f,
  -0.6960860f, +0.1299631f, +0.0295920f, -0.2402163f, +0.0593873f, +0.8810973f, -0.1364281f, +0.4517821f,
  +0.1983950f, -0.2203306f, -0.4594183f, +0.1129785f, +0.4395522f, -0.1056737f, -0.3823010f, +0.1868747f,
  -0.4416722f, -0.6706495f, +0.0318317f, -0.2834586f, +0.5642154f, +1.1486578f, +0.5876445f, -0.4668721f,
  +0.3534691f, -0.4398876f, +0.1310102f, -0.0114693f, -0.0924817f, -0.5369378f, -0.1957202f, -0.2780860f,
  -0.2455369f, -0.2538589f, -0.4537244f, +0.0278217f, +0.4608749f, -0.0527667f, -0.9612443f, +0.1451702f,
  -0.1421501f, -0.5793072f, -0.2340698f, -0.0775439f, -0.3503173f, -0.1727498f, -0.2137442f, -0.1987437f,
  -0.2300146f, -0.5702378f, -0.5566705f, +0.1265958f, +0.0393122f, +0.2953054f, -0.2317269f, +0.2782558f,
  -0.2111055f, +0.0827536f, +0.1494284f, +0.1393013f, -0.0760140f, +0.0019729f, +0.1670625f, -0.3040484f,
  +0.2758263f, -0.4473279f, +0.1738258f, -0.2287239f, +0.0226823f, -0.2974935f, -0.2746212f, -0.1621466f,
  +0.2053339f, -0.0190736f, +0.2029853f, +0.0123773f, -0.1615190f, -0.3442582f, -0.2781218f, -0.1460735f,
  -0.0541397f, -0.0781884f, -0.0028107f, +0.0025324f, -0.0962104f, +0.0725448f, +0.0332854f, +0.1250430f,
  -0.1538404f, +0.2727071f, +0.1667174f, -0.1009316f, +0.0928636f, +0.0628434f, +0.5184747f, +0.2539325f,
  -0.2656476f, -0.4090262f, +0.5032665f, -0.2510163f, -0.2945563f, +0.4287136f, +0.2527964f, -0.0644382f,
  +0.2646249f, +0.2657523f, +0.6108213f, -0.3791147f, +0.1302816f, -0.2685613f, +0.1494312f, -0.0940185f,
  +0.0287715f, -0.1578850f, -0.2617961f, -0.2020869f, +0.2989217f, -0.2764593f, -0.3430096f, -0.0099673f,
  -0.3848889f, -0.7209044f, -0.0984942f, -0.5163164f, -0.4184721f, -0.7114899f, +0.3764830f, +0.0048087f,
  -0.2860414f, -0.2640767f, -0.2517399f, +0.1092803f, +0.1337379f, -0.2871709f, -0.5806500f, -0.1759847f,
  +0.2108690f, -0.5257618f, -0.1251881f, +0.0125282f, +0.0551457f, +0.2019563f, -0.2427898f, -0.2746763f,
  +0.7692157f, -0.1734707f, -0.1575967f, +0.1360387f, -0.4484989f, +0.1180381f, -0.1007663f, -0.2757803f,
  +0.3430284f, -0.1237347f, -0.2160371f, +0.0869516f, +0.1548657f, +0.0308928f, +0.1422789f, -0.1425497f,
  -0.1084157f, -0.5745719f, +0.0429854f, +0.0236892f, -0.4292323f, -0.1332240f, +0.2102408f, +0.0309098f,
  -0.4744796f, -0.2071694f, -0.4282811f, +0.0775604f, -0.4475424f, +0.3630128f, -0.2078965f, +0.0681366f,
  -0.2738088f, +0.3110240f, +0.1067285f, -0.2063632f, +0.1017737f, -0.2743668f, -0.0633883f, +0.2642235f,
  +0.1783306f, -0.2481006f, +0.0699881f, +0.1635585f, +0.1035349f, +0.3510253f, -0.0321341f, -0.2135285f,
  +0.3070890f, -0.3818668f, -0.1144806f, -0.1600665f, -0.0909970f, -0.3282747f, -0.4626063f, -0.1168208f,
  -0.2307019f, -0.0137720f, +0.0788489f, +0.0051028f, -0.2774410f, -0.2917806f, +0.1588016f, -0.0916536f,
  -0.1494995f, -0.0412491f, +0.2595831f, -0.2277514f, +0.1691499f, -0.3672467f, -0.4218766f, +0.1510382f,
  -0.3761481f, -0.5153008f, -0.2749997f, +0.2606668f, -0.1848081f, -0.2530715f, -0.0690210f, +0.0432223f,
  +0.0167150f, -0.0480256f, +0.1510754f, +0.0557788f, -0.1991219f, -0.2212320f, +0.1956923f, +0.2114995f,
  -0.1266699f, +0.1082058f, -0.2385602f, -0.0280196f, -0.1747767f, +0.2597713f, +0.2975537f, +0.0563564f,
  -0.1855159f, +0.2323941f, +0.1526634f, +0.4272685f, -0.5969558f, +0.5420685f, +0.4280493f, +0.4479099f,
  -0.4140828f, -0.1173695f, +0.0903533f, +0.1475654f, -0.2437253f, -0.6361548f, +0.1364399f, -0.0587611f,
  +0.2044246f, -0.3730228f, +0.1056260f, -0.0866762f, -0.0946208f, +0.2946171f, -0.1128208f, -0.4681193f,
  -0.0981062f, -0.1852182f, +0.1188601f, +0.0525130f, +0.0275222f, -0.0783863f, -0.1534206f, -0.3007326f,
  -0.2094659f, -0.4461803f, +0.1602448f, -0.1124732f, -0.2188697f, -0.4206206f, +0.0706738f, +0.2193936f
);

const float biases[4] = float[4](
  -0.0061582f, +0.0426344f, +0.0127247f, +0.0573760f
);

vec4 hook() {
    const vec4 r[9][2] = vec4[9][2](
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 1.0f)))
    );

    float sum[4] = biases;
    for (int n = 0; n < 4; n++) {
        for (int i = 0; i < 9; i++) {
            const vec4 k0 = vec4(kernels[n * 8 * 9 + 8 * i + 0], kernels[n * 8 * 9 + 8 * i + 1], kernels[n * 8 * 9 + 8 * i + 2], kernels[n * 8 * 9 + 8 * i + 3]);
            const vec4 k1 = vec4(kernels[n * 8 * 9 + 8 * i + 4], kernels[n * 8 * 9 + 8 * i + 5], kernels[n * 8 * 9 + 8 * i + 6], kernels[n * 8 * 9 + 8 * i + 7]);
            sum[n] += (dot(k0, r[i][0]) + dot(k1, r[i][1]));
        }
    }

    return ACTIVE(vec4(sum[0], sum[1], sum[2], sum[3]));
}

//!HOOK LUMA
//!DESC ARNet b4 Layer4 L0
//!WHEN OUTPUT.w LUMA.w / 1.2 > OUTPUT.h LUMA.h / 1.2 > *
//!BIND TMP1_L0
//!BIND TMP1_L1
//!BIND TMP2_L0
//!SAVE TMP2_L0
//!COMPONENTS 4

#define ACTIVE(v) (v)

#define TEX_BIND_L0_TEXOFF TMP1_L0_texOff
#define TEX_BIND_L0_TEX TMP1_L0_tex
#define TEX_BIND_L0_POS TMP1_L0_pos
#define TEX_BIND_L0_SIZE TMP1_L0_size
#define TEX_BIND_L0_PT TMP1_L0_pt

#define TEX_BIND_L1_TEXOFF TMP1_L1_texOff
#define TEX_BIND_L1_TEX TMP1_L1_tex
#define TEX_BIND_L1_POS TMP1_L1_pos
#define TEX_BIND_L1_SIZE TMP1_L1_size
#define TEX_BIND_L1_PT TMP1_L1_pt

#define TEX_BIND_L2_TEXOFF TMP2_L0_texOff
#define TEX_BIND_L2_TEX TMP2_L0_tex
#define TEX_BIND_L2_POS TMP2_L0_pos
#define TEX_BIND_L2_SIZE TMP2_L0_size
#define TEX_BIND_L2_PT TMP2_L0_pt

const float kernels[288] = float[288](
  -0.2507392f, +0.0456869f, -0.0342095f, -0.9688456f, +0.1700013f, -0.2229085f, -0.0711522f, +0.0273598f,
  +0.5340551f, -0.2337657f, -0.1254297f, -0.0894186f, +0.9432583f, +0.0922803f, -0.0801489f, -0.1133993f,
  +0.3109376f, -0.1015761f, -0.1245967f, -0.0365907f, +0.0912640f, -0.1195565f, -0.1718341f, -0.3235593f,
  -0.1730797f, -0.5506095f, +0.2702722f, -0.3261338f, +0.2223810f, -0.2171025f, +0.1302781f, +0.1818918f,
  -0.2863456f, +0.4881324f, +0.2386560f, -0.5562562f, +0.1111238f, +0.0036251f, +0.3973843f, +0.7472055f,
  -0.2250524f, +0.0029127f, +0.0782083f, -0.0057961f, -0.0197282f, -0.2487037f, -0.1937084f, -0.1915078f,
  +0.2087950f, +0.1979844f, +0.0820767f, -0.4627959f, +0.1698343f, +0.1577688f, -0.2923702f, -0.2947351f,
  +0.4234286f, +0.0555693f, +0.2836825f, -0.2458881f, +1.1148254f, +0.3131139f, -0.5466082f, +0.3432015f,
  +0.4920340f, -0.1903310f, +0.1448076f, -0.2897355f, +0.1641195f, +0.1012893f, -0.3066521f, +0.3721755f,
  -0.2133309f, +0.1429962f, -0.0724906f, +0.0972526f, -0.1955815f, -0.2154216f, -0.0747128f, +0.1700820f,
  -0.4393879f, -0.3188222f, -0.0297045f, -0.1128365f, +0.1919926f, +0.0961184f, -0.0443215f, +0.3185858f,
  -0.1114348f, -0.1021958f, +0.0787690f, +0.0438321f, +0.0165095f, +0.0589905f, +0.0510465f, +0.0886406f,
  -0.0835439f, +0.1559620f, -0.0335676f, +0.3520861f, +0.0388552f, -0.0029977f, +0.0295693f, +0.1124323f,
  +0.0706950f, +0.3414215f, -0.1493338f, +0.5435702f, +0.3248896f, +0.8265404f, +0.1887821f, -0.3279991f,
  -0.2451307f, +0.0526465f, +0.0733920f, +0.1896450f, +0.0811606f, +0.0879993f, +0.0842625f, +0.1307717f,
  -0.1473482f, -0.2772546f, -0.0463630f, +0.2171581f, -0.0137067f, -0.1244285f, -0.0345938f, +0.1441518f,
  -0.1017845f, -0.0727511f, -0.5392511f, +0.2355492f, -0.3103865f, -0.0434105f, -0.0639500f, +0.3046523f,
  -0.2402910f, -0.0149227f, -0.0135094f, +0.1671315f, -0.0890733f, -0.2258329f, +0.1606901f, -0.0696175f,
  -0.0061004f, +0.3074638f, +0.0321076f, +0.2634445f, +0.1909681f, -0.0577205f, +0.1664280f, -0.0492769f,
  +0.1773296f, -0.2801202f, +0.1147925f, -0.5352163f, -0.4408109f, +0.3498359f, -0.5172138f, -0.3220300f,
  -0.3287268f, -0.3672307f, +0.0700016f, +0.0175896f, -0.0778493f, +0.1073476f, -0.1146389f, +0.0578000f,
  +0.0846816f, +0.1269287f, +0.2323509f, +0.1344604f, +0.4994226f, +0.1294597f, +0.1153736f, +0.2025770f,
  -0.1215174f, +0.5694953f, +0.0685053f, -0.6513273f, -0.8014377f, -0.0218555f, +0.3901752f, +0.6750642f,
  -0.4296598f, -0.6733042f, +0.1018452f, +0.3746308f, +0.4569767f, +0.9728903f, -0.6768305f, +0.3148539f,
  -0.0740647f, +0.4005885f, -0.0946687f, +0.3573372f, +0.1959274f, +0.2567183f, +0.2991330f, -0.2440140f,
  -0.4160728f, -0.0382501f, -0.0729288f, +0.4768380f, +0.0952266f, -0.0465214f, +0.1523725f, +0.0602694f,
  +0.0069734f, -0.2310995f, -0.3362971f, +0.3592266f, -0.6746264f, -0.1010744f, -0.0210179f, -0.2082438f,
  +0.0189299f, -0.1573926f, -0.0746066f, +0.1563201f, +0.1718905f, +0.0948123f, +0.1284490f, -0.0872227f,
  -0.2926854f, -0.1125202f, -0.0187128f, +0.0054642f, -0.0378678f, +0.0287175f, -0.0030742f, -0.0595902f,
  +0.1225777f, -0.1231255f, +0.0377384f, -0.2865213f, +0.0418739f, -0.0229762f, -0.2791876f, -0.0159001f,
  +0.0811242f, -0.2619773f, +0.0506858f, -0.3037459f, -0.0883118f, +0.2283692f, -0.0879619f, -0.0397660f,
  +0.0320265f, -0.2520061f, -0.1239191f, -0.4027621f, -0.1889853f, -0.5421666f, +0.1656882f, -0.2587996f,
  +0.0043718f, +0.0212180f, +0.1591311f, -0.1176781f, +0.6747638f, +0.1530989f, -0.1379789f, +0.1982193f,
  -0.0638592f, +0.0791771f, -0.1601879f, +0.1447567f, -0.1402421f, +0.0005165f, +0.2585894f, +0.0574046f,
  +0.0341864f, +0.2573309f, -0.0157379f, +0.0146984f, -0.0566960f, -0.0868145f, +0.0129966f, -0.2249519f,
  +0.0247025f, +0.1391890f, +0.2043413f, +0.0222550f, +0.0061156f, +0.2489121f, -0.0596334f, +0.1383568f
);

const float biases[4] = float[4](
  -0.0036572f, -0.0947209f, +0.0496114f, -0.0037542f
);

vec4 hook() {
    const vec4 r[9][2] = vec4[9][2](
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 1.0f)))
    );

    float sum[4] = biases;
    for (int n = 0; n < 4; n++) {
        for (int i = 0; i < 9; i++) {
            const vec4 k0 = vec4(kernels[n * 8 * 9 + 8 * i + 0], kernels[n * 8 * 9 + 8 * i + 1], kernels[n * 8 * 9 + 8 * i + 2], kernels[n * 8 * 9 + 8 * i + 3]);
            const vec4 k1 = vec4(kernels[n * 8 * 9 + 8 * i + 4], kernels[n * 8 * 9 + 8 * i + 5], kernels[n * 8 * 9 + 8 * i + 6], kernels[n * 8 * 9 + 8 * i + 7]);
            sum[n] += (dot(k0, r[i][0]) + dot(k1, r[i][1]));
        }
    }

    return ACTIVE(vec4(sum[0], sum[1], sum[2], sum[3]) * 0.2000000f + TEX_BIND_L2_TEXOFF(vec2(0.0f, 0.0f)));
}

//!HOOK LUMA
//!DESC ARNet b4 Layer4 L1
//!WHEN OUTPUT.w LUMA.w / 1.2 > OUTPUT.h LUMA.h / 1.2 > *
//!BIND TMP1_L0
//!BIND TMP1_L1
//!BIND TMP2_L1
//!SAVE TMP2_L1
//!COMPONENTS 4

#define ACTIVE(v) (v)

#define TEX_BIND_L0_TEXOFF TMP1_L0_texOff
#define TEX_BIND_L0_TEX TMP1_L0_tex
#define TEX_BIND_L0_POS TMP1_L0_pos
#define TEX_BIND_L0_SIZE TMP1_L0_size
#define TEX_BIND_L0_PT TMP1_L0_pt

#define TEX_BIND_L1_TEXOFF TMP1_L1_texOff
#define TEX_BIND_L1_TEX TMP1_L1_tex
#define TEX_BIND_L1_POS TMP1_L1_pos
#define TEX_BIND_L1_SIZE TMP1_L1_size
#define TEX_BIND_L1_PT TMP1_L1_pt

#define TEX_BIND_L2_TEXOFF TMP2_L1_texOff
#define TEX_BIND_L2_TEX TMP2_L1_tex
#define TEX_BIND_L2_POS TMP2_L1_pos
#define TEX_BIND_L2_SIZE TMP2_L1_size
#define TEX_BIND_L2_PT TMP2_L1_pt

const float kernels[288] = float[288](
  -0.1275136f, -0.1675392f, -0.0927775f, -0.3287772f, +0.0592836f, +0.1040334f, -0.1069235f, +0.2393507f,
  -0.3532653f, -0.0414820f, -0.2449828f, -0.4212442f, -0.2061344f, -0.1702257f, -0.0105794f, +0.2407385f,
  -0.7562578f, -0.0721932f, -0.0261612f, +0.1829325f, +0.2167136f, +0.4685636f, +0.0581721f, +0.2051702f,
  -0.1120742f, -0.0663365f, +0.0487220f, -0.0669643f, -0.0649154f, +0.1635344f, +0.0347400f, +0.1209619f,
  -0.6008858f, -0.8319252f, +0.4067243f, -0.1898450f, +0.0712200f, -0.6865668f, +0.4973620f, -0.1958415f,
  -0.3570686f, -0.3958415f, -0.2400538f, +0.6220066f, +0.4797208f, +0.0848331f, -0.1961971f, -0.1383047f,
  -0.0173145f, +0.2145843f, +0.0059721f, -0.1728636f, -0.0998411f, +0.1950467f, -0.1108260f, +0.1361094f,
  -0.0709431f, -0.4366228f, +0.0798069f, -0.1779723f, +0.6813431f, +0.1231820f, -0.1024231f, +0.0989203f,
  -0.2155537f, -0.0702936f, -0.2333283f, +0.1684313f, -0.5278933f, +0.1674490f, +0.1252561f, -0.0689257f,
  -0.2406409f, +0.0341372f, -0.1195233f, +0.0772191f, -0.1110340f, +0.0348179f, +0.0961196f, +0.3473437f,
  -0.1141014f, +0.2754567f, +0.1859962f, +0.4320072f, +0.1095637f, +0.3173549f, +0.1091576f, +0.0149594f,
  +0.1683066f, -0.0029188f, +0.0328059f, -0.2566770f, -0.3032288f, -0.1526269f, -0.1869794f, -0.2938841f,
  +0.1623310f, +0.8089131f, -0.0741677f, -0.0481262f, +0.4042143f, +0.5794240f, +0.1787706f, +0.1195911f,
  -0.2998533f, -0.1027501f, -0.6769562f, -0.4174420f, -0.2938305f, -0.2122805f, -0.2372473f, -0.1323856f,
  +0.0959244f, +0.1285568f, +0.0157242f, -0.1361867f, +0.0911247f, -0.0736085f, +0.2620479f, +0.1130509f,
  -0.3522544f, -0.1342737f, -0.4264514f, +0.3117889f, +0.0416232f, -0.2095025f, +0.0162984f, +0.3063746f,
  -0.2283453f, +0.0267173f, -0.0919134f, -0.0475647f, -0.7826636f, -0.3089260f, +0.4632289f, -0.3129882f,
  -0.1475308f, +0.1741007f, +0.1696150f, +0.0552738f, -0.2165936f, -0.0933908f, -0.0636561f, +0.1811577f,
  -0.0780382f, -0.1422362f, +0.0219128f, -0.2624872f, -0.0426797f, +0.1497007f, -0.3042805f, +0.2236433f,
  -0.2548583f, +0.2254878f, -0.0660915f, +0.1610556f, -0.2318849f, +0.0931388f, +0.2749434f, +0.0942755f,
  -0.4573616f, -0.0055787f, -0.0506849f, +0.3722432f, +0.0301381f, +0.4934755f, +0.1137357f, -0.0399984f,
  -0.0047558f, -0.3411590f, +0.2398809f, +0.2320488f, -0.1026596f, -0.1806442f, +0.0677999f, -0.0548307f,
  -0.1103192f, -1.0955040f, +0.3943180f, -0.0500583f, +0.0165881f, -0.2291484f, -0.1975909f, -0.1087994f,
  -0.1419129f, -0.1068457f, -0.4508190f, +0.3926598f, +0.0657653f, -0.3977645f, +0.3353321f, -0.2540206f,
  +0.2841813f, -0.0540320f, +0.1410460f, -0.4870200f, -0.0616837f, +0.2798971f, -0.3533715f, +0.1022354f,
  -0.0004449f, -0.4366939f, +0.1209102f, -0.2842528f, +0.5190036f, +0.1730532f, -0.0729017f, +0.1892241f,
  -0.1809044f, +0.0350875f, -0.1791374f, +0.0335034f, -0.3722142f, +0.0503205f, +0.1297603f, -0.0977029f,
  -0.0764475f, +0.8266124f, -0.0398911f, -0.4453588f, +0.1032327f, +0.1685399f, -0.0806987f, +0.0643262f,
  -0.0596477f, +0.0994482f, -0.2168221f, +0.2142347f, +0.4870837f, +0.3911897f, +0.0378459f, -0.2204309f,
  -0.1247467f, -0.2119737f, -0.0295276f, +0.0830233f, -0.0152775f, +0.2969629f, +0.0265229f, -0.3295053f,
  -0.1068586f, -0.2695196f, +0.0098677f, +0.3218515f, +0.4443369f, +0.1707553f, +0.1141621f, +0.2330661f,
  -0.4594691f, -0.2574149f, -0.4793660f, +0.5361928f, -0.4170901f, -0.4233567f, +0.7335391f, -0.3002873f,
  -0.2250634f, +0.0630948f, -0.2170151f, +0.2952383f, -0.1492584f, -0.6259922f, +0.1329440f, -0.1333781f,
  -0.0499247f, +0.0102979f, -0.2742014f, +0.1853156f, +0.3236829f, +0.0448933f, +0.1519842f, -0.0415800f,
  -0.2248822f, +0.1465681f, +0.0104969f, -0.2055320f, -0.1071705f, -0.0026082f, +0.2682820f, -0.0971959f,
  -0.1620151f, -0.0625953f, +0.1644570f, +0.0161858f, +0.0404050f, -0.0720373f, -0.0521743f, -0.0686074f
);

const float biases[4] = float[4](
  -0.0719551f, -0.0029618f, +0.0777424f, +0.0345687f
);

vec4 hook() {
    const vec4 r[9][2] = vec4[9][2](
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 1.0f)))
    );

    float sum[4] = biases;
    for (int n = 0; n < 4; n++) {
        for (int i = 0; i < 9; i++) {
            const vec4 k0 = vec4(kernels[n * 8 * 9 + 8 * i + 0], kernels[n * 8 * 9 + 8 * i + 1], kernels[n * 8 * 9 + 8 * i + 2], kernels[n * 8 * 9 + 8 * i + 3]);
            const vec4 k1 = vec4(kernels[n * 8 * 9 + 8 * i + 4], kernels[n * 8 * 9 + 8 * i + 5], kernels[n * 8 * 9 + 8 * i + 6], kernels[n * 8 * 9 + 8 * i + 7]);
            sum[n] += (dot(k0, r[i][0]) + dot(k1, r[i][1]));
        }
    }

    return ACTIVE(vec4(sum[0], sum[1], sum[2], sum[3]) * 0.2000000f + TEX_BIND_L2_TEXOFF(vec2(0.0f, 0.0f)));
}

//!HOOK LUMA
//!DESC ARNet b4 Layer5 L0
//!WHEN OUTPUT.w LUMA.w / 1.2 > OUTPUT.h LUMA.h / 1.2 > *
//!BIND TMP2_L0
//!BIND TMP2_L1
//!SAVE TMP1_L0
//!COMPONENTS 4

#define ACTIVE(v) (max(v, v * 0.2000000f))

#define TEX_BIND_L0_TEXOFF TMP2_L0_texOff
#define TEX_BIND_L0_TEX TMP2_L0_tex
#define TEX_BIND_L0_POS TMP2_L0_pos
#define TEX_BIND_L0_SIZE TMP2_L0_size
#define TEX_BIND_L0_PT TMP2_L0_pt

#define TEX_BIND_L1_TEXOFF TMP2_L1_texOff
#define TEX_BIND_L1_TEX TMP2_L1_tex
#define TEX_BIND_L1_POS TMP2_L1_pos
#define TEX_BIND_L1_SIZE TMP2_L1_size
#define TEX_BIND_L1_PT TMP2_L1_pt

const float kernels[288] = float[288](
  +0.3696223f, -0.1013149f, -0.2011942f, +0.1228349f, -0.2338663f, -0.0159530f, +0.1864330f, -0.1183944f,
  +0.1713613f, +0.6846234f, -0.0726603f, +0.0153373f, -0.6585424f, +0.0124163f, +0.7880303f, -0.0843284f,
  +0.1004376f, +0.3360542f, +0.1620215f, +0.2415482f, -0.2969754f, -0.2970658f, +0.3311320f, +0.0511168f,
  +0.2846204f, -0.4522539f, -0.1832591f, +0.2156479f, -0.0758579f, -0.2306529f, -0.5644699f, -0.0478931f,
  +0.5653874f, +0.5133526f, -0.4952354f, -0.1196375f, -0.1364853f, -0.7135947f, +0.5148613f, -0.1247982f,
  -0.1800574f, +0.2265127f, -0.2167597f, +0.1188490f, +0.1031700f, -0.0018861f, +0.1153489f, +0.0689584f,
  -0.1556240f, +0.1440868f, -0.0347289f, +0.0997188f, +0.0367846f, +0.0044258f, -0.1451863f, -0.0645380f,
  +0.1437093f, -0.3621947f, +0.4966556f, +0.0653983f, -0.0588138f, +0.5344315f, -0.0591217f, -0.0415574f,
  +0.1357400f, -0.2584480f, +0.0909321f, -0.1237035f, +0.0091844f, -0.0417415f, -0.0182355f, +0.0251321f,
  -0.0695296f, -0.0913918f, -0.0010664f, -0.0867471f, -0.2349939f, +0.3076547f, +0.0362168f, +0.1245151f,
  -0.2678225f, -0.7202873f, -0.2450000f, +0.0028439f, +0.0608244f, -0.0419939f, -0.0030557f, -0.0489117f,
  -0.0789859f, -0.4773488f, -0.0793217f, -0.1079895f, +0.2016646f, -0.0004972f, -0.1294438f, -0.1696221f,
  +0.0112966f, -0.4659067f, -0.5047709f, -0.2746398f, +0.1028033f, +0.0638200f, -0.0268578f, -0.2517760f,
  -0.1007401f, -1.0167536f, +0.0268565f, -0.2030364f, +0.3578257f, -0.3138016f, -0.1025059f, +0.3471537f,
  +0.7792100f, -0.1342960f, +0.3060578f, -0.0592353f, +0.1954080f, -0.2163060f, -0.0664922f, -0.0665091f,
  +0.0011742f, +0.0708933f, +0.5876204f, +0.1754365f, -0.1243926f, +0.3763052f, +0.0775049f, -0.4332059f,
  -0.2397053f, -0.4889140f, +0.4342389f, -0.1098813f, -0.2967421f, +0.0461894f, +0.0358160f, -0.3497450f,
  -0.1960698f, +0.0237321f, +0.0827982f, +0.0996715f, -0.1859163f, -0.3608057f, -0.0494585f, +0.1151679f,
  -0.3823611f, +0.0758112f, +0.1698358f, -0.6832719f, +0.0118877f, +0.0308540f, +0.4235466f, +0.1349574f,
  -0.8357292f, -1.0585761f, -0.0029415f, +0.3350451f, +0.5051500f, -0.5426798f, +0.0975526f, +0.4237068f,
  -0.0301058f, -0.7351801f, +0.1600163f, -0.1057050f, -0.1823904f, -0.1240376f, -0.1386157f, +0.0239729f,
  -0.0287805f, +0.3733496f, -0.2011729f, -0.4920595f, +0.2575032f, -0.0303616f, +0.5685003f, +0.2145123f,
  +0.5584378f, +0.1853706f, -0.2131597f, +0.2762177f, +1.2663770f, -0.4120650f, +0.8149204f, +0.6205746f,
  +1.0029463f, +0.6759730f, -0.0641335f, +0.3015712f, -0.0227713f, -0.3031143f, +0.1795385f, -0.0863475f,
  +0.1529132f, -0.1477648f, -0.2551546f, +0.0997312f, +0.0643778f, +0.5753981f, -0.3438685f, -0.0655932f,
  +0.1993068f, -0.1048905f, +0.0888005f, +0.3276804f, +0.0898467f, +0.7301073f, -0.3246202f, -0.3883625f,
  -0.9967180f, -0.7114367f, +0.0355538f, -0.1372955f, -0.4107159f, +0.1677684f, -0.2714287f, -0.0347514f,
  -0.0400505f, -0.3074778f, -0.3039244f, +0.0457687f, +0.0592486f, +0.1288816f, -0.0028075f, -0.1002681f,
  -0.0328753f, -0.4401517f, -0.3652691f, -0.0550972f, -0.1154186f, -0.2871652f, +0.4603778f, -0.1316657f,
  +0.2049464f, +0.1095819f, +0.1897825f, +0.0373608f, -0.4981537f, -0.0900491f, +0.5792199f, -0.2268862f,
  +0.3001653f, +0.5481947f, +0.1139990f, +0.0098223f, -0.1503120f, -0.0114934f, -0.3639206f, +0.0819304f,
  +0.9672006f, +0.0151884f, +0.2664134f, -0.1860150f, +0.8578935f, -0.8724334f, +0.0005731f, -0.1781222f,
  +0.9375530f, +0.3623903f, -0.0818143f, -0.0245687f, +0.3069247f, -0.1685385f, +0.2424293f, -0.0072484f,
  -0.3548609f, +0.0465535f, +0.0982044f, +0.0101377f, -0.1087713f, +0.1259644f, +0.0615491f, +0.0246293f,
  +0.1177247f, -0.2407198f, +0.6569577f, -0.0694418f, +0.2851609f, +0.5563937f, +0.0721392f, -0.0994143f,
  +0.3814267f, -0.2645969f, +0.1582492f, +0.0308398f, +0.2501041f, +0.1073994f, -0.1242587f, +0.1016330f
);

const float biases[4] = float[4](
  +0.0088675f, +0.0253250f, -0.0234828f, +0.0407805f
);

vec4 hook() {
    const vec4 r[9][2] = vec4[9][2](
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 1.0f)))
    );

    float sum[4] = biases;
    for (int n = 0; n < 4; n++) {
        for (int i = 0; i < 9; i++) {
            const vec4 k0 = vec4(kernels[n * 8 * 9 + 8 * i + 0], kernels[n * 8 * 9 + 8 * i + 1], kernels[n * 8 * 9 + 8 * i + 2], kernels[n * 8 * 9 + 8 * i + 3]);
            const vec4 k1 = vec4(kernels[n * 8 * 9 + 8 * i + 4], kernels[n * 8 * 9 + 8 * i + 5], kernels[n * 8 * 9 + 8 * i + 6], kernels[n * 8 * 9 + 8 * i + 7]);
            sum[n] += (dot(k0, r[i][0]) + dot(k1, r[i][1]));
        }
    }

    return ACTIVE(vec4(sum[0], sum[1], sum[2], sum[3]));
}

//!HOOK LUMA
//!DESC ARNet b4 Layer5 L1
//!WHEN OUTPUT.w LUMA.w / 1.2 > OUTPUT.h LUMA.h / 1.2 > *
//!BIND TMP2_L0
//!BIND TMP2_L1
//!SAVE TMP1_L1
//!COMPONENTS 4

#define ACTIVE(v) (max(v, v * 0.2000000f))

#define TEX_BIND_L0_TEXOFF TMP2_L0_texOff
#define TEX_BIND_L0_TEX TMP2_L0_tex
#define TEX_BIND_L0_POS TMP2_L0_pos
#define TEX_BIND_L0_SIZE TMP2_L0_size
#define TEX_BIND_L0_PT TMP2_L0_pt

#define TEX_BIND_L1_TEXOFF TMP2_L1_texOff
#define TEX_BIND_L1_TEX TMP2_L1_tex
#define TEX_BIND_L1_POS TMP2_L1_pos
#define TEX_BIND_L1_SIZE TMP2_L1_size
#define TEX_BIND_L1_PT TMP2_L1_pt

const float kernels[288] = float[288](
  +0.4455933f, +0.8549494f, +0.2852983f, +0.0690213f, -0.1825986f, -0.0673893f, +0.3264972f, -0.2068653f,
  -0.1500171f, -0.2960690f, -0.4244869f, +0.0928719f, +0.5884324f, +0.3716899f, +0.0789947f, +0.0857814f,
  +0.2283150f, -0.0488648f, +0.1990815f, -0.0932132f, -0.0019241f, +0.2295099f, +0.3386801f, -0.1499121f,
  -0.0755016f, -0.6005126f, +0.5233698f, -0.0801284f, +0.6004905f, +0.2400761f, +0.6260713f, +0.0029802f,
  -1.1256750f, +1.4210591f, -0.6910409f, +0.1195464f, -0.2915417f, -1.3687772f, +0.9859711f, -0.5494052f,
  +0.3800627f, -0.1005904f, -0.0507027f, +0.1423217f, +0.1021272f, +0.0440031f, -0.0131209f, +0.0912371f,
  +0.2418679f, -1.0361828f, -0.9225041f, -0.0337908f, +0.0905885f, +0.1541859f, -0.4565093f, -0.1063848f,
  -1.1487063f, -0.1917387f, +0.3915647f, -0.0932927f, -0.6377279f, +0.1060844f, -0.2663936f, +0.0787483f,
  -0.0769223f, -0.1717677f, +0.0648085f, -0.1702535f, +0.1597040f, +0.0731515f, +0.0952284f, +0.2009987f,
  -0.4793784f, +0.5932271f, -0.1928878f, +0.0674858f, +0.0692247f, +0.4398318f, +0.4916817f, +0.3846738f,
  +0.1577797f, +1.3793048f, +0.5679482f, +0.2504909f, +1.0905662f, +0.2343431f, +0.0566973f, +0.1293749f,
  -0.3224129f, -0.1735329f, -0.3588009f, +0.0650708f, +0.1045181f, +0.3002198f, -0.2178851f, +0.1730144f,
  -0.2196527f, +1.2203981f, -0.4713838f, -0.0510148f, +0.0887090f, +0.4936749f, +0.1444743f, +0.7056731f,
  +0.0309667f, +1.0207490f, +0.1318687f, +0.3054875f, +0.9368581f, +0.9418827f, +0.0043888f, +0.5004764f,
  -0.4967686f, -0.0821556f, -0.0914404f, -0.3303435f, -0.1756904f, -0.3871020f, +0.3319580f, +0.0270111f,
  +0.4719241f, +0.0270689f, -0.1582429f, -0.0778937f, +0.1509734f, +0.0095369f, -0.3243331f, -0.0015686f,
  -0.2404886f, +0.0534343f, +0.4147452f, -0.2781692f, -0.0136398f, -0.5234823f, -0.1198127f, -0.2708994f,
  -0.0682553f, -0.3271000f, +0.1778175f, +0.1986904f, +0.1977068f, +0.0740284f, -0.6813878f, +0.0502189f,
  +0.1808588f, +0.4492603f, -0.1291750f, -0.2382692f, +0.4995555f, -0.5177699f, -0.0556828f, +0.0948285f,
  +0.8947226f, +1.2642121f, +1.0676492f, +0.0134292f, +0.0116616f, -0.2583616f, +0.5341700f, +0.0695679f,
  -0.0113454f, +0.0169298f, +0.1987111f, +0.0643807f, +0.1207838f, +0.0996892f, -0.0523551f, +0.3463286f,
  -0.3586514f, -0.1004235f, +0.2904422f, -0.3091183f, +0.6509358f, +0.0331298f, +0.6141451f, +0.3384072f,
  -0.6650296f, +0.9418085f, +0.2480837f, +0.2448641f, -0.0140294f, -0.0782296f, +0.6985973f, -0.1792348f,
  -0.4916260f, +0.1916261f, -0.2545569f, +0.1606139f, -0.3440568f, -0.1697729f, +0.3787543f, -0.1002852f,
  +0.1495766f, +0.2608962f, -0.5292659f, -0.1696702f, +0.1204609f, -0.2007386f, -0.0662636f, +0.6503877f,
  -0.3106188f, +0.0025327f, -0.0033240f, -0.2218943f, +0.1180114f, -0.3735325f, -0.1644325f, +0.0543847f,
  +0.9937633f, -0.0077369f, -0.0310040f, -0.1240895f, +0.5294711f, +0.4153935f, -0.2432513f, -0.0673422f,
  +0.4823347f, +0.6724762f, +0.0548182f, +0.3431984f, -0.3370692f, -0.1027903f, -0.0291762f, -0.1789617f,
  -0.1937964f, -0.1579973f, -0.3570437f, +0.0471721f, +0.0906366f, -0.0375052f, +0.3934818f, -0.0907642f,
  +0.2738546f, +0.2355372f, +0.2371459f, -0.1543005f, -0.3263329f, +0.0173283f, +0.6088064f, -0.2681419f,
  -0.2361275f, -0.7651439f, +1.2306881f, +0.1531327f, -0.0514767f, +0.1465085f, +0.3617809f, -0.4542853f,
  -0.8992500f, +0.4993308f, -0.9094799f, -0.6432407f, -0.2358901f, -1.1591413f, +0.0297533f, -1.0885786f,
  +0.2536623f, -0.1793634f, -0.0785776f, +0.1290725f, +0.5020884f, +0.1059892f, -0.5081010f, +0.2090326f,
  -0.0026104f, -0.1639397f, -0.1410296f, +0.0116324f, -0.1668336f, -0.2281211f, +0.0932307f, +0.0188484f,
  +0.2121824f, +0.0397455f, +0.2651988f, +0.0946134f, +0.0326240f, +0.2701692f, -0.0473803f, +0.1148339f,
  +0.1286279f, -0.1377821f, -0.0657890f, -0.0546872f, +0.1241207f, -0.0043087f, +0.0130468f, +0.0032588f
);

const float biases[4] = float[4](
  -0.0462661f, +0.0452995f, -0.0214990f, -0.0061713f
);

vec4 hook() {
    const vec4 r[9][2] = vec4[9][2](
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 1.0f)))
    );

    float sum[4] = biases;
    for (int n = 0; n < 4; n++) {
        for (int i = 0; i < 9; i++) {
            const vec4 k0 = vec4(kernels[n * 8 * 9 + 8 * i + 0], kernels[n * 8 * 9 + 8 * i + 1], kernels[n * 8 * 9 + 8 * i + 2], kernels[n * 8 * 9 + 8 * i + 3]);
            const vec4 k1 = vec4(kernels[n * 8 * 9 + 8 * i + 4], kernels[n * 8 * 9 + 8 * i + 5], kernels[n * 8 * 9 + 8 * i + 6], kernels[n * 8 * 9 + 8 * i + 7]);
            sum[n] += (dot(k0, r[i][0]) + dot(k1, r[i][1]));
        }
    }

    return ACTIVE(vec4(sum[0], sum[1], sum[2], sum[3]));
}

//!HOOK LUMA
//!DESC ARNet b4 Layer6 L0
//!WHEN OUTPUT.w LUMA.w / 1.2 > OUTPUT.h LUMA.h / 1.2 > *
//!BIND TMP1_L0
//!BIND TMP1_L1
//!BIND TMP2_L0
//!SAVE TMP2_L0
//!COMPONENTS 4

#define ACTIVE(v) (v)

#define TEX_BIND_L0_TEXOFF TMP1_L0_texOff
#define TEX_BIND_L0_TEX TMP1_L0_tex
#define TEX_BIND_L0_POS TMP1_L0_pos
#define TEX_BIND_L0_SIZE TMP1_L0_size
#define TEX_BIND_L0_PT TMP1_L0_pt

#define TEX_BIND_L1_TEXOFF TMP1_L1_texOff
#define TEX_BIND_L1_TEX TMP1_L1_tex
#define TEX_BIND_L1_POS TMP1_L1_pos
#define TEX_BIND_L1_SIZE TMP1_L1_size
#define TEX_BIND_L1_PT TMP1_L1_pt

#define TEX_BIND_L2_TEXOFF TMP2_L0_texOff
#define TEX_BIND_L2_TEX TMP2_L0_tex
#define TEX_BIND_L2_POS TMP2_L0_pos
#define TEX_BIND_L2_SIZE TMP2_L0_size
#define TEX_BIND_L2_PT TMP2_L0_pt

const float kernels[288] = float[288](
  +0.3546228f, -0.1243415f, +0.0386034f, -0.2866269f, +0.2697258f, +0.0744746f, -0.0559192f, -0.2331505f,
  +0.1690369f, +0.5312596f, +0.1310563f, +0.0272536f, +0.1502959f, +0.1882642f, -0.0524076f, +0.0684461f,
  +0.1068739f, -0.0402962f, -0.0977708f, -0.1207604f, -0.1338457f, +0.1146374f, -0.2010606f, +0.1631027f,
  +0.3601432f, -0.5461916f, +0.4794720f, -0.1066004f, +0.1039585f, -0.1539916f, -0.8843861f, -0.3072311f,
  -0.2414121f, -0.1894343f, +1.2393546f, -0.5742832f, -0.2696065f, +0.6181853f, -0.2167591f, +0.6287773f,
  -0.0454362f, +0.1380503f, +0.1945154f, -0.3798182f, +0.0945485f, +0.1660849f, +0.3118047f, -0.0248770f,
  -0.3230134f, +0.0199578f, +0.0683692f, -0.0128643f, -0.2030424f, +0.0753377f, -0.4648851f, +0.0409913f,
  -0.5264675f, -0.0183559f, -0.1444836f, +0.3623673f, -0.0769893f, +0.5224252f, -0.0046470f, +0.2642986f,
  -0.1255504f, -0.0439303f, -0.0193922f, +0.1939871f, +0.2588806f, +0.1425489f, +0.0610281f, -0.1992431f,
  +0.0469154f, -0.1004328f, +0.3021144f, -0.1427602f, -0.2926283f, +0.0257488f, -0.1194626f, +0.2464342f,
  +0.0664835f, +0.3086545f, -0.5358945f, +0.2157347f, +0.1328235f, +0.1313859f, +0.2598664f, -0.1960549f,
  -0.2270311f, +0.0558886f, +0.0085381f, +0.0283365f, -0.0241188f, +0.0339888f, +0.0350665f, -0.0422585f,
  -0.0020436f, +0.0370146f, -0.0281703f, -0.0334805f, -0.2132559f, +0.0182200f, +0.3152242f, +0.1358333f,
  -0.0315343f, +0.1397340f, +0.5318301f, -0.2465947f, +0.5695583f, -0.2515663f, -0.3728703f, -0.3465644f,
  +0.1936122f, +0.1243450f, -0.1677034f, -0.0843456f, +0.0722690f, +0.0389187f, -0.0341904f, +0.1228191f,
  +0.0439829f, -0.0397350f, -0.0750227f, +0.1035788f, -0.0478031f, -0.2462068f, +0.1364066f, -0.0161444f,
  -0.1491578f, +0.1185731f, +0.0873604f, +0.0197628f, +0.1141719f, -0.1514124f, -0.1944588f, -0.0820483f,
  -0.0351295f, +0.0277332f, +0.0079773f, -0.1135259f, +0.1636192f, -0.1328595f, +0.0705598f, +0.0133960f,
  -0.1372239f, +0.0903918f, -0.2326476f, +0.1499290f, -0.1001589f, +0.2749708f, +0.1374969f, -0.0198669f,
  +0.0619701f, -0.3447557f, +0.1337745f, -0.2367454f, -0.2452514f, -0.0624336f, -0.2932696f, +0.1046853f,
  -0.0784452f, -0.0185764f, -0.5608503f, +0.2698596f, +0.2406816f, -0.4722601f, +0.3022782f, -0.2836821f,
  -0.0614316f, -0.3806908f, +0.1902721f, +0.1179017f, +0.5199507f, -0.0551057f, -0.2624126f, -0.2672255f,
  +0.1855305f, -0.2498806f, -0.1403546f, -0.7450886f, -0.0960132f, +0.7140146f, -0.2977770f, +0.3818142f,
  +0.2342854f, -0.1177675f, -0.7672384f, +0.4257916f, +0.6591224f, -0.4489777f, -0.5562209f, -0.9504418f,
  -0.4088595f, -0.0512485f, +0.4094924f, +0.1144102f, +0.0764608f, +0.0673236f, -0.3895754f, +0.0940821f,
  -0.3096708f, +0.0636879f, -0.2192084f, +0.2533157f, -0.2137720f, +0.1708951f, +0.0505095f, +0.5823509f,
  -0.0133783f, -0.1088755f, -0.1351842f, +0.0166821f, +0.3062007f, -0.2149508f, -0.2427694f, -0.2695584f,
  -0.1818288f, -0.0267102f, +0.3183992f, +0.0172488f, +0.1981711f, +0.1032000f, +0.1562372f, -0.0376466f,
  +0.1077958f, -0.2896001f, -0.2008084f, -0.3095226f, +0.4832658f, -0.3027194f, -0.3338788f, -0.1413465f,
  +0.0164212f, -0.1212531f, +0.0398821f, +0.0869140f, -0.0021179f, -0.1213819f, +0.0212876f, +0.0527419f,
  -0.3269379f, +0.0353312f, -0.4382775f, -0.0954742f, -0.0903260f, -0.1389741f, -0.0073610f, +0.1487678f,
  +0.3268588f, +0.3821806f, -0.1376430f, +0.3679724f, -1.0139647f, -0.1620207f, +0.4000083f, +0.4163502f,
  -0.1002009f, +0.2516448f, +0.2268068f, -0.0012113f, +0.1509290f, -0.0828401f, +0.2165213f, -0.2613273f,
  +0.2645077f, -0.0397951f, -0.1292266f, -0.0077336f, -0.0594350f, -0.0358370f, +0.2498419f, +0.0286525f,
  +0.2437832f, +0.1920708f, +0.0699025f, -0.0415181f, -0.4474253f, +0.0304910f, +0.4296353f, +0.1301440f,
  +0.1859758f, +0.1762614f, +0.1761065f, -0.1447312f, +0.1648541f, -0.0111246f, +0.0997147f, -0.3643859f
);

const float biases[4] = float[4](
  -0.0103540f, +0.0717672f, -0.0357979f, -0.0553648f
);

vec4 hook() {
    const vec4 r[9][2] = vec4[9][2](
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 1.0f)))
    );

    float sum[4] = biases;
    for (int n = 0; n < 4; n++) {
        for (int i = 0; i < 9; i++) {
            const vec4 k0 = vec4(kernels[n * 8 * 9 + 8 * i + 0], kernels[n * 8 * 9 + 8 * i + 1], kernels[n * 8 * 9 + 8 * i + 2], kernels[n * 8 * 9 + 8 * i + 3]);
            const vec4 k1 = vec4(kernels[n * 8 * 9 + 8 * i + 4], kernels[n * 8 * 9 + 8 * i + 5], kernels[n * 8 * 9 + 8 * i + 6], kernels[n * 8 * 9 + 8 * i + 7]);
            sum[n] += (dot(k0, r[i][0]) + dot(k1, r[i][1]));
        }
    }

    return ACTIVE(vec4(sum[0], sum[1], sum[2], sum[3]) * 0.2000000f + TEX_BIND_L2_TEXOFF(vec2(0.0f, 0.0f)));
}

//!HOOK LUMA
//!DESC ARNet b4 Layer6 L1
//!WHEN OUTPUT.w LUMA.w / 1.2 > OUTPUT.h LUMA.h / 1.2 > *
//!BIND TMP1_L0
//!BIND TMP1_L1
//!BIND TMP2_L1
//!SAVE TMP2_L1
//!COMPONENTS 4

#define ACTIVE(v) (v)

#define TEX_BIND_L0_TEXOFF TMP1_L0_texOff
#define TEX_BIND_L0_TEX TMP1_L0_tex
#define TEX_BIND_L0_POS TMP1_L0_pos
#define TEX_BIND_L0_SIZE TMP1_L0_size
#define TEX_BIND_L0_PT TMP1_L0_pt

#define TEX_BIND_L1_TEXOFF TMP1_L1_texOff
#define TEX_BIND_L1_TEX TMP1_L1_tex
#define TEX_BIND_L1_POS TMP1_L1_pos
#define TEX_BIND_L1_SIZE TMP1_L1_size
#define TEX_BIND_L1_PT TMP1_L1_pt

#define TEX_BIND_L2_TEXOFF TMP2_L1_texOff
#define TEX_BIND_L2_TEX TMP2_L1_tex
#define TEX_BIND_L2_POS TMP2_L1_pos
#define TEX_BIND_L2_SIZE TMP2_L1_size
#define TEX_BIND_L2_PT TMP2_L1_pt

const float kernels[288] = float[288](
  +0.0028944f, +0.0390599f, -0.2690293f, -0.0620583f, +0.2492095f, -0.0053071f, +0.2562816f, -0.1312185f,
  +0.5308248f, +0.2378242f, -0.1245335f, -0.3243578f, +0.0075257f, -0.5792192f, +0.0122487f, -0.0363663f,
  +0.0360742f, -0.0338033f, -0.0520326f, -0.0223650f, +0.0603767f, -0.2834972f, +0.2330164f, -0.1702008f,
  -0.0654152f, -0.0517515f, +0.0416026f, -0.3484761f, -0.0586126f, +0.2558292f, -0.1089222f, +0.0588987f,
  +0.2464454f, -0.2744978f, -0.4547666f, -0.2830227f, -0.7977891f, -0.7662262f, -0.1635389f, +0.1412105f,
  +0.1612044f, -0.2087889f, +0.2189982f, +0.2369992f, -0.0851548f, -0.2680627f, -0.4187373f, -0.2047597f,
  +0.0349420f, -0.0649768f, -0.0067702f, -0.0321457f, +0.0098741f, +0.0931894f, +0.0580287f, -0.0185754f,
  -0.0209616f, +0.0188383f, -0.4988427f, +0.2042223f, -0.3857296f, -0.3845025f, +0.2899944f, -0.0258227f,
  +0.2126393f, +0.2078250f, -0.0374333f, -0.1349416f, -0.1713976f, -0.3326550f, +0.0215087f, -0.1815761f,
  +0.1681870f, +0.1430385f, +0.2857445f, -0.0130867f, -0.2460524f, +0.0552050f, +0.0282902f, +0.1317949f,
  -0.4005885f, -0.0929576f, -0.0859406f, +0.0186011f, -0.0421031f, +0.1750780f, +0.0220050f, -0.0471700f,
  +0.1694448f, -0.0941101f, +0.2300816f, +0.0894927f, +0.0402816f, -0.0233895f, -0.0688876f, +0.0140479f,
  -0.1738852f, +0.1616866f, +0.4037189f, -0.2000089f, -0.1607918f, +0.5889211f, +0.2878356f, +0.0792185f,
  +0.4790171f, +0.1798772f, -0.2629683f, +0.4766257f, +0.2664472f, +0.2456072f, -0.0636901f, +0.1196756f,
  +0.4453694f, +0.2316066f, -0.2607211f, -0.1931416f, +0.1544032f, -0.3374218f, +0.3239407f, -0.3069987f,
  -0.0322060f, +0.0280641f, +0.2159898f, -0.0946187f, -0.1029544f, +0.2244362f, +0.1700634f, +0.1821250f,
  +0.1883537f, +0.0142579f, -0.2602077f, +0.1098627f, +0.3548456f, +0.0605420f, +0.3277459f, -0.1382217f,
  +0.1715469f, -0.2116376f, +0.1792521f, -0.0794923f, +0.2664788f, -0.1411004f, +0.1249318f, -0.3438860f,
  -0.0524042f, +0.0936908f, -0.5325446f, +0.0778017f, +0.3347164f, -0.1556970f, +0.2300530f, -0.2201638f,
  +0.2111099f, +0.1153543f, -0.1285045f, -0.1855251f, -0.1287174f, -0.4552133f, -0.0104597f, -0.0394851f,
  +0.0321385f, -0.1983482f, -0.0048161f, +0.0603103f, +0.1739725f, -0.2134949f, +0.1631196f, -0.2683273f,
  +0.0994010f, -0.2598512f, -0.2450100f, -0.3850122f, -0.0067472f, -0.2469407f, -0.4396276f, -0.0901499f,
  -0.4692720f, -0.3356214f, -0.6355070f, +0.3390542f, -0.8760137f, -1.0046706f, -0.4422856f, -0.0448752f,
  +0.5174335f, -0.0376097f, +0.4583240f, -0.1243131f, -0.3719467f, -0.0027248f, -0.3106585f, +0.1368409f,
  -0.1532950f, -0.0058188f, -0.4572682f, +0.0789080f, +0.0332429f, -0.0843582f, -0.0312413f, -0.1530893f,
  +0.2398991f, -0.1555131f, -0.3893008f, -0.0202278f, -0.2939559f, -0.4474131f, +0.0819412f, -0.3416354f,
  +0.1459746f, +0.0213415f, +0.1420089f, -0.0229285f, -0.4082369f, +0.0784374f, -0.0675077f, +0.1454505f,
  -0.1849100f, +0.0390114f, -0.0125110f, +0.0078053f, +0.1221968f, +0.1911534f, +0.2474179f, -0.1459506f,
  +0.2577465f, +0.8844174f, -0.3671687f, +0.4383314f, -0.1868444f, +0.2265566f, +0.2700308f, -0.0392456f,
  -0.0132871f, -0.0700131f, -0.1864522f, -0.1389475f, -0.1718174f, +0.2325659f, -0.0208115f, +0.0216483f,
  +0.1827575f, -0.0162052f, +0.3526967f, -0.3064111f, +0.0192800f, +0.2347610f, -0.1631208f, -0.1021017f,
  +0.9490014f, -0.4852852f, +1.2406691f, -0.4278156f, -0.3476695f, +0.0444149f, -1.3730412f, +0.2163522f,
  -0.0328798f, +0.4283401f, -0.0086792f, -0.3083442f, -0.2721292f, -0.0878898f, +0.0594649f, +0.5124759f,
  -0.2689375f, +0.0261894f, +0.1714931f, +0.1229849f, -0.0332607f, +0.2348573f, -0.2242188f, +0.0751574f,
  -0.0420061f, +0.2537384f, -0.3242130f, -0.0025203f, +0.0165740f, +0.1880886f, +0.3773882f, +0.1783949f,
  +0.1959735f, -0.1204673f, -0.0399724f, -0.0056087f, +0.2454080f, -0.0699086f, +0.3229457f, -0.3333098f
);

const float biases[4] = float[4](
  +0.0475657f, -0.0355818f, -0.1303310f, +0.0499854f
);

vec4 hook() {
    const vec4 r[9][2] = vec4[9][2](
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 1.0f)))
    );

    float sum[4] = biases;
    for (int n = 0; n < 4; n++) {
        for (int i = 0; i < 9; i++) {
            const vec4 k0 = vec4(kernels[n * 8 * 9 + 8 * i + 0], kernels[n * 8 * 9 + 8 * i + 1], kernels[n * 8 * 9 + 8 * i + 2], kernels[n * 8 * 9 + 8 * i + 3]);
            const vec4 k1 = vec4(kernels[n * 8 * 9 + 8 * i + 4], kernels[n * 8 * 9 + 8 * i + 5], kernels[n * 8 * 9 + 8 * i + 6], kernels[n * 8 * 9 + 8 * i + 7]);
            sum[n] += (dot(k0, r[i][0]) + dot(k1, r[i][1]));
        }
    }

    return ACTIVE(vec4(sum[0], sum[1], sum[2], sum[3]) * 0.2000000f + TEX_BIND_L2_TEXOFF(vec2(0.0f, 0.0f)));
}

//!HOOK LUMA
//!DESC ARNet b4 Layer7 L0
//!WHEN OUTPUT.w LUMA.w / 1.2 > OUTPUT.h LUMA.h / 1.2 > *
//!BIND TMP2_L0
//!BIND TMP2_L1
//!SAVE TMP1_L0
//!COMPONENTS 4

#define ACTIVE(v) (max(v, v * 0.2000000f))

#define TEX_BIND_L0_TEXOFF TMP2_L0_texOff
#define TEX_BIND_L0_TEX TMP2_L0_tex
#define TEX_BIND_L0_POS TMP2_L0_pos
#define TEX_BIND_L0_SIZE TMP2_L0_size
#define TEX_BIND_L0_PT TMP2_L0_pt

#define TEX_BIND_L1_TEXOFF TMP2_L1_texOff
#define TEX_BIND_L1_TEX TMP2_L1_tex
#define TEX_BIND_L1_POS TMP2_L1_pos
#define TEX_BIND_L1_SIZE TMP2_L1_size
#define TEX_BIND_L1_PT TMP2_L1_pt

const float kernels[288] = float[288](
  +0.1917668f, +0.1334240f, +0.2393095f, -0.0122388f, -0.1546317f, -0.3369163f, +0.1483191f, -0.0897405f,
  +0.2866509f, -0.1826138f, -0.3202325f, +0.1603333f, -0.6076499f, +0.1352749f, +0.1741791f, -0.2590214f,
  -0.0811058f, -0.1227616f, -0.1476933f, -0.0110937f, -0.5196971f, +0.2395231f, +0.1646723f, -0.0131158f,
  -0.0083564f, +0.0129834f, +0.2824300f, -0.0449516f, -0.1921040f, -0.1761848f, +0.2618994f, -0.0590762f,
  -0.0937311f, -0.0621938f, -0.9530123f, +0.3275998f, -0.1156270f, -0.0519664f, +0.0707873f, +0.3056111f,
  +0.2336133f, -0.1583266f, +0.4588456f, -0.0103538f, -0.6892136f, -0.4112284f, -0.1135205f, +0.1700776f,
  +0.1343094f, +0.1631200f, +0.1342189f, -0.1038842f, +0.1544381f, -0.1524156f, +0.1793270f, -0.2291992f,
  +0.1401195f, -0.4483607f, -0.2432181f, +0.1050267f, +0.0194567f, -0.5043605f, -0.2422103f, -0.0472791f,
  -0.0958531f, -0.2384178f, +0.1343249f, -0.1011638f, -0.2045122f, +0.2353601f, -0.0919307f, +0.1408301f,
  +0.0038842f, -0.1233054f, +0.2056933f, +0.0298216f, -0.2333987f, -0.0046012f, +0.0852782f, -0.0708743f,
  -0.1139317f, -0.2123189f, -0.2249726f, -0.0329255f, -0.0373767f, +0.2421289f, -0.1359414f, -0.0194346f,
  -0.1086441f, +0.2416290f, -0.0185040f, +0.1670101f, -0.4408250f, -0.1104360f, +0.1623545f, +0.0371299f,
  +0.1822269f, +0.6918746f, +0.0772771f, +0.0009415f, +0.3766345f, -0.0850390f, -0.0751983f, +0.0271837f,
  +0.2693018f, -0.9915173f, +0.1011713f, +0.0015093f, -0.6160554f, +0.0100370f, -0.3583453f, -0.0627936f,
  -0.0109339f, -0.5246893f, +0.3459196f, -0.1875880f, -0.5680559f, -0.0669458f, -0.0766205f, +0.3125123f,
  -0.0739106f, -0.3380261f, -0.1902115f, -0.0338097f, +0.2484162f, +0.0931570f, -0.1323840f, +0.0374975f,
  -0.1275440f, -0.1870696f, -0.0492458f, -0.0656990f, -0.4971444f, -0.4236771f, +0.1640519f, +0.1453039f,
  +0.1706677f, -0.2378660f, +0.0810452f, +0.0269432f, -0.1098881f, -0.0787578f, -0.0813676f, +0.0198105f,
  +0.1847388f, +0.2596023f, +0.1604714f, -0.3704002f, +0.2696977f, -0.6179756f, -0.2421843f, +0.4184008f,
  +0.6787440f, +1.3001838f, +0.5744185f, -0.0387816f, +0.9365234f, -0.2563750f, +0.3297142f, +0.0532818f,
  +0.1706398f, +0.0772651f, +0.2800392f, +0.0293950f, +0.2968025f, -0.2314807f, -0.0026646f, +0.0624394f,
  -0.3682246f, -0.0807832f, -0.5370830f, -0.0053893f, +0.0343884f, -0.1080200f, -0.2252285f, -0.0231433f,
  -0.6527629f, +0.1425423f, -1.4243648f, +0.4301105f, -0.2352950f, +0.3755898f, -0.1427749f, -0.1987323f,
  -0.2793738f, -0.1575936f, -0.9964828f, -0.1877193f, -0.0663197f, +0.9979560f, -0.6514951f, +0.0099792f,
  +0.1135601f, -0.1128532f, -0.2257866f, +0.0798160f, +0.2347225f, +0.4576470f, -0.2947598f, +0.1832560f,
  -0.0171478f, +0.4397995f, +0.4170147f, +0.0678854f, +0.2902427f, +1.1884326f, +0.1726848f, +0.0436090f,
  -0.3473993f, -0.2405479f, +0.3144770f, +0.0471279f, -0.2159827f, +0.3903812f, +0.1943260f, -0.1211167f,
  -0.1041984f, +0.0206650f, -0.1829448f, +0.0463913f, +0.1783900f, +0.1921608f, +0.0085192f, -0.0054014f,
  +0.1870210f, -0.2594631f, +0.2650908f, -0.1093855f, -0.2445583f, +0.0470280f, +0.0721209f, -0.1309003f,
  +0.4994894f, +0.2118705f, +0.1950215f, -0.1601852f, -0.0789179f, +0.2122607f, -0.0372822f, +0.0711091f,
  -0.0421079f, +0.0902968f, -0.4232461f, +0.0750435f, +0.1334999f, +0.6593425f, +0.0466436f, +0.1610975f,
  +0.6725559f, -0.0273334f, +0.9991274f, -0.2534468f, -0.3592391f, -1.6038691f, +0.1319915f, -0.5016336f,
  +0.4471772f, +0.1304258f, -0.2923177f, +0.0966567f, +0.4369246f, +1.3119704f, -1.1076488f, +0.2306908f,
  -0.0239700f, +0.3147466f, -0.3020348f, +0.1024791f, -0.0893975f, +0.4614483f, +0.0442205f, +0.0446599f,
  +0.3417393f, -0.2647532f, +0.1729027f, -0.1774625f, +0.3521991f, -0.8819752f, -0.3751276f, -0.4429713f,
  +0.4031155f, -0.1838349f, -0.0613714f, +0.1644820f, +0.2154264f, +1.0665033f, -0.3989330f, +0.0346471f
);

const float biases[4] = float[4](
  +0.0323293f, +0.0303527f, -0.1129205f, -0.0140967f
);

vec4 hook() {
    const vec4 r[9][2] = vec4[9][2](
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 1.0f)))
    );

    float sum[4] = biases;
    for (int n = 0; n < 4; n++) {
        for (int i = 0; i < 9; i++) {
            const vec4 k0 = vec4(kernels[n * 8 * 9 + 8 * i + 0], kernels[n * 8 * 9 + 8 * i + 1], kernels[n * 8 * 9 + 8 * i + 2], kernels[n * 8 * 9 + 8 * i + 3]);
            const vec4 k1 = vec4(kernels[n * 8 * 9 + 8 * i + 4], kernels[n * 8 * 9 + 8 * i + 5], kernels[n * 8 * 9 + 8 * i + 6], kernels[n * 8 * 9 + 8 * i + 7]);
            sum[n] += (dot(k0, r[i][0]) + dot(k1, r[i][1]));
        }
    }

    return ACTIVE(vec4(sum[0], sum[1], sum[2], sum[3]));
}

//!HOOK LUMA
//!DESC ARNet b4 Layer7 L1
//!WHEN OUTPUT.w LUMA.w / 1.2 > OUTPUT.h LUMA.h / 1.2 > *
//!BIND TMP2_L0
//!BIND TMP2_L1
//!SAVE TMP1_L1
//!COMPONENTS 4

#define ACTIVE(v) (max(v, v * 0.2000000f))

#define TEX_BIND_L0_TEXOFF TMP2_L0_texOff
#define TEX_BIND_L0_TEX TMP2_L0_tex
#define TEX_BIND_L0_POS TMP2_L0_pos
#define TEX_BIND_L0_SIZE TMP2_L0_size
#define TEX_BIND_L0_PT TMP2_L0_pt

#define TEX_BIND_L1_TEXOFF TMP2_L1_texOff
#define TEX_BIND_L1_TEX TMP2_L1_tex
#define TEX_BIND_L1_POS TMP2_L1_pos
#define TEX_BIND_L1_SIZE TMP2_L1_size
#define TEX_BIND_L1_PT TMP2_L1_pt

const float kernels[288] = float[288](
  -0.0000535f, -0.1625187f, -0.1381435f, +0.0941951f, -0.3535610f, +0.0258113f, +0.1136572f, -0.0413628f,
  +0.0118141f, -0.0380928f, -0.0017538f, +0.1142123f, -0.1639679f, -0.1697582f, -0.1623927f, -0.1112571f,
  -0.1862505f, -0.1915819f, -0.3016661f, +0.0214086f, -0.4637113f, +0.5251069f, +0.1970318f, -0.0662806f,
  -0.1406387f, -0.0338578f, +0.2638920f, +0.1194279f, -0.1726615f, +0.1855306f, +0.1726845f, -0.0661839f,
  +0.0030335f, -0.1859335f, +0.4584921f, +0.0767595f, -0.1670093f, +0.2654029f, -0.0350747f, -0.0125450f,
  +0.1195949f, -0.2457603f, +0.4141275f, +0.0833452f, -0.3069237f, -0.1204223f, +0.3596755f, -0.0015201f,
  -0.0202992f, -0.4356311f, -0.1148960f, +0.0916771f, -0.0625060f, +0.2543513f, -0.1975641f, -0.1413265f,
  +0.0941360f, -0.3824766f, +0.0836115f, +0.1561774f, -0.4059520f, +0.5262252f, +0.0274765f, +0.2217812f,
  -0.2146872f, -0.0238899f, +0.0334282f, +0.0167223f, -0.3973638f, -0.1956633f, +0.2461040f, +0.2428639f,
  -0.5533024f, +0.3458529f, -0.0990031f, +0.0573679f, +0.4493468f, -0.0893207f, -0.3086645f, +0.0628557f,
  -0.3382744f, +0.0543962f, -0.0290115f, +0.1888760f, -0.3475280f, -0.1525575f, +0.5341478f, -0.1013690f,
  +0.0617777f, -0.1882704f, +0.0737265f, -0.0167467f, -0.2776589f, -0.3140766f, -0.0063746f, +0.0820659f,
  -0.3737916f, -0.6700137f, +0.9133060f, -0.1983354f, -0.0047667f, +0.3563707f, +0.3133538f, +0.3743650f,
  -0.2265588f, +0.5601878f, -1.0078725f, +0.3004570f, -0.1233290f, -0.4006098f, +0.4790462f, +0.0045848f,
  +0.0937923f, -0.2957693f, +0.1212094f, -0.1515454f, +0.0470919f, +0.2184042f, -0.3935103f, +0.0188789f,
  -0.1702043f, -0.0105912f, +0.1593669f, -0.1253704f, +0.0205275f, -0.9214056f, +0.3018895f, +0.0250814f,
  +0.2696508f, +0.0570404f, -0.2543066f, +0.1454618f, -0.2225287f, -0.1188995f, +0.1093848f, -0.0476716f,
  -0.3131508f, -0.1023747f, +0.0922802f, -0.0203369f, -0.2139175f, +0.0812377f, +0.0277430f, +0.0178173f,
  -0.2536032f, +0.2085347f, +0.0059488f, +0.1287741f, +0.1479726f, +0.2229813f, +0.0550892f, +0.0642572f,
  -0.2320683f, -0.3903060f, -0.2738541f, +0.0487145f, -0.4987491f, -0.1698885f, -0.0265146f, -0.1401099f,
  -0.0941858f, +0.0522377f, +0.0514256f, +0.0223195f, -0.6205301f, -0.1476270f, +0.0176752f, +0.0923408f,
  -0.1138841f, -0.2670285f, -0.2867553f, +0.2506118f, -0.5609795f, +0.5621718f, +0.1889062f, -0.0158212f,
  +0.0738621f, -0.1689973f, -0.3565361f, +0.3132366f, -0.5505159f, -0.7232248f, -0.0525771f, +0.2687530f,
  -0.2434507f, -0.1118864f, +0.1010120f, +0.1189424f, -0.6840993f, +0.4254381f, -0.0957432f, +0.1280068f,
  +0.0660788f, -0.0642348f, +0.0488365f, +0.0134408f, +0.0552530f, +0.2140076f, -0.0140265f, -0.1928374f,
  +0.1236917f, -0.1786684f, -0.0625719f, +0.1478136f, -0.2410521f, -0.4156983f, -0.0865033f, +0.0702256f,
  +0.0470933f, -0.3328235f, +0.3009123f, -0.1009459f, -0.3856260f, -0.0755286f, +0.1412486f, +0.2795556f,
  -0.0677427f, +0.6369239f, +0.3758614f, -0.2136830f, +0.0321632f, -0.5966059f, -0.1834588f, +0.2121011f,
  +0.1080557f, +0.2739188f, +0.3737695f, +0.1659544f, -0.2627955f, -0.7439992f, -0.1754273f, +0.0450198f,
  -0.2434746f, +0.0964544f, -0.0628032f, +0.0378882f, +0.0778910f, -0.2515248f, -0.1178993f, +0.0687368f,
  -0.2775657f, +1.8040218f, +0.5355824f, -0.0693401f, -0.2473153f, -0.0261211f, +0.6707667f, +0.3549355f,
  +0.0351229f, +0.1407508f, +1.4217041f, -0.3822466f, +0.1507376f, +0.4421877f, -1.0651128f, +0.3541182f,
  +0.3793710f, -0.0236292f, +0.2059443f, -0.1467962f, -0.2258871f, -0.4031945f, +0.1150294f, +0.0354057f,
  +0.0044231f, -0.0288661f, +0.1529593f, -0.3082012f, +0.3090332f, -0.5524216f, -0.0663022f, +0.0005228f,
  +0.0099152f, +0.4939002f, -0.3840854f, +0.1445829f, +0.1655315f, +0.0405266f, +0.2702121f, +0.1046283f,
  +0.3594965f, +0.1314517f, +0.0125758f, -0.0543847f, +0.3687625f, +0.6020533f, -0.0789544f, -0.1331675f
);

const float biases[4] = float[4](
  +0.0951115f, +0.0411966f, +0.0456887f, -0.0562946f
);

vec4 hook() {
    const vec4 r[9][2] = vec4[9][2](
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 1.0f)))
    );

    float sum[4] = biases;
    for (int n = 0; n < 4; n++) {
        for (int i = 0; i < 9; i++) {
            const vec4 k0 = vec4(kernels[n * 8 * 9 + 8 * i + 0], kernels[n * 8 * 9 + 8 * i + 1], kernels[n * 8 * 9 + 8 * i + 2], kernels[n * 8 * 9 + 8 * i + 3]);
            const vec4 k1 = vec4(kernels[n * 8 * 9 + 8 * i + 4], kernels[n * 8 * 9 + 8 * i + 5], kernels[n * 8 * 9 + 8 * i + 6], kernels[n * 8 * 9 + 8 * i + 7]);
            sum[n] += (dot(k0, r[i][0]) + dot(k1, r[i][1]));
        }
    }

    return ACTIVE(vec4(sum[0], sum[1], sum[2], sum[3]));
}

//!HOOK LUMA
//!DESC ARNet b4 Layer8 L0
//!WHEN OUTPUT.w LUMA.w / 1.2 > OUTPUT.h LUMA.h / 1.2 > *
//!BIND TMP1_L0
//!BIND TMP1_L1
//!BIND TMP2_L0
//!BIND FEAT_L0
//!SAVE TMP2_L0
//!COMPONENTS 4

#define ACTIVE(v) (v)

#define TEX_BIND_L0_TEXOFF TMP1_L0_texOff
#define TEX_BIND_L0_TEX TMP1_L0_tex
#define TEX_BIND_L0_POS TMP1_L0_pos
#define TEX_BIND_L0_SIZE TMP1_L0_size
#define TEX_BIND_L0_PT TMP1_L0_pt

#define TEX_BIND_L1_TEXOFF TMP1_L1_texOff
#define TEX_BIND_L1_TEX TMP1_L1_tex
#define TEX_BIND_L1_POS TMP1_L1_pos
#define TEX_BIND_L1_SIZE TMP1_L1_size
#define TEX_BIND_L1_PT TMP1_L1_pt

#define TEX_BIND_L2_TEXOFF TMP2_L0_texOff
#define TEX_BIND_L2_TEX TMP2_L0_tex
#define TEX_BIND_L2_POS TMP2_L0_pos
#define TEX_BIND_L2_SIZE TMP2_L0_size
#define TEX_BIND_L2_PT TMP2_L0_pt

#define TEX_BIND_L3_TEXOFF FEAT_L0_texOff
#define TEX_BIND_L3_TEX FEAT_L0_tex
#define TEX_BIND_L3_POS FEAT_L0_pos
#define TEX_BIND_L3_SIZE FEAT_L0_size
#define TEX_BIND_L3_PT FEAT_L0_pt

const float kernels[288] = float[288](
  +0.1460047f, -0.0275758f, -0.5334705f, +0.3358737f, -0.0319777f, +0.0729027f, -0.4582033f, -0.4228610f,
  -0.2191404f, -0.1274473f, +0.4784844f, -0.5833678f, +0.0039957f, +0.0163197f, +0.1887204f, +0.3162635f,
  -0.0226347f, -0.1276128f, -0.0154296f, -0.0521496f, +0.0987109f, +0.1505495f, +0.2220249f, -0.3637169f,
  +0.1502579f, -0.4241230f, -0.8841097f, -0.5059074f, -0.2663944f, +0.1115366f, +1.0835849f, +0.3172601f,
  +0.1304681f, -0.2608781f, -1.2227737f, -0.4166538f, -0.4436764f, +0.0450348f, -0.2112614f, +0.4213344f,
  +0.1402969f, -0.2449725f, +0.0675100f, +0.2297904f, -0.1156180f, -0.1436908f, -0.1667885f, -0.1137127f,
  -0.1039434f, -0.2047007f, -0.0019664f, +0.2003845f, +0.4056340f, -0.0543768f, +0.5674505f, +0.1783323f,
  +0.0212985f, +0.2103699f, -0.0808276f, -0.3885853f, -0.2565176f, -0.2371130f, +0.0852370f, -0.0327185f,
  -0.0212684f, -0.0952947f, -0.0073675f, +0.1666709f, -0.0377624f, -0.1277902f, +0.1498729f, +0.0514156f,
  -0.0766784f, +0.0218922f, -0.1110491f, -0.0676076f, -0.0921788f, -0.0683537f, +0.0526602f, +0.1110047f,
  +0.2972658f, +0.1271769f, -0.2731514f, -0.1919226f, +0.0035493f, -0.0971595f, +0.0403945f, +0.1133827f,
  -0.1662659f, +0.0643719f, +0.3638317f, +0.0296623f, +0.0515241f, +0.1354210f, +0.0286198f, +0.5516974f,
  +0.0178235f, +0.3495009f, +0.1494101f, -0.1173950f, -0.0304915f, +0.0353559f, -0.0853617f, +0.0361702f,
  +0.1849571f, +0.1022101f, -0.7302502f, +0.2766110f, +0.3809533f, +0.3023814f, -0.0891013f, -0.2556820f,
  -0.0675198f, +0.0677987f, +0.0881862f, -0.4431517f, -0.0680765f, +0.2332994f, +0.0333963f, -0.3284608f,
  +0.0296804f, -0.0278518f, -0.0262140f, -0.0417086f, +0.1381027f, +0.0234699f, +0.0716492f, +0.0599333f,
  +0.0123578f, +0.0503321f, +0.0429503f, -0.1614032f, -0.2054679f, -0.0786823f, -0.1355808f, +0.0037140f,
  +0.0714835f, +0.0489327f, -0.0011526f, +0.1847567f, -0.0540050f, -0.0748143f, -0.1846801f, -0.1631887f,
  +0.0457422f, +0.4813309f, -0.2037411f, +0.1606328f, -0.0368076f, +0.0093830f, -0.1756392f, -0.2290696f,
  +0.3151680f, +0.0542784f, -0.0135508f, +0.7031046f, +0.0437505f, -0.0741726f, +0.1938887f, +0.0011562f,
  -0.2733985f, +0.6894045f, -0.0697394f, +0.1131999f, -0.0743584f, +0.2906051f, -0.3922291f, +0.1756696f,
  +0.3064838f, -0.6767779f, -0.0270744f, -0.4987380f, -0.2073961f, +0.2024412f, +0.2637694f, +0.3005906f,
  +0.2204092f, -0.5790897f, -0.3692022f, +1.0936075f, -0.0086489f, +1.2157745f, +0.1245746f, +0.2624362f,
  -0.2488994f, +0.6083212f, +0.4332694f, -0.7855475f, +0.0827691f, -0.7893798f, +0.9190819f, -0.3632796f,
  -0.2000613f, -0.0670582f, -0.4707687f, +0.3797573f, -0.1047968f, -0.1603062f, +0.1553229f, +0.0346135f,
  +0.2487482f, -0.2187274f, +0.4180164f, +0.1513674f, +0.1260906f, -0.1761116f, -0.2480479f, +0.2331034f,
  -0.3230486f, -0.2651398f, -0.4146815f, +0.0429931f, -0.7178655f, +0.3210536f, +0.4776646f, -0.3857536f,
  +0.0323831f, -0.0729939f, +0.1266601f, -0.4959616f, -0.0651885f, -0.0481833f, +0.2314084f, +0.0038299f,
  +0.0083590f, -0.1453314f, -0.0997334f, +0.4420507f, -0.3801223f, +0.2117876f, -0.0168731f, -1.1606057f,
  -0.1400970f, +0.1291479f, -0.1082581f, +0.2973432f, +0.0863861f, +0.4249971f, -0.1067078f, +0.2455156f,
  -0.0363782f, -0.2617188f, +0.0900506f, +0.9047902f, +0.0394939f, -0.1153432f, -0.0392309f, +0.2255362f,
  -0.2786742f, +0.2313176f, -0.2516061f, +0.0749908f, +0.0790099f, -0.0912003f, -0.3238480f, +0.8702956f,
  +0.2563706f, +0.1960305f, +0.2092911f, -0.1856252f, -0.2538999f, -0.4049838f, -0.2251022f, +0.0313534f,
  +0.0313724f, +0.1175725f, -0.0413031f, -0.2020400f, +0.0215779f, +0.0142472f, -0.0061522f, -0.0998425f,
  -0.3507409f, +0.0870531f, -0.3872859f, +0.2163514f, -0.1612730f, -0.1411335f, +0.0902480f, +0.1809456f,
  -0.0605577f, -0.0523256f, -0.0259182f, +0.2220104f, -0.1193537f, -0.4453074f, +0.0560091f, -0.1175835f
);

const float biases[4] = float[4](
  -0.1640113f, +0.0698706f, -0.0744643f, -0.1076078f
);

vec4 hook() {
    const vec4 r[9][2] = vec4[9][2](
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 1.0f)))
    );

    float sum[4] = biases;
    for (int n = 0; n < 4; n++) {
        for (int i = 0; i < 9; i++) {
            const vec4 k0 = vec4(kernels[n * 8 * 9 + 8 * i + 0], kernels[n * 8 * 9 + 8 * i + 1], kernels[n * 8 * 9 + 8 * i + 2], kernels[n * 8 * 9 + 8 * i + 3]);
            const vec4 k1 = vec4(kernels[n * 8 * 9 + 8 * i + 4], kernels[n * 8 * 9 + 8 * i + 5], kernels[n * 8 * 9 + 8 * i + 6], kernels[n * 8 * 9 + 8 * i + 7]);
            sum[n] += (dot(k0, r[i][0]) + dot(k1, r[i][1]));
        }
    }

    return ACTIVE(vec4(sum[0], sum[1], sum[2], sum[3]) * 0.2000000f + TEX_BIND_L2_TEXOFF(vec2(0.0f, 0.0f)) + TEX_BIND_L3_TEXOFF(vec2(0.0f, 0.0f)));
}

//!HOOK LUMA
//!DESC ARNet b4 Layer8 L1
//!WHEN OUTPUT.w LUMA.w / 1.2 > OUTPUT.h LUMA.h / 1.2 > *
//!BIND TMP1_L0
//!BIND TMP1_L1
//!BIND TMP2_L1
//!BIND FEAT_L1
//!SAVE TMP2_L1
//!COMPONENTS 4

#define ACTIVE(v) (v)

#define TEX_BIND_L0_TEXOFF TMP1_L0_texOff
#define TEX_BIND_L0_TEX TMP1_L0_tex
#define TEX_BIND_L0_POS TMP1_L0_pos
#define TEX_BIND_L0_SIZE TMP1_L0_size
#define TEX_BIND_L0_PT TMP1_L0_pt

#define TEX_BIND_L1_TEXOFF TMP1_L1_texOff
#define TEX_BIND_L1_TEX TMP1_L1_tex
#define TEX_BIND_L1_POS TMP1_L1_pos
#define TEX_BIND_L1_SIZE TMP1_L1_size
#define TEX_BIND_L1_PT TMP1_L1_pt

#define TEX_BIND_L2_TEXOFF TMP2_L1_texOff
#define TEX_BIND_L2_TEX TMP2_L1_tex
#define TEX_BIND_L2_POS TMP2_L1_pos
#define TEX_BIND_L2_SIZE TMP2_L1_size
#define TEX_BIND_L2_PT TMP2_L1_pt

#define TEX_BIND_L3_TEXOFF FEAT_L1_texOff
#define TEX_BIND_L3_TEX FEAT_L1_tex
#define TEX_BIND_L3_POS FEAT_L1_pos
#define TEX_BIND_L3_SIZE FEAT_L1_size
#define TEX_BIND_L3_PT FEAT_L1_pt

const float kernels[288] = float[288](
  +0.0430587f, +0.0226365f, +0.2160533f, +0.0685443f, -0.0291486f, +0.0724101f, +0.0107521f, -0.0566803f,
  -0.2088269f, +0.1221227f, -0.0536109f, +0.7099581f, -0.0148388f, +0.0547742f, -0.0680831f, -0.6044336f,
  +0.0249716f, -0.0215087f, -0.2133731f, +0.2881280f, +0.1787639f, -0.0657388f, -0.0633631f, +0.1571586f,
  -0.0260748f, +0.1610553f, +0.1024224f, +0.3107741f, +0.0158131f, -0.0341895f, -0.0336363f, -0.0619010f,
  +0.1200805f, -0.0323668f, -0.1420442f, -0.0391200f, +0.0432283f, -0.1995580f, +0.3557312f, +0.3321815f,
  +0.1205925f, -0.1252741f, +0.1367126f, -0.2379186f, +0.0606562f, +0.2875527f, +0.0561037f, +0.0790970f,
  -0.0231602f, +0.0499419f, +0.0312924f, -0.3213355f, -0.0872836f, -0.1299186f, +0.1330464f, +0.0009762f,
  +0.1636090f, -0.0793690f, -0.1061951f, -0.0202768f, +0.2321585f, -0.0957639f, +0.2365513f, +0.0372772f,
  +0.1474038f, -0.0617559f, +0.0345087f, +0.0634416f, +0.3284048f, -0.1989260f, -0.1259667f, +0.0874816f,
  +0.0509177f, -0.1149951f, -0.1018900f, -0.1436309f, -0.0896211f, -0.0689402f, +0.0540908f, -0.1376792f,
  +0.0818845f, -0.0074656f, +0.1133022f, -0.6851056f, -0.2119512f, -0.1816303f, +0.3187761f, +0.1933355f,
  +0.3560046f, +0.0588681f, -0.1665930f, +0.1110533f, -0.0282668f, +0.4002651f, -0.7268935f, -0.0606086f,
  +0.2493480f, -0.0405115f, -0.2901418f, +0.3562852f, +0.0497992f, -0.0903521f, +0.0916878f, +0.1117588f,
  +0.2426940f, +0.1370666f, +0.2411073f, -0.0074235f, +0.1806594f, +0.2073301f, -0.1548556f, -0.2407579f,
  +0.3154033f, +0.2117081f, -0.2107421f, -0.0797066f, +0.5698576f, +0.1818838f, -0.2655352f, +0.0974138f,
  +0.1558453f, +0.1772396f, +0.2385721f, +0.1343164f, +0.0362516f, +0.0791000f, -0.4558843f, +0.1086518f,
  +0.1717159f, -0.3761999f, +0.2264405f, -0.0261488f, -0.2629948f, +0.2147352f, +0.0944955f, -0.2523749f,
  +0.1918813f, -0.1420573f, -0.1111849f, -0.0082823f, +0.2404916f, +0.2268163f, -0.1233136f, +0.1102036f,
  +0.2191693f, +0.1756703f, -0.0395848f, +0.7591096f, -0.0341019f, +0.0354036f, -0.0424043f, -0.1410882f,
  -0.1692481f, +0.2560857f, +0.3678104f, +0.2527728f, +0.1984126f, +0.0136061f, +0.0133401f, +0.2333676f,
  +0.0902043f, +0.3462326f, -0.2704739f, +0.1196038f, +0.1782466f, -0.1390318f, -0.2285809f, -0.5836695f,
  +0.0237568f, +0.2068467f, +0.2457970f, +0.0284078f, -0.1262966f, +0.3022256f, -0.3306504f, -0.1328063f,
  -0.5274770f, +0.2100840f, -0.4918977f, -0.2175858f, -0.2379227f, -0.0849252f, +0.3273500f, +0.0721472f,
  +0.3088129f, -0.1104661f, +0.1270906f, +0.2704042f, -0.0648661f, -0.1562216f, -0.1066743f, +0.4160277f,
  +0.0154117f, -0.1129862f, -0.0567626f, -0.2307196f, +0.2331377f, -0.1092750f, +0.3751259f, -0.0430621f,
  +0.0954433f, +0.2245657f, -0.0300428f, +0.0094261f, +0.7429895f, -0.0135733f, +0.3539672f, +0.0505636f,
  +0.1148902f, +0.1345886f, +0.0932477f, -0.2878320f, +0.3108135f, -0.1579286f, -0.0487002f, +0.2495844f,
  +0.2466697f, -0.1459330f, -0.9650685f, +0.7052161f, -0.1867089f, -0.0313072f, -0.5594524f, -0.4171960f,
  +0.2411403f, -0.2605438f, +0.0834176f, -0.6645201f, +0.1815837f, -0.1067409f, +0.2165904f, +1.0017701f,
  +0.2492605f, +0.1265929f, +0.1487849f, -0.1859131f, +0.0492778f, -0.1453155f, +0.1895337f, -0.5703216f,
  +0.6546903f, -0.0864106f, -0.0742016f, +0.4038476f, +0.2510198f, +0.3719219f, +0.2574053f, +0.4395764f,
  -0.6679835f, -0.2853202f, -2.1572940f, +0.1019414f, -0.2379532f, +0.1255730f, +0.4659991f, -0.5728424f,
  +0.2856013f, -0.1162530f, +0.0851927f, +0.1200555f, -0.3734228f, -0.5482778f, +0.2063786f, -0.1373554f,
  -0.1202874f, +0.3330916f, +0.1384370f, -0.1483675f, -0.1140573f, -0.1356994f, -0.1789364f, +0.1580438f,
  -0.0589152f, -0.3771290f, +0.2764214f, +0.1111971f, -0.3271383f, +0.0723878f, +0.2846949f, -0.2660042f,
  +0.1844044f, -0.1438278f, -0.2483911f, +0.0800091f, +0.0694211f, -0.1658166f, +0.0613519f, +0.2237901f
);

const float biases[4] = float[4](
  -0.0028716f, +0.0778893f, +0.0171782f, +0.0272997f
);

vec4 hook() {
    const vec4 r[9][2] = vec4[9][2](
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 1.0f)))
    );

    float sum[4] = biases;
    for (int n = 0; n < 4; n++) {
        for (int i = 0; i < 9; i++) {
            const vec4 k0 = vec4(kernels[n * 8 * 9 + 8 * i + 0], kernels[n * 8 * 9 + 8 * i + 1], kernels[n * 8 * 9 + 8 * i + 2], kernels[n * 8 * 9 + 8 * i + 3]);
            const vec4 k1 = vec4(kernels[n * 8 * 9 + 8 * i + 4], kernels[n * 8 * 9 + 8 * i + 5], kernels[n * 8 * 9 + 8 * i + 6], kernels[n * 8 * 9 + 8 * i + 7]);
            sum[n] += (dot(k0, r[i][0]) + dot(k1, r[i][1]));
        }
    }

    return ACTIVE(vec4(sum[0], sum[1], sum[2], sum[3]) * 0.2000000f + TEX_BIND_L2_TEXOFF(vec2(0.0f, 0.0f)) + TEX_BIND_L3_TEXOFF(vec2(0.0f, 0.0f)));
}

//!HOOK LUMA
//!DESC ARNet b4 Layer9 L0
//!WHEN OUTPUT.w LUMA.w / 1.2 > OUTPUT.h LUMA.h / 1.2 > *
//!BIND TMP2_L0
//!BIND TMP2_L1
//!SAVE TMP1_L0
//!COMPONENTS 4

#define ACTIVE(v) (v)

#define TEX_BIND_L0_TEXOFF TMP2_L0_texOff
#define TEX_BIND_L0_TEX TMP2_L0_tex
#define TEX_BIND_L0_POS TMP2_L0_pos
#define TEX_BIND_L0_SIZE TMP2_L0_size
#define TEX_BIND_L0_PT TMP2_L0_pt

#define TEX_BIND_L1_TEXOFF TMP2_L1_texOff
#define TEX_BIND_L1_TEX TMP2_L1_tex
#define TEX_BIND_L1_POS TMP2_L1_pos
#define TEX_BIND_L1_SIZE TMP2_L1_size
#define TEX_BIND_L1_PT TMP2_L1_pt

const float kernels[288] = float[288](
  +0.0222117f, -0.0462912f, -0.0065840f, -0.0009863f, -0.0474545f, +0.0183056f, -0.0139470f, -0.0046639f,
  +0.0099609f, +0.1331719f, +0.0717548f, +0.0725552f, -0.1010785f, -0.0746022f, -0.0730401f, +0.0670176f,
  -0.1230633f, +0.0217333f, -0.0818647f, +0.0550891f, -0.0112904f, +0.0354619f, +0.0322388f, +0.0372002f,
  +0.0020068f, -0.0437607f, -0.0826073f, +0.0275568f, -0.0599757f, +0.0146384f, +0.0015350f, +0.0165021f,
  -0.0351907f, -0.3486898f, +0.2911269f, +0.1190447f, -0.1248025f, +0.1809647f, +0.1523183f, -0.1656695f,
  -0.0656746f, +0.0365434f, -0.0006012f, +0.0096640f, -0.1287566f, -0.0396962f, +0.1295897f, +0.0098642f,
  +0.0365079f, -0.0588889f, -0.0010856f, -0.0098462f, +0.0179882f, +0.0671615f, -0.0488807f, -0.0277337f,
  +0.0342979f, -0.0253410f, -0.0531578f, -0.1025024f, +0.0068889f, -0.2304384f, -0.0544311f, +0.0635969f,
  +0.0547717f, -0.0744312f, -0.0064509f, -0.0129594f, -0.0218738f, +0.0368470f, -0.0285817f, -0.0239614f,
  +0.0121270f, +0.1063554f, +0.0674989f, -0.0688076f, +0.1688835f, -0.0482811f, -0.0692868f, -0.0150984f,
  -0.1477702f, -0.1061082f, -0.0340640f, +0.0396317f, -0.0781958f, -0.0572479f, -0.0893539f, +0.0703827f,
  +0.1580159f, -0.0400539f, +0.1372637f, -0.0972555f, +0.0646221f, -0.0050829f, -0.1230310f, -0.0139357f,
  -0.0947295f, -0.2661216f, +0.0306922f, -0.0755469f, -0.0351733f, -0.1037936f, -0.0752144f, +0.0686103f,
  +0.0571795f, -0.1475167f, -0.0285006f, +0.1093279f, -0.2524746f, +0.3859949f, +0.4040661f, -0.1007843f,
  -0.0517278f, +0.0061455f, +0.0170092f, +0.0140958f, +0.0286648f, +0.1118128f, -0.0840319f, -0.1369950f,
  +0.0071132f, -0.0621349f, -0.0564905f, -0.0034508f, -0.1108894f, -0.1051549f, -0.0113203f, +0.0558325f,
  +0.0526316f, -0.0215529f, -0.0698958f, +0.0204531f, -0.1260912f, -0.0477525f, -0.0551974f, +0.0735782f,
  -0.0114609f, +0.1150821f, -0.0046168f, +0.0385782f, -0.1574194f, -0.0146159f, +0.1237696f, -0.0201313f,
  -0.0322446f, +0.0204549f, +0.0436078f, +0.0069415f, +0.0324353f, -0.0787735f, -0.0364218f, +0.0200522f,
  -0.1139072f, -0.0532042f, -0.0332147f, +0.1708314f, -0.2478201f, -0.0981197f, +0.0125453f, +0.0091110f,
  -0.1641690f, +0.0694260f, -0.0620675f, +0.1034021f, -0.0742939f, +0.0427982f, +0.0742564f, +0.0703572f,
  -0.0056266f, -0.1102542f, -0.1392452f, +0.0232927f, -0.2049644f, +0.1450990f, +0.1131278f, +0.0452013f,
  +0.1698441f, -0.0665976f, +0.2579579f, +0.2356879f, -0.0119943f, +0.0370167f, -0.0728886f, +0.1386419f,
  +0.0232043f, +0.1890013f, -0.0174368f, -0.0100981f, -0.2037984f, +0.0060612f, +0.2494638f, -0.0464324f,
  +0.0749166f, -0.0458196f, -0.0041604f, -0.0113872f, +0.0680510f, +0.0701626f, -0.0936264f, -0.0810975f,
  -0.0217362f, -0.0139768f, -0.0012523f, -0.0890744f, +0.0634643f, -0.1131549f, +0.0011508f, -0.0928253f,
  +0.0566014f, -0.1158756f, -0.0053985f, +0.0220056f, +0.0023619f, +0.0345371f, -0.0530322f, -0.0109254f,
  -0.0357889f, +0.0124645f, +0.0338889f, -0.0374042f, +0.1212039f, -0.0783595f, -0.1351489f, +0.0499498f,
  -0.0705993f, +0.0629030f, +0.0377838f, +0.1014871f, -0.1567099f, -0.1653511f, +0.1068851f, -0.0487551f,
  -0.1537354f, -0.1977019f, +0.0276819f, +0.0031210f, +0.0424335f, +0.0255085f, -0.1406998f, +0.0968819f,
  -0.0572071f, -0.2612328f, +0.0208825f, -0.0744629f, -0.1171932f, +0.0475013f, +0.0446789f, +0.0051674f,
  -0.0116076f, -0.0064144f, -0.1295046f, +0.2267326f, -0.0792345f, +0.3705856f, +0.2053333f, +0.2292023f,
  +0.3301387f, +0.1642651f, +0.1240258f, -0.1577446f, -0.0009719f, +0.0368622f, -0.0299779f, -0.1931056f,
  +0.0094174f, +0.0335161f, -0.0347570f, -0.0172073f, -0.0171081f, -0.1567525f, -0.0329979f, +0.0361950f,
  +0.0962999f, -0.1338283f, -0.1200168f, +0.0605449f, -0.2186422f, +0.0508709f, -0.0671014f, -0.0617740f,
  -0.0754640f, +0.2213986f, -0.0091010f, +0.1614961f, -0.1942647f, +0.0763666f, +0.1770179f, -0.0686047f
);

const float biases[4] = float[4](
  +0.0470065f, +0.0337043f, +0.0470672f, +0.0308241f
);

vec4 hook() {
    const vec4 r[9][2] = vec4[9][2](
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 1.0f)))
    );

    float sum[4] = biases;
    for (int n = 0; n < 4; n++) {
        for (int i = 0; i < 9; i++) {
            const vec4 k0 = vec4(kernels[n * 8 * 9 + 8 * i + 0], kernels[n * 8 * 9 + 8 * i + 1], kernels[n * 8 * 9 + 8 * i + 2], kernels[n * 8 * 9 + 8 * i + 3]);
            const vec4 k1 = vec4(kernels[n * 8 * 9 + 8 * i + 4], kernels[n * 8 * 9 + 8 * i + 5], kernels[n * 8 * 9 + 8 * i + 6], kernels[n * 8 * 9 + 8 * i + 7]);
            sum[n] += (dot(k0, r[i][0]) + dot(k1, r[i][1]));
        }
    }

    return ACTIVE(vec4(sum[0], sum[1], sum[2], sum[3]));
}

//!HOOK LUMA
//!DESC ACNet b4 Layer10 L0
//!WIDTH LUMA.w 2 *
//!HEIGHT LUMA.h 2 *
//!BIND TMP1_L0
//!COMPONENTS 1

#define TEX_BIND_L0_TEXOFF TMP1_L0_texOff
#define TEX_BIND_L0_TEX TMP1_L0_tex
#define TEX_BIND_L0_POS TMP1_L0_pos
#define TEX_BIND_L0_SIZE TMP1_L0_size
#define TEX_BIND_L0_PT TMP1_L0_pt

vec4 hook() {
    vec2 fcoord = fract(TEX_BIND_L0_POS * TEX_BIND_L0_SIZE);
    vec2 pos = TEX_BIND_L0_POS + (vec2(0.5f) - fcoord) * TEX_BIND_L0_PT;

    ivec2 icoord = ivec2(fcoord * vec2(2.0f));
    int index = icoord.y * 2 + icoord.x;

    vec4 r = TEX_BIND_L0_TEX(pos);

    return vec4(clamp(float[4](r.x, r.y, r.z, r.w)[index], 0.0f, 1.0f), 0.0f, 0.0f, 1.0f);
}
