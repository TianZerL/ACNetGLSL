//!HOOK LUMA
//!DESC ACNet Layer0 L0
//!WHEN OUTPUT.w LUMA.w / 1.2 > OUTPUT.h LUMA.h / 1.2 > *
//!BIND LUMA
//!SAVE TMP1_L0
//!COMPONENTS 4

#define ACTIVE(v) (max(v, 0.0f))

#define TEX_BIND_L0_TEXOFF LUMA_texOff
#define TEX_BIND_L0_TEX LUMA_tex
#define TEX_BIND_L0_POS LUMA_pos
#define TEX_BIND_L0_SIZE LUMA_size
#define TEX_BIND_L0_PT LUMA_pt

const float kernels[36] = float[36](
  -0.0663258f, -0.2231613f, +0.0424708f, +0.0170638f, -0.6830483f, -0.1597832f, +0.6756802f, +0.3221192f,
  +0.0835615f, -0.4664889f, -0.0687886f, +0.5345528f, -0.5094117f, +0.0706568f, +0.4564682f, -0.0236569f,
  +0.0353023f, -0.0183162f, -0.2031648f, +0.0470209f, -0.2231294f, +0.0534653f, +0.7074958f, +0.0913665f,
  -0.2856621f, -0.0205209f, -0.0717859f, +0.0481857f, -0.0934292f, +0.0024493f, +0.3465437f, +0.0726249f,
  +0.1661483f, +0.3210107f, +0.3292333f, -0.0985483f
);

const float biases[4] = float[4](
  -0.0264190f, -0.0229482f, -0.3021187f, -0.2578625f
);

vec4 hook() {
    const vec4 r0 = vec4(
        TEX_BIND_L0_TEXOFF(vec2(-1.0f,-1.0f)).x,
        TEX_BIND_L0_TEXOFF(vec2( 0.0f,-1.0f)).x,
        TEX_BIND_L0_TEXOFF(vec2( 1.0f,-1.0f)).x,
        TEX_BIND_L0_TEXOFF(vec2(-1.0f, 0.0f)).x
    );
    const vec4 r4 = vec4(
        TEX_BIND_L0_TEXOFF(vec2( 0.0f, 0.0f)).x,
        TEX_BIND_L0_TEXOFF(vec2( 1.0f, 0.0f)).x,
        TEX_BIND_L0_TEXOFF(vec2(-1.0f, 1.0f)).x,
        TEX_BIND_L0_TEXOFF(vec2( 0.0f, 1.0f)).x
    );
    const float r8 = TEX_BIND_L0_TEXOFF(vec2( 1.0f, 1.0f)).x;

    float sum[4] = biases;
    for(int n = 0; n < 4; n++) {
        const vec4 k0 = vec4(kernels[n * 9 + 0], kernels[n * 9 + 1], kernels[n * 9 + 2], kernels[n * 9 + 3]);
        const vec4 k4 = vec4(kernels[n * 9 + 4], kernels[n * 9 + 5], kernels[n * 9 + 6], kernels[n * 9 + 7]);
        const float k8 = kernels[n * 9 + 8];
        sum[n] += (dot(r0, k0) + dot(r4, k4) + r8 * k8);
    }

    return ACTIVE(vec4(sum[0], sum[1], sum[2], sum[3]));
}

//!HOOK LUMA
//!DESC ACNet Layer0 L1
//!WHEN OUTPUT.w LUMA.w / 1.2 > OUTPUT.h LUMA.h / 1.2 > *
//!BIND LUMA
//!SAVE TMP1_L1
//!COMPONENTS 4

#define ACTIVE(v) (max(v, 0.0f))

#define TEX_BIND_L0_TEXOFF LUMA_texOff
#define TEX_BIND_L0_TEX LUMA_tex
#define TEX_BIND_L0_POS LUMA_pos
#define TEX_BIND_L0_SIZE LUMA_size
#define TEX_BIND_L0_PT LUMA_pt

const float kernels[36] = float[36](
  +0.0119156f, +0.2041287f, -0.0189204f, +0.0608575f, +0.8354775f, +0.1405976f, -0.9182746f, -0.2455147f,
  -0.0461179f, -0.0527372f, +0.4315118f, +0.1702734f, +0.2664738f, +0.5524006f, +0.0034745f, +0.0534950f,
  -0.0470594f, -0.0265932f, +0.1569073f, +0.4733164f, +0.0026651f, +0.0179966f, +0.4136711f, +0.0132389f,
  +0.0469325f, +0.1027804f, +0.0106990f, -0.0343190f, -0.7637252f, -0.0970222f, -0.1415974f, +0.2956665f,
  +0.6621997f, +0.0000735f, +0.1268263f, -0.0634420f
);

const float biases[4] = float[4](
  -0.0326917f, -0.0053376f, -0.7776655f, +0.0232260f
);

vec4 hook() {
    const vec4 r0 = vec4(
        TEX_BIND_L0_TEXOFF(vec2(-1.0f,-1.0f)).x,
        TEX_BIND_L0_TEXOFF(vec2( 0.0f,-1.0f)).x,
        TEX_BIND_L0_TEXOFF(vec2( 1.0f,-1.0f)).x,
        TEX_BIND_L0_TEXOFF(vec2(-1.0f, 0.0f)).x
    );
    const vec4 r4 = vec4(
        TEX_BIND_L0_TEXOFF(vec2( 0.0f, 0.0f)).x,
        TEX_BIND_L0_TEXOFF(vec2( 1.0f, 0.0f)).x,
        TEX_BIND_L0_TEXOFF(vec2(-1.0f, 1.0f)).x,
        TEX_BIND_L0_TEXOFF(vec2( 0.0f, 1.0f)).x
    );
    const float r8 = TEX_BIND_L0_TEXOFF(vec2( 1.0f, 1.0f)).x;

    float sum[4] = biases;
    for(int n = 0; n < 4; n++) {
        const vec4 k0 = vec4(kernels[n * 9 + 0], kernels[n * 9 + 1], kernels[n * 9 + 2], kernels[n * 9 + 3]);
        const vec4 k4 = vec4(kernels[n * 9 + 4], kernels[n * 9 + 5], kernels[n * 9 + 6], kernels[n * 9 + 7]);
        const float k8 = kernels[n * 9 + 8];
        sum[n] += (dot(r0, k0) + dot(r4, k4) + r8 * k8);
    }

    return ACTIVE(vec4(sum[0], sum[1], sum[2], sum[3]));
}

//!HOOK LUMA
//!DESC ACNet Layer1 L0
//!WHEN OUTPUT.w LUMA.w / 1.2 > OUTPUT.h LUMA.h / 1.2 > *
//!BIND TMP1_L0
//!BIND TMP1_L1
//!SAVE TMP2_L0
//!COMPONENTS 4

#define ACTIVE(v) (max(v, 0.0f))

#define TEX_BIND_L0_TEXOFF TMP1_L0_texOff
#define TEX_BIND_L0_TEX TMP1_L0_tex
#define TEX_BIND_L0_POS TMP1_L0_pos
#define TEX_BIND_L0_SIZE TMP1_L0_size
#define TEX_BIND_L0_PT TMP1_L0_pt

#define TEX_BIND_L1_TEXOFF TMP1_L1_texOff
#define TEX_BIND_L1_TEX TMP1_L1_tex
#define TEX_BIND_L1_POS TMP1_L1_pos
#define TEX_BIND_L1_SIZE TMP1_L1_size
#define TEX_BIND_L1_PT TMP1_L1_pt

const float kernels[288] = float[288](
  -0.0000000f, -0.0000000f, +0.0000000f, -0.0000000f, +0.0000000f, -0.0000000f, -0.0000000f, +0.0000000f,
  -0.0000000f, +0.0000000f, +0.0000000f, -0.0000000f, +0.0000000f, -0.0000000f, -0.0000000f, +0.0000000f,
  -0.0000000f, +0.0000000f, +0.0000000f, -0.0000000f, -0.0000000f, -0.0000000f, -0.0000000f, +0.0000000f,
  +0.0000000f, -0.0000000f, -0.0000000f, -0.0000000f, +0.0000000f, -0.0000000f, -0.0000000f, -0.0000000f,
  +0.0000000f, +0.0000000f, -0.0000000f, -0.0000000f, +0.0000000f, -0.0000000f, -0.0000000f, +0.0000000f,
  +0.0000000f, -0.0000000f, -0.0000000f, -0.0000000f, -0.0000000f, -0.0000000f, -0.0000000f, -0.0000000f,
  -0.0000000f, -0.0000000f, +0.0000000f, -0.0000000f, +0.0000000f, -0.0000000f, -0.0000000f, -0.0000000f,
  +0.0000000f, +0.0000000f, +0.0000000f, -0.0000000f, -0.0000000f, -0.0000000f, -0.0000000f, +0.0000000f,
  -0.0000000f, -0.0000000f, +0.0000000f, -0.0000000f, -0.0000000f, -0.0000000f, -0.0000000f, +0.0000000f,
  -0.1493627f, -0.0349959f, -0.0665795f, -0.0336104f, +0.0474599f, -0.0442221f, -0.1159309f, -0.0151957f,
  -0.1043819f, -0.0250238f, -0.0264475f, +0.1226340f, -0.0014093f, -0.0394795f, -0.0537529f, +0.0096704f,
  +0.0298268f, -0.0188801f, +0.0197910f, +0.0243513f, -0.0159113f, -0.1919278f, -0.0289181f, -0.0801357f,
  +0.0147514f, +0.0300084f, -0.0417267f, +0.0171484f, -0.0229780f, -0.0318971f, +0.0679394f, +0.0894413f,
  -0.1685414f, +0.0486893f, +0.0364328f, +0.1714367f, +0.0990251f, +0.1077638f, +0.2396294f, +0.1031429f,
  -0.0881011f, -0.1341453f, +0.0315159f, +0.0403045f, +0.0128675f, -0.0527421f, +0.2085567f, -0.0202043f,
  +0.0492279f, -0.0091698f, -0.0576191f, +0.0087902f, +0.0347041f, +0.0803773f, +0.0279641f, -0.0339696f,
  -0.0307436f, -0.0110192f, +0.0234013f, -0.0700768f, +0.1467205f, +0.2576407f, +0.2778136f, -0.0145621f,
  -0.1151227f, -0.0506547f, +0.0307854f, -0.1068839f, +0.0791885f, -0.0973296f, +0.2185855f, +0.0347234f,
  +0.0000000f, +0.0000000f, +0.0000000f, -0.0000000f, +0.0000000f, -0.0000003f, -0.0000000f, -0.0000000f,
  -0.0000000f, +0.0000000f, +0.0000000f, -0.0000000f, +0.0000000f, -0.0000003f, -0.0000000f, -0.0000000f,
  +0.0000000f, -0.0000000f, +0.0000000f, -0.0000000f, +0.0000000f, -0.0000003f, -0.0000000f, -0.0000000f,
  -0.0000000f, -0.0000000f, -0.0000000f, -0.0000000f, +0.0000000f, -0.0000003f, -0.0000000f, -0.0000000f,
  -0.0000000f, -0.0000000f, +0.0000000f, -0.0000000f, +0.0000000f, -0.0000003f, -0.0000000f, -0.0000000f,
  -0.0000000f, -0.0000000f, +0.0000000f, -0.0000000f, +0.0000000f, -0.0000003f, -0.0000000f, -0.0000000f,
  +0.0000000f, -0.0000000f, -0.0000000f, -0.0000000f, -0.0000000f, -0.0000003f, -0.0000000f, -0.0000000f,
  +0.0000000f, +0.0000000f, -0.0000000f, -0.0000000f, -0.0000000f, -0.0000003f, -0.0000000f, -0.0000000f,
  -0.0000000f, +0.0000000f, +0.0000000f, -0.0000000f, +0.0000000f, -0.0000003f, -0.0000000f, -0.0000000f,
  +0.0045039f, +0.0491016f, +0.0126732f, -0.0738837f, -0.0677933f, -0.0352881f, -0.0706034f, -0.0322473f,
  -0.0133034f, -0.0024075f, +0.0339077f, +0.0141531f, +0.1354694f, +0.0070111f, +0.0555735f, -0.0107474f,
  +0.1618339f, +0.0481945f, +0.0482816f, +0.0958246f, -0.0996660f, +0.0248197f, -0.0500254f, +0.0091431f,
  +0.0659508f, -0.0708924f, +0.0443688f, +0.0428503f, +0.0354976f, -0.0106489f, -0.0828846f, +0.1211397f,
  -0.0713534f, -0.1894813f, +0.0563042f, -0.0353374f, +0.0537253f, +0.1671468f, +0.1095723f, -0.0597803f,
  +0.1725371f, -0.1658557f, +0.0122252f, +0.1361507f, +0.1150117f, +0.1282515f, +0.1331110f, +0.0548212f,
  -0.0018671f, -0.0281015f, +0.0418554f, -0.2090021f, -0.1223756f, +0.0311449f, +0.0291471f, -0.0525916f,
  +0.1059336f, +0.0208703f, +0.1199011f, -0.0228347f, +0.0353538f, +0.1209709f, -0.0118485f, -0.0690819f,
  -0.0368724f, +0.0592284f, +0.0637990f, -0.0869867f, +0.0742156f, -0.0120732f, +0.0899533f, -0.0759808f
);

const float biases[4] = float[4](
  -0.0000000f, -0.3827929f, -0.0000637f, -0.0590545f
);

vec4 hook() {
    const vec4 r[9][2] = vec4[9][2](
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 1.0f)))
    );

    float sum[4] = biases;
    for (int n = 0; n < 4; n++) {
        for (int i = 0; i < 9; i++) {
            const vec4 k0 = vec4(kernels[n * 8 * 9 + 8 * i + 0], kernels[n * 8 * 9 + 8 * i + 1], kernels[n * 8 * 9 + 8 * i + 2], kernels[n * 8 * 9 + 8 * i + 3]);
            const vec4 k1 = vec4(kernels[n * 8 * 9 + 8 * i + 4], kernels[n * 8 * 9 + 8 * i + 5], kernels[n * 8 * 9 + 8 * i + 6], kernels[n * 8 * 9 + 8 * i + 7]);
            sum[n] += (dot(k0, r[i][0]) + dot(k1, r[i][1]));
        }
    }

    return ACTIVE(vec4(sum[0], sum[1], sum[2], sum[3]));
}

//!HOOK LUMA
//!DESC ACNet Layer1 L1
//!WHEN OUTPUT.w LUMA.w / 1.2 > OUTPUT.h LUMA.h / 1.2 > *
//!BIND TMP1_L0
//!BIND TMP1_L1
//!SAVE TMP2_L1
//!COMPONENTS 4

#define ACTIVE(v) (max(v, 0.0f))

#define TEX_BIND_L0_TEXOFF TMP1_L0_texOff
#define TEX_BIND_L0_TEX TMP1_L0_tex
#define TEX_BIND_L0_POS TMP1_L0_pos
#define TEX_BIND_L0_SIZE TMP1_L0_size
#define TEX_BIND_L0_PT TMP1_L0_pt

#define TEX_BIND_L1_TEXOFF TMP1_L1_texOff
#define TEX_BIND_L1_TEX TMP1_L1_tex
#define TEX_BIND_L1_POS TMP1_L1_pos
#define TEX_BIND_L1_SIZE TMP1_L1_size
#define TEX_BIND_L1_PT TMP1_L1_pt

const float kernels[288] = float[288](
  -0.0785326f, -0.0201096f, +0.0963750f, +0.1158256f, -0.0384466f, +0.0005136f, +0.0599035f, +0.1225864f,
  +0.1365808f, +0.0614394f, +0.1751853f, +0.1338868f, -0.1315629f, +0.0678730f, +0.1625852f, -0.0107782f,
  +0.1092255f, -0.0274045f, +0.0050725f, +0.2913477f, -0.1107231f, -0.0034787f, +0.1431298f, +0.0062284f,
  -0.0325300f, +0.0608233f, +0.1915893f, +0.0102900f, +0.1825591f, +0.1768922f, +0.2223378f, +0.0145081f,
  -0.2134216f, -0.0064268f, +0.3972454f, +0.1121426f, +0.2283132f, +0.1841443f, +0.4094292f, -0.0690728f,
  -0.1219996f, -0.0091778f, +0.1285054f, +0.1756049f, -0.1650771f, +0.2228581f, +0.3146859f, +0.0509976f,
  -0.0191960f, +0.0648766f, -0.0691971f, -0.0180478f, +0.0467809f, +0.1257072f, +0.1979945f, +0.0529617f,
  +0.1045029f, -0.0612273f, +0.0493719f, +0.0847821f, +0.1491260f, +0.1768743f, +0.4305239f, -0.1529093f,
  -0.0890442f, -0.0544657f, -0.0342206f, +0.0499246f, -0.0869562f, +0.1594856f, +0.3051034f, -0.0104912f,
  -0.0869034f, +0.0053656f, -0.0948070f, +0.0091539f, +0.0242623f, +0.1320822f, +0.0405508f, +0.0877842f,
  -0.1042957f, +0.0679361f, -0.0756813f, -0.1176048f, +0.0536763f, -0.1049252f, +0.0044914f, +0.0361274f,
  +0.0301305f, +0.1079252f, -0.0369899f, +0.0468248f, -0.2476719f, -0.0670760f, -0.0193483f, -0.0203755f,
  +0.0416911f, -0.0274244f, +0.0087385f, +0.0199009f, -0.0429329f, -0.2524393f, -0.0673856f, +0.0454615f,
  -0.1267470f, -0.1765233f, -0.0579888f, -0.0397183f, -0.2247342f, +0.0111753f, -0.1554314f, -0.0490710f,
  -0.5516883f, -0.3577550f, -0.0495730f, +0.0129969f, -0.4031014f, +0.2556822f, -0.0308825f, +0.0994354f,
  +0.0896438f, +0.0245929f, -0.0774218f, +0.0422087f, -0.0351604f, -0.3386664f, +0.0891770f, -0.2570028f,
  +0.0369100f, -0.5623704f, -0.1189859f, -0.0521193f, +0.1985783f, +0.0319530f, -0.0464315f, -0.2770582f,
  -0.1545862f, -0.5903766f, -0.0740228f, -0.1225483f, -0.1594286f, +0.5942631f, +0.0682270f, +0.0627761f,
  -0.0695708f, +0.0116817f, +0.0146472f, +0.0005012f, +0.0412838f, -0.0357946f, -0.0787314f, -0.1201053f,
  -0.0057888f, +0.1560807f, +0.0576092f, +0.0639472f, -0.0731375f, -0.0048631f, -0.0075747f, -0.0751601f,
  +0.0938515f, +0.1584402f, -0.0167285f, -0.1835629f, +0.1726446f, -0.2271484f, -0.0556006f, +0.0137372f,
  +0.0284900f, +0.0580271f, +0.2121195f, +0.1409129f, +0.0258831f, +0.1232964f, +0.0797641f, -0.2947039f,
  -0.2785400f, +0.0266323f, +0.3267273f, -0.0215681f, +0.5294495f, +0.7173919f, +0.1052392f, +0.2661312f,
  +0.1420902f, -0.0085479f, +0.0456696f, +0.0859326f, +0.2450962f, -0.4172517f, +0.0086742f, -0.0237400f,
  +0.0153726f, +0.1283602f, -0.0608443f, -0.0394058f, +0.0027291f, +0.0751065f, +0.0217914f, +0.1295672f,
  -0.0435028f, +0.2071360f, -0.1176751f, +0.0829212f, +0.0401729f, +0.0252667f, +0.0373041f, +0.1475222f,
  +0.0968951f, +0.1022766f, -0.1123297f, -0.1060116f, +0.0078221f, -0.2865495f, -0.1153447f, -0.0936549f,
  +0.0298281f, +0.0716641f, -0.0670169f, -0.0526001f, -0.0091528f, +0.2042386f, -0.0442207f, +0.2093283f,
  +0.2066369f, +0.1529394f, +0.0697670f, -0.1886408f, +0.2818591f, -0.0728189f, +0.0150323f, +0.1728593f,
  +0.0197312f, -0.0121123f, -0.0502682f, -0.1119525f, -0.1593328f, +0.0219027f, +0.0290779f, +0.0676013f,
  -0.0803782f, +0.0210228f, -0.0091106f, +0.3211874f, +0.0484987f, -0.3563019f, -0.1973778f, +0.5513561f,
  -0.3948124f, +0.1194542f, +0.2426736f, -0.0979132f, +0.4518914f, +0.1317052f, -0.0148780f, +0.4686560f,
  -0.1539508f, -0.0729981f, +0.0602765f, +0.1473382f, -0.1639921f, -0.0767487f, +0.0133150f, +0.1840152f,
  -0.0579441f, -0.0116929f, +0.0352688f, +0.0869884f, +0.0581637f, +0.0388480f, +0.0139560f, +0.2236191f,
  -0.0863427f, -0.1881809f, +0.0773755f, -0.0053563f, +0.0632507f, +0.1790207f, +0.1285582f, +0.2412396f,
  -0.0543242f, -0.0986927f, +0.0166415f, -0.0026136f, -0.0287378f, -0.1190213f, +0.0706883f, +0.1316692f
);

const float biases[4] = float[4](
  +0.0009377f, -0.0299437f, -0.0011156f, -0.0756349f
);

vec4 hook() {
    const vec4 r[9][2] = vec4[9][2](
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 1.0f)))
    );

    float sum[4] = biases;
    for (int n = 0; n < 4; n++) {
        for (int i = 0; i < 9; i++) {
            const vec4 k0 = vec4(kernels[n * 8 * 9 + 8 * i + 0], kernels[n * 8 * 9 + 8 * i + 1], kernels[n * 8 * 9 + 8 * i + 2], kernels[n * 8 * 9 + 8 * i + 3]);
            const vec4 k1 = vec4(kernels[n * 8 * 9 + 8 * i + 4], kernels[n * 8 * 9 + 8 * i + 5], kernels[n * 8 * 9 + 8 * i + 6], kernels[n * 8 * 9 + 8 * i + 7]);
            sum[n] += (dot(k0, r[i][0]) + dot(k1, r[i][1]));
        }
    }

    return ACTIVE(vec4(sum[0], sum[1], sum[2], sum[3]));
}

//!HOOK LUMA
//!DESC ACNet Layer2 L0
//!WHEN OUTPUT.w LUMA.w / 1.2 > OUTPUT.h LUMA.h / 1.2 > *
//!BIND TMP2_L0
//!BIND TMP2_L1
//!SAVE TMP1_L0
//!COMPONENTS 4

#define ACTIVE(v) (max(v, 0.0f))

#define TEX_BIND_L0_TEXOFF TMP2_L0_texOff
#define TEX_BIND_L0_TEX TMP2_L0_tex
#define TEX_BIND_L0_POS TMP2_L0_pos
#define TEX_BIND_L0_SIZE TMP2_L0_size
#define TEX_BIND_L0_PT TMP2_L0_pt

#define TEX_BIND_L1_TEXOFF TMP2_L1_texOff
#define TEX_BIND_L1_TEX TMP2_L1_tex
#define TEX_BIND_L1_POS TMP2_L1_pos
#define TEX_BIND_L1_SIZE TMP2_L1_size
#define TEX_BIND_L1_PT TMP2_L1_pt

const float kernels[288] = float[288](
  -0.0000000f, +0.0579942f, +0.0000002f, +0.0293363f, +0.1200710f, -0.0211175f, -0.2562366f, -0.0483571f,
  -0.0000000f, +0.1005100f, +0.0000002f, +0.0544269f, +0.1977553f, -0.0201995f, +0.1604946f, +0.2510658f,
  -0.0000000f, -0.1061839f, +0.0000002f, -0.1208161f, +0.0774642f, +0.0937035f, -0.0332673f, +0.0483231f,
  -0.0000000f, +0.0680899f, +0.0000002f, +0.0583992f, +0.0670180f, -0.0469316f, -0.2324774f, +0.0972447f,
  -0.0000000f, +0.1278858f, +0.0000002f, +0.2226083f, +0.3653581f, -0.1591025f, +0.5403578f, +0.5501482f,
  -0.0000000f, +0.1137956f, +0.0000002f, +0.1116522f, +0.1379580f, +0.0880943f, +0.1002665f, -0.3464134f,
  -0.0000000f, -0.1588151f, +0.0000002f, -0.0960985f, +0.0607240f, -0.0566406f, -0.2168017f, +0.0124576f,
  -0.0000000f, +0.0082323f, +0.0000002f, +0.0831747f, +0.0461607f, -0.1714637f, -0.0070096f, -0.1362575f,
  -0.0000000f, -0.0914243f, +0.0000002f, -0.0659094f, +0.2373971f, -0.1050238f, -0.1069214f, -0.4199249f,
  -0.0000000f, -0.0000000f, -0.0000000f, -0.0000000f, -0.0000005f, +0.0000000f, -0.0000000f, -0.0000000f,
  -0.0000000f, +0.0000000f, -0.0000000f, -0.0000000f, -0.0000005f, -0.0000000f, -0.0000000f, -0.0000000f,
  -0.0000000f, -0.0000000f, -0.0000000f, -0.0000000f, -0.0000005f, -0.0000000f, -0.0000000f, -0.0000000f,
  -0.0000000f, +0.0000000f, -0.0000000f, -0.0000000f, -0.0000005f, +0.0000000f, -0.0000000f, -0.0000000f,
  +0.0000000f, +0.0000000f, -0.0000000f, -0.0000000f, -0.0000005f, +0.0000000f, -0.0000000f, -0.0000000f,
  -0.0000000f, +0.0000000f, -0.0000000f, -0.0000000f, -0.0000005f, +0.0000000f, -0.0000000f, +0.0000000f,
  -0.0000000f, -0.0000000f, -0.0000000f, -0.0000000f, -0.0000005f, +0.0000000f, -0.0000000f, -0.0000000f,
  -0.0000000f, -0.0000000f, -0.0000000f, -0.0000000f, -0.0000005f, +0.0000000f, -0.0000000f, +0.0000000f,
  -0.0000000f, -0.0000000f, -0.0000000f, -0.0000000f, -0.0000005f, +0.0000000f, -0.0000000f, +0.0000000f,
  -0.0000000f, -0.0000000f, -0.0000000f, +0.0000000f, -0.0000000f, +0.0000000f, +0.0000000f, -0.0000000f,
  -0.0000000f, +0.0000000f, +0.0000000f, +0.0000000f, -0.0000000f, +0.0000000f, +0.0000000f, +0.0000000f,
  +0.0000000f, +0.0000000f, +0.0000000f, -0.0000000f, -0.0000000f, -0.0000000f, -0.0000000f, -0.0000000f,
  +0.0000000f, +0.0000000f, -0.0000000f, +0.0000000f, -0.0000000f, +0.0000000f, -0.0000000f, -0.0000000f,
  -0.0000000f, -0.0000000f, -0.0000000f, -0.0000000f, -0.0000000f, -0.0000000f, +0.0000000f, -0.0000000f,
  -0.0000000f, +0.0000000f, +0.0000000f, +0.0000000f, -0.0000000f, +0.0000000f, -0.0000000f, +0.0000000f,
  +0.0000000f, +0.0000000f, +0.0000000f, +0.0000000f, -0.0000000f, +0.0000000f, -0.0000000f, -0.0000000f,
  -0.0000000f, +0.0000000f, -0.0000000f, +0.0000000f, -0.0000000f, +0.0000000f, +0.0000000f, -0.0000000f,
  +0.0000000f, +0.0000000f, -0.0000000f, +0.0000000f, -0.0000000f, +0.0000000f, -0.0000000f, -0.0000000f,
  -0.0000000f, +0.0000000f, -0.0000000f, -0.0000000f, -0.0000010f, -0.0000000f, -0.0000000f, -0.0000000f,
  -0.0000000f, +0.0000000f, -0.0000000f, -0.0000000f, -0.0000010f, +0.0000000f, -0.0000000f, +0.0000000f,
  -0.0000000f, +0.0000000f, -0.0000000f, -0.0000000f, -0.0000009f, +0.0000000f, -0.0000000f, +0.0000000f,
  +0.0000000f, +0.0000000f, -0.0000000f, -0.0000000f, -0.0000010f, -0.0000000f, -0.0000000f, -0.0000000f,
  -0.0000000f, -0.0000000f, -0.0000000f, -0.0000000f, -0.0000010f, -0.0000000f, -0.0000000f, +0.0000000f,
  -0.0000000f, -0.0000000f, -0.0000000f, -0.0000000f, -0.0000010f, +0.0000000f, -0.0000000f, -0.0000000f,
  +0.0000000f, -0.0000000f, -0.0000000f, -0.0000000f, -0.0000010f, -0.0000000f, -0.0000000f, +0.0000000f,
  -0.0000000f, -0.0000000f, -0.0000000f, -0.0000000f, -0.0000010f, +0.0000000f, -0.0000000f, +0.0000000f,
  -0.0000000f, -0.0000000f, -0.0000000f, -0.0000000f, -0.0000010f, -0.0000000f, -0.0000000f, -0.0000000f
);

const float biases[4] = float[4](
  -0.1770068f, -0.0000013f, -0.0000000f, -0.0000019f
);

vec4 hook() {
    const vec4 r[9][2] = vec4[9][2](
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 1.0f)))
    );

    float sum[4] = biases;
    for (int n = 0; n < 4; n++) {
        for (int i = 0; i < 9; i++) {
            const vec4 k0 = vec4(kernels[n * 8 * 9 + 8 * i + 0], kernels[n * 8 * 9 + 8 * i + 1], kernels[n * 8 * 9 + 8 * i + 2], kernels[n * 8 * 9 + 8 * i + 3]);
            const vec4 k1 = vec4(kernels[n * 8 * 9 + 8 * i + 4], kernels[n * 8 * 9 + 8 * i + 5], kernels[n * 8 * 9 + 8 * i + 6], kernels[n * 8 * 9 + 8 * i + 7]);
            sum[n] += (dot(k0, r[i][0]) + dot(k1, r[i][1]));
        }
    }

    return ACTIVE(vec4(sum[0], sum[1], sum[2], sum[3]));
}

//!HOOK LUMA
//!DESC ACNet Layer2 L1
//!WHEN OUTPUT.w LUMA.w / 1.2 > OUTPUT.h LUMA.h / 1.2 > *
//!BIND TMP2_L0
//!BIND TMP2_L1
//!SAVE TMP1_L1
//!COMPONENTS 4

#define ACTIVE(v) (max(v, 0.0f))

#define TEX_BIND_L0_TEXOFF TMP2_L0_texOff
#define TEX_BIND_L0_TEX TMP2_L0_tex
#define TEX_BIND_L0_POS TMP2_L0_pos
#define TEX_BIND_L0_SIZE TMP2_L0_size
#define TEX_BIND_L0_PT TMP2_L0_pt

#define TEX_BIND_L1_TEXOFF TMP2_L1_texOff
#define TEX_BIND_L1_TEX TMP2_L1_tex
#define TEX_BIND_L1_POS TMP2_L1_pos
#define TEX_BIND_L1_SIZE TMP2_L1_size
#define TEX_BIND_L1_PT TMP2_L1_pt

const float kernels[288] = float[288](
  +0.0000000f, -0.0049675f, +0.0000000f, +0.0644843f, -0.0282354f, -0.2313500f, +0.0256299f, -0.0385694f,
  +0.0000000f, +0.1541160f, +0.0000000f, +0.0662955f, -0.0292320f, -0.1378604f, -0.1235822f, -0.0927294f,
  +0.0000000f, -0.0041930f, +0.0000000f, +0.2283844f, -0.0939119f, +0.2858147f, -0.1573476f, -0.1898246f,
  +0.0000000f, -0.0610893f, +0.0000000f, -0.1021282f, +0.0513172f, -0.3241040f, -0.1219793f, +0.1137846f,
  +0.0000000f, +0.2040537f, +0.0000000f, +0.0758831f, +0.0902558f, -0.2662345f, +0.5197003f, +0.5719479f,
  +0.0000000f, +0.1958740f, +0.0000000f, -0.1753089f, -0.0246692f, +0.0615827f, +0.1997580f, -0.1826532f,
  +0.0000000f, +0.0387718f, +0.0000000f, -0.1486855f, -0.0324649f, +0.1869576f, -0.1251518f, -0.0357236f,
  -0.0000000f, +0.1689437f, +0.0000000f, +0.1073631f, +0.0580992f, +0.0472506f, +0.0987675f, -0.2137874f,
  +0.0000000f, -0.0261631f, +0.0000000f, +0.1412864f, +0.0984020f, -0.2352046f, +0.0589172f, -0.2212887f,
  -0.0000000f, +0.0000000f, +0.0000000f, -0.0000000f, -0.0000000f, -0.0000000f, -0.0000000f, +0.0000000f,
  -0.0000000f, +0.0000000f, +0.0000000f, +0.0000000f, -0.0000000f, +0.0000000f, -0.0000000f, -0.0000000f,
  +0.0000000f, -0.0000000f, -0.0000000f, -0.0000000f, -0.0000000f, -0.0000000f, -0.0000000f, -0.0000000f,
  -0.0000000f, +0.0000000f, +0.0000000f, -0.0000000f, -0.0000000f, -0.0000000f, +0.0000000f, -0.0000000f,
  -0.0000000f, +0.0000000f, -0.0000000f, -0.0000000f, -0.0000000f, -0.0000000f, -0.0000000f, -0.0000000f,
  -0.0000000f, +0.0000000f, +0.0000000f, -0.0000000f, -0.0000000f, -0.0000000f, +0.0000000f, -0.0000000f,
  -0.0000000f, -0.0000000f, +0.0000000f, +0.0000000f, -0.0000000f, +0.0000000f, -0.0000000f, +0.0000000f,
  -0.0000000f, +0.0000000f, -0.0000000f, -0.0000000f, -0.0000000f, -0.0000000f, -0.0000000f, +0.0000000f,
  +0.0000000f, +0.0000000f, +0.0000000f, +0.0000000f, +0.0000000f, -0.0000000f, +0.0000000f, +0.0000000f,
  +0.0000000f, +0.1949708f, -0.0000000f, +0.0893886f, +0.1016791f, +0.2215580f, -0.1481326f, -0.0892294f,
  -0.0000000f, +0.2313957f, -0.0000000f, +0.0664603f, +0.1028068f, -0.0642619f, -0.2090350f, +0.0339714f,
  +0.0000000f, -0.0352440f, -0.0000000f, +0.0684774f, -0.0791726f, -0.0728411f, -0.0880098f, +0.1829529f,
  -0.0000000f, +0.1687602f, -0.0000000f, +0.0061099f, +0.2085501f, -0.3233398f, -0.2721498f, +0.1720450f,
  -0.0000000f, -0.0176463f, -0.0000000f, -0.0875359f, +0.1753698f, +0.0655905f, +0.5766758f, +0.3808191f,
  -0.0000000f, -0.2041334f, -0.0000000f, +0.1179235f, -0.0709999f, +0.1116275f, +0.0176181f, +0.0374147f,
  +0.0000000f, +0.0980523f, -0.0000000f, -0.1007890f, -0.1415689f, +0.0721511f, -0.0713647f, +0.0593090f,
  +0.0000000f, -0.0679058f, -0.0000000f, +0.1529313f, -0.0384778f, -0.1694253f, +0.1297600f, -0.0004955f,
  +0.0000000f, -0.0398344f, -0.0000000f, +0.0439453f, -0.2747760f, +0.0590486f, -0.1016918f, +0.5155537f,
  -0.0000000f, +0.0640669f, +0.0000000f, -0.1729437f, +0.0851535f, +0.3483624f, -0.1548312f, +0.0131841f,
  -0.0000000f, +0.0188891f, +0.0000000f, -0.1219951f, +0.0420796f, +0.5438918f, -0.0051271f, +0.1212479f,
  -0.0000000f, -0.1063440f, +0.0000000f, -0.0495771f, -0.0501111f, -0.2236041f, +0.0497802f, -0.0125025f,
  -0.0000000f, +0.0001732f, +0.0000000f, -0.0350869f, +0.1284450f, +0.5172090f, -0.1318393f, +0.0927295f,
  -0.0000000f, +0.1993495f, +0.0000000f, -0.1252644f, +0.1963006f, +0.5709435f, +0.2802789f, -0.0659740f,
  -0.0000000f, -0.0118542f, +0.0000000f, +0.0093445f, +0.1054208f, -0.0674908f, -0.0114274f, -0.1651894f,
  -0.0000000f, -0.0936685f, +0.0000000f, -0.0743742f, -0.1009464f, -0.0359723f, -0.0340934f, +0.1954599f,
  -0.0000000f, -0.1192419f, +0.0000000f, -0.1135005f, +0.0626314f, +0.1058984f, -0.0676221f, -0.1518814f,
  -0.0000000f, -0.0189812f, +0.0000000f, +0.0027510f, +0.0887340f, -0.2298399f, -0.0123588f, -0.0817524f
);

const float biases[4] = float[4](
  -0.0129648f, -0.0000000f, +0.0146992f, +0.0260819f
);

vec4 hook() {
    const vec4 r[9][2] = vec4[9][2](
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 1.0f)))
    );

    float sum[4] = biases;
    for (int n = 0; n < 4; n++) {
        for (int i = 0; i < 9; i++) {
            const vec4 k0 = vec4(kernels[n * 8 * 9 + 8 * i + 0], kernels[n * 8 * 9 + 8 * i + 1], kernels[n * 8 * 9 + 8 * i + 2], kernels[n * 8 * 9 + 8 * i + 3]);
            const vec4 k1 = vec4(kernels[n * 8 * 9 + 8 * i + 4], kernels[n * 8 * 9 + 8 * i + 5], kernels[n * 8 * 9 + 8 * i + 6], kernels[n * 8 * 9 + 8 * i + 7]);
            sum[n] += (dot(k0, r[i][0]) + dot(k1, r[i][1]));
        }
    }

    return ACTIVE(vec4(sum[0], sum[1], sum[2], sum[3]));
}

//!HOOK LUMA
//!DESC ACNet Layer3 L0
//!WHEN OUTPUT.w LUMA.w / 1.2 > OUTPUT.h LUMA.h / 1.2 > *
//!BIND TMP1_L0
//!BIND TMP1_L1
//!SAVE TMP2_L0
//!COMPONENTS 4

#define ACTIVE(v) (max(v, 0.0f))

#define TEX_BIND_L0_TEXOFF TMP1_L0_texOff
#define TEX_BIND_L0_TEX TMP1_L0_tex
#define TEX_BIND_L0_POS TMP1_L0_pos
#define TEX_BIND_L0_SIZE TMP1_L0_size
#define TEX_BIND_L0_PT TMP1_L0_pt

#define TEX_BIND_L1_TEXOFF TMP1_L1_texOff
#define TEX_BIND_L1_TEX TMP1_L1_tex
#define TEX_BIND_L1_POS TMP1_L1_pos
#define TEX_BIND_L1_SIZE TMP1_L1_size
#define TEX_BIND_L1_PT TMP1_L1_pt

const float kernels[288] = float[288](
  -0.0003490f, +0.0000000f, -0.0000000f, +0.0000000f, -0.0000000f, +0.0000000f, -0.0000000f, -0.0000005f,
  -0.0003574f, -0.0000000f, +0.0000000f, -0.0000000f, -0.0000000f, +0.0000000f, -0.0000000f, -0.0000005f,
  -0.0003292f, +0.0000000f, +0.0000000f, +0.0000000f, -0.0000000f, +0.0000000f, -0.0000000f, -0.0000005f,
  -0.0003851f, -0.0000000f, +0.0000000f, +0.0000000f, -0.0000000f, -0.0000000f, -0.0000000f, -0.0000006f,
  -0.0003912f, -0.0000000f, -0.0000000f, +0.0000000f, -0.0000000f, -0.0000000f, -0.0000000f, -0.0000006f,
  -0.0003563f, +0.0000000f, -0.0000000f, +0.0000000f, -0.0000000f, +0.0000000f, -0.0000000f, -0.0000005f,
  -0.0003730f, -0.0000000f, -0.0000000f, -0.0000000f, -0.0000000f, +0.0000000f, -0.0000000f, -0.0000005f,
  -0.0003770f, -0.0000000f, +0.0000000f, +0.0000000f, -0.0000000f, -0.0000000f, -0.0000000f, -0.0000006f,
  -0.0003419f, -0.0000000f, +0.0000000f, -0.0000000f, -0.0000000f, -0.0000000f, -0.0000000f, -0.0000005f,
  -0.0149223f, -0.0000000f, -0.0000000f, -0.0000000f, -0.2713704f, -0.0000000f, +0.4191693f, -0.3069593f,
  -0.1192637f, -0.0000000f, -0.0000000f, -0.0000000f, -0.4502503f, -0.0000000f, -0.0162073f, -0.1729327f,
  -0.0190672f, -0.0000000f, -0.0000000f, -0.0000000f, +0.0264048f, +0.0000000f, -0.0685057f, -0.0871427f,
  -0.0026298f, -0.0000000f, +0.0000000f, -0.0000000f, -0.0795804f, -0.0000000f, -0.0270601f, -0.1674021f,
  +0.2175589f, -0.0000000f, +0.0000000f, -0.0000000f, +0.5069821f, -0.0000000f, +0.5616201f, +0.0188612f,
  +0.0301480f, -0.0000000f, -0.0000000f, -0.0000000f, -0.0787943f, -0.0000000f, +0.1669585f, -0.1711179f,
  +0.1437155f, -0.0000000f, +0.0000000f, -0.0000000f, -0.0375396f, -0.0000000f, -0.0017677f, +0.0865944f,
  +0.0350663f, -0.0000000f, +0.0000000f, -0.0000000f, -0.0071115f, -0.0000000f, +0.1884233f, +0.3002526f,
  -0.0101837f, -0.0000000f, +0.0000000f, -0.0000000f, -0.3974056f, -0.0000000f, -0.0604927f, -0.0761413f,
  +0.0113170f, -0.0000000f, -0.0000000f, -0.0000000f, +0.1579455f, -0.0000000f, -0.1149769f, -0.0667985f,
  +0.1067787f, -0.0000000f, -0.0000000f, -0.0000000f, -0.1442890f, +0.0000000f, -0.0129252f, -0.0358999f,
  -0.0512831f, -0.0000000f, +0.0000000f, -0.0000000f, -0.0605014f, +0.0000000f, +0.0267352f, -0.0561107f,
  -0.1287203f, -0.0000000f, +0.0000000f, -0.0000000f, +0.0591135f, -0.0000000f, -0.0814695f, +0.0951813f,
  +0.4258034f, -0.0000000f, -0.0000000f, -0.0000000f, +0.3439138f, -0.0000000f, +0.2967802f, +0.0212161f,
  +0.0496780f, -0.0000000f, -0.0000000f, -0.0000000f, +0.1416504f, +0.0000000f, +0.1897056f, +0.2047737f,
  -0.2837203f, -0.0000000f, -0.0000000f, -0.0000000f, +0.0525637f, +0.0000000f, +0.0201491f, +0.0085923f,
  -0.1347949f, -0.0000000f, +0.0000000f, -0.0000000f, -0.1820950f, -0.0000000f, +0.0024207f, +0.0068615f,
  -0.0738132f, -0.0000000f, +0.0000000f, -0.0000000f, -0.0681763f, -0.0000000f, -0.1254866f, +0.0382524f,
  +0.0045098f, -0.0000000f, -0.0000000f, -0.0000000f, -0.0933273f, -0.0000000f, +0.0784027f, -0.2160826f,
  +0.2132147f, -0.0000000f, +0.0000000f, -0.0000000f, +0.1531418f, +0.0000000f, +0.1640703f, -0.4461937f,
  +0.0034612f, -0.0000000f, -0.0000000f, -0.0000000f, +0.1067591f, -0.0000000f, +0.0799316f, -0.0444695f,
  +0.3566211f, -0.0000000f, +0.0000000f, -0.0000000f, +0.2597929f, +0.0000000f, +0.3225338f, -0.3942960f,
  +0.0475318f, -0.0000000f, +0.0000000f, -0.0000000f, -0.6682644f, -0.0000000f, -0.2603576f, -0.8237315f,
  +0.2531851f, -0.0000000f, +0.0000000f, -0.0000000f, +0.2372653f, -0.0000000f, -0.0897266f, -0.7064624f,
  +0.0412753f, -0.0000000f, -0.0000000f, -0.0000000f, +0.1485455f, -0.0000000f, -0.0751455f, -0.0069004f,
  +0.1795130f, -0.0000000f, -0.0000000f, -0.0000000f, +0.1920462f, +0.0000000f, +0.0155359f, -0.4969732f,
  +0.0322388f, -0.0000000f, +0.0000000f, -0.0000000f, +0.0882457f, +0.0000000f, -0.0827104f, -0.1421158f
);

const float biases[4] = float[4](
  -0.0000004f, +0.0044550f, -0.0008127f, +0.3240792f
);

vec4 hook() {
    const vec4 r[9][2] = vec4[9][2](
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 1.0f)))
    );

    float sum[4] = biases;
    for (int n = 0; n < 4; n++) {
        for (int i = 0; i < 9; i++) {
            const vec4 k0 = vec4(kernels[n * 8 * 9 + 8 * i + 0], kernels[n * 8 * 9 + 8 * i + 1], kernels[n * 8 * 9 + 8 * i + 2], kernels[n * 8 * 9 + 8 * i + 3]);
            const vec4 k1 = vec4(kernels[n * 8 * 9 + 8 * i + 4], kernels[n * 8 * 9 + 8 * i + 5], kernels[n * 8 * 9 + 8 * i + 6], kernels[n * 8 * 9 + 8 * i + 7]);
            sum[n] += (dot(k0, r[i][0]) + dot(k1, r[i][1]));
        }
    }

    return ACTIVE(vec4(sum[0], sum[1], sum[2], sum[3]));
}

//!HOOK LUMA
//!DESC ACNet Layer3 L1
//!WHEN OUTPUT.w LUMA.w / 1.2 > OUTPUT.h LUMA.h / 1.2 > *
//!BIND TMP1_L0
//!BIND TMP1_L1
//!SAVE TMP2_L1
//!COMPONENTS 4

#define ACTIVE(v) (max(v, 0.0f))

#define TEX_BIND_L0_TEXOFF TMP1_L0_texOff
#define TEX_BIND_L0_TEX TMP1_L0_tex
#define TEX_BIND_L0_POS TMP1_L0_pos
#define TEX_BIND_L0_SIZE TMP1_L0_size
#define TEX_BIND_L0_PT TMP1_L0_pt

#define TEX_BIND_L1_TEXOFF TMP1_L1_texOff
#define TEX_BIND_L1_TEX TMP1_L1_tex
#define TEX_BIND_L1_POS TMP1_L1_pos
#define TEX_BIND_L1_SIZE TMP1_L1_size
#define TEX_BIND_L1_PT TMP1_L1_pt

const float kernels[288] = float[288](
  -0.0000019f, -0.0000000f, +0.0000000f, -0.0000000f, -0.0000000f, -0.0000000f, -0.0000000f, -0.0000001f,
  -0.0000018f, -0.0000000f, +0.0000000f, -0.0000000f, -0.0000000f, -0.0000000f, -0.0000000f, -0.0000001f,
  -0.0000016f, -0.0000000f, -0.0000000f, -0.0000000f, -0.0000000f, -0.0000000f, -0.0000000f, -0.0000001f,
  -0.0000019f, -0.0000000f, +0.0000000f, -0.0000000f, -0.0000000f, -0.0000000f, -0.0000000f, -0.0000001f,
  -0.0000019f, -0.0000000f, -0.0000000f, -0.0000000f, -0.0000000f, -0.0000000f, -0.0000000f, -0.0000001f,
  -0.0000017f, -0.0000000f, +0.0000000f, -0.0000000f, -0.0000000f, -0.0000000f, -0.0000000f, -0.0000001f,
  -0.0000019f, -0.0000000f, +0.0000000f, -0.0000000f, -0.0000000f, -0.0000000f, -0.0000000f, -0.0000001f,
  -0.0000019f, -0.0000000f, +0.0000000f, -0.0000000f, -0.0000000f, +0.0000000f, -0.0000000f, -0.0000001f,
  -0.0000017f, -0.0000000f, +0.0000000f, -0.0000000f, -0.0000000f, -0.0000000f, -0.0000000f, -0.0000001f,
  -0.0000000f, -0.0000000f, +0.0000000f, -0.0000000f, -0.0000000f, -0.0000000f, -0.0000000f, -0.0000000f,
  -0.0000000f, -0.0000000f, +0.0000000f, -0.0000000f, +0.0000000f, +0.0000000f, -0.0000000f, -0.0000000f,
  -0.0000000f, -0.0000000f, +0.0000000f, -0.0000000f, +0.0000000f, +0.0000000f, -0.0000000f, -0.0000000f,
  -0.0000000f, -0.0000000f, -0.0000000f, -0.0000000f, +0.0000000f, -0.0000000f, -0.0000000f, -0.0000000f,
  -0.0000000f, +0.0000000f, -0.0000000f, +0.0000000f, +0.0000000f, -0.0000000f, +0.0000000f, -0.0000000f,
  -0.0000000f, +0.0000000f, -0.0000000f, +0.0000000f, +0.0000000f, +0.0000000f, -0.0000000f, -0.0000000f,
  -0.0000000f, -0.0000000f, -0.0000000f, +0.0000000f, -0.0000000f, -0.0000000f, -0.0000000f, -0.0000000f,
  -0.0000000f, +0.0000000f, -0.0000000f, -0.0000000f, -0.0000000f, -0.0000000f, -0.0000000f, -0.0000000f,
  -0.0000000f, +0.0000000f, +0.0000000f, -0.0000000f, -0.0000000f, -0.0000000f, -0.0000000f, -0.0000000f,
  -0.0000000f, +0.0000000f, +0.0000000f, -0.0000000f, -0.0000000f, -0.0000000f, +0.0000000f, -0.0000000f,
  -0.0000000f, +0.0000000f, -0.0000000f, +0.0000000f, +0.0000000f, +0.0000000f, -0.0000000f, +0.0000000f,
  -0.0000000f, -0.0000000f, +0.0000000f, -0.0000000f, -0.0000000f, -0.0000000f, +0.0000000f, -0.0000000f,
  -0.0000000f, +0.0000000f, -0.0000000f, +0.0000000f, +0.0000000f, -0.0000000f, -0.0000000f, -0.0000000f,
  -0.0000000f, +0.0000000f, -0.0000000f, -0.0000000f, -0.0000000f, +0.0000000f, +0.0000000f, -0.0000000f,
  -0.0000000f, -0.0000000f, +0.0000000f, -0.0000000f, -0.0000000f, -0.0000000f, -0.0000000f, -0.0000000f,
  -0.0000000f, +0.0000000f, +0.0000000f, -0.0000000f, +0.0000000f, +0.0000000f, +0.0000000f, -0.0000000f,
  -0.0000000f, +0.0000000f, +0.0000000f, -0.0000000f, -0.0000000f, +0.0000000f, +0.0000000f, +0.0000000f,
  -0.0000000f, -0.0000000f, -0.0000000f, -0.0000000f, +0.0000000f, -0.0000000f, -0.0000000f, +0.0000000f,
  +0.1373294f, +0.0000003f, -0.0000000f, +0.0000010f, +0.0100369f, +0.0000000f, -0.3296692f, -0.0101221f,
  +0.1848480f, +0.0000003f, -0.0000000f, +0.0000011f, +0.1495733f, -0.0000000f, -0.2598130f, +0.0741272f,
  +0.0761794f, +0.0000004f, -0.0000000f, +0.0000011f, -0.0490095f, -0.0000000f, -0.1301588f, -0.0715539f,
  +0.0817192f, +0.0000003f, +0.0000000f, +0.0000011f, +0.0268770f, +0.0000000f, -0.2650676f, +0.0778689f,
  +0.3334340f, +0.0000004f, +0.0000000f, +0.0000012f, +0.1906741f, -0.0000000f, +0.3228217f, +0.1573364f,
  +0.0298567f, +0.0000004f, -0.0000000f, +0.0000012f, -0.0019339f, -0.0000000f, +0.4320436f, +0.1328661f,
  -0.0042753f, +0.0000004f, -0.0000000f, +0.0000012f, -0.0220805f, +0.0000000f, -0.0709356f, -0.0954307f,
  +0.2095735f, +0.0000004f, -0.0000000f, +0.0000012f, -0.1513694f, +0.0000000f, +0.1979959f, +0.1098428f,
  +0.0185821f, +0.0000004f, -0.0000000f, +0.0000012f, -0.1608796f, +0.0000000f, +0.0949161f, -0.0767590f
);

const float biases[4] = float[4](
  -0.0000001f, -0.0000000f, -0.0000000f, -0.0323937f
);

vec4 hook() {
    const vec4 r[9][2] = vec4[9][2](
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 1.0f)))
    );

    float sum[4] = biases;
    for (int n = 0; n < 4; n++) {
        for (int i = 0; i < 9; i++) {
            const vec4 k0 = vec4(kernels[n * 8 * 9 + 8 * i + 0], kernels[n * 8 * 9 + 8 * i + 1], kernels[n * 8 * 9 + 8 * i + 2], kernels[n * 8 * 9 + 8 * i + 3]);
            const vec4 k1 = vec4(kernels[n * 8 * 9 + 8 * i + 4], kernels[n * 8 * 9 + 8 * i + 5], kernels[n * 8 * 9 + 8 * i + 6], kernels[n * 8 * 9 + 8 * i + 7]);
            sum[n] += (dot(k0, r[i][0]) + dot(k1, r[i][1]));
        }
    }

    return ACTIVE(vec4(sum[0], sum[1], sum[2], sum[3]));
}

//!HOOK LUMA
//!DESC ACNet Layer4 L0
//!WHEN OUTPUT.w LUMA.w / 1.2 > OUTPUT.h LUMA.h / 1.2 > *
//!BIND TMP2_L0
//!BIND TMP2_L1
//!SAVE TMP1_L0
//!COMPONENTS 4

#define ACTIVE(v) (max(v, 0.0f))

#define TEX_BIND_L0_TEXOFF TMP2_L0_texOff
#define TEX_BIND_L0_TEX TMP2_L0_tex
#define TEX_BIND_L0_POS TMP2_L0_pos
#define TEX_BIND_L0_SIZE TMP2_L0_size
#define TEX_BIND_L0_PT TMP2_L0_pt

#define TEX_BIND_L1_TEXOFF TMP2_L1_texOff
#define TEX_BIND_L1_TEX TMP2_L1_tex
#define TEX_BIND_L1_POS TMP2_L1_pos
#define TEX_BIND_L1_SIZE TMP2_L1_size
#define TEX_BIND_L1_PT TMP2_L1_pt

const float kernels[288] = float[288](
  -0.0000000f, -0.0000000f, -0.0000000f, -0.0000000f, +0.0000000f, -0.0000000f, +0.0000000f, -0.0000000f,
  +0.0000000f, -0.0000000f, +0.0000000f, -0.0000000f, +0.0000000f, -0.0000000f, -0.0000000f, -0.0000000f,
  -0.0000000f, -0.0000000f, -0.0000000f, +0.0000000f, -0.0000000f, +0.0000000f, +0.0000000f, -0.0000000f,
  +0.0000000f, -0.0000000f, +0.0000000f, -0.0000000f, -0.0000000f, -0.0000000f, -0.0000000f, -0.0000000f,
  -0.0000000f, -0.0000000f, +0.0000000f, -0.0000000f, -0.0000000f, -0.0000000f, -0.0000000f, -0.0000000f,
  -0.0000000f, +0.0000000f, -0.0000000f, -0.0000000f, -0.0000000f, -0.0000000f, +0.0000000f, -0.0000000f,
  -0.0000000f, -0.0000000f, +0.0000000f, +0.0000000f, -0.0000000f, -0.0000000f, +0.0000000f, -0.0000000f,
  +0.0000000f, +0.0000000f, +0.0000000f, +0.0000000f, -0.0000000f, +0.0000000f, +0.0000000f, -0.0000000f,
  -0.0000000f, +0.0000000f, -0.0000000f, +0.0000000f, +0.0000000f, +0.0000000f, +0.0000000f, -0.0000000f,
  -0.0000000f, -0.0801365f, -0.0287508f, -0.0074696f, +0.0000000f, -0.0000000f, -0.0000000f, -0.1415261f,
  -0.0000000f, +0.0138090f, +0.0991725f, +0.0508063f, -0.0000000f, -0.0000000f, +0.0000000f, +0.0940233f,
  -0.0000000f, +0.0016846f, +0.0558414f, -0.1717886f, -0.0000000f, -0.0000000f, +0.0000000f, -0.0985264f,
  +0.0000000f, +0.0379602f, -0.0403831f, +0.0503035f, +0.0000000f, +0.0000000f, -0.0000000f, +0.2067816f,
  +0.0000000f, +0.0875574f, +0.1085644f, -0.4032201f, +0.0000000f, -0.0000000f, +0.0000000f, +0.4084234f,
  -0.0000000f, -0.3549792f, -0.5433911f, +0.7475975f, -0.0000000f, +0.0000000f, -0.0000000f, -0.1185330f,
  +0.0000000f, +0.0098165f, +0.0132448f, -0.0923422f, -0.0000000f, +0.0000000f, -0.0000000f, -0.1410830f,
  -0.0000000f, +0.0983844f, -0.0476419f, +0.1195763f, -0.0000000f, -0.0000000f, +0.0000000f, -0.1100508f,
  -0.0000000f, +0.1239450f, -0.1042719f, -0.1887071f, +0.0000000f, +0.0000000f, -0.0000000f, -0.0812737f,
  +0.0000000f, -0.0817003f, -0.0615784f, +0.0490247f, -0.0000000f, +0.0000000f, -0.0000000f, -0.2374898f,
  +0.0000000f, -0.1821471f, -0.3390652f, +0.3373804f, +0.0000000f, -0.0000000f, -0.0000000f, -0.2700844f,
  +0.0000000f, -0.1601115f, +0.0022344f, -0.1810388f, -0.0000000f, +0.0000000f, -0.0000000f, -0.0015222f,
  -0.0000000f, -0.1420291f, +0.1506031f, -0.2505106f, +0.0000000f, +0.0000000f, -0.0000000f, +0.1480602f,
  -0.0000000f, +0.0537906f, -0.1919928f, +0.0823625f, -0.0000000f, +0.0000000f, -0.0000000f, +0.0907835f,
  -0.0000000f, -0.0376634f, -0.0552742f, +0.2032488f, +0.0000000f, +0.0000000f, -0.0000000f, +0.0271698f,
  -0.0000000f, -0.1170530f, +0.0623000f, +0.0569883f, -0.0000000f, +0.0000000f, +0.0000000f, +0.1870588f,
  -0.0000000f, -0.1260407f, +0.0910843f, -0.1511807f, +0.0000000f, +0.0000000f, +0.0000000f, +0.1816232f,
  +0.0000000f, -0.0084890f, +0.0137882f, +0.0688971f, +0.0000000f, -0.0000000f, +0.0000000f, -0.1179856f,
  -0.0000000f, +0.1183482f, +0.0353757f, -0.0669485f, -0.0000000f, -0.0000000f, -0.0000000f, -0.0045583f,
  -0.0000000f, -0.2762378f, +0.0891911f, +0.2288570f, -0.0000000f, +0.0000000f, -0.0000000f, -0.1063511f,
  -0.0000000f, +0.1144569f, +0.0676428f, +0.1814346f, -0.0000000f, +0.0000000f, -0.0000000f, -0.0749618f,
  -0.0000000f, +0.1357426f, -0.0827161f, +0.1863618f, -0.0000000f, +0.0000000f, -0.0000000f, -0.1274116f,
  +0.0000000f, +0.4310856f, +0.2417847f, -0.2480014f, -0.0000000f, -0.0000000f, +0.0000000f, +0.2723416f,
  +0.0000000f, +0.1322690f, +0.0608183f, +0.1718482f, -0.0000000f, -0.0000000f, +0.0000000f, +0.1050812f,
  +0.0000000f, +0.0325539f, -0.0677222f, -0.0065479f, -0.0000000f, -0.0000000f, +0.0000000f, -0.2120709f,
  -0.0000000f, +0.1713870f, -0.0337116f, +0.1882765f, -0.0000000f, +0.0000000f, +0.0000000f, +0.0967202f,
  -0.0000000f, -0.1198775f, +0.0306644f, -0.0744637f, -0.0000000f, +0.0000000f, -0.0000000f, +0.0346406f
);

const float biases[4] = float[4](
  -0.0000000f, -0.0141302f, -0.0194104f, -0.0187029f
);

vec4 hook() {
    const vec4 r[9][2] = vec4[9][2](
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 1.0f)))
    );

    float sum[4] = biases;
    for (int n = 0; n < 4; n++) {
        for (int i = 0; i < 9; i++) {
            const vec4 k0 = vec4(kernels[n * 8 * 9 + 8 * i + 0], kernels[n * 8 * 9 + 8 * i + 1], kernels[n * 8 * 9 + 8 * i + 2], kernels[n * 8 * 9 + 8 * i + 3]);
            const vec4 k1 = vec4(kernels[n * 8 * 9 + 8 * i + 4], kernels[n * 8 * 9 + 8 * i + 5], kernels[n * 8 * 9 + 8 * i + 6], kernels[n * 8 * 9 + 8 * i + 7]);
            sum[n] += (dot(k0, r[i][0]) + dot(k1, r[i][1]));
        }
    }

    return ACTIVE(vec4(sum[0], sum[1], sum[2], sum[3]));
}

//!HOOK LUMA
//!DESC ACNet Layer4 L1
//!WHEN OUTPUT.w LUMA.w / 1.2 > OUTPUT.h LUMA.h / 1.2 > *
//!BIND TMP2_L0
//!BIND TMP2_L1
//!SAVE TMP1_L1
//!COMPONENTS 4

#define ACTIVE(v) (max(v, 0.0f))

#define TEX_BIND_L0_TEXOFF TMP2_L0_texOff
#define TEX_BIND_L0_TEX TMP2_L0_tex
#define TEX_BIND_L0_POS TMP2_L0_pos
#define TEX_BIND_L0_SIZE TMP2_L0_size
#define TEX_BIND_L0_PT TMP2_L0_pt

#define TEX_BIND_L1_TEXOFF TMP2_L1_texOff
#define TEX_BIND_L1_TEX TMP2_L1_tex
#define TEX_BIND_L1_POS TMP2_L1_pos
#define TEX_BIND_L1_SIZE TMP2_L1_size
#define TEX_BIND_L1_PT TMP2_L1_pt

const float kernels[288] = float[288](
  +0.0000000f, -0.0841975f, -0.1384769f, +0.0047601f, -0.0000036f, -0.0000000f, -0.0000000f, -0.0911673f,
  +0.0000000f, +0.0638344f, -0.0660902f, +0.0439410f, -0.0000036f, -0.0000000f, -0.0000000f, +0.1237436f,
  +0.0000000f, +0.0231571f, -0.0772014f, -0.0359854f, -0.0000032f, -0.0000000f, -0.0000000f, -0.0383036f,
  +0.0000000f, -0.0212804f, -0.0519633f, +0.0176916f, -0.0000037f, -0.0000000f, -0.0000000f, +0.2264054f,
  +0.0000000f, +0.2907369f, +0.0606433f, -0.2370544f, -0.0000036f, -0.0000000f, -0.0000000f, +0.2485498f,
  +0.0000000f, +0.0858832f, -0.0499317f, +0.2106232f, -0.0000033f, -0.0000000f, -0.0000000f, -0.0431737f,
  +0.0000000f, -0.1369535f, +0.1177853f, +0.0771742f, -0.0000036f, -0.0000000f, -0.0000000f, +0.1436397f,
  +0.0000000f, -0.1604658f, +0.1752062f, -0.0766157f, -0.0000035f, -0.0000000f, -0.0000000f, +0.1843825f,
  +0.0000000f, -0.0458340f, +0.0303657f, +0.0201018f, -0.0000033f, -0.0000000f, -0.0000000f, +0.0116169f,
  +0.0000000f, +0.0756573f, -0.0085909f, +0.0206017f, +0.0000000f, -0.0000000f, -0.0000000f, +0.1092897f,
  +0.0000000f, -0.0010697f, +0.1217695f, -0.0246243f, +0.0000000f, +0.0000000f, +0.0000000f, +0.0298949f,
  +0.0000000f, +0.0303188f, +0.2643402f, +0.1374093f, +0.0000000f, -0.0000000f, -0.0000000f, -0.1492291f,
  +0.0000000f, -0.0476424f, +0.0244675f, +0.0186414f, -0.0000000f, -0.0000000f, +0.0000000f, -0.1123360f,
  -0.0000000f, -0.0944538f, +0.0504840f, +0.4048376f, +0.0000000f, -0.0000000f, -0.0000000f, -0.1051381f,
  -0.0000000f, -0.0265435f, +0.3469778f, +0.3297559f, +0.0000000f, -0.0000000f, -0.0000000f, -0.0132801f,
  +0.0000000f, -0.0531288f, -0.0014764f, -0.4480937f, -0.0000000f, +0.0000000f, -0.0000000f, +0.2225505f,
  +0.0000000f, -0.1966669f, +0.0373744f, -0.0032104f, +0.0000000f, -0.0000000f, -0.0000000f, +0.0064152f,
  +0.0000000f, -0.1085147f, +0.1265830f, +0.0016290f, +0.0000000f, -0.0000000f, -0.0000000f, -0.0163092f,
  -0.0000000f, +0.0636387f, +0.0017673f, -0.0507479f, -0.0000000f, -0.0000000f, +0.0000000f, +0.0643909f,
  -0.0000000f, -0.0337199f, +0.0636455f, +0.0656410f, +0.0000000f, +0.0000000f, +0.0000000f, -0.1307894f,
  -0.0000000f, -0.0234530f, -0.0151269f, -0.0025353f, +0.0000000f, -0.0000000f, +0.0000000f, -0.0379800f,
  -0.0000000f, +0.1947666f, -0.0377874f, +0.0849547f, +0.0000000f, +0.0000000f, +0.0000000f, -0.3236172f,
  +0.0000000f, +0.0522672f, -0.1403731f, +0.7423050f, +0.0000000f, +0.0000000f, -0.0000000f, -0.3723903f,
  +0.0000000f, +0.0185646f, -0.0362305f, +0.1379549f, -0.0000000f, +0.0000000f, +0.0000000f, -0.0801822f,
  +0.0000000f, +0.1604763f, -0.0156360f, -0.1455158f, -0.0000000f, -0.0000000f, +0.0000000f, -0.2678698f,
  +0.0000000f, +0.2763577f, -0.0787419f, +0.2086909f, +0.0000000f, -0.0000000f, +0.0000000f, -0.3123955f,
  -0.0000000f, +0.0159301f, -0.0241365f, +0.0407391f, -0.0000000f, -0.0000000f, +0.0000000f, -0.0127977f,
  -0.0000000f, -0.0928971f, -0.0525397f, -0.1563520f, -0.0000000f, +0.0000000f, +0.0000000f, -0.0293272f,
  +0.0000000f, +0.1803966f, -0.3685637f, +0.3858359f, +0.0000000f, +0.0000000f, -0.0000000f, -0.0427460f,
  -0.0000000f, -0.4326880f, +0.1124637f, -0.1443408f, -0.0000000f, -0.0000000f, -0.0000000f, -0.1501783f,
  -0.0000000f, -0.0766689f, -0.0236319f, +0.1752343f, -0.0000000f, +0.0000000f, -0.0000000f, +0.0863537f,
  -0.0000000f, +0.4355440f, +0.1316511f, +0.0372535f, -0.0000000f, -0.0000000f, -0.0000000f, +0.2813972f,
  +0.0000000f, -0.0448696f, -0.0153800f, +0.4978355f, +0.0000000f, -0.0000000f, +0.0000000f, +0.0129695f,
  -0.0000000f, -0.0232493f, -0.0114667f, +0.0584843f, -0.0000000f, -0.0000000f, +0.0000000f, -0.2075509f,
  +0.0000000f, -0.1180478f, -0.0537537f, -0.0847105f, +0.0000000f, +0.0000000f, -0.0000000f, +0.0675476f,
  -0.0000000f, +0.1050736f, -0.0416188f, -0.0774976f, -0.0000000f, +0.0000000f, +0.0000000f, -0.0360494f
);

const float biases[4] = float[4](
  -0.0291770f, -0.0406349f, +0.0780971f, -0.1164277f
);

vec4 hook() {
    const vec4 r[9][2] = vec4[9][2](
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 1.0f)))
    );

    float sum[4] = biases;
    for (int n = 0; n < 4; n++) {
        for (int i = 0; i < 9; i++) {
            const vec4 k0 = vec4(kernels[n * 8 * 9 + 8 * i + 0], kernels[n * 8 * 9 + 8 * i + 1], kernels[n * 8 * 9 + 8 * i + 2], kernels[n * 8 * 9 + 8 * i + 3]);
            const vec4 k1 = vec4(kernels[n * 8 * 9 + 8 * i + 4], kernels[n * 8 * 9 + 8 * i + 5], kernels[n * 8 * 9 + 8 * i + 6], kernels[n * 8 * 9 + 8 * i + 7]);
            sum[n] += (dot(k0, r[i][0]) + dot(k1, r[i][1]));
        }
    }

    return ACTIVE(vec4(sum[0], sum[1], sum[2], sum[3]));
}

//!HOOK LUMA
//!DESC ACNet Layer5 L0
//!WHEN OUTPUT.w LUMA.w / 1.2 > OUTPUT.h LUMA.h / 1.2 > *
//!BIND TMP1_L0
//!BIND TMP1_L1
//!SAVE TMP2_L0
//!COMPONENTS 4

#define ACTIVE(v) (max(v, 0.0f))

#define TEX_BIND_L0_TEXOFF TMP1_L0_texOff
#define TEX_BIND_L0_TEX TMP1_L0_tex
#define TEX_BIND_L0_POS TMP1_L0_pos
#define TEX_BIND_L0_SIZE TMP1_L0_size
#define TEX_BIND_L0_PT TMP1_L0_pt

#define TEX_BIND_L1_TEXOFF TMP1_L1_texOff
#define TEX_BIND_L1_TEX TMP1_L1_tex
#define TEX_BIND_L1_POS TMP1_L1_pos
#define TEX_BIND_L1_SIZE TMP1_L1_size
#define TEX_BIND_L1_PT TMP1_L1_pt

const float kernels[288] = float[288](
  +0.0000000f, +0.0775988f, +0.0220104f, -0.0735479f, +0.0257716f, +0.0098690f, +0.0464095f, +0.1281832f,
  +0.0000000f, +0.0250431f, -0.0391201f, -0.2049240f, -0.1343581f, -0.0213381f, +0.3470118f, +0.0406604f,
  -0.0000000f, -0.0140992f, -0.1155769f, +0.1404273f, -0.0592846f, -0.1217547f, +0.0265874f, +0.0767148f,
  -0.0000000f, -0.0331840f, +0.0916327f, -0.0604114f, -0.0939831f, +0.0179357f, +0.0841751f, +0.0879914f,
  +0.0000000f, +0.5686290f, +0.1306980f, +0.0577095f, +0.1154504f, -0.0278107f, +0.5271185f, +0.4655613f,
  +0.0000000f, -0.0270010f, +0.1248939f, -0.0368399f, +0.1160247f, +0.0670365f, +0.0689993f, -0.0400251f,
  +0.0000000f, -0.0526587f, -0.0440403f, +0.0131730f, -0.0185048f, -0.0051401f, -0.0807560f, +0.0021251f,
  -0.0000000f, +0.0547133f, -0.0163241f, +0.0023215f, +0.0614978f, +0.0764212f, +0.1964846f, -0.0083784f,
  +0.0000000f, +0.0023991f, -0.0496306f, +0.0118203f, -0.0130975f, -0.1079393f, -0.0846388f, +0.0598594f,
  +0.0000000f, +0.3200668f, +0.0862944f, -0.3819047f, -0.1861110f, +0.0066194f, +0.1292450f, +0.0796742f,
  -0.0000000f, +0.1579989f, -0.1339757f, +0.3839336f, -0.0112414f, -0.0424411f, -0.0591616f, +0.0276557f,
  -0.0000000f, -0.0195942f, -0.1069387f, +0.0165871f, -0.0425383f, -0.1116723f, -0.0009195f, +0.0071211f,
  -0.0000000f, -0.0453154f, +0.0860835f, +0.1500167f, -0.0578975f, -0.1323616f, +0.0186675f, +0.1146305f,
  +0.0000000f, +0.1053558f, -0.0012393f, +0.1958636f, +0.2458259f, -0.0796424f, -0.0263612f, +0.1076546f,
  -0.0000000f, -0.0806919f, +0.0175490f, -0.2626050f, +0.0415898f, -0.0606227f, -0.0071042f, +0.0760657f,
  +0.0000000f, +0.2118453f, -0.1550405f, -0.0401591f, +0.0248899f, -0.0047198f, -0.0431776f, -0.0807802f,
  -0.0000000f, -0.3141752f, -0.1311157f, -0.0828905f, +0.0079409f, +0.0569038f, +0.0002605f, -0.0548746f,
  -0.0000000f, -0.1525651f, -0.0359050f, -0.1776102f, -0.0274176f, +0.1265145f, +0.0447992f, +0.0152089f,
  -0.0000000f, -0.0178470f, +0.0270914f, -0.0082430f, -0.0073799f, -0.0084553f, -0.0229903f, +0.0105970f,
  -0.0000000f, -0.0175365f, +0.0883330f, -0.0140967f, +0.1588071f, -0.0118770f, -0.0892652f, -0.0235338f,
  -0.0000000f, -0.0037313f, +0.1061884f, -0.0624743f, +0.0671954f, +0.0442090f, +0.0640497f, -0.0260676f,
  -0.0000000f, +0.0265309f, +0.0504700f, +0.0805341f, +0.0459465f, -0.0142811f, -0.0233539f, -0.0788123f,
  -0.0000000f, +0.0759506f, +0.0124059f, +0.1860311f, +0.2435821f, -0.0688489f, +0.1384561f, +0.1950178f,
  -0.0000000f, -0.0040134f, +0.1550290f, -0.0317253f, +0.1467702f, -0.0041386f, -0.1625552f, +0.0068938f,
  -0.0000000f, +0.0173873f, -0.0159357f, -0.0031621f, -0.0747885f, +0.0322861f, -0.0656613f, +0.0320247f,
  -0.0000000f, +0.0600443f, -0.2242236f, +0.0020362f, +0.0672972f, +0.0471278f, -0.0289826f, +0.0233532f,
  -0.0000000f, -0.0902108f, -0.0246403f, -0.1400198f, +0.0907353f, -0.0129875f, -0.0434966f, +0.0492250f,
  -0.0000000f, -0.3080250f, +0.0066857f, -0.1455994f, +0.0199510f, -0.1859156f, -0.1338402f, -0.0476875f,
  +0.0000000f, +0.1780370f, +0.1862338f, +0.1877132f, +0.2696276f, +0.0668082f, -0.0764291f, -0.1173344f,
  +0.0000000f, +0.1060445f, -0.1212615f, +0.0845078f, -0.1859402f, -0.1576789f, +0.0171425f, -0.1503156f,
  +0.0000000f, +0.4140525f, -0.1632303f, +0.0587320f, -0.0865497f, -0.0644024f, -0.1238507f, -0.2069851f,
  -0.0000000f, +0.1973968f, -0.0127191f, -0.2237841f, -0.1309700f, -0.1226505f, -0.1182133f, -0.0949485f,
  +0.0000000f, -0.0530670f, -0.1774279f, +0.1267308f, -0.0350323f, +0.0684868f, -0.0012716f, -0.0263737f,
  -0.0000000f, +0.2373759f, -0.1361181f, +0.0030455f, +0.0204227f, +0.0198991f, +0.0537703f, +0.0444892f,
  -0.0000000f, -0.1682814f, -0.0344422f, +0.0384383f, -0.0904993f, +0.0933764f, +0.1497255f, +0.0183762f,
  +0.0000000f, +0.1533773f, -0.1055213f, -0.0622348f, +0.1712987f, +0.0785770f, +0.1476234f, -0.0768435f
);

const float biases[4] = float[4](
  -0.0263086f, -0.0222379f, +0.0068700f, -0.0179727f
);

vec4 hook() {
    const vec4 r[9][2] = vec4[9][2](
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 1.0f)))
    );

    float sum[4] = biases;
    for (int n = 0; n < 4; n++) {
        for (int i = 0; i < 9; i++) {
            const vec4 k0 = vec4(kernels[n * 8 * 9 + 8 * i + 0], kernels[n * 8 * 9 + 8 * i + 1], kernels[n * 8 * 9 + 8 * i + 2], kernels[n * 8 * 9 + 8 * i + 3]);
            const vec4 k1 = vec4(kernels[n * 8 * 9 + 8 * i + 4], kernels[n * 8 * 9 + 8 * i + 5], kernels[n * 8 * 9 + 8 * i + 6], kernels[n * 8 * 9 + 8 * i + 7]);
            sum[n] += (dot(k0, r[i][0]) + dot(k1, r[i][1]));
        }
    }

    return ACTIVE(vec4(sum[0], sum[1], sum[2], sum[3]));
}

//!HOOK LUMA
//!DESC ACNet Layer5 L1
//!WHEN OUTPUT.w LUMA.w / 1.2 > OUTPUT.h LUMA.h / 1.2 > *
//!BIND TMP1_L0
//!BIND TMP1_L1
//!SAVE TMP2_L1
//!COMPONENTS 4

#define ACTIVE(v) (max(v, 0.0f))

#define TEX_BIND_L0_TEXOFF TMP1_L0_texOff
#define TEX_BIND_L0_TEX TMP1_L0_tex
#define TEX_BIND_L0_POS TMP1_L0_pos
#define TEX_BIND_L0_SIZE TMP1_L0_size
#define TEX_BIND_L0_PT TMP1_L0_pt

#define TEX_BIND_L1_TEXOFF TMP1_L1_texOff
#define TEX_BIND_L1_TEX TMP1_L1_tex
#define TEX_BIND_L1_POS TMP1_L1_pos
#define TEX_BIND_L1_SIZE TMP1_L1_size
#define TEX_BIND_L1_PT TMP1_L1_pt

const float kernels[288] = float[288](
  +0.0000000f, -0.0208086f, -0.0151494f, -0.0241163f, +0.0162128f, +0.0060473f, -0.1338959f, +0.0060740f,
  -0.0000000f, +0.0053674f, +0.1052131f, +0.0135461f, +0.2081627f, +0.0897413f, -0.0930897f, +0.0370647f,
  -0.0000000f, +0.0017057f, -0.0417065f, -0.0010298f, +0.0894409f, -0.0682058f, +0.0433662f, +0.0004552f,
  -0.0000000f, +0.2415994f, -0.0506511f, +0.0121019f, -0.0754519f, -0.0717697f, +0.0486200f, -0.1379347f,
  +0.0000000f, +0.4134768f, +0.0236152f, +0.0226304f, +0.0034580f, -0.3566108f, +0.1491653f, +0.2384790f,
  +0.0000000f, +0.0352151f, -0.0938598f, +0.1137502f, -0.3331746f, -0.2893516f, +0.1629467f, -0.1119881f,
  +0.0000000f, +0.0821535f, -0.1082294f, +0.0139665f, +0.0509166f, -0.0163243f, +0.0024123f, +0.1042159f,
  +0.0000000f, +0.2043136f, -0.0636448f, +0.1075363f, +0.1389750f, +0.0257284f, -0.0763475f, +0.1121395f,
  +0.0000000f, +0.1036623f, -0.1157281f, +0.1662061f, -0.1072280f, -0.0112815f, -0.0802261f, +0.0334566f,
  -0.0000000f, +0.0734569f, +0.0173017f, -0.0067532f, -0.0201167f, +0.0504053f, +0.1070600f, +0.0267617f,
  +0.0000000f, -0.0820314f, +0.0990627f, -0.1160759f, +0.3639434f, -0.0106110f, -0.0936751f, -0.0507402f,
  +0.0000000f, -0.0295042f, +0.0488473f, -0.0508759f, +0.1454646f, -0.1055721f, +0.1175735f, -0.0183017f,
  -0.0000000f, -0.0534202f, +0.0495134f, +0.1210700f, -0.0080861f, -0.0443464f, -0.0504397f, +0.0533401f,
  -0.0000000f, +0.0496968f, +0.2423952f, +0.3107257f, -0.0439565f, -0.1450532f, -0.1178375f, +0.0657101f,
  +0.0000000f, +0.0076779f, +0.2717351f, +0.0716808f, -0.1347262f, +0.0539767f, -0.0405987f, +0.0061552f,
  -0.0000000f, +0.0211804f, +0.2748707f, -0.1141131f, +0.0515193f, -0.2628776f, +0.1961774f, -0.0721583f,
  -0.0000000f, +0.0110691f, +0.1940968f, -0.1790177f, -0.3112232f, +0.0182466f, +0.0993697f, -0.0355631f,
  -0.0000000f, -0.0119395f, +0.3116500f, +0.0788985f, -0.0468467f, -0.1160625f, +0.0822581f, +0.0821399f,
  +0.0000000f, +0.1454386f, +0.0976391f, -0.1655876f, -0.1354725f, +0.1753569f, +0.0999529f, +0.1672343f,
  +0.0000000f, +0.0824905f, -0.0062085f, +0.0979012f, +0.2009433f, -0.2475781f, -0.1415388f, +0.1711327f,
  +0.0000000f, -0.0092349f, +0.0481543f, -0.1186862f, +0.1010213f, -0.0114812f, -0.0830383f, -0.0485124f,
  +0.0000000f, +0.2612396f, +0.0273790f, -0.2128694f, -0.2131142f, +0.0615960f, +0.1452663f, +0.2131918f,
  -0.0000000f, +0.2749361f, -0.1844333f, +0.4102289f, -0.1508794f, -0.4035175f, -0.2142963f, +0.4703074f,
  +0.0000000f, -0.0549460f, +0.0404024f, -0.0973791f, +0.1817515f, -0.1434774f, -0.0758396f, +0.1157040f,
  -0.0000000f, +0.1823335f, +0.0018893f, -0.0013767f, +0.0469464f, +0.0316898f, +0.1614636f, +0.2033003f,
  -0.0000000f, +0.1242818f, -0.0052282f, -0.1634267f, -0.1396343f, +0.1723961f, +0.0375078f, +0.2463622f,
  +0.0000000f, -0.0067498f, +0.0067548f, -0.0950588f, +0.1021963f, +0.0707802f, +0.0538330f, +0.0699238f,
  -0.0000000f, -0.0000000f, +0.0000000f, -0.0000000f, -0.0000060f, -0.0000000f, -0.0000000f, -0.0000000f,
  -0.0000000f, +0.0000000f, -0.0000000f, -0.0000000f, -0.0000060f, -0.0000000f, +0.0000000f, +0.0000000f,
  -0.0000000f, -0.0000000f, -0.0000000f, -0.0000000f, -0.0000059f, -0.0000000f, -0.0000000f, +0.0000000f,
  -0.0000000f, -0.0000000f, +0.0000000f, -0.0000000f, -0.0000060f, -0.0000000f, -0.0000000f, +0.0000000f,
  -0.0000000f, +0.0000000f, -0.0000000f, -0.0000000f, -0.0000060f, -0.0000000f, +0.0000000f, +0.0000000f,
  +0.0000000f, -0.0000000f, -0.0000000f, -0.0000000f, -0.0000060f, -0.0000000f, -0.0000000f, +0.0000000f,
  +0.0000000f, +0.0000000f, -0.0000000f, -0.0000000f, -0.0000060f, -0.0000000f, +0.0000000f, -0.0000000f,
  -0.0000000f, -0.0000000f, -0.0000000f, -0.0000000f, -0.0000060f, -0.0000000f, +0.0000000f, +0.0000000f,
  +0.0000000f, -0.0000000f, -0.0000000f, -0.0000000f, -0.0000060f, -0.0000000f, -0.0000000f, -0.0000000f
);

const float biases[4] = float[4](
  -0.0108929f, -0.0118878f, -0.0049598f, -0.0000064f
);

vec4 hook() {
    const vec4 r[9][2] = vec4[9][2](
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 1.0f)))
    );

    float sum[4] = biases;
    for (int n = 0; n < 4; n++) {
        for (int i = 0; i < 9; i++) {
            const vec4 k0 = vec4(kernels[n * 8 * 9 + 8 * i + 0], kernels[n * 8 * 9 + 8 * i + 1], kernels[n * 8 * 9 + 8 * i + 2], kernels[n * 8 * 9 + 8 * i + 3]);
            const vec4 k1 = vec4(kernels[n * 8 * 9 + 8 * i + 4], kernels[n * 8 * 9 + 8 * i + 5], kernels[n * 8 * 9 + 8 * i + 6], kernels[n * 8 * 9 + 8 * i + 7]);
            sum[n] += (dot(k0, r[i][0]) + dot(k1, r[i][1]));
        }
    }

    return ACTIVE(vec4(sum[0], sum[1], sum[2], sum[3]));
}

//!HOOK LUMA
//!DESC ACNet Layer6 L0
//!WHEN OUTPUT.w LUMA.w / 1.2 > OUTPUT.h LUMA.h / 1.2 > *
//!BIND TMP2_L0
//!BIND TMP2_L1
//!SAVE TMP1_L0
//!COMPONENTS 4

#define ACTIVE(v) (max(v, 0.0f))

#define TEX_BIND_L0_TEXOFF TMP2_L0_texOff
#define TEX_BIND_L0_TEX TMP2_L0_tex
#define TEX_BIND_L0_POS TMP2_L0_pos
#define TEX_BIND_L0_SIZE TMP2_L0_size
#define TEX_BIND_L0_PT TMP2_L0_pt

#define TEX_BIND_L1_TEXOFF TMP2_L1_texOff
#define TEX_BIND_L1_TEX TMP2_L1_tex
#define TEX_BIND_L1_POS TMP2_L1_pos
#define TEX_BIND_L1_SIZE TMP2_L1_size
#define TEX_BIND_L1_PT TMP2_L1_pt

const float kernels[288] = float[288](
  -0.1777824f, -0.0938430f, -0.1807959f, +0.0482367f, +0.0273622f, +0.1399022f, +0.1643232f, -0.0000000f,
  +0.0052351f, +0.1263966f, +0.1139561f, -0.0253029f, -0.0741523f, -0.4159787f, -0.1278262f, +0.0000000f,
  +0.0160354f, -0.0150156f, -0.0261782f, +0.0178823f, +0.0023185f, +0.0021609f, -0.0018285f, -0.0000000f,
  -0.0974824f, -0.5288041f, -0.0166891f, -0.0428519f, +0.1877109f, +0.1599696f, +0.2941436f, -0.0000000f,
  -0.0110557f, +0.1946932f, +0.1413209f, -0.0150714f, -0.0208268f, +0.1137484f, +0.1740072f, +0.0000000f,
  -0.0509991f, -0.0900373f, -0.0067769f, -0.0338177f, -0.0755812f, -0.0182715f, -0.2632086f, -0.0000000f,
  +0.1745977f, -0.0891356f, -0.0211196f, +0.1363519f, +0.1467480f, +0.0190445f, -0.1012487f, -0.0000000f,
  -0.0400052f, +0.0986324f, +0.0686160f, +0.4532985f, -0.0655520f, -0.0427016f, +0.1356477f, -0.0000000f,
  -0.0509113f, -0.1500947f, -0.0782089f, +0.2148907f, +0.0422923f, -0.0256022f, +0.0158941f, -0.0000000f,
  -0.0000000f, +0.0000000f, -0.0000000f, -0.0000000f, -0.0000000f, +0.0000000f, +0.0000000f, -0.0000000f,
  -0.0000000f, -0.0000000f, -0.0000000f, +0.0000000f, -0.0000000f, -0.0000000f, -0.0000000f, -0.0000000f,
  -0.0000000f, -0.0000000f, -0.0000000f, -0.0000000f, +0.0000000f, -0.0000000f, -0.0000000f, +0.0000000f,
  -0.0000000f, -0.0000000f, -0.0000000f, +0.0000000f, +0.0000000f, +0.0000000f, -0.0000000f, -0.0000000f,
  +0.0000000f, -0.0000000f, -0.0000000f, +0.0000000f, +0.0000000f, +0.0000000f, +0.0000000f, +0.0000000f,
  -0.0000000f, +0.0000000f, -0.0000000f, +0.0000000f, +0.0000000f, +0.0000000f, +0.0000000f, -0.0000000f,
  +0.0000000f, +0.0000000f, -0.0000000f, -0.0000000f, -0.0000000f, -0.0000000f, +0.0000000f, -0.0000000f,
  -0.0000000f, -0.0000000f, -0.0000000f, +0.0000000f, -0.0000000f, -0.0000000f, +0.0000000f, -0.0000000f,
  +0.0000000f, -0.0000000f, -0.0000000f, +0.0000000f, +0.0000000f, -0.0000000f, -0.0000000f, +0.0000000f,
  -0.0000000f, -0.0000000f, -0.0000010f, -0.0000000f, -0.0000000f, -0.0000000f, -0.0000000f, -0.0000000f,
  -0.0000000f, -0.0000000f, -0.0000008f, -0.0000000f, -0.0000000f, -0.0000000f, -0.0000000f, -0.0000000f,
  -0.0000000f, +0.0000000f, -0.0000012f, -0.0000000f, -0.0000000f, -0.0000000f, -0.0000000f, +0.0000000f,
  -0.0000000f, -0.0000000f, -0.0000006f, -0.0000000f, -0.0000000f, -0.0000000f, -0.0000000f, -0.0000000f,
  -0.0000000f, -0.0000000f, -0.0000004f, -0.0000000f, -0.0000000f, -0.0000000f, -0.0000000f, -0.0000000f,
  -0.0000000f, -0.0000000f, -0.0000006f, -0.0000000f, -0.0000000f, -0.0000000f, -0.0000000f, +0.0000000f,
  -0.0000000f, +0.0000000f, -0.0000006f, -0.0000000f, -0.0000000f, -0.0000000f, -0.0000000f, +0.0000000f,
  -0.0000000f, -0.0000000f, -0.0000004f, +0.0000000f, -0.0000000f, -0.0000000f, -0.0000000f, +0.0000000f,
  -0.0000000f, -0.0000000f, -0.0000005f, -0.0000000f, -0.0000000f, -0.0000000f, -0.0000000f, -0.0000000f,
  +0.0908351f, +0.0472050f, -0.1583738f, +0.1944963f, -0.0868773f, +0.0469744f, -0.0477619f, +0.0000000f,
  -0.0052035f, -0.2383904f, +0.0647487f, -0.1360267f, +0.1153258f, -0.1004861f, -0.0477765f, +0.0000000f,
  -0.0259797f, -0.0149827f, -0.2141710f, +0.1200804f, -0.0498698f, -0.1745987f, +0.5112513f, -0.0000000f,
  -0.1009015f, +0.0568241f, -0.0340477f, +0.1680318f, -0.0072811f, -0.1791013f, -0.2020961f, -0.0000000f,
  -0.0741671f, -0.0182586f, +0.4963818f, +0.0568045f, +0.2573045f, +0.3077095f, +0.0648145f, -0.0000000f,
  +0.1336398f, +0.0964257f, +0.0020984f, +0.1151820f, -0.1853610f, -0.2575672f, -0.0616061f, +0.0000000f,
  +0.1030235f, +0.0059740f, -0.1433519f, +0.0593197f, -0.0649651f, -0.0228462f, +0.0007369f, +0.0000000f,
  -0.1525039f, -0.1419803f, +0.0482946f, -0.0381998f, +0.1036379f, -0.0037491f, -0.1622624f, +0.0000000f,
  +0.1241743f, -0.2107643f, -0.0922092f, -0.1133968f, +0.0137065f, -0.0052171f, -0.0303274f, +0.0000000f
);

const float biases[4] = float[4](
  -0.0012406f, -0.0000000f, -0.0000010f, +0.0063490f
);

vec4 hook() {
    const vec4 r[9][2] = vec4[9][2](
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 1.0f)))
    );

    float sum[4] = biases;
    for (int n = 0; n < 4; n++) {
        for (int i = 0; i < 9; i++) {
            const vec4 k0 = vec4(kernels[n * 8 * 9 + 8 * i + 0], kernels[n * 8 * 9 + 8 * i + 1], kernels[n * 8 * 9 + 8 * i + 2], kernels[n * 8 * 9 + 8 * i + 3]);
            const vec4 k1 = vec4(kernels[n * 8 * 9 + 8 * i + 4], kernels[n * 8 * 9 + 8 * i + 5], kernels[n * 8 * 9 + 8 * i + 6], kernels[n * 8 * 9 + 8 * i + 7]);
            sum[n] += (dot(k0, r[i][0]) + dot(k1, r[i][1]));
        }
    }

    return ACTIVE(vec4(sum[0], sum[1], sum[2], sum[3]));
}

//!HOOK LUMA
//!DESC ACNet Layer6 L1
//!WHEN OUTPUT.w LUMA.w / 1.2 > OUTPUT.h LUMA.h / 1.2 > *
//!BIND TMP2_L0
//!BIND TMP2_L1
//!SAVE TMP1_L1
//!COMPONENTS 4

#define ACTIVE(v) (max(v, 0.0f))

#define TEX_BIND_L0_TEXOFF TMP2_L0_texOff
#define TEX_BIND_L0_TEX TMP2_L0_tex
#define TEX_BIND_L0_POS TMP2_L0_pos
#define TEX_BIND_L0_SIZE TMP2_L0_size
#define TEX_BIND_L0_PT TMP2_L0_pt

#define TEX_BIND_L1_TEXOFF TMP2_L1_texOff
#define TEX_BIND_L1_TEX TMP2_L1_tex
#define TEX_BIND_L1_POS TMP2_L1_pos
#define TEX_BIND_L1_SIZE TMP2_L1_size
#define TEX_BIND_L1_PT TMP2_L1_pt

const float kernels[288] = float[288](
  -0.1141160f, -0.0475299f, +0.0205990f, -0.0285638f, -0.0235103f, +0.0226581f, +0.0176881f, -0.0000000f,
  +0.1339078f, +0.0654105f, -0.0386673f, +0.0488459f, -0.0505696f, +0.1405758f, +0.1809043f, -0.0000000f,
  -0.1227888f, -0.0249152f, -0.0721903f, +0.0424120f, +0.1079852f, +0.1063890f, -0.0021718f, +0.0000000f,
  +0.1436985f, +0.0334285f, -0.2111170f, +0.1463216f, +0.1749519f, -0.0556261f, -0.0106594f, -0.0000000f,
  +0.3761650f, -0.1389899f, -0.1652492f, +0.0159742f, -0.0015788f, -0.3079417f, -0.2130216f, +0.0000000f,
  +0.0714067f, -0.0338751f, -0.0234302f, -0.1069859f, -0.0164469f, -0.0571598f, +0.1005614f, +0.0000000f,
  +0.0696609f, -0.0192613f, -0.0122869f, +0.0556613f, +0.0776417f, +0.1087351f, -0.0606929f, -0.0000000f,
  +0.3196295f, -0.1316184f, -0.2663729f, -0.2095166f, -0.0938879f, -0.0839066f, -0.0236244f, +0.0000000f,
  -0.0170895f, +0.1141529f, +0.0010859f, +0.0241508f, +0.0013891f, +0.0421062f, +0.0063688f, +0.0000000f,
  +0.1690488f, -0.0327534f, +0.0891372f, +0.0823982f, -0.1202857f, -0.0366194f, +0.1110995f, +0.0000000f,
  -0.1737898f, -0.1580956f, -0.2307828f, +0.0085883f, -0.0038982f, -0.1936584f, +0.1661792f, +0.0000000f,
  -0.0213605f, +0.0522570f, -0.1962640f, +0.0768298f, +0.0216544f, +0.2717749f, +0.3613924f, +0.0000000f,
  -0.2939624f, -0.0181334f, +0.3127625f, -0.1458022f, -0.3201664f, +0.0559374f, +0.0797770f, -0.0000000f,
  +0.1178249f, +0.2054777f, +0.1533226f, +0.4625310f, +0.2026512f, +0.0797134f, +0.4365479f, +0.0000000f,
  +0.0791115f, -0.2807142f, -0.1958996f, -0.3189979f, -0.1731123f, -0.2387170f, +0.3059728f, -0.0000000f,
  -0.0064767f, -0.0537248f, -0.0183176f, -0.1105092f, -0.0132288f, -0.0396901f, -0.0551250f, -0.0000000f,
  -0.1994929f, +0.0840667f, +0.0684598f, +0.0638071f, +0.1380506f, +0.0229143f, +0.0612287f, -0.0000000f,
  +0.0542433f, -0.0746393f, +0.0091476f, -0.0251299f, -0.0626895f, -0.0177793f, +0.1241416f, +0.0000000f,
  -0.0671764f, -0.0314700f, -0.2882954f, -0.1108508f, +0.3878857f, -0.1006260f, -0.0034665f, +0.0000000f,
  -0.0349301f, -0.0133652f, -0.0704581f, +0.0837607f, +0.3240630f, +0.1941826f, +0.2255991f, -0.0000000f,
  -0.0270872f, +0.0877417f, +0.0789225f, +0.0326341f, +0.1063102f, -0.0770390f, -0.0829296f, +0.0000000f,
  +0.1048933f, -0.0228090f, -0.1443557f, +0.3246996f, +0.0751307f, +0.0094531f, -0.1550724f, -0.0000000f,
  +0.2117787f, -0.4799100f, +0.0410680f, -0.2776031f, -0.2020608f, +0.0716047f, +0.2720646f, -0.0000000f,
  -0.1675155f, +0.0247397f, +0.0628965f, +0.0412350f, +0.1302734f, +0.1400379f, -0.0286651f, -0.0000000f,
  -0.1262667f, +0.0644184f, +0.0041061f, +0.0866253f, +0.0403825f, -0.0205905f, -0.0034909f, -0.0000000f,
  -0.2420721f, +0.0348179f, +0.2184372f, +0.2681584f, +0.2435008f, +0.0459440f, +0.0176960f, +0.0000000f,
  -0.0746667f, -0.2927474f, +0.0904876f, -0.1356037f, -0.0036042f, -0.0026721f, -0.0854922f, +0.0000000f,
  -0.0104962f, -0.0085760f, +0.0850027f, +0.0358305f, -0.1197213f, -0.0011533f, +0.0320212f, -0.0000002f,
  +0.0541201f, +0.0245183f, -0.0036434f, +0.0579947f, -0.0436277f, -0.2789666f, -0.0889554f, -0.0000002f,
  -0.0164982f, -0.0690903f, +0.0138163f, -0.0056879f, +0.0202777f, -0.0887065f, -0.0222984f, -0.0000002f,
  -0.0593865f, +0.0216231f, +0.0905316f, +0.0377076f, -0.1481790f, -0.0179070f, +0.0813533f, -0.0000002f,
  +0.2375699f, +0.0896410f, +0.2366146f, -0.2637324f, +0.0408444f, +0.1839957f, +0.3307926f, -0.0000002f,
  -0.0803813f, +0.0990311f, +0.1807662f, +0.2088559f, +0.1591713f, +0.1102579f, -0.2061563f, -0.0000002f,
  +0.0237386f, -0.0100521f, +0.0281202f, -0.0406319f, -0.0456839f, -0.0023183f, -0.0358020f, -0.0000002f,
  -0.1371499f, +0.0465060f, +0.0437525f, +0.1689053f, +0.1407527f, +0.0638750f, +0.0498045f, -0.0000002f,
  -0.0309057f, -0.1575573f, +0.0229810f, -0.0689957f, -0.0207842f, -0.0042394f, -0.0927123f, -0.0000002f
);

const float biases[4] = float[4](
  +0.1349513f, -0.0038411f, -0.0066630f, -0.0073614f
);

vec4 hook() {
    const vec4 r[9][2] = vec4[9][2](
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 1.0f)))
    );

    float sum[4] = biases;
    for (int n = 0; n < 4; n++) {
        for (int i = 0; i < 9; i++) {
            const vec4 k0 = vec4(kernels[n * 8 * 9 + 8 * i + 0], kernels[n * 8 * 9 + 8 * i + 1], kernels[n * 8 * 9 + 8 * i + 2], kernels[n * 8 * 9 + 8 * i + 3]);
            const vec4 k1 = vec4(kernels[n * 8 * 9 + 8 * i + 4], kernels[n * 8 * 9 + 8 * i + 5], kernels[n * 8 * 9 + 8 * i + 6], kernels[n * 8 * 9 + 8 * i + 7]);
            sum[n] += (dot(k0, r[i][0]) + dot(k1, r[i][1]));
        }
    }

    return ACTIVE(vec4(sum[0], sum[1], sum[2], sum[3]));
}

//!HOOK LUMA
//!DESC ACNet Layer7 L0
//!WHEN OUTPUT.w LUMA.w / 1.2 > OUTPUT.h LUMA.h / 1.2 > *
//!BIND TMP1_L0
//!BIND TMP1_L1
//!SAVE TMP2_L0
//!COMPONENTS 4

#define ACTIVE(v) (max(v, 0.0f))

#define TEX_BIND_L0_TEXOFF TMP1_L0_texOff
#define TEX_BIND_L0_TEX TMP1_L0_tex
#define TEX_BIND_L0_POS TMP1_L0_pos
#define TEX_BIND_L0_SIZE TMP1_L0_size
#define TEX_BIND_L0_PT TMP1_L0_pt

#define TEX_BIND_L1_TEXOFF TMP1_L1_texOff
#define TEX_BIND_L1_TEX TMP1_L1_tex
#define TEX_BIND_L1_POS TMP1_L1_pos
#define TEX_BIND_L1_SIZE TMP1_L1_size
#define TEX_BIND_L1_PT TMP1_L1_pt

const float kernels[288] = float[288](
  -0.0150801f, +0.0000000f, -0.0000000f, -0.0553010f, +0.0122498f, -0.0191655f, +0.0237024f, +0.2679419f,
  +0.1129365f, +0.0000000f, -0.0000000f, -0.0249715f, +0.0519886f, -0.0211791f, +0.0407640f, +0.0520844f,
  +0.0711869f, +0.0000000f, +0.0000000f, +0.0492505f, +0.0030706f, -0.0215578f, +0.0357666f, +0.0127613f,
  +0.0116276f, -0.0000000f, -0.0000000f, -0.2558887f, -0.0795337f, +0.3681638f, -0.0845862f, -0.1116932f,
  -0.8493794f, -0.0000000f, +0.0000000f, +0.1655967f, -0.1980059f, -0.0529286f, +0.1902525f, -0.1780774f,
  +0.0854571f, -0.0000000f, +0.0000000f, -0.0809557f, -0.0277911f, +0.0957897f, -0.1679443f, +0.1136346f,
  -0.0396417f, +0.0000000f, +0.0000000f, +0.4051824f, +0.2176808f, +0.2809539f, -0.0102734f, -0.1380753f,
  -0.0238790f, -0.0000000f, +0.0000000f, +0.0313199f, +0.0699784f, -0.1473112f, +0.3225875f, -0.0177643f,
  +0.0100294f, +0.0000000f, -0.0000000f, -0.1426180f, -0.0423247f, +0.0341819f, -0.1584066f, -0.0174201f,
  +0.0158400f, -0.0000000f, -0.0000000f, +0.0514947f, +0.3004368f, -0.0336524f, -0.2315675f, -0.3002681f,
  -0.2340545f, -0.0000000f, -0.0000000f, +0.0788432f, -0.1404077f, -0.2045193f, -0.0255938f, -0.1836956f,
  +0.0076361f, -0.0000000f, -0.0000000f, +0.0422435f, -0.0236773f, -0.0410485f, +0.1115389f, +0.0120865f,
  -0.0660816f, +0.0000000f, -0.0000000f, -0.2124543f, -0.1165604f, +0.2853120f, +0.2123407f, +0.0211778f,
  +0.0797781f, +0.0000000f, -0.0000000f, +0.1956752f, -0.0751130f, +0.1211608f, +0.3276186f, +0.2955926f,
  -0.2042332f, -0.0000000f, +0.0000000f, +0.0079369f, +0.0106248f, -0.0215261f, -0.2899991f, +0.1296621f,
  -0.0195943f, -0.0000000f, +0.0000000f, +0.0227947f, -0.0121327f, -0.2456389f, +0.0185914f, +0.0685420f,
  -0.0633701f, +0.0000000f, -0.0000000f, +0.0228012f, +0.0506576f, -0.0418698f, -0.0598204f, +0.0077710f,
  +0.0333514f, +0.0000000f, -0.0000000f, +0.0768945f, -0.0729439f, -0.0558190f, -0.0908073f, -0.0603042f,
  +0.0033019f, +0.0000000f, -0.0000000f, -0.0159913f, -0.0403711f, +0.0093318f, -0.0091277f, -0.0348094f,
  -0.0191347f, -0.0000000f, +0.0000000f, +0.0827487f, -0.0790441f, -0.0650847f, -0.0285680f, -0.0081302f,
  +0.0093227f, +0.0000000f, +0.0000000f, -0.0637765f, +0.1245088f, +0.0101653f, +0.0162023f, +0.0607856f,
  -0.0099003f, +0.0000000f, +0.0000000f, -0.0032220f, +0.0419066f, -0.0287577f, -0.0082490f, +0.0518445f,
  -0.1010123f, +0.0000000f, +0.0000000f, +0.0414433f, -0.0881594f, -0.0499974f, +0.1288809f, +0.4699534f,
  -0.3351266f, -0.0000000f, +0.0000000f, -0.0812192f, -0.1122904f, +0.0460688f, -0.1315928f, -0.0103924f,
  -0.0084091f, -0.0000000f, +0.0000000f, -0.1123075f, -0.0040654f, +0.0004211f, +0.0160654f, +0.0233594f,
  -0.0159179f, +0.0000000f, -0.0000000f, +0.6758595f, -0.0044087f, +0.2171824f, +0.0401434f, -0.1836405f,
  -0.0343230f, +0.0000000f, -0.0000000f, -0.1760024f, +0.1294177f, +0.0031080f, +0.2704281f, -0.3734261f,
  -0.0829955f, -0.0000000f, +0.0000000f, -0.0471636f, -0.0818629f, -0.0141406f, +0.0501965f, +0.1027226f,
  +0.0977243f, -0.0000000f, +0.0000000f, -0.0247539f, +0.0427723f, -0.0028116f, +0.1550565f, +0.0746860f,
  -0.0610125f, -0.0000000f, +0.0000000f, -0.0182565f, -0.0009945f, +0.0269903f, -0.0573279f, +0.0747324f,
  +0.0282248f, -0.0000000f, +0.0000000f, +0.1052550f, -0.0555210f, -0.2020052f, +0.0483229f, +0.0837436f,
  +0.0887065f, -0.0000000f, +0.0000000f, -0.0046010f, -0.1126351f, +0.4321408f, +0.0382435f, +0.1583444f,
  +0.0134430f, -0.0000000f, +0.0000000f, -0.0227837f, -0.0457815f, +0.0293733f, -0.1353265f, +0.0292213f,
  +0.0037515f, -0.0000000f, +0.0000000f, -0.0520276f, -0.1102634f, -0.2176793f, -0.0098862f, +0.0656409f,
  +0.0177717f, -0.0000000f, +0.0000000f, -0.1640843f, +0.0214426f, -0.0272298f, -0.0569705f, +0.0776966f,
  +0.0065945f, -0.0000000f, +0.0000000f, +0.0079112f, -0.0451205f, +0.0055396f, -0.0714997f, +0.0357455f
);

const float biases[4] = float[4](
  -0.0027729f, -0.0048174f, -0.0063012f, +0.2049149f
);

vec4 hook() {
    const vec4 r[9][2] = vec4[9][2](
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 1.0f)))
    );

    float sum[4] = biases;
    for (int n = 0; n < 4; n++) {
        for (int i = 0; i < 9; i++) {
            const vec4 k0 = vec4(kernels[n * 8 * 9 + 8 * i + 0], kernels[n * 8 * 9 + 8 * i + 1], kernels[n * 8 * 9 + 8 * i + 2], kernels[n * 8 * 9 + 8 * i + 3]);
            const vec4 k1 = vec4(kernels[n * 8 * 9 + 8 * i + 4], kernels[n * 8 * 9 + 8 * i + 5], kernels[n * 8 * 9 + 8 * i + 6], kernels[n * 8 * 9 + 8 * i + 7]);
            sum[n] += (dot(k0, r[i][0]) + dot(k1, r[i][1]));
        }
    }

    return ACTIVE(vec4(sum[0], sum[1], sum[2], sum[3]));
}

//!HOOK LUMA
//!DESC ACNet Layer7 L1
//!WHEN OUTPUT.w LUMA.w / 1.2 > OUTPUT.h LUMA.h / 1.2 > *
//!BIND TMP1_L0
//!BIND TMP1_L1
//!SAVE TMP2_L1
//!COMPONENTS 4

#define ACTIVE(v) (max(v, 0.0f))

#define TEX_BIND_L0_TEXOFF TMP1_L0_texOff
#define TEX_BIND_L0_TEX TMP1_L0_tex
#define TEX_BIND_L0_POS TMP1_L0_pos
#define TEX_BIND_L0_SIZE TMP1_L0_size
#define TEX_BIND_L0_PT TMP1_L0_pt

#define TEX_BIND_L1_TEXOFF TMP1_L1_texOff
#define TEX_BIND_L1_TEX TMP1_L1_tex
#define TEX_BIND_L1_POS TMP1_L1_pos
#define TEX_BIND_L1_SIZE TMP1_L1_size
#define TEX_BIND_L1_PT TMP1_L1_pt

const float kernels[288] = float[288](
  -0.1661364f, -0.0000000f, -0.0000000f, +0.0371392f, +0.0550610f, +0.0549713f, -0.0095654f, +0.2035929f,
  -0.2312756f, -0.0000000f, -0.0000000f, +0.0005294f, -0.0474693f, -0.0172342f, -0.1875090f, +0.0742145f,
  +0.0446907f, -0.0000000f, +0.0000000f, -0.0236585f, +0.0300450f, -0.0032759f, +0.0170785f, +0.0319700f,
  +0.0635459f, +0.0000000f, +0.0000000f, -0.3619932f, +0.0021565f, +0.4822487f, +0.0701332f, -0.1819911f,
  -0.3810545f, -0.0000000f, -0.0000000f, -0.0519122f, -0.0238664f, -0.1123357f, +0.7636322f, -0.1938583f,
  +0.0341103f, +0.0000000f, -0.0000000f, -0.0519688f, -0.0234965f, +0.0382574f, -0.0873879f, -0.0025967f,
  -0.0350223f, +0.0000000f, +0.0000000f, +0.2541481f, +0.0608920f, +0.0521054f, -0.0565355f, -0.0346089f,
  -0.0237820f, +0.0000000f, -0.0000000f, +0.2410903f, -0.0004644f, -0.0028473f, -0.1915215f, +0.0338699f,
  +0.0286636f, +0.0000000f, -0.0000000f, +0.0098721f, -0.0502002f, -0.0103546f, -0.1604343f, +0.0588352f,
  +0.0882199f, -0.0000000f, -0.0000000f, -0.0347631f, +0.0243991f, -0.0152170f, -0.0156697f, +0.2759297f,
  +0.0992654f, +0.0000000f, -0.0000000f, -0.0316321f, +0.0022923f, -0.0276592f, +0.0530201f, +0.1145631f,
  +0.0071240f, +0.0000000f, +0.0000000f, +0.0300440f, +0.0515755f, -0.0314009f, +0.0605364f, +0.0160482f,
  -0.0913946f, +0.0000000f, +0.0000000f, -0.2093469f, -0.1415362f, +0.3496045f, -0.1885251f, -0.5167532f,
  -0.3169853f, +0.0000000f, +0.0000000f, +0.1353326f, -0.0100131f, +0.0723904f, +0.2753220f, +0.1472725f,
  -0.0291196f, +0.0000000f, +0.0000000f, -0.0091607f, -0.0756962f, +0.0207219f, -0.1968109f, +0.0751701f,
  -0.0184357f, -0.0000000f, -0.0000000f, -0.1593135f, +0.1084887f, +0.3943961f, +0.0832585f, -0.0691434f,
  -0.0214322f, +0.0000000f, +0.0000000f, +0.1077106f, +0.1257456f, +0.0009182f, +0.0942848f, -0.0929482f,
  -0.0454649f, +0.0000000f, +0.0000000f, -0.0665181f, -0.0731605f, +0.0178420f, -0.1269472f, +0.0346867f,
  +0.0141279f, -0.0000000f, -0.0000000f, +0.0064790f, +0.0049939f, +0.0321863f, +0.0507528f, -0.0183629f,
  -0.0799624f, +0.0000000f, -0.0000000f, -0.0038464f, +0.0140645f, +0.0663819f, -0.0045071f, -0.1191166f,
  +0.0804463f, -0.0000000f, -0.0000000f, -0.0100075f, -0.0342942f, +0.0193047f, -0.0398365f, +0.0097347f,
  +0.0370111f, +0.0000000f, -0.0000000f, -0.0260006f, +0.0485294f, +0.0701962f, -0.0603806f, -0.1565748f,
  -0.1339993f, +0.0000000f, -0.0000000f, -0.0794828f, +0.6338636f, -0.1689204f, -0.0920159f, -0.2103521f,
  -0.0207247f, +0.0000000f, -0.0000000f, +0.0337105f, -0.0368047f, -0.0289798f, +0.0954333f, -0.0497370f,
  -0.0064981f, +0.0000000f, -0.0000000f, +0.0026659f, -0.1370309f, +0.0977616f, -0.0100452f, -0.0300246f,
  +0.0707243f, -0.0000000f, -0.0000000f, -0.0326339f, +0.0258781f, +0.0097998f, +0.0087955f, -0.0649590f,
  +0.0661670f, +0.0000000f, -0.0000000f, +0.0107667f, -0.0486169f, -0.0051620f, +0.0494289f, -0.0561068f,
  +0.0000000f, +0.0000000f, +0.0000000f, -0.0000000f, -0.0000000f, +0.0000000f, -0.0000000f, -0.0000001f,
  +0.0000000f, +0.0000000f, -0.0000000f, -0.0000000f, -0.0000000f, +0.0000000f, +0.0000000f, -0.0000001f,
  +0.0000000f, -0.0000000f, -0.0000000f, +0.0000000f, +0.0000000f, -0.0000000f, -0.0000000f, -0.0000001f,
  -0.0000000f, -0.0000000f, +0.0000000f, -0.0000000f, +0.0000000f, +0.0000000f, +0.0000000f, -0.0000001f,
  +0.0000000f, +0.0000000f, +0.0000000f, +0.0000000f, -0.0000000f, -0.0000000f, -0.0000000f, -0.0000001f,
  -0.0000000f, -0.0000000f, +0.0000000f, -0.0000000f, +0.0000000f, -0.0000000f, +0.0000000f, -0.0000001f,
  -0.0000000f, +0.0000000f, -0.0000000f, -0.0000000f, -0.0000000f, -0.0000000f, -0.0000000f, -0.0000001f,
  -0.0000000f, +0.0000000f, -0.0000000f, -0.0000000f, -0.0000000f, +0.0000000f, -0.0000000f, -0.0000001f,
  -0.0000000f, -0.0000000f, +0.0000000f, +0.0000000f, +0.0000000f, +0.0000000f, -0.0000000f, -0.0000001f
);

const float biases[4] = float[4](
  -0.0020110f, -0.0030974f, +0.5140746f, -0.0000000f
);

vec4 hook() {
    const vec4 r[9][2] = vec4[9][2](
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 1.0f)))
    );

    float sum[4] = biases;
    for (int n = 0; n < 4; n++) {
        for (int i = 0; i < 9; i++) {
            const vec4 k0 = vec4(kernels[n * 8 * 9 + 8 * i + 0], kernels[n * 8 * 9 + 8 * i + 1], kernels[n * 8 * 9 + 8 * i + 2], kernels[n * 8 * 9 + 8 * i + 3]);
            const vec4 k1 = vec4(kernels[n * 8 * 9 + 8 * i + 4], kernels[n * 8 * 9 + 8 * i + 5], kernels[n * 8 * 9 + 8 * i + 6], kernels[n * 8 * 9 + 8 * i + 7]);
            sum[n] += (dot(k0, r[i][0]) + dot(k1, r[i][1]));
        }
    }

    return ACTIVE(vec4(sum[0], sum[1], sum[2], sum[3]));
}

//!HOOK LUMA
//!DESC ACNet Layer8 L0
//!WHEN OUTPUT.w LUMA.w / 1.2 > OUTPUT.h LUMA.h / 1.2 > *
//!BIND TMP2_L0
//!BIND TMP2_L1
//!SAVE TMP1_L0
//!COMPONENTS 4

#define ACTIVE(v) (max(v, 0.0f))

#define TEX_BIND_L0_TEXOFF TMP2_L0_texOff
#define TEX_BIND_L0_TEX TMP2_L0_tex
#define TEX_BIND_L0_POS TMP2_L0_pos
#define TEX_BIND_L0_SIZE TMP2_L0_size
#define TEX_BIND_L0_PT TMP2_L0_pt

#define TEX_BIND_L1_TEXOFF TMP2_L1_texOff
#define TEX_BIND_L1_TEX TMP2_L1_tex
#define TEX_BIND_L1_POS TMP2_L1_pos
#define TEX_BIND_L1_SIZE TMP2_L1_size
#define TEX_BIND_L1_PT TMP2_L1_pt

const float kernels[288] = float[288](
  -0.0259644f, +0.0009793f, -0.3055838f, +0.0137358f, -0.0065111f, +0.0142155f, +0.0064825f, -0.0000000f,
  +0.0296696f, -0.0518354f, -0.0853897f, +0.0124411f, -0.1427125f, +0.0342309f, +0.0163236f, -0.0000000f,
  +0.1210019f, -0.0010278f, -0.0143603f, -0.0434910f, -0.0504807f, -0.0208903f, +0.0149278f, -0.0000000f,
  -0.0303712f, -0.0123364f, +0.1247298f, +0.0648061f, +0.0532404f, +0.0278794f, -0.0884201f, +0.0000000f,
  -0.0152769f, +0.2213019f, -0.0170053f, +0.3701241f, -0.0348429f, +0.1371659f, -0.1077949f, +0.0000000f,
  -0.1858875f, -0.1237305f, -0.0368163f, +0.0380639f, -0.0227034f, +0.0045864f, -0.0906535f, +0.0000000f,
  -0.0186501f, -0.0234507f, -0.0891245f, -0.0137308f, +0.0374139f, +0.0030460f, +0.0310861f, -0.0000000f,
  -0.1285219f, +0.0342171f, -0.0614004f, -0.2485929f, +0.1033413f, -0.1173428f, -0.0290670f, -0.0000000f,
  -0.0662969f, -0.0101184f, -0.0206235f, -0.2544996f, -0.0722370f, +0.0444386f, -0.0884879f, +0.0000000f,
  +0.0214352f, -0.0116616f, +0.2678376f, -0.0114207f, -0.0200922f, -0.0234317f, -0.1336639f, -0.0000000f,
  -0.4373156f, -0.0117208f, +0.2281690f, +0.0421387f, +0.2353713f, +0.0528807f, -0.1712259f, -0.0000000f,
  +0.0155204f, +0.0430334f, -0.0030553f, +0.0429445f, +0.0243561f, -0.0732393f, -0.0356292f, +0.0000000f,
  +0.0340799f, +0.0521354f, -0.0679984f, +0.0188091f, +0.0319567f, -0.0370476f, +0.1121626f, +0.0000000f,
  +0.1991199f, -0.2250262f, -0.1204977f, -0.2522086f, -0.0485726f, -0.2148070f, +0.1147854f, -0.0000000f,
  -0.0814130f, +0.2394085f, +0.0147138f, +0.0975615f, +0.0293794f, +0.0000598f, +0.0952973f, +0.0000000f,
  -0.0328161f, +0.0383996f, +0.0240453f, -0.0415998f, +0.0064562f, -0.0426462f, +0.0247284f, +0.0000000f,
  +0.0578439f, +0.1807450f, -0.0143292f, +0.0040069f, -0.1152719f, -0.0183659f, -0.0073135f, -0.0000000f,
  +0.0089258f, -0.1477576f, -0.0167054f, +0.0752905f, -0.0912233f, -0.1068055f, -0.0343729f, -0.0000000f,
  -0.0209000f, -0.0047364f, -0.0653786f, +0.0568346f, +0.0203288f, +0.0106288f, +0.0281217f, -0.0000000f,
  +0.0212033f, +0.0320367f, +0.0052462f, +0.0404669f, -0.0494124f, -0.0107223f, -0.0759615f, -0.0000000f,
  -0.0471689f, +0.0110038f, -0.0168072f, +0.0025447f, +0.0206626f, +0.0282467f, -0.0094797f, -0.0000000f,
  +0.0236316f, -0.0043001f, +0.1096011f, +0.0945990f, -0.0071648f, -0.0113026f, -0.1300986f, -0.0000000f,
  -0.7114801f, +0.2524469f, +0.1794331f, +0.2522171f, +0.1498580f, +0.1007625f, -0.5418399f, -0.0000000f,
  +0.0497224f, +0.0591122f, -0.0063043f, +0.0698547f, +0.2121207f, -0.4059179f, -0.1361930f, -0.0000000f,
  -0.0078963f, +0.0289320f, +0.0931024f, +0.0447585f, +0.0276567f, +0.0267438f, -0.0018661f, -0.0000000f,
  +0.0506895f, -0.1126668f, +0.0731030f, +0.1807304f, -0.0686602f, +0.0736502f, -0.1435685f, -0.0000000f,
  +0.0226186f, -0.2373941f, +0.0252588f, +0.1507458f, +0.0173208f, +0.0579661f, +0.0079520f, -0.0000000f,
  +0.0154410f, -0.0292100f, +0.1285481f, -0.0061711f, -0.0405947f, -0.0191371f, +0.0589700f, -0.0000000f,
  -0.1814182f, +0.0254027f, +0.0118924f, +0.0505876f, +0.0801490f, +0.0811626f, -0.1218843f, -0.0000000f,
  -0.0868020f, +0.0913312f, -0.0133564f, -0.1081141f, +0.0202165f, +0.0670652f, +0.0779824f, -0.0000000f,
  -0.0409831f, +0.0236212f, +0.1080993f, +0.0157440f, +0.0388376f, -0.0022377f, -0.0265157f, -0.0000000f,
  +0.2435093f, +0.2395404f, +0.1676033f, +0.1609058f, -0.6358594f, +0.1186021f, -0.4128874f, -0.0000000f,
  -0.0581812f, +0.0524868f, -0.0320403f, -0.0617387f, +0.2378477f, +0.0341218f, +0.0214714f, -0.0000000f,
  -0.0295678f, +0.0165090f, +0.0622089f, -0.0567169f, -0.0104718f, +0.0105007f, +0.0339567f, -0.0000000f,
  +0.0039561f, -0.0627284f, +0.0406816f, -0.0106574f, +0.0638991f, +0.0298513f, +0.0357622f, -0.0000000f,
  +0.0341811f, +0.0134476f, +0.0397725f, -0.0379434f, -0.0821844f, +0.0758408f, -0.0578571f, -0.0000000f
);

const float biases[4] = float[4](
  +0.0324065f, +0.0140193f, +0.6750330f, +0.2661170f
);

vec4 hook() {
    const vec4 r[9][2] = vec4[9][2](
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 1.0f)))
    );

    float sum[4] = biases;
    for (int n = 0; n < 4; n++) {
        for (int i = 0; i < 9; i++) {
            const vec4 k0 = vec4(kernels[n * 8 * 9 + 8 * i + 0], kernels[n * 8 * 9 + 8 * i + 1], kernels[n * 8 * 9 + 8 * i + 2], kernels[n * 8 * 9 + 8 * i + 3]);
            const vec4 k1 = vec4(kernels[n * 8 * 9 + 8 * i + 4], kernels[n * 8 * 9 + 8 * i + 5], kernels[n * 8 * 9 + 8 * i + 6], kernels[n * 8 * 9 + 8 * i + 7]);
            sum[n] += (dot(k0, r[i][0]) + dot(k1, r[i][1]));
        }
    }

    return ACTIVE(vec4(sum[0], sum[1], sum[2], sum[3]));
}

//!HOOK LUMA
//!DESC ACNet Layer8 L1
//!WHEN OUTPUT.w LUMA.w / 1.2 > OUTPUT.h LUMA.h / 1.2 > *
//!BIND TMP2_L0
//!BIND TMP2_L1
//!SAVE TMP1_L1
//!COMPONENTS 4

#define ACTIVE(v) (max(v, 0.0f))

#define TEX_BIND_L0_TEXOFF TMP2_L0_texOff
#define TEX_BIND_L0_TEX TMP2_L0_tex
#define TEX_BIND_L0_POS TMP2_L0_pos
#define TEX_BIND_L0_SIZE TMP2_L0_size
#define TEX_BIND_L0_PT TMP2_L0_pt

#define TEX_BIND_L1_TEXOFF TMP2_L1_texOff
#define TEX_BIND_L1_TEX TMP2_L1_tex
#define TEX_BIND_L1_POS TMP2_L1_pos
#define TEX_BIND_L1_SIZE TMP2_L1_size
#define TEX_BIND_L1_PT TMP2_L1_pt

const float kernels[288] = float[288](
  -0.0184971f, +0.0017742f, -0.1568518f, +0.0520622f, +0.0153725f, -0.0069905f, -0.0007968f, -0.0000000f,
  -0.0245540f, +0.0214874f, +0.0984339f, +0.0669135f, +0.0395865f, -0.0639720f, -0.2119908f, -0.0000000f,
  +0.1442778f, +0.0331472f, -0.0012502f, +0.0075256f, +0.0469090f, -0.1843004f, -0.0434615f, -0.0000000f,
  +0.0142169f, -0.0109709f, +0.3137027f, +0.0249663f, -0.0229111f, +0.0044453f, -0.0429288f, -0.0000000f,
  -0.2364668f, +0.3016209f, -0.0288791f, +0.2808091f, -0.1456828f, +0.2068670f, -0.2822666f, -0.0000000f,
  +0.0840971f, +0.0523908f, +0.0026313f, +0.0298152f, -0.3896433f, +0.3003224f, +0.0289973f, -0.0000000f,
  -0.0102507f, +0.0183412f, +0.0175481f, +0.0223746f, +0.0228495f, +0.0172425f, -0.0018741f, -0.0000000f,
  -0.0042137f, -0.1339037f, +0.0066741f, +0.0014257f, -0.0422974f, +0.0098548f, +0.0111655f, -0.0000000f,
  +0.0060831f, +0.0943031f, -0.0017681f, -0.0747023f, +0.0657355f, -0.0974755f, +0.0018381f, -0.0000000f,
  +0.0445048f, -0.0378559f, -0.3000766f, -0.1168795f, -0.0999725f, -0.0343768f, +0.0921640f, -0.0000000f,
  +0.0888026f, -0.0171473f, +0.2148456f, +0.0260684f, +0.1355444f, -0.0330858f, -0.0843069f, -0.0000000f,
  +0.0113845f, +0.1598404f, -0.0543024f, -0.1349000f, +0.0216562f, -0.0950972f, +0.0789221f, -0.0000000f,
  -0.0394336f, -0.0264593f, +0.0577243f, -0.1608544f, -0.0883026f, -0.0074538f, +0.1251894f, -0.0000000f,
  +0.1931935f, +0.1746916f, +0.3216789f, +0.1940882f, +0.5443453f, +0.2254463f, -0.6180934f, -0.0000000f,
  -0.0120156f, +0.1258425f, -0.0252614f, +0.1143380f, -0.0405820f, -0.0263795f, -0.1089541f, -0.0000000f,
  -0.0460725f, +0.0163868f, +0.0692770f, -0.0738188f, -0.0348050f, +0.0144400f, +0.0627442f, -0.0000000f,
  +0.1176875f, +0.1736963f, +0.0750350f, -0.0778805f, -0.1529087f, +0.1320504f, -0.0449515f, -0.0000000f,
  +0.0074816f, -0.1735025f, +0.0634848f, +0.0073699f, -0.0369170f, +0.1616412f, -0.0325477f, -0.0000000f,
  -0.0086113f, +0.0014758f, -0.3075596f, +0.0135412f, -0.0041941f, +0.0297559f, -0.1141135f, -0.0000000f,
  -0.0709874f, +0.0333492f, +0.0262845f, +0.1704411f, +0.0895994f, -0.1160067f, -0.1769713f, -0.0000000f,
  +0.0582646f, -0.0108671f, -0.0190581f, +0.0896260f, -0.0336843f, -0.0731708f, -0.0580867f, -0.0000000f,
  -0.0131479f, -0.0402343f, -0.0007935f, +0.0668145f, -0.0113098f, +0.0279393f, +0.0796133f, -0.0000000f,
  +0.5637107f, +0.1989448f, +0.1264440f, +0.2642964f, -0.4373085f, +0.2133405f, -0.4281442f, -0.0000000f,
  +0.0505795f, +0.1397224f, +0.0295670f, +0.1740916f, +0.0571767f, -0.4020978f, -0.1081362f, -0.0000000f,
  +0.0117406f, -0.0191672f, -0.0392741f, -0.0006103f, -0.0004572f, -0.0086847f, -0.0306101f, -0.0000000f,
  -0.0356139f, -0.0417227f, +0.0110299f, +0.0175693f, +0.1017517f, +0.0818289f, +0.0011342f, -0.0000000f,
  -0.0612645f, -0.1998225f, -0.0094885f, +0.1309033f, +0.0412111f, +0.0442249f, -0.0022322f, -0.0000000f,
  +0.0302832f, -0.0302763f, +0.1389486f, -0.1301989f, -0.0816031f, +0.0168761f, -0.0495684f, +0.0000000f,
  -0.0561915f, +0.0143658f, -0.3389952f, +0.1433398f, +0.1298154f, -0.0325895f, +0.0021857f, -0.0000000f,
  -0.1044730f, +0.0263634f, +0.0077998f, -0.0557003f, -0.0731932f, +0.0556453f, +0.0861273f, -0.0000000f,
  -0.0145782f, -0.0849624f, +0.2476905f, -0.0353863f, -0.0614688f, +0.0252310f, +0.0865931f, -0.0000000f,
  -0.2874455f, +0.0789984f, -0.1850574f, +0.1099212f, +0.1713081f, +0.2998360f, -0.5813382f, -0.0000000f,
  +0.1908871f, -0.0477171f, -0.0023116f, -0.0802350f, +0.4025484f, -0.0369945f, +0.3450665f, +0.0000000f,
  -0.0272515f, -0.0320038f, +0.0313614f, -0.0058978f, -0.0064582f, +0.0093322f, +0.0488545f, +0.0000000f,
  +0.0980692f, -0.0215793f, -0.0117178f, +0.0770390f, -0.0827411f, +0.2075780f, -0.1050643f, -0.0000000f,
  -0.0145799f, +0.0112470f, -0.0182857f, -0.0746193f, -0.0222201f, -0.0219859f, +0.0415845f, -0.0000000f
);

const float biases[4] = float[4](
  +0.3645926f, +0.3590603f, +0.5597306f, +0.0815938f
);

vec4 hook() {
    const vec4 r[9][2] = vec4[9][2](
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 1.0f)))
    );

    float sum[4] = biases;
    for (int n = 0; n < 4; n++) {
        for (int i = 0; i < 9; i++) {
            const vec4 k0 = vec4(kernels[n * 8 * 9 + 8 * i + 0], kernels[n * 8 * 9 + 8 * i + 1], kernels[n * 8 * 9 + 8 * i + 2], kernels[n * 8 * 9 + 8 * i + 3]);
            const vec4 k1 = vec4(kernels[n * 8 * 9 + 8 * i + 4], kernels[n * 8 * 9 + 8 * i + 5], kernels[n * 8 * 9 + 8 * i + 6], kernels[n * 8 * 9 + 8 * i + 7]);
            sum[n] += (dot(k0, r[i][0]) + dot(k1, r[i][1]));
        }
    }

    return ACTIVE(vec4(sum[0], sum[1], sum[2], sum[3]));
}

//!HOOK LUMA
//!DESC ACNet Layer9 L0
//!WIDTH LUMA.w 2 *
//!HEIGHT LUMA.h 2 *
//!BIND TMP1_L0
//!BIND TMP1_L1
//!COMPONENTS 1

#define ACTIVE(v) (max(v, 0.0f))

#define TEX_BIND_L0_TEXOFF TMP1_L0_texOff
#define TEX_BIND_L0_TEX TMP1_L0_tex
#define TEX_BIND_L0_POS TMP1_L0_pos
#define TEX_BIND_L0_SIZE TMP1_L0_size
#define TEX_BIND_L0_PT TMP1_L0_pt

#define TEX_BIND_L1_TEXOFF TMP1_L1_texOff
#define TEX_BIND_L1_TEX TMP1_L1_tex
#define TEX_BIND_L1_POS TMP1_L1_pos
#define TEX_BIND_L1_SIZE TMP1_L1_size
#define TEX_BIND_L1_PT TMP1_L1_pt

const float kernels[32] = float[32](
  +0.0882308f, -0.3209064f, +0.1033665f, +0.3621237f, +0.2229542f, -0.2097334f, +0.2420552f, +0.1137127f,
  +0.0421761f, -0.4870340f, +0.0173247f, -0.1645023f, +0.3026482f, +0.1893825f, +0.3362843f, -0.2165238f,
  +0.3775496f, -0.0383584f, +0.5011001f, -0.1304257f, +0.1618423f, -0.0325640f, -0.0938498f, +0.2272790f,
  +0.4754364f, +0.0530301f, +0.3899779f, +0.0012911f, -0.4513567f, +0.1434326f, +0.3155702f, -0.1283752f
);

vec4 hook() {
    vec2 fcoord = fract(TEX_BIND_L0_POS * TEX_BIND_L0_SIZE);
    vec2 pos = TEX_BIND_L0_POS + (vec2(0.5f) - fcoord) * TEX_BIND_L0_PT;

    ivec2 icoord = ivec2(fcoord * vec2(2.0f));
    int index = icoord.y * 2 + icoord.x;

    vec4 r0 = TEX_BIND_L0_TEX(pos);
    vec4 r1 = TEX_BIND_L1_TEX(pos);

    vec4 k0 = vec4(kernels[8 * index + 0], kernels[8 * index + 1], kernels[8 * index + 2], kernels[8 * index + 3]);
    vec4 k1 = vec4(kernels[8 * index + 4], kernels[8 * index + 5], kernels[8 * index + 6], kernels[8 * index + 7]);

    return vec4(clamp(dot(r0, k0) + dot(r1, k1), 0.0f, 1.0f), 0.0f, 0.0f, 1.0f);
}
