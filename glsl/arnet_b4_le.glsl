//!HOOK LUMA
//!DESC ARNet b4 Layer0 L0
//!WHEN OUTPUT.w LUMA.w / 1.2 > OUTPUT.h LUMA.h / 1.2 > *
//!BIND LUMA
//!SAVE FEAT_L0
//!COMPONENTS 4

#define ACTIVE(v) (v)

#define TEX_BIND_L0_TEXOFF LUMA_texOff
#define TEX_BIND_L0_TEX LUMA_tex
#define TEX_BIND_L0_POS LUMA_pos
#define TEX_BIND_L0_SIZE LUMA_size
#define TEX_BIND_L0_PT LUMA_pt

const float kernels[36] = float[36](
  -0.6927442f, -0.0030111f, +0.3670628f, +0.1631552f, +0.0355144f, +0.0284537f, -0.1028187f, +0.4137266f,
  +0.0267958f, +0.1051541f, -0.1358465f, -0.1803131f, -0.1330780f, +0.1726892f, -0.0032345f, -0.1141640f,
  -0.6094778f, +0.3672927f, -0.2315896f, +0.0115672f, -0.4962909f, -0.1568848f, +0.8372228f, -0.2207955f,
  -0.6284877f, +0.5914272f, +0.4305337f, -0.4431521f, -0.3439512f, -0.3811292f, +0.2245572f, +0.4626314f,
  -0.4477988f, +0.3959771f, +0.7121016f, +0.0707599f
);

const float biases[4] = float[4](
  +0.0403674f, +0.0508365f, -0.0625928f, -0.0042455f
);

vec4 hook() {
    const vec4 r0 = vec4(
        TEX_BIND_L0_TEXOFF(vec2(-1.0f,-1.0f)).x,
        TEX_BIND_L0_TEXOFF(vec2( 0.0f,-1.0f)).x,
        TEX_BIND_L0_TEXOFF(vec2( 1.0f,-1.0f)).x,
        TEX_BIND_L0_TEXOFF(vec2(-1.0f, 0.0f)).x
    );
    const vec4 r4 = vec4(
        TEX_BIND_L0_TEXOFF(vec2( 0.0f, 0.0f)).x,
        TEX_BIND_L0_TEXOFF(vec2( 1.0f, 0.0f)).x,
        TEX_BIND_L0_TEXOFF(vec2(-1.0f, 1.0f)).x,
        TEX_BIND_L0_TEXOFF(vec2( 0.0f, 1.0f)).x
    );
    const float r8 = TEX_BIND_L0_TEXOFF(vec2( 1.0f, 1.0f)).x;

    float sum[4] = biases;
    for(int n = 0; n < 4; n++) {
        const vec4 k0 = vec4(kernels[n * 9 + 0], kernels[n * 9 + 1], kernels[n * 9 + 2], kernels[n * 9 + 3]);
        const vec4 k4 = vec4(kernels[n * 9 + 4], kernels[n * 9 + 5], kernels[n * 9 + 6], kernels[n * 9 + 7]);
        const float k8 = kernels[n * 9 + 8];
        sum[n] += (dot(r0, k0) + dot(r4, k4) + r8 * k8);
    }

    return ACTIVE(vec4(sum[0], sum[1], sum[2], sum[3]));
}

//!HOOK LUMA
//!DESC ARNet b4 Layer0 L1
//!WHEN OUTPUT.w LUMA.w / 1.2 > OUTPUT.h LUMA.h / 1.2 > *
//!BIND LUMA
//!SAVE FEAT_L1
//!COMPONENTS 4

#define ACTIVE(v) (v)

#define TEX_BIND_L0_TEXOFF LUMA_texOff
#define TEX_BIND_L0_TEX LUMA_tex
#define TEX_BIND_L0_POS LUMA_pos
#define TEX_BIND_L0_SIZE LUMA_size
#define TEX_BIND_L0_PT LUMA_pt

const float kernels[36] = float[36](
  -0.4861287f, -0.2609226f, -0.4103940f, -0.1460695f, -0.1936028f, +0.1895040f, +0.3594488f, +0.4051208f,
  -0.6094947f, +0.0485875f, -0.1634310f, +0.1677374f, -0.7801635f, +1.2474992f, -0.2965650f, -0.5272380f,
  -0.1506296f, +0.1290134f, -0.4992457f, +0.0641956f, -0.1584761f, +0.6643360f, -0.1437831f, +0.3247578f,
  +0.2719913f, +0.0397842f, -0.7275132f, -0.8408838f, +0.1429510f, +0.1523457f, -0.5974618f, +0.5067882f,
  +0.2661844f, +0.0110955f, +0.2983405f, +0.0711600f
);

const float biases[4] = float[4](
  +0.0714916f, +0.0226974f, +0.0126592f, -0.0012868f
);

vec4 hook() {
    const vec4 r0 = vec4(
        TEX_BIND_L0_TEXOFF(vec2(-1.0f,-1.0f)).x,
        TEX_BIND_L0_TEXOFF(vec2( 0.0f,-1.0f)).x,
        TEX_BIND_L0_TEXOFF(vec2( 1.0f,-1.0f)).x,
        TEX_BIND_L0_TEXOFF(vec2(-1.0f, 0.0f)).x
    );
    const vec4 r4 = vec4(
        TEX_BIND_L0_TEXOFF(vec2( 0.0f, 0.0f)).x,
        TEX_BIND_L0_TEXOFF(vec2( 1.0f, 0.0f)).x,
        TEX_BIND_L0_TEXOFF(vec2(-1.0f, 1.0f)).x,
        TEX_BIND_L0_TEXOFF(vec2( 0.0f, 1.0f)).x
    );
    const float r8 = TEX_BIND_L0_TEXOFF(vec2( 1.0f, 1.0f)).x;

    float sum[4] = biases;
    for(int n = 0; n < 4; n++) {
        const vec4 k0 = vec4(kernels[n * 9 + 0], kernels[n * 9 + 1], kernels[n * 9 + 2], kernels[n * 9 + 3]);
        const vec4 k4 = vec4(kernels[n * 9 + 4], kernels[n * 9 + 5], kernels[n * 9 + 6], kernels[n * 9 + 7]);
        const float k8 = kernels[n * 9 + 8];
        sum[n] += (dot(r0, k0) + dot(r4, k4) + r8 * k8);
    }

    return ACTIVE(vec4(sum[0], sum[1], sum[2], sum[3]));
}

//!HOOK LUMA
//!DESC ARNet b4 Layer1 L0
//!WHEN OUTPUT.w LUMA.w / 1.2 > OUTPUT.h LUMA.h / 1.2 > *
//!BIND FEAT_L0
//!BIND FEAT_L1
//!SAVE TMP1_L0
//!COMPONENTS 4

#define ACTIVE(v) (max(v, v * 0.2000000f))

#define TEX_BIND_L0_TEXOFF FEAT_L0_texOff
#define TEX_BIND_L0_TEX FEAT_L0_tex
#define TEX_BIND_L0_POS FEAT_L0_pos
#define TEX_BIND_L0_SIZE FEAT_L0_size
#define TEX_BIND_L0_PT FEAT_L0_pt

#define TEX_BIND_L1_TEXOFF FEAT_L1_texOff
#define TEX_BIND_L1_TEX FEAT_L1_tex
#define TEX_BIND_L1_POS FEAT_L1_pos
#define TEX_BIND_L1_SIZE FEAT_L1_size
#define TEX_BIND_L1_PT FEAT_L1_pt

const float kernels[288] = float[288](
  -0.2507551f, -0.2591158f, -0.2946188f, -0.0599580f, -0.2664949f, -0.1216470f, +0.0030277f, +0.3949844f,
  -0.2421715f, -0.2418094f, -0.0461289f, -0.4722477f, -0.0273559f, -0.0604768f, +0.1973816f, +0.2917252f,
  +0.0399345f, -0.0419951f, -0.3240815f, +0.1096167f, +0.0628762f, -0.2949011f, -0.0059896f, -0.0105881f,
  -0.2625904f, -0.2917910f, -0.2861267f, -0.0679400f, +0.0394764f, +0.1917997f, -0.1614668f, +0.2071980f,
  -0.1352366f, +0.2066171f, -0.1232211f, -0.0862853f, -0.1229036f, +0.3014248f, +0.1519909f, -0.0606299f,
  +0.0843060f, -0.4073349f, +0.3853293f, +0.1078584f, -0.0635077f, -0.0424338f, +0.1984350f, -0.1234293f,
  +0.1151513f, +0.0155612f, -0.2260759f, +0.1180077f, -0.0963015f, +0.0670101f, -0.3303882f, -0.1199465f,
  +0.2141008f, -0.2859830f, +0.3931488f, -0.1436307f, +0.1339182f, -0.1653326f, -0.0631066f, -0.3578507f,
  +0.2018733f, -0.3735227f, -0.0015075f, +0.3019652f, +0.0039835f, +0.0679344f, -0.1853056f, -0.0595564f,
  -0.1108473f, +0.1786167f, +0.0588667f, +0.1883467f, -0.1519485f, -0.0501342f, -0.0714165f, +0.0799978f,
  -0.0679062f, +0.2781274f, -0.0866525f, -0.1070402f, +0.0529165f, -0.0380060f, -0.2793062f, +0.2350150f,
  +0.1972652f, +0.0272041f, +0.2418467f, +0.1977781f, -0.0622882f, +0.1682457f, -0.2128277f, -0.4149738f,
  +0.1391373f, +0.0552756f, +0.0993180f, -0.0634484f, -0.1557756f, +0.0817476f, -0.0670021f, -0.1164984f,
  +0.0347212f, +0.0503487f, -0.2913670f, -0.4165540f, +0.0165446f, +0.2210274f, -0.1223090f, +0.6729967f,
  +0.3319007f, -0.0071272f, +0.2500883f, +0.1880375f, -0.1073532f, +0.3872555f, +0.2525240f, +0.0948871f,
  +0.1942918f, -0.0458251f, +0.2890578f, +0.1134574f, +0.0089570f, +0.0088087f, +0.3646417f, -0.4326319f,
  +0.4960298f, -0.0234308f, -0.1063577f, -0.0810779f, +0.1362312f, +0.2372557f, +0.2002060f, +0.2236081f,
  +0.1487608f, -0.1019161f, +0.2127569f, +0.0890860f, -0.0077281f, -0.0604639f, -0.1820656f, -0.3228793f,
  -0.6759568f, +0.4598997f, -0.1996436f, -0.1067584f, +0.3206158f, +0.0062296f, -0.1570935f, +0.0469627f,
  -0.4588937f, +0.2227334f, -0.3790063f, -0.0641413f, +0.3169473f, +0.1537879f, -0.4564112f, +0.3462217f,
  -0.2803976f, +0.6478900f, +0.4371181f, +0.2995687f, +0.3202514f, -0.6137370f, +0.3538951f, -0.6118120f,
  -0.4516487f, +0.2037099f, +0.2076565f, -0.0144631f, +0.2236810f, +0.3157430f, +0.2202915f, +0.1626407f,
  -0.2316002f, +0.5733156f, +0.5376234f, +0.1938803f, +0.1704203f, +0.0106132f, -0.1296768f, +0.3162198f,
  -0.5176570f, +0.2557315f, +0.3101269f, +0.0614701f, +0.2066623f, -0.0033910f, -0.1586412f, -0.3694162f,
  +0.1131851f, +0.1026495f, -0.0373945f, +0.1027821f, +0.0079907f, +0.0258623f, -0.3037093f, +0.1057363f,
  -0.1726415f, +0.2010038f, -0.7004565f, -0.1527339f, -0.0601939f, +0.4599261f, -0.8922453f, -0.0082781f,
  -0.2203162f, -0.0094782f, -0.6778128f, +0.0614704f, +0.1510682f, -0.0074425f, +0.0190505f, +0.5862491f,
  -0.3018204f, +0.3207672f, -0.0281502f, -0.2614059f, -0.0142750f, +0.3858590f, +0.8474958f, +0.1685532f,
  +0.1249453f, -0.0459357f, +0.5013834f, -0.5423391f, -0.2131451f, +0.0617831f, +0.1967797f, -0.1165002f,
  -0.1686591f, +0.3927174f, +0.2590944f, -0.0393399f, -0.0248367f, +0.4213010f, +0.1807446f, +0.0475827f,
  +0.0972424f, +0.0736521f, +0.4059296f, +0.1415752f, -0.1468973f, -0.5335551f, -0.4886508f, -0.4539783f,
  +0.1960553f, -0.1723392f, -0.2427499f, +0.2080933f, -0.0017017f, -0.2500676f, -0.2553728f, -0.3403704f,
  -0.3335528f, -0.1620131f, -0.3071195f, +0.1976724f, -0.1935741f, -0.0201852f, -0.0757752f, -0.0967377f,
  -0.3423981f, +0.0375139f, -0.4997393f, -0.3884243f, -0.0118651f, +0.3260417f, +0.1843593f, -0.1066820f,
  +0.0284977f, -0.0731381f, -0.3206909f, +0.1814554f, +0.0130980f, +0.6431056f, -0.1259185f, -0.3477299f,
  +0.0493361f, +0.0383199f, -0.1410238f, -0.4363511f, -0.2756766f, -0.1108983f, -0.2119492f, -0.6382826f
);

const float biases[4] = float[4](
  +0.3012655f, -0.0183595f, -0.3226351f, +0.0035739f
);

vec4 hook() {
    const vec4 r[9][2] = vec4[9][2](
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 1.0f)))
    );

    float sum[4] = biases;
    for (int n = 0; n < 4; n++) {
        for (int i = 0; i < 9; i++) {
            const vec4 k0 = vec4(kernels[n * 8 * 9 + 8 * i + 0], kernels[n * 8 * 9 + 8 * i + 1], kernels[n * 8 * 9 + 8 * i + 2], kernels[n * 8 * 9 + 8 * i + 3]);
            const vec4 k1 = vec4(kernels[n * 8 * 9 + 8 * i + 4], kernels[n * 8 * 9 + 8 * i + 5], kernels[n * 8 * 9 + 8 * i + 6], kernels[n * 8 * 9 + 8 * i + 7]);
            sum[n] += (dot(k0, r[i][0]) + dot(k1, r[i][1]));
        }
    }

    return ACTIVE(vec4(sum[0], sum[1], sum[2], sum[3]));
}

//!HOOK LUMA
//!DESC ARNet b4 Layer1 L1
//!WHEN OUTPUT.w LUMA.w / 1.2 > OUTPUT.h LUMA.h / 1.2 > *
//!BIND FEAT_L0
//!BIND FEAT_L1
//!SAVE TMP1_L1
//!COMPONENTS 4

#define ACTIVE(v) (max(v, v * 0.2000000f))

#define TEX_BIND_L0_TEXOFF FEAT_L0_texOff
#define TEX_BIND_L0_TEX FEAT_L0_tex
#define TEX_BIND_L0_POS FEAT_L0_pos
#define TEX_BIND_L0_SIZE FEAT_L0_size
#define TEX_BIND_L0_PT FEAT_L0_pt

#define TEX_BIND_L1_TEXOFF FEAT_L1_texOff
#define TEX_BIND_L1_TEX FEAT_L1_tex
#define TEX_BIND_L1_POS FEAT_L1_pos
#define TEX_BIND_L1_SIZE FEAT_L1_size
#define TEX_BIND_L1_PT FEAT_L1_pt

const float kernels[288] = float[288](
  -0.4412075f, -0.1409510f, -0.0556430f, -0.1965754f, +0.0087843f, +0.2834948f, +0.1413290f, +0.2127646f,
  -0.0826858f, -0.0461296f, -0.0125608f, +0.2272954f, -0.0214296f, +0.4575755f, +0.5528413f, +0.0607569f,
  +0.0900322f, +0.0494170f, -0.0190739f, -0.0674220f, -0.1689509f, +0.0771529f, +0.2711088f, -0.3910725f,
  +0.2004927f, -0.0786061f, -0.6701102f, -0.5818108f, -0.3014625f, +0.2369112f, -0.1115292f, +0.3665534f,
  -0.1229802f, +0.2047585f, -0.7382713f, -0.5073917f, -0.2440856f, -0.4470221f, -0.1301918f, -1.4990550f,
  -0.0146291f, -0.3781766f, -0.1172623f, -0.2956023f, +0.0992815f, +0.4971538f, -0.1158582f, -0.6498480f,
  +0.0615460f, -0.1498200f, +0.2364560f, -0.1394496f, +0.2363131f, +0.0409121f, -0.0758515f, -0.7157005f,
  +0.2665154f, -0.1606871f, -0.2860403f, -0.1731833f, -0.0335503f, -0.0975199f, +0.1120321f, +0.2109737f,
  +0.0872668f, -0.0142399f, +0.1263807f, +0.1028882f, -0.2178958f, -0.0441532f, +0.2689720f, +0.5662735f,
  +0.0955886f, -0.4286497f, +0.0450167f, +0.0043660f, +0.0168510f, +0.1170538f, -0.3377545f, -0.0139174f,
  -0.1276622f, -0.2092506f, +0.3113341f, -0.0611003f, -0.2174206f, +0.4648515f, +0.2582146f, +0.2090858f,
  +0.2025335f, +0.0909869f, +0.3267716f, +0.0200349f, +0.0030935f, +0.3018005f, -0.0630989f, +0.2481821f,
  -0.1777632f, -0.0688386f, +0.1110573f, +0.1868753f, -0.2381783f, +0.1438904f, -0.2936724f, -0.0707899f,
  +0.0651014f, -0.4106572f, -0.2757581f, -0.0959469f, -0.1511528f, -0.5851195f, -0.2904775f, +0.1685955f,
  -0.0717932f, -0.1155550f, +0.3333346f, -0.2441260f, -0.0673309f, -0.2265940f, +0.1134216f, -0.3448740f,
  -0.0562213f, +0.2127351f, +0.0118273f, -0.1956252f, +0.0812477f, -0.0634283f, +0.0460872f, -0.1863485f,
  +0.0933500f, +0.0295714f, -0.1486237f, -0.0701500f, -0.1174257f, -0.0569862f, +0.1491312f, +0.2403794f,
  -0.1902311f, +0.2256646f, -0.2075515f, +0.2796054f, +0.2487840f, +0.5548440f, +0.2000874f, +0.1817233f,
  -0.4485160f, -0.1614781f, +0.2527358f, +0.2041453f, +0.1738133f, +0.5069768f, +0.5284117f, -0.4896590f,
  -0.4003653f, +0.3058514f, -0.1969844f, -0.3869928f, +0.0039482f, -0.0045681f, +0.7799602f, -0.0920971f,
  +0.0040977f, -0.1174952f, +0.1947538f, -0.2771589f, +0.0076010f, +0.1890384f, +0.1968810f, -0.3241088f,
  +0.0430894f, +0.1606826f, +0.4072312f, +0.1793981f, +0.1683096f, +0.2009404f, +0.0358140f, -0.1426103f,
  +0.3101676f, -0.0662012f, +0.1162647f, +0.1505804f, +0.1836822f, -0.2621420f, -0.3704995f, +0.3969965f,
  -0.3751140f, -0.3078694f, +0.0714737f, +0.0928954f, -0.2819583f, +0.0968484f, -0.0241211f, -0.4224580f,
  +0.0792815f, -0.2170865f, +0.0753654f, +0.1627343f, +0.0003011f, +0.1331598f, -0.0329780f, -0.3927617f,
  +0.3137775f, -0.1478258f, +0.0910223f, -0.0723619f, -0.4251781f, +0.1102594f, +0.2345976f, +0.1019980f,
  +0.3430708f, -0.3368223f, -0.5946657f, -0.0449605f, -0.2194431f, +0.0017377f, -0.0333406f, -0.0097978f,
  +0.0217604f, +0.0716646f, +0.1411711f, -0.3378856f, +0.0480439f, -0.2352666f, +0.0862479f, +0.0979660f,
  +0.0730847f, -0.2320606f, +0.1868676f, +0.1489246f, +0.0834066f, +0.4062022f, -0.0633455f, +0.0067200f,
  +0.1883290f, -0.3334665f, -0.2142818f, +0.1471232f, +0.1499964f, -0.5030693f, +0.2767598f, +0.1449948f,
  +0.3529872f, +0.0834223f, -0.0605603f, -0.0948633f, +0.0760211f, +0.0995817f, +0.1577477f, +0.1160179f,
  +0.0557793f, +0.1775852f, +0.1982534f, -0.1477440f, -0.1038167f, +0.0342608f, -0.0275084f, -0.3052987f,
  +0.0995207f, -0.2333879f, +0.1043715f, +0.1043035f, -0.0745722f, -0.3714167f, +0.4213277f, -0.1490731f,
  +0.3119108f, +0.0233798f, -0.4906055f, -0.2886574f, -0.0372724f, +0.0604683f, -0.1425353f, +0.2417653f,
  +0.2517259f, -0.0342168f, -0.4203036f, -0.5052636f, +0.1596080f, -0.3375020f, -0.0989096f, -0.4656588f,
  -0.1127526f, -0.7030182f, -0.4993671f, -0.1863730f, -0.2699617f, -0.4937062f, -0.5030721f, -0.0743950f
);

const float biases[4] = float[4](
  -0.0383901f, -0.0721227f, +0.0244124f, -0.0971309f
);

vec4 hook() {
    const vec4 r[9][2] = vec4[9][2](
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 1.0f)))
    );

    float sum[4] = biases;
    for (int n = 0; n < 4; n++) {
        for (int i = 0; i < 9; i++) {
            const vec4 k0 = vec4(kernels[n * 8 * 9 + 8 * i + 0], kernels[n * 8 * 9 + 8 * i + 1], kernels[n * 8 * 9 + 8 * i + 2], kernels[n * 8 * 9 + 8 * i + 3]);
            const vec4 k1 = vec4(kernels[n * 8 * 9 + 8 * i + 4], kernels[n * 8 * 9 + 8 * i + 5], kernels[n * 8 * 9 + 8 * i + 6], kernels[n * 8 * 9 + 8 * i + 7]);
            sum[n] += (dot(k0, r[i][0]) + dot(k1, r[i][1]));
        }
    }

    return ACTIVE(vec4(sum[0], sum[1], sum[2], sum[3]));
}

//!HOOK LUMA
//!DESC ARNet b4 Layer2 L0
//!WHEN OUTPUT.w LUMA.w / 1.2 > OUTPUT.h LUMA.h / 1.2 > *
//!BIND TMP1_L0
//!BIND TMP1_L1
//!BIND FEAT_L0
//!SAVE TMP2_L0
//!COMPONENTS 4

#define ACTIVE(v) (v)

#define TEX_BIND_L0_TEXOFF TMP1_L0_texOff
#define TEX_BIND_L0_TEX TMP1_L0_tex
#define TEX_BIND_L0_POS TMP1_L0_pos
#define TEX_BIND_L0_SIZE TMP1_L0_size
#define TEX_BIND_L0_PT TMP1_L0_pt

#define TEX_BIND_L1_TEXOFF TMP1_L1_texOff
#define TEX_BIND_L1_TEX TMP1_L1_tex
#define TEX_BIND_L1_POS TMP1_L1_pos
#define TEX_BIND_L1_SIZE TMP1_L1_size
#define TEX_BIND_L1_PT TMP1_L1_pt

#define TEX_BIND_L2_TEXOFF FEAT_L0_texOff
#define TEX_BIND_L2_TEX FEAT_L0_tex
#define TEX_BIND_L2_POS FEAT_L0_pos
#define TEX_BIND_L2_SIZE FEAT_L0_size
#define TEX_BIND_L2_PT FEAT_L0_pt

const float kernels[288] = float[288](
  +0.0920054f, -0.0081632f, -0.2798947f, -0.1040432f, +0.1541475f, +0.2051195f, +0.1110417f, -0.0113155f,
  -0.1970299f, -0.1887150f, +0.2214586f, +0.2033564f, -0.2070338f, +0.0371182f, -0.0206608f, -0.1655157f,
  -0.1075935f, -0.0676145f, +0.0260482f, +0.0453687f, -0.0447457f, +0.1393087f, +0.0596573f, -0.0748691f,
  -0.0166306f, -0.0460477f, +0.3434907f, +0.0871818f, +0.1509946f, +0.2154716f, +0.1634365f, +0.1762503f,
  -0.0989158f, -0.1681334f, +0.0314966f, +0.1296579f, -0.2131966f, -0.1988126f, -0.3975974f, +0.0370601f,
  +0.1574416f, -0.1341111f, +0.3458071f, +0.0940901f, -0.1143298f, +0.1850339f, -0.0157421f, -0.2184334f,
  +0.2372998f, -0.1904618f, +0.2531424f, +0.0466389f, -0.2125217f, -0.3967469f, -0.0798970f, -0.1368829f,
  -0.1763052f, -0.2024289f, +0.4850312f, +0.0849537f, -0.1275494f, -0.2610352f, -0.2105587f, -0.0295979f,
  +0.0267661f, -0.2276309f, +0.2723300f, +0.1291108f, -0.1194103f, -0.0900751f, -0.2912467f, -0.1919734f,
  +0.0037109f, -0.0519972f, -0.1071531f, -0.0047083f, -0.0170399f, +0.0858383f, +0.1650243f, -0.0832777f,
  +0.1885749f, +0.2716156f, -0.4512030f, -0.1264653f, +0.0540891f, +0.2127923f, +0.1535685f, -0.1166916f,
  -0.2118284f, +0.0218559f, -0.0166928f, +0.0483086f, +0.1315936f, -0.1711785f, +0.0702632f, +0.1417064f,
  +0.1696865f, +0.3588442f, +0.2154306f, +0.0336774f, +0.0558748f, +0.3707992f, +0.2586029f, +0.3221773f,
  +0.1651239f, +0.4019493f, -0.2127211f, -0.1408826f, -0.0893276f, +0.0008655f, +0.4430667f, -0.2314586f,
  +0.0433736f, -0.1749773f, +0.3223325f, -0.0505935f, +0.2484251f, -0.1391142f, +0.1134528f, +0.2447866f,
  -0.0564590f, +0.0313317f, -0.1623085f, +0.0484321f, +0.0354140f, +0.2495336f, +0.1809022f, +0.1540816f,
  +0.1804826f, +0.0789238f, +0.2487422f, -0.1113597f, -0.2047422f, -0.0820201f, +0.0435155f, -0.1189222f,
  -0.1518526f, +0.1647728f, +0.0043315f, -0.0124012f, +0.3360428f, -0.2724416f, +0.0831560f, +0.1522063f,
  +0.0882372f, -0.2561389f, +0.3133906f, +0.0417044f, -0.1304979f, +0.1214417f, +0.2514718f, -0.0719113f,
  -0.2540281f, -0.3043633f, -0.0250038f, +0.1613016f, +0.1300808f, +0.0144224f, +0.2193868f, -0.1386523f,
  +0.0409486f, -0.1716262f, -0.3815387f, -0.1399277f, -0.1293422f, -0.0253604f, +0.4239985f, -0.1724638f,
  -0.0799418f, -0.1925852f, -0.0687966f, +0.0629431f, +0.0413826f, -0.5293796f, +0.1646041f, -0.0864655f,
  +0.3672691f, +0.4274209f, -0.1803093f, -0.2675645f, +0.5354350f, +0.0900960f, +0.0866242f, -0.0661271f,
  +0.3178625f, -0.0128077f, -0.2898064f, -0.1997459f, +0.0157200f, +0.3690803f, -0.0318681f, -0.4179611f,
  -0.1210248f, +0.1754318f, -0.2018947f, -0.0615635f, -0.0578832f, +0.3223602f, -0.1081007f, +0.0482197f,
  +0.0457174f, -0.1990534f, +0.1797545f, -0.0152806f, +0.3081180f, -0.5212904f, +0.2474364f, -0.0383856f,
  -0.1365725f, +0.0455354f, +0.2962418f, +0.0420392f, +0.4733931f, -0.0044280f, +0.2670979f, -0.2934180f,
  +0.0419267f, -0.1870189f, -0.2731282f, +0.1190806f, +0.0787325f, -0.1860555f, -0.0571329f, -0.0559261f,
  -0.1014759f, +0.0763366f, -0.0354831f, +0.1359576f, +0.1136640f, -0.0682046f, +0.0249751f, -0.0112995f,
  -0.0898547f, -0.0318610f, -0.3099775f, +0.3594674f, -0.3027784f, -0.1711571f, +0.1862659f, -0.0392651f,
  -0.4988228f, -0.2991732f, -0.1759915f, +0.0937607f, -0.0460716f, +0.0356449f, -0.5612723f, +0.0336481f,
  -0.1809360f, -0.1447685f, -0.0664592f, +0.0757760f, -0.1735097f, -0.4020658f, +0.2004843f, +0.5552257f,
  +0.4540678f, +0.0932664f, +0.0421107f, -0.0204701f, -0.4266195f, +0.2936312f, -0.0621361f, -0.3639978f,
  -0.1822841f, +0.1056775f, +0.4721252f, +0.0698549f, -0.1403580f, +0.2388270f, -0.4216762f, -0.2725015f,
  -0.1410986f, -0.2203506f, +0.3039337f, -0.1718750f, -0.0641950f, +0.2088835f, +0.0147174f, -0.0371139f,
  +0.0773268f, -0.0430874f, -0.0403894f, +0.0049425f, +0.0735216f, -0.1742373f, +0.1908961f, +0.2005900f
);

const float biases[4] = float[4](
  +0.5598915f, -0.1874962f, -0.0921204f, +0.0085564f
);

vec4 hook() {
    const vec4 r[9][2] = vec4[9][2](
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 1.0f)))
    );

    float sum[4] = biases;
    for (int n = 0; n < 4; n++) {
        for (int i = 0; i < 9; i++) {
            const vec4 k0 = vec4(kernels[n * 8 * 9 + 8 * i + 0], kernels[n * 8 * 9 + 8 * i + 1], kernels[n * 8 * 9 + 8 * i + 2], kernels[n * 8 * 9 + 8 * i + 3]);
            const vec4 k1 = vec4(kernels[n * 8 * 9 + 8 * i + 4], kernels[n * 8 * 9 + 8 * i + 5], kernels[n * 8 * 9 + 8 * i + 6], kernels[n * 8 * 9 + 8 * i + 7]);
            sum[n] += (dot(k0, r[i][0]) + dot(k1, r[i][1]));
        }
    }

    return ACTIVE(vec4(sum[0], sum[1], sum[2], sum[3]) * 0.2000000f + TEX_BIND_L2_TEXOFF(vec2(0.0f, 0.0f)));
}

//!HOOK LUMA
//!DESC ARNet b4 Layer2 L1
//!WHEN OUTPUT.w LUMA.w / 1.2 > OUTPUT.h LUMA.h / 1.2 > *
//!BIND TMP1_L0
//!BIND TMP1_L1
//!BIND FEAT_L1
//!SAVE TMP2_L1
//!COMPONENTS 4

#define ACTIVE(v) (v)

#define TEX_BIND_L0_TEXOFF TMP1_L0_texOff
#define TEX_BIND_L0_TEX TMP1_L0_tex
#define TEX_BIND_L0_POS TMP1_L0_pos
#define TEX_BIND_L0_SIZE TMP1_L0_size
#define TEX_BIND_L0_PT TMP1_L0_pt

#define TEX_BIND_L1_TEXOFF TMP1_L1_texOff
#define TEX_BIND_L1_TEX TMP1_L1_tex
#define TEX_BIND_L1_POS TMP1_L1_pos
#define TEX_BIND_L1_SIZE TMP1_L1_size
#define TEX_BIND_L1_PT TMP1_L1_pt

#define TEX_BIND_L2_TEXOFF FEAT_L1_texOff
#define TEX_BIND_L2_TEX FEAT_L1_tex
#define TEX_BIND_L2_POS FEAT_L1_pos
#define TEX_BIND_L2_SIZE FEAT_L1_size
#define TEX_BIND_L2_PT FEAT_L1_pt

const float kernels[288] = float[288](
  -0.0257421f, -0.1022642f, -0.2741275f, +0.0220830f, -0.0473914f, +0.0272105f, +0.0527780f, -0.0023813f,
  +0.0066292f, -0.3966409f, -0.1806483f, +0.2959829f, +0.0943879f, -0.0849990f, +0.4079617f, +0.2292530f,
  +0.2399782f, -0.0627755f, -0.3154041f, -0.1252126f, -0.2445127f, +0.0638262f, +0.3405687f, +0.0283441f,
  +0.2091348f, -0.1332087f, -0.0996444f, -0.0424124f, -0.0165477f, -0.0131622f, -0.3064940f, +0.0574545f,
  +0.5727778f, -0.3162242f, +0.0528696f, +0.1333943f, +0.1669857f, +0.1519470f, -0.1243679f, +0.3185659f,
  -0.0401724f, +0.1602179f, -0.4329425f, +0.0043460f, -0.4670285f, +0.0894663f, -0.1906167f, -0.1576041f,
  -0.1253584f, +0.0177299f, +0.0116839f, +0.0447789f, -0.0432006f, -0.4308576f, +0.1211628f, -0.1601534f,
  +0.0022878f, -0.1839322f, +0.1589519f, -0.0161528f, -0.0093692f, +0.3217016f, -0.1902097f, +0.0889984f,
  +0.1264787f, +0.3228293f, -0.2118940f, +0.0531466f, -0.0952592f, +0.2443144f, -0.1205211f, -0.2061657f,
  +0.3437889f, +0.1814059f, -0.0577739f, +0.0019967f, +0.0626014f, +0.0688857f, +0.1852156f, +0.1650325f,
  +0.0152857f, -0.0863710f, +0.2089710f, +0.3529727f, -0.3034611f, -0.1401121f, +0.0173100f, +0.1267034f,
  -0.0694874f, -0.1014648f, -0.3745449f, +0.2850651f, +0.0262199f, +0.1502782f, -0.0912512f, +0.0726514f,
  +0.0038053f, -0.0847778f, -0.7091162f, -0.0887149f, -0.3062667f, +0.0139796f, +0.2300469f, +0.0439174f,
  -0.0888103f, -0.4694512f, +0.1891738f, +0.9263017f, -0.4582348f, -0.5238316f, +0.1184480f, +0.4496919f,
  +0.0770868f, -0.1906310f, +0.0920076f, +0.2124421f, -0.5569294f, +0.1447014f, -0.1810784f, -0.0365426f,
  +0.4541055f, +0.0399143f, -0.3409098f, +0.0078598f, -0.1088567f, +0.0972976f, +0.0080708f, +0.1247909f,
  +0.1181526f, +0.1781893f, +0.2096810f, +0.1410482f, -0.3187186f, -0.0097108f, +0.0630706f, +0.1627961f,
  -0.0758615f, +0.0322767f, +0.1297224f, +0.0087896f, -0.5460907f, +0.0809139f, -0.5481184f, -0.3205603f,
  -0.2113223f, -0.1775941f, -0.2162561f, +0.2510403f, -0.0942230f, +0.0984758f, -0.1109629f, +0.0790300f,
  +0.0414812f, +0.1362432f, +0.2998752f, +0.4796904f, -0.0174942f, +0.1793961f, +0.1632442f, +0.1498259f,
  +0.5104159f, -0.0763631f, -0.2228282f, +0.3751597f, -0.2062530f, +0.2851286f, +0.1788603f, -0.1637474f,
  -0.1372178f, +0.0688648f, +0.1611972f, +0.1326046f, -0.1576750f, -0.4262101f, +0.0891652f, -0.0189961f,
  +0.2525816f, +0.4215904f, -0.0336463f, +0.5346531f, -0.1954733f, -0.0429820f, -0.2868393f, +0.2890517f,
  +0.2176351f, +0.0968954f, -0.1359641f, +0.4250987f, -0.5925416f, +0.0065097f, -0.1221445f, +0.3230976f,
  -0.1554491f, -0.2103672f, -0.2676746f, +0.0559223f, -0.2774376f, -0.4286138f, +0.0001445f, -0.3042523f,
  -0.4162146f, +0.0397165f, +0.1474987f, -0.0969521f, -0.4835077f, +0.5612200f, -0.0374936f, -0.1670499f,
  +0.1286988f, +0.1058439f, +0.0901240f, -0.0633277f, -0.5087873f, -0.1727980f, -0.1554493f, -0.0592340f,
  +0.0609721f, +0.3708477f, -0.0394381f, -0.0946193f, -0.2114208f, -0.3255191f, +0.0585247f, +0.3959242f,
  +0.0564504f, -0.3491928f, -0.4285194f, +0.4009213f, -0.3737639f, -0.0825865f, +0.2723616f, +0.0738922f,
  -0.1964860f, +0.2347877f, -0.0419805f, -0.3950243f, -0.1720736f, +0.1995658f, +0.1599915f, -0.0734852f,
  +0.5062033f, +0.1609462f, -0.2412875f, +0.2473896f, -0.0708936f, +0.2259570f, -0.5119935f, +0.0063658f,
  +0.0383043f, +0.1801855f, -0.0965764f, -0.4036304f, +0.1197993f, +0.2532002f, -0.7579045f, -0.8597474f,
  -0.1962682f, +0.1825943f, +0.0866904f, -0.3937953f, -0.0167712f, +0.1634130f, -0.1193869f, +0.0063058f,
  +0.0856691f, +0.1611519f, -0.2980936f, +0.0971974f, -0.0041344f, -0.2528102f, -0.1239122f, +0.1065248f,
  -0.2800414f, +0.3845845f, -0.2711737f, -0.1092452f, +0.3614969f, -0.0162740f, -0.0117540f, +0.0192280f,
  -0.2564261f, +0.0102088f, +0.0927073f, -0.0690150f, +0.4345383f, +0.2556442f, +0.1154394f, -0.1673215f
);

const float biases[4] = float[4](
  +0.3094147f, -0.0388083f, +0.0981869f, -0.1584313f
);

vec4 hook() {
    const vec4 r[9][2] = vec4[9][2](
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 1.0f)))
    );

    float sum[4] = biases;
    for (int n = 0; n < 4; n++) {
        for (int i = 0; i < 9; i++) {
            const vec4 k0 = vec4(kernels[n * 8 * 9 + 8 * i + 0], kernels[n * 8 * 9 + 8 * i + 1], kernels[n * 8 * 9 + 8 * i + 2], kernels[n * 8 * 9 + 8 * i + 3]);
            const vec4 k1 = vec4(kernels[n * 8 * 9 + 8 * i + 4], kernels[n * 8 * 9 + 8 * i + 5], kernels[n * 8 * 9 + 8 * i + 6], kernels[n * 8 * 9 + 8 * i + 7]);
            sum[n] += (dot(k0, r[i][0]) + dot(k1, r[i][1]));
        }
    }

    return ACTIVE(vec4(sum[0], sum[1], sum[2], sum[3]) * 0.2000000f + TEX_BIND_L2_TEXOFF(vec2(0.0f, 0.0f)));
}

//!HOOK LUMA
//!DESC ARNet b4 Layer3 L0
//!WHEN OUTPUT.w LUMA.w / 1.2 > OUTPUT.h LUMA.h / 1.2 > *
//!BIND TMP2_L0
//!BIND TMP2_L1
//!SAVE TMP1_L0
//!COMPONENTS 4

#define ACTIVE(v) (max(v, v * 0.2000000f))

#define TEX_BIND_L0_TEXOFF TMP2_L0_texOff
#define TEX_BIND_L0_TEX TMP2_L0_tex
#define TEX_BIND_L0_POS TMP2_L0_pos
#define TEX_BIND_L0_SIZE TMP2_L0_size
#define TEX_BIND_L0_PT TMP2_L0_pt

#define TEX_BIND_L1_TEXOFF TMP2_L1_texOff
#define TEX_BIND_L1_TEX TMP2_L1_tex
#define TEX_BIND_L1_POS TMP2_L1_pos
#define TEX_BIND_L1_SIZE TMP2_L1_size
#define TEX_BIND_L1_PT TMP2_L1_pt

const float kernels[288] = float[288](
  -0.5465179f, -0.1813857f, +0.0281055f, -0.1015351f, +0.2314144f, -0.0603657f, -0.1826515f, +0.3922512f,
  +0.1212667f, +0.0669492f, +0.2383224f, -0.1071251f, +0.1463049f, -0.3703077f, +0.0324115f, -0.0707424f,
  +0.0277058f, -0.0140382f, +0.1080220f, +0.0478713f, +0.0399844f, -0.0655916f, -0.3707117f, -0.1144216f,
  +0.2585468f, -0.1766256f, +0.1882442f, +0.1991132f, +0.0724225f, -0.0351931f, -1.4136622f, +0.0676993f,
  +0.3159859f, +0.1299425f, -0.2273960f, +0.2726021f, -0.0706385f, +0.5241545f, -0.2612918f, +0.0600361f,
  +0.6723818f, -0.0948621f, +0.4589195f, +0.1696998f, -0.1512998f, +0.0410133f, +0.1014724f, -0.3213015f,
  +0.0214976f, -0.2113370f, -0.5926974f, -0.0176610f, -0.0045633f, +0.0924836f, -0.5078585f, +0.1421309f,
  -0.1026877f, -0.2827728f, -0.2501234f, -0.1490140f, -0.2643248f, +0.4067191f, +0.2333364f, -0.2942967f,
  +0.1679200f, -0.0731632f, -0.3748723f, +0.1220440f, -0.1800863f, +0.2336716f, +0.1148757f, -0.5760921f,
  +0.2303603f, -0.0633582f, +0.2822642f, -0.0422270f, +0.0181197f, -0.5937437f, -0.6937523f, +0.2243812f,
  +0.1581208f, -0.1593495f, +0.1844178f, -0.2469670f, +0.3364915f, -0.0597347f, +0.7185153f, -0.2204939f,
  +0.1611713f, -0.8271319f, +0.1644388f, -0.1572122f, +0.0655136f, +0.2137835f, +0.1046440f, -0.0001156f,
  +0.3957306f, +0.2724440f, -0.4222948f, -0.2360625f, -0.0276172f, -0.1733741f, -0.0027563f, +0.3355623f,
  +0.0408750f, +0.1684493f, +0.2038174f, +0.4200456f, -0.2935379f, +1.3669258f, +0.9607046f, -0.4928770f,
  +0.4836916f, -0.6259786f, +0.0846875f, +0.0979265f, -0.1045969f, -0.4725299f, +0.2166559f, -0.6356002f,
  +0.0992146f, -0.1587072f, +0.0788924f, -0.2974881f, +0.0411237f, -0.4029994f, -0.3646770f, +0.2320738f,
  +0.2352059f, -0.1073590f, +0.3977514f, -0.0069531f, -0.0848083f, -0.7548366f, -0.2400679f, -0.5570742f,
  +0.2443644f, -0.0309516f, -0.0886616f, -0.1274170f, +0.0072639f, -0.3740209f, -0.1502259f, +0.3037601f,
  -0.2125648f, +0.0787429f, -0.1526160f, +0.6267788f, +0.0287592f, +0.4276071f, -0.2391112f, -0.1761353f,
  -0.3343036f, -0.1401918f, -0.2826272f, -0.1222266f, -0.0247457f, +0.1321193f, -0.2742341f, -0.0577745f,
  +0.4273535f, +0.2010940f, +0.0996195f, +0.1455177f, -0.1986437f, -0.0446874f, +0.0770959f, -0.0345664f,
  -0.3718699f, +0.5392159f, -0.7706878f, +0.2141129f, -0.3622339f, +0.5658224f, +0.7810339f, -0.4975369f,
  -0.0971853f, +0.3038430f, -0.0188203f, -0.2981507f, -0.4165689f, +0.1881146f, +0.3738251f, -0.3941489f,
  -0.7477224f, -0.1566551f, +0.0255155f, +0.2484896f, -0.4649997f, +0.5152513f, +0.1388366f, +0.6405523f,
  -0.6433310f, +0.8146302f, +0.0236593f, +0.6511397f, +0.1526779f, +0.5956683f, +0.4193338f, -0.1399888f,
  +0.7731423f, +0.5642735f, -0.5915551f, +0.8406786f, +0.3294314f, +0.3130462f, -0.0333910f, -0.3726929f,
  +0.4198208f, +0.6803690f, -0.1452416f, +0.2847975f, +0.2945552f, +0.3766811f, +0.2842162f, +0.2793076f,
  -0.1123533f, -0.1048575f, +0.1348286f, +0.0663105f, -0.2174513f, -0.0945380f, +0.0415598f, +0.1072134f,
  -0.0478212f, -0.3016980f, -0.0878804f, -0.2458618f, +0.0618404f, +0.3859894f, +0.3296686f, +0.0563153f,
  +0.0433622f, +0.3488021f, +0.2577114f, -0.1276559f, +0.1185098f, -0.3183598f, -0.1746300f, +0.0276215f,
  +0.2447328f, +0.1511339f, -0.1776756f, +0.1777629f, -0.1318398f, -0.0396131f, -0.1352850f, +0.0867831f,
  +0.1788375f, +0.1684418f, +1.0801756f, +0.7256848f, +0.1533663f, +0.3569896f, -1.3710504f, -0.1158583f,
  +0.3209153f, +0.2536265f, +0.3442559f, -0.0337786f, +0.1423638f, -0.6149613f, -0.7343414f, -0.1799960f,
  +0.1585188f, -0.0721233f, -0.2557464f, -0.0424845f, -0.1163257f, -0.1911146f, -0.2836154f, +0.0621592f,
  -0.6748768f, -0.0641925f, +0.1898398f, +0.4030181f, +0.2760964f, -0.0757376f, +0.4767059f, -0.7901381f,
  +0.2241669f, -0.3233822f, +0.2694513f, +0.2167335f, -0.0135534f, -0.3804689f, +0.1562316f, -0.0261234f
);

const float biases[4] = float[4](
  -0.0603635f, -0.2071972f, +0.0670620f, +0.0780800f
);

vec4 hook() {
    const vec4 r[9][2] = vec4[9][2](
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 1.0f)))
    );

    float sum[4] = biases;
    for (int n = 0; n < 4; n++) {
        for (int i = 0; i < 9; i++) {
            const vec4 k0 = vec4(kernels[n * 8 * 9 + 8 * i + 0], kernels[n * 8 * 9 + 8 * i + 1], kernels[n * 8 * 9 + 8 * i + 2], kernels[n * 8 * 9 + 8 * i + 3]);
            const vec4 k1 = vec4(kernels[n * 8 * 9 + 8 * i + 4], kernels[n * 8 * 9 + 8 * i + 5], kernels[n * 8 * 9 + 8 * i + 6], kernels[n * 8 * 9 + 8 * i + 7]);
            sum[n] += (dot(k0, r[i][0]) + dot(k1, r[i][1]));
        }
    }

    return ACTIVE(vec4(sum[0], sum[1], sum[2], sum[3]));
}

//!HOOK LUMA
//!DESC ARNet b4 Layer3 L1
//!WHEN OUTPUT.w LUMA.w / 1.2 > OUTPUT.h LUMA.h / 1.2 > *
//!BIND TMP2_L0
//!BIND TMP2_L1
//!SAVE TMP1_L1
//!COMPONENTS 4

#define ACTIVE(v) (max(v, v * 0.2000000f))

#define TEX_BIND_L0_TEXOFF TMP2_L0_texOff
#define TEX_BIND_L0_TEX TMP2_L0_tex
#define TEX_BIND_L0_POS TMP2_L0_pos
#define TEX_BIND_L0_SIZE TMP2_L0_size
#define TEX_BIND_L0_PT TMP2_L0_pt

#define TEX_BIND_L1_TEXOFF TMP2_L1_texOff
#define TEX_BIND_L1_TEX TMP2_L1_tex
#define TEX_BIND_L1_POS TMP2_L1_pos
#define TEX_BIND_L1_SIZE TMP2_L1_size
#define TEX_BIND_L1_PT TMP2_L1_pt

const float kernels[288] = float[288](
  +0.4135942f, -0.2021150f, +0.2085077f, -0.0973362f, -0.3600062f, -0.7616619f, -0.4994515f, +0.0303565f,
  -0.1095065f, +0.2642873f, +0.5344011f, +0.0999580f, -0.0165864f, -0.1065446f, +0.1772538f, -0.3752021f,
  -0.1959993f, +0.1268242f, +0.1545223f, -0.5067917f, +0.1001888f, -0.2234353f, +0.1204506f, +0.0710099f,
  +0.6665772f, -0.3383781f, -0.4275345f, -0.1070679f, +0.3689312f, -0.0698044f, -0.1186457f, +0.0863802f,
  +0.3774617f, +0.5122560f, +0.0606118f, -0.7184590f, -0.1661883f, +0.3696848f, -1.0915613f, +0.0010399f,
  -0.5358741f, +0.3924011f, +0.5066100f, -0.0926100f, +0.1990317f, +0.7528459f, +0.1672970f, +0.6038141f,
  +0.1317796f, -0.0657929f, +0.0411449f, +0.4601157f, -0.2196409f, +0.6079667f, +0.4887270f, -0.7558723f,
  +0.3030950f, +0.6875118f, -0.0985386f, +0.4943824f, -0.0373935f, +0.5860806f, +0.1046348f, +0.1871587f,
  -0.2390443f, +0.1762901f, +0.1330624f, -0.0483452f, -0.1831900f, +0.2198958f, +0.2484819f, -0.3058448f,
  -0.2264000f, -0.2285554f, +0.2812423f, +0.2445805f, +0.1360514f, -0.2374458f, -0.0811400f, +0.2328234f,
  +0.0622780f, -0.2421349f, -0.2213111f, -0.1846668f, +0.3521289f, -0.2187772f, -0.4898627f, -0.1932030f,
  -0.2266754f, -0.2799811f, +0.2666102f, +0.0017716f, -0.0979165f, +0.2910349f, -0.0541657f, -0.2860400f,
  +0.2338265f, +0.1484920f, +0.4094230f, +0.1337202f, -0.0007872f, -0.4568244f, -0.3599530f, +0.0668551f,
  -0.1548418f, +0.1087240f, +0.8467673f, -0.4182993f, -0.0040998f, -0.8083155f, -0.5163234f, +0.6149464f,
  +0.3930397f, +0.2713300f, -0.1548315f, -0.1991750f, +0.2873047f, -0.5718625f, +0.0862922f, -0.0030383f,
  -0.0303506f, -0.3528132f, +0.2725279f, +0.2794412f, +0.0094655f, -0.6024890f, -0.4049941f, -0.0617254f,
  -0.2632679f, +0.1081760f, +0.8264669f, +0.3035868f, -0.0710958f, -1.0618705f, +0.3791478f, -0.1316795f,
  +0.4748141f, +0.2142190f, +0.1869461f, +0.1341019f, +0.2372689f, -0.4121282f, +0.0397058f, -0.0263710f,
  +0.2503703f, +0.3182038f, -0.8691620f, -0.0902071f, -0.2788353f, -0.3055692f, -0.3724405f, +0.2236024f,
  +0.4697969f, -0.4030376f, -0.6787370f, +0.3383868f, -0.0350185f, -0.5223095f, +0.1056331f, +0.1012391f,
  +0.5143408f, -0.2777464f, -0.3328118f, +0.3575572f, +0.0801312f, -0.0044298f, +0.1609334f, -0.6444643f,
  +0.3439842f, +0.0023587f, -0.0716806f, +0.0370211f, -0.4989283f, +0.5550296f, -0.5562694f, +0.1316065f,
  -0.1897044f, +0.0517083f, -0.8351169f, +0.0994769f, -0.3935070f, -0.3737480f, -0.2338872f, -0.6378975f,
  +0.2058868f, +0.1984805f, -0.2080717f, -0.3495026f, -0.0811620f, -0.2044045f, -0.1666510f, -0.2075222f,
  -0.0023746f, +0.0810697f, -0.0474445f, +0.2874057f, -0.0295968f, -0.0997519f, +0.2966452f, +0.2155589f,
  +0.0643393f, -0.0948650f, +0.1830142f, -0.0648932f, -0.1113257f, +0.0199629f, +0.3893198f, +0.2306250f,
  -0.2148331f, -0.2707456f, +0.0123122f, +0.0063616f, -0.2385297f, +0.1870937f, +0.0425376f, +0.3870502f,
  +0.2019920f, +0.2629901f, +0.3103939f, -0.4354482f, +0.0485244f, +0.1550943f, +0.2700910f, -0.1366091f,
  -0.0342458f, -0.0684871f, -0.1652102f, +0.1218041f, -0.1846783f, +0.4214691f, +0.7984315f, +0.0529956f,
  +0.4520591f, +0.0242226f, +0.3941443f, +0.2566632f, +0.0143077f, +0.1733369f, +0.1039648f, -0.4780682f,
  +0.0079391f, -0.4131985f, -0.0045712f, -0.1470006f, -0.0402137f, -0.3338586f, +0.1223069f, +0.0859709f,
  +0.0586380f, +0.2067462f, +0.2723808f, +0.1465244f, -0.5810601f, -0.2766825f, +0.6700700f, +0.1833604f,
  +0.3965919f, -0.0001532f, +0.0467125f, +0.4497973f, -0.1474645f, -0.2028010f, -0.0640267f, -0.8621933f,
  -0.0504281f, +0.1545807f, -0.2274825f, -0.2188444f, -0.0347014f, -0.3014339f, -0.4651141f, +0.3320534f,
  +0.1210919f, +0.0948951f, +0.1771277f, +0.1400141f, +0.0137515f, -0.3349382f, +0.0031671f, -0.2354916f,
  +0.0495864f, +0.0735729f, +0.1160688f, -0.0450510f, -0.0456771f, -0.0437896f, +0.0496048f, -0.3178159f
);

const float biases[4] = float[4](
  -0.0898952f, +0.0915498f, -0.0300560f, +0.0463310f
);

vec4 hook() {
    const vec4 r[9][2] = vec4[9][2](
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 1.0f)))
    );

    float sum[4] = biases;
    for (int n = 0; n < 4; n++) {
        for (int i = 0; i < 9; i++) {
            const vec4 k0 = vec4(kernels[n * 8 * 9 + 8 * i + 0], kernels[n * 8 * 9 + 8 * i + 1], kernels[n * 8 * 9 + 8 * i + 2], kernels[n * 8 * 9 + 8 * i + 3]);
            const vec4 k1 = vec4(kernels[n * 8 * 9 + 8 * i + 4], kernels[n * 8 * 9 + 8 * i + 5], kernels[n * 8 * 9 + 8 * i + 6], kernels[n * 8 * 9 + 8 * i + 7]);
            sum[n] += (dot(k0, r[i][0]) + dot(k1, r[i][1]));
        }
    }

    return ACTIVE(vec4(sum[0], sum[1], sum[2], sum[3]));
}

//!HOOK LUMA
//!DESC ARNet b4 Layer4 L0
//!WHEN OUTPUT.w LUMA.w / 1.2 > OUTPUT.h LUMA.h / 1.2 > *
//!BIND TMP1_L0
//!BIND TMP1_L1
//!BIND TMP2_L0
//!SAVE TMP2_L0
//!COMPONENTS 4

#define ACTIVE(v) (v)

#define TEX_BIND_L0_TEXOFF TMP1_L0_texOff
#define TEX_BIND_L0_TEX TMP1_L0_tex
#define TEX_BIND_L0_POS TMP1_L0_pos
#define TEX_BIND_L0_SIZE TMP1_L0_size
#define TEX_BIND_L0_PT TMP1_L0_pt

#define TEX_BIND_L1_TEXOFF TMP1_L1_texOff
#define TEX_BIND_L1_TEX TMP1_L1_tex
#define TEX_BIND_L1_POS TMP1_L1_pos
#define TEX_BIND_L1_SIZE TMP1_L1_size
#define TEX_BIND_L1_PT TMP1_L1_pt

#define TEX_BIND_L2_TEXOFF TMP2_L0_texOff
#define TEX_BIND_L2_TEX TMP2_L0_tex
#define TEX_BIND_L2_POS TMP2_L0_pos
#define TEX_BIND_L2_SIZE TMP2_L0_size
#define TEX_BIND_L2_PT TMP2_L0_pt

const float kernels[288] = float[288](
  -0.1135821f, +0.1131442f, +0.0254405f, -0.0568181f, +0.0314831f, -0.0590690f, +0.1766097f, +0.0698896f,
  +0.0723396f, +0.0278612f, -0.3542451f, -0.1689208f, -0.0119440f, +0.4477529f, +0.1000650f, -0.0273258f,
  -0.0133095f, -0.0825119f, +0.1607734f, -0.0196166f, +0.1959919f, -0.0145570f, -0.1614159f, -0.1097292f,
  +0.2613694f, -0.2802069f, +0.5208721f, -0.3671371f, -0.2326583f, -0.0975584f, +0.0132211f, +0.2161829f,
  +0.3856817f, -0.1871824f, -0.1551860f, -0.3204114f, +0.0410364f, +0.2749566f, +0.3836856f, +0.2457938f,
  -0.1353389f, +0.0877277f, +0.0626137f, -0.1298043f, -0.0339624f, +0.3630431f, -0.2519740f, -0.1811161f,
  +0.2119179f, -0.0764091f, +0.0105925f, -0.2586286f, +0.0469991f, +0.4876443f, -0.2009791f, +0.0290694f,
  -0.2464088f, -0.2801856f, -0.4448844f, -0.2283779f, +0.2063317f, +0.1037019f, -0.0352248f, +0.0449713f,
  -0.2782537f, +0.1574795f, +0.1916216f, -0.1555159f, +0.3547170f, +0.0719395f, -0.0932534f, -0.1959275f,
  -0.2282311f, -0.0762896f, -0.0534983f, +0.2521687f, -0.0066780f, -0.2295144f, -0.2305955f, -0.0006254f,
  -0.0178277f, -0.2731454f, +0.3518187f, +0.2709215f, +0.3160127f, -0.2865226f, -0.2913933f, -0.0682520f,
  +0.0566734f, +0.1200802f, -0.1203251f, -0.0844512f, -0.1193911f, -0.0505100f, +0.1834601f, +0.0415296f,
  -0.4337746f, +0.2847998f, +0.0482620f, +0.3079253f, +0.2338343f, +0.0874735f, +0.0404907f, +0.0656623f,
  -0.3408950f, +0.6500421f, -0.8404325f, +0.5578181f, -0.3053409f, +0.2686905f, -0.1801445f, -0.1684942f,
  -0.0154724f, -0.1267527f, -0.0154006f, +0.0713541f, -0.1642166f, -0.4952320f, -0.0358204f, +0.2386758f,
  -0.0977464f, +0.5836657f, +0.1559367f, +0.1252456f, -0.0642833f, -0.1357282f, +0.1848288f, -0.1143514f,
  +0.1106819f, +0.4662170f, -0.1471468f, +0.3627382f, +0.0529953f, -0.1546895f, +0.1457585f, -0.2099885f,
  +0.1507595f, -0.0594509f, +0.2185638f, +0.1016160f, -0.3193384f, -0.1432317f, +0.2444851f, +0.0511073f,
  -0.1656280f, -0.1689900f, -0.4383247f, -0.0105260f, +0.1868772f, +0.6159220f, +0.0622786f, +0.2708088f,
  +0.1233016f, -0.2075056f, -0.2455397f, -0.0429035f, -0.1429740f, -0.2371154f, +0.2757193f, -0.0414741f,
  -0.1097971f, +0.1829867f, -0.3379936f, -0.2082732f, -0.1031464f, +0.2827926f, +0.0745067f, -0.1082652f,
  -0.5370601f, +0.3793329f, -0.1550799f, +0.6363593f, -0.2628014f, -0.6215590f, +0.2513036f, -0.4942603f,
  -0.0759348f, +0.2589723f, +0.7989745f, -0.0535296f, -1.2333758f, -0.2342038f, +0.4280522f, +0.3399447f,
  -0.4526418f, -0.2124117f, +0.1743215f, -0.0287481f, -0.0599864f, -0.0184710f, +0.1646205f, +0.0987128f,
  -0.0683604f, +0.2923433f, -0.4511548f, -0.0701542f, +0.1751561f, +0.4972144f, +0.2436980f, -0.5422062f,
  +0.0163371f, -0.1055682f, +0.0004877f, +0.2107906f, +0.0078184f, -0.2798215f, +0.2792922f, +0.0780558f,
  -0.2893404f, +0.2959889f, +0.3471496f, -0.0869717f, -0.0116502f, +0.0593414f, +0.1996432f, -0.1710475f,
  +0.2074866f, +0.0727146f, +0.0707245f, -0.0450414f, -0.3036300f, +0.1699359f, +0.6984754f, -0.0485256f,
  -0.2284543f, +0.0126605f, -0.1663617f, +0.1766112f, -0.1328527f, +0.2811104f, +0.3079995f, -0.0382005f,
  +0.2015251f, -0.0065634f, -0.5458516f, +0.2402356f, -0.0268173f, -0.0186450f, +0.3653609f, +0.1581097f,
  +0.6791171f, -0.8209716f, -0.2216300f, -1.1684825f, -0.0570536f, +0.3359939f, -0.1391045f, +0.0674853f,
  +0.3960096f, -0.4949412f, +1.4765211f, -0.5805197f, +0.5960409f, +0.0363043f, -0.4633380f, +0.1157598f,
  -0.2139284f, -0.1774906f, -0.1226473f, -0.1521538f, +0.1756390f, +0.4547832f, +0.1465023f, +0.1661686f,
  +0.0282807f, -0.3776886f, +0.1230173f, -0.3015568f, -0.0954359f, +0.2276686f, -0.1635429f, +0.2195333f,
  -0.1089126f, -0.0582147f, +0.0217479f, -0.5294802f, -0.1585674f, +0.4840247f, -0.4531354f, -0.0941082f,
  -0.2897669f, +0.3276269f, -0.4361756f, -0.1973242f, +0.3672780f, +0.2536890f, -0.1843465f, +0.0170918f
);

const float biases[4] = float[4](
  +0.9000131f, -0.1750593f, -0.3010239f, -0.2155392f
);

vec4 hook() {
    const vec4 r[9][2] = vec4[9][2](
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 1.0f)))
    );

    float sum[4] = biases;
    for (int n = 0; n < 4; n++) {
        for (int i = 0; i < 9; i++) {
            const vec4 k0 = vec4(kernels[n * 8 * 9 + 8 * i + 0], kernels[n * 8 * 9 + 8 * i + 1], kernels[n * 8 * 9 + 8 * i + 2], kernels[n * 8 * 9 + 8 * i + 3]);
            const vec4 k1 = vec4(kernels[n * 8 * 9 + 8 * i + 4], kernels[n * 8 * 9 + 8 * i + 5], kernels[n * 8 * 9 + 8 * i + 6], kernels[n * 8 * 9 + 8 * i + 7]);
            sum[n] += (dot(k0, r[i][0]) + dot(k1, r[i][1]));
        }
    }

    return ACTIVE(vec4(sum[0], sum[1], sum[2], sum[3]) * 0.2000000f + TEX_BIND_L2_TEXOFF(vec2(0.0f, 0.0f)));
}

//!HOOK LUMA
//!DESC ARNet b4 Layer4 L1
//!WHEN OUTPUT.w LUMA.w / 1.2 > OUTPUT.h LUMA.h / 1.2 > *
//!BIND TMP1_L0
//!BIND TMP1_L1
//!BIND TMP2_L1
//!SAVE TMP2_L1
//!COMPONENTS 4

#define ACTIVE(v) (v)

#define TEX_BIND_L0_TEXOFF TMP1_L0_texOff
#define TEX_BIND_L0_TEX TMP1_L0_tex
#define TEX_BIND_L0_POS TMP1_L0_pos
#define TEX_BIND_L0_SIZE TMP1_L0_size
#define TEX_BIND_L0_PT TMP1_L0_pt

#define TEX_BIND_L1_TEXOFF TMP1_L1_texOff
#define TEX_BIND_L1_TEX TMP1_L1_tex
#define TEX_BIND_L1_POS TMP1_L1_pos
#define TEX_BIND_L1_SIZE TMP1_L1_size
#define TEX_BIND_L1_PT TMP1_L1_pt

#define TEX_BIND_L2_TEXOFF TMP2_L1_texOff
#define TEX_BIND_L2_TEX TMP2_L1_tex
#define TEX_BIND_L2_POS TMP2_L1_pos
#define TEX_BIND_L2_SIZE TMP2_L1_size
#define TEX_BIND_L2_PT TMP2_L1_pt

const float kernels[288] = float[288](
  -0.1343304f, +0.1744392f, -0.3050350f, +0.1955674f, -0.0239678f, -0.0527314f, -0.0223962f, -0.0638566f,
  -0.0417669f, -0.0982933f, +0.3086486f, +0.0626614f, -0.0064700f, -0.1410341f, +0.1752120f, -0.0557573f,
  -0.2372030f, +0.0901512f, -0.3380937f, +0.0881489f, -0.1486718f, -0.0335855f, -0.0899709f, +0.0980417f,
  +0.3744084f, -0.3403694f, -0.1997979f, -0.1325865f, -0.0689171f, +0.0421649f, +0.2592726f, -0.0276463f,
  +0.1720569f, -0.2395940f, +0.4248392f, -0.4156044f, +0.2826144f, +0.0223988f, +0.4555753f, +0.0639912f,
  +0.0526266f, -0.1847794f, -0.0100068f, +0.1356434f, +0.1249909f, -0.0438021f, -0.0400117f, -0.0078632f,
  -0.1038879f, -0.5162283f, +0.1018077f, +0.0242196f, -0.1299640f, -0.0025326f, -0.1155929f, +0.0771109f,
  -0.1888998f, -0.7334034f, -0.0942040f, -0.2014087f, +0.0157217f, +0.0681192f, -0.1885165f, +0.0460965f,
  +0.0174632f, +0.0415065f, -0.0801427f, +0.0761439f, +0.3072794f, -0.0011568f, -0.0627784f, -0.1748141f,
  +0.0963787f, +0.0865925f, +0.2235652f, -0.6220300f, -0.0561455f, +0.2038807f, +0.1032071f, +0.2561897f,
  +0.0800125f, -0.0469272f, -0.5546099f, -0.8968136f, -0.4322811f, +0.7412071f, -0.0781051f, +0.2428189f,
  +0.2681492f, -0.1243450f, -0.1620685f, -0.1887471f, +0.1701927f, +0.4131365f, -0.0762782f, -0.1580256f,
  +0.4724972f, -0.2090101f, -0.4531825f, -0.4428110f, +0.1774950f, +0.1389758f, +0.0729172f, +0.3927156f,
  +0.5769197f, -0.3496298f, +0.1902953f, -1.1085387f, -0.0514611f, +0.1152290f, -0.3602109f, +0.3913459f,
  -0.3605660f, -0.2181100f, -0.1414988f, -0.4666795f, +0.5227710f, +0.6853273f, -0.0545906f, +0.1331580f,
  -0.2506420f, -0.2947343f, +0.1887982f, +0.3263460f, -0.2178612f, -0.3561734f, +0.3139907f, +0.5952418f,
  +0.1470574f, -0.9420723f, +0.0429103f, -0.3011732f, -0.2029492f, +0.1222307f, +0.1661570f, +0.4895145f,
  -0.3869881f, +0.1219423f, -0.0824655f, -0.3906408f, -0.0139934f, +0.1385418f, -0.2393766f, +0.1288462f,
  -0.3308930f, +0.0907944f, -0.4610704f, +0.5569098f, -0.0220636f, -0.0633588f, -0.0977781f, -0.1097607f,
  +0.0626489f, +0.0884074f, +0.2209575f, +0.7436657f, +0.0263401f, -0.3257303f, +0.1278277f, -0.1388046f,
  -0.0747048f, +0.1585139f, +0.0487646f, -0.0871711f, -0.7604270f, -0.2689761f, -0.2104491f, +0.0267016f,
  +0.1785854f, -0.3008264f, -0.1177686f, +0.8706296f, -0.1325786f, -0.5418907f, +0.2079889f, -0.7134524f,
  -0.1212228f, +0.3685813f, +0.2174602f, +0.7131059f, +1.0029811f, +0.0558439f, +0.6818484f, +0.0749408f,
  +0.2609220f, +0.1503947f, -0.3547745f, +0.1583409f, -0.2375128f, -0.3497744f, +0.3631776f, -0.1770597f,
  -0.0387352f, -0.6597455f, -0.0606820f, +0.1619049f, -0.0134941f, +0.2177904f, -0.4226465f, -0.3273221f,
  -0.7833768f, -0.5791669f, -0.0288225f, +0.3772877f, +0.1608971f, -0.0541389f, -0.0500496f, -0.1754274f,
  +0.3233081f, -0.1686909f, +0.0075117f, +0.2956193f, -0.0140512f, -0.3550899f, +0.2396984f, -0.1616977f,
  +0.5366417f, +0.4230461f, -0.2637057f, -0.9227025f, +0.3117589f, +0.1718101f, +0.3172682f, +0.3373864f,
  -0.2358125f, +0.0114593f, -0.7748394f, -0.8393325f, -0.0997184f, +0.2061606f, +0.0700439f, +0.1239162f,
  -0.1730428f, +0.0180876f, +0.0064803f, +0.0872370f, +0.4475999f, -0.0401382f, -0.4076487f, -0.1404629f,
  -0.2002517f, -0.1287540f, -0.0652117f, +0.8412129f, -0.5576209f, -0.2722710f, +0.5771185f, -0.1344075f,
  -0.0232125f, -0.2038086f, +0.4733877f, -0.2441384f, +0.2959083f, +0.1525006f, +0.4558921f, -0.4423554f,
  +0.2069918f, +0.0282575f, +0.0046255f, +0.3450770f, +0.4792251f, -0.3140255f, -0.3130781f, -0.3218343f,
  +0.7009349f, -0.0442998f, -0.4122798f, -0.3957923f, +0.2197291f, +0.0386910f, -0.2622747f, -0.1222222f,
  +0.0261462f, +0.6433925f, +0.1296436f, -0.0416287f, -0.0746134f, -0.0054406f, +0.1157759f, +0.0050478f,
  +0.3608526f, -0.1188607f, -0.0107512f, +0.1044746f, -0.1274808f, +0.2001783f, -0.1813713f, -0.0449550f
);

const float biases[4] = float[4](
  +0.2349715f, +0.0236294f, +0.1397675f, -0.3231965f
);

vec4 hook() {
    const vec4 r[9][2] = vec4[9][2](
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 1.0f)))
    );

    float sum[4] = biases;
    for (int n = 0; n < 4; n++) {
        for (int i = 0; i < 9; i++) {
            const vec4 k0 = vec4(kernels[n * 8 * 9 + 8 * i + 0], kernels[n * 8 * 9 + 8 * i + 1], kernels[n * 8 * 9 + 8 * i + 2], kernels[n * 8 * 9 + 8 * i + 3]);
            const vec4 k1 = vec4(kernels[n * 8 * 9 + 8 * i + 4], kernels[n * 8 * 9 + 8 * i + 5], kernels[n * 8 * 9 + 8 * i + 6], kernels[n * 8 * 9 + 8 * i + 7]);
            sum[n] += (dot(k0, r[i][0]) + dot(k1, r[i][1]));
        }
    }

    return ACTIVE(vec4(sum[0], sum[1], sum[2], sum[3]) * 0.2000000f + TEX_BIND_L2_TEXOFF(vec2(0.0f, 0.0f)));
}

//!HOOK LUMA
//!DESC ARNet b4 Layer5 L0
//!WHEN OUTPUT.w LUMA.w / 1.2 > OUTPUT.h LUMA.h / 1.2 > *
//!BIND TMP2_L0
//!BIND TMP2_L1
//!SAVE TMP1_L0
//!COMPONENTS 4

#define ACTIVE(v) (max(v, v * 0.2000000f))

#define TEX_BIND_L0_TEXOFF TMP2_L0_texOff
#define TEX_BIND_L0_TEX TMP2_L0_tex
#define TEX_BIND_L0_POS TMP2_L0_pos
#define TEX_BIND_L0_SIZE TMP2_L0_size
#define TEX_BIND_L0_PT TMP2_L0_pt

#define TEX_BIND_L1_TEXOFF TMP2_L1_texOff
#define TEX_BIND_L1_TEX TMP2_L1_tex
#define TEX_BIND_L1_POS TMP2_L1_pos
#define TEX_BIND_L1_SIZE TMP2_L1_size
#define TEX_BIND_L1_PT TMP2_L1_pt

const float kernels[288] = float[288](
  -0.0630727f, -0.0971728f, +0.0881543f, -0.0335869f, -0.0487959f, +0.0050576f, -0.0877440f, -0.0596165f,
  +0.1602083f, +0.0766701f, +0.0356743f, +0.1321969f, -0.3120058f, +0.5564367f, -0.5068764f, +0.1992756f,
  +0.2228468f, -0.4400663f, +0.8083507f, +0.3189738f, -0.0616951f, +0.6236573f, -0.1434235f, +0.1290317f,
  +0.2656459f, +0.0867239f, +0.0565006f, -0.1066616f, -0.0102017f, -0.1780164f, +0.0564777f, +0.0077127f,
  +0.0282018f, +0.1587095f, -0.4248177f, -0.2942696f, -0.0090416f, -0.0285785f, -0.5494030f, +0.0664531f,
  -0.0081076f, -0.2836226f, +0.0620272f, +0.5694508f, +0.1434181f, +0.7042082f, -0.9519292f, -0.4652711f,
  -0.0436023f, +0.3086666f, -0.0849181f, +0.1822837f, +0.0326650f, -0.3366853f, +0.1786942f, -0.1106374f,
  +0.1947470f, +0.1585912f, +0.1516441f, -0.0189879f, -0.0826297f, +0.0221128f, +0.2710517f, +0.0961757f,
  -0.0922334f, -0.1598375f, -0.2444836f, +0.1389939f, +0.1080719f, +0.2180389f, -0.4084038f, +0.2066656f,
  -0.4159155f, +0.1338820f, -0.0133799f, +0.2071318f, +0.0078139f, +0.6048394f, -0.0959837f, +0.3244576f,
  -0.3069525f, -1.0582066f, +0.1334715f, +0.2656821f, +0.0762722f, +0.3890614f, -0.5574495f, +0.0062372f,
  +0.1981694f, -0.3079644f, +0.0851591f, -0.1216045f, -0.1040349f, +0.1573883f, +0.1167186f, -0.0489467f,
  +0.0167896f, -0.1340399f, -0.1173132f, -0.2501337f, +0.0086983f, +0.5521634f, -0.4815256f, -0.1505335f,
  -0.4167878f, -0.7025921f, +0.0345046f, -0.3115139f, +0.3535248f, -0.1678837f, -0.3266366f, -0.1872052f,
  +0.1754736f, +0.2118514f, -0.4623473f, +0.0598714f, +0.0187953f, -0.6801319f, -0.3990626f, +0.2968825f,
  -0.1293625f, +0.1509504f, +0.0172772f, +0.1439019f, +0.0432579f, -0.0894967f, +0.1377197f, -0.1651432f,
  -0.1136521f, +0.1978051f, -0.0903130f, +0.3405425f, +0.1606272f, -0.5456904f, +0.2418668f, -0.2893225f,
  -0.0097659f, -0.1130725f, +0.2150595f, +0.1762209f, +0.1570162f, -0.1744865f, +0.3484454f, +0.0808154f,
  +0.2310093f, -0.2210149f, +0.0303207f, +0.1629068f, -0.0886697f, +0.0387972f, -0.0244822f, +0.1381999f,
  +0.2476202f, -0.4401359f, +0.1608143f, +0.4205820f, -0.3068957f, -0.0872296f, +0.2504015f, -0.0480448f,
  -0.4501048f, +0.0021764f, -0.4195591f, +0.1447309f, -0.2542914f, -0.1246076f, -0.0581104f, -0.2491314f,
  -0.0257868f, -0.1587332f, -0.3458808f, -0.1581479f, -0.0781718f, -0.0085014f, +0.1534303f, +0.4714522f,
  +0.5531579f, -0.1650791f, +0.1961445f, +0.5527069f, -0.1767730f, -0.0773491f, +0.7439115f, +0.0317914f,
  -0.0881880f, -0.2668331f, -0.3053729f, +0.0724323f, +0.0535089f, -0.0414955f, +0.3870324f, +0.0589764f,
  +0.0334049f, +0.2944833f, -0.2855130f, -0.1910458f, +0.2283019f, -0.0770773f, -0.5314130f, +0.6498441f,
  -0.4017768f, +0.2872147f, -0.2838907f, +0.2044813f, +0.0871350f, -0.2161863f, -0.7916185f, -0.3026145f,
  -0.1180988f, +0.4365972f, -0.1009209f, -0.1205095f, +0.1750200f, -0.1239652f, -0.4213095f, -0.1768861f,
  +0.0352646f, -0.0311821f, -0.0456246f, +0.0763648f, -0.0573635f, +0.2333644f, -0.3047145f, -0.1533302f,
  -0.2603548f, -0.2194882f, -0.1111075f, +0.0107198f, +0.1070594f, +0.0346115f, +0.4003724f, +0.1197734f,
  -0.0533110f, +0.1754809f, -0.1043903f, -0.1671642f, -0.0308350f, -0.2936473f, +0.0163759f, +0.0442558f,
  +0.4148518f, +0.2871147f, -0.1141654f, -0.2475343f, -0.1423153f, +0.7411795f, -0.6177044f, -0.3778825f,
  +0.6462222f, -0.2968957f, +0.2077754f, +0.0342169f, +0.4318267f, +0.6166893f, -0.6136082f, +0.0615415f,
  -0.0183019f, -0.1866640f, -0.2492392f, -0.0811731f, +0.0284506f, +0.3695635f, +0.7478647f, -0.0141813f,
  -0.0597437f, +0.0571433f, +0.2259306f, +0.0003861f, +0.2536058f, +0.0995091f, +0.1114600f, +0.1108174f,
  -0.0910091f, -0.1498171f, -0.1524664f, +0.2649210f, -0.0253046f, +0.4238174f, -0.1176222f, -0.3312747f,
  +0.0442683f, -0.4463556f, +0.4362937f, -0.0227507f, -0.1302884f, -0.2973233f, -0.1473459f, +0.1282984f
);

const float biases[4] = float[4](
  +0.0274005f, +0.1852987f, +0.0377210f, -0.0181153f
);

vec4 hook() {
    const vec4 r[9][2] = vec4[9][2](
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 1.0f)))
    );

    float sum[4] = biases;
    for (int n = 0; n < 4; n++) {
        for (int i = 0; i < 9; i++) {
            const vec4 k0 = vec4(kernels[n * 8 * 9 + 8 * i + 0], kernels[n * 8 * 9 + 8 * i + 1], kernels[n * 8 * 9 + 8 * i + 2], kernels[n * 8 * 9 + 8 * i + 3]);
            const vec4 k1 = vec4(kernels[n * 8 * 9 + 8 * i + 4], kernels[n * 8 * 9 + 8 * i + 5], kernels[n * 8 * 9 + 8 * i + 6], kernels[n * 8 * 9 + 8 * i + 7]);
            sum[n] += (dot(k0, r[i][0]) + dot(k1, r[i][1]));
        }
    }

    return ACTIVE(vec4(sum[0], sum[1], sum[2], sum[3]));
}

//!HOOK LUMA
//!DESC ARNet b4 Layer5 L1
//!WHEN OUTPUT.w LUMA.w / 1.2 > OUTPUT.h LUMA.h / 1.2 > *
//!BIND TMP2_L0
//!BIND TMP2_L1
//!SAVE TMP1_L1
//!COMPONENTS 4

#define ACTIVE(v) (max(v, v * 0.2000000f))

#define TEX_BIND_L0_TEXOFF TMP2_L0_texOff
#define TEX_BIND_L0_TEX TMP2_L0_tex
#define TEX_BIND_L0_POS TMP2_L0_pos
#define TEX_BIND_L0_SIZE TMP2_L0_size
#define TEX_BIND_L0_PT TMP2_L0_pt

#define TEX_BIND_L1_TEXOFF TMP2_L1_texOff
#define TEX_BIND_L1_TEX TMP2_L1_tex
#define TEX_BIND_L1_POS TMP2_L1_pos
#define TEX_BIND_L1_SIZE TMP2_L1_size
#define TEX_BIND_L1_PT TMP2_L1_pt

const float kernels[288] = float[288](
  -0.2242490f, +0.1528839f, -0.0710057f, +0.2670310f, +0.5033247f, -1.3712254f, +0.8934948f, -0.2349079f,
  +0.1830908f, +0.5998442f, -0.1425449f, -0.6266541f, +0.4237077f, -1.5568565f, -0.3934077f, -0.2929775f,
  -0.4482764f, -0.9495764f, +0.7860860f, -0.3350904f, -0.3106639f, +1.0533717f, +0.1189669f, -0.3282329f,
  -0.3522364f, +0.0297405f, +0.5475121f, -0.0868876f, +0.3953162f, -0.2472699f, +0.6796092f, +0.1093365f,
  -0.3695332f, +0.6868134f, +0.0492419f, -0.3881718f, +0.5524723f, -0.3218895f, +0.4526514f, +0.6051984f,
  +0.2416508f, -0.4717111f, +0.3653983f, +0.2835419f, -0.2978058f, +1.3748045f, +0.4566514f, -0.0908690f,
  -0.0997969f, +0.5615816f, +0.0365929f, -0.0573249f, +0.1027761f, -0.3202279f, -0.0260758f, -0.0606923f,
  +0.0370014f, +0.3052623f, +0.1405161f, -0.4122880f, -0.0639129f, +0.1952394f, +0.2097157f, +0.0361341f,
  +0.0082391f, -0.1707502f, +0.0204420f, -0.1440417f, -0.0362716f, +0.3911131f, -0.2310647f, -0.1541831f,
  -0.5769196f, -0.0594456f, +0.0331498f, +0.3395500f, -0.2672657f, -0.1467515f, +0.2502092f, +0.2077142f,
  -0.4956526f, +0.2352482f, +0.2436431f, +0.4223609f, -0.5276977f, -0.2821417f, -0.0936543f, +0.1015246f,
  -0.4769358f, -0.1573199f, -0.0020525f, +0.2100656f, -0.0306223f, +0.0739909f, -0.2126314f, +0.0560281f,
  +0.0432444f, -0.1425460f, -0.2492815f, +0.1058238f, -0.3726242f, -0.0608049f, +0.0334206f, +0.2681977f,
  -0.0337842f, +0.4977545f, +0.3493534f, +0.3914872f, +0.0334887f, +0.0926212f, -0.1700034f, +0.3706572f,
  +0.0989481f, +0.1807740f, +0.2723166f, -0.0178611f, -0.1674005f, -0.1541588f, +0.3717507f, +0.1829886f,
  -0.1484690f, -0.2896523f, -0.1440307f, -0.1773706f, -0.0238853f, -0.1256117f, -0.2227654f, +0.3697474f,
  -0.2104716f, -0.3617263f, +0.0297234f, -0.1110177f, -0.3872277f, -0.0577576f, +0.1487337f, -0.3801084f,
  -0.2439310f, -0.1588779f, -0.2195249f, -0.0390624f, -0.0238041f, -0.1489002f, -0.3775745f, -0.2821497f,
  -0.2257255f, -0.2489346f, +0.1526967f, -0.0371094f, +0.4877100f, +0.5889611f, -0.2346523f, +0.1736184f,
  -0.0723359f, +0.0178600f, +0.4681572f, -0.1333276f, +0.1538221f, +0.3944692f, -0.1809818f, +0.1370089f,
  +0.0254931f, +0.3541525f, +0.0558154f, +0.0766902f, +0.0230586f, +0.0699931f, -0.0783599f, +0.1391903f,
  +0.1778757f, +0.2339188f, -0.2108823f, -0.2346251f, -0.3967119f, -1.1692244f, -0.4078471f, -0.1853816f,
  +0.1377842f, +0.5726299f, -0.0823489f, -0.0648869f, -0.1213817f, -0.9158036f, -1.3490593f, -0.4201781f,
  +0.1547080f, +0.2100157f, +0.4150213f, -0.0972204f, +0.0330199f, +0.1242948f, +0.0440178f, +0.1100414f,
  +0.2155129f, +0.5991496f, -0.0767617f, +0.6157634f, -0.4629404f, -0.6393904f, +0.5001750f, +0.1775302f,
  +0.1982044f, -0.0134835f, -0.3717221f, +0.2723967f, -0.1557123f, +0.0576611f, +0.3741681f, +0.5467666f,
  +0.0451773f, +0.1011619f, -0.0789774f, +0.0265029f, +0.1293123f, -0.0157219f, +0.1291199f, +0.1424455f,
  +0.1819938f, -0.4400806f, +0.2376132f, -0.3192007f, +0.4209761f, -0.1060941f, +0.0998057f, +0.0885676f,
  -0.0023830f, +0.3573788f, -0.0421181f, -0.0234336f, -0.4361196f, -0.3551519f, -0.0546644f, -0.0645255f,
  -0.1050341f, +0.4902689f, +0.3885069f, -0.0135599f, +0.0292353f, +0.1394771f, +0.0794077f, +0.3278243f,
  -0.1252172f, -0.0946151f, +0.3037952f, -0.1809222f, -0.3387163f, -0.7496176f, +0.2884994f, -0.0453277f,
  +0.1011017f, +0.6021577f, -1.2425871f, -0.5400390f, -0.2601784f, -0.9846182f, +0.0490042f, +0.2199042f,
  +0.1296565f, +0.8193841f, -0.1355608f, -0.0863173f, -0.1307177f, -0.0627704f, +0.1547046f, +0.0713196f,
  +0.2852803f, +0.2237902f, -0.1340031f, -0.0284915f, +0.0825960f, -0.3350871f, -0.0312538f, -0.0130640f,
  +0.1975053f, -0.1406794f, +0.0926003f, +0.1111342f, -0.3574693f, -0.1718654f, +0.4205184f, +0.1347310f,
  +0.1309574f, -0.1491468f, +0.0312710f, +0.1194000f, -0.1565189f, +0.2529836f, +0.5209724f, +0.0983045f
);

const float biases[4] = float[4](
  +0.0209209f, -0.6589195f, +0.1291860f, +0.0008194f
);

vec4 hook() {
    const vec4 r[9][2] = vec4[9][2](
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 1.0f)))
    );

    float sum[4] = biases;
    for (int n = 0; n < 4; n++) {
        for (int i = 0; i < 9; i++) {
            const vec4 k0 = vec4(kernels[n * 8 * 9 + 8 * i + 0], kernels[n * 8 * 9 + 8 * i + 1], kernels[n * 8 * 9 + 8 * i + 2], kernels[n * 8 * 9 + 8 * i + 3]);
            const vec4 k1 = vec4(kernels[n * 8 * 9 + 8 * i + 4], kernels[n * 8 * 9 + 8 * i + 5], kernels[n * 8 * 9 + 8 * i + 6], kernels[n * 8 * 9 + 8 * i + 7]);
            sum[n] += (dot(k0, r[i][0]) + dot(k1, r[i][1]));
        }
    }

    return ACTIVE(vec4(sum[0], sum[1], sum[2], sum[3]));
}

//!HOOK LUMA
//!DESC ARNet b4 Layer6 L0
//!WHEN OUTPUT.w LUMA.w / 1.2 > OUTPUT.h LUMA.h / 1.2 > *
//!BIND TMP1_L0
//!BIND TMP1_L1
//!BIND TMP2_L0
//!SAVE TMP2_L0
//!COMPONENTS 4

#define ACTIVE(v) (v)

#define TEX_BIND_L0_TEXOFF TMP1_L0_texOff
#define TEX_BIND_L0_TEX TMP1_L0_tex
#define TEX_BIND_L0_POS TMP1_L0_pos
#define TEX_BIND_L0_SIZE TMP1_L0_size
#define TEX_BIND_L0_PT TMP1_L0_pt

#define TEX_BIND_L1_TEXOFF TMP1_L1_texOff
#define TEX_BIND_L1_TEX TMP1_L1_tex
#define TEX_BIND_L1_POS TMP1_L1_pos
#define TEX_BIND_L1_SIZE TMP1_L1_size
#define TEX_BIND_L1_PT TMP1_L1_pt

#define TEX_BIND_L2_TEXOFF TMP2_L0_texOff
#define TEX_BIND_L2_TEX TMP2_L0_tex
#define TEX_BIND_L2_POS TMP2_L0_pos
#define TEX_BIND_L2_SIZE TMP2_L0_size
#define TEX_BIND_L2_PT TMP2_L0_pt

const float kernels[288] = float[288](
  -0.2237192f, -0.1511476f, -0.7808564f, -0.4942060f, +0.0198303f, +0.4805616f, -0.0854034f, +0.4602176f,
  -0.2941040f, +0.1931769f, +0.0985437f, +0.1147415f, +0.1694862f, +0.2992027f, +0.0946563f, +0.4636970f,
  +0.0948840f, -0.1030045f, +0.0169687f, +0.0907994f, -0.2855812f, +0.0064051f, -0.4817761f, -0.0423975f,
  +0.6257182f, +0.0890254f, -0.5167320f, +0.1516971f, -0.9766731f, -0.4638073f, +0.1682941f, -0.7582262f,
  -0.2762853f, -0.0492561f, +0.8476611f, -0.5300765f, +0.9073924f, +0.4115906f, -0.9076617f, -0.5756038f,
  +0.1558714f, -0.0356971f, +0.0501749f, -0.1162254f, +0.0450847f, -0.0730842f, +0.4883231f, -0.5413420f,
  -0.6089109f, -0.6590870f, +0.0690766f, -0.1309831f, +0.5390448f, +0.8185484f, -0.1846621f, -0.0746771f,
  -0.0583080f, -0.2223837f, -0.3792144f, -0.0915266f, -0.1056382f, +0.3494082f, +0.3649447f, +0.5566545f,
  +0.1713328f, +0.0066543f, +0.0744879f, -0.0199429f, -0.1601275f, -0.0730997f, -0.5263945f, -0.1293104f,
  +0.2092683f, +0.2432001f, -0.2995299f, -0.1026755f, +0.2090171f, -0.2583956f, -0.0420628f, -0.0828652f,
  -0.2948265f, +0.0251349f, -0.6643140f, -0.2065797f, +0.1724580f, +0.0201646f, +0.0726042f, +0.1415531f,
  -0.0521545f, +0.0827444f, +0.1819180f, -0.2635836f, +0.1230960f, -0.0033272f, +0.2108003f, +0.2428456f,
  +0.1517653f, +0.1211205f, -0.6943079f, -0.0802354f, +0.0160984f, -0.5279438f, +0.3766103f, -0.0350942f,
  -0.1377084f, +0.1603989f, -0.1702981f, +0.1876901f, +0.0297747f, -0.1501441f, +0.1510987f, +0.2163768f,
  +0.1107656f, +0.0733748f, +0.0744340f, -0.2416977f, -0.0842160f, +0.1736256f, -0.1046869f, -0.2245361f,
  -0.1063069f, +0.2071486f, -0.3171496f, -0.0883152f, -0.3637546f, -0.1358533f, +0.1688298f, -0.1592482f,
  +0.0896949f, +0.3453020f, +0.2261266f, +0.2531674f, +0.2584881f, -0.1132094f, +0.0465219f, -0.1947529f,
  +0.0581423f, +0.1688557f, -0.0479752f, +0.2061608f, -0.0151503f, -0.0110031f, -0.1145897f, -0.1015456f,
  -0.1513009f, -0.1411387f, +0.8396581f, -0.3354872f, -0.3502764f, -0.2900234f, -0.0594650f, +0.3198539f,
  -0.0326139f, -0.4344739f, +0.1082641f, -0.1237648f, -0.1779937f, -0.1275107f, -0.1590192f, +0.2221013f,
  -0.0962648f, +0.0837152f, +0.0437646f, -0.1128524f, -0.0039918f, +0.5510101f, +0.0875344f, +0.0877253f,
  -0.1192735f, +0.5238924f, +0.2845076f, -0.1848445f, +0.5272891f, -0.4064811f, -0.0913069f, +0.2886530f,
  +0.2511292f, +0.1131207f, +0.3440905f, -0.2776707f, -0.0368984f, -0.3786235f, -0.2479851f, -1.7205721f,
  +0.1917600f, -0.0183277f, +0.2812837f, -0.1931763f, +0.4793890f, +0.2042521f, +0.4510873f, -0.0581651f,
  -0.3794247f, +0.4230013f, +0.0321554f, +0.0887679f, -0.2819442f, -0.2805710f, -0.0980993f, +0.2380350f,
  +0.2165581f, +0.1467451f, +0.6607116f, +0.0785748f, +0.0379250f, -1.0209213f, -0.1209175f, +0.3264348f,
  -0.1202620f, +0.2117403f, -0.2443110f, +0.2211628f, +0.0829543f, -0.5510778f, -0.2816197f, -0.3456583f,
  +0.4283451f, -0.7098162f, +0.6129087f, +0.3378724f, -0.5271882f, +0.7434193f, -0.7011313f, -0.0321142f,
  +0.5233149f, -0.6245696f, +0.0764823f, +0.2157977f, -0.7961966f, +0.0671475f, +0.2124039f, +0.3733694f,
  -0.0790872f, -0.2996618f, -0.0564256f, +0.4010876f, -0.0852659f, +0.1638865f, -1.1100506f, +0.1103845f,
  -1.2072333f, -0.8244602f, +0.8359970f, -0.1768521f, -0.2069381f, +0.5128776f, -0.6537260f, +0.0971146f,
  +1.0502182f, +0.5773873f, +1.5225527f, +0.7122393f, -0.0968511f, -0.5361394f, -0.0605782f, -0.1978295f,
  -0.0006226f, -0.3267705f, +0.0220109f, -0.1387783f, +0.1811159f, -0.0621149f, +0.3489266f, -0.0059619f,
  -0.1674035f, -0.1177659f, -0.0822792f, +0.3724818f, +0.8764444f, -0.3720402f, -0.2076520f, +0.1621266f,
  +0.1074715f, -0.1471266f, +0.1493894f, -0.1503157f, -0.6710421f, -0.5490692f, +0.1044701f, -0.1831059f,
  -0.3159379f, -0.2621300f, -0.0756533f, +0.0351524f, +0.3179186f, -0.4030506f, -0.0488549f, +0.1495410f
);

const float biases[4] = float[4](
  -0.2292518f, -0.0591496f, +0.0103919f, -0.0887338f
);

vec4 hook() {
    const vec4 r[9][2] = vec4[9][2](
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 1.0f)))
    );

    float sum[4] = biases;
    for (int n = 0; n < 4; n++) {
        for (int i = 0; i < 9; i++) {
            const vec4 k0 = vec4(kernels[n * 8 * 9 + 8 * i + 0], kernels[n * 8 * 9 + 8 * i + 1], kernels[n * 8 * 9 + 8 * i + 2], kernels[n * 8 * 9 + 8 * i + 3]);
            const vec4 k1 = vec4(kernels[n * 8 * 9 + 8 * i + 4], kernels[n * 8 * 9 + 8 * i + 5], kernels[n * 8 * 9 + 8 * i + 6], kernels[n * 8 * 9 + 8 * i + 7]);
            sum[n] += (dot(k0, r[i][0]) + dot(k1, r[i][1]));
        }
    }

    return ACTIVE(vec4(sum[0], sum[1], sum[2], sum[3]) * 0.2000000f + TEX_BIND_L2_TEXOFF(vec2(0.0f, 0.0f)));
}

//!HOOK LUMA
//!DESC ARNet b4 Layer6 L1
//!WHEN OUTPUT.w LUMA.w / 1.2 > OUTPUT.h LUMA.h / 1.2 > *
//!BIND TMP1_L0
//!BIND TMP1_L1
//!BIND TMP2_L1
//!SAVE TMP2_L1
//!COMPONENTS 4

#define ACTIVE(v) (v)

#define TEX_BIND_L0_TEXOFF TMP1_L0_texOff
#define TEX_BIND_L0_TEX TMP1_L0_tex
#define TEX_BIND_L0_POS TMP1_L0_pos
#define TEX_BIND_L0_SIZE TMP1_L0_size
#define TEX_BIND_L0_PT TMP1_L0_pt

#define TEX_BIND_L1_TEXOFF TMP1_L1_texOff
#define TEX_BIND_L1_TEX TMP1_L1_tex
#define TEX_BIND_L1_POS TMP1_L1_pos
#define TEX_BIND_L1_SIZE TMP1_L1_size
#define TEX_BIND_L1_PT TMP1_L1_pt

#define TEX_BIND_L2_TEXOFF TMP2_L1_texOff
#define TEX_BIND_L2_TEX TMP2_L1_tex
#define TEX_BIND_L2_POS TMP2_L1_pos
#define TEX_BIND_L2_SIZE TMP2_L1_size
#define TEX_BIND_L2_PT TMP2_L1_pt

const float kernels[288] = float[288](
  -0.0063989f, -0.1798447f, +0.3610555f, +0.1004615f, +0.0325451f, +0.2101058f, -0.2259056f, -0.1351379f,
  +0.2103400f, -0.3280503f, +0.0302132f, -0.0213758f, -0.2392430f, +0.3114275f, +0.1352620f, +0.1464834f,
  -0.1934849f, +0.0888994f, -0.1031953f, +0.0366108f, +0.2512316f, +0.1400523f, +0.4788117f, +0.0711389f,
  +0.0844391f, +0.2995033f, +0.1868743f, -0.1034712f, +0.4658341f, +0.2712648f, -0.1383945f, -0.2884289f,
  +0.2019096f, -0.1465602f, -0.7234971f, +0.0092479f, -0.3946221f, +0.2676616f, -0.0164651f, +0.1215777f,
  +0.1703990f, +0.4875808f, -0.2638045f, +0.2820818f, +0.1167642f, +0.0165439f, -0.0255646f, +0.3679415f,
  +0.2401997f, -0.2111758f, -0.1430493f, +0.1513305f, +0.3068594f, +0.2578363f, -0.0078097f, -0.0834872f,
  -0.1411912f, -0.0041582f, -0.2257355f, -0.1130171f, +0.0961591f, +0.8999078f, +0.0211541f, +0.2576149f,
  -0.0697542f, -0.0061354f, -0.1801173f, +0.0280832f, -0.0730082f, +0.1090591f, +0.2711356f, -0.3032567f,
  -0.1983985f, -0.1903453f, -0.1538399f, +0.2035690f, -0.3566576f, -0.3079432f, -0.0271695f, +0.1410582f,
  +0.0791491f, +0.0421796f, +0.6083941f, +0.1689830f, -0.1820063f, +0.2496362f, -0.8488493f, -0.0677556f,
  +0.0328314f, +0.0649554f, -0.3748689f, +0.5707144f, -0.0629464f, +0.3185197f, +0.0766128f, +0.0358047f,
  -1.1566889f, +0.2083320f, -0.1242395f, -0.3335076f, +0.3131240f, +0.8158034f, +0.0035713f, -0.0105232f,
  +0.3326022f, -0.1632048f, -0.0858657f, +0.2017597f, +0.3114990f, +0.9604592f, +0.6344107f, -0.0745596f,
  +0.1335039f, -0.2119343f, +0.1144928f, +0.2477077f, +0.3030616f, +0.9657500f, +0.2802876f, +0.1788196f,
  +0.1227712f, -0.3232020f, -0.1135423f, +0.0343160f, +0.3173719f, +0.0328212f, +0.0296482f, -0.2345756f,
  -0.1594563f, -0.0197808f, -0.4523256f, +0.5274949f, +0.3312933f, +0.3731035f, -0.2497686f, -0.3116694f,
  -0.1032982f, -0.2265509f, +0.0612665f, +0.0351974f, +0.0427347f, +0.1358795f, +0.4350740f, +0.0073253f,
  +0.2119507f, +0.0546160f, +0.4377581f, +0.0339889f, +0.0537735f, +0.1126567f, -0.4545384f, +0.1733898f,
  +0.0967598f, -0.3584616f, +0.3013988f, -0.1254504f, +0.1076120f, +0.3050384f, -0.3346677f, +0.0499056f,
  -0.2498835f, +0.2301107f, +0.3346530f, -0.0840387f, +0.4176475f, -0.0719385f, +0.6046852f, +0.0881178f,
  +0.7425489f, +0.5084929f, -0.4119810f, -0.1615431f, +0.7340912f, +0.2158446f, -0.1075631f, -0.8952344f,
  +0.0145585f, -0.7976613f, -0.9749963f, -0.0378984f, -1.0082762f, +0.6228513f, +0.3693570f, -0.2986011f,
  +0.2757044f, +0.6039260f, -0.3687575f, +0.2031337f, +0.1366380f, +0.0817272f, +0.3487950f, +0.4039001f,
  -0.0300525f, -0.0460469f, +0.0341903f, +0.1683973f, +0.3363603f, +0.4833615f, -0.0573246f, +0.0339963f,
  -0.0296036f, -0.3576080f, -0.4637722f, -0.0565707f, -0.5313425f, +0.4114415f, +0.4340212f, -0.1962712f,
  +0.0188222f, +0.0943336f, -0.2270694f, +0.1787954f, -0.0814109f, +0.3893050f, -0.1101527f, +0.0815761f,
  -0.9776049f, +0.3294686f, +0.0143119f, -0.7680308f, -0.0568456f, -0.0915847f, -0.1571387f, +0.2225999f,
  +0.0021631f, +0.4605881f, +0.6490562f, +0.6982103f, +0.7493724f, +0.7621247f, +0.6860949f, -0.1999591f,
  +0.0928478f, +0.3141336f, -0.6786397f, +0.0664231f, -0.0012033f, -0.2603434f, +1.2249891f, -0.2478867f,
  +1.1347260f, -0.6921000f, +0.4052287f, +0.0647933f, -0.1019375f, -0.4903097f, -0.2353912f, -0.6480680f,
  -0.1628504f, -0.0396958f, +0.0177629f, -0.2104312f, +0.7933663f, -0.6959479f, -0.4068690f, -0.3856600f,
  +0.2915745f, +0.0423485f, -0.3067241f, +0.4017387f, -0.8569782f, -0.2901624f, -1.3208115f, -0.4753663f,
  -0.4007338f, +0.2793773f, -0.1471470f, +0.1666811f, +0.7824420f, +0.3554971f, -0.0840212f, +0.4610921f,
  -0.4237912f, -0.3824028f, +0.0693327f, -0.0944196f, -0.0602619f, +0.2010291f, +0.1008500f, +0.0628880f,
  -0.0190301f, -0.2384809f, +0.1243019f, +0.2003656f, +0.0689289f, +0.0130410f, +0.2610331f, +0.6343507f
);

const float biases[4] = float[4](
  -0.3607268f, +0.1905509f, +0.0703876f, +0.1399592f
);

vec4 hook() {
    const vec4 r[9][2] = vec4[9][2](
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 1.0f)))
    );

    float sum[4] = biases;
    for (int n = 0; n < 4; n++) {
        for (int i = 0; i < 9; i++) {
            const vec4 k0 = vec4(kernels[n * 8 * 9 + 8 * i + 0], kernels[n * 8 * 9 + 8 * i + 1], kernels[n * 8 * 9 + 8 * i + 2], kernels[n * 8 * 9 + 8 * i + 3]);
            const vec4 k1 = vec4(kernels[n * 8 * 9 + 8 * i + 4], kernels[n * 8 * 9 + 8 * i + 5], kernels[n * 8 * 9 + 8 * i + 6], kernels[n * 8 * 9 + 8 * i + 7]);
            sum[n] += (dot(k0, r[i][0]) + dot(k1, r[i][1]));
        }
    }

    return ACTIVE(vec4(sum[0], sum[1], sum[2], sum[3]) * 0.2000000f + TEX_BIND_L2_TEXOFF(vec2(0.0f, 0.0f)));
}

//!HOOK LUMA
//!DESC ARNet b4 Layer7 L0
//!WHEN OUTPUT.w LUMA.w / 1.2 > OUTPUT.h LUMA.h / 1.2 > *
//!BIND TMP2_L0
//!BIND TMP2_L1
//!SAVE TMP1_L0
//!COMPONENTS 4

#define ACTIVE(v) (max(v, v * 0.2000000f))

#define TEX_BIND_L0_TEXOFF TMP2_L0_texOff
#define TEX_BIND_L0_TEX TMP2_L0_tex
#define TEX_BIND_L0_POS TMP2_L0_pos
#define TEX_BIND_L0_SIZE TMP2_L0_size
#define TEX_BIND_L0_PT TMP2_L0_pt

#define TEX_BIND_L1_TEXOFF TMP2_L1_texOff
#define TEX_BIND_L1_TEX TMP2_L1_tex
#define TEX_BIND_L1_POS TMP2_L1_pos
#define TEX_BIND_L1_SIZE TMP2_L1_size
#define TEX_BIND_L1_PT TMP2_L1_pt

const float kernels[288] = float[288](
  -0.0276376f, -0.3076536f, +0.0986042f, +0.1154871f, -0.5574835f, -0.5624657f, +0.2627158f, -0.1051812f,
  -0.1342699f, +0.2571528f, +0.1140579f, -0.0903755f, -0.3380322f, +0.1504434f, -0.1756368f, -0.1712390f,
  -0.1335162f, +0.3131224f, +0.1087912f, +0.0841500f, -0.2484178f, -0.1647741f, +0.2476791f, +0.1548828f,
  +0.2838404f, +0.2852634f, +0.2013837f, -0.0992516f, -0.2805193f, -0.3418416f, +0.3743063f, +0.1708208f,
  -0.0885576f, +0.5939978f, -0.3961878f, +0.0425375f, +0.2651241f, -0.1281721f, -0.3526148f, +0.7702204f,
  -0.2421572f, +0.4208626f, -0.0702915f, +0.1598739f, -0.3637204f, +0.1064256f, +0.1308086f, +0.1328142f,
  -0.0291461f, +0.4263670f, +0.0306752f, +0.2877562f, +0.2977222f, -0.4753627f, +0.2993843f, -0.2629888f,
  +0.2804706f, +0.3075350f, +0.2183324f, +0.3197080f, +0.3254023f, -0.2444695f, -0.0693906f, +0.1321034f,
  -0.0135163f, +0.2271948f, -0.0450241f, -0.0631821f, +0.0034666f, -0.1230744f, +0.1595690f, +0.1519453f,
  -0.2043132f, +0.1640937f, -0.0334961f, +0.1353072f, -0.4115239f, -0.0635657f, +0.1353871f, +0.0259326f,
  +0.1333090f, +0.1222510f, +0.1701946f, +0.2417267f, +0.1903280f, -0.2461858f, -0.1625708f, -0.0276730f,
  -0.0952730f, -0.1705568f, +0.0268433f, +0.2150439f, -0.5162135f, -0.1648783f, +0.3463641f, -0.1294806f,
  +0.1640309f, +0.6020942f, -0.0656638f, +0.1289707f, -0.1243199f, -0.1597804f, +0.1451994f, -0.3071608f,
  +0.0762307f, +0.6191693f, -0.2169027f, -0.0393705f, -0.1855728f, +0.1688864f, +0.8925917f, +0.2899554f,
  -0.1100873f, -0.2831042f, +0.0268445f, -0.0358628f, -0.2115786f, -0.3856785f, -0.5943034f, -0.2396278f,
  +0.0121451f, +0.4443545f, +0.1042268f, +0.0977112f, +0.4300442f, +0.0980469f, +0.2843252f, -0.2676519f,
  -0.0899737f, -0.1346621f, +0.0300781f, +0.0819336f, +0.0231641f, -0.4460742f, +0.1086721f, +0.2794904f,
  -0.0207235f, -0.3057683f, +0.2321792f, -0.1004832f, -0.0439220f, +0.3855208f, +0.2113389f, -0.0092800f,
  +0.1584485f, -0.1203978f, +0.0811221f, -0.0758661f, +0.3242519f, -0.2740595f, -0.2093806f, -0.4268317f,
  -0.3683521f, +0.0371094f, -0.1816018f, -0.2478298f, +0.3065403f, +0.3617003f, -0.4238068f, -0.3218000f,
  +0.0134801f, +0.1227773f, +0.1486801f, +0.0047956f, +0.1823179f, +0.0022929f, -0.0834743f, +0.1697963f,
  -0.1179634f, +0.3616410f, +0.2276323f, -0.2068494f, +0.3119298f, -0.3977033f, +0.4026056f, +0.0645665f,
  +0.1131216f, +0.6668930f, -0.7608517f, +0.2531512f, +0.4307532f, -0.2987350f, -0.9612836f, +1.0830414f,
  +0.0484031f, +0.2209287f, -0.0141720f, -0.0851826f, +0.3162490f, +0.0308798f, -0.0435160f, +0.0402166f,
  -0.0094165f, +0.3702823f, +0.0378381f, +0.1969433f, +0.1941738f, -0.2031763f, +0.2522022f, -0.3015804f,
  +0.3397706f, +0.3866092f, +0.0253730f, +0.3568572f, +0.3349743f, +0.0371913f, -0.2201241f, +0.0722684f,
  -0.0368240f, +0.5062366f, -0.0375883f, -0.0131262f, +0.1100509f, -0.0617031f, +0.1404078f, +0.1620790f,
  -0.0572233f, +0.0705845f, -0.0098411f, +0.1742408f, -0.2175937f, +0.0973689f, +0.0078206f, -0.0275385f,
  +0.0483691f, -0.0381802f, +0.1159456f, -0.3172657f, +0.4804513f, +0.0557497f, -0.3297026f, -0.0438331f,
  +0.1257132f, -0.0809786f, +0.2627237f, -0.1425155f, -0.0345959f, +0.0312401f, -0.0911473f, -0.0510043f,
  +0.1372456f, +0.2377817f, +0.2124014f, +0.0468025f, +0.2621879f, +0.0118042f, -0.2786043f, -0.3831692f,
  -0.4040141f, +0.1981098f, -0.4374065f, -0.6232201f, +0.6307119f, -0.8853239f, +0.0373599f, +0.2172643f,
  -0.1815091f, +0.2098578f, -0.2181062f, +0.1925426f, +0.3106974f, +0.4497050f, -0.8172804f, +0.1845396f,
  -0.0498932f, +0.3597696f, +0.0111309f, +0.2436183f, +0.2878209f, -0.0587688f, +0.1762532f, -0.1698714f,
  +0.0659745f, +0.4750577f, +0.1892848f, +0.1245168f, +0.4857703f, -0.4031885f, +0.2369216f, +0.3508698f,
  +0.1612390f, +0.2085673f, +0.1924016f, +0.0548466f, +0.4949242f, +0.1663272f, +0.0174844f, +0.2005807f
);

const float biases[4] = float[4](
  +0.1719528f, +0.1117397f, -0.2788602f, -0.1678721f
);

vec4 hook() {
    const vec4 r[9][2] = vec4[9][2](
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 1.0f)))
    );

    float sum[4] = biases;
    for (int n = 0; n < 4; n++) {
        for (int i = 0; i < 9; i++) {
            const vec4 k0 = vec4(kernels[n * 8 * 9 + 8 * i + 0], kernels[n * 8 * 9 + 8 * i + 1], kernels[n * 8 * 9 + 8 * i + 2], kernels[n * 8 * 9 + 8 * i + 3]);
            const vec4 k1 = vec4(kernels[n * 8 * 9 + 8 * i + 4], kernels[n * 8 * 9 + 8 * i + 5], kernels[n * 8 * 9 + 8 * i + 6], kernels[n * 8 * 9 + 8 * i + 7]);
            sum[n] += (dot(k0, r[i][0]) + dot(k1, r[i][1]));
        }
    }

    return ACTIVE(vec4(sum[0], sum[1], sum[2], sum[3]));
}

//!HOOK LUMA
//!DESC ARNet b4 Layer7 L1
//!WHEN OUTPUT.w LUMA.w / 1.2 > OUTPUT.h LUMA.h / 1.2 > *
//!BIND TMP2_L0
//!BIND TMP2_L1
//!SAVE TMP1_L1
//!COMPONENTS 4

#define ACTIVE(v) (max(v, v * 0.2000000f))

#define TEX_BIND_L0_TEXOFF TMP2_L0_texOff
#define TEX_BIND_L0_TEX TMP2_L0_tex
#define TEX_BIND_L0_POS TMP2_L0_pos
#define TEX_BIND_L0_SIZE TMP2_L0_size
#define TEX_BIND_L0_PT TMP2_L0_pt

#define TEX_BIND_L1_TEXOFF TMP2_L1_texOff
#define TEX_BIND_L1_TEX TMP2_L1_tex
#define TEX_BIND_L1_POS TMP2_L1_pos
#define TEX_BIND_L1_SIZE TMP2_L1_size
#define TEX_BIND_L1_PT TMP2_L1_pt

const float kernels[288] = float[288](
  +0.1973808f, -0.1343663f, -0.0280534f, -0.2073008f, -0.0432562f, -0.0788689f, +0.0007223f, -0.0962257f,
  +0.0075975f, -0.1443390f, -0.4271381f, +0.2283488f, +0.1299452f, +0.2758430f, -0.0551673f, +0.0003746f,
  -0.1572351f, -0.1672126f, -0.1995679f, +0.1992862f, -0.1416631f, +0.0307754f, +0.1166421f, +0.0571546f,
  -0.0914688f, +0.1928223f, -0.3201019f, -0.0114328f, -0.0265142f, +0.0265295f, +0.3237377f, +0.4957290f,
  +0.6336358f, -0.0307691f, -0.2144848f, +1.1019224f, +0.0094543f, +1.0095658f, -0.2543743f, +0.1429407f,
  +0.3296086f, -0.0156866f, -0.0157719f, +0.0458879f, +0.0524147f, -0.2032002f, +0.6139075f, -0.2806872f,
  +0.0135147f, -0.1167750f, -0.0896081f, -0.0516365f, -0.1109967f, -0.1734836f, -0.0837496f, -0.0628122f,
  +0.0797744f, -0.3345318f, -0.3717481f, +0.0950271f, -0.3500918f, +0.1849446f, -0.3042705f, -0.3900119f,
  -0.1357916f, +0.0205057f, -0.2206901f, +0.1736883f, -0.1785130f, -0.2465399f, -0.0317534f, -0.2560092f,
  +0.0006553f, -0.0845480f, -0.3998624f, -0.1016138f, +0.0222562f, +0.2163088f, +0.2531988f, +0.3375188f,
  +0.2243522f, -0.0926495f, -0.7469472f, +0.9830833f, +0.3026034f, +0.6015697f, -0.0259258f, +0.4166509f,
  -0.1025737f, -0.2964913f, -0.2627036f, +0.0394500f, +0.1025217f, -0.1945169f, -0.0482866f, -0.1193997f,
  +0.1848937f, -0.1583384f, -0.4085310f, +0.1396708f, -0.2501318f, +0.3308252f, -0.1847028f, +0.1988959f,
  +0.2873597f, -0.5026151f, +0.0888779f, +0.8032611f, +0.0943724f, +0.9533537f, +0.4629196f, -0.9968280f,
  +0.1990170f, -0.1499480f, -0.0031996f, +0.0439209f, +0.0699183f, -0.2002118f, +0.3236967f, -0.2246918f,
  +0.0688823f, -0.2812234f, -0.2415258f, -0.1839769f, -0.0962673f, -0.1755563f, -0.1865188f, +0.0429335f,
  -0.0780286f, -0.2614607f, -0.4005176f, -0.0195042f, -0.2189375f, -0.2872177f, -0.1097813f, -0.4758852f,
  -0.0594727f, -0.1768357f, -0.1741250f, +0.1248838f, -0.1346715f, -0.1580028f, -0.2066571f, -0.1659274f,
  +0.0270181f, -0.0283805f, -0.0442679f, -0.0456314f, +0.0477738f, -0.1464502f, -0.1105613f, -0.0963136f,
  +0.0210879f, +0.1106049f, +0.1370060f, -0.0717846f, -0.2275510f, +0.2114032f, +0.0233688f, -0.0912381f,
  +0.0113029f, +0.3062946f, +0.0007227f, +0.0167233f, -0.0638147f, +0.1356384f, +0.0642278f, +0.0682158f,
  -0.0550233f, -0.1405155f, -0.4487851f, +0.0151461f, -0.1008611f, +0.0718218f, +0.4259544f, +0.1122978f,
  +0.2355940f, +0.3166718f, -0.2126439f, +0.3179796f, -0.3307492f, -0.9183969f, -0.2231026f, -0.2053359f,
  -0.3611446f, +0.1995104f, -0.0414505f, +0.1235285f, -0.4982305f, -0.1801254f, +0.1766853f, -0.0276311f,
  +0.0187826f, -0.1745138f, +0.1133408f, -0.2972899f, +0.3654871f, +0.1211024f, -0.2422817f, +0.0599499f,
  -0.2003358f, -0.3119904f, +0.0016678f, -0.1334624f, +0.0230171f, +0.0201681f, -0.3280275f, -0.1640185f,
  +0.0579901f, -0.0031050f, -0.1466338f, -0.0823493f, -0.2297207f, +0.1956129f, -0.0671802f, -0.0224143f,
  +0.3828856f, -0.3209147f, +0.3961555f, -0.0857689f, -0.1251467f, -0.5516132f, -0.2752794f, -0.2023197f,
  -0.1029468f, +0.2617322f, +0.5065650f, -0.5285811f, -0.5407761f, -0.1524260f, -0.1526682f, -0.2371640f,
  +0.0159250f, +0.5634835f, +0.1818866f, +0.0069714f, -0.2193813f, -0.2417846f, +0.0018291f, +0.2015419f,
  +0.0370783f, +0.6650779f, +0.2361151f, -0.1892432f, +0.7089285f, -0.9468941f, +0.5956469f, +0.2263515f,
  +0.0308906f, +0.6571633f, +0.2087167f, -0.0379419f, -0.2731783f, +0.7181025f, -0.9038089f, +1.1259311f,
  +0.1507084f, +0.1228066f, +0.1787263f, -0.3742698f, +0.0834464f, +0.0726802f, +0.5663704f, +0.1870890f,
  +0.0991379f, -0.0428080f, +0.2567385f, -0.1292063f, +0.0104722f, +0.0755779f, -0.0130701f, +0.0087896f,
  +0.3434304f, +0.0670545f, +0.1995674f, +0.3529711f, -0.2741582f, +1.3161581f, -0.4663938f, -0.3857946f,
  -0.2168064f, +0.6581742f, -0.0779432f, -0.0906418f, +0.0666403f, +0.0658659f, +0.3425813f, -0.1449056f
);

const float biases[4] = float[4](
  -0.0161310f, +0.0239470f, +0.0717387f, -0.0795713f
);

vec4 hook() {
    const vec4 r[9][2] = vec4[9][2](
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 1.0f)))
    );

    float sum[4] = biases;
    for (int n = 0; n < 4; n++) {
        for (int i = 0; i < 9; i++) {
            const vec4 k0 = vec4(kernels[n * 8 * 9 + 8 * i + 0], kernels[n * 8 * 9 + 8 * i + 1], kernels[n * 8 * 9 + 8 * i + 2], kernels[n * 8 * 9 + 8 * i + 3]);
            const vec4 k1 = vec4(kernels[n * 8 * 9 + 8 * i + 4], kernels[n * 8 * 9 + 8 * i + 5], kernels[n * 8 * 9 + 8 * i + 6], kernels[n * 8 * 9 + 8 * i + 7]);
            sum[n] += (dot(k0, r[i][0]) + dot(k1, r[i][1]));
        }
    }

    return ACTIVE(vec4(sum[0], sum[1], sum[2], sum[3]));
}

//!HOOK LUMA
//!DESC ARNet b4 Layer8 L0
//!WHEN OUTPUT.w LUMA.w / 1.2 > OUTPUT.h LUMA.h / 1.2 > *
//!BIND TMP1_L0
//!BIND TMP1_L1
//!BIND TMP2_L0
//!BIND FEAT_L0
//!SAVE TMP2_L0
//!COMPONENTS 4

#define ACTIVE(v) (v)

#define TEX_BIND_L0_TEXOFF TMP1_L0_texOff
#define TEX_BIND_L0_TEX TMP1_L0_tex
#define TEX_BIND_L0_POS TMP1_L0_pos
#define TEX_BIND_L0_SIZE TMP1_L0_size
#define TEX_BIND_L0_PT TMP1_L0_pt

#define TEX_BIND_L1_TEXOFF TMP1_L1_texOff
#define TEX_BIND_L1_TEX TMP1_L1_tex
#define TEX_BIND_L1_POS TMP1_L1_pos
#define TEX_BIND_L1_SIZE TMP1_L1_size
#define TEX_BIND_L1_PT TMP1_L1_pt

#define TEX_BIND_L2_TEXOFF TMP2_L0_texOff
#define TEX_BIND_L2_TEX TMP2_L0_tex
#define TEX_BIND_L2_POS TMP2_L0_pos
#define TEX_BIND_L2_SIZE TMP2_L0_size
#define TEX_BIND_L2_PT TMP2_L0_pt

#define TEX_BIND_L3_TEXOFF FEAT_L0_texOff
#define TEX_BIND_L3_TEX FEAT_L0_tex
#define TEX_BIND_L3_POS FEAT_L0_pos
#define TEX_BIND_L3_SIZE FEAT_L0_size
#define TEX_BIND_L3_PT FEAT_L0_pt

const float kernels[288] = float[288](
  -0.1439343f, +0.0286013f, -0.0576318f, +0.0271537f, -0.1898959f, +0.1652129f, +0.4631961f, +0.3480629f,
  +0.0450589f, -0.3977974f, -0.2229455f, -0.1609927f, -0.2884253f, +0.1060572f, -0.3752759f, -0.3618372f,
  -0.1351735f, -0.3908505f, +0.1106120f, +0.1093825f, +0.1268950f, +0.0926103f, +0.7883389f, -0.4604482f,
  +0.2341255f, -0.4130694f, -0.0840083f, +0.6273190f, -1.0553991f, +0.2760846f, +0.4775831f, +0.3653381f,
  +0.3103021f, -0.7711296f, -1.4007038f, +0.2122938f, -1.3091136f, +0.6104933f, +0.4566945f, -0.0716822f,
  -0.1878229f, -0.1007092f, +0.3670182f, -0.2406862f, +0.1080373f, +0.0871877f, +0.2645062f, -0.6181977f,
  -0.2085994f, -0.7165253f, +0.6431741f, -0.8381968f, +0.4293523f, +0.1246855f, +0.5101965f, -0.4609173f,
  -0.8290303f, -0.3959939f, +0.6981882f, -0.2232631f, -0.0993841f, +0.3459730f, -0.0936355f, -0.3086996f,
  +0.1277892f, -0.3656292f, -0.0999196f, -0.3138412f, +0.1154233f, -0.1240442f, +0.1395113f, +0.0735464f,
  -0.1265322f, +0.4624475f, -0.2677650f, +0.3914039f, -0.3931634f, +0.1983579f, +0.2934008f, -0.0272632f,
  +0.2352606f, +0.2586455f, -0.2623379f, +0.1009649f, -0.0309178f, +0.1596871f, +0.2611598f, +0.3798431f,
  -0.0470974f, +0.2815163f, +0.0317741f, +0.1339251f, -0.0114031f, +0.0546047f, -0.1977189f, +0.2470073f,
  +0.1486965f, +0.4892241f, -0.2282188f, +0.5954381f, -0.1782686f, +0.1104887f, -0.2273840f, +0.2227429f,
  +0.4177604f, +0.0051603f, -0.2846293f, +0.0127320f, -0.1281477f, +0.5956607f, -0.2980401f, -0.3748173f,
  -0.0550483f, -0.0052550f, +0.0891342f, -0.4083148f, +0.0814144f, -0.0106241f, +0.1329221f, -0.1828295f,
  +0.1193925f, +0.0236275f, -0.2424867f, -0.0560559f, +0.1166646f, +0.0118041f, -0.0178325f, +0.1472446f,
  -0.0933438f, -0.0127763f, -0.1074280f, +0.1045434f, -0.2258733f, +0.2815571f, -0.1589072f, -0.0379205f,
  -0.0332613f, +0.1024976f, -0.0960685f, -0.1434741f, -0.1677656f, +0.1362504f, -0.1364244f, -0.0675398f,
  +0.0225942f, -0.0416248f, -0.0893267f, -0.1248093f, -0.1294442f, -0.0872865f, +0.0791814f, +0.0123566f,
  -0.0274921f, +0.0760079f, +0.2716412f, -0.1875039f, -0.0444617f, +0.1610293f, +0.2792554f, -0.0101221f,
  -0.1482052f, +0.6162838f, -0.0104525f, -0.2621907f, -0.0631442f, +0.0568053f, -0.3030784f, -0.4906632f,
  +0.3493161f, -0.2500810f, -0.1602021f, -0.0130018f, -0.2878962f, +0.0204003f, +0.4222307f, -0.3162071f,
  -0.8025748f, -0.0765478f, +0.8450508f, +0.4226296f, -0.0194896f, -0.0182442f, +0.4548232f, +0.5030863f,
  +0.0996230f, +0.4031247f, -0.0329863f, -0.4697080f, +0.6492388f, +0.2136329f, +0.4123051f, -0.7101284f,
  +0.0988667f, +0.1849731f, -0.0283442f, -0.0115410f, -0.0053310f, +0.0035150f, -0.2116085f, -0.1010260f,
  -0.3816553f, -0.1252565f, +0.7002270f, +0.2175703f, +0.2211017f, +0.0841540f, +0.1077133f, -0.2171883f,
  -0.6197733f, -0.2011197f, +0.5059818f, +0.4867386f, -0.1159951f, -0.6350073f, +0.1590446f, -0.2495631f,
  -0.0491588f, +0.0166177f, +0.0836010f, -0.0042692f, -0.1290830f, +0.1013172f, -0.0845251f, +0.1875413f,
  -0.0692709f, -0.2515763f, -0.0161923f, +0.2373298f, -0.3824312f, +0.1707361f, -0.0682779f, -0.1554519f,
  +0.0172644f, +0.2917639f, -0.1812308f, -0.1784744f, +0.0894457f, +0.2577980f, +0.0110454f, -0.7231255f,
  +0.0039241f, -0.0411139f, -0.1693327f, -0.1846078f, +0.1349556f, -0.0874983f, +0.0409383f, -0.0934008f,
  +0.0217578f, +0.1784790f, -0.0833218f, +0.3998941f, -0.0334391f, -0.0420612f, -0.3692108f, +0.6367798f,
  +0.1399224f, +0.1214098f, +0.0929588f, +0.0413334f, -0.2566146f, +0.2541446f, -0.1090123f, -0.1015649f,
  -0.1079275f, +0.2142260f, +0.3242972f, +0.3897078f, +0.0250295f, -0.1725587f, -0.0772657f, -0.1868601f,
  -0.0264116f, +0.1012735f, +0.2899384f, +0.1930739f, -0.0913775f, -0.7440842f, -0.1579385f, +0.0483225f,
  -0.0326121f, +0.0728027f, +0.1205703f, +0.1913130f, -0.0178922f, -0.1706612f, +0.0691119f, +0.3508151f
);

const float biases[4] = float[4](
  -0.4604177f, +0.1448928f, +0.1733259f, -0.0153354f
);

vec4 hook() {
    const vec4 r[9][2] = vec4[9][2](
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 1.0f)))
    );

    float sum[4] = biases;
    for (int n = 0; n < 4; n++) {
        for (int i = 0; i < 9; i++) {
            const vec4 k0 = vec4(kernels[n * 8 * 9 + 8 * i + 0], kernels[n * 8 * 9 + 8 * i + 1], kernels[n * 8 * 9 + 8 * i + 2], kernels[n * 8 * 9 + 8 * i + 3]);
            const vec4 k1 = vec4(kernels[n * 8 * 9 + 8 * i + 4], kernels[n * 8 * 9 + 8 * i + 5], kernels[n * 8 * 9 + 8 * i + 6], kernels[n * 8 * 9 + 8 * i + 7]);
            sum[n] += (dot(k0, r[i][0]) + dot(k1, r[i][1]));
        }
    }

    return ACTIVE(vec4(sum[0], sum[1], sum[2], sum[3]) * 0.2000000f + TEX_BIND_L2_TEXOFF(vec2(0.0f, 0.0f)) + TEX_BIND_L3_TEXOFF(vec2(0.0f, 0.0f)));
}

//!HOOK LUMA
//!DESC ARNet b4 Layer8 L1
//!WHEN OUTPUT.w LUMA.w / 1.2 > OUTPUT.h LUMA.h / 1.2 > *
//!BIND TMP1_L0
//!BIND TMP1_L1
//!BIND TMP2_L1
//!BIND FEAT_L1
//!SAVE TMP2_L1
//!COMPONENTS 4

#define ACTIVE(v) (v)

#define TEX_BIND_L0_TEXOFF TMP1_L0_texOff
#define TEX_BIND_L0_TEX TMP1_L0_tex
#define TEX_BIND_L0_POS TMP1_L0_pos
#define TEX_BIND_L0_SIZE TMP1_L0_size
#define TEX_BIND_L0_PT TMP1_L0_pt

#define TEX_BIND_L1_TEXOFF TMP1_L1_texOff
#define TEX_BIND_L1_TEX TMP1_L1_tex
#define TEX_BIND_L1_POS TMP1_L1_pos
#define TEX_BIND_L1_SIZE TMP1_L1_size
#define TEX_BIND_L1_PT TMP1_L1_pt

#define TEX_BIND_L2_TEXOFF TMP2_L1_texOff
#define TEX_BIND_L2_TEX TMP2_L1_tex
#define TEX_BIND_L2_POS TMP2_L1_pos
#define TEX_BIND_L2_SIZE TMP2_L1_size
#define TEX_BIND_L2_PT TMP2_L1_pt

#define TEX_BIND_L3_TEXOFF FEAT_L1_texOff
#define TEX_BIND_L3_TEX FEAT_L1_tex
#define TEX_BIND_L3_POS FEAT_L1_pos
#define TEX_BIND_L3_SIZE FEAT_L1_size
#define TEX_BIND_L3_PT FEAT_L1_pt

const float kernels[288] = float[288](
  +0.2324173f, +0.0116152f, -0.0459893f, -0.1438446f, -0.0014348f, +0.1693521f, +0.0195103f, -0.0255513f,
  -0.1089025f, +0.1478699f, -0.1947659f, -0.1413705f, -0.0678913f, -0.1066125f, -0.1625521f, +0.0237474f,
  +0.3365464f, -0.0496363f, -0.0934205f, -0.0172704f, +0.0276111f, +0.2329471f, -0.2058938f, -0.2180957f,
  +0.0944084f, +0.1653351f, -0.0224276f, -0.1596470f, +0.0509423f, +0.2415929f, -0.1004586f, +0.0096496f,
  +0.1185594f, -0.0475670f, -0.0504756f, -0.3560976f, -0.0040504f, -0.2263637f, +0.2335577f, -0.0918353f,
  +0.2394563f, -0.1058911f, -0.2287224f, -0.2622273f, -0.0231603f, +0.2456118f, -0.1006758f, +0.2212146f,
  +0.1302104f, -0.0418396f, -0.1245502f, -0.0395976f, -0.1154952f, +0.0830629f, +0.2062670f, +0.0091907f,
  +0.1181387f, -0.0200286f, -0.1820370f, -0.1756462f, +0.2632026f, -0.1873002f, +0.1965737f, +0.0013698f,
  +0.1524090f, -0.0221544f, +0.0801839f, -0.0216231f, +0.1823241f, -0.2002810f, -0.2346441f, +0.0490890f,
  +0.0208423f, +0.1023512f, -0.0323767f, +0.2599956f, -0.0172230f, -0.0051799f, -0.0411693f, -0.1858497f,
  +0.4571947f, +0.8127202f, -0.2523163f, +0.0808029f, -0.2387253f, +0.1341361f, +0.1423531f, -0.2164573f,
  +0.3868827f, +0.1092793f, -0.0468595f, +0.1289104f, -0.2176325f, -0.0863699f, +0.0510476f, -0.0229619f,
  +0.4573605f, +0.3092321f, +0.1236366f, -0.5389030f, +0.4922403f, +0.1012524f, -0.2389055f, -0.1155200f,
  -0.4180785f, -0.0453494f, +0.0849411f, +0.6129523f, +0.0426287f, -0.6923915f, +0.4369472f, -0.7394394f,
  +0.0273839f, +0.0880330f, +0.0093176f, -0.3236854f, -0.1305455f, -0.0117323f, -0.2066500f, -0.2744625f,
  +0.0647062f, +0.0739313f, -0.3176830f, +0.0337150f, +0.0277128f, +0.0685726f, -0.4492333f, +0.2937899f,
  +0.2624665f, +0.1515992f, -0.6530867f, +0.2404956f, -0.4585874f, -0.0768957f, -0.0532930f, +0.0050790f,
  +0.2703913f, +0.2470608f, -0.7299410f, -0.3843824f, -0.3046924f, +0.5100819f, -0.1839180f, +0.0542842f,
  +0.3856133f, +0.1376085f, -0.1926227f, -0.4036686f, -0.0509651f, +0.1212701f, +0.4631598f, -0.0647722f,
  +0.1040629f, +0.1800321f, -0.1834780f, -0.6434257f, +0.2398040f, -0.3175103f, -0.2831308f, -0.0235483f,
  +0.2173436f, +0.1276195f, -0.0618797f, -0.5444184f, +0.3656451f, +0.1015725f, -0.0721179f, -0.3126549f,
  -0.2980195f, -0.1850029f, +0.1875413f, +0.7464928f, -0.5193837f, +0.1148455f, +0.0496822f, +0.1223854f,
  -1.2155069f, -0.3039278f, +1.2313486f, -0.5240347f, +0.9950928f, -1.1306716f, +0.1825646f, -0.1447954f,
  +0.5618757f, -0.4029230f, -0.7795845f, +0.4892549f, -0.8349750f, -0.2660153f, -0.1470970f, +1.0600799f,
  +0.0613113f, -0.2405267f, +0.5565574f, -0.5448584f, +0.4309601f, -0.0334602f, +0.5529513f, -0.4762950f,
  -0.1106689f, +0.3941663f, +0.2038034f, -0.1117893f, -0.1320161f, +0.1274382f, +0.0885989f, +0.2343321f,
  +0.5008713f, +0.3824152f, -0.3409505f, -0.0622805f, +0.0649436f, +0.3792627f, +0.0564997f, +0.3807400f,
  +0.2168385f, -0.1600763f, -0.2540344f, +0.0876076f, -0.2159513f, +0.2850648f, -0.0465423f, +0.1635361f,
  +0.5422881f, +0.3064219f, -0.4202337f, -0.3178233f, -0.4250247f, -0.1366653f, -0.5817788f, -0.3212782f,
  +0.1661190f, -0.0276008f, +0.1566111f, +0.0788297f, +0.1549952f, -0.1901932f, -0.5711723f, +0.1655826f,
  +0.6680613f, -0.0939140f, -0.2958013f, +0.1930335f, -0.3858967f, +0.2384156f, -0.0102126f, -0.1510208f,
  +0.3773174f, +0.2558297f, -1.0802488f, -0.6741973f, -0.4002290f, +1.3058987f, +0.4941586f, +0.0268507f,
  -0.1520860f, -0.1750953f, -0.1046908f, +0.9577547f, -0.6577343f, -0.2640751f, -0.1391750f, +0.8729014f,
  -0.1286465f, -0.1396749f, +0.2014924f, +0.1075083f, +0.2197674f, +0.0014911f, -0.3383197f, -0.2601289f,
  -0.2189267f, -0.0276683f, +0.8250248f, -0.0782055f, +0.3418696f, -0.6269402f, -0.2988775f, -0.3102930f,
  -0.1608283f, +0.1907271f, +0.4888725f, +0.1679223f, +0.0419995f, +0.0559983f, -0.2782773f, +0.0182109f
);

const float biases[4] = float[4](
  +0.0034448f, -0.1253913f, +0.2137275f, +0.2542445f
);

vec4 hook() {
    const vec4 r[9][2] = vec4[9][2](
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 1.0f)))
    );

    float sum[4] = biases;
    for (int n = 0; n < 4; n++) {
        for (int i = 0; i < 9; i++) {
            const vec4 k0 = vec4(kernels[n * 8 * 9 + 8 * i + 0], kernels[n * 8 * 9 + 8 * i + 1], kernels[n * 8 * 9 + 8 * i + 2], kernels[n * 8 * 9 + 8 * i + 3]);
            const vec4 k1 = vec4(kernels[n * 8 * 9 + 8 * i + 4], kernels[n * 8 * 9 + 8 * i + 5], kernels[n * 8 * 9 + 8 * i + 6], kernels[n * 8 * 9 + 8 * i + 7]);
            sum[n] += (dot(k0, r[i][0]) + dot(k1, r[i][1]));
        }
    }

    return ACTIVE(vec4(sum[0], sum[1], sum[2], sum[3]) * 0.2000000f + TEX_BIND_L2_TEXOFF(vec2(0.0f, 0.0f)) + TEX_BIND_L3_TEXOFF(vec2(0.0f, 0.0f)));
}

//!HOOK LUMA
//!DESC ARNet b4 Layer9 L0
//!WHEN OUTPUT.w LUMA.w / 1.2 > OUTPUT.h LUMA.h / 1.2 > *
//!BIND TMP2_L0
//!BIND TMP2_L1
//!SAVE TMP1_L0
//!COMPONENTS 4

#define ACTIVE(v) (v)

#define TEX_BIND_L0_TEXOFF TMP2_L0_texOff
#define TEX_BIND_L0_TEX TMP2_L0_tex
#define TEX_BIND_L0_POS TMP2_L0_pos
#define TEX_BIND_L0_SIZE TMP2_L0_size
#define TEX_BIND_L0_PT TMP2_L0_pt

#define TEX_BIND_L1_TEXOFF TMP2_L1_texOff
#define TEX_BIND_L1_TEX TMP2_L1_tex
#define TEX_BIND_L1_POS TMP2_L1_pos
#define TEX_BIND_L1_SIZE TMP2_L1_size
#define TEX_BIND_L1_PT TMP2_L1_pt

const float kernels[288] = float[288](
  -0.0631666f, -0.0592477f, +0.0845263f, -0.0753820f, -0.0282169f, -0.0805716f, -0.0128025f, +0.0919323f,
  -0.1253640f, +0.0785388f, -0.0342622f, +0.1561967f, -0.1072415f, -0.0047226f, -0.0145340f, +0.1951255f,
  -0.0839236f, -0.0268342f, -0.0309945f, +0.0698166f, -0.0253856f, +0.0089677f, -0.0039978f, -0.0009640f,
  +0.1088995f, -0.0898091f, -0.0799968f, +0.0810111f, -0.0733974f, +0.0068257f, -0.1395883f, +0.0727333f,
  +0.0000323f, -0.2009527f, +0.2628994f, +0.1043121f, -0.1034542f, +0.3144899f, +0.2723782f, -0.2700236f,
  +0.0979497f, +0.1021563f, +0.0519540f, -0.0029976f, -0.0931621f, -0.0551567f, +0.1054581f, -0.0344809f,
  +0.0415759f, -0.0066205f, -0.0210237f, -0.0513870f, -0.0170147f, -0.0449898f, -0.0995986f, +0.0332394f,
  -0.0270994f, +0.0508795f, -0.1153278f, -0.0135411f, -0.0790037f, -0.1444713f, -0.0614103f, -0.0733944f,
  -0.0068070f, -0.0359717f, -0.0617006f, +0.0396136f, -0.0561297f, -0.0353054f, -0.0393175f, -0.0492290f,
  -0.0149703f, -0.0212060f, +0.0286695f, -0.0769437f, -0.0020135f, -0.0766002f, -0.0177004f, +0.0518828f,
  -0.1417186f, +0.0046367f, +0.0322091f, +0.1286902f, -0.1295673f, +0.0584879f, -0.0065406f, +0.1724880f,
  -0.1176657f, -0.0061289f, +0.0103423f, +0.0765867f, -0.0234459f, -0.0454103f, -0.0486771f, +0.0850332f,
  -0.0148937f, -0.1139291f, -0.1036227f, -0.0556767f, -0.0275642f, -0.0050077f, -0.0058877f, +0.0981754f,
  +0.2169498f, -0.1177440f, +0.0752032f, +0.3953427f, -0.1838110f, +0.2670864f, -0.1069332f, -0.2208046f,
  +0.0568849f, +0.1109317f, +0.2538520f, -0.1736516f, -0.0643975f, +0.0406147f, +0.3070870f, -0.0599409f,
  +0.0144758f, +0.0038212f, -0.0216725f, -0.0471677f, -0.0182505f, -0.0128875f, -0.0421651f, +0.0180433f,
  +0.0212025f, -0.0175083f, -0.1177696f, -0.0052453f, -0.1245428f, -0.1265655f, -0.1089779f, -0.0475829f,
  -0.0182513f, +0.1100586f, -0.0952701f, +0.0624725f, -0.0757888f, -0.1161540f, -0.0236021f, -0.0573478f,
  -0.0325161f, +0.0059640f, +0.0219930f, -0.0225223f, +0.0232735f, -0.0525780f, -0.0010835f, +0.0112376f,
  -0.1150397f, +0.0288760f, -0.1415921f, +0.1683709f, -0.1711779f, -0.0010658f, +0.0719084f, +0.0604111f,
  -0.0936961f, -0.0264344f, -0.0416973f, +0.0931982f, -0.0163825f, +0.0300384f, -0.0069108f, +0.0098843f,
  -0.0100180f, -0.1453477f, -0.0501790f, +0.0439395f, -0.1842582f, +0.0216310f, -0.0194839f, +0.1820146f,
  +0.1346879f, -0.0601692f, +0.2631986f, +0.1284233f, -0.0554890f, +0.0986561f, +0.0849089f, +0.0601126f,
  +0.1250290f, +0.1164022f, +0.0103005f, +0.0244147f, -0.1202902f, -0.0695269f, +0.1266812f, -0.0653147f,
  +0.1483574f, +0.0158059f, -0.0040250f, -0.0102511f, +0.0245141f, -0.0749751f, -0.2173187f, +0.0059377f,
  -0.1222428f, +0.0441769f, -0.0185331f, +0.0042259f, -0.0474418f, +0.0031546f, +0.0702560f, -0.2309808f,
  +0.0192938f, -0.0107722f, -0.0242151f, +0.0240260f, -0.0928234f, -0.0804164f, -0.0196087f, -0.0234671f,
  -0.0091279f, +0.0074359f, +0.0180356f, -0.0409922f, +0.0484617f, -0.0539657f, -0.0273985f, +0.0139455f,
  -0.0915025f, +0.0199630f, -0.0681518f, +0.1254968f, -0.1595251f, +0.0338025f, +0.0765776f, +0.0418805f,
  -0.1506188f, -0.0388752f, -0.0765285f, +0.1412280f, -0.0442896f, +0.0115475f, -0.0157935f, +0.0395827f,
  -0.0253055f, -0.1441565f, -0.1068937f, -0.0352078f, -0.1564818f, +0.0181471f, +0.0384677f, +0.1279974f,
  +0.1194063f, -0.0270222f, +0.1341819f, +0.3163115f, -0.1083971f, +0.1576833f, -0.0968175f, +0.0847964f,
  +0.2057323f, +0.1272482f, +0.2140984f, -0.1209260f, -0.0839537f, -0.0850517f, +0.2004125f, +0.0069905f,
  +0.0288998f, +0.0222168f, -0.0153475f, -0.0699368f, +0.0457699f, -0.0497868f, -0.0634887f, +0.0270287f,
  +0.1083793f, -0.0436156f, -0.0848219f, +0.1396819f, -0.1406009f, -0.0339492f, -0.1851014f, -0.1945186f,
  -0.0846099f, +0.1718073f, +0.0140513f, -0.0140461f, -0.1012824f, -0.1012206f, +0.0980828f, -0.0660376f
);

const float biases[4] = float[4](
  +0.1127955f, +0.0940167f, +0.0934083f, +0.0765184f
);

vec4 hook() {
    const vec4 r[9][2] = vec4[9][2](
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 1.0f)))
    );

    float sum[4] = biases;
    for (int n = 0; n < 4; n++) {
        for (int i = 0; i < 9; i++) {
            const vec4 k0 = vec4(kernels[n * 8 * 9 + 8 * i + 0], kernels[n * 8 * 9 + 8 * i + 1], kernels[n * 8 * 9 + 8 * i + 2], kernels[n * 8 * 9 + 8 * i + 3]);
            const vec4 k1 = vec4(kernels[n * 8 * 9 + 8 * i + 4], kernels[n * 8 * 9 + 8 * i + 5], kernels[n * 8 * 9 + 8 * i + 6], kernels[n * 8 * 9 + 8 * i + 7]);
            sum[n] += (dot(k0, r[i][0]) + dot(k1, r[i][1]));
        }
    }

    return ACTIVE(vec4(sum[0], sum[1], sum[2], sum[3]));
}

//!HOOK LUMA
//!DESC ACNet b4 Layer10 L0
//!WIDTH LUMA.w 2 *
//!HEIGHT LUMA.h 2 *
//!BIND TMP1_L0
//!COMPONENTS 1

#define TEX_BIND_L0_TEXOFF TMP1_L0_texOff
#define TEX_BIND_L0_TEX TMP1_L0_tex
#define TEX_BIND_L0_POS TMP1_L0_pos
#define TEX_BIND_L0_SIZE TMP1_L0_size
#define TEX_BIND_L0_PT TMP1_L0_pt

vec4 hook() {
    vec2 fcoord = fract(TEX_BIND_L0_POS * TEX_BIND_L0_SIZE);
    vec2 pos = TEX_BIND_L0_POS + (vec2(0.5f) - fcoord) * TEX_BIND_L0_PT;

    ivec2 icoord = ivec2(fcoord * vec2(2.0f));
    int index = icoord.y * 2 + icoord.x;

    vec4 r = TEX_BIND_L0_TEX(pos);

    return vec4(clamp(float[4](r.x, r.y, r.z, r.w)[index], 0.0f, 1.0f), 0.0f, 0.0f, 1.0f);
}
