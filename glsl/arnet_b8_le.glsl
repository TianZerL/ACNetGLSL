//!HOOK LUMA
//!DESC ARNet b8 Layer0 L0
//!WHEN OUTPUT.w LUMA.w / 1.2 > OUTPUT.h LUMA.h / 1.2 > *
//!BIND LUMA
//!SAVE FEAT_L0
//!COMPONENTS 4

#define ACTIVE(v) (v)

#define TEX_BIND_L0_TEXOFF LUMA_texOff
#define TEX_BIND_L0_TEX LUMA_tex
#define TEX_BIND_L0_POS LUMA_pos
#define TEX_BIND_L0_SIZE LUMA_size
#define TEX_BIND_L0_PT LUMA_pt

const float kernels[36] = float[36](
  -0.0435117f, +0.4359987f, -0.4935477f, -0.7465261f, -0.3953478f, +0.0102460f, +0.2166282f, -0.0729262f,
  +0.2299648f, -0.1192049f, -0.1716273f, +0.6286605f, +0.7763299f, -0.6449417f, -0.2993680f, +0.1291222f,
  -0.2799515f, -0.2415737f, -0.4377527f, -0.6731150f, +0.5980521f, +0.3826232f, -0.2140942f, +0.1481732f,
  +0.0735726f, +0.6796825f, -0.3924037f, +0.5794539f, +0.2420534f, -0.3950830f, +0.6356029f, -0.0432307f,
  -0.4033474f, -0.1866918f, -0.2007173f, -0.1075740f
);

const float biases[4] = float[4](
  +0.0085483f, +0.0800460f, -0.0702371f, -0.0629915f
);

vec4 hook() {
    const vec4 r0 = vec4(
        TEX_BIND_L0_TEXOFF(vec2(-1.0f,-1.0f)).x,
        TEX_BIND_L0_TEXOFF(vec2( 0.0f,-1.0f)).x,
        TEX_BIND_L0_TEXOFF(vec2( 1.0f,-1.0f)).x,
        TEX_BIND_L0_TEXOFF(vec2(-1.0f, 0.0f)).x
    );
    const vec4 r4 = vec4(
        TEX_BIND_L0_TEXOFF(vec2( 0.0f, 0.0f)).x,
        TEX_BIND_L0_TEXOFF(vec2( 1.0f, 0.0f)).x,
        TEX_BIND_L0_TEXOFF(vec2(-1.0f, 1.0f)).x,
        TEX_BIND_L0_TEXOFF(vec2( 0.0f, 1.0f)).x
    );
    const float r8 = TEX_BIND_L0_TEXOFF(vec2( 1.0f, 1.0f)).x;

    float sum[4] = biases;
    for(int n = 0; n < 4; n++) {
        const vec4 k0 = vec4(kernels[n * 9 + 0], kernels[n * 9 + 1], kernels[n * 9 + 2], kernels[n * 9 + 3]);
        const vec4 k4 = vec4(kernels[n * 9 + 4], kernels[n * 9 + 5], kernels[n * 9 + 6], kernels[n * 9 + 7]);
        const float k8 = kernels[n * 9 + 8];
        sum[n] += (dot(r0, k0) + dot(r4, k4) + r8 * k8);
    }

    return ACTIVE(vec4(sum[0], sum[1], sum[2], sum[3]));
}

//!HOOK LUMA
//!DESC ARNet b8 Layer0 L1
//!WHEN OUTPUT.w LUMA.w / 1.2 > OUTPUT.h LUMA.h / 1.2 > *
//!BIND LUMA
//!SAVE FEAT_L1
//!COMPONENTS 4

#define ACTIVE(v) (v)

#define TEX_BIND_L0_TEXOFF LUMA_texOff
#define TEX_BIND_L0_TEX LUMA_tex
#define TEX_BIND_L0_POS LUMA_pos
#define TEX_BIND_L0_SIZE LUMA_size
#define TEX_BIND_L0_PT LUMA_pt

const float kernels[36] = float[36](
  +0.4161111f, -0.8645393f, +0.6772934f, -0.1597275f, +0.0442541f, +0.2106176f, +0.2160048f, -0.0812557f,
  -0.2805347f, +0.2012676f, -0.2766437f, +0.1799035f, -0.1465225f, +0.2384073f, -0.3543440f, +0.0557555f,
  +0.2461606f, -0.2754217f, +0.1022345f, -0.4486099f, -0.3938505f, +0.2068817f, +0.7880134f, -0.0744505f,
  -0.1853338f, +0.5048227f, -0.1519411f, -0.5369553f, +0.4664869f, +0.0206369f, -0.1719649f, -0.0066300f,
  +0.5379081f, -0.2464654f, +0.5176432f, +0.3104080f
);

const float biases[4] = float[4](
  -0.0435815f, +0.0316434f, -0.0166685f, -0.0725553f
);

vec4 hook() {
    const vec4 r0 = vec4(
        TEX_BIND_L0_TEXOFF(vec2(-1.0f,-1.0f)).x,
        TEX_BIND_L0_TEXOFF(vec2( 0.0f,-1.0f)).x,
        TEX_BIND_L0_TEXOFF(vec2( 1.0f,-1.0f)).x,
        TEX_BIND_L0_TEXOFF(vec2(-1.0f, 0.0f)).x
    );
    const vec4 r4 = vec4(
        TEX_BIND_L0_TEXOFF(vec2( 0.0f, 0.0f)).x,
        TEX_BIND_L0_TEXOFF(vec2( 1.0f, 0.0f)).x,
        TEX_BIND_L0_TEXOFF(vec2(-1.0f, 1.0f)).x,
        TEX_BIND_L0_TEXOFF(vec2( 0.0f, 1.0f)).x
    );
    const float r8 = TEX_BIND_L0_TEXOFF(vec2( 1.0f, 1.0f)).x;

    float sum[4] = biases;
    for(int n = 0; n < 4; n++) {
        const vec4 k0 = vec4(kernels[n * 9 + 0], kernels[n * 9 + 1], kernels[n * 9 + 2], kernels[n * 9 + 3]);
        const vec4 k4 = vec4(kernels[n * 9 + 4], kernels[n * 9 + 5], kernels[n * 9 + 6], kernels[n * 9 + 7]);
        const float k8 = kernels[n * 9 + 8];
        sum[n] += (dot(r0, k0) + dot(r4, k4) + r8 * k8);
    }

    return ACTIVE(vec4(sum[0], sum[1], sum[2], sum[3]));
}

//!HOOK LUMA
//!DESC ARNet b8 Layer1 L0
//!WHEN OUTPUT.w LUMA.w / 1.2 > OUTPUT.h LUMA.h / 1.2 > *
//!BIND FEAT_L0
//!BIND FEAT_L1
//!SAVE TMP1_L0
//!COMPONENTS 4

#define ACTIVE(v) (max(v, v * 0.2000000f))

#define TEX_BIND_L0_TEXOFF FEAT_L0_texOff
#define TEX_BIND_L0_TEX FEAT_L0_tex
#define TEX_BIND_L0_POS FEAT_L0_pos
#define TEX_BIND_L0_SIZE FEAT_L0_size
#define TEX_BIND_L0_PT FEAT_L0_pt

#define TEX_BIND_L1_TEXOFF FEAT_L1_texOff
#define TEX_BIND_L1_TEX FEAT_L1_tex
#define TEX_BIND_L1_POS FEAT_L1_pos
#define TEX_BIND_L1_SIZE FEAT_L1_size
#define TEX_BIND_L1_PT FEAT_L1_pt

const float kernels[288] = float[288](
  +0.0418582f, -0.1372726f, +0.1169181f, +0.1252683f, -0.0619881f, +0.0533871f, +0.0301996f, -0.2576007f,
  -0.1534542f, +0.4083067f, -0.2103156f, +0.3080727f, +0.3676229f, -0.3964670f, +0.0088179f, +0.0460860f,
  -0.1594440f, +0.2324037f, -0.2397887f, +0.3433021f, +0.3992763f, -0.1652101f, +0.2571156f, +0.0723849f,
  +0.3091087f, +0.1560776f, -0.0360233f, +0.1320147f, +0.0527994f, -0.0242939f, +0.1249419f, +0.5093604f,
  -0.2134983f, +0.0490514f, -0.0019250f, -0.3346365f, -0.1976851f, -0.2388145f, -0.3058546f, +0.2728378f,
  +0.0974589f, -0.0074499f, -0.0286053f, -0.1356083f, +0.0784988f, +0.3999844f, +0.1293811f, -0.1471334f,
  +0.2656754f, -0.0118132f, +0.0823009f, +0.0562299f, -0.1329125f, +0.3111679f, -0.0982554f, -0.1806827f,
  -0.1047316f, +0.2329840f, -0.2548135f, -0.1309641f, -0.1778712f, -0.2309163f, -0.2426244f, +0.2537357f,
  -0.0613851f, +0.3541264f, -0.0016672f, +0.1905430f, +0.2467038f, +0.0091431f, -0.0382779f, +0.1887325f,
  +0.1853183f, +0.2473996f, -0.0979868f, -0.1577239f, -0.0975819f, +0.6958241f, -0.0642799f, +0.0700403f,
  +0.5517095f, -0.2086188f, +0.2431289f, -0.4439848f, +0.1243796f, +0.4900833f, -0.4070803f, -0.1621993f,
  +0.4800348f, -0.0851036f, +0.0101054f, -0.4194167f, -0.1160706f, +0.7681496f, -0.1596367f, -0.1657995f,
  -0.1509772f, -0.2733366f, -0.3860777f, +0.2581951f, -0.1028138f, -0.5127642f, +0.0886043f, -0.0690813f,
  -0.3847619f, -0.0050214f, +0.5206167f, +0.0588193f, +0.2599960f, -0.2175688f, +0.4049695f, +0.0482991f,
  +0.0033266f, +0.0349453f, +0.3400868f, +0.0203385f, +0.2802849f, -0.1714487f, +0.5162153f, -0.3263645f,
  -0.0859028f, +0.0447060f, +0.1297538f, -0.1089879f, +0.1556139f, -0.3845668f, +0.2514396f, +0.0307431f,
  -0.1310285f, +0.1334437f, -0.0505518f, +0.2927248f, -0.0804616f, -0.0821111f, +0.1424285f, +0.2961733f,
  -0.0649251f, +0.0154617f, +0.1187479f, -0.0293671f, +0.3164679f, -0.7199895f, +0.2068567f, -0.0190164f,
  -0.2207885f, +0.1483322f, +0.0208886f, -0.0531095f, -0.1531716f, -0.1712961f, +0.0327693f, -0.1614560f,
  -0.2509173f, -0.0873979f, +0.0616208f, -0.1545266f, +0.0142016f, -0.2233945f, +0.2204591f, -0.2123062f,
  -0.0741913f, +0.4517430f, -0.2451615f, +0.3318577f, -0.1296263f, -0.6040694f, +0.0624702f, -0.4819529f,
  +0.0513890f, +0.0914405f, +0.1163906f, -0.4462261f, -0.0068843f, +0.0018927f, -0.0105834f, -0.1894268f,
  -0.0166580f, +0.3234631f, +0.2246258f, -0.0931318f, +0.0087196f, +0.3292341f, +0.1331647f, -0.3989674f,
  -0.1550266f, +0.4618391f, +0.1276613f, +0.0912696f, +0.1411872f, -0.2420243f, -0.5414231f, +0.0443990f,
  -0.2065628f, -0.0537378f, -0.3743377f, -0.2848799f, -0.2110050f, +0.1915335f, +0.1946563f, -0.2447825f,
  +0.0568309f, -0.3180825f, +0.0970622f, -0.1162473f, +0.1295349f, -0.1283461f, -0.0615359f, +0.2856388f,
  -0.3884908f, -0.0631099f, -0.2708772f, -0.0113950f, +0.1914657f, -0.1835613f, +0.1955244f, -0.1227749f,
  -0.1982298f, -0.4679464f, +0.2072082f, -0.1592538f, +0.2962019f, +0.2738512f, +0.1479287f, -0.0402651f,
  +0.1178690f, -0.0683264f, +0.3874983f, +0.3863402f, -0.2286755f, +0.9316166f, +0.2121755f, -0.4347788f,
  +0.0176074f, +0.3183036f, +0.0346433f, +0.4826438f, +0.0621314f, -0.0696000f, -0.2044442f, -0.2248469f,
  -0.1369111f, -0.1625444f, +0.0786755f, +0.1524414f, +0.1216509f, -0.3336356f, +0.1744256f, +0.1326685f,
  +0.0223081f, -0.0444418f, -0.4323261f, +0.8305076f, -0.3802216f, +0.0243122f, +0.0155833f, +0.0455032f,
  +0.3280983f, +0.2530357f, +0.0390016f, +0.0613055f, +0.3879057f, -0.0147768f, -0.0481575f, -0.0729137f,
  -0.1419840f, +0.1940709f, +0.1007890f, -0.1184958f, -0.1510545f, +0.1489512f, +0.0400116f, +0.1166279f,
  -0.0746603f, +0.0242439f, -0.0582594f, +0.1083478f, +0.1069901f, +0.1549633f, +0.0959646f, -0.0180512f,
  -0.2261638f, -0.1744812f, -0.1808428f, -0.3450850f, +0.1243938f, +0.0425851f, -0.0168613f, -0.0030589f
);

const float biases[4] = float[4](
  -0.0354018f, +0.0138416f, +0.1939462f, +0.0970164f
);

vec4 hook() {
    const vec4 r[9][2] = vec4[9][2](
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 1.0f)))
    );

    float sum[4] = biases;
    for (int n = 0; n < 4; n++) {
        for (int i = 0; i < 9; i++) {
            const vec4 k0 = vec4(kernels[n * 8 * 9 + 8 * i + 0], kernels[n * 8 * 9 + 8 * i + 1], kernels[n * 8 * 9 + 8 * i + 2], kernels[n * 8 * 9 + 8 * i + 3]);
            const vec4 k1 = vec4(kernels[n * 8 * 9 + 8 * i + 4], kernels[n * 8 * 9 + 8 * i + 5], kernels[n * 8 * 9 + 8 * i + 6], kernels[n * 8 * 9 + 8 * i + 7]);
            sum[n] += (dot(k0, r[i][0]) + dot(k1, r[i][1]));
        }
    }

    return ACTIVE(vec4(sum[0], sum[1], sum[2], sum[3]));
}

//!HOOK LUMA
//!DESC ARNet b8 Layer1 L1
//!WHEN OUTPUT.w LUMA.w / 1.2 > OUTPUT.h LUMA.h / 1.2 > *
//!BIND FEAT_L0
//!BIND FEAT_L1
//!SAVE TMP1_L1
//!COMPONENTS 4

#define ACTIVE(v) (max(v, v * 0.2000000f))

#define TEX_BIND_L0_TEXOFF FEAT_L0_texOff
#define TEX_BIND_L0_TEX FEAT_L0_tex
#define TEX_BIND_L0_POS FEAT_L0_pos
#define TEX_BIND_L0_SIZE FEAT_L0_size
#define TEX_BIND_L0_PT FEAT_L0_pt

#define TEX_BIND_L1_TEXOFF FEAT_L1_texOff
#define TEX_BIND_L1_TEX FEAT_L1_tex
#define TEX_BIND_L1_POS FEAT_L1_pos
#define TEX_BIND_L1_SIZE FEAT_L1_size
#define TEX_BIND_L1_PT FEAT_L1_pt

const float kernels[288] = float[288](
  +0.0475754f, +0.0209188f, +0.1844413f, +0.0654786f, -0.0061180f, +0.7318651f, +0.2357401f, +0.1970304f,
  +0.0298809f, -0.0067553f, +0.3807135f, +0.0797445f, +0.0141610f, +0.1867917f, -0.1347968f, +0.0038238f,
  +0.0220586f, -0.0971569f, +0.1565774f, +0.2240960f, +0.0675036f, +0.4303420f, +0.0434426f, -0.0277460f,
  +0.1415575f, -0.1129244f, -0.1199620f, +0.0103819f, -0.0109983f, +0.0191848f, +0.1330365f, -0.0453363f,
  -0.0581912f, -0.4503616f, +0.0710490f, +0.0864283f, +0.3910753f, -0.0200826f, +0.2205561f, +0.1798211f,
  -0.2346408f, +0.0238231f, +0.2238597f, +0.1319575f, -0.1601461f, -0.4176238f, -0.0167169f, -0.1897488f,
  +0.0630402f, +0.2372441f, +0.3413886f, +0.3159216f, -0.3326777f, +0.8156258f, -0.2089292f, +0.3891194f,
  -0.2033599f, -0.2282794f, -0.1447980f, +0.0456520f, +0.0359699f, +0.0335262f, -0.1884157f, +0.1559065f,
  +0.0154387f, +0.3847854f, -0.1776609f, +0.0382175f, +0.1378872f, +0.0379364f, -0.1761986f, +0.1299788f,
  -0.0351729f, +0.0922685f, -0.2608481f, -0.3854207f, +0.2751478f, -0.0744454f, +0.0045438f, -0.0268421f,
  +0.0013967f, -0.2773501f, -0.0420942f, +0.1388007f, +0.1940745f, +0.2141271f, +0.1818490f, +0.1505276f,
  +0.3982432f, -0.4596580f, +0.1253355f, -0.7245575f, +0.0628513f, +0.9707142f, +0.0070902f, +0.2599805f,
  -0.0388567f, -0.2593578f, -0.2433860f, +0.0389752f, -0.0776514f, -0.4510941f, -0.1521140f, +0.0614166f,
  -0.1053137f, -0.4204915f, -0.2576053f, +0.0967285f, +0.1128904f, +0.4767202f, +0.1450178f, +0.2513749f,
  -0.0250659f, -0.4580546f, -0.1098573f, +0.3298568f, -0.1658205f, +0.1508668f, -0.1706905f, -0.0617838f,
  +0.1453414f, +0.1750861f, -0.2499521f, +0.1883040f, +0.1488128f, +0.1172689f, +0.0591216f, +0.1269520f,
  +0.2050592f, +0.3734126f, -0.0818769f, +0.2130730f, -0.1843978f, -0.2354568f, -0.0533465f, +0.0933114f,
  +0.0503324f, +0.0645866f, -0.3458437f, +0.1339434f, +0.0646961f, +0.5310847f, +0.0402679f, +0.2247404f,
  -0.1488542f, -0.1525710f, -0.0978741f, +0.0219158f, +0.3248263f, -0.5172861f, +0.1773199f, +0.2677688f,
  +0.0478557f, +0.1157200f, -0.4324766f, -0.1369736f, +0.2428318f, -0.3418853f, +0.0034905f, +0.3150474f,
  -0.0336749f, +0.1365160f, -0.0442693f, -0.0086280f, -0.0080075f, -0.0527209f, +0.3974325f, +0.1400247f,
  -0.0741718f, +0.3310941f, +0.1733328f, -0.0175987f, +0.4945346f, +0.1746485f, -0.3389137f, +0.1767782f,
  -0.2479237f, +0.2250529f, -0.2621320f, +0.3850120f, -0.0218883f, -0.5449862f, -0.1478020f, -0.0459579f,
  -0.0282725f, -0.0512868f, -0.2326099f, +0.2570636f, +0.0215979f, -0.0537109f, -0.0400390f, +0.1080476f,
  -0.1115221f, -0.0833692f, +0.0138123f, -0.2337130f, +0.0103460f, -0.0129813f, -0.0403079f, +0.0125743f,
  +0.0027051f, -0.0015473f, +0.0185938f, +0.0329337f, +0.0472195f, +0.1010846f, +0.2764293f, +0.0041698f,
  -0.0764766f, -0.0158804f, +0.0625375f, -0.0965577f, -0.2301272f, +0.3020257f, +0.0611486f, -0.0034645f,
  -0.1184721f, +0.1078966f, -0.0122986f, -0.1576875f, -0.3956775f, +0.2432454f, +0.0573716f, -0.2967156f,
  -0.1935189f, +0.0295716f, -0.3532274f, -0.1096110f, +0.1038333f, -0.4246300f, -0.4813007f, -0.0192490f,
  -0.2786901f, +0.0037039f, +0.2568891f, +0.0548821f, -0.1817305f, +0.1015943f, +0.4301784f, +0.2033822f,
  -0.1812360f, -0.0084414f, +0.0742496f, -0.2140882f, -0.0295857f, +0.1839319f, -0.2225820f, -0.0685283f,
  -0.1192590f, -0.0595977f, +0.4430092f, -0.3631407f, +0.2020177f, -0.3645268f, -0.3093465f, +0.2234913f,
  +0.2839413f, -0.4412920f, -0.2017907f, -0.0820441f, +0.2054647f, -0.2041020f, +0.0900710f, +0.3074709f,
  +0.0117681f, +0.0099025f, -0.0616482f, +0.0715909f, -0.2656350f, -0.1848464f, -0.1971734f, -0.0292151f,
  -0.2036033f, +0.1565103f, +0.3116923f, -0.2615732f, +0.0622832f, -0.2385733f, -0.0956409f, -0.1779566f,
  +0.4258944f, -0.1834670f, +0.0509656f, +0.1436841f, -0.2870187f, +0.4651180f, -0.1910228f, -0.0944171f
);

const float biases[4] = float[4](
  +0.1245269f, +0.0181751f, +0.0551173f, +0.0733121f
);

vec4 hook() {
    const vec4 r[9][2] = vec4[9][2](
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 1.0f)))
    );

    float sum[4] = biases;
    for (int n = 0; n < 4; n++) {
        for (int i = 0; i < 9; i++) {
            const vec4 k0 = vec4(kernels[n * 8 * 9 + 8 * i + 0], kernels[n * 8 * 9 + 8 * i + 1], kernels[n * 8 * 9 + 8 * i + 2], kernels[n * 8 * 9 + 8 * i + 3]);
            const vec4 k1 = vec4(kernels[n * 8 * 9 + 8 * i + 4], kernels[n * 8 * 9 + 8 * i + 5], kernels[n * 8 * 9 + 8 * i + 6], kernels[n * 8 * 9 + 8 * i + 7]);
            sum[n] += (dot(k0, r[i][0]) + dot(k1, r[i][1]));
        }
    }

    return ACTIVE(vec4(sum[0], sum[1], sum[2], sum[3]));
}

//!HOOK LUMA
//!DESC ARNet b8 Layer2 L0
//!WHEN OUTPUT.w LUMA.w / 1.2 > OUTPUT.h LUMA.h / 1.2 > *
//!BIND TMP1_L0
//!BIND TMP1_L1
//!BIND FEAT_L0
//!SAVE TMP2_L0
//!COMPONENTS 4

#define ACTIVE(v) (v)

#define TEX_BIND_L0_TEXOFF TMP1_L0_texOff
#define TEX_BIND_L0_TEX TMP1_L0_tex
#define TEX_BIND_L0_POS TMP1_L0_pos
#define TEX_BIND_L0_SIZE TMP1_L0_size
#define TEX_BIND_L0_PT TMP1_L0_pt

#define TEX_BIND_L1_TEXOFF TMP1_L1_texOff
#define TEX_BIND_L1_TEX TMP1_L1_tex
#define TEX_BIND_L1_POS TMP1_L1_pos
#define TEX_BIND_L1_SIZE TMP1_L1_size
#define TEX_BIND_L1_PT TMP1_L1_pt

#define TEX_BIND_L2_TEXOFF FEAT_L0_texOff
#define TEX_BIND_L2_TEX FEAT_L0_tex
#define TEX_BIND_L2_POS FEAT_L0_pos
#define TEX_BIND_L2_SIZE FEAT_L0_size
#define TEX_BIND_L2_PT FEAT_L0_pt

const float kernels[288] = float[288](
  +0.0715091f, +0.0724594f, +0.3892428f, +0.0528741f, +0.2394339f, +0.4152848f, +0.1957000f, -0.1424982f,
  -0.1010037f, -0.3484895f, +0.3173255f, -0.1160903f, +0.1802566f, +0.1095254f, -0.1911858f, +0.4158326f,
  +0.1883423f, +0.0015110f, +0.0305359f, -0.1103061f, +0.1474797f, +0.0986885f, -0.2177866f, +0.1863889f,
  -0.1146494f, +0.0268067f, +0.2712693f, +0.0014852f, +0.1959974f, +0.1075020f, +0.3188850f, -0.0758843f,
  -0.0382625f, +0.3001923f, -0.1359755f, -0.4125823f, +0.2614120f, -0.4342021f, +0.3032389f, +0.0339238f,
  +0.1925640f, -0.1822578f, -0.2566234f, +0.1966362f, -0.1877168f, -0.0597581f, +0.0732358f, +0.1166094f,
  +0.2233593f, -0.0822808f, -0.1720356f, -0.0778654f, +0.0840082f, +0.1054592f, +0.4614724f, +0.0348733f,
  -0.1020518f, +0.2161286f, -0.2633290f, +0.1358373f, +0.1775315f, +0.3324255f, +0.1077322f, +0.1173364f,
  -0.0745220f, +0.3630772f, -0.0169761f, +0.2197444f, +0.0039616f, +0.0612282f, +0.0605136f, +0.0515701f,
  -0.2727258f, +0.1778313f, -0.1810159f, +0.0082005f, -0.2619320f, +0.0991535f, -0.0002528f, +0.0405645f,
  +0.0326301f, -0.1378415f, +0.1060075f, -0.0609546f, -0.1492916f, +0.0323932f, +0.0441930f, -0.2705097f,
  -0.1165048f, +0.1521578f, -0.1683486f, +0.1434521f, -0.1316375f, -0.2009078f, -0.1426657f, +0.1204494f,
  -0.0883911f, -0.1579616f, -0.0906803f, +0.0069739f, -0.2229321f, -0.2237957f, -0.3142206f, +0.3746184f,
  +0.0306729f, -0.4737077f, +0.0702510f, -0.2132011f, +0.2530958f, +0.0152992f, -0.4267130f, -0.5012361f,
  -0.2597944f, -0.0909789f, +0.1699459f, +0.0403919f, +0.2151071f, -0.0878517f, -0.0557453f, -0.1366302f,
  +0.0313426f, -0.1545733f, +0.0068781f, -0.2109411f, +0.0026761f, +0.0038321f, +0.0475447f, -0.0104121f,
  +0.1015208f, -0.1170277f, +0.1929426f, -0.4118532f, +0.1232183f, +0.2462683f, -0.1930682f, +0.0288801f,
  +0.2071268f, -0.0375684f, +0.0556178f, -0.1334378f, +0.0624949f, +0.1803639f, +0.2554240f, -0.0626784f,
  +0.1116645f, +0.2092464f, +0.1286417f, +0.1480242f, -0.0539185f, +0.0371190f, +0.1098517f, -0.2995892f,
  -0.1029090f, -0.2379180f, +0.0581647f, +0.1857744f, -0.3018320f, +0.2260333f, +0.0100015f, -0.5752208f,
  -0.0474311f, -0.1706259f, -0.0706825f, -0.0254654f, -0.3407270f, +0.0379247f, +0.1393487f, -0.0055510f,
  -0.1563465f, +0.0878428f, +0.4621042f, -0.0491031f, +0.0705198f, +0.3997656f, +0.1286002f, +0.0093494f,
  -0.0514496f, -0.4834158f, +0.2713952f, +0.3022966f, +0.1368584f, +0.5054401f, +0.3097544f, -0.7688683f,
  -0.3856668f, -0.1243322f, +0.0465913f, -0.0135927f, -0.0537911f, +0.0332930f, +0.1501782f, -0.4628634f,
  -0.4394991f, -0.1007632f, +0.3608706f, +0.0274269f, +0.0930874f, +0.0729813f, -0.3247575f, -0.2080886f,
  -0.4681493f, -0.1860898f, -0.3299976f, -0.2546208f, -0.3346176f, -0.2153785f, -0.3185791f, +0.2127196f,
  -0.0186820f, -0.0182367f, -0.1071106f, -0.1081567f, +0.1401448f, -0.0364690f, +0.0361565f, +0.0628427f,
  -0.0701670f, -0.3235833f, -0.2718416f, +0.0200747f, +0.0647509f, -0.1920069f, -0.0952123f, -0.0036885f,
  +0.0495126f, +0.1476490f, +0.0173440f, -0.1451598f, +0.1298571f, -0.1313547f, -0.1578498f, +0.2205271f,
  -0.2325690f, -0.1195993f, +0.0581612f, -0.1249106f, -0.2067204f, +0.1536816f, -0.1114630f, -0.1198395f,
  -0.1532770f, +0.0118478f, +0.5873466f, -0.4787685f, +0.2723421f, -0.0095844f, -0.4995939f, +0.1025624f,
  -0.0188029f, -0.6714935f, -0.0471407f, -0.1765910f, -0.0834695f, -0.1846174f, +0.0641178f, +0.2208873f,
  +0.0596570f, -0.3662770f, -0.0107808f, -0.2084560f, -0.0230264f, -0.0079370f, +0.1437017f, +0.0667207f,
  +0.0010648f, -0.1114331f, +0.1177237f, -0.2707639f, +0.0068655f, -0.1706559f, +0.1097198f, -0.1800348f,
  +0.0497954f, +0.2631421f, +0.3855013f, -0.0684138f, +0.1708518f, +0.2314599f, +0.1161848f, -0.1591830f,
  -0.0188472f, +0.2703072f, +0.0538087f, +0.3056859f, +0.2183088f, +0.0129432f, +0.3001588f, +0.0105545f
);

const float biases[4] = float[4](
  +0.1306281f, +0.2306357f, +0.1446520f, -0.0099089f
);

vec4 hook() {
    const vec4 r[9][2] = vec4[9][2](
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 1.0f)))
    );

    float sum[4] = biases;
    for (int n = 0; n < 4; n++) {
        for (int i = 0; i < 9; i++) {
            const vec4 k0 = vec4(kernels[n * 8 * 9 + 8 * i + 0], kernels[n * 8 * 9 + 8 * i + 1], kernels[n * 8 * 9 + 8 * i + 2], kernels[n * 8 * 9 + 8 * i + 3]);
            const vec4 k1 = vec4(kernels[n * 8 * 9 + 8 * i + 4], kernels[n * 8 * 9 + 8 * i + 5], kernels[n * 8 * 9 + 8 * i + 6], kernels[n * 8 * 9 + 8 * i + 7]);
            sum[n] += (dot(k0, r[i][0]) + dot(k1, r[i][1]));
        }
    }

    return ACTIVE(vec4(sum[0], sum[1], sum[2], sum[3]) * 0.2000000f + TEX_BIND_L2_TEXOFF(vec2(0.0f, 0.0f)));
}

//!HOOK LUMA
//!DESC ARNet b8 Layer2 L1
//!WHEN OUTPUT.w LUMA.w / 1.2 > OUTPUT.h LUMA.h / 1.2 > *
//!BIND TMP1_L0
//!BIND TMP1_L1
//!BIND FEAT_L1
//!SAVE TMP2_L1
//!COMPONENTS 4

#define ACTIVE(v) (v)

#define TEX_BIND_L0_TEXOFF TMP1_L0_texOff
#define TEX_BIND_L0_TEX TMP1_L0_tex
#define TEX_BIND_L0_POS TMP1_L0_pos
#define TEX_BIND_L0_SIZE TMP1_L0_size
#define TEX_BIND_L0_PT TMP1_L0_pt

#define TEX_BIND_L1_TEXOFF TMP1_L1_texOff
#define TEX_BIND_L1_TEX TMP1_L1_tex
#define TEX_BIND_L1_POS TMP1_L1_pos
#define TEX_BIND_L1_SIZE TMP1_L1_size
#define TEX_BIND_L1_PT TMP1_L1_pt

#define TEX_BIND_L2_TEXOFF FEAT_L1_texOff
#define TEX_BIND_L2_TEX FEAT_L1_tex
#define TEX_BIND_L2_POS FEAT_L1_pos
#define TEX_BIND_L2_SIZE FEAT_L1_size
#define TEX_BIND_L2_PT FEAT_L1_pt

const float kernels[288] = float[288](
  +0.1616693f, +0.1913507f, +0.2267240f, -0.0639930f, +0.1714131f, -0.1066942f, +0.1074653f, +0.0075008f,
  -0.2217888f, -0.2608449f, +0.2018236f, +0.0884259f, -0.3116973f, +0.0784453f, -0.1230531f, -0.3318101f,
  -0.0820163f, -0.0901307f, -0.2878483f, +0.0139666f, -0.0226183f, -0.3240553f, -0.0412764f, +0.0980789f,
  +0.0652793f, +0.1484551f, +0.0466132f, -0.9283167f, +0.5747753f, -0.0815369f, +0.1929325f, +0.3717273f,
  -0.1636353f, -0.4243961f, -0.2249978f, -0.2567652f, -0.1881971f, -0.0101987f, +0.1131146f, -0.3532868f,
  -0.1651783f, -0.2307133f, +0.0322882f, +0.0958068f, -0.0062107f, -0.2216902f, -0.1013531f, -0.2746436f,
  -0.0771565f, -0.2448528f, +0.3073259f, -0.4040934f, +0.0516695f, +0.1700620f, +0.1326458f, -0.0402107f,
  -0.2343768f, +0.0432745f, -0.2002269f, -0.6729898f, -0.0322904f, +0.1286271f, -0.1770328f, +0.0883605f,
  -0.2316936f, -0.4771436f, +0.1249173f, -0.4443652f, +0.2654818f, +0.3095061f, -0.2827232f, -0.0399238f,
  +0.0632301f, -0.2688339f, -0.4965393f, -0.1865828f, +0.3228081f, +0.0544940f, +0.1923592f, +0.2051416f,
  +0.0490539f, +0.4848599f, +0.3184904f, -0.0968331f, -0.0189153f, +0.2691945f, +0.3840022f, -0.1392669f,
  +0.2342166f, +0.3716115f, +0.1766456f, -0.1205496f, -0.2822420f, +0.2456082f, +0.0097696f, +0.1022158f,
  -0.0413961f, -0.0940345f, -0.0019141f, -0.1638352f, +0.0963713f, -0.1013898f, -0.2652488f, +0.1674054f,
  -0.0129859f, +0.7057548f, +0.0139106f, -0.3041995f, +0.1336721f, -0.4287968f, +0.0362204f, +0.6151493f,
  +0.5096000f, +0.1175193f, -0.1069810f, -0.1345072f, -0.2868947f, +0.0959275f, +0.1448017f, -0.3550194f,
  -0.2693228f, -0.4222273f, +0.1072551f, -0.0897976f, +0.1766477f, -0.0900337f, +0.0066543f, -0.2634819f,
  +0.0897634f, +0.2738796f, -0.2503647f, -0.3607623f, +0.1053653f, -0.0138077f, +0.0315680f, +0.1840378f,
  -0.0781756f, +0.3202655f, +0.0802582f, -0.0516632f, -0.3129247f, +0.0819462f, -0.1086325f, -0.0502661f,
  -0.4157183f, -0.2017367f, +0.1494050f, -0.2114743f, +0.1145580f, -0.1218402f, -0.1231789f, +0.3055663f,
  -0.2983541f, -0.4171971f, +0.3332151f, -0.0417084f, +0.2184755f, -0.1158099f, -0.5410010f, +0.0184944f,
  -0.1877150f, -0.0846536f, +0.1529886f, +0.0391466f, +0.0985900f, +0.1346105f, -0.0925719f, +0.0806129f,
  +0.0406047f, -0.4366483f, -0.9249793f, -0.1677589f, +0.2691359f, +0.1127897f, -0.1443887f, +0.0894075f,
  -0.2232945f, -0.0367386f, +0.0341270f, -0.5170084f, +0.0698920f, -0.1453289f, +0.1520169f, +0.2565290f,
  +0.3443261f, +0.1412818f, -0.0804627f, +0.1932080f, -0.2749512f, -0.1361123f, +0.1665614f, +0.1441429f,
  +0.0314509f, -0.0181874f, -0.1309326f, +0.1625144f, +0.1713887f, +0.0526201f, -0.1954799f, +0.0446946f,
  -0.2505858f, +0.0104945f, -0.0249123f, -0.0145411f, -0.3099296f, -0.0553487f, -0.0072280f, +0.0659002f,
  +0.1672886f, +0.4419818f, +0.0755206f, +0.1905093f, -0.2250566f, -0.0477283f, +0.1338623f, +0.0135551f,
  +0.2555701f, -0.3298883f, +0.5254185f, -0.2572517f, +0.1158534f, +0.3869026f, -0.1944559f, +0.2327256f,
  -0.1972093f, -0.0326054f, -0.1391437f, -0.0184559f, -0.0208216f, -0.2032155f, -0.4583897f, +0.2308263f,
  +0.1173608f, -0.0845941f, -0.0696113f, +0.0007409f, -0.3756708f, +0.0094371f, -0.3112047f, +0.1055365f,
  +0.1970402f, -0.4630943f, -0.3267249f, +0.2135596f, -0.1987364f, +0.1917121f, +0.4074385f, -0.6735195f,
  -0.0195904f, -0.2431684f, +0.2446897f, +0.5192116f, -0.0897601f, +0.2003410f, -0.1260909f, -0.5772766f,
  -0.3655417f, -0.1140455f, +0.1333302f, +0.1016463f, -0.1225990f, -0.2243571f, +0.2691461f, +0.1248568f,
  -0.0846562f, -0.2237928f, -0.1798933f, +0.1921741f, +0.1629735f, +0.2277925f, -0.2717836f, -0.4997891f,
  -0.3683821f, -0.5806957f, -0.3161206f, -0.0403157f, -0.3312625f, -0.4077052f, -0.1889538f, -0.3334177f,
  -0.1104169f, -0.4350269f, +0.0545143f, -0.1604705f, +0.1603234f, -0.1729375f, -0.4506216f, +0.1012166f
);

const float biases[4] = float[4](
  +0.0834020f, -0.0948895f, +0.2120394f, -0.0476877f
);

vec4 hook() {
    const vec4 r[9][2] = vec4[9][2](
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 1.0f)))
    );

    float sum[4] = biases;
    for (int n = 0; n < 4; n++) {
        for (int i = 0; i < 9; i++) {
            const vec4 k0 = vec4(kernels[n * 8 * 9 + 8 * i + 0], kernels[n * 8 * 9 + 8 * i + 1], kernels[n * 8 * 9 + 8 * i + 2], kernels[n * 8 * 9 + 8 * i + 3]);
            const vec4 k1 = vec4(kernels[n * 8 * 9 + 8 * i + 4], kernels[n * 8 * 9 + 8 * i + 5], kernels[n * 8 * 9 + 8 * i + 6], kernels[n * 8 * 9 + 8 * i + 7]);
            sum[n] += (dot(k0, r[i][0]) + dot(k1, r[i][1]));
        }
    }

    return ACTIVE(vec4(sum[0], sum[1], sum[2], sum[3]) * 0.2000000f + TEX_BIND_L2_TEXOFF(vec2(0.0f, 0.0f)));
}

//!HOOK LUMA
//!DESC ARNet b8 Layer3 L0
//!WHEN OUTPUT.w LUMA.w / 1.2 > OUTPUT.h LUMA.h / 1.2 > *
//!BIND TMP2_L0
//!BIND TMP2_L1
//!SAVE TMP1_L0
//!COMPONENTS 4

#define ACTIVE(v) (max(v, v * 0.2000000f))

#define TEX_BIND_L0_TEXOFF TMP2_L0_texOff
#define TEX_BIND_L0_TEX TMP2_L0_tex
#define TEX_BIND_L0_POS TMP2_L0_pos
#define TEX_BIND_L0_SIZE TMP2_L0_size
#define TEX_BIND_L0_PT TMP2_L0_pt

#define TEX_BIND_L1_TEXOFF TMP2_L1_texOff
#define TEX_BIND_L1_TEX TMP2_L1_tex
#define TEX_BIND_L1_POS TMP2_L1_pos
#define TEX_BIND_L1_SIZE TMP2_L1_size
#define TEX_BIND_L1_PT TMP2_L1_pt

const float kernels[288] = float[288](
  +0.3469112f, -0.4194259f, +0.1998507f, +0.0543072f, -0.0195414f, +0.2340663f, +0.0966464f, +0.1410886f,
  -0.2588052f, -0.2368803f, +0.0272485f, -0.2526475f, -0.2445319f, -0.2851697f, +0.1860977f, -0.0217472f,
  -0.2227838f, +0.0404087f, +0.3605687f, +0.5414005f, -0.1221586f, -0.3265373f, -0.0503946f, -0.2337386f,
  +0.1733188f, +0.0674436f, -0.4185541f, +0.5231472f, +0.1268489f, +0.6069962f, -0.2020251f, -0.1119373f,
  +0.0931162f, +0.3717541f, +0.1133818f, +0.0750563f, -0.2291054f, +0.5239677f, -0.7510377f, -0.3086556f,
  -0.2579428f, -0.1547825f, -0.3337237f, -0.3634695f, +0.2367709f, +0.1333410f, -0.3427800f, -0.6161167f,
  -0.0842915f, +0.0126275f, -0.1225518f, -0.0882133f, -0.0563921f, -0.1414133f, -0.3633231f, +0.1793749f,
  -0.1607783f, +0.0125016f, +0.4561455f, -0.4322149f, +0.1277947f, -0.0156673f, +0.0507908f, -0.3392833f,
  +0.2625699f, -0.2222101f, +0.2052807f, +0.2000748f, +0.5651845f, +0.0347862f, +0.2020754f, +0.2354586f,
  -0.1751399f, -0.0878315f, -0.1091330f, -0.1180782f, +0.1976777f, -0.4509686f, -0.3464127f, +0.0658209f,
  +0.3521761f, -0.0989547f, +0.2370071f, -0.4605647f, -0.0442638f, +0.2418372f, -0.2510152f, +0.0459047f,
  -0.1715702f, +0.1370828f, +0.0958757f, -0.1311553f, -0.2478858f, +0.0975949f, -0.1990103f, -0.1253500f,
  -0.1999735f, +0.0692874f, +0.0371174f, +0.0292468f, +0.1147076f, -0.5216013f, -0.0825130f, +0.0832712f,
  +0.4752738f, -0.2287515f, -0.0278205f, -0.0554222f, +0.2468869f, -0.0769469f, +0.5508896f, -0.1525106f,
  +0.0713623f, +0.3553081f, -0.0807309f, -0.1164831f, +0.1540122f, -0.0108527f, +0.1015816f, +0.1718860f,
  +0.0387210f, -0.1688048f, +0.0181615f, -0.1282405f, +0.1399063f, -0.2498110f, +0.3790542f, +0.1732435f,
  +0.2004005f, +0.3454917f, +0.2165961f, +0.6641921f, -0.2659790f, -0.3567808f, +0.9378586f, -0.0694866f,
  +0.0771670f, -0.1231754f, +0.1582092f, -0.1011847f, +0.2311431f, -0.0532887f, +0.5474147f, +0.4315230f,
  -0.3026971f, -0.1013532f, -0.5954875f, +0.0084312f, +0.1487741f, -0.0331836f, -0.1745826f, -0.2220991f,
  -0.3028186f, +0.1117232f, +0.0924920f, +0.2513430f, +0.2399220f, -0.0076066f, +0.4618029f, +0.1636437f,
  +0.1537456f, -0.0864490f, +0.4863569f, +0.0280294f, +0.0467774f, -0.2453218f, -0.2001348f, -0.2696806f,
  +0.0872088f, +0.4833892f, -0.2251584f, -0.0697624f, -0.4090744f, +0.7454830f, -0.5591285f, -0.5732529f,
  -0.4154225f, -0.0543934f, -1.1964972f, -0.3682586f, -0.0121130f, +0.3455988f, +0.2213655f, -0.1542415f,
  -0.2318580f, -0.1173909f, +0.0440694f, +0.0508655f, +0.2542228f, +0.1189269f, +0.0583442f, -0.1054777f,
  +0.0097720f, -0.1850706f, +0.5415142f, +0.5688705f, -0.1655075f, +0.7678022f, -0.1911595f, +0.2937480f,
  -0.0664635f, +0.1600289f, +0.0462599f, +0.1706018f, -0.2717608f, +0.2361420f, +0.1710516f, -0.2389286f,
  +0.1164682f, +0.0075122f, +0.0051894f, -0.2239561f, +0.1691175f, -0.0038668f, +0.1778232f, +0.1279213f,
  -0.1347681f, -0.0205487f, -0.1130155f, +0.2554561f, +0.0495164f, +0.2159908f, -0.0197053f, +0.0808300f,
  -0.1185993f, +0.0221353f, +0.0481634f, +0.1531943f, +0.0612256f, +0.0849865f, -0.0209250f, +0.0613695f,
  -0.1113694f, -0.1406904f, +0.2551192f, +0.0146894f, -0.0593216f, +0.0325912f, -0.0406208f, -0.0150510f,
  +0.0565604f, +0.0742296f, +0.3838169f, +0.0869400f, -0.0269665f, +0.1932542f, +0.0336821f, -0.0791445f,
  +0.2149146f, +0.1743106f, -0.5203729f, +0.1081066f, -0.1754986f, +0.2332955f, +0.0445935f, +0.1239747f,
  -0.3016462f, +0.0293120f, +0.1162559f, -0.4669712f, -0.1653088f, +0.0059709f, -0.0217475f, +0.3759640f,
  +0.9126092f, +0.5656987f, +0.6146632f, +0.4123567f, -0.0923462f, +0.9562310f, -0.0829407f, +0.2869569f,
  +0.3523335f, -0.0082090f, -0.3538251f, +1.0844187f, +0.2361119f, +0.2231888f, -0.2932687f, +0.0878767f,
  +0.1809054f, -0.2432487f, -0.2674460f, -0.6067296f, -0.1441123f, +0.0496065f, +0.4120320f, +0.2067910f
);

const float biases[4] = float[4](
  -0.0391490f, +0.0256282f, -0.0806047f, -0.0096816f
);

vec4 hook() {
    const vec4 r[9][2] = vec4[9][2](
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 1.0f)))
    );

    float sum[4] = biases;
    for (int n = 0; n < 4; n++) {
        for (int i = 0; i < 9; i++) {
            const vec4 k0 = vec4(kernels[n * 8 * 9 + 8 * i + 0], kernels[n * 8 * 9 + 8 * i + 1], kernels[n * 8 * 9 + 8 * i + 2], kernels[n * 8 * 9 + 8 * i + 3]);
            const vec4 k1 = vec4(kernels[n * 8 * 9 + 8 * i + 4], kernels[n * 8 * 9 + 8 * i + 5], kernels[n * 8 * 9 + 8 * i + 6], kernels[n * 8 * 9 + 8 * i + 7]);
            sum[n] += (dot(k0, r[i][0]) + dot(k1, r[i][1]));
        }
    }

    return ACTIVE(vec4(sum[0], sum[1], sum[2], sum[3]));
}

//!HOOK LUMA
//!DESC ARNet b8 Layer3 L1
//!WHEN OUTPUT.w LUMA.w / 1.2 > OUTPUT.h LUMA.h / 1.2 > *
//!BIND TMP2_L0
//!BIND TMP2_L1
//!SAVE TMP1_L1
//!COMPONENTS 4

#define ACTIVE(v) (max(v, v * 0.2000000f))

#define TEX_BIND_L0_TEXOFF TMP2_L0_texOff
#define TEX_BIND_L0_TEX TMP2_L0_tex
#define TEX_BIND_L0_POS TMP2_L0_pos
#define TEX_BIND_L0_SIZE TMP2_L0_size
#define TEX_BIND_L0_PT TMP2_L0_pt

#define TEX_BIND_L1_TEXOFF TMP2_L1_texOff
#define TEX_BIND_L1_TEX TMP2_L1_tex
#define TEX_BIND_L1_POS TMP2_L1_pos
#define TEX_BIND_L1_SIZE TMP2_L1_size
#define TEX_BIND_L1_PT TMP2_L1_pt

const float kernels[288] = float[288](
  -0.1355371f, +0.1597881f, -0.2917975f, -0.1222274f, -0.0621884f, -0.0248990f, -0.1478205f, -0.1021207f,
  +0.0033035f, +0.1663473f, -0.3890191f, -0.1768707f, +0.0957366f, +0.3501103f, -0.2481933f, +0.0764052f,
  -0.0663495f, +0.1024846f, +0.1131861f, -0.2089966f, -0.1904845f, +0.0830659f, +0.2777040f, -0.0765627f,
  -0.2522063f, +0.0851581f, +0.2744940f, -0.1869060f, +0.0986882f, -0.0209957f, -0.3091588f, +0.3090172f,
  -0.0314572f, +0.0088299f, +0.0084655f, -0.3077257f, +0.8149487f, -0.1574705f, -0.0850921f, +0.6338227f,
  +0.1918933f, -0.2517214f, -0.0142676f, +0.0996685f, +0.2344652f, +0.3697135f, +0.7226635f, -0.1517723f,
  -0.0808217f, -0.0501602f, +0.1441656f, -0.0047133f, -0.2873894f, +0.2953472f, -0.0029116f, -0.3232316f,
  +0.7504914f, -0.1106357f, +0.1793605f, +0.4263217f, +0.6244245f, -0.2789542f, +0.1944675f, +0.0532689f,
  +0.0654772f, +0.1537436f, -0.5425902f, +0.9109053f, +0.5445331f, -0.1800372f, +0.0860061f, +0.0421773f,
  -0.3778550f, +0.0363364f, +0.2597454f, -0.2078828f, +0.2647698f, +0.0587104f, -0.1500471f, +0.5674496f,
  +0.4820589f, +0.2298937f, +0.3175762f, +0.1565112f, +0.2690806f, +0.1043503f, +0.1281839f, +0.3101177f,
  +0.3930210f, +0.1654256f, +0.3692068f, -0.6544213f, -0.6995257f, +0.0426789f, -0.2341776f, +0.1648373f,
  +0.3464347f, -0.3483261f, +0.0851412f, +0.1712513f, +0.0070594f, +0.2246543f, -0.3328236f, -0.3197664f,
  +0.0306918f, +0.1080660f, +0.4189634f, +0.0635079f, +0.3091244f, -0.1280290f, -0.2228283f, -0.3565814f,
  -0.4624284f, +0.0826062f, +0.2211890f, -0.0931730f, +0.1491281f, +0.0143392f, +0.2916701f, +0.1962418f,
  +0.2186565f, -0.4039666f, -0.0462749f, +0.2766373f, +0.0712246f, -0.0677239f, +0.0481097f, +0.0274620f,
  +0.0308401f, +0.4212579f, -0.1239428f, -0.2220627f, +0.1806078f, -0.0706447f, +0.0426442f, +0.0062445f,
  -0.1509125f, -0.1955186f, -0.9221887f, +0.4186873f, +0.1115163f, -0.0062504f, +0.5763721f, +0.0513809f,
  +0.2539454f, +0.0210051f, +0.7430696f, +0.7783535f, -0.1738911f, -0.2848590f, +0.1364327f, +0.1347216f,
  +0.5379235f, -0.1376027f, +0.7711802f, +0.4092951f, +0.7190348f, +0.0412982f, +0.2385933f, -0.0974117f,
  +0.7405401f, -0.0009711f, +0.5237939f, +0.3952551f, +0.0493961f, -0.2013387f, +0.3110461f, +0.0194915f,
  +0.4953928f, +0.0141212f, +0.4114146f, +0.5415492f, +0.3634616f, +0.1596374f, -0.4854108f, -0.1340688f,
  -0.2398050f, -0.0190471f, -0.2049047f, +0.7856388f, +0.4745262f, +0.0788817f, -0.0256971f, -0.4040651f,
  +0.4244581f, -0.0892807f, +0.4410400f, -0.1359597f, -0.0611518f, +0.2916319f, +0.2507096f, -0.3075417f,
  +0.3123678f, +0.0794737f, +0.0242773f, +0.2098947f, -0.1732835f, +0.2368085f, -0.1373922f, +0.4222313f,
  -0.2910962f, -0.2908462f, -0.1642212f, +0.5586010f, +0.1049072f, +0.2354662f, +0.2535717f, +0.2892867f,
  -0.0740396f, -0.1317585f, +0.9582605f, -0.4758268f, -0.4764501f, +0.5606250f, -0.3351291f, +0.1426290f,
  +0.2921190f, -0.0264908f, +0.0338031f, +0.1001543f, -0.1489999f, +0.1180157f, +0.1937488f, -0.1332791f,
  +0.0413831f, +0.1075701f, -0.1326791f, -0.0297031f, -0.3136281f, -0.1596260f, +0.0884141f, -0.1408327f,
  -0.0023539f, +0.3449064f, -0.1123070f, +0.1307719f, +0.1104554f, -0.1681291f, -0.0616233f, -0.1327592f,
  -0.1417141f, -0.1485278f, +0.2412026f, +0.2277623f, -0.5461602f, +0.5911642f, +0.1124161f, -0.4412853f,
  -0.0125207f, -0.0032924f, -0.4207839f, +0.1867391f, -0.4501902f, -0.1024341f, -0.1206115f, +0.1405494f,
  -0.1054955f, +0.2435686f, -0.1681558f, -0.1478720f, -0.1820301f, -0.0104686f, +0.0104321f, +0.0141991f,
  -0.1355157f, -0.2040212f, +0.4198011f, -0.0272186f, -0.1267857f, +0.3674709f, +0.1904030f, -0.0763891f,
  -0.1632641f, -0.3412423f, -0.5141046f, -0.0497431f, -0.3101225f, +0.0848675f, +0.3566053f, +0.3984271f,
  -0.2765023f, -0.2256894f, -0.3052962f, +0.1319771f, -0.0174296f, -0.1413700f, +0.3044138f, -0.0966706f
);

const float biases[4] = float[4](
  +0.0853960f, +0.0386407f, -0.4981543f, +0.0035366f
);

vec4 hook() {
    const vec4 r[9][2] = vec4[9][2](
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 1.0f)))
    );

    float sum[4] = biases;
    for (int n = 0; n < 4; n++) {
        for (int i = 0; i < 9; i++) {
            const vec4 k0 = vec4(kernels[n * 8 * 9 + 8 * i + 0], kernels[n * 8 * 9 + 8 * i + 1], kernels[n * 8 * 9 + 8 * i + 2], kernels[n * 8 * 9 + 8 * i + 3]);
            const vec4 k1 = vec4(kernels[n * 8 * 9 + 8 * i + 4], kernels[n * 8 * 9 + 8 * i + 5], kernels[n * 8 * 9 + 8 * i + 6], kernels[n * 8 * 9 + 8 * i + 7]);
            sum[n] += (dot(k0, r[i][0]) + dot(k1, r[i][1]));
        }
    }

    return ACTIVE(vec4(sum[0], sum[1], sum[2], sum[3]));
}

//!HOOK LUMA
//!DESC ARNet b8 Layer4 L0
//!WHEN OUTPUT.w LUMA.w / 1.2 > OUTPUT.h LUMA.h / 1.2 > *
//!BIND TMP1_L0
//!BIND TMP1_L1
//!BIND TMP2_L0
//!SAVE TMP2_L0
//!COMPONENTS 4

#define ACTIVE(v) (v)

#define TEX_BIND_L0_TEXOFF TMP1_L0_texOff
#define TEX_BIND_L0_TEX TMP1_L0_tex
#define TEX_BIND_L0_POS TMP1_L0_pos
#define TEX_BIND_L0_SIZE TMP1_L0_size
#define TEX_BIND_L0_PT TMP1_L0_pt

#define TEX_BIND_L1_TEXOFF TMP1_L1_texOff
#define TEX_BIND_L1_TEX TMP1_L1_tex
#define TEX_BIND_L1_POS TMP1_L1_pos
#define TEX_BIND_L1_SIZE TMP1_L1_size
#define TEX_BIND_L1_PT TMP1_L1_pt

#define TEX_BIND_L2_TEXOFF TMP2_L0_texOff
#define TEX_BIND_L2_TEX TMP2_L0_tex
#define TEX_BIND_L2_POS TMP2_L0_pos
#define TEX_BIND_L2_SIZE TMP2_L0_size
#define TEX_BIND_L2_PT TMP2_L0_pt

const float kernels[288] = float[288](
  -0.2907774f, -0.1793701f, +0.1096858f, -0.1728374f, -0.1881085f, -0.2505007f, +0.4083588f, -0.0874388f,
  -0.5534593f, +0.3122578f, +0.6905544f, -0.4193005f, +0.0166732f, -0.2197805f, -0.0178002f, -0.2544286f,
  -0.6824292f, -0.0575615f, +0.5474948f, -0.5644198f, +0.1376761f, -0.3620365f, -0.2189776f, -0.0416292f,
  +0.2976609f, +0.0794468f, -0.1216485f, -0.1225097f, +0.0759577f, -0.2756519f, -0.1250040f, +0.0937615f,
  +0.4259680f, +0.0057658f, -0.3436805f, +0.2828061f, +0.1237043f, +0.9337474f, +0.1199112f, +0.1699843f,
  -0.2740651f, -0.1331259f, +1.0792537f, +0.0601787f, +0.4239706f, -0.1447332f, -0.5084702f, +0.0511580f,
  -0.0616037f, -0.1158496f, -0.0146962f, -0.0826558f, -0.0786654f, -0.0700699f, +0.0431163f, +0.1781111f,
  +0.0217815f, +0.1648465f, -0.3316712f, -0.0367454f, +0.1190195f, +0.3507876f, -0.0652080f, +0.2872838f,
  -0.5689486f, -0.1645074f, +0.0401220f, -0.0207063f, +0.4113496f, -0.0566746f, -0.1097385f, -0.1448571f,
  +0.1873919f, +0.1016337f, -0.1353171f, -0.2412767f, +0.1817832f, +0.2282016f, +0.0871697f, +0.1714623f,
  +0.2614853f, +0.0851491f, -0.1368535f, +0.6445966f, +0.0813646f, -0.3413118f, +0.1086190f, -0.1735586f,
  +0.0377744f, +0.0901202f, +0.0582700f, +0.0511652f, -0.2985424f, +0.2867793f, +0.1704188f, -0.1017865f,
  +0.1202999f, -0.0897707f, -0.0814055f, +0.2282401f, +0.2371779f, +0.1980261f, +0.4588048f, +0.0265504f,
  +0.5421359f, +0.2960305f, -0.3020485f, -0.1101116f, +0.2053953f, +0.1089587f, -0.0626246f, +0.2641843f,
  +0.0918662f, +0.3044065f, -0.2364723f, -0.2368692f, -0.3038840f, +0.1694903f, -0.1101999f, +0.1136527f,
  -0.1523758f, -0.0029723f, +0.0036621f, -0.1119081f, +0.1157970f, -0.2661024f, +0.0863263f, +0.0202161f,
  -0.1194243f, +0.0948923f, +0.0266690f, -0.1927440f, +0.1988452f, +0.0056140f, +0.1607005f, +0.1791645f,
  +0.1066582f, +0.1151920f, -0.1810851f, +0.1907936f, +0.0687122f, +0.0137666f, -0.0531454f, -0.0828412f,
  -0.1669896f, +0.1735561f, +0.1125380f, -0.0508439f, +0.4011264f, +0.2780219f, -0.0230881f, +0.5582216f,
  +0.0498996f, +0.2274446f, +0.2699390f, -0.2279098f, -0.5663054f, -0.0376412f, +0.0843399f, +0.3117315f,
  +0.1141900f, -0.2771423f, +0.0737484f, -0.4707280f, -0.5161822f, +0.2853074f, -0.1401295f, +0.3743070f,
  +0.0363109f, -0.0801277f, +0.1535991f, +0.0443386f, +0.1209898f, -0.1026329f, +0.1341795f, -0.2011220f,
  -0.0448666f, +0.3340743f, -0.0910016f, +0.1307960f, +0.0159040f, -0.3663375f, -0.0923205f, -0.0124179f,
  -0.5727483f, -0.2681546f, +0.0436162f, -0.5714516f, -0.6003755f, -0.0935417f, -0.2548918f, +0.0370536f,
  -0.1201379f, +0.1234107f, +0.2260532f, -0.1547556f, -0.1620814f, -0.2819776f, -0.1159262f, +0.0085797f,
  +0.1558349f, -0.2567594f, -0.1379914f, -0.1305730f, -0.2249947f, -0.3152273f, -0.4887218f, +0.0432450f,
  -0.0754100f, -0.3285706f, +0.0152547f, +0.0090568f, -0.2021398f, -0.2273902f, -0.4189762f, +0.3896298f,
  +0.2622566f, -0.1282689f, -0.0583257f, +0.2485693f, -0.1688984f, -0.3870321f, +0.8845373f, +0.0376299f,
  -0.0062505f, -0.2662637f, -0.1343334f, +0.3154978f, +0.2747657f, +0.0668100f, -0.4392315f, +0.0690914f,
  -0.0758706f, +0.0915736f, +0.1084618f, -0.4997394f, -0.0188676f, +0.0298859f, +0.0448345f, +0.0130376f,
  -0.3162948f, -0.1157428f, -0.0467730f, -0.0798460f, -0.0152196f, -0.1674471f, +0.0076124f, -0.0388885f,
  +0.3181893f, -0.4922377f, +0.0814230f, -0.0982729f, -0.0421767f, -0.1523751f, -0.5101008f, -0.1174431f,
  +0.3110196f, -0.6034835f, -0.1599673f, -0.1299748f, -0.2787524f, -0.0363869f, -0.5082299f, -0.0473479f,
  -0.0899109f, -0.0252701f, +0.1035010f, -0.0766193f, -0.0061383f, -0.0776198f, -0.2661044f, -0.1321659f,
  +0.0516351f, -0.1539571f, +0.0977637f, -0.0276528f, -0.4102814f, +0.3407217f, -0.8519529f, -0.0559285f,
  -0.4184964f, -0.6000327f, -0.0505322f, -0.1229916f, -0.5356182f, +0.1193495f, -0.3499714f, -0.0012524f
);

const float biases[4] = float[4](
  -0.0184806f, +0.0639215f, +0.1675652f, -0.0679806f
);

vec4 hook() {
    const vec4 r[9][2] = vec4[9][2](
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 1.0f)))
    );

    float sum[4] = biases;
    for (int n = 0; n < 4; n++) {
        for (int i = 0; i < 9; i++) {
            const vec4 k0 = vec4(kernels[n * 8 * 9 + 8 * i + 0], kernels[n * 8 * 9 + 8 * i + 1], kernels[n * 8 * 9 + 8 * i + 2], kernels[n * 8 * 9 + 8 * i + 3]);
            const vec4 k1 = vec4(kernels[n * 8 * 9 + 8 * i + 4], kernels[n * 8 * 9 + 8 * i + 5], kernels[n * 8 * 9 + 8 * i + 6], kernels[n * 8 * 9 + 8 * i + 7]);
            sum[n] += (dot(k0, r[i][0]) + dot(k1, r[i][1]));
        }
    }

    return ACTIVE(vec4(sum[0], sum[1], sum[2], sum[3]) * 0.2000000f + TEX_BIND_L2_TEXOFF(vec2(0.0f, 0.0f)));
}

//!HOOK LUMA
//!DESC ARNet b8 Layer4 L1
//!WHEN OUTPUT.w LUMA.w / 1.2 > OUTPUT.h LUMA.h / 1.2 > *
//!BIND TMP1_L0
//!BIND TMP1_L1
//!BIND TMP2_L1
//!SAVE TMP2_L1
//!COMPONENTS 4

#define ACTIVE(v) (v)

#define TEX_BIND_L0_TEXOFF TMP1_L0_texOff
#define TEX_BIND_L0_TEX TMP1_L0_tex
#define TEX_BIND_L0_POS TMP1_L0_pos
#define TEX_BIND_L0_SIZE TMP1_L0_size
#define TEX_BIND_L0_PT TMP1_L0_pt

#define TEX_BIND_L1_TEXOFF TMP1_L1_texOff
#define TEX_BIND_L1_TEX TMP1_L1_tex
#define TEX_BIND_L1_POS TMP1_L1_pos
#define TEX_BIND_L1_SIZE TMP1_L1_size
#define TEX_BIND_L1_PT TMP1_L1_pt

#define TEX_BIND_L2_TEXOFF TMP2_L1_texOff
#define TEX_BIND_L2_TEX TMP2_L1_tex
#define TEX_BIND_L2_POS TMP2_L1_pos
#define TEX_BIND_L2_SIZE TMP2_L1_size
#define TEX_BIND_L2_PT TMP2_L1_pt

const float kernels[288] = float[288](
  -0.2622468f, -0.3010353f, +0.1059399f, +0.2392757f, +0.5493376f, +0.7142236f, +0.3738570f, +0.1551031f,
  -0.4010681f, +0.0673778f, -0.0562335f, -0.0616680f, -0.3036706f, -0.2932278f, +0.2545074f, +0.5025427f,
  +0.1349231f, -0.1226289f, +0.1494114f, +0.0505554f, +0.0697321f, +0.1432821f, +0.2271831f, +0.0634796f,
  -0.2201344f, +0.1091256f, -0.2327366f, +0.3997372f, +0.4728631f, +0.2495994f, -0.2439520f, +0.1324682f,
  +0.6037979f, -0.1435428f, -0.7096081f, +0.3083614f, +0.1975816f, +0.2438834f, +0.0427317f, +0.8180749f,
  +0.4317688f, +0.3272318f, -0.0915467f, -0.1648194f, +0.0693882f, +0.3531283f, +0.2469816f, +0.0054557f,
  +0.0182233f, +0.0252262f, +0.0450108f, -0.1611458f, +0.1645410f, -0.1778738f, -0.2342578f, -0.2300197f,
  +0.2631520f, +0.0903867f, -0.1145782f, +0.0487615f, +0.5043435f, +0.1814662f, +0.1353333f, +0.2677302f,
  +0.6987801f, +0.6436647f, -0.1328998f, -0.0562778f, +0.4570759f, -0.0429312f, -0.0338498f, -0.0289086f,
  +0.0044533f, -0.1704218f, +0.1214074f, +0.2667347f, +0.5408248f, +0.0650805f, +0.0996740f, -0.1550335f,
  -0.0304855f, -0.3750359f, -0.4094517f, +0.1048399f, +0.0377420f, -0.4978574f, -0.0585160f, +0.1149690f,
  +0.2249232f, -0.0552807f, -0.5166841f, -0.2854879f, -0.3656445f, +0.4334974f, +0.3289187f, +0.2676069f,
  +0.4197742f, +0.0254917f, -0.1434272f, +0.1995184f, -0.2641524f, -0.2496284f, +0.4129867f, -0.1742582f,
  -0.6016219f, -0.2965626f, -0.0474061f, -0.2011530f, +0.2266194f, -0.4094567f, +0.0834921f, +0.1940885f,
  +0.0796412f, -0.2132529f, -1.1657284f, -0.1311544f, -0.0480636f, +0.4184836f, -0.1313549f, -0.0106416f,
  +0.0140467f, +0.0889106f, +0.0115312f, -0.0429883f, +0.1856856f, -0.1881314f, +0.1044800f, +0.2352878f,
  +0.3468359f, -0.0419411f, +0.3446737f, -0.0138564f, -0.0885288f, +0.2315607f, -0.0402790f, -0.1320627f,
  -0.1727523f, -0.1476595f, -0.1343125f, +0.0928542f, -0.4578458f, -0.3304216f, +0.0113297f, +0.2285006f,
  +0.3008832f, +0.0648235f, +0.0036441f, +0.2146616f, +0.1067016f, +0.4266937f, -0.3921003f, -0.0145374f,
  -0.0385972f, -0.3369665f, +0.1361242f, +0.2451217f, -0.2193439f, -0.0535168f, -0.2566213f, -0.1399051f,
  -0.2199087f, +0.1128793f, +0.3128149f, -0.6124142f, -0.3849201f, -0.1471041f, -0.2690892f, +0.0556910f,
  +0.4613860f, -0.4142631f, +0.1068474f, +0.0424258f, -0.2330846f, -0.1523523f, -0.1272956f, -0.4567322f,
  -0.1782298f, -0.5355984f, +0.6511256f, +0.0629737f, -0.0315405f, -0.4729446f, -0.1107828f, -0.5716457f,
  +0.0812144f, -0.8117363f, -0.0908213f, -0.0991409f, -0.3691635f, +0.3029455f, -0.0519811f, -0.1544454f,
  +0.2365718f, -0.0494439f, -0.4146810f, +0.0223937f, +0.0497046f, +0.1380590f, +0.0247067f, +0.0808746f,
  +0.1094202f, -0.1470571f, +0.1092516f, -0.1440426f, -0.2521542f, +0.4983937f, +0.1084738f, -0.1608380f,
  -0.4481887f, -0.1187943f, -0.0203810f, -0.2008189f, -0.8834886f, +0.4367716f, +0.1681093f, -0.0251171f,
  -0.1462540f, -0.1141046f, +0.1311761f, -0.3134339f, -0.7439765f, -0.2659839f, +0.7641233f, +0.6547300f,
  -0.0207702f, +0.4046509f, +0.3089622f, +0.5363428f, -0.4142964f, +0.0446339f, -0.1864923f, -0.3779786f,
  -0.2049420f, +0.0301948f, +0.3947076f, -0.4180323f, -0.1142318f, -0.0545986f, +0.0772548f, +0.2228830f,
  -0.0546691f, +0.3200938f, -0.2554478f, -0.1495329f, -0.4672782f, +0.0142430f, +0.2786850f, -0.0043383f,
  -0.0117203f, +0.3299927f, +0.7048363f, -0.2454495f, -0.4793137f, +0.3033921f, -0.1917778f, -0.3584739f,
  +0.1150622f, -0.2109364f, +0.0662033f, -0.3957541f, -0.1709816f, +0.4828801f, +0.4144551f, +0.2183267f,
  +0.1952175f, -0.0446781f, -0.1425992f, +0.0932180f, +0.2214762f, +0.0464673f, +0.5916675f, +0.4160677f,
  +0.2890952f, +0.3105174f, +0.5950822f, -0.2326592f, +0.3957792f, +0.2556711f, +0.8625591f, +0.0177216f,
  +0.2599193f, +0.1334589f, +0.0011247f, -0.0597070f, +0.1858917f, -0.0368099f, +0.6902491f, +0.3416779f
);

const float biases[4] = float[4](
  -0.0622976f, +0.0473496f, +0.1845324f, -0.0368212f
);

vec4 hook() {
    const vec4 r[9][2] = vec4[9][2](
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 1.0f)))
    );

    float sum[4] = biases;
    for (int n = 0; n < 4; n++) {
        for (int i = 0; i < 9; i++) {
            const vec4 k0 = vec4(kernels[n * 8 * 9 + 8 * i + 0], kernels[n * 8 * 9 + 8 * i + 1], kernels[n * 8 * 9 + 8 * i + 2], kernels[n * 8 * 9 + 8 * i + 3]);
            const vec4 k1 = vec4(kernels[n * 8 * 9 + 8 * i + 4], kernels[n * 8 * 9 + 8 * i + 5], kernels[n * 8 * 9 + 8 * i + 6], kernels[n * 8 * 9 + 8 * i + 7]);
            sum[n] += (dot(k0, r[i][0]) + dot(k1, r[i][1]));
        }
    }

    return ACTIVE(vec4(sum[0], sum[1], sum[2], sum[3]) * 0.2000000f + TEX_BIND_L2_TEXOFF(vec2(0.0f, 0.0f)));
}

//!HOOK LUMA
//!DESC ARNet b8 Layer5 L0
//!WHEN OUTPUT.w LUMA.w / 1.2 > OUTPUT.h LUMA.h / 1.2 > *
//!BIND TMP2_L0
//!BIND TMP2_L1
//!SAVE TMP1_L0
//!COMPONENTS 4

#define ACTIVE(v) (max(v, v * 0.2000000f))

#define TEX_BIND_L0_TEXOFF TMP2_L0_texOff
#define TEX_BIND_L0_TEX TMP2_L0_tex
#define TEX_BIND_L0_POS TMP2_L0_pos
#define TEX_BIND_L0_SIZE TMP2_L0_size
#define TEX_BIND_L0_PT TMP2_L0_pt

#define TEX_BIND_L1_TEXOFF TMP2_L1_texOff
#define TEX_BIND_L1_TEX TMP2_L1_tex
#define TEX_BIND_L1_POS TMP2_L1_pos
#define TEX_BIND_L1_SIZE TMP2_L1_size
#define TEX_BIND_L1_PT TMP2_L1_pt

const float kernels[288] = float[288](
  -0.1492517f, -0.1373781f, +0.1726929f, -0.1474040f, +0.1947396f, -0.1439491f, -0.1943384f, -0.2928668f,
  +0.0125538f, -0.0282110f, +0.3160417f, +0.0146458f, -0.2222152f, +0.4953368f, +0.2949522f, -0.1772213f,
  +0.1796733f, -0.3268923f, +0.0220703f, +0.0673633f, +0.1213420f, +0.3802151f, +0.1013543f, -0.1449210f,
  +0.1275069f, +0.1508180f, +0.1967122f, -0.1156281f, -0.0858850f, -0.2590717f, +0.3627451f, +0.0029990f,
  -0.1673940f, -0.3040814f, +0.4517212f, +0.0405336f, -0.4067419f, +0.1489992f, +0.5685118f, -0.2242953f,
  +0.0653081f, -0.0707312f, -0.4291394f, +0.1235215f, -0.1755121f, -0.0460987f, +0.0473571f, -0.0668268f,
  -0.1143059f, -0.1095732f, +0.0994483f, -0.0085271f, -0.0282680f, +0.2031963f, +0.2908013f, +0.1436873f,
  +0.1761004f, +0.0577902f, -0.0092302f, +0.2316047f, -0.0725518f, +0.7333550f, -0.2927359f, +0.2299418f,
  +0.0078627f, +0.0323993f, -0.2211009f, -0.5111006f, +0.1047191f, -0.0594046f, +0.2108765f, -0.1487416f,
  -0.0367321f, -0.2077418f, +0.0403391f, +0.0896994f, -0.1625518f, -0.2568783f, +0.0238113f, -0.0120661f,
  +0.1041442f, -0.1728574f, +0.0221915f, -0.0543425f, -0.4005958f, +0.1361001f, +0.3594934f, +0.1253176f,
  +0.1283711f, +0.0095061f, +0.0890229f, -0.0443956f, +0.0648982f, -0.1702501f, -0.2335879f, -0.0624647f,
  -0.1722140f, -0.1264956f, -0.0797603f, -0.0445378f, -0.4655039f, +0.0994654f, -0.3493437f, -0.3250720f,
  -0.4095677f, -0.2370562f, +0.1361748f, +0.3888136f, +0.1857931f, +0.0633859f, -0.2471130f, -0.4327220f,
  -0.2121183f, -0.0063900f, +0.0661393f, -0.0974749f, -0.0623273f, -0.0893479f, -0.2877052f, -0.6039701f,
  -0.1157999f, +0.2082766f, +0.4207843f, -0.2402533f, +0.0049370f, +0.9436257f, -0.5224857f, +0.4681719f,
  +0.0173434f, +0.1439035f, +0.1441472f, +0.0328409f, -0.0184840f, +0.4535642f, -0.7119466f, +0.1389582f,
  -0.1438424f, -0.0994248f, -0.0245787f, -0.3957618f, +0.1481895f, -0.0919836f, -0.4507907f, -0.0210982f,
  +0.1656179f, -0.1476067f, -0.0716962f, -0.1400427f, +0.0728940f, -0.0002894f, -0.1625125f, -0.0200488f,
  +0.3206971f, -0.0108434f, +0.3204560f, -0.4312197f, +0.1386875f, -0.1661212f, -0.5777139f, -0.1248163f,
  +0.0681502f, +0.0686879f, +0.1865389f, +0.1313561f, +0.1703905f, +0.1845639f, -0.3069933f, +0.1184223f,
  -0.1682109f, -0.1740625f, -0.0071574f, -0.6483200f, +0.1704951f, -0.5972857f, +0.5649217f, -0.2383938f,
  -0.3554751f, +0.1645249f, +0.3321504f, +0.6109902f, +0.2064254f, -0.5622765f, +0.2513315f, -0.1211829f,
  +0.0870582f, -0.0055970f, +0.2768132f, +0.2691229f, +0.0002119f, -0.0921052f, -0.0828273f, -0.1406388f,
  -0.0977127f, -0.1789939f, +0.2551790f, -0.2981641f, +0.2402159f, -0.7096162f, +0.5002031f, -0.4522765f,
  +0.1605504f, -0.3982332f, -0.2007782f, +0.5580897f, -0.1746981f, +0.0787732f, -0.3186635f, -0.1479161f,
  -0.0058021f, -0.1415949f, +0.0971843f, +0.2002843f, +0.2008628f, +0.2609562f, -0.3872223f, -0.0550895f,
  +0.1813353f, -0.2218681f, +0.0810908f, +0.1715643f, +0.2410490f, +0.4198096f, +0.0533333f, +0.3067019f,
  +0.6172115f, -0.3389173f, +0.3195283f, -0.3171721f, -0.3327352f, +0.1448385f, +0.2214971f, +0.3293932f,
  +0.1320588f, +0.1674826f, +0.1484761f, -0.0487197f, -0.3157634f, -0.2707764f, -0.1054500f, -0.0322981f,
  +0.1971457f, -0.3885163f, -0.5021110f, -0.1866788f, +0.1103158f, -0.1930777f, +0.1946727f, -0.1284711f,
  -0.4431296f, -0.5826100f, -0.2270180f, -0.7896877f, +0.0713868f, -0.0142125f, +0.7580789f, +0.2525945f,
  +0.3059421f, +0.1387062f, +0.2689674f, -0.0498865f, +0.0819648f, -0.0507868f, -0.2764973f, -0.0592983f,
  +0.0572836f, +0.2237916f, +0.0327786f, -0.1781954f, -0.0693219f, -0.1305897f, +0.0236679f, -0.3469867f,
  +0.1280205f, +0.1072518f, +0.0755849f, +0.3191108f, -0.3565530f, -0.3675592f, -0.2972541f, -0.1842958f,
  -0.2228070f, -0.0437012f, -0.0045793f, +0.1887729f, -0.1305862f, -0.1468282f, +0.0241498f, -0.1050846f
);

const float biases[4] = float[4](
  -0.0177275f, +0.0255002f, -0.1634029f, -0.0357078f
);

vec4 hook() {
    const vec4 r[9][2] = vec4[9][2](
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 1.0f)))
    );

    float sum[4] = biases;
    for (int n = 0; n < 4; n++) {
        for (int i = 0; i < 9; i++) {
            const vec4 k0 = vec4(kernels[n * 8 * 9 + 8 * i + 0], kernels[n * 8 * 9 + 8 * i + 1], kernels[n * 8 * 9 + 8 * i + 2], kernels[n * 8 * 9 + 8 * i + 3]);
            const vec4 k1 = vec4(kernels[n * 8 * 9 + 8 * i + 4], kernels[n * 8 * 9 + 8 * i + 5], kernels[n * 8 * 9 + 8 * i + 6], kernels[n * 8 * 9 + 8 * i + 7]);
            sum[n] += (dot(k0, r[i][0]) + dot(k1, r[i][1]));
        }
    }

    return ACTIVE(vec4(sum[0], sum[1], sum[2], sum[3]));
}

//!HOOK LUMA
//!DESC ARNet b8 Layer5 L1
//!WHEN OUTPUT.w LUMA.w / 1.2 > OUTPUT.h LUMA.h / 1.2 > *
//!BIND TMP2_L0
//!BIND TMP2_L1
//!SAVE TMP1_L1
//!COMPONENTS 4

#define ACTIVE(v) (max(v, v * 0.2000000f))

#define TEX_BIND_L0_TEXOFF TMP2_L0_texOff
#define TEX_BIND_L0_TEX TMP2_L0_tex
#define TEX_BIND_L0_POS TMP2_L0_pos
#define TEX_BIND_L0_SIZE TMP2_L0_size
#define TEX_BIND_L0_PT TMP2_L0_pt

#define TEX_BIND_L1_TEXOFF TMP2_L1_texOff
#define TEX_BIND_L1_TEX TMP2_L1_tex
#define TEX_BIND_L1_POS TMP2_L1_pos
#define TEX_BIND_L1_SIZE TMP2_L1_size
#define TEX_BIND_L1_PT TMP2_L1_pt

const float kernels[288] = float[288](
  +0.2552720f, -0.1571937f, +0.1636584f, -0.0305995f, +0.1642903f, +0.0110898f, +0.0218280f, -0.1976153f,
  +0.3677663f, -0.1232905f, +0.1696340f, +0.2203897f, -0.0918087f, -0.0657531f, -0.0966161f, -0.0690733f,
  -0.1673910f, +0.0155613f, -0.2374118f, -0.2481432f, +0.0779501f, -0.0654863f, -0.3332708f, -0.3015122f,
  -0.2449495f, +0.1213602f, -0.0864394f, +0.0221988f, +0.3038476f, -0.2047841f, +0.4688317f, +0.0614045f,
  +0.1511970f, -0.0913793f, -0.1256581f, +0.6128057f, -0.3646917f, -0.0106637f, +0.8193660f, +0.7969829f,
  +0.5584168f, +0.1492040f, +0.2590063f, +0.0329858f, -0.3097780f, -0.6467936f, -0.1739675f, +0.1360185f,
  +0.1201623f, +0.0824673f, +0.1067867f, -0.2610610f, +0.3308275f, -0.4673666f, +0.2445738f, -0.1096906f,
  -0.3661053f, -0.1753961f, +0.2700356f, +0.4537354f, -0.2653254f, -0.6754174f, +0.2247401f, +0.6305572f,
  +0.3692984f, -0.0269630f, +0.0732482f, -0.4034900f, -0.2196628f, -0.3830330f, +0.4218230f, -0.1053420f,
  +0.6913960f, +0.5206935f, +0.3050666f, +0.6235718f, -0.4300270f, +0.3576736f, +0.1887363f, -0.2174375f,
  -0.5916018f, -0.2243055f, -0.5621576f, -0.3713001f, -0.6619304f, -0.0092771f, -0.6060508f, +0.2937443f,
  -0.0460634f, +0.0716790f, -0.3351922f, -0.0272218f, -0.1610111f, -0.1166630f, +0.3613810f, +0.1929673f,
  +0.9262707f, +0.5161723f, -0.4966032f, +0.9272921f, -0.2514192f, -0.1303796f, +0.1002496f, +0.1706135f,
  +0.2793862f, +0.1501081f, -0.0130174f, -0.7042742f, +0.1214016f, -0.1959393f, -0.4069232f, +0.0744581f,
  -0.2226106f, -0.1214677f, +0.2196871f, -0.1889933f, +0.2932423f, +0.0704073f, +0.1665224f, -0.2087037f,
  -0.1986404f, +0.3005700f, -0.0229150f, -0.0653417f, -0.2864426f, +0.0867413f, +0.1364619f, +0.1930695f,
  -0.1124795f, +0.0956224f, +0.5638328f, -0.6002349f, -0.2457950f, -0.2693759f, +0.4390034f, -0.0199584f,
  +0.1408919f, +0.0671677f, -0.1279971f, -0.1684949f, -0.3211262f, +0.0516370f, +0.1093450f, +0.0591112f,
  +0.0666066f, -0.1311341f, -0.0172023f, +0.0553308f, -0.0329463f, -0.0326946f, +0.0966964f, +0.0965181f,
  -0.2977180f, -0.0604656f, +0.0275203f, +0.1921005f, +0.0561691f, -0.1088433f, +0.1000345f, -0.0796985f,
  -0.0927743f, -0.1271920f, -0.1315370f, +0.1186936f, +0.4392263f, +0.0532894f, +0.2501006f, +0.1044294f,
  -0.1774855f, +0.2771697f, +0.1012108f, +0.2131771f, +0.5060615f, +0.3174887f, -0.0414355f, +0.1046678f,
  -0.2662714f, -0.2085689f, +0.3076029f, +0.0348146f, +0.3874628f, -0.0785658f, +0.2624807f, +0.5675589f,
  -0.0246640f, -0.0300359f, +0.0283715f, +0.0703496f, +0.6576393f, -0.0310617f, +0.4634687f, -0.1632513f,
  +0.0941718f, -0.0715755f, +0.0306211f, +0.0294099f, +0.2844492f, -0.1641778f, -0.0680402f, +0.1091354f,
  +0.0348785f, +0.0457379f, +0.2273237f, +0.1026362f, +0.0948828f, -0.6339160f, +0.0758874f, -0.0534803f,
  +0.1207574f, +0.0297819f, +0.1867158f, +0.1173791f, +0.1047531f, -0.0616032f, +0.2941726f, +0.0967864f,
  -0.2188040f, -0.0363184f, +0.5376485f, -0.0337626f, -0.1436663f, +0.1567393f, +0.2483205f, -0.0500218f,
  -0.1214525f, -0.1240595f, -0.0619504f, +0.2193071f, +0.0552217f, +0.4889486f, +0.4998429f, +0.1042638f,
  -0.1442869f, -0.2227473f, -0.1224760f, +0.0197938f, +0.2653741f, -0.2488118f, -0.1067091f, -0.0724379f,
  -0.2449691f, +0.0023989f, +0.4378452f, -0.0540432f, -0.2790384f, +0.6666322f, +0.5278191f, -0.0249447f,
  +0.3766304f, +0.2737985f, -0.3700924f, +0.5399538f, -0.6361293f, +0.5551503f, -0.0211598f, +0.2610441f,
  -0.2867023f, +0.0470692f, +0.1101825f, -0.3433720f, -0.3779005f, -0.3608226f, -0.2174659f, +0.1047241f,
  -0.2116031f, +0.1631243f, -0.1002881f, +0.0243817f, -0.2541424f, +0.3669889f, -0.2374011f, -0.2055028f,
  +0.1939844f, +0.1612074f, -0.3802700f, -0.0881685f, +0.2425485f, +0.4745942f, -0.6133030f, -0.2082602f,
  -0.2659800f, +0.0023753f, +0.0773523f, -0.3208401f, +0.3293096f, +0.0948378f, -0.2187684f, -0.1318675f
);

const float biases[4] = float[4](
  -0.0409717f, -0.0934582f, +0.1466089f, -0.0314530f
);

vec4 hook() {
    const vec4 r[9][2] = vec4[9][2](
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 1.0f)))
    );

    float sum[4] = biases;
    for (int n = 0; n < 4; n++) {
        for (int i = 0; i < 9; i++) {
            const vec4 k0 = vec4(kernels[n * 8 * 9 + 8 * i + 0], kernels[n * 8 * 9 + 8 * i + 1], kernels[n * 8 * 9 + 8 * i + 2], kernels[n * 8 * 9 + 8 * i + 3]);
            const vec4 k1 = vec4(kernels[n * 8 * 9 + 8 * i + 4], kernels[n * 8 * 9 + 8 * i + 5], kernels[n * 8 * 9 + 8 * i + 6], kernels[n * 8 * 9 + 8 * i + 7]);
            sum[n] += (dot(k0, r[i][0]) + dot(k1, r[i][1]));
        }
    }

    return ACTIVE(vec4(sum[0], sum[1], sum[2], sum[3]));
}

//!HOOK LUMA
//!DESC ARNet b8 Layer6 L0
//!WHEN OUTPUT.w LUMA.w / 1.2 > OUTPUT.h LUMA.h / 1.2 > *
//!BIND TMP1_L0
//!BIND TMP1_L1
//!BIND TMP2_L0
//!SAVE TMP2_L0
//!COMPONENTS 4

#define ACTIVE(v) (v)

#define TEX_BIND_L0_TEXOFF TMP1_L0_texOff
#define TEX_BIND_L0_TEX TMP1_L0_tex
#define TEX_BIND_L0_POS TMP1_L0_pos
#define TEX_BIND_L0_SIZE TMP1_L0_size
#define TEX_BIND_L0_PT TMP1_L0_pt

#define TEX_BIND_L1_TEXOFF TMP1_L1_texOff
#define TEX_BIND_L1_TEX TMP1_L1_tex
#define TEX_BIND_L1_POS TMP1_L1_pos
#define TEX_BIND_L1_SIZE TMP1_L1_size
#define TEX_BIND_L1_PT TMP1_L1_pt

#define TEX_BIND_L2_TEXOFF TMP2_L0_texOff
#define TEX_BIND_L2_TEX TMP2_L0_tex
#define TEX_BIND_L2_POS TMP2_L0_pos
#define TEX_BIND_L2_SIZE TMP2_L0_size
#define TEX_BIND_L2_PT TMP2_L0_pt

const float kernels[288] = float[288](
  -0.0457566f, +0.0273451f, -0.1441246f, +0.1184399f, +0.0262277f, -0.2900591f, -0.1468267f, +0.0726646f,
  -0.4176731f, -0.0379203f, +0.0446949f, +0.2076871f, +0.2264530f, -0.2410789f, -0.2023234f, +0.4289334f,
  -0.0362591f, -0.0334671f, -0.1303620f, +0.2212055f, +0.3104804f, +0.0399795f, +0.1407294f, +0.3635347f,
  -0.2036288f, +0.0338931f, +0.0767209f, -0.1160388f, +0.6512215f, +0.0714065f, +0.1256869f, +0.1471994f,
  -0.5304210f, +0.3240640f, +0.3470685f, -0.7320883f, +0.6661219f, -0.5652841f, -0.0831046f, +0.8927355f,
  +0.2079601f, -0.3478886f, -0.5553199f, -0.1423076f, -0.3117406f, -1.1780564f, -0.0875688f, +0.0136888f,
  +0.1460019f, -0.3458079f, +0.0120540f, +0.0554078f, -0.4385144f, +0.0789356f, -0.1244360f, +0.1716908f,
  -0.1336591f, -0.2089393f, +0.1482335f, +0.3849345f, +0.2876721f, +0.4536151f, +0.0230771f, +0.3190256f,
  +0.1051796f, -0.2986781f, +0.0192660f, -0.1096670f, +0.1801324f, -0.5091999f, +0.0103042f, -0.0480496f,
  -0.0299655f, +0.5075961f, -0.0942222f, -0.2103666f, +0.3515950f, +0.0214331f, -0.0629908f, -0.3272017f,
  -0.0833091f, +0.1868576f, +0.0322978f, -0.2912149f, +0.0630288f, +0.2281943f, -0.0391046f, +0.3604548f,
  +0.0513992f, +0.0086525f, -0.1875457f, +0.0556452f, -0.1980163f, +0.3985939f, -0.0589900f, -0.1080500f,
  +0.1876901f, +0.1047420f, -0.3080702f, +0.1997155f, +0.1773854f, +0.0852147f, +0.1875178f, -0.4758995f,
  +0.1658107f, +0.2588971f, +0.2839456f, +0.0690358f, +0.2269017f, +0.2273460f, +0.2371105f, +0.3109767f,
  +0.3803790f, +0.1093484f, +0.2242504f, +0.1918957f, -0.1528611f, -0.0296131f, +0.3060838f, -0.2795938f,
  +0.1467918f, +0.1068593f, -0.1190262f, +0.0558732f, -0.2923682f, -0.1945151f, +0.4592345f, +0.0215789f,
  +0.3176332f, +0.1875716f, +0.0358750f, +0.2999710f, -0.0944947f, +0.1658250f, +0.3574647f, -0.0078266f,
  +0.0748555f, -0.0659424f, +0.1205719f, +0.0610393f, -0.0206643f, +0.2233386f, -0.0980583f, -0.0001871f,
  +0.1328986f, -0.1005450f, +0.1782923f, -0.0679392f, -0.0648704f, +0.1689986f, +0.0617044f, +0.5168316f,
  +0.0560242f, -0.3194687f, +0.1169762f, -0.2355580f, -0.3733343f, -0.1950256f, -0.1017391f, -0.0746340f,
  +0.0531223f, -0.0509626f, +0.0023951f, +0.0861235f, -0.0320107f, -0.1728572f, +0.0423595f, -0.0623774f,
  +0.0738665f, -0.4239729f, -0.0037099f, +0.0511811f, -0.3564036f, -0.0753882f, -0.2401376f, -0.1238700f,
  -0.3761356f, +0.0996241f, +0.0513405f, -0.0848203f, -0.6150481f, -0.5261129f, -0.0717051f, -0.7694874f,
  -0.1133438f, -0.0089615f, +0.0966058f, -0.0918789f, -0.0563779f, +0.5862287f, -0.2782508f, -0.4008631f,
  +0.1601820f, +0.0212680f, -0.0990059f, -0.0778648f, -0.3952259f, -0.1577269f, +0.1709996f, -0.5453990f,
  -0.5232597f, -0.1275300f, +0.0627301f, -0.0841365f, -0.4671917f, +0.0628052f, -0.1676575f, -0.6250425f,
  -0.0712802f, +0.0981021f, -0.2238666f, -0.4043240f, -0.3914286f, -0.2420617f, -0.0643160f, -0.3327409f,
  +0.0800325f, +0.1192018f, +0.0685919f, +0.0528163f, -0.2576290f, -0.1210070f, +0.0455446f, -0.2947988f,
  -0.1716166f, -0.3389382f, -0.2106428f, +0.5221927f, +0.2188994f, +0.0932344f, -0.2514910f, -0.0223254f,
  -0.2676980f, +0.3733648f, +0.1592367f, -0.1754618f, +0.2452098f, +0.2482651f, +0.1023972f, +0.1646194f,
  -0.4068005f, +0.1422690f, -0.0258986f, -0.0589627f, +0.1012823f, -0.1107196f, +0.1535895f, -0.3712164f,
  -0.0031844f, +0.0109714f, -0.1204367f, -0.2481830f, -0.3589240f, +0.4611356f, -0.3145392f, -0.0831665f,
  +0.1362555f, -0.1351026f, +0.0693323f, +0.2159447f, -0.1006676f, -0.0822590f, +0.1993792f, +0.3654418f,
  -0.1504178f, +0.1318025f, -0.0307799f, +0.0605722f, +0.0076773f, -0.1026547f, +0.3006457f, +0.1192385f,
  +0.1474215f, -0.0550917f, -0.0479918f, -0.0619973f, -0.0433092f, +0.0645727f, -0.4008513f, +0.2264388f,
  -0.0540955f, -0.0593810f, +0.0663200f, -0.1120251f, -0.0333885f, -0.1230180f, +0.1901324f, -0.4177475f
);

const float biases[4] = float[4](
  +0.0663615f, -0.0873988f, +0.3307495f, +0.1141290f
);

vec4 hook() {
    const vec4 r[9][2] = vec4[9][2](
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 1.0f)))
    );

    float sum[4] = biases;
    for (int n = 0; n < 4; n++) {
        for (int i = 0; i < 9; i++) {
            const vec4 k0 = vec4(kernels[n * 8 * 9 + 8 * i + 0], kernels[n * 8 * 9 + 8 * i + 1], kernels[n * 8 * 9 + 8 * i + 2], kernels[n * 8 * 9 + 8 * i + 3]);
            const vec4 k1 = vec4(kernels[n * 8 * 9 + 8 * i + 4], kernels[n * 8 * 9 + 8 * i + 5], kernels[n * 8 * 9 + 8 * i + 6], kernels[n * 8 * 9 + 8 * i + 7]);
            sum[n] += (dot(k0, r[i][0]) + dot(k1, r[i][1]));
        }
    }

    return ACTIVE(vec4(sum[0], sum[1], sum[2], sum[3]) * 0.2000000f + TEX_BIND_L2_TEXOFF(vec2(0.0f, 0.0f)));
}

//!HOOK LUMA
//!DESC ARNet b8 Layer6 L1
//!WHEN OUTPUT.w LUMA.w / 1.2 > OUTPUT.h LUMA.h / 1.2 > *
//!BIND TMP1_L0
//!BIND TMP1_L1
//!BIND TMP2_L1
//!SAVE TMP2_L1
//!COMPONENTS 4

#define ACTIVE(v) (v)

#define TEX_BIND_L0_TEXOFF TMP1_L0_texOff
#define TEX_BIND_L0_TEX TMP1_L0_tex
#define TEX_BIND_L0_POS TMP1_L0_pos
#define TEX_BIND_L0_SIZE TMP1_L0_size
#define TEX_BIND_L0_PT TMP1_L0_pt

#define TEX_BIND_L1_TEXOFF TMP1_L1_texOff
#define TEX_BIND_L1_TEX TMP1_L1_tex
#define TEX_BIND_L1_POS TMP1_L1_pos
#define TEX_BIND_L1_SIZE TMP1_L1_size
#define TEX_BIND_L1_PT TMP1_L1_pt

#define TEX_BIND_L2_TEXOFF TMP2_L1_texOff
#define TEX_BIND_L2_TEX TMP2_L1_tex
#define TEX_BIND_L2_POS TMP2_L1_pos
#define TEX_BIND_L2_SIZE TMP2_L1_size
#define TEX_BIND_L2_PT TMP2_L1_pt

const float kernels[288] = float[288](
  -0.0328697f, +0.0109501f, +0.0476588f, -0.0320087f, +0.4138091f, +0.0481292f, -0.0446448f, +0.0288716f,
  +0.0739002f, +0.1814447f, +0.0573736f, -0.2080341f, -0.4680263f, -0.0204369f, +0.1682707f, +0.0147848f,
  +0.0104731f, -0.2748808f, -0.0712639f, -0.0920706f, -0.0431697f, +0.3892238f, -0.0483087f, -0.4260973f,
  -0.0490560f, -0.1140150f, -0.2534536f, +0.2000953f, +1.0881780f, -0.0754686f, -0.1514569f, +0.0798819f,
  +0.3043864f, +0.4261317f, -0.2068702f, -0.2378821f, +0.2941149f, +0.0274077f, -0.3209433f, -0.8995622f,
  +0.0296003f, +0.3100218f, -0.2382246f, +0.4632615f, +0.3232833f, -0.3718545f, +0.0231490f, -0.3557294f,
  +0.0399977f, +0.3057367f, -0.3727845f, -0.0509121f, +0.1086260f, -0.2383569f, +0.0842177f, +0.0017119f,
  +0.6616643f, +0.3200680f, -0.2673924f, -0.2162118f, -0.1200059f, -0.2429163f, -0.1780436f, -0.3555105f,
  +0.3436792f, -0.0337066f, +0.0114975f, +0.1208221f, -0.0687053f, +0.0911631f, +0.1841189f, +0.5999839f,
  +0.0931090f, -0.0773554f, +0.2436070f, +0.2214683f, -0.0107207f, +0.0663994f, +0.0456118f, +0.4499836f,
  +0.1496179f, -0.3454595f, +0.1244296f, +0.2335001f, -0.1463123f, +0.1429801f, +0.2679399f, -0.2282015f,
  -0.2092821f, +0.0093553f, +0.0445107f, +0.1710496f, +0.0424662f, +0.0967217f, +0.0405082f, -0.1876408f,
  +0.1455883f, -0.0026439f, +0.0423862f, +0.0036085f, +0.2295128f, -0.0060888f, -0.0354288f, -0.0490225f,
  +0.0954733f, -0.1682632f, -0.0909695f, +0.2334532f, +0.1526246f, +0.0147501f, +0.3100399f, -0.2008985f,
  -0.0226743f, +0.2201120f, +0.2658584f, -0.1427412f, +0.1120222f, +0.8216549f, +0.1761588f, -0.2100294f,
  -0.1420388f, -0.0367129f, +0.1142540f, -0.0437186f, +0.0540106f, -0.1372723f, -0.3364097f, -0.1226392f,
  -0.1030603f, -0.2823891f, -0.0487595f, -0.0761022f, -0.3705457f, -0.1276191f, -0.1592285f, -0.3829704f,
  -0.3176786f, +0.1797581f, -0.1071152f, -0.3254288f, -0.2226269f, -0.1740102f, +0.1076677f, -0.4908450f,
  -0.2812487f, +0.1173418f, +0.1486323f, -0.0965329f, +0.2620973f, +0.1959220f, +0.0837047f, +0.2466238f,
  -0.0650765f, +0.2436816f, +0.4025870f, -0.0342394f, -0.0893531f, +0.4313949f, +0.3770885f, +0.6031469f,
  -0.0025905f, +0.0411654f, +0.1325904f, +0.2532259f, -0.2565358f, +0.2915223f, +0.1719368f, +0.2047815f,
  -0.0828706f, +0.1686094f, -0.0988897f, +0.1022746f, +0.5052147f, -0.0329859f, -0.4433961f, +0.4668738f,
  -0.4436020f, +0.0772814f, +0.1218905f, -0.3724217f, +0.8856137f, -0.1511350f, -0.4308690f, +1.0392051f,
  -0.1929779f, -0.0042423f, -0.4016120f, +0.0024103f, +0.0116391f, -0.3408873f, +0.0766832f, -0.0840791f,
  -0.2096252f, +0.1824899f, +0.1718511f, -0.0128441f, +0.3961394f, -0.1007905f, -0.1996027f, +0.1252978f,
  +0.1180162f, -0.1184853f, +0.1805394f, -0.1789089f, +0.0009334f, -0.3808922f, -0.0734429f, -0.1118429f,
  +0.0995309f, +0.0483103f, +0.1800697f, +0.1263695f, +0.0157273f, -0.1442929f, -0.0042846f, -0.4559197f,
  +0.0826813f, +0.0014995f, +0.2978631f, -0.0012187f, -0.2399188f, -0.3374280f, -0.2211906f, +0.7781188f,
  +0.1330889f, -0.2527501f, +0.2045454f, +0.0940327f, -0.0630488f, -0.2715954f, -0.0197313f, +0.6268405f,
  +0.1428990f, -0.1270963f, +0.2752399f, -0.1023815f, -0.3249355f, -0.5463471f, +0.3332317f, +0.3475353f,
  +0.1458478f, -0.0873156f, +0.4362863f, -0.4271839f, -0.3104715f, -0.1088275f, -0.1003482f, -0.2480409f,
  -0.0013715f, -0.2232622f, +0.0284623f, +0.6469995f, +0.0381587f, -0.6118065f, -0.0155054f, -0.3667327f,
  -0.1937269f, +0.0402251f, +0.7788445f, -0.1528778f, +0.1473515f, -0.1044675f, +0.2352341f, -0.1038310f,
  +0.1620238f, -0.0572335f, +0.2447860f, -0.0266527f, +0.0210571f, +0.1555840f, -0.1667687f, -0.2092072f,
  -0.3281271f, -0.2277871f, +0.4938616f, +0.2162289f, +0.0868279f, -0.3549696f, -0.0333847f, +0.8873916f,
  +0.3002343f, +0.1028601f, -0.1262443f, +0.1197173f, -0.0699198f, -0.1683206f, +0.0491743f, +0.0585797f
);

const float biases[4] = float[4](
  -0.0080151f, -0.2585879f, +0.0220595f, -0.2423758f
);

vec4 hook() {
    const vec4 r[9][2] = vec4[9][2](
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 1.0f)))
    );

    float sum[4] = biases;
    for (int n = 0; n < 4; n++) {
        for (int i = 0; i < 9; i++) {
            const vec4 k0 = vec4(kernels[n * 8 * 9 + 8 * i + 0], kernels[n * 8 * 9 + 8 * i + 1], kernels[n * 8 * 9 + 8 * i + 2], kernels[n * 8 * 9 + 8 * i + 3]);
            const vec4 k1 = vec4(kernels[n * 8 * 9 + 8 * i + 4], kernels[n * 8 * 9 + 8 * i + 5], kernels[n * 8 * 9 + 8 * i + 6], kernels[n * 8 * 9 + 8 * i + 7]);
            sum[n] += (dot(k0, r[i][0]) + dot(k1, r[i][1]));
        }
    }

    return ACTIVE(vec4(sum[0], sum[1], sum[2], sum[3]) * 0.2000000f + TEX_BIND_L2_TEXOFF(vec2(0.0f, 0.0f)));
}

//!HOOK LUMA
//!DESC ARNet b8 Layer7 L0
//!WHEN OUTPUT.w LUMA.w / 1.2 > OUTPUT.h LUMA.h / 1.2 > *
//!BIND TMP2_L0
//!BIND TMP2_L1
//!SAVE TMP1_L0
//!COMPONENTS 4

#define ACTIVE(v) (max(v, v * 0.2000000f))

#define TEX_BIND_L0_TEXOFF TMP2_L0_texOff
#define TEX_BIND_L0_TEX TMP2_L0_tex
#define TEX_BIND_L0_POS TMP2_L0_pos
#define TEX_BIND_L0_SIZE TMP2_L0_size
#define TEX_BIND_L0_PT TMP2_L0_pt

#define TEX_BIND_L1_TEXOFF TMP2_L1_texOff
#define TEX_BIND_L1_TEX TMP2_L1_tex
#define TEX_BIND_L1_POS TMP2_L1_pos
#define TEX_BIND_L1_SIZE TMP2_L1_size
#define TEX_BIND_L1_PT TMP2_L1_pt

const float kernels[288] = float[288](
  +0.1869626f, -0.0327040f, +0.0550971f, -0.0166160f, +0.0152444f, +0.1270038f, +0.0646594f, -0.0533679f,
  +0.1793021f, +0.1996677f, +0.1472882f, -0.2257696f, -0.1007085f, -0.2112346f, -0.2294439f, +0.3649877f,
  +0.0796769f, +0.0266948f, +0.0677918f, +0.1529281f, -0.0839225f, -0.0289054f, +0.1126016f, +0.1754299f,
  +0.1613849f, +0.1290463f, +0.2184415f, +0.3006460f, -0.2159156f, +0.2783071f, -0.0290710f, +0.0468425f,
  -0.0860778f, +0.2897590f, -0.8651338f, +0.1765206f, -0.0222895f, +0.1135535f, +0.1367954f, -0.0861694f,
  -0.3794927f, +0.2083273f, -0.3485765f, -0.1029263f, -0.3355593f, +0.2535348f, +0.0215686f, +0.0411561f,
  +0.7225110f, +0.3782185f, -0.3432631f, +0.0278450f, -0.1779713f, +0.2899582f, +0.0483711f, -0.2370616f,
  +0.9661677f, +0.7177255f, -0.7871413f, -0.0919910f, +0.6129258f, +0.3282284f, +0.2939736f, -0.8830003f,
  -0.0617857f, -0.0123668f, +0.2805695f, +0.0401248f, -0.2416551f, +0.4551079f, -0.4180689f, +0.0679876f,
  -0.2275063f, -0.0246576f, +0.2810711f, +0.4387118f, +0.2204802f, +0.0287782f, +0.2217003f, +0.0810476f,
  -0.1279082f, -0.1760326f, +0.0404806f, +0.0813542f, +0.4224792f, +0.2137069f, +0.1708746f, +0.3203403f,
  +0.2919941f, -0.2212996f, +0.3981989f, +0.0297671f, +0.3635399f, +0.2651211f, +0.3389502f, +0.4832812f,
  -0.2068320f, +0.0051526f, +0.0265354f, -0.1459363f, +0.0429158f, -0.2498799f, +0.0082246f, -0.2850735f,
  -0.2099011f, +0.7058592f, +0.1477709f, +0.0537519f, +0.1298135f, -0.0580299f, -0.6274242f, +0.1951693f,
  -0.0483583f, +0.3528862f, +0.0967045f, -0.1569982f, +0.0151533f, +0.0969721f, +0.2651607f, -0.1457034f,
  -0.1391461f, +0.1202756f, +0.0233659f, -0.1172863f, +0.1674309f, -0.1596773f, +0.0322667f, -0.1352649f,
  +0.1137701f, +0.3056870f, -0.4534630f, -0.1977107f, -0.0974016f, -0.0007983f, -0.1121034f, -0.0425755f,
  -0.1493894f, -0.1340479f, +0.0250680f, -0.0360122f, +0.0292298f, -0.2196982f, +0.4975025f, -0.1427678f,
  -0.3036101f, -0.1405607f, -0.3432041f, -0.1285003f, +0.3662859f, -0.1667307f, -0.0683584f, +0.0907471f,
  +0.0157012f, -0.2040837f, +0.0901656f, -0.0762599f, +0.1456702f, +0.0790083f, +0.1427947f, +0.2909439f,
  -0.0068884f, -0.0999052f, +0.0404559f, +0.0546451f, +0.2023568f, +0.1031388f, +0.0950287f, +0.1907963f,
  -0.2750099f, -0.0867208f, -0.1058854f, -0.0844756f, +0.2334614f, -0.0593517f, -0.2897630f, +0.1943919f,
  -0.1488411f, +0.0448585f, -0.2724208f, +0.0454099f, -0.1099511f, +0.3823406f, +0.6391373f, +0.1584771f,
  -0.1277228f, +0.0193436f, -0.1200130f, -0.2338315f, -0.1297569f, -0.0776223f, +0.0888600f, +0.0267352f,
  +0.0060926f, -0.2850147f, +0.0389691f, +0.0099192f, +0.0679585f, +0.2382993f, +0.0134956f, +0.1010028f,
  +0.1404002f, -0.2412869f, +0.0269441f, +0.4587547f, -0.2313225f, +0.0009878f, -0.2173839f, +0.1863232f,
  +0.0774519f, +0.0520012f, -0.0035936f, +0.1221584f, -0.0213412f, +0.1581927f, -0.1821418f, +0.1607449f,
  -0.3051965f, -0.0501404f, +0.1136902f, +0.2984370f, -0.1771661f, +0.1571500f, -0.3752697f, -0.5009436f,
  +0.3603100f, -0.0765261f, +0.2712841f, -0.0402661f, -0.0297521f, -0.0749811f, -0.3777354f, -0.2927286f,
  +0.0469861f, -0.1491417f, +0.0463469f, -0.0853731f, +0.0607609f, +0.3179004f, +0.1548987f, -0.0755699f,
  +0.0173496f, -0.3977132f, +0.3584456f, +0.2204235f, +0.5172535f, -0.3721443f, -0.6330895f, -0.0610901f,
  +0.0765014f, -0.0595317f, +0.5107709f, +1.0437069f, +0.2503235f, -0.1202747f, -0.2160557f, +0.0977727f,
  +0.2633388f, +0.1725155f, +0.0741220f, +0.2817432f, +0.3065919f, -0.0964955f, +0.2294894f, +0.3314610f,
  +0.3226786f, -0.1687898f, -0.1406496f, +0.0824186f, +0.2719727f, -0.3546978f, +0.2859166f, -0.1108767f,
  +0.1232136f, +0.0638178f, -0.5171618f, -0.0299290f, -0.3050061f, -0.2015323f, -0.0929306f, +0.3570219f,
  -0.0846057f, -0.0574932f, -0.0294227f, -0.0048118f, +0.1405844f, +0.0566641f, +0.0880577f, +0.2497961f
);

const float biases[4] = float[4](
  -0.1939689f, +0.0888992f, -0.6807284f, -0.0943354f
);

vec4 hook() {
    const vec4 r[9][2] = vec4[9][2](
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 1.0f)))
    );

    float sum[4] = biases;
    for (int n = 0; n < 4; n++) {
        for (int i = 0; i < 9; i++) {
            const vec4 k0 = vec4(kernels[n * 8 * 9 + 8 * i + 0], kernels[n * 8 * 9 + 8 * i + 1], kernels[n * 8 * 9 + 8 * i + 2], kernels[n * 8 * 9 + 8 * i + 3]);
            const vec4 k1 = vec4(kernels[n * 8 * 9 + 8 * i + 4], kernels[n * 8 * 9 + 8 * i + 5], kernels[n * 8 * 9 + 8 * i + 6], kernels[n * 8 * 9 + 8 * i + 7]);
            sum[n] += (dot(k0, r[i][0]) + dot(k1, r[i][1]));
        }
    }

    return ACTIVE(vec4(sum[0], sum[1], sum[2], sum[3]));
}

//!HOOK LUMA
//!DESC ARNet b8 Layer7 L1
//!WHEN OUTPUT.w LUMA.w / 1.2 > OUTPUT.h LUMA.h / 1.2 > *
//!BIND TMP2_L0
//!BIND TMP2_L1
//!SAVE TMP1_L1
//!COMPONENTS 4

#define ACTIVE(v) (max(v, v * 0.2000000f))

#define TEX_BIND_L0_TEXOFF TMP2_L0_texOff
#define TEX_BIND_L0_TEX TMP2_L0_tex
#define TEX_BIND_L0_POS TMP2_L0_pos
#define TEX_BIND_L0_SIZE TMP2_L0_size
#define TEX_BIND_L0_PT TMP2_L0_pt

#define TEX_BIND_L1_TEXOFF TMP2_L1_texOff
#define TEX_BIND_L1_TEX TMP2_L1_tex
#define TEX_BIND_L1_POS TMP2_L1_pos
#define TEX_BIND_L1_SIZE TMP2_L1_size
#define TEX_BIND_L1_PT TMP2_L1_pt

const float kernels[288] = float[288](
  -0.0300594f, -0.1173550f, +0.0357946f, -0.0701267f, -0.1795233f, +0.1781803f, -0.3160265f, -0.2560541f,
  +0.3184699f, +0.2714701f, +0.2092579f, +0.1836548f, -0.3269847f, +0.0824251f, +0.0950508f, +0.0476748f,
  -0.1598040f, +0.2072896f, -0.2232167f, -0.0036173f, -0.2428347f, -0.2271343f, -0.2802352f, -0.0428401f,
  +0.2117956f, +0.2498658f, -0.1961991f, -0.1624645f, -0.0335235f, -0.2415054f, -0.1657976f, +0.1665153f,
  +0.6816266f, +0.5746037f, -0.2003089f, -0.3692384f, +0.1635112f, -0.3069998f, -0.5781978f, +0.1617310f,
  -0.1022193f, +0.1564150f, -0.2807940f, -0.1897006f, -0.5775982f, +0.1475893f, -0.4664455f, +0.0532988f,
  -0.0833614f, -0.3477606f, +0.1476973f, +0.3021894f, +0.1285775f, -0.4106292f, +0.0810579f, +0.1604608f,
  -0.0271282f, -0.2847850f, +0.1648519f, -0.3157495f, +0.1644905f, -0.4434231f, +0.2658204f, +0.6282213f,
  +0.0765834f, +0.0446400f, +0.1747142f, +0.1705268f, +0.2472159f, +0.1269892f, -0.0223149f, +0.1181741f,
  -0.0684130f, -0.2637288f, +0.0276963f, +0.0035712f, +0.0766942f, +0.1824620f, -0.2802645f, -0.1966275f,
  -0.1221059f, +0.7794753f, -0.0371225f, +0.1278844f, -0.3057575f, +0.0814457f, -0.0277542f, +0.3547630f,
  -0.3156505f, +0.0614760f, -0.6175708f, +0.1830168f, -0.1685855f, -0.2685506f, +0.1022529f, -0.0133964f,
  -0.1947177f, -0.1275748f, +0.3659775f, +0.0218587f, -0.1682239f, +0.4514555f, +0.1214536f, -0.1775608f,
  -0.2042097f, +0.4085364f, -0.0809539f, -0.0942264f, +0.0552468f, +0.1443048f, -0.2179506f, +0.3108214f,
  +0.0674067f, +0.5370871f, -0.4185083f, +0.1097028f, +0.0536019f, -0.3673049f, -0.2000160f, +0.2472260f,
  -0.0532918f, -0.3279240f, +0.1501082f, -0.0070970f, -0.0750397f, -0.2589751f, +0.0903280f, -0.1645713f,
  -0.0170606f, +0.0568286f, +0.3968999f, +0.1956104f, -0.1033147f, -0.0597533f, +0.0557437f, +0.1657220f,
  +0.0012158f, -0.0005360f, -0.0247951f, -0.3460777f, +0.1023593f, +0.0756792f, -0.0404969f, +0.0314854f,
  +0.0205590f, +0.1959512f, +0.1053221f, +0.1480367f, -0.1820406f, -0.2334873f, +0.3047504f, +0.2631123f,
  +0.0361541f, -0.1826591f, -0.1876105f, -0.1728302f, -0.1177330f, +0.0426416f, -0.2579066f, -0.0975267f,
  -0.0985769f, -0.2320943f, -0.0338515f, +0.1553188f, +0.1550649f, -0.0284340f, +0.1550661f, -0.0500925f,
  -0.0049433f, +0.0980386f, -0.1390458f, -0.1888936f, -0.0245030f, -0.1007965f, +0.0404622f, +0.0293368f,
  +0.1212693f, -0.2714341f, -0.1045528f, -0.2672547f, +0.1935593f, -0.2762890f, +0.4983414f, +0.0933649f,
  -0.5735424f, +0.4911945f, -0.3781622f, +0.1745889f, +0.3089142f, -0.0112036f, +0.4389741f, +0.2506641f,
  -0.1578054f, +0.2465269f, -0.1004634f, +0.2503441f, -0.1691057f, -0.1942379f, -0.2953379f, +0.0430976f,
  +0.0877656f, +0.1163958f, -0.0476943f, -0.1713700f, +0.2427297f, -0.2350837f, -0.4525712f, +0.2335425f,
  +0.0938425f, +0.4006242f, +0.1160227f, -0.1444874f, +0.2656936f, +0.1841184f, -0.0568162f, -0.2190036f,
  +0.2810226f, +0.1219141f, -0.0582433f, +0.0230779f, +0.3348158f, -0.0440860f, +0.1872835f, +0.1893236f,
  -0.2847623f, -0.1255127f, -0.0512238f, -0.1416479f, +0.4842662f, -0.0128730f, +0.1429622f, +0.2193733f,
  +0.2122213f, -0.1882625f, +0.3487772f, -0.0561678f, +0.2557524f, +0.1257795f, +0.4085241f, +0.2615598f,
  +0.3292533f, +0.1664927f, -0.4908881f, +0.0607536f, -0.0609421f, +0.0983768f, +0.0303365f, -0.2617286f,
  -0.3717557f, -0.4054481f, -0.0998770f, +0.1225404f, -0.2014291f, +0.1317405f, +0.2867299f, -0.1210830f,
  -0.3069767f, +0.1219902f, +0.0870693f, +0.2458001f, +0.1144393f, +0.1380753f, +0.5073932f, -0.3618286f,
  +0.1016684f, +0.4315377f, -0.6808900f, -0.0826883f, +0.0423191f, +0.5332589f, -0.2243536f, -0.2884574f,
  +0.2975321f, +0.3197854f, -0.2274967f, +0.3002284f, +0.0954001f, +0.1505940f, -0.1558519f, -0.1265188f,
  +0.1136810f, +0.0929477f, -0.0161224f, +0.2009754f, +0.0580565f, +0.1544457f, -0.1534028f, +0.2219019f
);

const float biases[4] = float[4](
  +0.0738868f, +0.0750920f, +0.1141574f, +0.0702759f
);

vec4 hook() {
    const vec4 r[9][2] = vec4[9][2](
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 1.0f)))
    );

    float sum[4] = biases;
    for (int n = 0; n < 4; n++) {
        for (int i = 0; i < 9; i++) {
            const vec4 k0 = vec4(kernels[n * 8 * 9 + 8 * i + 0], kernels[n * 8 * 9 + 8 * i + 1], kernels[n * 8 * 9 + 8 * i + 2], kernels[n * 8 * 9 + 8 * i + 3]);
            const vec4 k1 = vec4(kernels[n * 8 * 9 + 8 * i + 4], kernels[n * 8 * 9 + 8 * i + 5], kernels[n * 8 * 9 + 8 * i + 6], kernels[n * 8 * 9 + 8 * i + 7]);
            sum[n] += (dot(k0, r[i][0]) + dot(k1, r[i][1]));
        }
    }

    return ACTIVE(vec4(sum[0], sum[1], sum[2], sum[3]));
}

//!HOOK LUMA
//!DESC ARNet b8 Layer8 L0
//!WHEN OUTPUT.w LUMA.w / 1.2 > OUTPUT.h LUMA.h / 1.2 > *
//!BIND TMP1_L0
//!BIND TMP1_L1
//!BIND TMP2_L0
//!SAVE TMP2_L0
//!COMPONENTS 4

#define ACTIVE(v) (v)

#define TEX_BIND_L0_TEXOFF TMP1_L0_texOff
#define TEX_BIND_L0_TEX TMP1_L0_tex
#define TEX_BIND_L0_POS TMP1_L0_pos
#define TEX_BIND_L0_SIZE TMP1_L0_size
#define TEX_BIND_L0_PT TMP1_L0_pt

#define TEX_BIND_L1_TEXOFF TMP1_L1_texOff
#define TEX_BIND_L1_TEX TMP1_L1_tex
#define TEX_BIND_L1_POS TMP1_L1_pos
#define TEX_BIND_L1_SIZE TMP1_L1_size
#define TEX_BIND_L1_PT TMP1_L1_pt

#define TEX_BIND_L2_TEXOFF TMP2_L0_texOff
#define TEX_BIND_L2_TEX TMP2_L0_tex
#define TEX_BIND_L2_POS TMP2_L0_pos
#define TEX_BIND_L2_SIZE TMP2_L0_size
#define TEX_BIND_L2_PT TMP2_L0_pt

const float kernels[288] = float[288](
  +0.1408900f, +0.1594435f, +0.4011286f, -0.0794957f, -0.0578380f, -0.1489373f, +0.1358294f, -0.1580433f,
  -0.8981604f, +0.1389466f, -0.1243448f, -0.4118450f, +0.1517436f, +0.1160428f, -0.1841455f, -0.2882841f,
  -0.4102381f, +0.1048258f, +0.2587457f, -0.2883621f, +0.0717688f, -0.1552360f, +0.1929179f, +0.0045691f,
  -0.0263666f, +0.1007348f, +0.0917491f, -0.2117460f, -0.0301913f, +0.0651246f, +0.5041960f, +0.0089046f,
  -0.1611721f, +0.1145147f, +0.3219624f, -0.0681123f, -0.4074626f, +0.1602746f, +0.0372644f, -0.3982326f,
  -0.2558250f, +0.3349491f, +0.3782249f, +0.0197126f, -0.0038912f, +0.2345899f, -0.0765351f, +0.2666537f,
  +0.1317144f, -0.2129984f, -0.1533112f, +0.0137238f, -0.1303783f, +0.2689346f, +0.0718148f, -0.0577741f,
  -0.0193597f, -0.1244637f, -0.2959490f, +0.1249881f, -0.2686777f, +0.0125128f, +0.2437178f, -0.3776535f,
  -0.0320106f, +0.0489603f, +0.2901004f, +0.2440233f, +0.0372674f, -0.1829723f, -0.1152749f, +0.1595602f,
  -0.0984910f, +0.1545899f, +0.1320179f, +0.2696729f, -0.0318152f, +0.0638459f, -0.1780137f, +0.0676350f,
  +0.3035136f, -0.1013759f, +0.0667402f, +0.1321564f, -0.1961981f, +0.1655627f, -0.1878145f, -0.1260744f,
  -0.0911633f, +0.0772191f, +0.1473898f, -0.0087025f, -0.0731732f, +0.0188348f, -0.0910914f, -0.1919640f,
  +0.0359904f, -0.0712289f, -0.1478157f, -0.0120296f, +0.1632120f, -0.2270359f, -0.6272641f, +0.1978391f,
  +0.1293164f, -0.6015902f, +0.0653765f, -0.0930505f, -0.2015938f, -0.1071393f, +0.3924006f, -0.2258644f,
  +0.2972152f, +0.0686449f, +0.0088998f, +0.0891833f, +0.2343529f, +0.0744413f, -0.0742023f, +0.1663340f,
  -0.0735538f, +0.1962839f, +0.1838875f, -0.0148672f, +0.0559709f, -0.2192739f, +0.0695636f, +0.1707025f,
  -0.2260093f, +0.2921660f, -0.0503533f, -0.0983099f, -0.0286104f, -0.2515750f, +0.3740137f, +0.0397743f,
  -0.0976165f, -0.0129653f, +0.2779640f, -0.0410329f, +0.0575699f, +0.0773498f, -0.0167320f, +0.2605672f,
  +0.1667247f, -0.0095379f, -0.3049724f, +0.1046273f, -0.0739499f, -0.0196471f, +0.2859760f, +0.1563706f,
  +0.5004590f, +0.2058450f, +0.3760138f, -0.0152985f, -0.1688692f, -0.1162246f, -0.0777376f, -0.0848203f,
  +0.4609036f, +0.2274739f, -0.1957318f, +0.2933525f, -0.1914155f, +0.0115596f, +0.0736938f, +0.2386293f,
  +0.3368342f, -0.0510502f, +0.0713314f, +0.2031089f, -0.2096660f, +0.4211390f, -0.0720359f, -0.2511657f,
  +0.3898033f, -0.1472490f, +1.2997664f, +0.1374323f, -0.8040301f, +0.1701830f, -0.1591348f, +0.0226841f,
  +0.1421268f, +0.1055557f, +0.3491894f, +0.2088610f, -0.2572335f, -0.3050492f, +0.0845659f, -0.2076906f,
  +0.0607416f, -0.1170693f, +0.2603454f, +0.0968653f, -0.0637700f, +0.2076774f, +0.1641198f, +0.0407665f,
  +0.1113104f, -0.0160602f, +0.3399567f, +0.0588578f, -0.4690660f, +0.0041798f, +0.2548659f, -0.0219183f,
  +0.0912115f, -0.2450124f, +0.2817296f, -0.0507219f, -0.1453934f, -0.2509357f, +0.2420141f, -0.2444444f,
  +0.1967214f, +0.1446695f, -0.1454533f, -0.0092522f, -0.1869667f, -0.0212960f, +0.0206079f, -0.3214692f,
  -0.0514717f, -0.1393513f, -0.2643449f, +0.2671116f, +0.4448864f, -0.3247680f, +0.0530662f, -0.1501513f,
  +0.1263090f, +0.0301743f, -0.0736367f, -0.0534610f, +0.0948470f, -0.1284703f, +0.1318961f, -0.4374014f,
  +0.1712635f, -0.0570603f, +0.4415827f, +0.0826274f, +0.1057032f, -0.6546143f, +0.0526531f, -0.1050604f,
  -0.0087340f, -0.1959021f, -0.0567617f, -0.6307276f, +0.1590567f, +0.0253515f, +0.0869112f, +0.2044428f,
  +0.1321187f, +0.2472307f, -0.0082240f, +0.3139047f, +0.1182141f, +0.0099600f, +0.1212125f, +0.0910165f,
  +0.0398758f, -0.0130457f, +0.1601185f, +0.0241504f, +0.0629103f, -0.3147140f, -0.4803468f, -0.0441684f,
  -0.0626591f, +0.1465650f, +0.4277488f, +0.1905662f, -0.2150728f, -0.3117622f, +0.0274713f, +0.0387859f,
  +0.0222532f, +0.1778845f, +0.1071750f, +0.0445720f, +0.2731099f, +0.1873588f, -0.2392827f, +0.1071441f
);

const float biases[4] = float[4](
  +0.0318306f, -0.2079665f, +0.2028815f, +0.2665169f
);

vec4 hook() {
    const vec4 r[9][2] = vec4[9][2](
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 1.0f)))
    );

    float sum[4] = biases;
    for (int n = 0; n < 4; n++) {
        for (int i = 0; i < 9; i++) {
            const vec4 k0 = vec4(kernels[n * 8 * 9 + 8 * i + 0], kernels[n * 8 * 9 + 8 * i + 1], kernels[n * 8 * 9 + 8 * i + 2], kernels[n * 8 * 9 + 8 * i + 3]);
            const vec4 k1 = vec4(kernels[n * 8 * 9 + 8 * i + 4], kernels[n * 8 * 9 + 8 * i + 5], kernels[n * 8 * 9 + 8 * i + 6], kernels[n * 8 * 9 + 8 * i + 7]);
            sum[n] += (dot(k0, r[i][0]) + dot(k1, r[i][1]));
        }
    }

    return ACTIVE(vec4(sum[0], sum[1], sum[2], sum[3]) * 0.2000000f + TEX_BIND_L2_TEXOFF(vec2(0.0f, 0.0f)));
}

//!HOOK LUMA
//!DESC ARNet b8 Layer8 L1
//!WHEN OUTPUT.w LUMA.w / 1.2 > OUTPUT.h LUMA.h / 1.2 > *
//!BIND TMP1_L0
//!BIND TMP1_L1
//!BIND TMP2_L1
//!SAVE TMP2_L1
//!COMPONENTS 4

#define ACTIVE(v) (v)

#define TEX_BIND_L0_TEXOFF TMP1_L0_texOff
#define TEX_BIND_L0_TEX TMP1_L0_tex
#define TEX_BIND_L0_POS TMP1_L0_pos
#define TEX_BIND_L0_SIZE TMP1_L0_size
#define TEX_BIND_L0_PT TMP1_L0_pt

#define TEX_BIND_L1_TEXOFF TMP1_L1_texOff
#define TEX_BIND_L1_TEX TMP1_L1_tex
#define TEX_BIND_L1_POS TMP1_L1_pos
#define TEX_BIND_L1_SIZE TMP1_L1_size
#define TEX_BIND_L1_PT TMP1_L1_pt

#define TEX_BIND_L2_TEXOFF TMP2_L1_texOff
#define TEX_BIND_L2_TEX TMP2_L1_tex
#define TEX_BIND_L2_POS TMP2_L1_pos
#define TEX_BIND_L2_SIZE TMP2_L1_size
#define TEX_BIND_L2_PT TMP2_L1_pt

const float kernels[288] = float[288](
  +0.2632209f, +0.2619825f, -0.1314949f, -0.3463362f, -0.3488204f, -0.2450015f, -0.3076498f, -0.3196391f,
  +0.1318119f, -0.1414067f, +0.6406044f, -0.0999957f, -0.0739459f, -0.1697679f, -0.4440474f, -0.4458109f,
  -0.1597937f, +0.0548628f, -0.2798839f, +0.0047612f, -0.1837754f, -0.2320543f, -0.0067825f, -0.2812634f,
  +0.0589339f, +0.1065439f, +0.2780717f, +0.2159162f, +0.2772399f, -0.4309303f, -0.3950509f, -0.1372115f,
  -0.0873115f, -0.4371331f, +1.4874158f, +0.0960374f, -0.5189518f, -0.1440029f, -0.3733401f, -0.5415454f,
  -0.2640768f, -0.1193799f, -0.4688942f, -0.4771140f, -0.0546310f, +0.2355001f, +0.0661371f, -0.1300855f,
  +0.3119372f, +0.0454879f, -0.1599697f, -0.1843285f, +0.1985525f, -0.1763529f, -0.3428487f, -0.0071772f,
  +0.0815773f, +0.2900407f, +0.3587608f, -0.0293363f, +0.0387544f, -0.1396278f, +0.2907797f, -0.1158151f,
  -0.0784927f, +0.0438455f, -0.2983531f, +0.1277570f, +0.0276951f, -0.3460391f, +0.1278275f, -0.4035674f,
  +0.1861756f, +0.0578678f, -0.4803135f, -0.2980106f, +0.0177387f, -0.1127457f, -0.1008161f, -0.0109461f,
  +0.0261831f, +0.1353022f, -0.0268317f, -0.0270718f, +0.2666076f, -0.0963080f, +0.3394299f, +0.1707250f,
  +0.2594172f, +0.2149869f, -0.2688650f, +0.4815952f, -0.0537833f, +0.0723386f, +0.0547622f, +0.0005561f,
  -0.0303771f, +0.0227828f, -0.3873170f, -0.1182355f, +0.1480454f, +0.2464697f, -0.0673596f, +0.1416969f,
  +0.1120445f, +0.1221027f, -1.1449615f, -0.0311220f, +0.0919265f, +0.0927816f, +0.0169839f, +0.4767259f,
  +0.0972885f, +0.0638723f, +0.1454704f, +0.8028835f, -0.2693991f, -0.1632121f, +0.3080544f, -0.0447218f,
  +0.1143350f, -0.2135354f, -0.4505191f, -0.2546518f, -0.0747249f, +0.0651426f, -0.2664104f, -0.0490270f,
  +0.1294095f, -0.3551721f, -0.7772862f, +0.1124964f, -0.5385900f, +0.2348454f, -0.1244778f, -0.0192645f,
  -0.1424483f, -0.3591290f, +0.2043635f, -0.0233869f, -0.2727449f, -0.0578043f, -0.1051459f, -0.0346054f,
  -0.1786480f, +0.1380333f, +0.1894172f, -0.1491549f, +0.3779974f, -0.1101286f, +0.0494140f, +0.1836038f,
  -0.9332272f, -0.0261770f, +0.3696189f, -0.4028057f, +0.4474590f, +0.0674286f, +0.2790575f, +0.4474739f,
  -0.4928765f, +0.1395341f, +0.3165055f, -0.1048632f, +0.2622423f, -0.0683310f, +0.1219823f, +0.3225390f,
  +0.0523068f, -0.0475366f, +0.2643427f, -0.4810933f, +0.2448099f, -0.2417773f, -0.5650355f, +0.1061717f,
  -0.0211187f, +0.7727576f, -0.7770420f, -0.7831996f, +0.2255441f, +0.2279380f, +0.0898479f, +0.3589956f,
  -0.0337772f, -0.1497161f, +0.5287856f, +0.2658990f, +0.0807181f, -0.0960697f, +0.1172040f, +0.4387830f,
  -0.1005789f, -0.0042149f, +0.1229242f, -0.2053665f, +0.0927788f, -0.4557403f, -0.2100869f, +0.2021511f,
  +0.0423148f, -0.2760684f, -0.4254237f, -0.0841740f, +0.0164687f, -0.0297024f, -0.0842061f, +0.1754206f,
  +0.0239564f, +0.0124858f, +0.0524406f, +0.0515072f, +0.1884472f, -0.0025246f, -0.3357623f, +0.3041542f,
  -0.0000344f, -0.0403347f, -0.5284824f, -0.3843244f, +0.1777886f, +0.0744715f, -0.0464261f, -0.1665159f,
  +0.8312775f, +0.1639857f, -0.5426825f, -0.4254770f, -0.3479312f, -0.2418436f, -0.1564690f, -0.2251066f,
  +0.1958816f, +0.1397775f, -0.3074418f, +0.0642143f, -0.0620899f, +0.1125803f, -0.2754658f, -0.2068432f,
  -0.3470840f, +0.1314334f, -0.2228419f, -0.1903286f, -0.3426834f, -0.2712539f, -0.2386928f, +0.1999649f,
  +0.1868173f, +0.2530435f, -1.1690838f, +0.4145254f, -0.2718635f, -0.0813945f, -0.0021492f, -0.1443998f,
  -0.1362662f, +0.2861444f, -0.6747782f, -0.1645802f, -0.1901349f, +0.1762337f, +0.0486333f, -0.4139126f,
  +0.0437697f, -0.5576275f, -0.8239218f, -0.0110288f, -0.1536858f, -0.0704381f, +0.0166885f, -0.1608235f,
  -0.0815912f, -0.3029478f, -1.0744331f, +0.6159328f, -0.1742316f, -0.3646398f, -0.0498289f, -0.2831079f,
  -0.2094472f, -0.0740107f, -0.4607902f, +0.2674809f, +0.1952842f, +0.1039413f, -0.3255937f, +0.0698887f
);

const float biases[4] = float[4](
  +0.4976353f, -0.1594770f, -0.1645049f, -0.1948983f
);

vec4 hook() {
    const vec4 r[9][2] = vec4[9][2](
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 1.0f)))
    );

    float sum[4] = biases;
    for (int n = 0; n < 4; n++) {
        for (int i = 0; i < 9; i++) {
            const vec4 k0 = vec4(kernels[n * 8 * 9 + 8 * i + 0], kernels[n * 8 * 9 + 8 * i + 1], kernels[n * 8 * 9 + 8 * i + 2], kernels[n * 8 * 9 + 8 * i + 3]);
            const vec4 k1 = vec4(kernels[n * 8 * 9 + 8 * i + 4], kernels[n * 8 * 9 + 8 * i + 5], kernels[n * 8 * 9 + 8 * i + 6], kernels[n * 8 * 9 + 8 * i + 7]);
            sum[n] += (dot(k0, r[i][0]) + dot(k1, r[i][1]));
        }
    }

    return ACTIVE(vec4(sum[0], sum[1], sum[2], sum[3]) * 0.2000000f + TEX_BIND_L2_TEXOFF(vec2(0.0f, 0.0f)));
}

//!HOOK LUMA
//!DESC ARNet b8 Layer9 L0
//!WHEN OUTPUT.w LUMA.w / 1.2 > OUTPUT.h LUMA.h / 1.2 > *
//!BIND TMP2_L0
//!BIND TMP2_L1
//!SAVE TMP1_L0
//!COMPONENTS 4

#define ACTIVE(v) (max(v, v * 0.2000000f))

#define TEX_BIND_L0_TEXOFF TMP2_L0_texOff
#define TEX_BIND_L0_TEX TMP2_L0_tex
#define TEX_BIND_L0_POS TMP2_L0_pos
#define TEX_BIND_L0_SIZE TMP2_L0_size
#define TEX_BIND_L0_PT TMP2_L0_pt

#define TEX_BIND_L1_TEXOFF TMP2_L1_texOff
#define TEX_BIND_L1_TEX TMP2_L1_tex
#define TEX_BIND_L1_POS TMP2_L1_pos
#define TEX_BIND_L1_SIZE TMP2_L1_size
#define TEX_BIND_L1_PT TMP2_L1_pt

const float kernels[288] = float[288](
  +0.1939674f, -0.0522870f, -0.1482267f, -0.1683676f, -0.2874015f, -0.1451180f, +0.4136187f, +0.0252097f,
  +0.0720994f, -0.0335814f, -0.1720659f, -0.4930766f, -0.0469059f, -0.0026702f, -0.1019308f, +0.6050263f,
  -0.1786312f, -0.0751954f, +0.6325022f, +0.4560658f, -0.3963751f, -0.2570832f, +0.0509738f, +0.2808963f,
  -0.2028209f, -0.1412079f, +0.0120963f, -0.1587817f, -0.2197121f, +0.0038743f, +0.3100317f, -0.1302372f,
  -0.1466231f, +0.3083874f, -0.0215391f, -0.2839095f, +0.4605691f, +0.3486811f, -0.3585727f, +0.5296713f,
  +0.5045993f, +0.0397755f, +0.9893001f, +0.7566046f, +0.9941776f, +0.0514820f, -0.9079852f, +0.4859079f,
  -0.1098363f, +0.3124603f, -0.0762615f, -0.0642448f, -0.0217753f, +0.1476788f, +0.2890379f, -0.1798289f,
  +0.2047164f, +0.0855054f, -0.0816100f, -0.0582848f, +0.1640871f, -0.1447635f, +0.1429327f, -0.0663000f,
  -0.4984708f, -0.0735692f, -0.6889734f, +0.5282890f, -0.0272065f, +0.0250056f, -0.4211667f, -0.0112874f,
  +0.2333679f, -0.1972050f, +0.4944514f, +0.2276240f, +0.0834376f, +0.1707690f, -0.1775383f, -0.1876508f,
  -0.1137717f, -0.4401971f, +0.1611225f, -0.1911250f, -0.0550676f, +0.2295277f, +0.0526583f, -0.6497916f,
  -0.0167657f, -0.2844396f, +0.4215474f, -0.3489212f, -0.0303630f, +0.1107709f, +0.7299464f, -0.0318937f,
  +0.2489489f, -0.2170262f, -0.0375632f, +0.0775698f, -0.0077502f, +0.1270744f, -0.1749887f, -0.2706209f,
  -0.0842602f, -0.0286212f, -0.2585030f, -0.0395343f, +0.2300176f, +0.2043144f, +0.2937707f, -0.1791515f,
  +0.0595880f, -0.1986027f, +0.9329350f, -0.4902547f, +0.2000346f, -0.2504540f, +0.9062686f, +0.1931091f,
  -0.0536698f, +0.0335074f, +0.1047590f, +0.2619536f, +0.0098996f, +0.0186261f, -0.0078261f, +0.1120932f,
  +0.6199936f, +0.0802626f, -0.0195368f, +0.3219271f, -0.0052438f, +0.2403657f, +0.0021639f, -0.1955974f,
  +0.4433052f, -0.3173126f, +0.0764222f, +0.3540675f, -0.1750105f, +0.1013442f, -0.2208084f, +0.2644538f,
  -0.1571157f, +0.1905092f, -0.2664637f, -0.1374251f, -0.0678018f, +0.1638560f, -0.1556846f, +0.0047725f,
  +0.4200325f, +0.3781394f, +0.0591526f, -0.1757714f, -0.1724338f, -0.1814663f, -0.1545270f, +0.0086110f,
  +0.1520266f, +0.2974626f, +0.2118180f, -0.1303300f, -0.0579601f, -0.1354989f, -0.8328866f, -0.2008514f,
  -0.0924020f, +0.0239723f, -0.4643180f, +0.2193558f, +0.3961087f, -0.3191444f, +0.2158054f, +0.2373583f,
  -0.7210158f, -0.3686687f, -0.1474384f, -0.2554016f, +0.0481695f, -0.0506559f, +0.3400141f, +0.1672641f,
  +0.2008403f, -0.0097000f, +0.1663261f, +0.2063774f, +0.2258814f, -0.3870046f, -0.0253252f, +0.3716389f,
  +0.0059492f, +0.1744535f, -0.1959417f, +0.0383764f, +0.0834698f, +0.2006991f, +0.0631601f, +0.0289177f,
  +0.1868506f, +0.0572079f, -0.3196343f, +0.0096182f, -0.1588326f, -0.0146279f, +0.4579557f, -0.0868185f,
  -0.1114031f, -0.0313369f, +0.1147660f, -0.0781498f, -0.2261062f, +0.0153720f, -0.0089765f, +0.1120614f,
  +0.3587002f, +0.0647757f, +0.0947459f, -0.2258736f, +0.3944852f, +0.3336220f, -0.3309441f, -0.0072659f,
  +0.2697529f, +0.0854424f, +0.2234906f, -0.1936737f, +0.2672485f, -0.1591047f, -0.2428414f, +0.0154964f,
  +0.2883034f, +0.3188804f, +0.2891098f, -0.2238236f, +0.1657605f, +0.1025884f, +0.0359193f, +0.2846869f,
  -0.0838243f, -0.1128342f, -0.2550080f, -0.1531147f, +0.3304029f, +0.4203197f, +0.3753345f, +0.0866603f,
  +0.2996908f, +0.0029826f, +0.0008551f, +0.3254727f, -0.8756375f, +0.0042679f, +0.2493596f, -0.0999290f,
  -0.0783053f, +0.1698162f, -0.1757867f, +0.0106586f, -0.5444039f, +0.2608685f, +0.1807065f, +0.4565951f,
  -0.1149850f, -0.3525063f, -0.1253631f, -0.0368464f, +0.5506940f, -0.2738111f, -0.1205682f, +0.2633547f,
  -0.3065726f, -0.2453044f, -0.2074097f, +0.1357333f, +0.0216720f, +0.1855179f, +0.1269967f, +0.0929867f,
  -0.0615010f, +0.0733857f, -0.0733683f, +0.3743656f, -0.2179027f, +0.0067003f, +0.5843606f, +0.2085871f
);

const float biases[4] = float[4](
  -0.0670727f, -0.0637888f, +0.0046925f, -0.0581090f
);

vec4 hook() {
    const vec4 r[9][2] = vec4[9][2](
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 1.0f)))
    );

    float sum[4] = biases;
    for (int n = 0; n < 4; n++) {
        for (int i = 0; i < 9; i++) {
            const vec4 k0 = vec4(kernels[n * 8 * 9 + 8 * i + 0], kernels[n * 8 * 9 + 8 * i + 1], kernels[n * 8 * 9 + 8 * i + 2], kernels[n * 8 * 9 + 8 * i + 3]);
            const vec4 k1 = vec4(kernels[n * 8 * 9 + 8 * i + 4], kernels[n * 8 * 9 + 8 * i + 5], kernels[n * 8 * 9 + 8 * i + 6], kernels[n * 8 * 9 + 8 * i + 7]);
            sum[n] += (dot(k0, r[i][0]) + dot(k1, r[i][1]));
        }
    }

    return ACTIVE(vec4(sum[0], sum[1], sum[2], sum[3]));
}

//!HOOK LUMA
//!DESC ARNet b8 Layer9 L1
//!WHEN OUTPUT.w LUMA.w / 1.2 > OUTPUT.h LUMA.h / 1.2 > *
//!BIND TMP2_L0
//!BIND TMP2_L1
//!SAVE TMP1_L1
//!COMPONENTS 4

#define ACTIVE(v) (max(v, v * 0.2000000f))

#define TEX_BIND_L0_TEXOFF TMP2_L0_texOff
#define TEX_BIND_L0_TEX TMP2_L0_tex
#define TEX_BIND_L0_POS TMP2_L0_pos
#define TEX_BIND_L0_SIZE TMP2_L0_size
#define TEX_BIND_L0_PT TMP2_L0_pt

#define TEX_BIND_L1_TEXOFF TMP2_L1_texOff
#define TEX_BIND_L1_TEX TMP2_L1_tex
#define TEX_BIND_L1_POS TMP2_L1_pos
#define TEX_BIND_L1_SIZE TMP2_L1_size
#define TEX_BIND_L1_PT TMP2_L1_pt

const float kernels[288] = float[288](
  +0.2212186f, -0.1595402f, +0.2742360f, -0.1747737f, +0.4194108f, +0.2555449f, -0.2175839f, -0.0386592f,
  +0.1191761f, -0.1377872f, -0.0293001f, -0.0300984f, -0.0558571f, +0.4236270f, +0.5137939f, +0.1622626f,
  +0.1694785f, +0.3372134f, +0.1257389f, -0.1238978f, -0.0736872f, -0.1834462f, +0.0038856f, +0.2193463f,
  +0.5149525f, -0.1540908f, -0.1776334f, -0.1291473f, +0.2198147f, -0.0746369f, -0.0602279f, +0.1304237f,
  +0.5207742f, -0.1687832f, +0.1019600f, -0.0778979f, -0.3903211f, -0.2907970f, +1.1221584f, -0.0726999f,
  +0.3252129f, -0.2289447f, -0.2997070f, +0.1331119f, -0.1854070f, +0.4616390f, +0.1615397f, +0.2709180f,
  -0.2020777f, -0.1648948f, -0.2175094f, +0.0025237f, +0.0860828f, +0.0299034f, -0.0528463f, -0.2046085f,
  +0.0420948f, -0.3189023f, +0.2773004f, -0.5087318f, -0.0608977f, +0.0538742f, +0.3540609f, +0.1737131f,
  -0.1013526f, +0.0181674f, -0.1228762f, +0.2696646f, -0.4645485f, +0.0802404f, -0.3046175f, -0.0722401f,
  +0.1693585f, -0.0307302f, +0.0809594f, -0.0639374f, -0.2999269f, -0.1265369f, +0.3466744f, +0.0984044f,
  -0.0093195f, -0.0822212f, -0.0727199f, -0.3232498f, -0.3692979f, -0.1166548f, -0.0618076f, +0.6918534f,
  -0.0782906f, -0.2500895f, -0.1454617f, +0.2656351f, +0.0328909f, -0.0398336f, +0.1747107f, +0.1154498f,
  -0.1731888f, +0.0403087f, +0.2064236f, +0.3220411f, +0.0844155f, +0.3729204f, +0.4087429f, -0.2441617f,
  -0.4959822f, +0.3331464f, -0.0022022f, +0.4937930f, -0.3172744f, +0.2296120f, +0.0752488f, -0.3816701f,
  -0.1368914f, -0.1790004f, +0.2364160f, -0.3011054f, +0.0406215f, -0.2283003f, +0.2361286f, -0.0828656f,
  +0.4831552f, -0.0765181f, +0.0476118f, +0.1236731f, -0.1975436f, +0.2959429f, +0.1778260f, -0.1015946f,
  -0.2695945f, -0.1433023f, -0.0010057f, -0.5008870f, +0.0554314f, -0.0075293f, -0.3356037f, +0.1275717f,
  -0.3124932f, -0.0055053f, +0.1162923f, -0.1054176f, +0.2299838f, +0.0034197f, +0.2079162f, +0.0987653f,
  +0.3805994f, -0.0222888f, +0.0849825f, -0.1845031f, -0.0760576f, +0.4579937f, -0.1568909f, -0.2097071f,
  +0.2279510f, +0.4103447f, -0.1120856f, +0.1505617f, -0.1301749f, +0.3295987f, +0.1892123f, +0.0122696f,
  -0.0287411f, +0.1394052f, -0.4241524f, -0.2647947f, -0.4115136f, +0.1717121f, -0.2374215f, -0.4299139f,
  +0.0603481f, -0.6341887f, +0.3033520f, -0.0464545f, +0.4110681f, -0.1463492f, -0.4629145f, +0.0997405f,
  +1.0173029f, +0.3734903f, +0.0893680f, -0.1329164f, -0.0789431f, -0.1551005f, +0.3274360f, +0.1684143f,
  +0.1511922f, -0.2518653f, -0.7686596f, -0.0508709f, -0.2528690f, +0.3186876f, +0.0082271f, -0.0499666f,
  +0.2482471f, -0.3774040f, +0.9866167f, -0.3246650f, +0.2611609f, +0.4651350f, -0.4137430f, +0.2337460f,
  -0.1300418f, -0.2723444f, +0.4704777f, +0.6416661f, -0.6015183f, -1.1086746f, -0.7560183f, +1.0159224f,
  +0.2395980f, -0.0019686f, +0.2519939f, -0.3700441f, -0.2325659f, -0.0184959f, +0.1176824f, -0.2256412f,
  +0.2492072f, +0.0059367f, +0.2548261f, +0.0171544f, +0.0148905f, -0.0719349f, -0.3484926f, +0.0485005f,
  +0.1456928f, +0.1580910f, +0.2648900f, -0.2847332f, +0.3955103f, -0.1841671f, +0.0712177f, +0.0754727f,
  +0.2821112f, +0.1951855f, +0.2826448f, +0.0419111f, -0.0283745f, -0.2455221f, -0.3498923f, +0.0899451f,
  -0.5644990f, -0.1393446f, +0.2299325f, -0.2222116f, -0.0316533f, +0.2985170f, -0.1322182f, -0.1114999f,
  +0.0291762f, +0.1554203f, -0.4255255f, -0.2464456f, +0.2284310f, -0.2398277f, -0.1862334f, +0.1348279f,
  -0.0069560f, +0.1201653f, -0.4678766f, +0.4321949f, +0.2605862f, -0.0110539f, -0.8281829f, +0.1360488f,
  -0.0034177f, -0.0719798f, -0.0571259f, -0.1236755f, +0.0209665f, -0.0245124f, +0.2797651f, +0.0616512f,
  -0.3567103f, -0.0692217f, -0.8512002f, +0.2495307f, -0.5876433f, -0.3488896f, +0.4007637f, -0.0644818f,
  -0.2011664f, +0.2095926f, -0.2559063f, -0.0127438f, -0.4752995f, +0.0294871f, +0.4119889f, +0.2207112f
);

const float biases[4] = float[4](
  +0.1211976f, +0.0761031f, -0.1078211f, +0.0416074f
);

vec4 hook() {
    const vec4 r[9][2] = vec4[9][2](
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 1.0f)))
    );

    float sum[4] = biases;
    for (int n = 0; n < 4; n++) {
        for (int i = 0; i < 9; i++) {
            const vec4 k0 = vec4(kernels[n * 8 * 9 + 8 * i + 0], kernels[n * 8 * 9 + 8 * i + 1], kernels[n * 8 * 9 + 8 * i + 2], kernels[n * 8 * 9 + 8 * i + 3]);
            const vec4 k1 = vec4(kernels[n * 8 * 9 + 8 * i + 4], kernels[n * 8 * 9 + 8 * i + 5], kernels[n * 8 * 9 + 8 * i + 6], kernels[n * 8 * 9 + 8 * i + 7]);
            sum[n] += (dot(k0, r[i][0]) + dot(k1, r[i][1]));
        }
    }

    return ACTIVE(vec4(sum[0], sum[1], sum[2], sum[3]));
}

//!HOOK LUMA
//!DESC ARNet b8 Layer10 L0
//!WHEN OUTPUT.w LUMA.w / 1.2 > OUTPUT.h LUMA.h / 1.2 > *
//!BIND TMP1_L0
//!BIND TMP1_L1
//!BIND TMP2_L0
//!SAVE TMP2_L0
//!COMPONENTS 4

#define ACTIVE(v) (v)

#define TEX_BIND_L0_TEXOFF TMP1_L0_texOff
#define TEX_BIND_L0_TEX TMP1_L0_tex
#define TEX_BIND_L0_POS TMP1_L0_pos
#define TEX_BIND_L0_SIZE TMP1_L0_size
#define TEX_BIND_L0_PT TMP1_L0_pt

#define TEX_BIND_L1_TEXOFF TMP1_L1_texOff
#define TEX_BIND_L1_TEX TMP1_L1_tex
#define TEX_BIND_L1_POS TMP1_L1_pos
#define TEX_BIND_L1_SIZE TMP1_L1_size
#define TEX_BIND_L1_PT TMP1_L1_pt

#define TEX_BIND_L2_TEXOFF TMP2_L0_texOff
#define TEX_BIND_L2_TEX TMP2_L0_tex
#define TEX_BIND_L2_POS TMP2_L0_pos
#define TEX_BIND_L2_SIZE TMP2_L0_size
#define TEX_BIND_L2_PT TMP2_L0_pt

const float kernels[288] = float[288](
  -0.2536395f, +0.0420992f, -0.1556912f, +0.1617762f, -0.1168572f, +0.1772428f, +0.0797199f, -0.1892793f,
  -0.3956154f, +0.0333516f, -0.1108768f, -0.0807689f, -0.2032638f, +0.2775160f, +0.1204222f, -0.1497454f,
  -0.0814809f, -0.0018135f, -0.0450397f, +0.0496451f, -0.0253862f, -0.0651703f, -0.5153110f, -0.0143062f,
  -0.2332761f, -0.2070584f, +0.0591294f, -0.0520024f, -0.0359840f, +0.0170201f, +0.0411336f, -0.0248306f,
  -0.1161805f, +0.0718233f, +0.2502348f, -0.1638126f, -0.3131356f, -0.0318596f, -1.1109724f, +0.0018263f,
  -0.2502788f, -0.0957021f, +0.0685680f, -0.3112028f, -0.2762040f, +0.0336373f, -0.2736044f, +0.0112644f,
  -0.2888589f, +0.0321597f, -0.0582018f, +0.0977278f, -0.1242875f, -0.0417915f, -0.0179856f, +0.0485391f,
  -0.2477499f, +0.0895031f, +0.1823762f, -0.0583658f, -0.2736280f, -0.2753946f, -0.0359759f, -0.3341658f,
  -0.2055754f, -0.0068343f, -0.1354932f, +0.0300329f, -0.2043544f, +0.0812343f, -0.1024261f, +0.1424000f,
  +0.3307713f, -0.2460197f, +0.2086670f, -0.0625350f, +0.3858216f, -0.0196445f, +0.1409640f, +0.1605010f,
  -0.1829278f, +0.2363801f, -0.0214062f, -0.0609722f, +0.2659099f, -0.2212300f, -0.2776160f, -0.0243703f,
  +0.1734860f, -0.1425541f, -0.0738859f, +0.2271102f, +0.1366533f, +0.3787391f, +0.1826825f, -0.0551047f,
  +0.1799960f, +0.1266457f, -0.1778886f, -0.2281350f, -0.0246536f, +0.1587739f, +0.4362136f, -0.0957539f,
  +0.1602809f, +0.0681431f, +0.8114588f, +0.4334678f, +0.0975476f, -0.4616885f, -0.3718668f, -0.2215923f,
  +0.1035504f, -0.0140557f, -0.0840269f, +0.1665533f, -0.1069862f, +0.0208532f, +0.0807462f, -0.2380942f,
  +0.0116760f, +0.0792071f, +0.0672500f, -0.1556773f, -0.1669747f, +0.1792294f, +0.2706006f, +0.0028033f,
  -0.3572218f, -0.0184245f, +0.3072837f, -0.0904640f, -0.0329153f, -0.0784992f, -0.0131494f, -0.3825015f,
  -0.0889252f, -0.1355777f, +0.0160247f, -0.0259827f, +0.0432066f, -0.0777517f, -0.1687744f, -0.0988071f,
  +0.1921763f, -0.0365113f, +0.2874773f, +0.0449838f, +0.3496342f, -0.2974657f, -0.0945840f, +0.0142817f,
  +0.4699863f, -0.1395745f, -0.1549272f, -0.2625928f, -0.1033634f, -0.0283638f, +0.6876796f, -0.1699553f,
  +0.3700393f, +0.1558988f, +0.1895775f, -0.0716369f, -0.0191639f, -0.3292918f, +0.8666342f, +0.1816811f,
  -0.1283806f, +0.0675692f, +0.1250668f, -0.0946549f, +0.0492182f, -0.2012027f, +0.1726157f, +0.3534540f,
  +0.0158264f, +0.1395191f, +0.2257714f, -0.1902618f, -0.1405666f, -0.3487651f, +0.2104167f, +0.7996181f,
  +0.8300269f, +0.3502890f, +0.0727396f, -0.2474934f, +0.1036212f, -0.1554030f, +0.4930067f, +0.4783216f,
  +0.1560888f, +0.4595095f, -0.1971487f, -0.0457538f, -0.0738036f, +0.1953446f, +0.0167919f, -0.0427009f,
  +1.3351277f, +0.0427533f, -0.4469566f, -0.0334459f, -0.2606555f, +0.0922399f, +0.2267899f, +0.2746983f,
  +0.2119051f, +0.1888382f, +0.2350115f, -0.1746829f, +0.1572042f, -0.0126229f, +0.0174161f, -0.1196776f,
  +0.0610312f, +0.0969444f, -0.1647210f, -0.1001932f, -0.3564092f, -0.0852619f, +0.1016119f, +0.1246264f,
  -0.0717281f, -0.1393330f, +0.0899061f, +0.2228919f, +0.6668061f, +0.4595933f, +0.3791952f, -0.2997652f,
  +0.0279462f, +0.1368760f, -0.2453644f, +0.1137151f, +0.1336764f, -0.3938599f, -0.4263921f, +0.2673038f,
  +0.2378686f, +0.6234929f, -0.1520876f, +0.2267028f, -0.2517962f, +0.4162307f, +0.0694632f, -0.2304222f,
  -0.2367059f, +0.0993685f, +0.2818596f, +0.2133809f, -0.1056396f, -0.6306259f, +0.0777954f, +0.1184176f,
  -0.1845637f, -0.0844047f, -0.0743608f, +0.1112817f, -0.0982639f, -0.4412045f, -0.2979559f, -0.0970574f,
  -0.0482381f, +0.1602839f, +0.0340358f, +0.1987756f, +0.0492013f, -0.1049100f, +0.1442361f, -0.2122895f,
  +0.0720272f, +0.1041910f, +0.2110423f, +0.1395708f, -0.0161149f, +0.1752184f, -0.0682990f, -0.0278116f,
  -0.1543731f, -0.0690673f, +0.0577115f, -0.0284951f, +0.0094747f, -0.1326597f, -0.1068058f, +0.0466692f
);

const float biases[4] = float[4](
  +0.0421449f, -0.2258040f, +0.0495972f, -0.0275995f
);

vec4 hook() {
    const vec4 r[9][2] = vec4[9][2](
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 1.0f)))
    );

    float sum[4] = biases;
    for (int n = 0; n < 4; n++) {
        for (int i = 0; i < 9; i++) {
            const vec4 k0 = vec4(kernels[n * 8 * 9 + 8 * i + 0], kernels[n * 8 * 9 + 8 * i + 1], kernels[n * 8 * 9 + 8 * i + 2], kernels[n * 8 * 9 + 8 * i + 3]);
            const vec4 k1 = vec4(kernels[n * 8 * 9 + 8 * i + 4], kernels[n * 8 * 9 + 8 * i + 5], kernels[n * 8 * 9 + 8 * i + 6], kernels[n * 8 * 9 + 8 * i + 7]);
            sum[n] += (dot(k0, r[i][0]) + dot(k1, r[i][1]));
        }
    }

    return ACTIVE(vec4(sum[0], sum[1], sum[2], sum[3]) * 0.2000000f + TEX_BIND_L2_TEXOFF(vec2(0.0f, 0.0f)));
}

//!HOOK LUMA
//!DESC ARNet b8 Layer10 L1
//!WHEN OUTPUT.w LUMA.w / 1.2 > OUTPUT.h LUMA.h / 1.2 > *
//!BIND TMP1_L0
//!BIND TMP1_L1
//!BIND TMP2_L1
//!SAVE TMP2_L1
//!COMPONENTS 4

#define ACTIVE(v) (v)

#define TEX_BIND_L0_TEXOFF TMP1_L0_texOff
#define TEX_BIND_L0_TEX TMP1_L0_tex
#define TEX_BIND_L0_POS TMP1_L0_pos
#define TEX_BIND_L0_SIZE TMP1_L0_size
#define TEX_BIND_L0_PT TMP1_L0_pt

#define TEX_BIND_L1_TEXOFF TMP1_L1_texOff
#define TEX_BIND_L1_TEX TMP1_L1_tex
#define TEX_BIND_L1_POS TMP1_L1_pos
#define TEX_BIND_L1_SIZE TMP1_L1_size
#define TEX_BIND_L1_PT TMP1_L1_pt

#define TEX_BIND_L2_TEXOFF TMP2_L1_texOff
#define TEX_BIND_L2_TEX TMP2_L1_tex
#define TEX_BIND_L2_POS TMP2_L1_pos
#define TEX_BIND_L2_SIZE TMP2_L1_size
#define TEX_BIND_L2_PT TMP2_L1_pt

const float kernels[288] = float[288](
  -0.4106334f, -0.1128135f, +0.1189928f, -0.1790168f, +0.1467505f, +0.2941669f, -0.1352803f, +0.1451075f,
  -0.4289393f, +0.2850852f, -0.3452525f, +0.1736311f, -0.0471295f, +0.1056330f, -0.2220522f, -0.0501532f,
  -0.1450566f, +0.0095590f, -0.0313351f, +0.2279197f, -0.0135992f, +0.4802848f, -0.4925468f, -0.1357092f,
  -0.0964707f, -0.3840357f, +0.1842755f, -0.2134412f, +0.1655800f, +0.2234131f, +0.4485193f, +0.0258162f,
  -0.3352145f, -0.3117059f, +0.5732054f, +0.4367871f, +0.6022736f, +0.2376924f, +0.0821261f, -0.2557924f,
  +0.0032665f, -0.0425541f, -0.0901053f, -0.2204346f, -0.0709478f, -0.4372778f, -0.2744973f, -0.0133558f,
  +0.1037900f, -0.1127355f, +0.0521446f, +0.0473091f, -0.1594757f, -0.0251448f, +0.0660729f, -0.1683607f,
  -0.1435550f, +0.5660746f, +0.5588143f, +0.0838743f, -0.0660500f, +0.1844417f, -0.0152351f, -0.1605509f,
  -0.2344740f, +0.0400803f, +0.0518085f, -0.0376011f, -0.0741230f, +0.1741993f, -0.1471063f, +0.0798759f,
  +0.1975116f, -0.0753268f, -0.1295671f, -0.3470277f, -0.1603750f, -0.2368702f, +0.5499445f, +0.2636794f,
  +0.4245971f, -0.0494413f, +0.0788963f, -0.2293316f, -0.1002226f, -0.0393195f, +0.4293258f, +0.0812656f,
  +0.6323047f, -0.1767118f, -0.2261057f, -0.2596341f, +0.0286006f, -0.2681647f, +0.1568500f, +0.3911181f,
  +0.1954550f, +0.2189395f, -0.4660785f, -0.2259052f, -0.0464492f, +0.0713062f, +0.1631389f, -0.0530086f,
  -0.6262357f, +0.3036758f, -0.4890110f, -0.5321097f, +0.3323019f, -0.1545587f, -1.0383123f, -0.1306219f,
  +0.6144360f, +0.0454599f, +0.1979250f, -0.4817043f, +0.2455286f, -0.4727279f, -0.1818149f, +0.0894885f,
  +0.1652403f, -0.3488277f, +0.0105301f, -0.6271433f, +0.2128582f, -0.1060517f, +0.4510348f, +0.1856944f,
  +0.1307056f, -0.3616821f, -0.2313322f, -0.3361153f, +0.2974666f, +0.1218713f, +0.2125814f, +0.0947100f,
  +0.2643281f, +0.0256786f, +0.1775127f, -0.3161451f, -0.0484218f, +0.2019485f, +0.1182443f, -0.0779266f,
  -0.0151492f, -0.0893497f, +0.1923238f, -0.1496098f, +0.0370648f, -0.1229715f, +0.3730212f, +0.1580030f,
  -0.0142864f, +0.0914920f, -0.0910616f, -0.4568787f, -0.2735081f, -0.0835954f, -0.1100182f, +0.0779166f,
  +0.0241670f, -0.1559765f, -0.0992746f, -0.2214171f, -0.1162880f, +0.0985575f, +0.1109507f, +0.0914733f,
  +0.3107258f, -0.5034001f, -0.2328116f, -0.3833556f, -0.2511908f, -0.1281008f, +0.3664693f, +0.3700537f,
  -0.3342529f, +0.0309791f, +0.1501471f, -0.2870679f, -0.4546800f, -0.0945818f, -0.6364378f, -0.3446326f,
  -0.0346793f, +0.1181634f, -0.1506984f, -0.1791066f, +0.3332699f, +0.0508745f, +0.0461855f, -0.0918426f,
  +0.1222827f, -0.3249928f, +0.0050562f, -0.3624517f, -0.0752660f, -0.0951019f, +0.6003385f, +0.1934006f,
  -0.2281331f, -0.2432795f, +0.1996264f, -0.0739405f, -0.3295049f, +0.2681240f, +0.6217813f, -0.0322383f,
  +0.1008334f, +0.0265266f, +0.2975315f, +0.0068484f, +0.0444467f, +0.3427564f, +0.4388741f, -0.1564865f,
  -0.4355240f, -0.0039750f, -0.2827012f, +0.0039769f, +0.1033618f, -0.1963126f, -0.1667365f, -0.1236259f,
  -0.1770698f, -0.1064009f, +0.1998917f, +0.2853673f, +0.1804496f, -0.0125183f, -0.4990267f, -0.2875212f,
  -0.0533997f, +0.0672771f, -0.1180257f, -0.2682214f, +0.2546279f, -0.0149988f, -0.3911979f, -0.1038566f,
  -0.6136738f, +0.1328646f, +0.1499412f, +0.0398139f, +0.1694981f, +0.1190750f, -0.5729585f, -0.1195799f,
  -0.7916113f, -0.2095829f, +0.2114385f, -0.0702436f, +0.1354559f, -0.0423813f, -0.0507401f, -0.0637353f,
  +0.0862887f, +0.2635963f, +0.1433037f, +0.2228753f, +0.0331348f, -0.0152259f, -0.5216029f, -0.1427269f,
  -0.9388800f, -0.2187585f, +0.1576495f, -0.2137437f, +0.0160824f, -0.1575492f, +0.0669863f, +0.0650662f,
  -0.4072464f, -0.3287262f, +0.1300993f, +0.0849678f, -0.2329443f, -0.1246537f, +0.0715865f, +0.0490267f,
  -0.1161726f, +0.0839491f, +0.0804306f, +0.0599232f, -0.0277310f, +0.1469544f, +0.0571453f, -0.1924858f
);

const float biases[4] = float[4](
  +0.2023014f, -0.0899850f, +0.0810960f, +0.0178464f
);

vec4 hook() {
    const vec4 r[9][2] = vec4[9][2](
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 1.0f)))
    );

    float sum[4] = biases;
    for (int n = 0; n < 4; n++) {
        for (int i = 0; i < 9; i++) {
            const vec4 k0 = vec4(kernels[n * 8 * 9 + 8 * i + 0], kernels[n * 8 * 9 + 8 * i + 1], kernels[n * 8 * 9 + 8 * i + 2], kernels[n * 8 * 9 + 8 * i + 3]);
            const vec4 k1 = vec4(kernels[n * 8 * 9 + 8 * i + 4], kernels[n * 8 * 9 + 8 * i + 5], kernels[n * 8 * 9 + 8 * i + 6], kernels[n * 8 * 9 + 8 * i + 7]);
            sum[n] += (dot(k0, r[i][0]) + dot(k1, r[i][1]));
        }
    }

    return ACTIVE(vec4(sum[0], sum[1], sum[2], sum[3]) * 0.2000000f + TEX_BIND_L2_TEXOFF(vec2(0.0f, 0.0f)));
}

//!HOOK LUMA
//!DESC ARNet b8 Layer11 L0
//!WHEN OUTPUT.w LUMA.w / 1.2 > OUTPUT.h LUMA.h / 1.2 > *
//!BIND TMP2_L0
//!BIND TMP2_L1
//!SAVE TMP1_L0
//!COMPONENTS 4

#define ACTIVE(v) (max(v, v * 0.2000000f))

#define TEX_BIND_L0_TEXOFF TMP2_L0_texOff
#define TEX_BIND_L0_TEX TMP2_L0_tex
#define TEX_BIND_L0_POS TMP2_L0_pos
#define TEX_BIND_L0_SIZE TMP2_L0_size
#define TEX_BIND_L0_PT TMP2_L0_pt

#define TEX_BIND_L1_TEXOFF TMP2_L1_texOff
#define TEX_BIND_L1_TEX TMP2_L1_tex
#define TEX_BIND_L1_POS TMP2_L1_pos
#define TEX_BIND_L1_SIZE TMP2_L1_size
#define TEX_BIND_L1_PT TMP2_L1_pt

const float kernels[288] = float[288](
  -0.1484771f, +0.1521574f, -0.0779594f, +0.0763035f, -0.0520303f, +0.1543810f, +0.1996158f, -0.0544786f,
  -0.2020429f, +0.2099656f, -0.2398018f, +0.2536653f, -0.5128062f, +0.0098236f, +0.1907840f, -0.0947067f,
  +0.1386555f, -0.2859046f, -0.1414960f, -0.2717328f, -0.3046440f, +0.0730823f, +0.2251372f, +0.0097633f,
  -0.4718037f, -0.0098317f, -0.0044284f, +0.1803340f, -0.0313977f, -0.1685339f, +0.3761708f, +0.3111254f,
  +0.2101331f, -0.1568742f, -0.2095047f, +0.0353770f, -0.3732324f, +0.1639638f, +0.5077620f, -0.3369896f,
  -0.1141961f, -0.2273969f, +0.3426763f, -0.1735729f, +0.2120999f, +0.6007242f, -1.1286469f, +0.2898697f,
  -0.2354317f, -0.0727260f, +0.1407418f, -0.1874047f, +0.1809240f, +0.1269089f, +0.0230265f, +0.0027577f,
  -0.5493301f, +0.3183512f, -0.3080003f, -0.0478505f, +0.1021072f, -0.2112481f, +0.1931687f, +0.2470637f,
  +0.0040054f, +0.1451655f, +0.3184171f, -0.4717104f, -0.0854638f, +0.4220744f, +0.2236581f, -0.1848647f,
  +0.4755992f, +0.1981167f, -0.2144810f, +0.2185615f, -0.3175379f, -0.4904164f, +0.2652446f, -0.2500003f,
  -0.1931687f, -0.3528383f, -0.3260126f, -0.1422858f, -0.1875375f, -0.1071317f, -0.5974770f, -0.5308063f,
  -0.0454443f, -0.0475035f, +0.0093675f, +0.0369179f, -0.1606320f, -0.0155918f, +0.1016968f, -0.1437190f,
  +0.4529146f, +0.1731653f, +0.3003069f, +0.0541029f, -0.4375774f, -0.0961085f, -0.1155391f, -0.0911004f,
  -0.3330771f, +0.2619726f, +0.7289661f, -0.6688536f, +0.8585180f, +0.3070276f, -1.1136220f, -0.2431510f,
  -0.1388333f, -0.3305536f, +0.1830756f, -0.0226674f, +0.2834310f, +0.1836298f, +0.2563850f, -0.1356043f,
  -0.0760428f, +0.1817411f, +0.0628552f, +0.1739695f, -0.2309178f, -0.0977478f, -0.0203359f, -0.0985114f,
  -0.1807263f, -0.0404867f, +0.0138181f, -0.2087032f, +0.2100013f, +0.1443215f, -0.1029239f, -0.0189716f,
  -0.0724508f, +0.0967881f, +0.1044433f, -0.0176488f, -0.0055111f, -0.1209907f, -0.0935511f, +0.0863566f,
  -0.2650053f, -0.0299237f, +0.0103586f, +0.0763643f, -0.0831628f, +0.0098053f, -0.0868988f, +0.2100911f,
  +0.0007892f, -0.3095339f, -0.1511820f, +0.1456963f, -0.1589913f, -0.0181702f, +0.4678019f, +0.2366012f,
  -0.1967518f, -0.2568374f, -0.3232426f, -0.1573835f, -0.0200160f, +0.0105722f, -0.1037996f, -0.0761540f,
  -0.2145313f, +0.1214736f, -0.1165247f, +0.0965331f, +0.0925787f, -0.0515384f, -0.1043487f, +0.1956234f,
  +0.8161342f, +0.4876860f, -0.4026848f, -0.2029939f, +0.2534586f, -0.0647596f, +0.7993359f, +0.0536541f,
  +0.1947414f, -0.0097501f, -0.2924244f, -0.3236130f, +0.1740983f, +0.4703699f, -0.1681427f, +0.0216988f,
  +0.1428243f, +0.1046804f, -0.0023190f, +0.0450289f, -0.0490594f, -0.0850404f, -0.0720956f, +0.1996973f,
  +0.0192956f, +0.1497408f, -0.0610071f, +0.3871614f, -0.1419303f, -0.1981197f, -0.3136938f, +0.4746738f,
  +0.1434826f, +0.0676856f, -0.0447624f, +0.2789132f, -0.2309439f, -0.1541688f, -0.2474411f, +0.2218646f,
  -0.0248239f, +0.0137256f, -0.1372843f, -0.0166639f, -0.0085729f, -0.2483278f, -0.1175588f, -0.0064691f,
  -0.0193221f, -0.1339619f, -0.2162991f, -0.2009625f, +0.1981852f, -0.1425428f, -0.2695073f, -0.0833974f,
  -0.1791664f, -0.2489632f, +0.0232162f, +0.1126610f, +0.2319291f, -0.1959498f, +0.0902803f, +0.1228962f,
  +0.4653156f, +0.1466005f, -0.2444524f, -0.0192042f, -0.1064173f, -0.3139821f, -0.0811862f, -0.1511600f,
  -0.5545143f, -0.2430982f, +0.5274432f, -0.1559716f, +0.2369037f, +0.0351466f, -0.3216052f, -0.2356555f,
  +0.0715318f, +0.2503611f, +0.5919080f, -0.1019960f, +0.4013741f, -0.5195233f, -0.2739727f, -0.4229334f,
  +0.3524031f, +0.1130062f, +0.0722729f, -0.0352212f, -0.3121865f, -0.0350865f, -0.1080654f, -0.1669765f,
  +0.0567478f, -0.2870994f, +0.0045482f, +0.1789834f, -0.0917276f, -0.2201570f, -0.3447311f, -0.2462581f,
  +0.3181019f, -0.0428368f, -0.0730585f, +0.2396960f, -0.0219467f, -0.3282671f, -0.2290788f, +0.1679255f
);

const float biases[4] = float[4](
  +0.0243349f, +0.0187458f, +0.0371164f, +0.1243167f
);

vec4 hook() {
    const vec4 r[9][2] = vec4[9][2](
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 1.0f)))
    );

    float sum[4] = biases;
    for (int n = 0; n < 4; n++) {
        for (int i = 0; i < 9; i++) {
            const vec4 k0 = vec4(kernels[n * 8 * 9 + 8 * i + 0], kernels[n * 8 * 9 + 8 * i + 1], kernels[n * 8 * 9 + 8 * i + 2], kernels[n * 8 * 9 + 8 * i + 3]);
            const vec4 k1 = vec4(kernels[n * 8 * 9 + 8 * i + 4], kernels[n * 8 * 9 + 8 * i + 5], kernels[n * 8 * 9 + 8 * i + 6], kernels[n * 8 * 9 + 8 * i + 7]);
            sum[n] += (dot(k0, r[i][0]) + dot(k1, r[i][1]));
        }
    }

    return ACTIVE(vec4(sum[0], sum[1], sum[2], sum[3]));
}

//!HOOK LUMA
//!DESC ARNet b8 Layer11 L1
//!WHEN OUTPUT.w LUMA.w / 1.2 > OUTPUT.h LUMA.h / 1.2 > *
//!BIND TMP2_L0
//!BIND TMP2_L1
//!SAVE TMP1_L1
//!COMPONENTS 4

#define ACTIVE(v) (max(v, v * 0.2000000f))

#define TEX_BIND_L0_TEXOFF TMP2_L0_texOff
#define TEX_BIND_L0_TEX TMP2_L0_tex
#define TEX_BIND_L0_POS TMP2_L0_pos
#define TEX_BIND_L0_SIZE TMP2_L0_size
#define TEX_BIND_L0_PT TMP2_L0_pt

#define TEX_BIND_L1_TEXOFF TMP2_L1_texOff
#define TEX_BIND_L1_TEX TMP2_L1_tex
#define TEX_BIND_L1_POS TMP2_L1_pos
#define TEX_BIND_L1_SIZE TMP2_L1_size
#define TEX_BIND_L1_PT TMP2_L1_pt

const float kernels[288] = float[288](
  +0.4049858f, +0.1602951f, -0.1485723f, +0.0510102f, -0.3102920f, -0.0563154f, -0.0235669f, -0.0924957f,
  -1.0931097f, -0.8474547f, -0.1336752f, -0.1944847f, +0.0824035f, -0.4747771f, -0.4603793f, -0.0603937f,
  +0.0072006f, +0.1548336f, +0.0821796f, +0.0809077f, +0.1655903f, -0.1643819f, +0.2383480f, -0.2395191f,
  +0.3198974f, +0.4576556f, +0.0055576f, -0.2420002f, -0.2076258f, -0.0897251f, +0.0503122f, -0.1387351f,
  -0.3345869f, -0.5036134f, +0.2894804f, -0.3970876f, +0.1707995f, +0.3992667f, -0.5300071f, -0.5346087f,
  -0.1292908f, +0.1086796f, -0.0260415f, +0.1425760f, +0.1623657f, -0.2323786f, +0.1797474f, -0.1660167f,
  +0.0476959f, +0.1274852f, -0.0335516f, -0.0869912f, -0.1334497f, -0.0197555f, +0.0191047f, -0.0048151f,
  +0.1107086f, -0.0162844f, +0.1033468f, -0.1096259f, -0.0828324f, +0.0402107f, -0.0379650f, -0.0416384f,
  +0.0533596f, +0.1686886f, +0.0614216f, +0.1215835f, -0.0177741f, -0.1206526f, -0.1366659f, +0.1252197f,
  +0.1342543f, +0.3399154f, -0.4613607f, +0.3539032f, -0.6680398f, +0.3457797f, +0.5910100f, -0.4205794f,
  -0.0888749f, +0.0556372f, -0.3961886f, +0.0040708f, -0.4461202f, +0.6470042f, +0.1288517f, -0.1698695f,
  +0.2088940f, -0.0088639f, +0.0087832f, -0.0325736f, -0.1146277f, +0.0490090f, +0.1269677f, +0.2243093f,
  +0.1790974f, +1.1103009f, -0.3531705f, -0.1669244f, +0.0223747f, +0.0578203f, +0.2070701f, +0.0494654f,
  -0.1958217f, -0.1232346f, -0.2068036f, -0.1168770f, +0.3870214f, +0.7506536f, -0.1705240f, +0.2990984f,
  +0.0371610f, -0.0714855f, +0.2414234f, -0.0302901f, -0.1126077f, +0.0716912f, -0.0488425f, +0.1794380f,
  -0.5883904f, +0.3996765f, -0.0015765f, +0.1762272f, -0.0670613f, +0.2392740f, -0.1875997f, -0.0155452f,
  -0.3122825f, +0.1177251f, -0.0593705f, -0.1523578f, +0.0995000f, +0.3711665f, -0.1964199f, -0.0150764f,
  +0.0648780f, +0.0579824f, +0.0057752f, -0.2582968f, +0.0586155f, +0.1685899f, +0.0071686f, -0.1404225f,
  -0.3598506f, +0.0772384f, -0.0892326f, -0.0960941f, -0.0675430f, +0.1871897f, -0.0355233f, -0.4643213f,
  -0.5462743f, +0.2898434f, +0.8754327f, +0.4384878f, -0.1752079f, -0.2081090f, +0.0448641f, +0.5214747f,
  +0.0226057f, -0.0037157f, +0.4324296f, +0.0905971f, +0.0897150f, -0.0366358f, +0.3655930f, -0.2977349f,
  -0.0458969f, -0.0694705f, +0.0629676f, -0.1413092f, -0.2770048f, +0.1945146f, -0.0978632f, -0.2646121f,
  -0.3585305f, -0.1942963f, +0.7923863f, +0.4073181f, -0.6860855f, +0.0434152f, -0.5550119f, +0.1333346f,
  +0.2287751f, -0.2350017f, +0.2011831f, -0.0838974f, -0.2760029f, -0.3445757f, +0.4200830f, -0.3494358f,
  -0.0991353f, -0.0065902f, -0.1698810f, -0.0352757f, +0.1658863f, -0.0720556f, +0.0632496f, -0.1329071f,
  -0.0611125f, -0.1728463f, -0.0925732f, -0.4295111f, +0.2532286f, +0.1625319f, +0.3493905f, -0.1851250f,
  -0.0933378f, -0.2847455f, -0.1194602f, -0.1095475f, +0.0367955f, -0.0086295f, +0.0419270f, -0.1843962f,
  +0.1599211f, +0.0245430f, +0.4702675f, -0.1774519f, +0.0023805f, +0.6083906f, -0.3219937f, +0.0054263f,
  -0.0303686f, +0.3416341f, +0.3647770f, -0.1129426f, -0.1564416f, +0.0805576f, -0.3597172f, +0.2339007f,
  -0.0975396f, -0.0906749f, -0.4978310f, -0.2870204f, -0.0133312f, -0.2144974f, -0.0534353f, -0.0810293f,
  -0.8921444f, -0.6770331f, +0.5662196f, -0.1631972f, +0.1602143f, -0.1825103f, +0.1333889f, -0.0566953f,
  +0.8034944f, +0.0804373f, -0.8858140f, +0.3176634f, -0.4614564f, -0.0330449f, +0.8224298f, +0.1505303f,
  +0.6049458f, +0.3561730f, -0.2940292f, -0.5072950f, -0.4889114f, +0.3827088f, -0.1008714f, +0.9338909f,
  +0.1960792f, -0.0956644f, -0.4855255f, -0.3138558f, +0.0236890f, -0.1805612f, +0.4437754f, +0.3439415f,
  +0.3634731f, +0.0731990f, +0.1664574f, -0.1004483f, -0.2091398f, +0.2291224f, -0.1997280f, +0.4301789f,
  -0.2236215f, -0.1165165f, +0.7398368f, +0.3944345f, -0.2561693f, +0.2805448f, -0.1293779f, +0.2241282f
);

const float biases[4] = float[4](
  +0.0794594f, -0.1270351f, +0.0158236f, -0.0242046f
);

vec4 hook() {
    const vec4 r[9][2] = vec4[9][2](
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 1.0f)))
    );

    float sum[4] = biases;
    for (int n = 0; n < 4; n++) {
        for (int i = 0; i < 9; i++) {
            const vec4 k0 = vec4(kernels[n * 8 * 9 + 8 * i + 0], kernels[n * 8 * 9 + 8 * i + 1], kernels[n * 8 * 9 + 8 * i + 2], kernels[n * 8 * 9 + 8 * i + 3]);
            const vec4 k1 = vec4(kernels[n * 8 * 9 + 8 * i + 4], kernels[n * 8 * 9 + 8 * i + 5], kernels[n * 8 * 9 + 8 * i + 6], kernels[n * 8 * 9 + 8 * i + 7]);
            sum[n] += (dot(k0, r[i][0]) + dot(k1, r[i][1]));
        }
    }

    return ACTIVE(vec4(sum[0], sum[1], sum[2], sum[3]));
}

//!HOOK LUMA
//!DESC ARNet b8 Layer12 L0
//!WHEN OUTPUT.w LUMA.w / 1.2 > OUTPUT.h LUMA.h / 1.2 > *
//!BIND TMP1_L0
//!BIND TMP1_L1
//!BIND TMP2_L0
//!SAVE TMP2_L0
//!COMPONENTS 4

#define ACTIVE(v) (v)

#define TEX_BIND_L0_TEXOFF TMP1_L0_texOff
#define TEX_BIND_L0_TEX TMP1_L0_tex
#define TEX_BIND_L0_POS TMP1_L0_pos
#define TEX_BIND_L0_SIZE TMP1_L0_size
#define TEX_BIND_L0_PT TMP1_L0_pt

#define TEX_BIND_L1_TEXOFF TMP1_L1_texOff
#define TEX_BIND_L1_TEX TMP1_L1_tex
#define TEX_BIND_L1_POS TMP1_L1_pos
#define TEX_BIND_L1_SIZE TMP1_L1_size
#define TEX_BIND_L1_PT TMP1_L1_pt

#define TEX_BIND_L2_TEXOFF TMP2_L0_texOff
#define TEX_BIND_L2_TEX TMP2_L0_tex
#define TEX_BIND_L2_POS TMP2_L0_pos
#define TEX_BIND_L2_SIZE TMP2_L0_size
#define TEX_BIND_L2_PT TMP2_L0_pt

const float kernels[288] = float[288](
  +0.3091326f, -0.1055321f, -0.1074226f, -0.0667497f, +0.0459341f, -0.0507777f, +0.1076608f, -0.3393108f,
  +0.2323725f, -0.0764341f, -0.1901762f, +0.1654316f, +0.0409668f, -0.1061635f, -0.2008767f, -0.2483471f,
  +0.0211708f, +0.0040649f, +0.2517061f, +0.0944215f, +0.0539910f, -0.0578778f, +0.0958839f, +0.2176436f,
  -0.1754315f, -0.0707926f, +0.1326260f, +0.0894940f, +0.0881993f, -0.0594533f, +0.1594234f, +0.2213428f,
  +0.2771890f, +0.3158080f, +0.5694150f, -0.2552434f, +0.3008464f, -0.2392362f, -0.0010619f, +0.0112848f,
  +0.2800097f, -0.1280974f, +0.2137975f, -0.1133475f, +0.2083269f, -0.7886934f, -0.1753546f, -0.3182666f,
  +0.2414898f, +0.0569551f, -0.3917008f, +0.0231300f, -0.0729041f, -0.0322519f, +0.0325051f, +0.0083192f,
  +0.5600083f, +0.0437807f, +0.4179246f, +0.1276453f, +0.6736849f, -0.3002506f, -0.1895848f, +0.0698980f,
  +0.1529101f, -0.3775707f, -0.4207152f, +0.0846350f, -0.0230972f, -0.6358994f, -0.0427029f, -0.2187356f,
  -0.5131226f, +0.1080424f, +0.2685326f, +0.1863213f, -0.1484748f, +0.0456840f, -0.0417460f, +0.4185089f,
  -0.5237825f, +0.0361416f, +0.0057116f, -0.1428515f, -0.0945841f, +0.1693275f, +0.0075517f, +0.4305269f,
  -0.1947260f, -0.0969018f, -0.4462314f, +0.0532737f, -0.0412453f, +0.2547598f, -0.0697993f, -0.2407311f,
  -0.1401474f, +0.2905927f, -0.6082976f, +0.1689034f, -0.2927469f, +0.0710374f, -0.2611621f, -0.4927189f,
  +0.0121614f, -0.4226258f, +0.0911964f, +0.0670631f, +0.2732624f, +0.2093323f, +0.4321731f, -0.0844759f,
  -0.0083352f, +0.1666095f, -0.0615758f, +0.2178442f, -0.3739582f, +0.2225038f, +0.2278391f, +0.6103091f,
  +0.2033390f, -0.1699666f, +0.1993995f, +0.3302584f, -0.0663389f, -0.0553472f, -0.0007815f, -0.1650200f,
  +0.1423026f, -0.1402010f, +0.1686005f, +0.1719305f, +0.9096908f, +0.1917817f, +0.1381287f, -0.0776140f,
  -0.0524877f, -0.2677850f, +0.0675569f, +0.0612556f, +0.0097071f, +0.1348047f, -0.0152810f, -0.2053082f,
  +0.2248075f, +0.2030931f, +0.0909175f, -0.3113603f, +0.0159830f, +0.0733773f, -0.3656198f, -0.1999572f,
  +0.1263296f, +0.0483200f, +0.1419788f, +0.1690199f, +0.0723818f, -0.2619219f, +0.1231666f, +0.2940975f,
  +0.3971527f, -0.0274964f, +0.0951525f, -0.1951012f, +0.0282280f, -0.0788158f, +0.0537963f, -0.4030968f,
  -0.3011336f, +0.2397899f, +0.1170490f, -0.0644651f, -0.2334525f, -0.0052726f, -0.2457408f, +0.6078063f,
  +0.6026545f, -1.4452672f, +0.3390205f, -0.1385831f, +0.0973321f, -0.1098844f, +0.2398956f, -0.7420208f,
  +0.0990109f, -0.1344800f, +0.1293185f, +0.2057080f, +0.2428924f, +0.1136170f, -0.0386997f, +0.1158293f,
  -0.3477893f, +0.0086388f, -0.0426519f, -0.2195595f, -0.0212163f, +0.0255404f, -0.3778731f, +0.0422515f,
  -0.0123072f, -0.1852018f, +0.2103404f, +0.1096933f, +0.5495356f, +0.0572740f, +0.0223228f, -0.4018595f,
  +0.1562599f, +0.2288606f, +0.1357254f, +0.0748397f, -0.0796186f, +0.7707859f, +0.4085189f, +0.3730445f,
  +0.1447499f, -0.0061926f, -0.3222443f, +0.1244071f, -0.0236935f, -0.0357982f, +0.0230997f, +0.4942884f,
  -0.0485372f, -0.1468941f, -0.5888091f, +0.0257410f, +0.0577775f, +0.2332348f, +0.0460844f, -0.9422926f,
  -0.0607785f, -0.0221060f, +0.1601570f, +0.3012798f, +0.1411457f, +0.2111299f, -0.1155816f, +0.5369205f,
  -0.0563177f, -0.3084872f, +0.2184274f, -0.0912596f, +0.2711535f, +0.1253583f, +0.2278761f, -0.7010633f,
  -0.2319098f, +0.1934683f, +0.3682016f, -0.3292476f, -0.2601252f, +0.2127407f, -0.1994311f, +0.8212638f,
  -0.3855428f, -0.2235330f, +0.0993761f, -0.2439399f, +0.1589923f, +0.5176871f, -0.0792698f, -0.2265691f,
  -0.0588206f, +0.1325123f, +0.1975901f, +0.0259502f, +0.0393468f, +0.0505880f, +0.0311581f, -0.0313049f,
  +0.2947256f, +0.0314102f, -0.1771809f, -0.2403287f, +0.3672096f, +0.1106243f, -0.0532522f, -0.1159206f,
  -0.0098400f, -0.0477594f, +0.0494229f, -0.2154675f, +0.0902791f, -0.2285707f, -0.0553475f, +0.0338270f
);

const float biases[4] = float[4](
  -0.1118071f, -0.1040337f, -0.0127197f, +0.1627957f
);

vec4 hook() {
    const vec4 r[9][2] = vec4[9][2](
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 1.0f)))
    );

    float sum[4] = biases;
    for (int n = 0; n < 4; n++) {
        for (int i = 0; i < 9; i++) {
            const vec4 k0 = vec4(kernels[n * 8 * 9 + 8 * i + 0], kernels[n * 8 * 9 + 8 * i + 1], kernels[n * 8 * 9 + 8 * i + 2], kernels[n * 8 * 9 + 8 * i + 3]);
            const vec4 k1 = vec4(kernels[n * 8 * 9 + 8 * i + 4], kernels[n * 8 * 9 + 8 * i + 5], kernels[n * 8 * 9 + 8 * i + 6], kernels[n * 8 * 9 + 8 * i + 7]);
            sum[n] += (dot(k0, r[i][0]) + dot(k1, r[i][1]));
        }
    }

    return ACTIVE(vec4(sum[0], sum[1], sum[2], sum[3]) * 0.2000000f + TEX_BIND_L2_TEXOFF(vec2(0.0f, 0.0f)));
}

//!HOOK LUMA
//!DESC ARNet b8 Layer12 L1
//!WHEN OUTPUT.w LUMA.w / 1.2 > OUTPUT.h LUMA.h / 1.2 > *
//!BIND TMP1_L0
//!BIND TMP1_L1
//!BIND TMP2_L1
//!SAVE TMP2_L1
//!COMPONENTS 4

#define ACTIVE(v) (v)

#define TEX_BIND_L0_TEXOFF TMP1_L0_texOff
#define TEX_BIND_L0_TEX TMP1_L0_tex
#define TEX_BIND_L0_POS TMP1_L0_pos
#define TEX_BIND_L0_SIZE TMP1_L0_size
#define TEX_BIND_L0_PT TMP1_L0_pt

#define TEX_BIND_L1_TEXOFF TMP1_L1_texOff
#define TEX_BIND_L1_TEX TMP1_L1_tex
#define TEX_BIND_L1_POS TMP1_L1_pos
#define TEX_BIND_L1_SIZE TMP1_L1_size
#define TEX_BIND_L1_PT TMP1_L1_pt

#define TEX_BIND_L2_TEXOFF TMP2_L1_texOff
#define TEX_BIND_L2_TEX TMP2_L1_tex
#define TEX_BIND_L2_POS TMP2_L1_pos
#define TEX_BIND_L2_SIZE TMP2_L1_size
#define TEX_BIND_L2_PT TMP2_L1_pt

const float kernels[288] = float[288](
  +0.3780835f, -0.1702869f, +0.0772746f, -0.2493724f, -0.0145369f, -0.0682160f, +0.0855114f, -0.0463625f,
  +0.2521418f, -0.3786937f, -0.7657660f, -0.4703578f, +0.0122771f, -0.2035145f, +0.1253907f, -0.1784744f,
  +0.0718510f, -0.1947649f, +0.0081098f, -0.0820437f, +0.0546769f, -0.0488934f, -0.1279710f, +0.3119265f,
  -0.5446537f, +0.2952221f, +0.0924948f, -0.3333846f, -0.1075408f, +0.1576588f, +0.4528391f, +0.1097117f,
  +0.0041206f, -1.0176640f, +0.0006224f, -0.5317622f, +0.0235722f, +0.0531909f, +0.6910673f, -0.5710183f,
  +0.1877748f, +0.0160126f, +0.0534196f, -0.3441429f, +0.0323414f, -0.4877458f, -0.0572466f, -0.0220045f,
  +0.1165457f, +0.5032986f, -0.0569986f, -0.0645133f, -0.5347692f, +0.0234195f, -0.3891938f, +0.3573379f,
  -0.2631758f, +0.4497971f, -0.4130837f, +0.0062477f, -0.6962046f, -0.1955034f, -0.1781217f, +0.1056094f,
  +0.0526930f, +0.1077925f, +0.1959527f, -0.4477955f, +0.2192044f, +0.1475483f, -0.0479684f, -0.3023957f,
  -0.2038874f, +0.0608228f, +0.3838780f, -0.0404634f, +0.1534016f, +0.0266967f, +0.0973892f, -0.1165308f,
  -0.2192624f, -0.2334884f, +0.9566879f, +0.0620534f, +0.2094874f, +0.0698709f, +0.4750652f, -0.5916384f,
  -0.0505363f, -0.0292256f, +0.1390516f, +0.0970064f, -0.0216070f, -0.2130618f, -0.0367483f, -0.1193831f,
  +0.4036737f, -0.1402595f, +0.1925646f, +0.2046174f, +0.3509352f, -0.0406088f, +0.4153335f, -0.6343557f,
  +0.4003430f, +0.2579519f, -1.1543322f, +0.0181571f, +0.0606352f, -0.0476894f, -0.9833078f, -0.1136175f,
  -0.2998544f, +0.0478367f, +0.7087731f, +0.0691283f, +0.4629550f, +0.4035785f, +0.0582479f, +0.5792102f,
  +0.3614372f, -0.1236221f, -0.0330345f, -0.1087109f, +0.1258917f, -0.0741989f, -0.5680801f, -0.0909263f,
  +0.4432153f, -0.1354668f, +0.3514754f, -0.3170311f, +0.6641686f, -0.4995856f, -0.5384293f, +0.4313999f,
  +0.1667654f, -0.0563988f, +0.1794052f, -0.0710817f, -0.1020590f, -0.9372085f, +0.0141823f, -0.4134325f,
  -0.2063979f, +0.1907923f, +0.4733547f, -0.3599842f, +0.3656623f, +0.0867582f, +0.0046513f, +0.1301239f,
  -0.0444583f, +0.2072635f, +0.4509155f, -0.2137305f, -0.1152914f, -0.0183134f, +0.0201774f, +0.1837283f,
  +0.3001557f, +0.0725188f, -0.1221422f, -0.0293554f, -0.0521956f, -0.3736992f, +0.0722001f, +0.0876804f,
  -0.2571436f, -0.0533604f, -0.4507477f, -0.4530043f, -0.5449470f, +0.0641932f, -0.2345338f, +0.0949655f,
  -0.4050079f, +0.0204682f, +0.0537697f, -0.3473770f, +0.4581559f, -0.1880897f, -0.2195217f, +1.0522007f,
  -0.3995287f, +0.5290462f, -0.3160086f, -0.0820044f, -0.1679715f, -0.4721750f, +0.3367911f, +0.1454251f,
  -0.4052711f, +0.0454746f, -0.2313531f, -0.1206691f, +0.2049003f, +0.2811695f, +0.0366613f, +0.1578330f,
  +0.2169239f, +0.1718026f, -0.2508435f, -0.4480900f, -0.1947276f, +0.0048887f, -0.6900950f, -0.3454758f,
  +0.0772611f, +0.4879297f, +0.0129386f, -0.0711846f, -0.2744108f, -0.9389668f, +0.1159392f, +0.1322744f,
  +0.0927953f, +0.0566980f, -0.2063845f, -0.1877631f, +0.1106690f, +0.0174228f, -0.2359592f, -0.0531147f,
  -0.1271533f, +0.1106233f, -0.2718745f, -0.1197789f, -0.0691518f, +0.1400463f, -0.0238359f, +0.3509369f,
  -0.1035496f, +0.0451692f, -0.1164057f, -0.2667582f, -0.0097682f, +0.1816305f, +0.0485141f, +0.3045668f,
  +0.8466793f, -0.1046927f, +0.6228544f, -0.1955725f, +0.2760208f, -0.1336724f, +0.6356491f, +0.1830904f,
  -0.1349413f, -0.0395566f, -0.2184929f, +0.2027038f, +0.4498962f, -0.7067510f, -0.0269390f, -0.9705714f,
  +0.0017655f, -0.0476323f, +0.0763171f, -0.3582807f, -0.0614595f, -0.1226674f, +0.1737280f, -0.1517223f,
  +0.0618536f, +0.1153653f, -0.2300076f, -0.5455350f, +0.7250241f, -0.1977948f, +0.0514044f, +0.2345008f,
  -0.2596458f, +0.3787924f, +0.1094800f, -0.3309593f, -0.5773270f, -0.3639055f, -0.6817315f, +0.2327309f,
  +0.2372536f, +0.3954876f, -0.3054120f, -0.2618879f, +0.0067101f, -0.2699161f, -0.0003932f, +0.0799079f
);

const float biases[4] = float[4](
  +0.1220048f, -0.2284390f, +0.1539590f, -0.0089868f
);

vec4 hook() {
    const vec4 r[9][2] = vec4[9][2](
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 1.0f)))
    );

    float sum[4] = biases;
    for (int n = 0; n < 4; n++) {
        for (int i = 0; i < 9; i++) {
            const vec4 k0 = vec4(kernels[n * 8 * 9 + 8 * i + 0], kernels[n * 8 * 9 + 8 * i + 1], kernels[n * 8 * 9 + 8 * i + 2], kernels[n * 8 * 9 + 8 * i + 3]);
            const vec4 k1 = vec4(kernels[n * 8 * 9 + 8 * i + 4], kernels[n * 8 * 9 + 8 * i + 5], kernels[n * 8 * 9 + 8 * i + 6], kernels[n * 8 * 9 + 8 * i + 7]);
            sum[n] += (dot(k0, r[i][0]) + dot(k1, r[i][1]));
        }
    }

    return ACTIVE(vec4(sum[0], sum[1], sum[2], sum[3]) * 0.2000000f + TEX_BIND_L2_TEXOFF(vec2(0.0f, 0.0f)));
}

//!HOOK LUMA
//!DESC ARNet b8 Layer13 L0
//!WHEN OUTPUT.w LUMA.w / 1.2 > OUTPUT.h LUMA.h / 1.2 > *
//!BIND TMP2_L0
//!BIND TMP2_L1
//!SAVE TMP1_L0
//!COMPONENTS 4

#define ACTIVE(v) (max(v, v * 0.2000000f))

#define TEX_BIND_L0_TEXOFF TMP2_L0_texOff
#define TEX_BIND_L0_TEX TMP2_L0_tex
#define TEX_BIND_L0_POS TMP2_L0_pos
#define TEX_BIND_L0_SIZE TMP2_L0_size
#define TEX_BIND_L0_PT TMP2_L0_pt

#define TEX_BIND_L1_TEXOFF TMP2_L1_texOff
#define TEX_BIND_L1_TEX TMP2_L1_tex
#define TEX_BIND_L1_POS TMP2_L1_pos
#define TEX_BIND_L1_SIZE TMP2_L1_size
#define TEX_BIND_L1_PT TMP2_L1_pt

const float kernels[288] = float[288](
  -0.6526135f, -0.0587137f, -0.0883085f, +0.2165609f, -0.1784065f, -0.2246674f, +0.0149281f, +0.1384441f,
  +0.0107464f, -0.2185663f, -0.2561084f, +0.0659486f, -0.3894244f, -0.0463520f, +0.0736191f, +0.0133530f,
  -0.2925943f, -0.2482264f, -0.2951828f, -0.2942591f, +0.2278543f, -0.1850313f, -0.2282177f, -0.3803239f,
  -0.1386656f, +0.0369451f, -0.2581883f, -0.2709209f, -0.3273884f, +0.0861957f, +0.1342889f, +0.5246714f,
  +0.3377623f, +0.1455507f, +0.2693531f, -0.0462593f, +0.1588208f, +0.3225499f, +0.0814975f, -0.7818149f,
  -0.3037305f, -0.1848034f, -0.5463982f, -0.2137420f, +0.3813998f, +0.1024409f, +0.0536613f, -0.4318859f,
  +0.2481984f, +0.4542688f, +0.0387930f, +0.3474817f, -0.1494697f, +0.0058590f, -0.1702413f, +0.4488564f,
  +0.1266458f, +0.1713734f, +0.1075198f, -0.1074504f, +0.0167283f, -0.1984664f, +0.0178418f, +0.0481545f,
  -0.0515070f, +0.0786683f, -0.1957617f, -0.1174591f, +0.1585137f, +0.0670383f, +0.0516320f, -0.0080433f,
  +0.8721072f, +0.2357661f, -0.4283896f, -0.2561156f, +0.7079120f, +0.7667167f, +0.5459682f, -0.0992077f,
  +0.0896682f, +0.4264185f, +0.5002055f, +0.2235652f, +0.0189975f, +0.5086186f, +0.1408364f, +1.3759634f,
  -0.0550763f, +0.0721143f, +0.1930117f, -0.2463675f, +0.2186161f, +0.0375079f, -0.2949397f, -0.2339794f,
  +0.1242685f, +0.3278079f, -0.7092779f, -0.1563737f, +1.0017117f, -0.2579027f, +0.2417742f, +0.1200024f,
  -0.1470585f, -0.5090964f, -0.1611606f, +0.2617133f, -0.9564791f, +0.3173433f, +0.2225220f, +1.0811229f,
  +0.0089685f, +0.1379427f, +0.1166085f, -0.3221039f, -0.0018875f, -0.5202017f, -0.0809706f, -0.2202850f,
  +0.2026358f, -0.0734557f, -0.1749304f, +0.3965285f, -0.0236767f, -0.1239849f, -0.0726535f, +0.2516356f,
  +0.4441708f, -0.3271903f, +0.3677466f, +0.9268254f, -0.4110597f, +0.2967294f, -0.4554865f, +0.2266120f,
  +0.2570955f, -0.1585295f, +0.0704925f, -0.0458063f, -0.2300253f, -0.2191322f, -0.0560273f, +0.3737816f,
  -0.2854607f, -0.0234745f, +0.0849545f, +0.3078858f, +0.0700824f, +0.0549543f, +0.2555224f, +0.0893626f,
  -0.3693351f, -0.1364145f, +0.0102494f, +0.0563334f, +0.1666651f, +0.3022027f, +0.0198926f, +0.3230558f,
  +0.1006263f, -0.3690610f, +0.1873678f, -0.1998854f, -0.0712003f, +0.1544607f, +0.0224957f, +0.4682718f,
  -0.5677552f, -0.0261592f, +0.0409250f, +0.1428869f, -0.0887673f, +0.1473212f, -0.1160327f, +0.3758122f,
  -0.1306667f, +0.1759065f, +0.1993345f, -0.0773296f, +0.1142888f, +0.2260976f, +0.2224853f, +0.3709243f,
  -0.2392122f, +0.0596419f, +0.1994186f, -0.0329796f, -0.1976852f, -0.0508212f, +0.0175089f, +0.9979084f,
  +0.0446900f, +0.1658008f, +0.1476749f, +0.2508516f, -0.0481896f, -0.0181662f, -0.0255576f, +0.0887265f,
  -0.2356381f, +0.0713122f, +0.0809955f, +0.1233532f, -0.0870986f, +0.0031751f, -0.2953474f, +0.1858154f,
  -0.2322118f, +0.2077801f, -0.1172526f, -0.0155105f, +0.0901200f, +0.0148380f, -0.2212022f, +0.0490845f,
  +0.5424461f, +0.3954801f, -0.5359897f, +0.0646816f, +0.1282652f, +0.1339209f, +0.1417634f, +0.4560392f,
  +0.2484309f, -0.2836390f, -0.4661568f, -0.3542180f, +0.0593971f, +0.5835983f, +0.2585454f, -0.2453170f,
  +0.2788153f, +0.2081189f, -0.1910734f, -0.0054971f, -0.1219672f, +0.1333201f, +0.0946369f, +0.6504520f,
  +0.2160471f, +0.2335890f, -0.5884451f, -0.0724504f, +0.5645415f, -0.2261698f, -0.1758281f, +0.1329839f,
  -0.9262146f, -0.0311305f, -0.3910169f, -0.3913638f, +0.7404545f, +0.3574499f, +0.6275172f, +0.4990342f,
  -0.1507999f, +0.4574242f, +0.3160425f, -0.0183790f, -0.0365843f, -0.0781279f, +0.2513666f, +0.4380552f,
  +0.1244745f, +0.1981380f, -0.0512603f, +0.0192408f, -0.0640073f, -0.0273071f, -0.0548257f, +0.2465377f,
  -0.0617341f, -0.4453494f, -0.2141486f, +0.7381878f, -0.4440953f, +0.1915389f, -0.2679478f, +0.1835507f,
  -0.0580463f, -0.3729508f, +0.0188764f, +0.0929900f, -0.8144997f, -0.4424154f, -0.1315131f, +0.3048437f
);

const float biases[4] = float[4](
  +0.0457808f, -0.0554146f, +0.0528182f, +0.0347790f
);

vec4 hook() {
    const vec4 r[9][2] = vec4[9][2](
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 1.0f)))
    );

    float sum[4] = biases;
    for (int n = 0; n < 4; n++) {
        for (int i = 0; i < 9; i++) {
            const vec4 k0 = vec4(kernels[n * 8 * 9 + 8 * i + 0], kernels[n * 8 * 9 + 8 * i + 1], kernels[n * 8 * 9 + 8 * i + 2], kernels[n * 8 * 9 + 8 * i + 3]);
            const vec4 k1 = vec4(kernels[n * 8 * 9 + 8 * i + 4], kernels[n * 8 * 9 + 8 * i + 5], kernels[n * 8 * 9 + 8 * i + 6], kernels[n * 8 * 9 + 8 * i + 7]);
            sum[n] += (dot(k0, r[i][0]) + dot(k1, r[i][1]));
        }
    }

    return ACTIVE(vec4(sum[0], sum[1], sum[2], sum[3]));
}

//!HOOK LUMA
//!DESC ARNet b8 Layer13 L1
//!WHEN OUTPUT.w LUMA.w / 1.2 > OUTPUT.h LUMA.h / 1.2 > *
//!BIND TMP2_L0
//!BIND TMP2_L1
//!SAVE TMP1_L1
//!COMPONENTS 4

#define ACTIVE(v) (max(v, v * 0.2000000f))

#define TEX_BIND_L0_TEXOFF TMP2_L0_texOff
#define TEX_BIND_L0_TEX TMP2_L0_tex
#define TEX_BIND_L0_POS TMP2_L0_pos
#define TEX_BIND_L0_SIZE TMP2_L0_size
#define TEX_BIND_L0_PT TMP2_L0_pt

#define TEX_BIND_L1_TEXOFF TMP2_L1_texOff
#define TEX_BIND_L1_TEX TMP2_L1_tex
#define TEX_BIND_L1_POS TMP2_L1_pos
#define TEX_BIND_L1_SIZE TMP2_L1_size
#define TEX_BIND_L1_PT TMP2_L1_pt

const float kernels[288] = float[288](
  +0.7830572f, +0.1845225f, +0.2747751f, +0.0029915f, -0.5655196f, -0.1483931f, -0.0250436f, -0.1265260f,
  -0.0257836f, -0.3869191f, +0.3417194f, -0.4048049f, +0.0608534f, -0.3464718f, -0.6492712f, -0.0148245f,
  -0.1098245f, -0.3433436f, +0.1440940f, -0.3324467f, +0.1838953f, -0.3559380f, -0.3390327f, -0.1551342f,
  -0.2089692f, +0.2001009f, -0.0026895f, -0.3834677f, -0.3066935f, +0.0148621f, +0.1804592f, -0.4849525f,
  -0.4204876f, +0.1951417f, +0.1844231f, +0.4077405f, +0.0931254f, +0.6119784f, +0.0215926f, +0.0442841f,
  -0.3265840f, +0.2619227f, -0.0207608f, -0.1460863f, +0.3699457f, -0.0046453f, +0.1540251f, -1.0159796f,
  -0.0564630f, +0.3477435f, -0.1785200f, -0.3615347f, +0.2497192f, +0.0409607f, +0.2244890f, +0.0541800f,
  +0.1240725f, -0.4193675f, +0.1172994f, +0.4958735f, -0.2236688f, -0.0235467f, +0.0584956f, +0.0420457f,
  -0.0110230f, -0.0614678f, -0.0943875f, -0.3162363f, -0.0066503f, -0.4100011f, +0.2629119f, +0.1913451f,
  +0.4267473f, +0.2193849f, -0.1546548f, +0.1331462f, -0.0737282f, -0.1687241f, +0.0618064f, +0.1198594f,
  +0.3189210f, +0.3824724f, -0.1550591f, +0.1075134f, -0.0435790f, -0.0836161f, -0.0147520f, -0.1210988f,
  -0.1917411f, -0.2575109f, +0.0851850f, -0.2250594f, -0.0352445f, -0.1203659f, -0.0839614f, -0.0884366f,
  -0.2779650f, -0.0890408f, +0.6208728f, -0.1067256f, -0.4886559f, -0.0095125f, -0.3146545f, -0.0857302f,
  -0.1360635f, +0.1065442f, +0.3075205f, +0.1173129f, -0.3456675f, -0.1262692f, -0.2254759f, +0.3601191f,
  -0.1430375f, -0.4191085f, +0.2353130f, -0.2237170f, -0.2525859f, -0.4181122f, -0.3829733f, -0.5895259f,
  +0.4215191f, +0.0327750f, +0.0886654f, -0.0927264f, +0.0810629f, +0.0918401f, +0.0452161f, -0.2608487f,
  +0.9600819f, -0.2863599f, +0.3938332f, +0.4827794f, +0.2997627f, +0.0911438f, -0.3496232f, +0.0508063f,
  +0.1901678f, -0.1667267f, +0.0866234f, -0.0904189f, +0.2762351f, +0.0484116f, -0.2314672f, +0.1219872f,
  +0.1289109f, +0.1341504f, -0.0052235f, +0.0714165f, -0.0413994f, +0.1575731f, +0.1559128f, +0.1601941f,
  +0.1314056f, -0.0754889f, +0.1918903f, +0.1332427f, -0.0814548f, -0.1036790f, +0.2149499f, +0.2245729f,
  -0.1473759f, -0.1185256f, -0.0852664f, +0.1272993f, -0.2160474f, -0.1449810f, +0.3235216f, +0.0025802f,
  -0.0915632f, -0.0961546f, -0.1541196f, -0.2364656f, +0.4508398f, -0.1145862f, -0.0459242f, +0.1458290f,
  -0.0084522f, -0.1951340f, -0.4837577f, +0.0335105f, -0.1635688f, +0.5550233f, +0.4256760f, -0.0151737f,
  -0.2039868f, -0.6268649f, -0.1478437f, -0.0832847f, +0.4011895f, +0.3498637f, +0.6111040f, +0.0924540f,
  +0.0790722f, +0.5333867f, -0.4013211f, +0.2381363f, +0.2793939f, -0.1318794f, +0.2279401f, +0.9038618f,
  +0.6993597f, +0.3319767f, -0.7378348f, +0.4006919f, +0.0018900f, -0.0762104f, +0.3994242f, +0.2433945f,
  +0.0930241f, +0.0781161f, +0.1221026f, +0.1280438f, +0.1457448f, +0.1547699f, +0.1459447f, +0.5442812f,
  -0.3237687f, +0.2663025f, -0.0049567f, -0.0682021f, +0.0256339f, -0.0731275f, -0.2779479f, -0.0557199f,
  -0.4130263f, -0.0265811f, +0.0179307f, -0.0681603f, +0.1988998f, +0.0692546f, -0.1450424f, -0.1160209f,
  +0.2637492f, +0.4981127f, +0.0152907f, +0.3336850f, -0.3309977f, +0.1814754f, +0.3519253f, +0.4069567f,
  -0.0861639f, -0.0947239f, -0.3013225f, +0.1727230f, -0.2862839f, -0.0320461f, +0.0100280f, -0.1525759f,
  -0.8254503f, +0.0778336f, -0.5103414f, +0.2490308f, -0.7697133f, +0.0994542f, -0.1670869f, -0.1083347f,
  -0.2111209f, +0.0652378f, +0.0170463f, +0.0370642f, -0.2131672f, +0.1389524f, -0.2663873f, -0.3658881f,
  -0.4917739f, +0.2792915f, -0.6016771f, -0.2929797f, +0.1246128f, -0.3737338f, +0.0513152f, +0.2317872f,
  +0.2539341f, -0.0318993f, -0.0534456f, -0.2680583f, -0.0687457f, +0.1933244f, +0.1619841f, -0.3569957f,
  -0.1644345f, +0.0745634f, -0.1270522f, +0.1358994f, -0.1039981f, +0.1002866f, -0.3240092f, -0.0289477f
);

const float biases[4] = float[4](
  +0.0776027f, +0.0081678f, +0.0382282f, -0.0409111f
);

vec4 hook() {
    const vec4 r[9][2] = vec4[9][2](
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 1.0f)))
    );

    float sum[4] = biases;
    for (int n = 0; n < 4; n++) {
        for (int i = 0; i < 9; i++) {
            const vec4 k0 = vec4(kernels[n * 8 * 9 + 8 * i + 0], kernels[n * 8 * 9 + 8 * i + 1], kernels[n * 8 * 9 + 8 * i + 2], kernels[n * 8 * 9 + 8 * i + 3]);
            const vec4 k1 = vec4(kernels[n * 8 * 9 + 8 * i + 4], kernels[n * 8 * 9 + 8 * i + 5], kernels[n * 8 * 9 + 8 * i + 6], kernels[n * 8 * 9 + 8 * i + 7]);
            sum[n] += (dot(k0, r[i][0]) + dot(k1, r[i][1]));
        }
    }

    return ACTIVE(vec4(sum[0], sum[1], sum[2], sum[3]));
}

//!HOOK LUMA
//!DESC ARNet b8 Layer14 L0
//!WHEN OUTPUT.w LUMA.w / 1.2 > OUTPUT.h LUMA.h / 1.2 > *
//!BIND TMP1_L0
//!BIND TMP1_L1
//!BIND TMP2_L0
//!SAVE TMP2_L0
//!COMPONENTS 4

#define ACTIVE(v) (v)

#define TEX_BIND_L0_TEXOFF TMP1_L0_texOff
#define TEX_BIND_L0_TEX TMP1_L0_tex
#define TEX_BIND_L0_POS TMP1_L0_pos
#define TEX_BIND_L0_SIZE TMP1_L0_size
#define TEX_BIND_L0_PT TMP1_L0_pt

#define TEX_BIND_L1_TEXOFF TMP1_L1_texOff
#define TEX_BIND_L1_TEX TMP1_L1_tex
#define TEX_BIND_L1_POS TMP1_L1_pos
#define TEX_BIND_L1_SIZE TMP1_L1_size
#define TEX_BIND_L1_PT TMP1_L1_pt

#define TEX_BIND_L2_TEXOFF TMP2_L0_texOff
#define TEX_BIND_L2_TEX TMP2_L0_tex
#define TEX_BIND_L2_POS TMP2_L0_pos
#define TEX_BIND_L2_SIZE TMP2_L0_size
#define TEX_BIND_L2_PT TMP2_L0_pt

const float kernels[288] = float[288](
  -0.0089792f, -0.2511311f, +0.1383531f, +0.2562511f, +0.0878761f, -0.1178119f, +0.3657144f, +0.0416981f,
  +0.1454758f, -0.2887203f, +0.0079451f, -0.0071425f, +0.0853192f, -0.2657317f, -0.0562297f, -0.2733522f,
  -0.1127885f, +0.0637579f, +0.2001394f, -0.0321009f, -0.0715626f, -0.0782976f, +0.1240911f, -0.1364066f,
  -0.1811900f, -0.1626699f, +0.1331853f, +0.2900511f, +0.1811176f, +0.0631497f, -0.0052231f, +0.0209825f,
  -0.0541254f, -0.6326636f, +0.0284375f, -0.4031565f, +0.1155891f, +0.0195874f, +0.3561468f, +0.0133865f,
  +0.1010494f, +0.5200279f, +0.3307697f, +0.0257007f, -0.1472484f, +0.3060378f, -0.0597040f, -0.3642225f,
  -0.2072948f, -0.0651670f, +0.1032229f, +0.1093916f, +0.0378963f, +0.0482612f, -0.0853087f, -0.0212189f,
  -0.3194722f, +0.0141275f, +0.2005332f, -0.1402700f, -0.0198497f, +0.0027881f, -0.1677258f, +0.0979196f,
  +0.2622967f, -0.0971891f, -0.0859382f, +0.3128488f, -0.2125459f, -0.2749041f, +0.2139312f, -0.0783133f,
  +0.0439735f, +0.0069845f, -0.0343013f, -0.1415336f, -0.0332170f, +0.0828135f, -0.6108251f, -0.0218040f,
  +0.1154382f, +0.2662298f, +0.0340574f, -0.5033416f, +0.0680103f, +0.3937073f, -0.0188847f, +0.0774491f,
  +0.0636146f, +0.1087904f, -0.1603536f, +0.2140937f, -0.1906184f, +0.0555179f, -0.0965703f, +0.1098840f,
  +0.1971061f, +0.0297360f, -0.0572579f, -0.2060714f, -0.0862547f, +0.1577700f, +0.1461893f, -0.2639121f,
  +0.0754526f, +0.0553732f, +0.1026406f, -0.6612398f, +0.0819932f, -0.2159817f, +0.1782736f, -0.5018709f,
  +0.3796134f, +0.5794272f, -0.0536617f, -0.1298054f, -0.0772121f, -0.0281074f, +0.2079933f, +0.0510211f,
  +0.3427294f, -0.1399596f, -0.0040332f, -0.2497515f, -0.0279650f, -0.1637051f, +0.2704916f, -0.1236001f,
  +0.0999235f, +0.5137821f, +0.1491483f, -0.0714554f, +0.0951192f, -0.2356179f, +0.1595445f, -0.3426543f,
  -0.0222440f, +0.3963101f, +0.0202444f, +0.0318269f, -0.0129201f, -0.0072402f, -0.0223145f, +0.0880545f,
  +0.0387529f, +0.2824548f, -0.1716577f, -0.4042298f, -0.0758511f, +0.3732410f, -0.6376362f, +0.0429815f,
  -0.1480010f, +0.5730684f, -0.0500029f, +0.8625879f, -0.2993141f, -0.8713683f, -0.3170799f, +0.1102097f,
  -0.0609521f, +0.0977876f, -0.1393715f, -0.0133000f, +0.3379306f, +0.1590478f, +0.3521169f, +0.3307491f,
  +0.1627814f, +0.9259453f, -0.1650964f, -0.7096627f, -0.1150073f, -0.0319588f, -0.5845603f, -0.0306959f,
  +0.1584572f, -0.1411740f, +0.0710991f, +0.3067029f, +0.3706414f, +0.6634453f, +0.5139633f, -0.0099541f,
  -0.1232995f, +0.1466323f, -0.2924317f, -0.6122230f, +0.2161659f, -0.4644481f, +0.3955143f, +0.1987230f,
  +0.3783773f, -0.0036105f, -0.2414065f, +0.0015322f, -0.3722962f, -0.2415556f, -0.0585470f, +0.0299013f,
  +1.3755029f, +0.6783277f, +0.0856965f, +0.1421130f, -0.2579628f, +0.1543889f, +0.2639139f, -0.2452085f,
  +0.3390172f, +0.8783563f, +0.2110245f, +0.1771075f, +0.0752600f, +0.1776085f, -0.0126058f, +0.1833556f,
  +0.1095785f, +0.5133644f, +0.0001700f, -0.1019899f, -0.2362118f, -0.0806683f, -0.2112017f, -0.0021543f,
  -0.2475006f, +0.2629710f, +0.0033749f, +0.5226274f, -0.0648572f, -0.3666818f, +0.8720915f, +0.2572493f,
  -0.2894998f, -0.1309372f, -0.0898179f, -0.4344788f, +0.3253995f, -0.0101133f, +0.1208386f, +0.3712616f,
  +0.1393968f, -0.1681916f, -0.1307379f, -0.1681107f, +0.1398783f, -0.1363641f, +0.5532370f, -0.1577094f,
  +0.3009024f, +1.1134888f, -0.0014115f, -0.2871847f, -0.1238085f, -0.1671016f, +0.0710916f, +0.3086754f,
  -0.1292823f, -0.5730798f, +0.0338721f, -0.1750319f, -0.0240238f, +0.3651490f, +0.2356138f, +0.2338180f,
  +0.3075872f, +0.2115878f, +0.0954015f, -0.0354402f, +0.0182472f, +0.2224498f, +0.2774307f, -0.0467120f,
  -0.3663535f, +0.0633015f, -0.0272268f, +0.1666245f, +0.1180147f, -0.1360731f, +0.1947288f, +0.2696951f,
  -0.1471456f, +0.1572308f, +0.0911490f, +0.1634468f, +0.0221896f, -0.0110358f, -0.1182999f, +0.1477419f
);

const float biases[4] = float[4](
  -0.0329615f, -0.0777140f, +0.0603723f, +0.1043726f
);

vec4 hook() {
    const vec4 r[9][2] = vec4[9][2](
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 1.0f)))
    );

    float sum[4] = biases;
    for (int n = 0; n < 4; n++) {
        for (int i = 0; i < 9; i++) {
            const vec4 k0 = vec4(kernels[n * 8 * 9 + 8 * i + 0], kernels[n * 8 * 9 + 8 * i + 1], kernels[n * 8 * 9 + 8 * i + 2], kernels[n * 8 * 9 + 8 * i + 3]);
            const vec4 k1 = vec4(kernels[n * 8 * 9 + 8 * i + 4], kernels[n * 8 * 9 + 8 * i + 5], kernels[n * 8 * 9 + 8 * i + 6], kernels[n * 8 * 9 + 8 * i + 7]);
            sum[n] += (dot(k0, r[i][0]) + dot(k1, r[i][1]));
        }
    }

    return ACTIVE(vec4(sum[0], sum[1], sum[2], sum[3]) * 0.2000000f + TEX_BIND_L2_TEXOFF(vec2(0.0f, 0.0f)));
}

//!HOOK LUMA
//!DESC ARNet b8 Layer14 L1
//!WHEN OUTPUT.w LUMA.w / 1.2 > OUTPUT.h LUMA.h / 1.2 > *
//!BIND TMP1_L0
//!BIND TMP1_L1
//!BIND TMP2_L1
//!SAVE TMP2_L1
//!COMPONENTS 4

#define ACTIVE(v) (v)

#define TEX_BIND_L0_TEXOFF TMP1_L0_texOff
#define TEX_BIND_L0_TEX TMP1_L0_tex
#define TEX_BIND_L0_POS TMP1_L0_pos
#define TEX_BIND_L0_SIZE TMP1_L0_size
#define TEX_BIND_L0_PT TMP1_L0_pt

#define TEX_BIND_L1_TEXOFF TMP1_L1_texOff
#define TEX_BIND_L1_TEX TMP1_L1_tex
#define TEX_BIND_L1_POS TMP1_L1_pos
#define TEX_BIND_L1_SIZE TMP1_L1_size
#define TEX_BIND_L1_PT TMP1_L1_pt

#define TEX_BIND_L2_TEXOFF TMP2_L1_texOff
#define TEX_BIND_L2_TEX TMP2_L1_tex
#define TEX_BIND_L2_POS TMP2_L1_pos
#define TEX_BIND_L2_SIZE TMP2_L1_size
#define TEX_BIND_L2_PT TMP2_L1_pt

const float kernels[288] = float[288](
  +0.0210639f, +0.2254410f, +0.2067104f, -0.0194429f, -0.0325158f, +0.1822365f, -0.0235732f, +0.2768039f,
  +0.2097187f, +0.1219435f, -0.0584890f, +0.1569789f, +0.0996948f, -0.3068224f, +0.5324063f, +0.3126697f,
  +0.1040562f, -0.1007578f, +0.0629895f, +0.1079916f, +0.1753661f, +0.0624089f, +0.4202646f, +0.1104475f,
  -0.2984740f, +0.1253417f, -0.0103481f, +0.1022913f, -0.1571580f, +0.3265347f, +0.4926011f, -0.1083568f,
  -0.3792356f, -0.9180641f, -0.0055536f, +0.9227018f, +0.3396462f, +0.0637586f, -0.3865714f, +0.3436154f,
  -0.4975656f, -0.3703414f, -0.1859548f, +0.0012946f, +0.6906568f, -0.1699309f, +0.0557607f, +0.2958232f,
  +0.1661697f, +0.2469087f, -0.0692281f, -0.0344406f, -0.2121813f, +0.1127179f, +0.2278312f, -0.0143225f,
  -0.0288266f, -0.8370144f, -0.1550111f, +0.4435079f, -0.1701245f, +0.0446212f, +0.2332595f, +0.2548642f,
  +0.0089055f, -0.3008177f, +0.0263873f, +0.0419268f, +0.0864031f, -0.0142486f, -0.0846670f, +0.3007139f,
  -0.1238793f, +0.4163566f, +0.0189345f, -0.5282546f, +0.0442510f, -0.1034417f, -0.1162625f, -0.2008390f,
  -0.4248584f, +0.5765409f, -0.1582868f, +0.3101602f, -0.2702871f, +0.3126912f, -0.3975282f, +0.3871690f,
  -0.0749053f, +0.2236011f, +0.0160794f, -0.1353549f, +0.0883967f, -0.0327637f, +0.0420361f, -0.1200388f,
  +0.0638653f, +0.2383640f, -0.2006615f, -0.5441575f, -0.2728015f, +0.3291404f, +0.1365800f, +0.0906970f,
  -0.5394482f, +1.6803674f, -0.1011161f, +0.1237625f, -1.2732506f, +0.0896796f, +1.2221348f, +0.2258274f,
  -0.8965075f, -0.7765560f, +0.3262751f, -0.7463481f, +0.5718305f, +0.0059978f, +0.4732011f, -0.1250747f,
  +0.1664395f, +0.4649398f, +0.0662975f, -0.1697748f, -0.5190582f, +0.2852110f, -0.1707855f, +0.3389857f,
  +0.1192348f, +0.6194500f, -0.1371608f, +0.0181322f, -0.4721736f, -0.1561375f, -0.3574383f, -0.0104308f,
  -0.2272545f, -0.2824119f, -0.1591546f, +0.3339759f, -0.0636004f, +0.0920777f, +0.2203716f, +0.0517484f,
  -0.4577296f, +0.0684169f, +0.1106483f, -0.2082668f, -0.1182181f, +0.3885686f, +0.8346198f, +0.1364783f,
  -0.2844622f, -0.0939453f, -0.0324459f, -0.0358007f, -0.1617230f, +0.7408562f, +0.4469328f, -0.3385325f,
  +0.0989719f, -0.1021264f, -0.0123687f, -0.0708612f, -0.1110861f, -0.0932157f, -0.3433182f, -0.1953900f,
  -0.0812953f, +0.6187022f, -0.0265828f, +0.1541769f, -0.0702441f, +0.3351771f, -0.0900131f, +0.2386457f,
  -0.0307755f, +0.3668241f, +0.0883534f, +0.5032143f, -0.6113275f, +0.3820930f, +0.2590952f, +0.6217704f,
  -0.1177431f, -0.0680392f, +0.4201420f, +0.3543479f, -0.2032472f, +0.4077136f, +0.1993168f, -0.2713822f,
  -0.0984689f, +0.3782951f, +0.0775725f, +0.3323964f, -0.2037461f, +0.3069994f, +0.0150009f, +0.1530592f,
  +0.1779782f, +0.1236835f, -0.3801586f, -0.3103580f, -0.2968605f, -0.2830071f, -0.0005006f, +0.3640329f,
  +0.1509990f, +0.1063954f, -0.1697297f, +0.2602987f, -0.0497753f, -0.3517348f, -0.0655432f, -0.1515703f,
  +0.0279172f, +0.1035201f, -0.0342387f, -0.1631551f, -0.1218881f, -0.0949686f, +0.0163147f, -0.0879121f,
  -0.1427465f, -0.0724977f, -0.1047246f, +0.3388198f, -0.1160160f, -0.3740581f, -0.7703402f, +0.2588494f,
  -0.2926778f, -0.1530433f, -0.1898298f, +0.1350298f, +0.1397423f, -0.0355487f, -0.1866966f, +0.1067018f,
  -0.1913660f, -0.1358254f, -0.0774738f, +0.1529421f, +0.3089100f, +0.1885734f, +0.0022219f, +0.0477698f,
  +0.1279073f, -0.5260436f, +0.0291975f, +0.7996551f, +0.3202862f, -0.3817151f, +0.1249502f, +0.2014694f,
  -0.2194806f, -0.4959638f, -0.0954651f, -0.0178844f, +0.0294520f, -0.3607515f, -0.1521506f, +0.1139331f,
  -0.0017566f, +0.5553034f, -0.1675593f, -0.4246488f, -0.2627501f, +0.1957315f, -0.3324814f, -0.0876932f,
  -0.1433193f, +0.0634100f, -0.4312063f, -0.6668328f, +0.0582754f, +0.1085386f, -0.3132434f, -0.0958726f,
  -0.0854928f, -0.2692699f, -0.1568223f, -0.2001764f, +0.0878067f, -0.0525554f, -0.2894513f, -0.0356706f
);

const float biases[4] = float[4](
  -0.0216724f, +0.0172502f, +0.0577375f, -0.0241015f
);

vec4 hook() {
    const vec4 r[9][2] = vec4[9][2](
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 1.0f)))
    );

    float sum[4] = biases;
    for (int n = 0; n < 4; n++) {
        for (int i = 0; i < 9; i++) {
            const vec4 k0 = vec4(kernels[n * 8 * 9 + 8 * i + 0], kernels[n * 8 * 9 + 8 * i + 1], kernels[n * 8 * 9 + 8 * i + 2], kernels[n * 8 * 9 + 8 * i + 3]);
            const vec4 k1 = vec4(kernels[n * 8 * 9 + 8 * i + 4], kernels[n * 8 * 9 + 8 * i + 5], kernels[n * 8 * 9 + 8 * i + 6], kernels[n * 8 * 9 + 8 * i + 7]);
            sum[n] += (dot(k0, r[i][0]) + dot(k1, r[i][1]));
        }
    }

    return ACTIVE(vec4(sum[0], sum[1], sum[2], sum[3]) * 0.2000000f + TEX_BIND_L2_TEXOFF(vec2(0.0f, 0.0f)));
}

//!HOOK LUMA
//!DESC ARNet b8 Layer15 L0
//!WHEN OUTPUT.w LUMA.w / 1.2 > OUTPUT.h LUMA.h / 1.2 > *
//!BIND TMP2_L0
//!BIND TMP2_L1
//!SAVE TMP1_L0
//!COMPONENTS 4

#define ACTIVE(v) (max(v, v * 0.2000000f))

#define TEX_BIND_L0_TEXOFF TMP2_L0_texOff
#define TEX_BIND_L0_TEX TMP2_L0_tex
#define TEX_BIND_L0_POS TMP2_L0_pos
#define TEX_BIND_L0_SIZE TMP2_L0_size
#define TEX_BIND_L0_PT TMP2_L0_pt

#define TEX_BIND_L1_TEXOFF TMP2_L1_texOff
#define TEX_BIND_L1_TEX TMP2_L1_tex
#define TEX_BIND_L1_POS TMP2_L1_pos
#define TEX_BIND_L1_SIZE TMP2_L1_size
#define TEX_BIND_L1_PT TMP2_L1_pt

const float kernels[288] = float[288](
  +0.0133736f, -0.1021138f, -0.1157914f, -0.1600474f, +0.0381357f, +0.2902161f, -0.0077418f, +0.0533832f,
  -0.3936480f, -0.1505139f, -0.1357519f, -0.0662351f, +0.3654192f, -0.2667956f, -0.1276073f, +0.5154905f,
  +0.3107630f, -0.1643695f, +0.1401401f, -0.1613967f, +0.3821731f, -0.0163628f, -0.1282134f, -0.1875936f,
  +0.4829375f, +0.1726504f, -0.4343152f, +0.2022163f, +0.4349291f, -0.1711318f, +0.3916667f, +0.2702294f,
  +1.0946605f, -0.0504070f, -0.2263534f, +0.1723481f, +0.4561583f, +1.2909911f, +0.0255256f, -0.6508324f,
  -0.8495094f, +0.0609960f, -0.3442996f, -0.4523022f, -0.3481206f, +0.5260295f, +0.2491239f, -0.3364555f,
  -0.2537120f, +0.1431090f, +0.1564738f, +0.5720590f, -0.2679102f, -0.0083866f, -0.2399237f, +0.2282048f,
  -0.5090253f, +0.5823119f, -0.1963685f, +0.0024291f, +0.0991330f, -0.3285320f, -0.0992409f, +0.6590641f,
  +0.4788929f, +0.1313042f, -0.0911515f, +0.2971463f, +0.4167257f, -0.0039779f, +0.0438862f, -0.0531737f,
  +0.0022550f, +0.1084871f, +0.0677318f, -0.1767497f, +0.2052117f, +0.1652967f, -0.2554079f, +0.0220525f,
  +0.2175375f, -0.0159603f, +0.2520486f, -0.0023108f, +0.0960966f, -0.0871663f, -0.2720749f, -0.1935211f,
  +0.3582198f, -0.0299318f, +0.1620714f, -0.0296880f, -0.0504363f, +0.0306466f, +0.0046324f, +0.0094786f,
  -0.3565398f, -0.5129825f, +0.0345019f, +0.0037963f, +0.5552846f, -0.1988222f, -0.4576598f, +0.8302819f,
  -0.3667804f, -0.0888009f, +0.1603746f, +0.2301965f, +0.4348098f, +0.2395705f, +0.5819721f, +0.4440750f,
  +0.1736564f, -0.2045302f, +0.1985273f, +0.3110644f, +0.2329863f, +0.0431551f, +0.1334613f, +0.3679416f,
  +0.5430456f, -0.0750025f, -0.2122962f, +0.6503951f, +0.2444466f, +0.0482711f, +0.5256587f, -0.2224828f,
  +0.3233498f, -0.0354649f, -0.0848277f, -0.2274885f, +0.0029105f, -0.1259020f, +0.7799070f, -0.8246650f,
  +0.0779736f, -0.1826881f, -0.1191199f, +0.2143078f, +0.0847126f, -0.0076289f, -0.0918813f, +0.2449025f,
  +0.1524875f, -0.0104319f, -0.0283782f, +0.0589414f, -0.3303758f, -0.3640183f, -0.2279992f, +0.0282576f,
  -0.2691846f, -0.3670964f, +0.0724977f, -0.1418404f, -0.4774670f, -0.4511506f, +0.1111307f, -0.5248567f,
  -0.0846202f, +0.0549731f, -0.0291940f, +0.2271938f, -0.2093005f, +0.0545346f, +0.0389459f, -0.0360613f,
  -0.3012248f, -0.2523845f, +0.2007722f, +0.2197897f, -0.0809049f, +0.1801767f, +0.0068868f, -0.2568609f,
  -0.2530298f, -0.1327540f, -0.2422405f, +0.0049271f, -0.1816743f, -0.3046957f, +0.1516393f, +0.4548413f,
  -0.2189466f, -0.2219488f, -0.0052853f, +0.1790949f, -0.0022038f, -0.0823955f, +0.0720731f, -0.1734450f,
  +0.0447583f, -0.2037731f, +0.0975656f, +0.0055904f, +0.0058937f, -0.0044889f, -0.0839102f, +0.0053670f,
  -0.6227837f, +0.1753363f, -0.3796020f, -0.3825159f, -0.1852250f, +0.0885631f, +0.0844708f, -0.0119761f,
  -0.1310529f, -0.0675108f, -0.2185913f, -0.0593280f, +0.1087747f, -0.1115607f, +0.0996789f, +0.1316807f,
  +1.1844101f, -0.0492319f, +0.0727248f, +0.4089388f, +0.1707234f, -0.2987488f, +0.0484797f, +0.4513733f,
  -0.2731252f, -0.3133195f, +0.3636463f, -0.3688276f, +0.5654885f, +0.6590667f, +0.1095788f, -0.3583611f,
  +0.1443899f, +0.1675432f, -0.0752540f, -0.1575200f, +0.1764017f, +0.2136237f, +0.0408810f, -0.0587110f,
  +0.1677301f, +0.0681117f, -0.4781564f, +0.8073390f, -0.2996891f, -0.3698544f, -0.3952611f, +0.1988058f,
  +1.0760599f, +0.0971424f, +1.1915746f, +0.0069082f, +1.2074631f, +0.6348885f, +0.1579711f, +0.1561817f,
  -0.2156738f, -0.0505339f, -0.1003284f, -0.4163127f, -0.4922328f, +0.0084678f, -0.3123867f, +0.1869838f,
  -0.0058681f, +0.0966558f, +0.1121608f, +0.3151589f, +0.1239247f, -0.0219362f, +0.0928524f, -0.3560722f,
  -0.0092864f, -0.0875869f, +0.0969325f, +0.5337034f, -0.0699363f, -0.0342640f, -0.2554875f, +0.2881415f,
  +0.1950414f, +0.1686766f, +0.1275245f, +0.0663214f, -0.0187799f, -0.0007214f, -0.1154999f, +0.1669158f
);

const float biases[4] = float[4](
  -0.0448940f, -0.1106067f, +0.0281813f, -0.1570762f
);

vec4 hook() {
    const vec4 r[9][2] = vec4[9][2](
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 1.0f)))
    );

    float sum[4] = biases;
    for (int n = 0; n < 4; n++) {
        for (int i = 0; i < 9; i++) {
            const vec4 k0 = vec4(kernels[n * 8 * 9 + 8 * i + 0], kernels[n * 8 * 9 + 8 * i + 1], kernels[n * 8 * 9 + 8 * i + 2], kernels[n * 8 * 9 + 8 * i + 3]);
            const vec4 k1 = vec4(kernels[n * 8 * 9 + 8 * i + 4], kernels[n * 8 * 9 + 8 * i + 5], kernels[n * 8 * 9 + 8 * i + 6], kernels[n * 8 * 9 + 8 * i + 7]);
            sum[n] += (dot(k0, r[i][0]) + dot(k1, r[i][1]));
        }
    }

    return ACTIVE(vec4(sum[0], sum[1], sum[2], sum[3]));
}

//!HOOK LUMA
//!DESC ARNet b8 Layer15 L1
//!WHEN OUTPUT.w LUMA.w / 1.2 > OUTPUT.h LUMA.h / 1.2 > *
//!BIND TMP2_L0
//!BIND TMP2_L1
//!SAVE TMP1_L1
//!COMPONENTS 4

#define ACTIVE(v) (max(v, v * 0.2000000f))

#define TEX_BIND_L0_TEXOFF TMP2_L0_texOff
#define TEX_BIND_L0_TEX TMP2_L0_tex
#define TEX_BIND_L0_POS TMP2_L0_pos
#define TEX_BIND_L0_SIZE TMP2_L0_size
#define TEX_BIND_L0_PT TMP2_L0_pt

#define TEX_BIND_L1_TEXOFF TMP2_L1_texOff
#define TEX_BIND_L1_TEX TMP2_L1_tex
#define TEX_BIND_L1_POS TMP2_L1_pos
#define TEX_BIND_L1_SIZE TMP2_L1_size
#define TEX_BIND_L1_PT TMP2_L1_pt

const float kernels[288] = float[288](
  +0.2911938f, +0.0807073f, +0.0019361f, +0.0945479f, -0.0264832f, +0.1063969f, +0.0186926f, +0.1945304f,
  -0.6304258f, -0.2933291f, -0.0672689f, +0.0249543f, -0.2437085f, -0.2931383f, +0.0098806f, -0.4764154f,
  -0.0824495f, -0.2821233f, +0.0510004f, -0.2120939f, -0.0774519f, -0.0806226f, -0.3384211f, -0.1101794f,
  -0.3396338f, -0.3774221f, +0.0598890f, -0.1174892f, +0.5168273f, +0.0200912f, -0.1758857f, +0.1981012f,
  +0.2705247f, +0.1873233f, +0.3494309f, -0.0954925f, -0.2214530f, -0.0589635f, -0.0098385f, -0.2239546f,
  +0.0218552f, -0.2877931f, -0.2005503f, -0.2764920f, +0.3454621f, -0.0606129f, +0.0181940f, -0.2741366f,
  -0.1868851f, -0.0797246f, -0.0821757f, +0.0378653f, +0.2065992f, -0.0377074f, -0.0453350f, -0.2595293f,
  +0.1880886f, -0.2525632f, +0.1674292f, +0.3655606f, -0.1453446f, +0.2126020f, +0.0264232f, +0.2488782f,
  +0.5319435f, -0.5054541f, +0.3655932f, +0.2437555f, +0.0432180f, -0.2047629f, -0.1037632f, +0.0286525f,
  -0.2830370f, -0.1227563f, -0.0378057f, +0.0040819f, +0.2352642f, -0.1512462f, -0.1453767f, +0.1422249f,
  +0.3699313f, +0.3502451f, -0.0711577f, -0.0302762f, +0.1745051f, +0.0302146f, +0.0184275f, +0.2804254f,
  +0.1342843f, +0.0669537f, -0.1170148f, -0.1429429f, +0.0763911f, +0.0150301f, -0.0885191f, +0.0297761f,
  -0.6156470f, +0.0481162f, +0.1126853f, +0.3321670f, -0.4287174f, -0.2310236f, -0.0776117f, +0.0167869f,
  -1.3603762f, -0.6398955f, -0.1304746f, +0.0722604f, -0.2177004f, -0.1893158f, +0.1830160f, -1.2574811f,
  -0.3573175f, +0.3741269f, -0.1355120f, +0.4289042f, -0.0706453f, +0.0765046f, +0.0474814f, -0.0934779f,
  -0.1389630f, -0.1210103f, +0.0608730f, -0.1430324f, +0.0322850f, -0.0066274f, +0.1582327f, -0.1444746f,
  -0.4095403f, +0.0779805f, -0.4216765f, -0.5455502f, -0.0574758f, +0.0494554f, -0.0072666f, +0.1902470f,
  +0.1560372f, -0.1222556f, -0.0479913f, -0.3108272f, +0.3056166f, -0.0993124f, +0.0604604f, -0.1382769f,
  -0.0140139f, +0.1288636f, +0.1328749f, -0.0095422f, +0.1038878f, -0.0553551f, -0.1056709f, +0.3031609f,
  -0.1358998f, +0.0229351f, +0.2316605f, +0.1148065f, -0.1348166f, -0.2132478f, +0.0125571f, +0.2059317f,
  -0.0756252f, -0.0081469f, +0.0045594f, -0.0195469f, +0.0189384f, -0.1747301f, +0.0373369f, -0.0907894f,
  +0.1150498f, -0.4943218f, +0.0280152f, -0.1339321f, +0.3636357f, +0.0528298f, -0.0960897f, -0.2892549f,
  +0.5767738f, -0.4798707f, +0.5893883f, -0.1816477f, +0.3831959f, +0.1519229f, +0.0192886f, -0.1071937f,
  +0.1116013f, -0.3054858f, +0.1758250f, -0.2954589f, -0.1952078f, +0.0613078f, -0.0680457f, -0.2335144f,
  +0.0903897f, +0.0696710f, +0.1558202f, -0.0293931f, -0.0468785f, +0.0958226f, -0.2766830f, -0.1525827f,
  +0.1545476f, +0.1920229f, +0.1427787f, -0.0304446f, +0.0592074f, -0.0310723f, -0.0036652f, +0.2486508f,
  -0.2518576f, +0.2719027f, -0.0896944f, -0.1764889f, -0.2400528f, -0.0012444f, +0.0481016f, +0.0605650f,
  -0.0698502f, -0.2189702f, -0.0779631f, -0.0544630f, +0.0137650f, -0.2579813f, -0.0605761f, -0.1758829f,
  -0.0830665f, -0.2133722f, -0.0237768f, -0.2438049f, -0.0228908f, -0.3926115f, -0.1760966f, +0.0958700f,
  +0.0826424f, -0.0840115f, -0.0115217f, -0.1133444f, -0.0574984f, -0.0151653f, -0.0409644f, +0.1672331f,
  +0.0245222f, +0.0770327f, +0.0958571f, +0.1528411f, -0.5219056f, +0.0441242f, -0.1571834f, -0.0729172f,
  -0.3963799f, +0.1445320f, +0.3650238f, +0.2955221f, -0.8245183f, +0.7431363f, -0.0299446f, -0.5834416f,
  -0.4636459f, +0.0581540f, +0.1823538f, -0.1069959f, -0.5340219f, -0.0050985f, +0.0847943f, -0.3435465f,
  -0.1100964f, -0.0969155f, +0.0431991f, +0.0044059f, -0.0760046f, +0.0296071f, -0.0303815f, +0.0905004f,
  -0.3405527f, +0.2423217f, -0.3575035f, -0.4975185f, +0.1953089f, -0.2041800f, -0.0225019f, +0.0141188f,
  +0.2604592f, +0.1671182f, -0.1329629f, -0.1060158f, +0.4023253f, +0.1210754f, -0.1828266f, +0.1037859f
);

const float biases[4] = float[4](
  -0.0201759f, +0.0268471f, +0.1320131f, +0.0789189f
);

vec4 hook() {
    const vec4 r[9][2] = vec4[9][2](
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 1.0f)))
    );

    float sum[4] = biases;
    for (int n = 0; n < 4; n++) {
        for (int i = 0; i < 9; i++) {
            const vec4 k0 = vec4(kernels[n * 8 * 9 + 8 * i + 0], kernels[n * 8 * 9 + 8 * i + 1], kernels[n * 8 * 9 + 8 * i + 2], kernels[n * 8 * 9 + 8 * i + 3]);
            const vec4 k1 = vec4(kernels[n * 8 * 9 + 8 * i + 4], kernels[n * 8 * 9 + 8 * i + 5], kernels[n * 8 * 9 + 8 * i + 6], kernels[n * 8 * 9 + 8 * i + 7]);
            sum[n] += (dot(k0, r[i][0]) + dot(k1, r[i][1]));
        }
    }

    return ACTIVE(vec4(sum[0], sum[1], sum[2], sum[3]));
}

//!HOOK LUMA
//!DESC ARNet b8 Layer16 L0
//!WHEN OUTPUT.w LUMA.w / 1.2 > OUTPUT.h LUMA.h / 1.2 > *
//!BIND TMP1_L0
//!BIND TMP1_L1
//!BIND TMP2_L0
//!BIND FEAT_L0
//!SAVE TMP2_L0
//!COMPONENTS 4

#define ACTIVE(v) (v)

#define TEX_BIND_L0_TEXOFF TMP1_L0_texOff
#define TEX_BIND_L0_TEX TMP1_L0_tex
#define TEX_BIND_L0_POS TMP1_L0_pos
#define TEX_BIND_L0_SIZE TMP1_L0_size
#define TEX_BIND_L0_PT TMP1_L0_pt

#define TEX_BIND_L1_TEXOFF TMP1_L1_texOff
#define TEX_BIND_L1_TEX TMP1_L1_tex
#define TEX_BIND_L1_POS TMP1_L1_pos
#define TEX_BIND_L1_SIZE TMP1_L1_size
#define TEX_BIND_L1_PT TMP1_L1_pt

#define TEX_BIND_L2_TEXOFF TMP2_L0_texOff
#define TEX_BIND_L2_TEX TMP2_L0_tex
#define TEX_BIND_L2_POS TMP2_L0_pos
#define TEX_BIND_L2_SIZE TMP2_L0_size
#define TEX_BIND_L2_PT TMP2_L0_pt

#define TEX_BIND_L3_TEXOFF FEAT_L0_texOff
#define TEX_BIND_L3_TEX FEAT_L0_tex
#define TEX_BIND_L3_POS FEAT_L0_pos
#define TEX_BIND_L3_SIZE FEAT_L0_size
#define TEX_BIND_L3_PT FEAT_L0_pt

const float kernels[288] = float[288](
  +0.0928478f, -0.0243384f, +0.0944759f, +0.0699487f, -0.0791536f, -0.1232616f, -0.0904066f, +0.0874233f,
  +0.3758947f, -0.4366108f, +0.2814513f, -0.3257855f, +0.0416385f, +0.2680182f, -0.2853148f, +0.1316594f,
  -0.0836545f, +0.2377954f, +0.0507546f, +0.0002001f, +0.0692635f, +0.0111212f, +0.0436464f, +0.1275854f,
  +0.0371279f, +0.1050468f, +0.2066282f, -0.0339022f, -0.0243817f, +0.2265345f, -0.1221478f, +0.1222445f,
  -0.2611108f, +0.6136090f, -0.1896174f, +1.0233028f, -0.1069155f, +0.2525687f, +0.1163815f, +0.5064269f,
  +0.3227915f, -0.1633240f, +0.0677668f, +0.1154386f, +0.2544352f, +0.1966695f, -0.1499656f, +0.0439443f,
  -0.0470996f, +0.1308551f, -0.0259887f, -0.1673446f, -0.0435852f, +0.0118151f, -0.0220214f, +0.0837413f,
  -0.3051284f, +0.0053224f, -0.0398056f, -0.2523408f, +0.1860075f, -0.1163154f, -0.0125121f, +0.2612619f,
  +0.2432720f, -0.1827497f, +0.1594989f, -0.0135859f, +0.0505061f, +0.0800276f, +0.3796913f, +0.0446105f,
  -0.2085476f, +0.2520410f, +0.1217484f, -0.0193560f, +0.1641604f, -0.2209277f, -0.0568551f, -0.0282401f,
  +0.0395109f, +0.7101672f, -0.1326372f, +0.0792626f, +0.0471111f, -0.0117843f, -0.1264421f, -0.2688880f,
  -0.1080272f, +0.0687175f, -0.0039067f, +0.0396426f, -0.0759230f, -0.2868708f, -0.0182678f, +0.0069485f,
  -0.1890504f, -0.0204871f, -0.1227926f, -0.2595424f, +0.0049966f, -0.3983952f, +0.1688729f, -0.1357626f,
  +0.7502748f, -0.8978128f, +0.0847141f, -0.0925018f, +0.3132699f, +0.0870568f, +0.2099635f, -0.2196104f,
  -0.0124494f, +0.0702119f, +0.3075829f, -0.3487199f, -0.0260079f, +0.1587953f, +0.3863994f, -0.2248081f,
  +0.3315616f, -0.0944144f, +0.0063696f, +0.3344349f, +0.1372407f, +0.1641622f, -0.1944558f, +0.0131974f,
  -0.2344686f, +0.2240023f, -0.1299701f, -0.9022938f, +0.4445521f, -0.0928419f, +0.2702036f, +0.1203451f,
  -0.0993827f, -0.0716542f, +0.0504969f, +0.3156713f, +0.0596857f, -0.0574873f, -0.0230500f, +0.0485221f,
  +0.2174711f, +0.1408185f, -0.3070298f, -0.1604462f, -0.4852608f, +0.1391179f, +0.9001335f, -0.0015547f,
  -0.4996624f, +0.4395131f, +0.6516237f, +0.5315430f, +0.4402741f, +0.2082881f, +0.1617672f, +0.1523818f,
  +0.0773860f, -0.3864333f, -0.0679173f, -0.1855304f, -0.1324658f, -0.3621451f, -0.0205924f, -0.0230942f,
  +0.2288458f, -0.2215168f, -0.0521648f, -0.5862014f, -0.9937038f, +0.4360261f, +0.3886494f, -0.9611762f,
  +1.0976089f, -0.7651106f, +0.8284270f, -0.3433648f, +0.1940105f, -0.4952635f, +0.0241396f, -0.5973966f,
  -0.4708964f, +0.4089712f, -0.0187384f, -0.3393043f, -0.4120241f, -0.3661079f, -0.1529390f, -0.1783993f,
  +0.0668741f, +0.0523414f, -0.2227274f, +1.1772938f, -0.2708307f, +0.3030394f, -0.1201364f, -0.5567487f,
  -0.5604916f, +0.4906926f, -0.2140378f, -2.1214092f, +0.1275008f, -0.2068606f, -0.0266934f, +0.2293720f,
  -0.3455922f, +0.2953772f, +0.3820892f, +0.1966237f, +0.1223745f, -0.0023086f, -0.3106279f, -0.2991411f,
  +0.5149095f, -0.0728892f, -0.0380981f, +0.0818792f, +0.1180680f, +0.0848636f, -0.1264386f, -0.2394648f,
  -0.4202818f, -0.2830859f, -0.4092646f, -0.3209644f, +0.3509297f, -0.0514979f, -0.0479789f, +0.2693362f,
  -0.0997644f, +0.2681392f, -0.2442255f, -0.0021634f, +0.1858446f, +0.0246918f, +0.4276484f, -0.0779949f,
  -0.1858962f, -0.3249091f, -0.3687632f, +0.1263769f, +0.2835254f, -0.4636634f, +0.0597393f, +0.2125140f,
  -0.5553349f, -0.6593956f, +0.1713438f, -0.8027666f, -0.2524882f, -0.5356831f, +0.2541614f, -0.1095142f,
  +0.8773293f, -0.6552773f, +0.0652881f, -0.1441865f, +0.0351630f, -0.3859527f, +0.0929956f, +0.1551743f,
  +0.3519956f, -0.1849061f, -0.1425194f, -0.1711875f, +0.2218691f, +0.2528286f, -0.0248831f, -0.0806426f,
  -0.2338023f, +0.1652014f, -0.0450745f, -0.3181962f, +0.3435788f, -0.1172553f, -0.0353882f, +0.3797657f,
  +0.1173113f, -0.1530015f, -0.0928016f, +0.6265126f, -0.0490888f, +0.1690258f, -0.0145433f, +0.0363865f
);

const float biases[4] = float[4](
  -0.0356133f, -0.1057993f, +0.2777449f, -0.0208250f
);

vec4 hook() {
    const vec4 r[9][2] = vec4[9][2](
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 1.0f)))
    );

    float sum[4] = biases;
    for (int n = 0; n < 4; n++) {
        for (int i = 0; i < 9; i++) {
            const vec4 k0 = vec4(kernels[n * 8 * 9 + 8 * i + 0], kernels[n * 8 * 9 + 8 * i + 1], kernels[n * 8 * 9 + 8 * i + 2], kernels[n * 8 * 9 + 8 * i + 3]);
            const vec4 k1 = vec4(kernels[n * 8 * 9 + 8 * i + 4], kernels[n * 8 * 9 + 8 * i + 5], kernels[n * 8 * 9 + 8 * i + 6], kernels[n * 8 * 9 + 8 * i + 7]);
            sum[n] += (dot(k0, r[i][0]) + dot(k1, r[i][1]));
        }
    }

    return ACTIVE(vec4(sum[0], sum[1], sum[2], sum[3]) * 0.2000000f + TEX_BIND_L2_TEXOFF(vec2(0.0f, 0.0f)) + TEX_BIND_L3_TEXOFF(vec2(0.0f, 0.0f)));
}

//!HOOK LUMA
//!DESC ARNet b8 Layer16 L1
//!WHEN OUTPUT.w LUMA.w / 1.2 > OUTPUT.h LUMA.h / 1.2 > *
//!BIND TMP1_L0
//!BIND TMP1_L1
//!BIND TMP2_L1
//!BIND FEAT_L1
//!SAVE TMP2_L1
//!COMPONENTS 4

#define ACTIVE(v) (v)

#define TEX_BIND_L0_TEXOFF TMP1_L0_texOff
#define TEX_BIND_L0_TEX TMP1_L0_tex
#define TEX_BIND_L0_POS TMP1_L0_pos
#define TEX_BIND_L0_SIZE TMP1_L0_size
#define TEX_BIND_L0_PT TMP1_L0_pt

#define TEX_BIND_L1_TEXOFF TMP1_L1_texOff
#define TEX_BIND_L1_TEX TMP1_L1_tex
#define TEX_BIND_L1_POS TMP1_L1_pos
#define TEX_BIND_L1_SIZE TMP1_L1_size
#define TEX_BIND_L1_PT TMP1_L1_pt

#define TEX_BIND_L2_TEXOFF TMP2_L1_texOff
#define TEX_BIND_L2_TEX TMP2_L1_tex
#define TEX_BIND_L2_POS TMP2_L1_pos
#define TEX_BIND_L2_SIZE TMP2_L1_size
#define TEX_BIND_L2_PT TMP2_L1_pt

#define TEX_BIND_L3_TEXOFF FEAT_L1_texOff
#define TEX_BIND_L3_TEX FEAT_L1_tex
#define TEX_BIND_L3_POS FEAT_L1_pos
#define TEX_BIND_L3_SIZE FEAT_L1_size
#define TEX_BIND_L3_PT FEAT_L1_pt

const float kernels[288] = float[288](
  -0.0409742f, +0.0906040f, +0.0844491f, -0.0738869f, -0.1249797f, -0.2766255f, -0.2588201f, +0.0278122f,
  +0.0425628f, -0.4018529f, -0.1814993f, +0.1965407f, -0.3995442f, +0.2797747f, -0.1598292f, -0.0477702f,
  -0.1539048f, +0.5025097f, -0.1484941f, +0.0740954f, -0.0789659f, +0.0872613f, -0.0214300f, -0.2239594f,
  +0.5223950f, -0.2735094f, -0.1909806f, +0.2556792f, -0.0734103f, -0.2842792f, +0.1525407f, +0.1889404f,
  -0.0829736f, -1.0690683f, +0.3890451f, +1.0419786f, -0.1170268f, -0.3216080f, -0.1710205f, +0.5807934f,
  -0.2452775f, +0.1095455f, -0.0325102f, -0.1803017f, -0.5032209f, -0.1801672f, -0.3481406f, -0.0631476f,
  +0.1055643f, +0.0682406f, -0.0219493f, -0.2099969f, +0.2902619f, -0.1213616f, +0.0678422f, -0.0443832f,
  -0.3970048f, +0.0132216f, +0.2547584f, +0.3636806f, +0.1243069f, -0.4258448f, -0.0247630f, +0.5270386f,
  -0.3518466f, +0.4060136f, +0.1206940f, +0.0928372f, +0.0416878f, -0.0349214f, -0.0691520f, -0.1010007f,
  +0.1676459f, -0.1773981f, -0.0209618f, -0.0344070f, +0.2433617f, +0.2168091f, -0.1787097f, -0.0594472f,
  -0.9131935f, -0.5198575f, -0.1641682f, +0.2225547f, -0.0502946f, -0.4135457f, +0.4158362f, +0.0870735f,
  +0.3244448f, +0.6351116f, +0.1108460f, +0.1009572f, +0.0401892f, +0.0860285f, -0.2518337f, -0.1405894f,
  +0.2946376f, +0.0008119f, -0.2352637f, +0.1485553f, +0.5149530f, +0.3364760f, -0.0754384f, +0.3499646f,
  +0.8024837f, -0.0599134f, +0.6541995f, -0.3056777f, +0.6138833f, -0.0901153f, -0.8349686f, -1.2840793f,
  -0.2841145f, -0.3059297f, +0.1416892f, +0.5249087f, +0.0782161f, +0.4502293f, -0.6070232f, +0.2394049f,
  +0.0191512f, +0.2046921f, -0.1198082f, -0.4967768f, +0.3489139f, +0.0342548f, -0.0378034f, +0.0522594f,
  -0.0383052f, +0.1935043f, +0.5296999f, -1.0098996f, +0.7167466f, -0.4291312f, +0.2138929f, +0.6043773f,
  -0.3326528f, +0.2501076f, +0.6355979f, +1.1471249f, +0.2122980f, -0.3736930f, -0.2323208f, +0.1012459f,
  -0.3165987f, -0.2494117f, -0.1134059f, +0.1729722f, +0.0135087f, +0.0841687f, +0.0282437f, -0.0785569f,
  +0.6529476f, +0.4409152f, -0.2174952f, -0.2237573f, -0.6629224f, +0.3449216f, +0.3314798f, +0.0037863f,
  +0.0878582f, +0.2124420f, -0.1081136f, +0.0212702f, -0.0834662f, +0.2936677f, -0.0191525f, -0.1386339f,
  +0.9884057f, -0.1263889f, -0.0164697f, +0.1267890f, -0.1985933f, +0.3751942f, -0.0430244f, +0.2034354f,
  -1.4232033f, +0.1441687f, -0.7082324f, +0.2615298f, -0.1882102f, -0.2007713f, +0.0644098f, -0.5983341f,
  +0.3764309f, -0.4506232f, -0.0332613f, +0.2798822f, +0.1708044f, +0.5932221f, +0.1662601f, +0.0612435f,
  -0.1474663f, -0.1159573f, -0.5195666f, -0.1733735f, -0.2005993f, +0.2669286f, +0.0259070f, -0.1938386f,
  -0.0637435f, +0.2002588f, -0.5125709f, -1.0765761f, -0.0024350f, +0.1676163f, -0.2832305f, +0.5688668f,
  -0.2190911f, +0.2111633f, +0.2061945f, +0.5431206f, -0.1006631f, +0.4362598f, -0.2851717f, -0.0242227f,
  +0.0293888f, -0.2119665f, +0.0832922f, -0.1212191f, +0.0581561f, +0.3191981f, +0.4404399f, +0.0487695f,
  -0.0809353f, -0.4175147f, +0.0289329f, +0.3200058f, +0.0564073f, -0.0751133f, -0.1044019f, +0.1287612f,
  +0.1208223f, -0.8799206f, +0.1384387f, -0.1535703f, -0.0291841f, -0.1622328f, -0.1097196f, +0.1805359f,
  +0.1831826f, +0.2893379f, +0.2582039f, +0.0715259f, +0.0588175f, -0.0131228f, +0.3443683f, +0.0362658f,
  -0.3511569f, +0.3935499f, -0.0543901f, -0.2742967f, +0.2778654f, +0.4558558f, +0.0914732f, +0.3679383f,
  -0.4256571f, +0.3555230f, -0.3957096f, -0.1207695f, +0.0959303f, -0.0963059f, -0.0136177f, -0.1231324f,
  +0.0798529f, +0.1680457f, -0.0582683f, -0.1331770f, +0.1113088f, +0.1173382f, +0.1800040f, -0.0992514f,
  -0.1951575f, +0.1867264f, +0.3000459f, +0.2208443f, +0.1430591f, -0.3425524f, -0.0897092f, +0.1855458f,
  -0.0233194f, +0.0665413f, +0.0946733f, -0.4607315f, -0.1002693f, -0.0871658f, -0.4619417f, -0.1311275f
);

const float biases[4] = float[4](
  +0.0715211f, -0.1366574f, +0.0087676f, -0.0520176f
);

vec4 hook() {
    const vec4 r[9][2] = vec4[9][2](
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 1.0f)))
    );

    float sum[4] = biases;
    for (int n = 0; n < 4; n++) {
        for (int i = 0; i < 9; i++) {
            const vec4 k0 = vec4(kernels[n * 8 * 9 + 8 * i + 0], kernels[n * 8 * 9 + 8 * i + 1], kernels[n * 8 * 9 + 8 * i + 2], kernels[n * 8 * 9 + 8 * i + 3]);
            const vec4 k1 = vec4(kernels[n * 8 * 9 + 8 * i + 4], kernels[n * 8 * 9 + 8 * i + 5], kernels[n * 8 * 9 + 8 * i + 6], kernels[n * 8 * 9 + 8 * i + 7]);
            sum[n] += (dot(k0, r[i][0]) + dot(k1, r[i][1]));
        }
    }

    return ACTIVE(vec4(sum[0], sum[1], sum[2], sum[3]) * 0.2000000f + TEX_BIND_L2_TEXOFF(vec2(0.0f, 0.0f)) + TEX_BIND_L3_TEXOFF(vec2(0.0f, 0.0f)));
}

//!HOOK LUMA
//!DESC ARNet b8 Layer17 L0
//!WHEN OUTPUT.w LUMA.w / 1.2 > OUTPUT.h LUMA.h / 1.2 > *
//!BIND TMP2_L0
//!BIND TMP2_L1
//!SAVE TMP1_L0
//!COMPONENTS 4

#define ACTIVE(v) (v)

#define TEX_BIND_L0_TEXOFF TMP2_L0_texOff
#define TEX_BIND_L0_TEX TMP2_L0_tex
#define TEX_BIND_L0_POS TMP2_L0_pos
#define TEX_BIND_L0_SIZE TMP2_L0_size
#define TEX_BIND_L0_PT TMP2_L0_pt

#define TEX_BIND_L1_TEXOFF TMP2_L1_texOff
#define TEX_BIND_L1_TEX TMP2_L1_tex
#define TEX_BIND_L1_POS TMP2_L1_pos
#define TEX_BIND_L1_SIZE TMP2_L1_size
#define TEX_BIND_L1_PT TMP2_L1_pt

const float kernels[288] = float[288](
  -0.1813571f, -0.1301040f, -0.0340710f, +0.0551414f, +0.0049220f, -0.2011156f, -0.0026618f, +0.1302276f,
  -0.0268037f, -0.0048018f, +0.0043674f, -0.0686052f, -0.0415544f, -0.0236659f, +0.0046848f, -0.0550323f,
  -0.0407769f, +0.0261777f, -0.0423814f, +0.0523452f, +0.0745847f, -0.0025558f, +0.0618113f, +0.1117994f,
  -0.2228071f, -0.0220494f, +0.0106505f, -0.0448251f, -0.0591540f, +0.1215676f, -0.0549423f, +0.0851804f,
  -0.2398807f, +0.0398803f, -0.0476204f, -0.0134625f, -0.2068199f, +0.3046365f, +0.0687937f, +0.1333855f,
  -0.0426095f, -0.0191143f, +0.0620799f, -0.0793697f, -0.0637619f, -0.0675705f, +0.0825626f, -0.1449327f,
  +0.0652175f, -0.0067147f, +0.0123931f, +0.0402600f, +0.0527570f, -0.0248963f, -0.0147083f, +0.0301134f,
  -0.0097573f, +0.0150934f, +0.0014287f, +0.0912560f, +0.0205539f, -0.0509941f, -0.0467115f, +0.0716843f,
  +0.0024427f, +0.0318964f, -0.0229326f, +0.0144716f, +0.0412592f, +0.0029755f, -0.0026173f, +0.0632385f,
  -0.0473884f, +0.0091532f, -0.0144946f, +0.0451178f, +0.0031148f, -0.0459307f, +0.0462472f, +0.1436985f,
  -0.3187244f, -0.2166722f, -0.0695427f, -0.0414041f, +0.0099933f, -0.2216031f, -0.1082113f, -0.0040843f,
  -0.0343960f, -0.0232840f, +0.0250279f, -0.0162982f, +0.0162138f, -0.0640685f, +0.0261109f, -0.0248662f,
  -0.2309484f, -0.0374030f, -0.0084544f, -0.0597742f, +0.0021741f, +0.0037213f, +0.0309047f, +0.0468961f,
  -0.2392555f, -0.2057067f, -0.0174004f, -0.0553411f, -0.0836182f, +0.3872852f, -0.1060584f, +0.0329970f,
  -0.0143547f, +0.0273999f, +0.0721390f, -0.1080052f, -0.0789154f, -0.0212218f, +0.1427270f, -0.0703279f,
  +0.0452272f, +0.0970101f, -0.0206792f, -0.0535788f, +0.0283622f, +0.0039552f, +0.0169783f, +0.0432965f,
  +0.0712480f, -0.0952737f, +0.0595923f, +0.1439994f, +0.0323922f, -0.0579962f, -0.0652344f, -0.0246104f,
  -0.0152923f, +0.0577264f, -0.0310032f, +0.0705293f, +0.0462829f, +0.0044235f, -0.0179284f, +0.1217935f,
  -0.0469734f, -0.0188763f, -0.0055874f, +0.0518083f, +0.0049640f, -0.0202818f, +0.0289493f, +0.0566020f,
  +0.1273939f, +0.2114800f, +0.0442887f, +0.0531065f, +0.0142467f, +0.0325077f, +0.0287176f, +0.0835384f,
  -0.0015872f, -0.0489124f, +0.0367959f, -0.0027338f, +0.0508305f, -0.0032507f, +0.0537783f, -0.0013243f,
  -0.3158405f, -0.0710395f, -0.0581726f, -0.0918539f, +0.0661806f, -0.1322875f, -0.0437305f, +0.2038650f,
  +0.0353380f, -0.0002140f, -0.0991276f, +0.0234773f, -0.0079342f, +0.1386676f, +0.1163482f, +0.2589319f,
  -0.0801514f, +0.0217139f, -0.0373998f, +0.0389146f, -0.0157192f, -0.0223979f, -0.0086193f, -0.0040350f,
  +0.0005211f, -0.0492712f, +0.0270545f, +0.0717218f, -0.0422699f, +0.0364708f, -0.0082360f, +0.0078148f,
  -0.1293131f, -0.1212524f, +0.0810835f, +0.1417390f, -0.0674718f, +0.0556629f, -0.1092154f, +0.0259511f,
  +0.0003757f, +0.0652509f, -0.0137109f, -0.0692156f, +0.0108670f, -0.0279715f, +0.0679869f, +0.0053244f,
  +0.0102428f, +0.0234644f, -0.0068946f, +0.0299301f, +0.0135045f, -0.0201318f, +0.0215468f, +0.1208805f,
  -0.0353285f, +0.0671316f, +0.0382777f, +0.0641171f, +0.0036052f, -0.0318020f, -0.0081293f, +0.0297058f,
  +0.0027803f, -0.0139849f, +0.0499427f, -0.0006602f, +0.0114996f, -0.0351029f, +0.0461960f, -0.0332647f,
  -0.2795838f, -0.0830118f, -0.0230179f, -0.0302382f, +0.0177817f, -0.0245137f, +0.0779086f, +0.0295832f,
  -0.1671248f, -0.2718631f, -0.1522564f, -0.0968600f, +0.1645856f, +0.0314470f, -0.1158343f, +0.2936310f,
  +0.0844736f, +0.0524351f, +0.0127830f, -0.0015710f, +0.0484734f, -0.0212784f, +0.0494867f, +0.0515828f,
  -0.0061721f, +0.1287997f, -0.0421703f, -0.0990941f, +0.0169861f, +0.0013076f, +0.0319918f, +0.0775187f,
  -0.0352798f, -0.2533372f, +0.1173789f, +0.2386798f, -0.0740201f, +0.1053973f, -0.1250125f, -0.1239892f,
  -0.0351945f, +0.0330435f, +0.0317219f, +0.0140766f, -0.0295788f, -0.0163068f, +0.0312729f, +0.0584646f
);

const float biases[4] = float[4](
  +0.0612460f, +0.0731059f, +0.0764522f, +0.0897273f
);

vec4 hook() {
    const vec4 r[9][2] = vec4[9][2](
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 1.0f)))
    );

    float sum[4] = biases;
    for (int n = 0; n < 4; n++) {
        for (int i = 0; i < 9; i++) {
            const vec4 k0 = vec4(kernels[n * 8 * 9 + 8 * i + 0], kernels[n * 8 * 9 + 8 * i + 1], kernels[n * 8 * 9 + 8 * i + 2], kernels[n * 8 * 9 + 8 * i + 3]);
            const vec4 k1 = vec4(kernels[n * 8 * 9 + 8 * i + 4], kernels[n * 8 * 9 + 8 * i + 5], kernels[n * 8 * 9 + 8 * i + 6], kernels[n * 8 * 9 + 8 * i + 7]);
            sum[n] += (dot(k0, r[i][0]) + dot(k1, r[i][1]));
        }
    }

    return ACTIVE(vec4(sum[0], sum[1], sum[2], sum[3]));
}

//!HOOK LUMA
//!DESC ACNet b8 Layer18 L0
//!WIDTH LUMA.w 2 *
//!HEIGHT LUMA.h 2 *
//!BIND TMP1_L0
//!COMPONENTS 1

#define TEX_BIND_L0_TEXOFF TMP1_L0_texOff
#define TEX_BIND_L0_TEX TMP1_L0_tex
#define TEX_BIND_L0_POS TMP1_L0_pos
#define TEX_BIND_L0_SIZE TMP1_L0_size
#define TEX_BIND_L0_PT TMP1_L0_pt

vec4 hook() {
    vec2 fcoord = fract(TEX_BIND_L0_POS * TEX_BIND_L0_SIZE);
    vec2 pos = TEX_BIND_L0_POS + (vec2(0.5f) - fcoord) * TEX_BIND_L0_PT;

    ivec2 icoord = ivec2(fcoord * vec2(2.0f));
    int index = icoord.y * 2 + icoord.x;

    vec4 r = TEX_BIND_L0_TEX(pos);

    return vec4(clamp(float[4](r.x, r.y, r.z, r.w)[index], 0.0f, 1.0f), 0.0f, 0.0f, 1.0f);
}
