//!HOOK LUMA
//!DESC ACNet Layer0 L0
//!WHEN OUTPUT.w LUMA.w / 1.2 > OUTPUT.h LUMA.h / 1.2 > *
//!BIND LUMA
//!SAVE TMP1_L0
//!COMPONENTS 4

#define ACTIVE(v) (max(v, 0.0f))

#define TEX_BIND_L0_TEXOFF LUMA_texOff
#define TEX_BIND_L0_TEX LUMA_tex
#define TEX_BIND_L0_POS LUMA_pos
#define TEX_BIND_L0_SIZE LUMA_size
#define TEX_BIND_L0_PT LUMA_pt

const float kernels[36] = float[36](
  +0.0441616f, +0.0861672f, -0.0674997f, -0.1433230f, +0.7180264f, +0.1717445f, +0.0794144f, +0.0671351f,
  +0.0014139f, +0.0052910f, +0.1549240f, -0.8575752f, +0.0371139f, +0.8681992f, -0.2410071f, -0.0388188f,
  +0.0564710f, +0.0099080f, -0.1915272f, +0.7269663f, +0.0113055f, -0.8416671f, +0.4150768f, +0.0109638f,
  -0.0363220f, -0.0584788f, -0.0102980f, +0.0311330f, -0.9430303f, +0.1308698f, -0.0564992f, +0.1307037f,
  +0.7113526f, -0.0083213f, +0.0330729f, -0.0141427f
);

const float biases[4] = float[4](
  -0.7604295f, -0.0059439f, +0.0173967f, +0.0045202f
);

vec4 hook() {
    const vec4 r0 = vec4(
        TEX_BIND_L0_TEXOFF(vec2(-1.0f,-1.0f)).x,
        TEX_BIND_L0_TEXOFF(vec2( 0.0f,-1.0f)).x,
        TEX_BIND_L0_TEXOFF(vec2( 1.0f,-1.0f)).x,
        TEX_BIND_L0_TEXOFF(vec2(-1.0f, 0.0f)).x
    );
    const vec4 r4 = vec4(
        TEX_BIND_L0_TEXOFF(vec2( 0.0f, 0.0f)).x,
        TEX_BIND_L0_TEXOFF(vec2( 1.0f, 0.0f)).x,
        TEX_BIND_L0_TEXOFF(vec2(-1.0f, 1.0f)).x,
        TEX_BIND_L0_TEXOFF(vec2( 0.0f, 1.0f)).x
    );
    const float r8 = TEX_BIND_L0_TEXOFF(vec2( 1.0f, 1.0f)).x;

    float sum[4] = biases;
    for(int n = 0; n < 4; n++) {
        const vec4 k0 = vec4(kernels[n * 9 + 0], kernels[n * 9 + 1], kernels[n * 9 + 2], kernels[n * 9 + 3]);
        const vec4 k4 = vec4(kernels[n * 9 + 4], kernels[n * 9 + 5], kernels[n * 9 + 6], kernels[n * 9 + 7]);
        const float k8 = kernels[n * 9 + 8];
        sum[n] += (dot(r0, k0) + dot(r4, k4) + r8 * k8);
    }

    return ACTIVE(vec4(sum[0], sum[1], sum[2], sum[3]));
}

//!HOOK LUMA
//!DESC ACNet Layer0 L1
//!WHEN OUTPUT.w LUMA.w / 1.2 > OUTPUT.h LUMA.h / 1.2 > *
//!BIND LUMA
//!SAVE TMP1_L1
//!COMPONENTS 4

#define ACTIVE(v) (max(v, 0.0f))

#define TEX_BIND_L0_TEXOFF LUMA_texOff
#define TEX_BIND_L0_TEX LUMA_tex
#define TEX_BIND_L0_POS LUMA_pos
#define TEX_BIND_L0_SIZE LUMA_size
#define TEX_BIND_L0_PT LUMA_pt

const float kernels[36] = float[36](
  +0.2060540f, -0.0419266f, +0.1501411f, +0.3052118f, +0.5812289f, +0.2615118f, +0.1711326f, -0.1648584f,
  -0.0164623f, +0.0429604f, -0.2951300f, -0.1735653f, +0.3180910f, -0.2997980f, -0.2224078f, +0.2873775f,
  +0.3037313f, +0.0544734f, -0.0254445f, +0.0538169f, -0.0137047f, -0.0208240f, +1.0746503f, -0.1306315f,
  +0.0278336f, -0.3097475f, -0.6277237f, +0.0052848f, -0.9087600f, +0.0219121f, +0.0327079f, +0.8995000f,
  -0.0451350f, -0.0172828f, +0.0130219f, +0.0028771f
);

const float biases[4] = float[4](
  +0.0277400f, +0.0042092f, +0.0101775f, -0.0007636f
);

vec4 hook() {
    const vec4 r0 = vec4(
        TEX_BIND_L0_TEXOFF(vec2(-1.0f,-1.0f)).x,
        TEX_BIND_L0_TEXOFF(vec2( 0.0f,-1.0f)).x,
        TEX_BIND_L0_TEXOFF(vec2( 1.0f,-1.0f)).x,
        TEX_BIND_L0_TEXOFF(vec2(-1.0f, 0.0f)).x
    );
    const vec4 r4 = vec4(
        TEX_BIND_L0_TEXOFF(vec2( 0.0f, 0.0f)).x,
        TEX_BIND_L0_TEXOFF(vec2( 1.0f, 0.0f)).x,
        TEX_BIND_L0_TEXOFF(vec2(-1.0f, 1.0f)).x,
        TEX_BIND_L0_TEXOFF(vec2( 0.0f, 1.0f)).x
    );
    const float r8 = TEX_BIND_L0_TEXOFF(vec2( 1.0f, 1.0f)).x;

    float sum[4] = biases;
    for(int n = 0; n < 4; n++) {
        const vec4 k0 = vec4(kernels[n * 9 + 0], kernels[n * 9 + 1], kernels[n * 9 + 2], kernels[n * 9 + 3]);
        const vec4 k4 = vec4(kernels[n * 9 + 4], kernels[n * 9 + 5], kernels[n * 9 + 6], kernels[n * 9 + 7]);
        const float k8 = kernels[n * 9 + 8];
        sum[n] += (dot(r0, k0) + dot(r4, k4) + r8 * k8);
    }

    return ACTIVE(vec4(sum[0], sum[1], sum[2], sum[3]));
}

//!HOOK LUMA
//!DESC ACNet Layer1 L0
//!WHEN OUTPUT.w LUMA.w / 1.2 > OUTPUT.h LUMA.h / 1.2 > *
//!BIND TMP1_L0
//!BIND TMP1_L1
//!SAVE TMP2_L0
//!COMPONENTS 4

#define ACTIVE(v) (max(v, 0.0f))

#define TEX_BIND_L0_TEXOFF TMP1_L0_texOff
#define TEX_BIND_L0_TEX TMP1_L0_tex
#define TEX_BIND_L0_POS TMP1_L0_pos
#define TEX_BIND_L0_SIZE TMP1_L0_size
#define TEX_BIND_L0_PT TMP1_L0_pt

#define TEX_BIND_L1_TEXOFF TMP1_L1_texOff
#define TEX_BIND_L1_TEX TMP1_L1_tex
#define TEX_BIND_L1_POS TMP1_L1_pos
#define TEX_BIND_L1_SIZE TMP1_L1_size
#define TEX_BIND_L1_PT TMP1_L1_pt

const float kernels[288] = float[288](
  +0.2057865f, -0.0982473f, +0.0231257f, +0.3341902f, +0.0174761f, -0.1103571f, +0.3688482f, +0.0693406f,
  +0.0806008f, -0.0527199f, -0.0749448f, +0.0753748f, +0.2697688f, -0.1595500f, +0.3423192f, -0.0718455f,
  -0.0942439f, -0.1131672f, -0.2584180f, +0.0259255f, -0.1406422f, +0.0139107f, -0.1177369f, +0.0090813f,
  +0.0837277f, +0.0404102f, +0.1118336f, +0.0428148f, +0.0478372f, -0.1436100f, +0.1832579f, +0.1115562f,
  -0.0547147f, -0.1538908f, -0.1629468f, +0.0241945f, -0.0500142f, +0.0584406f, -0.1886797f, +0.0329171f,
  -0.0202807f, -0.1239234f, +0.0200884f, +0.1503590f, -0.1382622f, -0.0727522f, -0.0097393f, +0.1391082f,
  -0.1066897f, -0.2628321f, -0.0746852f, +0.2619149f, +0.0572609f, -0.0653130f, -0.0387233f, -0.3001469f,
  -0.0114656f, -0.0163350f, -0.0923251f, +0.5258449f, +0.1368628f, -0.0160314f, +0.0148315f, +0.0456417f,
  +0.0037661f, +0.1303221f, -0.0226708f, +0.0424723f, -0.2143094f, -0.0664364f, +0.0725130f, -0.2005754f,
  +0.0189251f, -0.0044867f, -0.0030008f, +0.0106985f, +0.0196895f, -0.0269273f, -0.0314194f, -0.0169019f,
  +0.0772025f, -0.0679753f, -0.0600503f, +0.0308199f, -0.0773116f, +0.0678366f, -0.0702129f, -0.0321866f,
  -0.0392670f, -0.0071151f, +0.1940514f, +0.0150975f, -0.0199863f, +0.0927908f, +0.0663578f, +0.0779885f,
  +0.1418120f, +0.0162797f, +0.0930029f, +0.1553688f, +0.0991921f, -0.1452489f, -0.1464783f, +0.0675807f,
  +0.4983377f, +0.1573494f, +0.1742208f, -0.0041175f, +0.1909369f, -0.3268098f, +0.3552601f, +0.0941308f,
  +0.0350156f, -0.0840380f, -0.2120781f, -0.0124255f, +0.0150670f, +0.0220762f, -0.0045562f, +0.0130717f,
  +0.0230137f, -0.0296204f, +0.0592832f, +0.0046028f, +0.0620099f, +0.0242454f, +0.0098037f, +0.1491971f,
  +0.0841505f, +0.0262552f, +0.2547183f, -0.2052528f, -0.0770052f, -0.1739493f, -0.0262875f, -0.1301410f,
  -0.0654081f, +0.0239293f, +0.0859089f, +0.2381417f, +0.0443585f, -0.0517917f, +0.0170558f, +0.2624348f,
  -0.0531245f, +0.0249455f, -0.0268187f, -0.0866644f, -0.0743980f, -0.0046576f, -0.0852174f, -0.0585706f,
  -0.0460628f, -0.0460673f, +0.0386979f, -0.0354828f, -0.1377611f, +0.0002346f, +0.1385249f, +0.0726937f,
  +0.0173024f, +0.0086179f, -0.0618328f, -0.0621138f, -0.0658783f, -0.0114835f, +0.0041312f, +0.0104062f,
  +0.0166510f, -0.1352364f, -0.0766287f, +0.1491868f, -0.0323407f, +0.0906331f, +0.1314983f, -0.1218545f,
  +0.1657387f, -0.0366110f, -0.0487731f, +0.2195991f, +0.0479841f, +0.3013950f, +0.3553065f, -0.1664106f,
  -0.0751375f, -0.0496613f, -0.0883105f, +0.0224621f, +0.1852706f, +0.2415706f, -0.0120662f, -0.1075793f,
  -0.0902453f, -0.1107674f, +0.0887344f, +0.2112067f, +0.1187370f, -0.1318257f, -0.0452914f, -0.0623532f,
  +0.0408359f, -0.1610369f, +0.2609500f, -0.3020764f, +0.0609568f, -0.1112580f, +0.0324564f, -0.3979347f,
  +0.1207103f, +0.0414950f, -0.2573411f, -0.0020300f, +0.0991442f, +0.0043050f, -0.0591121f, -0.1010396f,
  -0.0745718f, -0.0896696f, -0.0061825f, -0.0081922f, -0.0297232f, +0.0158960f, +0.0947133f, -0.0757239f,
  +0.0743901f, -0.2192484f, +0.1061881f, +0.0613589f, -0.1268586f, +0.1221724f, -0.0013121f, -0.1354743f,
  +0.0577846f, -0.0282958f, +0.1613693f, +0.0583433f, -0.0985351f, +0.1645919f, -0.1211177f, +0.1004823f,
  -0.0010620f, -0.0978215f, +0.0308552f, -0.0040218f, +0.0591666f, -0.0071288f, +0.0286359f, -0.0800011f,
  +0.1338393f, +0.2396041f, +0.2636583f, -0.1432800f, +0.2148319f, +0.1401728f, -0.0549628f, -0.2327307f,
  -0.0365614f, -0.1183607f, +0.3884409f, -0.0388397f, +0.0205185f, -0.1155654f, +0.2076043f, -0.0415668f,
  -0.0101920f, -0.0103424f, -0.0012668f, +0.0801221f, +0.0040350f, +0.0277143f, +0.0207382f, +0.0796228f,
  +0.0070779f, -0.0750340f, +0.0667528f, -0.2084899f, -0.0035104f, -0.0162204f, -0.0014325f, +0.1743531f,
  +0.0331935f, +0.1224578f, +0.1776810f, +0.0749934f, +0.1129396f, -0.0328767f, -0.0276568f, -0.1828452f
);

const float biases[4] = float[4](
  +0.0035425f, -0.5762517f, -0.0003968f, -0.0289898f
);

vec4 hook() {
    const vec4 r[9][2] = vec4[9][2](
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 1.0f)))
    );

    float sum[4] = biases;
    for (int n = 0; n < 4; n++) {
        for (int i = 0; i < 9; i++) {
            const vec4 k0 = vec4(kernels[n * 8 * 9 + 8 * i + 0], kernels[n * 8 * 9 + 8 * i + 1], kernels[n * 8 * 9 + 8 * i + 2], kernels[n * 8 * 9 + 8 * i + 3]);
            const vec4 k1 = vec4(kernels[n * 8 * 9 + 8 * i + 4], kernels[n * 8 * 9 + 8 * i + 5], kernels[n * 8 * 9 + 8 * i + 6], kernels[n * 8 * 9 + 8 * i + 7]);
            sum[n] += (dot(k0, r[i][0]) + dot(k1, r[i][1]));
        }
    }

    return ACTIVE(vec4(sum[0], sum[1], sum[2], sum[3]));
}

//!HOOK LUMA
//!DESC ACNet Layer1 L1
//!WHEN OUTPUT.w LUMA.w / 1.2 > OUTPUT.h LUMA.h / 1.2 > *
//!BIND TMP1_L0
//!BIND TMP1_L1
//!SAVE TMP2_L1
//!COMPONENTS 4

#define ACTIVE(v) (max(v, 0.0f))

#define TEX_BIND_L0_TEXOFF TMP1_L0_texOff
#define TEX_BIND_L0_TEX TMP1_L0_tex
#define TEX_BIND_L0_POS TMP1_L0_pos
#define TEX_BIND_L0_SIZE TMP1_L0_size
#define TEX_BIND_L0_PT TMP1_L0_pt

#define TEX_BIND_L1_TEXOFF TMP1_L1_texOff
#define TEX_BIND_L1_TEX TMP1_L1_tex
#define TEX_BIND_L1_POS TMP1_L1_pos
#define TEX_BIND_L1_SIZE TMP1_L1_size
#define TEX_BIND_L1_PT TMP1_L1_pt

const float kernels[288] = float[288](
  +0.0071290f, -0.0255990f, -0.0833238f, +0.0530152f, +0.0172694f, +0.1299402f, -0.1233414f, -0.0406492f,
  +0.0815181f, +0.2482262f, +0.0220506f, +0.0038257f, +0.1922523f, -0.0834951f, +0.1510873f, +0.0035638f,
  +0.0508812f, +0.0949681f, -0.2215708f, -0.1028831f, +0.1180130f, -0.3816733f, +0.0512080f, +0.0991339f,
  -0.0015369f, +0.1240530f, -0.0102873f, +0.0270580f, -0.1453520f, +0.0685919f, -0.0150693f, -0.0213864f,
  -0.0944427f, +0.0463234f, -0.0706708f, +0.0726119f, -0.2305990f, -0.0340790f, -0.2573973f, -0.0537639f,
  +0.1439314f, +0.2230632f, +0.8727840f, -0.1043071f, +0.1757620f, -0.0483118f, -0.0105226f, +0.2430211f,
  -0.0640289f, +0.2860465f, -0.0205668f, -0.0933406f, -0.0742863f, +0.0562509f, +0.0481890f, -0.0991605f,
  -0.0204657f, +0.1242375f, -0.2058642f, +0.1426011f, +0.0527111f, +0.0066908f, +0.0180874f, +0.1012401f,
  -0.0035636f, -0.0098429f, +0.2522103f, -0.1274282f, -0.1044302f, -0.0627048f, -0.0418161f, -0.0341870f,
  +0.1364803f, -0.0378164f, +0.0005727f, +0.0763879f, +0.0728305f, -0.0470105f, -0.3667829f, +0.0013392f,
  +0.1394356f, +0.1484347f, +0.0624197f, +0.0014059f, +0.1780726f, +0.0083702f, -0.2456808f, +0.0203016f,
  +0.0519006f, +0.0248440f, -0.1314971f, -0.0495944f, +0.1696177f, -0.0509620f, +0.0604026f, +0.0441795f,
  +0.2083217f, -0.1495915f, +0.0608000f, +0.1911844f, +0.0627872f, +0.0204174f, +0.0883311f, -0.0589661f,
  +0.2572467f, +0.2908242f, +0.0781407f, +0.1492580f, +0.2413724f, -0.0987884f, +0.3840832f, +0.0654114f,
  +0.0860782f, +0.0998034f, -0.3764845f, -0.0404772f, +0.2863915f, +0.0409785f, +0.0457728f, +0.0643845f,
  +0.0596411f, -0.2235776f, +0.0355771f, +0.0228705f, +0.0345959f, -0.0350268f, -0.0316992f, -0.0882074f,
  +0.0661767f, -0.0169654f, +0.2724476f, -0.3409203f, +0.2829905f, +0.0739881f, +0.0657745f, -0.1873440f,
  +0.0488316f, +0.0555254f, -0.0680796f, -0.0515015f, +0.1586411f, +0.0377644f, -0.0619817f, +0.0308601f,
  +0.0612553f, -0.0527102f, -0.0048411f, -0.0952208f, +0.0199657f, +0.0662846f, +0.2485254f, +0.0527987f,
  -0.1664233f, -0.0772591f, -0.0283082f, -0.1332331f, -0.1461333f, +0.0977859f, -0.0159434f, +0.1633007f,
  -0.0026076f, -0.0002803f, +0.1597414f, -0.0769004f, -0.0193452f, -0.1287973f, +0.0123460f, +0.1249784f,
  +0.0236729f, +0.1343922f, -0.0204290f, -0.0013349f, -0.1626147f, +0.0668984f, -0.1350765f, +0.0559684f,
  +0.2003989f, +0.4414602f, +0.0378895f, +0.3088841f, +0.2628790f, +0.1150264f, +0.0314049f, +0.7130912f,
  +0.1166435f, +0.0905930f, -0.0991477f, -0.0863400f, +0.1090494f, -0.0475450f, +0.0360373f, -0.0344665f,
  +0.0031131f, -0.2256241f, -0.1175027f, -0.0205704f, -0.0910868f, +0.0753308f, +0.0289546f, +0.2426468f,
  -0.0507615f, -0.1642057f, +0.0715823f, -0.2285941f, -0.1347655f, +0.0534257f, +0.0165753f, +0.0249025f,
  +0.0233919f, +0.0435038f, +0.1106040f, -0.0249358f, +0.1598992f, +0.0124965f, -0.0443839f, -0.0534403f,
  -0.0695057f, -0.0322359f, -0.0182468f, -0.0202363f, -0.0369430f, -0.0012318f, +0.0706144f, -0.0167680f,
  +0.0456946f, +0.0069011f, +0.0668258f, +0.1273145f, -0.1444555f, +0.0099728f, -0.0973674f, -0.1145600f,
  -0.0930380f, +0.0212589f, +0.0278219f, -0.0279424f, -0.0503979f, -0.0368207f, -0.0320729f, -0.0220959f,
  +0.0282363f, -0.1331457f, +0.0081847f, +0.0180030f, +0.0305808f, +0.0480966f, -0.0453375f, -0.2134643f,
  +0.1117168f, +0.2331229f, +0.0663714f, +0.2235029f, +0.5096631f, -0.1356280f, +0.7682161f, -0.2150619f,
  -0.0142699f, -0.0274360f, -0.0325323f, +0.0749106f, +0.0109631f, +0.0412560f, -0.0314286f, -0.0562610f,
  -0.0592126f, -0.0386420f, +0.0109857f, +0.0174500f, -0.0122005f, +0.0098051f, -0.0243365f, -0.0412437f,
  +0.0652210f, +0.5692649f, -0.0673264f, -0.1298494f, -0.1770904f, +0.1076027f, +0.0758563f, -0.1534653f,
  -0.0190135f, +0.0299949f, -0.1328779f, +0.2070374f, -0.1435250f, -0.0084077f, -0.0131830f, +0.0586145f
);

const float biases[4] = float[4](
  +0.0036620f, -0.0217202f, +0.0054525f, +0.0009976f
);

vec4 hook() {
    const vec4 r[9][2] = vec4[9][2](
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 1.0f)))
    );

    float sum[4] = biases;
    for (int n = 0; n < 4; n++) {
        for (int i = 0; i < 9; i++) {
            const vec4 k0 = vec4(kernels[n * 8 * 9 + 8 * i + 0], kernels[n * 8 * 9 + 8 * i + 1], kernels[n * 8 * 9 + 8 * i + 2], kernels[n * 8 * 9 + 8 * i + 3]);
            const vec4 k1 = vec4(kernels[n * 8 * 9 + 8 * i + 4], kernels[n * 8 * 9 + 8 * i + 5], kernels[n * 8 * 9 + 8 * i + 6], kernels[n * 8 * 9 + 8 * i + 7]);
            sum[n] += (dot(k0, r[i][0]) + dot(k1, r[i][1]));
        }
    }

    return ACTIVE(vec4(sum[0], sum[1], sum[2], sum[3]));
}

//!HOOK LUMA
//!DESC ACNet Layer2 L0
//!WHEN OUTPUT.w LUMA.w / 1.2 > OUTPUT.h LUMA.h / 1.2 > *
//!BIND TMP2_L0
//!BIND TMP2_L1
//!SAVE TMP1_L0
//!COMPONENTS 4

#define ACTIVE(v) (max(v, 0.0f))

#define TEX_BIND_L0_TEXOFF TMP2_L0_texOff
#define TEX_BIND_L0_TEX TMP2_L0_tex
#define TEX_BIND_L0_POS TMP2_L0_pos
#define TEX_BIND_L0_SIZE TMP2_L0_size
#define TEX_BIND_L0_PT TMP2_L0_pt

#define TEX_BIND_L1_TEXOFF TMP2_L1_texOff
#define TEX_BIND_L1_TEX TMP2_L1_tex
#define TEX_BIND_L1_POS TMP2_L1_pos
#define TEX_BIND_L1_SIZE TMP2_L1_size
#define TEX_BIND_L1_PT TMP2_L1_pt

const float kernels[288] = float[288](
  -0.0149349f, +0.1676716f, +0.0375339f, +0.0005620f, +0.0458070f, -0.0330278f, -0.0852744f, +0.0431904f,
  -0.0764852f, +0.3000498f, +0.0437527f, +0.0379900f, +0.1001000f, -0.1339322f, -0.0385309f, +0.3293461f,
  -0.0836633f, +0.2529495f, +0.1298189f, +0.0929648f, -0.0343068f, -0.1120838f, +0.0249017f, -0.0223766f,
  +0.1219832f, +0.0272792f, +0.2137083f, -0.1790621f, +0.1547572f, +0.0289312f, -0.0301798f, +0.0029013f,
  +0.0086903f, -0.0841966f, +0.2155827f, -0.0796163f, +0.2825535f, +0.1366508f, +0.3228782f, +0.4412657f,
  +0.0852552f, +0.0760482f, +0.0150222f, +0.0213199f, +0.0211264f, -0.1500644f, +0.1651317f, -0.0762921f,
  +0.0102658f, +0.1061407f, +0.0464478f, +0.0339919f, +0.1486685f, +0.0160612f, +0.0022305f, +0.0291096f,
  +0.0292522f, +0.0353276f, -0.0552938f, -0.0354078f, +0.0746803f, +0.0979702f, -0.0864399f, -0.0348711f,
  -0.1034961f, +0.0541666f, +0.0859326f, -0.0711673f, +0.0587800f, +0.0589850f, +0.0123649f, +0.0548906f,
  -0.1199773f, -0.1672451f, -0.1479904f, +0.0506194f, -0.0925111f, -0.1065418f, -0.1968782f, +0.1749596f,
  +0.2040421f, -0.3855937f, -0.5821720f, +0.0477948f, -0.1695167f, -0.2503582f, +0.1996547f, +0.1770485f,
  +0.1479707f, -0.0427919f, -0.0489866f, +0.0889840f, -0.1861302f, +0.1267231f, +0.1769338f, +0.1507142f,
  +0.1244624f, -0.1222582f, -0.1239847f, +0.0309868f, +0.2480463f, +0.0667773f, +0.1953145f, -0.0621423f,
  -0.0945934f, +0.0290437f, -0.0081320f, +0.1351965f, -0.1767588f, +0.2606686f, -0.1247520f, +0.1413743f,
  +0.1576155f, -0.1638957f, +0.0700295f, +0.1121159f, +0.0815534f, +0.0007146f, -0.3495372f, -0.1428996f,
  +0.1741067f, +0.0256781f, +0.0018056f, -0.0049381f, +0.0034855f, -0.0360152f, +0.0030606f, -0.0060783f,
  +0.1096346f, -0.1153023f, +0.0986561f, -0.0479541f, -0.0844918f, -0.0062610f, -0.2176688f, -0.0279285f,
  -0.1315401f, -0.2416221f, +0.0206312f, +0.0106914f, -0.0956417f, +0.0027376f, +0.0330259f, +0.0210904f,
  -0.0178435f, +0.0252578f, -0.0267024f, -0.0267807f, +0.0080884f, -0.0499641f, -0.0167786f, +0.0689407f,
  -0.0112957f, -0.0231177f, -0.0121713f, +0.0042826f, -0.0893632f, +0.1387596f, +0.0990820f, -0.0555929f,
  -0.0433937f, +0.0409414f, -0.1102658f, -0.0762261f, +0.0297109f, +0.1143698f, -0.0073239f, +0.0774441f,
  +0.0770115f, -0.0174484f, +0.0727201f, -0.0311116f, +0.0733186f, +0.0944318f, +0.1369976f, -0.1895033f,
  -0.0887025f, +0.0885396f, +0.0934391f, +0.1722978f, -0.2178266f, +0.4032789f, +0.1484801f, +0.3221850f,
  +0.0205563f, -0.0695021f, -0.1164182f, +0.0121570f, -0.0885830f, +0.1555843f, +0.0800382f, +0.0211465f,
  -0.0084745f, +0.0850599f, -0.0519113f, -0.0333716f, +0.1065896f, +0.0273782f, -0.0379104f, -0.0656790f,
  +0.1020884f, +0.0533405f, +0.0275373f, +0.0522459f, +0.0815816f, +0.2459248f, -0.3684516f, -0.0440104f,
  +0.0361488f, -0.1299939f, +0.0209321f, -0.0480219f, +0.0253859f, +0.0668047f, -0.1232652f, +0.0127617f,
  -0.0066573f, -0.0231898f, -0.1033536f, +0.0063645f, +0.0837568f, -0.0650653f, +0.0842427f, -0.2911503f,
  -0.0748132f, +0.0051936f, -0.1301441f, -0.1534254f, +0.1473060f, -0.0856804f, -0.0443032f, -0.0505023f,
  -0.0814322f, -0.1682605f, -0.0423678f, -0.0641694f, +0.0593167f, -0.0566666f, +0.0107157f, +0.0636192f,
  -0.0478843f, +0.2624933f, +0.0357480f, +0.1985213f, -0.2588393f, +0.2527710f, -0.0236047f, -0.4480257f,
  -0.0925955f, +0.4312980f, +0.3387700f, -0.0023521f, -0.0879539f, +0.1564768f, -0.2213604f, +0.0908446f,
  -0.0959230f, -0.0586526f, -0.0043893f, +0.0899974f, +0.0597243f, +0.0697602f, -0.0952809f, -0.0678166f,
  -0.2610252f, -0.0220547f, -0.1399013f, +0.0418390f, -0.1813704f, -0.2107940f, -0.1560692f, -0.0592236f,
  +0.0701726f, +0.1062664f, -0.0401377f, +0.3217157f, -0.0636796f, -0.0788960f, -0.2716180f, -0.0058166f,
  +0.0247929f, -0.1233131f, -0.0272658f, -0.0121045f, +0.0203670f, +0.0120767f, +0.0391610f, +0.0181030f
);

const float biases[4] = float[4](
  -0.0179002f, +0.0025148f, -0.0016707f, +0.0213202f
);

vec4 hook() {
    const vec4 r[9][2] = vec4[9][2](
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 1.0f)))
    );

    float sum[4] = biases;
    for (int n = 0; n < 4; n++) {
        for (int i = 0; i < 9; i++) {
            const vec4 k0 = vec4(kernels[n * 8 * 9 + 8 * i + 0], kernels[n * 8 * 9 + 8 * i + 1], kernels[n * 8 * 9 + 8 * i + 2], kernels[n * 8 * 9 + 8 * i + 3]);
            const vec4 k1 = vec4(kernels[n * 8 * 9 + 8 * i + 4], kernels[n * 8 * 9 + 8 * i + 5], kernels[n * 8 * 9 + 8 * i + 6], kernels[n * 8 * 9 + 8 * i + 7]);
            sum[n] += (dot(k0, r[i][0]) + dot(k1, r[i][1]));
        }
    }

    return ACTIVE(vec4(sum[0], sum[1], sum[2], sum[3]));
}

//!HOOK LUMA
//!DESC ACNet Layer2 L1
//!WHEN OUTPUT.w LUMA.w / 1.2 > OUTPUT.h LUMA.h / 1.2 > *
//!BIND TMP2_L0
//!BIND TMP2_L1
//!SAVE TMP1_L1
//!COMPONENTS 4

#define ACTIVE(v) (max(v, 0.0f))

#define TEX_BIND_L0_TEXOFF TMP2_L0_texOff
#define TEX_BIND_L0_TEX TMP2_L0_tex
#define TEX_BIND_L0_POS TMP2_L0_pos
#define TEX_BIND_L0_SIZE TMP2_L0_size
#define TEX_BIND_L0_PT TMP2_L0_pt

#define TEX_BIND_L1_TEXOFF TMP2_L1_texOff
#define TEX_BIND_L1_TEX TMP2_L1_tex
#define TEX_BIND_L1_POS TMP2_L1_pos
#define TEX_BIND_L1_SIZE TMP2_L1_size
#define TEX_BIND_L1_PT TMP2_L1_pt

const float kernels[288] = float[288](
  +0.0116845f, +0.0979083f, +0.0139623f, +0.0202234f, +0.0576652f, -0.0267280f, -0.0107659f, -0.0591572f,
  -0.0944607f, -0.0391845f, +0.0284608f, +0.0862518f, +0.0158742f, +0.1015988f, +0.0683859f, -0.1107151f,
  -0.0201167f, +0.0139372f, -0.0881006f, -0.1313863f, +0.0442885f, -0.0630328f, -0.0084038f, -0.0388143f,
  +0.1314877f, +0.0407930f, -0.1341567f, -0.1744420f, -0.0341499f, -0.0735716f, -0.0850575f, +0.1459384f,
  +0.0841294f, -0.0779165f, +0.1355667f, +0.1108901f, -0.1959558f, +0.3104014f, +0.3013837f, +0.4454704f,
  +0.0034107f, +0.0450480f, -0.0749710f, -0.0793242f, +0.1314945f, +0.0555220f, -0.1126821f, +0.0094743f,
  -0.1294057f, -0.0001297f, -0.0200382f, -0.2092315f, -0.5190830f, -0.3399531f, -0.2104113f, -0.0972012f,
  -0.3282751f, -0.0561643f, -0.0970560f, +0.0797509f, -0.2305796f, -0.1950299f, +0.0100597f, -0.0599425f,
  -0.1787349f, -0.0389510f, +0.0317809f, +0.0456823f, -0.0752384f, +0.0923651f, -0.0329788f, +0.0198625f,
  -0.0062539f, -0.0074675f, +0.1052675f, -0.0935917f, +0.0143579f, -0.0279916f, -0.0183543f, +0.0217033f,
  +0.0199254f, +0.0459407f, -0.1765302f, +0.0644004f, -0.0405789f, +0.2771992f, +0.1064728f, -0.1139160f,
  -0.0303884f, +0.0641854f, +0.0242782f, +0.0418102f, -0.1050853f, +0.0535863f, -0.0155611f, +0.1412286f,
  -0.0256738f, +0.1352833f, +0.1597687f, -0.3298196f, +0.0745679f, -0.0057218f, -0.0234873f, +0.1795674f,
  -0.3225856f, -0.1396073f, -0.3321771f, +0.1001822f, -0.1698619f, +0.0906378f, +0.4939286f, +0.2922894f,
  +0.0214223f, +0.3072779f, -0.0730132f, -0.0237822f, +0.0496177f, +0.0093377f, +0.0199475f, -0.1718060f,
  +0.0704406f, +0.0128364f, +0.0905911f, +0.0872060f, +0.0283785f, -0.0744582f, +0.0620292f, +0.1222538f,
  +0.0182377f, -0.0038355f, -0.0084158f, -0.1014767f, +0.1228088f, -0.1913148f, +0.2763355f, -0.0580503f,
  -0.0054713f, +0.0904802f, +0.0131959f, -0.0423247f, -0.0095731f, -0.0460847f, +0.1259882f, +0.0449609f,
  -0.1258099f, +0.0019685f, +0.1067281f, -0.1792375f, +0.1712595f, -0.1302057f, -0.0172186f, +0.3250352f,
  -0.1261846f, -0.0510357f, -0.3247841f, -0.0502016f, +0.1636878f, +0.1594454f, +0.0619511f, +0.3202459f,
  -0.1498631f, +0.1141910f, +0.1258768f, +0.2339451f, -0.2356517f, +0.1292564f, -0.0181920f, -0.0165348f,
  +0.1268326f, -0.0699019f, +0.1092836f, -0.1452550f, +0.2236423f, -0.0607769f, +0.0214253f, +0.1653375f,
  -0.3600821f, -0.4615551f, -0.3286337f, -0.5010080f, +0.5068111f, +0.0805608f, +0.0985843f, -0.0725899f,
  -0.0505608f, +0.0282576f, -0.0804081f, -0.0402170f, -0.0330422f, -0.0910674f, +0.1100449f, +0.0342928f,
  -0.0100613f, -0.0493427f, +0.0816359f, -0.1559035f, +0.2301782f, +0.0082961f, +0.0268073f, +0.0130364f,
  -0.2259694f, -0.0767825f, -0.0279911f, -0.3874233f, +0.2190129f, +0.0105604f, +0.0975800f, +0.0273938f,
  -0.0599594f, +0.0746523f, +0.1063799f, -0.1757430f, +0.2312052f, +0.0905527f, -0.0813020f, +0.0260259f,
  -0.5464609f, +0.1045220f, -0.0694357f, -0.1337315f, +0.1646264f, +0.1481213f, -0.0259851f, +0.0572280f,
  -0.1519243f, -0.0935571f, -0.3095776f, -0.1441545f, +0.2138587f, -0.0915364f, +0.0099285f, -0.1683149f,
  -0.0389831f, +0.1175542f, +0.0492659f, -0.0948048f, -0.0530975f, -0.0242656f, +0.0500224f, +0.0131467f,
  -0.2939078f, +0.2752356f, +0.0119034f, +0.1529088f, +0.2742854f, +0.1264749f, -0.0522462f, -0.1853929f,
  -0.1504148f, +0.1947101f, -0.0559602f, -0.1259365f, +0.0396296f, +0.2283924f, +0.2426977f, +0.0075301f,
  -0.1029371f, +0.0585156f, -0.1475920f, +0.0008451f, +0.1403868f, -0.1195859f, -0.0555768f, -0.1051062f,
  -0.2692854f, -0.0319105f, +0.0273007f, +0.0207239f, +0.2292438f, -0.0297183f, +0.0568050f, -0.0141176f,
  -0.2451778f, +0.0648109f, -0.0301410f, -0.1214295f, +0.2203782f, -0.0171014f, +0.0058455f, -0.1039183f,
  -0.3437241f, +0.0015251f, -0.0490162f, -0.0561450f, -0.0463468f, -0.0816276f, +0.0694950f, +0.0670282f
);

const float biases[4] = float[4](
  -0.0223115f, +0.0155711f, -0.0090493f, +0.0087855f
);

vec4 hook() {
    const vec4 r[9][2] = vec4[9][2](
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 1.0f)))
    );

    float sum[4] = biases;
    for (int n = 0; n < 4; n++) {
        for (int i = 0; i < 9; i++) {
            const vec4 k0 = vec4(kernels[n * 8 * 9 + 8 * i + 0], kernels[n * 8 * 9 + 8 * i + 1], kernels[n * 8 * 9 + 8 * i + 2], kernels[n * 8 * 9 + 8 * i + 3]);
            const vec4 k1 = vec4(kernels[n * 8 * 9 + 8 * i + 4], kernels[n * 8 * 9 + 8 * i + 5], kernels[n * 8 * 9 + 8 * i + 6], kernels[n * 8 * 9 + 8 * i + 7]);
            sum[n] += (dot(k0, r[i][0]) + dot(k1, r[i][1]));
        }
    }

    return ACTIVE(vec4(sum[0], sum[1], sum[2], sum[3]));
}

//!HOOK LUMA
//!DESC ACNet Layer3 L0
//!WHEN OUTPUT.w LUMA.w / 1.2 > OUTPUT.h LUMA.h / 1.2 > *
//!BIND TMP1_L0
//!BIND TMP1_L1
//!SAVE TMP2_L0
//!COMPONENTS 4

#define ACTIVE(v) (max(v, 0.0f))

#define TEX_BIND_L0_TEXOFF TMP1_L0_texOff
#define TEX_BIND_L0_TEX TMP1_L0_tex
#define TEX_BIND_L0_POS TMP1_L0_pos
#define TEX_BIND_L0_SIZE TMP1_L0_size
#define TEX_BIND_L0_PT TMP1_L0_pt

#define TEX_BIND_L1_TEXOFF TMP1_L1_texOff
#define TEX_BIND_L1_TEX TMP1_L1_tex
#define TEX_BIND_L1_POS TMP1_L1_pos
#define TEX_BIND_L1_SIZE TMP1_L1_size
#define TEX_BIND_L1_PT TMP1_L1_pt

const float kernels[288] = float[288](
  +0.0256664f, -0.0881124f, -0.0703027f, +0.1442098f, +0.1366647f, -0.1397697f, +0.0212154f, +0.0350028f,
  -0.0012800f, +0.0507664f, +0.1342351f, +0.0545001f, +0.1216248f, -0.1045131f, +0.0179236f, +0.0335327f,
  -0.0674912f, +0.0016826f, -0.1420766f, +0.0375368f, -0.0029363f, +0.1290471f, +0.0288084f, -0.0212054f,
  -0.2433629f, +0.0085081f, +0.2259125f, +0.2775948f, -0.0002622f, -0.0475186f, +0.1193654f, -0.0757585f,
  +0.3191784f, +0.1578863f, +0.1590089f, -0.4012007f, +0.3059044f, +0.3308421f, +0.2662854f, -0.1221902f,
  -0.1845826f, +0.1948186f, -0.2322811f, -0.4355907f, -0.3806939f, -0.2541112f, +0.2211963f, -0.3891747f,
  -0.0429920f, +0.1087691f, +0.0052931f, +0.0788045f, +0.0276790f, -0.0515738f, +0.1717123f, -0.0753328f,
  +0.0733548f, +0.2290138f, -0.1529594f, -0.1923236f, -0.0187147f, +0.0184110f, -0.0652574f, +0.1208534f,
  -0.0514473f, +0.2731852f, +0.0718825f, -0.2345429f, -0.0331840f, +0.0187427f, -0.0849466f, -0.1946460f,
  -0.0191594f, -0.0446496f, -0.0796736f, +0.1403639f, +0.1064715f, +0.0116068f, -0.0050008f, -0.0127113f,
  -0.0286454f, -0.1771398f, -0.0170804f, +0.3103533f, -0.1938681f, +0.0970855f, -0.0905257f, -0.0036453f,
  +0.0626582f, -0.0956573f, -0.0121630f, +0.1749871f, +0.0681940f, +0.0329866f, -0.1583784f, -0.1734162f,
  -0.1939422f, -0.1111804f, -0.0058633f, +0.0435936f, -0.1528590f, +0.0450303f, +0.1179364f, -0.0540121f,
  +0.1059956f, +0.1616881f, +0.1241543f, -0.1514102f, -0.0814357f, +0.3717953f, +0.3235162f, -0.1449340f,
  +0.0176199f, +0.0077774f, -0.0303549f, -0.1899882f, -0.1903476f, +0.1606765f, +0.0397026f, +0.1515513f,
  +0.0070587f, +0.0014531f, +0.0259328f, +0.0038330f, -0.0450175f, +0.0898863f, -0.0177862f, +0.0671112f,
  +0.0576041f, +0.3134303f, -0.0462620f, -0.0637925f, -0.0019788f, -0.0645182f, +0.0811381f, -0.1245812f,
  -0.0705758f, -0.1253338f, +0.0201808f, +0.1121410f, -0.0635757f, +0.0230295f, +0.0703930f, -0.0258732f,
  +0.0098077f, +0.1592670f, +0.0989945f, -0.1044424f, -0.0637353f, +0.0541285f, +0.0485807f, -0.1034051f,
  +0.0220574f, +0.1386260f, +0.0572437f, +0.2059104f, -0.0240077f, -0.0196935f, +0.0812399f, +0.1103489f,
  -0.0097088f, +0.1398186f, +0.0127981f, -0.0110218f, -0.0112434f, +0.0140610f, -0.0092503f, +0.0746766f,
  +0.1679366f, +0.0801238f, -0.2149564f, -0.2285047f, -0.0432500f, -0.0063018f, -0.2567197f, +0.0974919f,
  +0.0638857f, +0.0275107f, -0.1869780f, +0.1225999f, -0.1098281f, -0.2760018f, +0.0609599f, -0.1771781f,
  +0.1335208f, +0.0396641f, +0.2572490f, +0.0676066f, +0.1628804f, -0.0596471f, -0.0195295f, +0.0517340f,
  +0.1441963f, -0.0139381f, -0.0072688f, -0.0262783f, +0.0269479f, +0.0282218f, -0.0328921f, +0.0899004f,
  +0.0738756f, -0.0811357f, -0.1245087f, -0.0517519f, +0.0302354f, -0.2440657f, -0.4872310f, +0.1130879f,
  +0.1246999f, -0.1749926f, +0.1240315f, -0.0996833f, +0.1108063f, +0.0905545f, -0.0866086f, -0.0370497f,
  -0.0423205f, +0.0824908f, -0.1724960f, -0.1619674f, -0.0677835f, +0.0966198f, +0.0413008f, -0.1342084f,
  +0.0318268f, +0.1260781f, -0.2074216f, -0.3026075f, -0.1330224f, +0.2248534f, -0.0511100f, -0.2687844f,
  +0.0142249f, +0.0486522f, -0.1699104f, -0.0452892f, -0.0830140f, +0.1692560f, +0.0056711f, +0.1163848f,
  -0.0493192f, -0.0751879f, +0.1347505f, +0.0554488f, +0.0034526f, -0.0532312f, +0.1814059f, +0.0936533f,
  -0.2415127f, +0.2098479f, +0.2131200f, -0.1366000f, +0.2557298f, +0.3731698f, +0.1607406f, -0.2871026f,
  -0.1737875f, +0.1612748f, -0.1347461f, +0.0135653f, +0.1341781f, +0.0894747f, +0.0896031f, -0.3576025f,
  -0.2517601f, +0.3842540f, +0.1370321f, +0.1758503f, -0.0687218f, +0.0420546f, +0.1932367f, -0.3114524f,
  -0.2938555f, +0.4571673f, +0.1233275f, +0.3206167f, +0.0653615f, +0.0086348f, +0.0710006f, +0.0183877f,
  -0.0193937f, +0.0422609f, +0.0175044f, +0.3065669f, +0.0256492f, -0.0263008f, +0.0885439f, +0.2027589f
);

const float biases[4] = float[4](
  -0.0014860f, -0.0557952f, +0.0138786f, -0.0395589f
);

vec4 hook() {
    const vec4 r[9][2] = vec4[9][2](
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 1.0f)))
    );

    float sum[4] = biases;
    for (int n = 0; n < 4; n++) {
        for (int i = 0; i < 9; i++) {
            const vec4 k0 = vec4(kernels[n * 8 * 9 + 8 * i + 0], kernels[n * 8 * 9 + 8 * i + 1], kernels[n * 8 * 9 + 8 * i + 2], kernels[n * 8 * 9 + 8 * i + 3]);
            const vec4 k1 = vec4(kernels[n * 8 * 9 + 8 * i + 4], kernels[n * 8 * 9 + 8 * i + 5], kernels[n * 8 * 9 + 8 * i + 6], kernels[n * 8 * 9 + 8 * i + 7]);
            sum[n] += (dot(k0, r[i][0]) + dot(k1, r[i][1]));
        }
    }

    return ACTIVE(vec4(sum[0], sum[1], sum[2], sum[3]));
}

//!HOOK LUMA
//!DESC ACNet Layer3 L1
//!WHEN OUTPUT.w LUMA.w / 1.2 > OUTPUT.h LUMA.h / 1.2 > *
//!BIND TMP1_L0
//!BIND TMP1_L1
//!SAVE TMP2_L1
//!COMPONENTS 4

#define ACTIVE(v) (max(v, 0.0f))

#define TEX_BIND_L0_TEXOFF TMP1_L0_texOff
#define TEX_BIND_L0_TEX TMP1_L0_tex
#define TEX_BIND_L0_POS TMP1_L0_pos
#define TEX_BIND_L0_SIZE TMP1_L0_size
#define TEX_BIND_L0_PT TMP1_L0_pt

#define TEX_BIND_L1_TEXOFF TMP1_L1_texOff
#define TEX_BIND_L1_TEX TMP1_L1_tex
#define TEX_BIND_L1_POS TMP1_L1_pos
#define TEX_BIND_L1_SIZE TMP1_L1_size
#define TEX_BIND_L1_PT TMP1_L1_pt

const float kernels[288] = float[288](
  -0.0274437f, +0.1519680f, -0.0456666f, -0.2307405f, +0.0414728f, +0.0279139f, +0.2106022f, -0.0730705f,
  +0.0922237f, +0.0270293f, -0.1939052f, -0.1897499f, +0.0435543f, +0.1099345f, +0.0794386f, -0.2117044f,
  -0.0579948f, +0.0197053f, -0.0892788f, +0.1859876f, -0.0097847f, -0.1504283f, +0.0498541f, -0.2588972f,
  -0.0288338f, +0.0058430f, +0.0918592f, -0.2303830f, -0.0428310f, -0.0761610f, +0.0874723f, -0.0653730f,
  +0.1648636f, +0.1647899f, +0.2661079f, -0.0380091f, -0.1004681f, +0.2999545f, +0.1837466f, -0.1001895f,
  -0.0228077f, +0.1678834f, +0.1831310f, -0.0042291f, +0.0231817f, -0.3364536f, -0.3185804f, +0.1715005f,
  -0.0681107f, +0.0762467f, -0.0218874f, -0.0940012f, +0.1126394f, -0.1230172f, -0.1053228f, +0.1265248f,
  -0.1059204f, +0.3312438f, -0.1124496f, -0.0552046f, +0.0603155f, -0.0560367f, +0.1535620f, +0.0031245f,
  -0.0191718f, -0.0267306f, -0.0754836f, +0.1706220f, +0.0875088f, -0.1581710f, -0.2401763f, +0.3331529f,
  -0.0142981f, -0.0298170f, -0.0511063f, -0.0525069f, +0.0180327f, -0.0697247f, +0.0166078f, +0.0153156f,
  +0.0115198f, -0.0026977f, +0.1669969f, -0.0182834f, -0.0232303f, -0.1953953f, +0.0996518f, -0.0613280f,
  -0.0289240f, +0.0360056f, -0.0788704f, +0.0398688f, -0.0185387f, -0.0417639f, +0.0282682f, +0.0449708f,
  -0.1205379f, -0.0924401f, +0.1729955f, -0.0987397f, +0.0289081f, -0.0510455f, -0.0023892f, -0.0444044f,
  +0.3616571f, +0.1991612f, +0.4139307f, -0.0291164f, +0.7776137f, +0.3732844f, -0.3379933f, +0.1352136f,
  -0.0530616f, -0.0019999f, +0.0910894f, -0.0501196f, +0.0038863f, -0.1881379f, +0.0585608f, -0.0184540f,
  -0.1450291f, +0.0200983f, +0.1103049f, -0.0102128f, +0.0696415f, +0.0884980f, +0.2527019f, +0.0109374f,
  -0.1414557f, -0.2247937f, +0.1272555f, -0.0633303f, +0.0505406f, +0.0674793f, -0.0837636f, -0.0215318f,
  +0.0394402f, -0.0225501f, -0.0735699f, +0.0720308f, +0.0050510f, -0.0377445f, +0.0224438f, -0.0249302f,
  +0.0090051f, -0.0091877f, -0.0085441f, +0.0621592f, -0.0368090f, +0.0874643f, -0.0611055f, +0.0295314f,
  +0.0722633f, +0.0345637f, -0.0630594f, +0.0408072f, +0.1236761f, -0.1376124f, +0.2236590f, -0.0493425f,
  -0.0891970f, -0.0810362f, -0.2597125f, -0.0034877f, -0.0093527f, -0.1299863f, +0.2020785f, -0.0893066f,
  -0.1999993f, -0.0345230f, +0.1007706f, -0.0915698f, +0.0176559f, -0.0192022f, +0.2079819f, +0.0286629f,
  -0.0910388f, +0.1266199f, +0.5112106f, +0.2576128f, +0.1027797f, -0.0258361f, +0.3339386f, -0.0754588f,
  -0.1221353f, -0.0891918f, -0.1902972f, -0.1145361f, +0.0822966f, -0.1017001f, +0.1511361f, -0.0521996f,
  +0.1544801f, -0.0067179f, -0.1184856f, +0.0495724f, +0.0020811f, -0.0181348f, -0.1146252f, +0.1367012f,
  -0.1061168f, +0.1691813f, +0.0705698f, +0.0617401f, -0.0173379f, -0.0017126f, +0.4898157f, -0.3428532f,
  -0.0051183f, -0.0377160f, -0.0247133f, -0.0931223f, +0.1157246f, -0.0335839f, +0.0772518f, +0.1953485f,
  +0.0000000f, -0.0000000f, -0.0000000f, -0.0000000f, +0.0000000f, -0.0000000f, +0.0000000f, +0.0000000f,
  -0.0000000f, -0.0000000f, -0.0000000f, +0.0000000f, -0.0000000f, -0.0000000f, +0.0000000f, -0.0000000f,
  -0.0000000f, +0.0000000f, -0.0000000f, +0.0000000f, +0.0000000f, -0.0000000f, -0.0000000f, +0.0000000f,
  -0.0000000f, +0.0000000f, -0.0000000f, -0.0000000f, -0.0000000f, +0.0000000f, +0.0000000f, +0.0000000f,
  +0.0000000f, -0.0000000f, -0.0000000f, +0.0000000f, +0.0000000f, -0.0000000f, -0.0000000f, -0.0000000f,
  -0.0000000f, -0.0000000f, -0.0000000f, -0.0000000f, +0.0000000f, +0.0000000f, -0.0000000f, -0.0000000f,
  -0.0000000f, +0.0000000f, +0.0000000f, +0.0000000f, +0.0000000f, +0.0000000f, +0.0000000f, +0.0000000f,
  -0.0000000f, +0.0000000f, -0.0000000f, +0.0000000f, +0.0000000f, -0.0000000f, +0.0000000f, +0.0000000f,
  +0.0000000f, -0.0000000f, -0.0000000f, +0.0000000f, +0.0000000f, -0.0000000f, +0.0000000f, -0.0000000f
);

const float biases[4] = float[4](
  -0.0122291f, +0.0015718f, -0.0024131f, -0.0000000f
);

vec4 hook() {
    const vec4 r[9][2] = vec4[9][2](
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 1.0f)))
    );

    float sum[4] = biases;
    for (int n = 0; n < 4; n++) {
        for (int i = 0; i < 9; i++) {
            const vec4 k0 = vec4(kernels[n * 8 * 9 + 8 * i + 0], kernels[n * 8 * 9 + 8 * i + 1], kernels[n * 8 * 9 + 8 * i + 2], kernels[n * 8 * 9 + 8 * i + 3]);
            const vec4 k1 = vec4(kernels[n * 8 * 9 + 8 * i + 4], kernels[n * 8 * 9 + 8 * i + 5], kernels[n * 8 * 9 + 8 * i + 6], kernels[n * 8 * 9 + 8 * i + 7]);
            sum[n] += (dot(k0, r[i][0]) + dot(k1, r[i][1]));
        }
    }

    return ACTIVE(vec4(sum[0], sum[1], sum[2], sum[3]));
}

//!HOOK LUMA
//!DESC ACNet Layer4 L0
//!WHEN OUTPUT.w LUMA.w / 1.2 > OUTPUT.h LUMA.h / 1.2 > *
//!BIND TMP2_L0
//!BIND TMP2_L1
//!SAVE TMP1_L0
//!COMPONENTS 4

#define ACTIVE(v) (max(v, 0.0f))

#define TEX_BIND_L0_TEXOFF TMP2_L0_texOff
#define TEX_BIND_L0_TEX TMP2_L0_tex
#define TEX_BIND_L0_POS TMP2_L0_pos
#define TEX_BIND_L0_SIZE TMP2_L0_size
#define TEX_BIND_L0_PT TMP2_L0_pt

#define TEX_BIND_L1_TEXOFF TMP2_L1_texOff
#define TEX_BIND_L1_TEX TMP2_L1_tex
#define TEX_BIND_L1_POS TMP2_L1_pos
#define TEX_BIND_L1_SIZE TMP2_L1_size
#define TEX_BIND_L1_PT TMP2_L1_pt

const float kernels[288] = float[288](
  -0.0277448f, +0.0029218f, -0.0205976f, +0.0294295f, -0.0486405f, -0.0644672f, +0.1816590f, -0.0000000f,
  -0.0390364f, +0.0665061f, -0.0906471f, +0.0346942f, +0.0995673f, +0.0143547f, +0.1437167f, +0.0000000f,
  -0.2033001f, -0.1192133f, -0.0936091f, -0.2391805f, -0.0378212f, +0.1860166f, -0.2060968f, -0.0000000f,
  -0.0300768f, +0.0865978f, -0.1565001f, -0.0273184f, -0.0650580f, +0.0200105f, +0.0270782f, +0.0000000f,
  +0.0508768f, +0.1733557f, -0.2245297f, +0.1831594f, -0.1986579f, -0.2992184f, +0.0003858f, -0.0000000f,
  +0.0143985f, -0.0881482f, -0.1172697f, -0.0963944f, +0.4245236f, +0.0972541f, +0.3707103f, +0.0000000f,
  -0.0388241f, +0.0553250f, -0.1299807f, -0.0240271f, -0.1050702f, +0.0174589f, -0.0240414f, +0.0000000f,
  -0.2251432f, -0.0850993f, -0.0223929f, -0.1765586f, -0.0060956f, +0.2342586f, +0.3703445f, +0.0000000f,
  -0.0357983f, -0.1275247f, -0.1152343f, +0.2330609f, +0.2039586f, -0.2360782f, -0.0185158f, -0.0000000f,
  +0.2459755f, -0.0620251f, -0.2319368f, -0.1009903f, +0.1599562f, -0.1377161f, -0.0429323f, -0.0000000f,
  -0.0450808f, +0.0799870f, -0.0194027f, -0.0964581f, -0.0159413f, -0.0661052f, -0.0545447f, +0.0000000f,
  +0.0010181f, -0.0385583f, -0.0501315f, -0.0635772f, +0.0343368f, +0.0381181f, -0.0181367f, +0.0000000f,
  +0.6263692f, -0.1401972f, -0.1445408f, +0.0903966f, +0.0360247f, -0.3663094f, +0.0163252f, -0.0000000f,
  +0.2335057f, -0.1921849f, +0.1246563f, +0.1876244f, -0.1444969f, +0.4981124f, +0.1361948f, -0.0000000f,
  -0.0130436f, +0.1266595f, +0.0294291f, +0.0280447f, +0.0621576f, +0.0628185f, -0.0504979f, -0.0000000f,
  +0.1962006f, -0.1774300f, -0.0348116f, +0.0179049f, -0.0361900f, -0.0288974f, +0.0634884f, -0.0000000f,
  +0.1239432f, -0.0088826f, +0.0056905f, -0.0262711f, +0.0659803f, -0.0044608f, -0.0083952f, -0.0000000f,
  -0.0106882f, +0.0005326f, -0.0129729f, -0.0657526f, +0.0194493f, +0.0490093f, +0.0258021f, +0.0000000f,
  -0.0105011f, -0.1794776f, +0.1293077f, +0.0596863f, +0.0558749f, +0.0339296f, -0.1926960f, +0.0000000f,
  -0.1487916f, -0.2005645f, -0.1306213f, -0.1057758f, +0.0257121f, -0.0395238f, +0.1773220f, -0.0000000f,
  +0.1133134f, -0.1861845f, -0.2014592f, +0.1451290f, +0.0208343f, +0.0482254f, -0.1177385f, +0.0000000f,
  +0.1222580f, -0.0003857f, -0.0344670f, +0.0675489f, -0.0264896f, -0.0306930f, -0.2481132f, -0.0000000f,
  +0.5313294f, +0.1121449f, -0.3360315f, -0.2430159f, +0.0546808f, +0.0452377f, +0.3458012f, +0.0000000f,
  -0.0337727f, +0.0760502f, -0.1074548f, +0.1261509f, +0.0445296f, -0.0636894f, -0.1132052f, -0.0000000f,
  -0.1141957f, -0.1715487f, -0.0304760f, +0.1465237f, -0.0000927f, +0.0169142f, -0.0154111f, +0.0000000f,
  +0.0701844f, -0.1461891f, -0.0590468f, +0.2499446f, -0.1019318f, -0.1505421f, +0.2039266f, -0.0000000f,
  +0.0204737f, -0.0468843f, +0.1046576f, +0.0885273f, -0.0061503f, +0.1310923f, +0.0376036f, +0.0000000f,
  +0.1662346f, +0.0571924f, +0.0129453f, +0.1127026f, -0.0283625f, -0.0673386f, +0.0368334f, -0.0000000f,
  +0.0416385f, -0.0773857f, -0.0975593f, -0.2330479f, +0.1295466f, -0.2055227f, -0.0034869f, +0.0000000f,
  +0.0305329f, -0.0793335f, +0.0274507f, -0.0026169f, +0.0189546f, +0.0480954f, -0.0468277f, -0.0000000f,
  +0.5441944f, -0.1714817f, +0.0600806f, +0.1106925f, -0.5468568f, -0.3499713f, -0.2155238f, +0.0000000f,
  +0.2881924f, +0.0034028f, -0.1322366f, +0.2955035f, -0.0511273f, +0.3069120f, +0.1137279f, -0.0000000f,
  +0.0115973f, -0.0358326f, +0.0273532f, -0.0130309f, -0.0853786f, +0.2439092f, -0.0380760f, +0.0000000f,
  +0.1920209f, -0.1486324f, +0.0760877f, +0.0003487f, +0.0287530f, -0.0494697f, +0.0784538f, +0.0000000f,
  +0.1456931f, -0.2168637f, -0.1458080f, +0.0497328f, +0.0268272f, +0.0010444f, +0.0664511f, +0.0000000f,
  +0.0311111f, +0.0148671f, +0.0228653f, -0.0460422f, -0.0246996f, +0.0688676f, +0.0157412f, +0.0000000f
);

const float biases[4] = float[4](
  -0.0162953f, +0.0106048f, -0.0166828f, -0.0065067f
);

vec4 hook() {
    const vec4 r[9][2] = vec4[9][2](
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 1.0f)))
    );

    float sum[4] = biases;
    for (int n = 0; n < 4; n++) {
        for (int i = 0; i < 9; i++) {
            const vec4 k0 = vec4(kernels[n * 8 * 9 + 8 * i + 0], kernels[n * 8 * 9 + 8 * i + 1], kernels[n * 8 * 9 + 8 * i + 2], kernels[n * 8 * 9 + 8 * i + 3]);
            const vec4 k1 = vec4(kernels[n * 8 * 9 + 8 * i + 4], kernels[n * 8 * 9 + 8 * i + 5], kernels[n * 8 * 9 + 8 * i + 6], kernels[n * 8 * 9 + 8 * i + 7]);
            sum[n] += (dot(k0, r[i][0]) + dot(k1, r[i][1]));
        }
    }

    return ACTIVE(vec4(sum[0], sum[1], sum[2], sum[3]));
}

//!HOOK LUMA
//!DESC ACNet Layer4 L1
//!WHEN OUTPUT.w LUMA.w / 1.2 > OUTPUT.h LUMA.h / 1.2 > *
//!BIND TMP2_L0
//!BIND TMP2_L1
//!SAVE TMP1_L1
//!COMPONENTS 4

#define ACTIVE(v) (max(v, 0.0f))

#define TEX_BIND_L0_TEXOFF TMP2_L0_texOff
#define TEX_BIND_L0_TEX TMP2_L0_tex
#define TEX_BIND_L0_POS TMP2_L0_pos
#define TEX_BIND_L0_SIZE TMP2_L0_size
#define TEX_BIND_L0_PT TMP2_L0_pt

#define TEX_BIND_L1_TEXOFF TMP2_L1_texOff
#define TEX_BIND_L1_TEX TMP2_L1_tex
#define TEX_BIND_L1_POS TMP2_L1_pos
#define TEX_BIND_L1_SIZE TMP2_L1_size
#define TEX_BIND_L1_PT TMP2_L1_pt

const float kernels[288] = float[288](
  -0.0476154f, +0.0438126f, +0.0834542f, +0.0285348f, -0.0393278f, +0.0736647f, +0.0357951f, +0.0000000f,
  -0.0083052f, -0.0805293f, -0.0429377f, +0.0396687f, +0.0076050f, +0.1308658f, -0.0771636f, -0.0000000f,
  -0.0247359f, +0.0576895f, -0.0191153f, +0.0337566f, +0.0078724f, +0.0018487f, -0.0115119f, -0.0000000f,
  -0.2461597f, +0.0833208f, +0.0340297f, -0.0624821f, +0.0079476f, +0.1440699f, -0.0725694f, +0.0000000f,
  +0.0999297f, +0.0912495f, -0.0908601f, +0.0060644f, +0.1185602f, +0.3683335f, +0.2156591f, -0.0000000f,
  +0.0107654f, -0.0500257f, -0.0080529f, +0.0246038f, +0.0099868f, +0.1620657f, -0.0641715f, -0.0000000f,
  +0.0747003f, +0.0646860f, +0.0361251f, +0.0043294f, +0.0058000f, -0.0564469f, -0.1799697f, +0.0000000f,
  +0.0756317f, -0.0414603f, -0.0000423f, -0.0362753f, -0.0460094f, +0.0425200f, +0.0162944f, -0.0000000f,
  +0.0218112f, +0.0220202f, +0.0078694f, -0.0277206f, -0.0081227f, +0.0252390f, +0.0364054f, -0.0000000f,
  +0.0785737f, +0.2544684f, +0.1709846f, -0.0605512f, +0.0247934f, +0.0526142f, -0.1199953f, -0.0000000f,
  -0.1229149f, -0.1668887f, -0.1201643f, -0.0757515f, +0.0633206f, -0.1317987f, +0.0163749f, +0.0000000f,
  +0.0756955f, -0.1591852f, -0.0704308f, +0.0446151f, +0.0944495f, +0.0508486f, -0.1101535f, -0.0000000f,
  -0.1937956f, -0.1391508f, -0.1303732f, -0.0955759f, -0.0315918f, -0.0572012f, -0.0955228f, -0.0000000f,
  +0.3515321f, -0.0927755f, -0.2199591f, +0.0048023f, -0.1259951f, +0.2735921f, +0.0673903f, -0.0000000f,
  +0.0954239f, -0.0171642f, -0.0409531f, +0.0463252f, +0.1141871f, -0.0107106f, -0.1243566f, -0.0000000f,
  +0.1146459f, -0.0898446f, -0.2075257f, +0.0233466f, -0.0327175f, +0.0076129f, -0.1844535f, +0.0000000f,
  +0.1452654f, -0.1335059f, -0.1966579f, +0.3388122f, -0.0966076f, -0.2468118f, -0.1648768f, +0.0000000f,
  -0.0421095f, +0.0949846f, +0.0981674f, +0.6581413f, +0.1250112f, +0.0623308f, -0.1081565f, -0.0000000f,
  -0.0200189f, +0.0575749f, -0.1451198f, +0.0478717f, +0.0077162f, -0.0887477f, +0.3615656f, +0.0000000f,
  +0.0508520f, +0.0326230f, -0.0791234f, -0.1036017f, -0.0151105f, -0.1040333f, +0.0157025f, -0.0000000f,
  -0.0816905f, -0.0490607f, +0.1329679f, -0.0902122f, +0.0412577f, +0.1798467f, -0.0747141f, +0.0000000f,
  -0.1699059f, -0.1554196f, -0.1601048f, +0.0560996f, -0.3511345f, +0.2059759f, +0.2589061f, +0.0000000f,
  -0.0727651f, -0.1236395f, -0.2129170f, +0.6115970f, -0.2732953f, +0.0281585f, -0.0606366f, +0.0000000f,
  -0.1396037f, +0.0497965f, +0.0026567f, +0.0103846f, +0.0786016f, -0.2610459f, +0.1994196f, +0.0000000f,
  +0.0081316f, -0.1221837f, +0.0466271f, +0.1159699f, +0.0156973f, -0.1360420f, -0.1127057f, -0.0000000f,
  -0.0919650f, -0.0743436f, -0.3859105f, -0.0898805f, +0.1096248f, +0.1702546f, +0.1485794f, -0.0000000f,
  +0.0139521f, -0.0165298f, -0.1768294f, +0.0316560f, +0.3007208f, -0.0179048f, +0.1152088f, +0.0000000f,
  -0.0646892f, -0.0208594f, -0.0616950f, -0.0491323f, +0.0497841f, +0.0190952f, -0.0363883f, +0.0000000f,
  -0.0179082f, -0.1017786f, -0.1180016f, +0.0486691f, -0.1010534f, +0.1782952f, -0.1551774f, -0.0000000f,
  -0.0563170f, +0.0061636f, -0.1045646f, +0.0166509f, +0.1310616f, +0.0126393f, -0.0175530f, -0.0000000f,
  -0.1332196f, -0.0684651f, -0.0545201f, +0.0664031f, -0.0178823f, +0.0128898f, +0.1965658f, -0.0000000f,
  +0.3134954f, +0.0871406f, -0.2767586f, +0.2745161f, -0.0448701f, +0.2886897f, +0.0530187f, +0.0000000f,
  +0.0315028f, +0.0269741f, +0.0843098f, +0.1786841f, -0.0027098f, +0.0086806f, +0.1146364f, +0.0000000f,
  -0.0832405f, -0.2536376f, -0.0151472f, +0.1121957f, -0.1078750f, -0.0257122f, +0.2105599f, +0.0000000f,
  +0.0024170f, +0.0298230f, +0.0677676f, +0.7245862f, +0.0449562f, -0.3709746f, -0.3342806f, +0.0000000f,
  -0.1030608f, -0.0197613f, -0.0274188f, +0.5471511f, +0.1337806f, -0.1175325f, +0.0130474f, -0.0000000f
);

const float biases[4] = float[4](
  -0.0061931f, -0.0348627f, -0.0224240f, -0.0058052f
);

vec4 hook() {
    const vec4 r[9][2] = vec4[9][2](
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 1.0f)))
    );

    float sum[4] = biases;
    for (int n = 0; n < 4; n++) {
        for (int i = 0; i < 9; i++) {
            const vec4 k0 = vec4(kernels[n * 8 * 9 + 8 * i + 0], kernels[n * 8 * 9 + 8 * i + 1], kernels[n * 8 * 9 + 8 * i + 2], kernels[n * 8 * 9 + 8 * i + 3]);
            const vec4 k1 = vec4(kernels[n * 8 * 9 + 8 * i + 4], kernels[n * 8 * 9 + 8 * i + 5], kernels[n * 8 * 9 + 8 * i + 6], kernels[n * 8 * 9 + 8 * i + 7]);
            sum[n] += (dot(k0, r[i][0]) + dot(k1, r[i][1]));
        }
    }

    return ACTIVE(vec4(sum[0], sum[1], sum[2], sum[3]));
}

//!HOOK LUMA
//!DESC ACNet Layer5 L0
//!WHEN OUTPUT.w LUMA.w / 1.2 > OUTPUT.h LUMA.h / 1.2 > *
//!BIND TMP1_L0
//!BIND TMP1_L1
//!SAVE TMP2_L0
//!COMPONENTS 4

#define ACTIVE(v) (max(v, 0.0f))

#define TEX_BIND_L0_TEXOFF TMP1_L0_texOff
#define TEX_BIND_L0_TEX TMP1_L0_tex
#define TEX_BIND_L0_POS TMP1_L0_pos
#define TEX_BIND_L0_SIZE TMP1_L0_size
#define TEX_BIND_L0_PT TMP1_L0_pt

#define TEX_BIND_L1_TEXOFF TMP1_L1_texOff
#define TEX_BIND_L1_TEX TMP1_L1_tex
#define TEX_BIND_L1_POS TMP1_L1_pos
#define TEX_BIND_L1_SIZE TMP1_L1_size
#define TEX_BIND_L1_PT TMP1_L1_pt

const float kernels[288] = float[288](
  +0.0486770f, -0.0544074f, +0.1278271f, +0.0023750f, -0.1166185f, +0.3684007f, -0.1005328f, +0.1871380f,
  -0.0661562f, -0.2879994f, +0.0629607f, -0.1314519f, -0.5154594f, -0.1127603f, +0.0141382f, +0.6534100f,
  -0.0173650f, +0.1603187f, -0.0931051f, +0.0384622f, -0.0773162f, -0.1699724f, -0.0734941f, +0.1720489f,
  -0.0903288f, +0.0465187f, +0.0113147f, -0.0023425f, +0.0289368f, -0.0108622f, +0.1048924f, +0.1479385f,
  +0.0269648f, +0.1792519f, +0.1788724f, +0.2209932f, +0.3604971f, +0.0785153f, -0.0975325f, +0.1184279f,
  +0.0120989f, +0.1663518f, -0.0204803f, -0.3538231f, +0.1678217f, -0.1771817f, -0.0713856f, +0.1489232f,
  -0.1090464f, -0.0451776f, -0.2007281f, +0.0560448f, +0.0011854f, -0.0176603f, +0.0571278f, +0.0062468f,
  -0.0910865f, -0.1044286f, -0.0116947f, +0.0224973f, +0.0735718f, -0.0392897f, -0.1157925f, -0.0013088f,
  -0.0143443f, -0.1511708f, +0.0210200f, -0.0045316f, +0.0795873f, +0.0376646f, +0.0187784f, -0.0350298f,
  -0.0619629f, -0.0725261f, -0.2439961f, +0.0714155f, -0.0231669f, +0.1855310f, -0.0823466f, +0.2463722f,
  -0.0139554f, +0.0332568f, +0.0191543f, +0.2514564f, +0.1248542f, +0.1087826f, -0.0913700f, +0.4173418f,
  -0.0342911f, -0.0723364f, +0.0546776f, +0.1320499f, -0.1271951f, -0.2326678f, -0.0576439f, +0.1744255f,
  -0.0953907f, +0.0514944f, +0.0658230f, -0.0052926f, +0.0356585f, +0.0135192f, -0.0494548f, +0.0431136f,
  -0.2378314f, -0.1208155f, -0.5016536f, +0.0474314f, -0.0799928f, -0.2681306f, -0.0211094f, +0.1089129f,
  +0.0362209f, +0.1619758f, -0.1584272f, +0.0794129f, -0.0788377f, +0.0762479f, -0.0871882f, +0.0329630f,
  -0.0060530f, -0.0233897f, +0.0568840f, +0.0394495f, +0.0736966f, +0.0052953f, -0.0334323f, -0.0141088f,
  -0.0653463f, -0.0518255f, -0.0452859f, +0.0249983f, +0.0045996f, -0.0354380f, -0.0482393f, +0.0103135f,
  +0.0580378f, +0.0044051f, -0.0195363f, -0.0802898f, +0.0662048f, -0.0606873f, -0.0473670f, +0.0099871f,
  -0.0378190f, +0.0100543f, +0.0985040f, -0.0042262f, +0.0837208f, -0.5103924f, -0.0326287f, -0.1357437f,
  -0.0813478f, -0.0281381f, +0.0477599f, +0.0950217f, +0.0423467f, +0.1562756f, +0.1026247f, +0.0906640f,
  -0.0318256f, +0.0502128f, -0.0400540f, +0.1314983f, -0.0080339f, +0.1461821f, -0.0939498f, -0.0012193f,
  +0.2217993f, +0.0666948f, +0.4373940f, -0.0772811f, +0.0374243f, +0.3047585f, -0.2130307f, -0.0506926f,
  +0.3242167f, +0.0914058f, +0.2445760f, +0.0608500f, -0.2276419f, -0.5107381f, +0.1513358f, +0.1826812f,
  +0.0929214f, +0.3061310f, -0.0068197f, +0.1280914f, +0.0547427f, -0.1959272f, +0.0150596f, +0.0915806f,
  -0.1920940f, +0.0413198f, +0.0979093f, -0.0260781f, +0.0370255f, +0.1842180f, -0.0375347f, -0.0973156f,
  -0.0663548f, +0.0043283f, -0.0857476f, +0.0355037f, -0.1083899f, +0.1007717f, +0.0876977f, -0.0388314f,
  -0.0815025f, +0.3157159f, -0.0535038f, -0.2426308f, +0.0254989f, -0.0573958f, -0.0294882f, +0.0544928f,
  +0.0598452f, -0.0202080f, +0.0336508f, +0.0142371f, +0.0346369f, -0.0474603f, -0.0168362f, -0.0544775f,
  +0.0884053f, -0.0098385f, +0.0619370f, +0.0881358f, +0.0194164f, +0.2874157f, +0.0182844f, -0.0531942f,
  -0.0362695f, +0.0661811f, +0.0168697f, -0.0846598f, +0.0134352f, +0.0672990f, -0.0423590f, -0.0283207f,
  +0.1824153f, +0.0381895f, -0.2785517f, +0.0942128f, +0.1674885f, +0.0254524f, +0.2083149f, +0.0604156f,
  +0.2786322f, +0.1562859f, -0.1200466f, +0.4920243f, +0.3405877f, -0.0419204f, +0.7158763f, +0.2973284f,
  -0.1733822f, -0.0268243f, +0.0622411f, +0.4784370f, -0.4104450f, -0.1193175f, -0.1163528f, -0.0693051f,
  +0.0549055f, -0.0033006f, -0.0471679f, -0.0271533f, -0.0105303f, +0.0468809f, -0.0356639f, -0.0175229f,
  +0.1562658f, -0.0058016f, -0.0327493f, -0.0014846f, +0.0384128f, -0.0973616f, +0.0535205f, +0.0250578f,
  +0.0519405f, +0.1753654f, -0.0929202f, +0.2981105f, -0.2044155f, -0.0162440f, +0.1015519f, -0.0129769f
);

const float biases[4] = float[4](
  +0.0049006f, -0.0009781f, -0.0182200f, -0.0029865f
);

vec4 hook() {
    const vec4 r[9][2] = vec4[9][2](
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 1.0f)))
    );

    float sum[4] = biases;
    for (int n = 0; n < 4; n++) {
        for (int i = 0; i < 9; i++) {
            const vec4 k0 = vec4(kernels[n * 8 * 9 + 8 * i + 0], kernels[n * 8 * 9 + 8 * i + 1], kernels[n * 8 * 9 + 8 * i + 2], kernels[n * 8 * 9 + 8 * i + 3]);
            const vec4 k1 = vec4(kernels[n * 8 * 9 + 8 * i + 4], kernels[n * 8 * 9 + 8 * i + 5], kernels[n * 8 * 9 + 8 * i + 6], kernels[n * 8 * 9 + 8 * i + 7]);
            sum[n] += (dot(k0, r[i][0]) + dot(k1, r[i][1]));
        }
    }

    return ACTIVE(vec4(sum[0], sum[1], sum[2], sum[3]));
}

//!HOOK LUMA
//!DESC ACNet Layer5 L1
//!WHEN OUTPUT.w LUMA.w / 1.2 > OUTPUT.h LUMA.h / 1.2 > *
//!BIND TMP1_L0
//!BIND TMP1_L1
//!SAVE TMP2_L1
//!COMPONENTS 4

#define ACTIVE(v) (max(v, 0.0f))

#define TEX_BIND_L0_TEXOFF TMP1_L0_texOff
#define TEX_BIND_L0_TEX TMP1_L0_tex
#define TEX_BIND_L0_POS TMP1_L0_pos
#define TEX_BIND_L0_SIZE TMP1_L0_size
#define TEX_BIND_L0_PT TMP1_L0_pt

#define TEX_BIND_L1_TEXOFF TMP1_L1_texOff
#define TEX_BIND_L1_TEX TMP1_L1_tex
#define TEX_BIND_L1_POS TMP1_L1_pos
#define TEX_BIND_L1_SIZE TMP1_L1_size
#define TEX_BIND_L1_PT TMP1_L1_pt

const float kernels[288] = float[288](
  +0.0094580f, -0.0156479f, -0.1077387f, +0.0521833f, +0.0392755f, -0.1114086f, +0.0675993f, -0.0462888f,
  +0.0417879f, +0.0939441f, -0.0450479f, +0.2130610f, +0.1877326f, -0.0660910f, +0.0298693f, -0.2398442f,
  -0.0985768f, -0.0609232f, +0.0221593f, -0.0718768f, -0.0401630f, -0.0595400f, -0.0349454f, -0.0088056f,
  +0.3066921f, +0.0228212f, +0.0208950f, +0.0617986f, +0.1294595f, +0.1113556f, +0.0570458f, +0.0872899f,
  -0.5600960f, +0.0993260f, +0.2270219f, +0.2070313f, +0.3567265f, -0.0559786f, -0.3377176f, +0.2026271f,
  -0.0215489f, -0.0850583f, +0.0570376f, -0.4480034f, +0.1836902f, +0.0210132f, +0.0424611f, +0.0687415f,
  +0.0244844f, -0.0021743f, -0.0243116f, -0.0755671f, -0.0625519f, -0.0169149f, -0.1089668f, +0.0037466f,
  +0.0436912f, -0.0164698f, -0.0445163f, +0.0473057f, +0.0615435f, -0.0087860f, +0.1637129f, -0.0042755f,
  -0.0150333f, -0.0314515f, +0.0040392f, -0.0399787f, +0.0689176f, +0.0171133f, -0.0357309f, -0.0372386f,
  -0.0662122f, +0.0350996f, -0.0366410f, +0.0085598f, +0.0897088f, +0.0115195f, -0.1922890f, -0.1506861f,
  -0.0161925f, +0.1470581f, +0.0967207f, +0.1192059f, +0.0122597f, -0.0396103f, -0.2474836f, +0.0081043f,
  -0.1634374f, -0.0544638f, +0.0571481f, -0.0633726f, +0.1550079f, -0.0293185f, +0.0670073f, -0.1771112f,
  -0.0140579f, +0.0212197f, +0.1603239f, -0.0201547f, +0.1098466f, -0.0596723f, +0.2151929f, -0.0101737f,
  -0.0333269f, -0.0076534f, -0.2004554f, -0.0530281f, -0.3429052f, +0.1277536f, +0.1473330f, -0.3151835f,
  -0.0143274f, -0.0305155f, -0.0633076f, +0.0235554f, -0.1093522f, +0.0298924f, -0.1698111f, -0.2950839f,
  +0.2759631f, +0.0114215f, +0.1201718f, +0.0317397f, -0.0065659f, -0.0382728f, +0.0275205f, +0.0293647f,
  -0.2524172f, +0.0798582f, +0.1737243f, +0.0649264f, +0.0383112f, +0.0514850f, -0.1344413f, -0.0136009f,
  -0.0149843f, -0.0491956f, +0.1486105f, +0.0947728f, +0.0380751f, +0.0202793f, -0.0022703f, +0.0127165f,
  +0.0947412f, +0.1163332f, +0.0567785f, -0.0198223f, +0.1088687f, -0.0137650f, +0.1241673f, -0.0714396f,
  +0.2197098f, -0.0388871f, -0.1166254f, +0.1259670f, +0.0458527f, +0.0409087f, -0.0598471f, -0.0829763f,
  -0.0532557f, -0.0553872f, -0.0334765f, +0.0240781f, -0.0553402f, -0.0262486f, -0.0281077f, -0.0985646f,
  +0.1489462f, -0.2059048f, +0.1290077f, -0.1164871f, -0.3958952f, +0.1998092f, +0.0645595f, +0.1572322f,
  -0.1568835f, +0.6360282f, -0.1919352f, -0.1624885f, +0.2306336f, +0.0206099f, -0.0623557f, +0.1130009f,
  -0.0716235f, -0.2324588f, +0.0788167f, +0.0019136f, -0.0366856f, +0.0383905f, -0.1460138f, -0.0296956f,
  -0.0041369f, +0.1610602f, -0.1408801f, -0.0657048f, -0.0188269f, -0.1014455f, +0.1910921f, +0.0772514f,
  +0.2418289f, +0.1755228f, -0.2715091f, +0.0631840f, +0.0297748f, +0.0590707f, +0.4333824f, +0.0169716f,
  +0.0071237f, +0.0413795f, -0.0289241f, -0.1489629f, +0.0649068f, -0.0186374f, +0.0466999f, -0.0084424f,
  +0.0094008f, +0.0333458f, -0.0626914f, +0.0304659f, +0.0031967f, +0.0760882f, +0.0031323f, -0.0847569f,
  +0.0535664f, -0.0581257f, +0.0627363f, +0.0266627f, -0.0231158f, -0.1246109f, -0.0161978f, +0.1217736f,
  -0.0342917f, +0.0352268f, -0.0317830f, -0.0152183f, +0.0417443f, -0.0366564f, +0.0079404f, -0.0544194f,
  +0.0191850f, +0.0005847f, +0.0008800f, -0.0229958f, +0.0711551f, +0.0066806f, +0.0184236f, +0.0360804f,
  -0.1252917f, -0.0584282f, -0.1289116f, -0.0170903f, -0.3682146f, +0.0092216f, -0.1142237f, -0.1364325f,
  -0.0381635f, +0.0838535f, +0.0121597f, -0.0134077f, -0.0813429f, +0.0115205f, +0.0298858f, +0.0655308f,
  +0.0360774f, -0.0004689f, -0.0792972f, -0.0246327f, -0.0305989f, -0.0327276f, -0.0094552f, +0.0040989f,
  -0.0516497f, -0.0365341f, +0.0686928f, +0.0562998f, -0.0761084f, -0.0079629f, -0.0547355f, +0.0125483f,
  +0.0471704f, -0.0673053f, +0.0041189f, +0.0288572f, +0.0034120f, -0.0412064f, +0.0190317f, +0.0180171f
);

const float biases[4] = float[4](
  +0.1045378f, +0.0114261f, -0.0004966f, +0.7359714f
);

vec4 hook() {
    const vec4 r[9][2] = vec4[9][2](
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 1.0f)))
    );

    float sum[4] = biases;
    for (int n = 0; n < 4; n++) {
        for (int i = 0; i < 9; i++) {
            const vec4 k0 = vec4(kernels[n * 8 * 9 + 8 * i + 0], kernels[n * 8 * 9 + 8 * i + 1], kernels[n * 8 * 9 + 8 * i + 2], kernels[n * 8 * 9 + 8 * i + 3]);
            const vec4 k1 = vec4(kernels[n * 8 * 9 + 8 * i + 4], kernels[n * 8 * 9 + 8 * i + 5], kernels[n * 8 * 9 + 8 * i + 6], kernels[n * 8 * 9 + 8 * i + 7]);
            sum[n] += (dot(k0, r[i][0]) + dot(k1, r[i][1]));
        }
    }

    return ACTIVE(vec4(sum[0], sum[1], sum[2], sum[3]));
}

//!HOOK LUMA
//!DESC ACNet Layer6 L0
//!WHEN OUTPUT.w LUMA.w / 1.2 > OUTPUT.h LUMA.h / 1.2 > *
//!BIND TMP2_L0
//!BIND TMP2_L1
//!SAVE TMP1_L0
//!COMPONENTS 4

#define ACTIVE(v) (max(v, 0.0f))

#define TEX_BIND_L0_TEXOFF TMP2_L0_texOff
#define TEX_BIND_L0_TEX TMP2_L0_tex
#define TEX_BIND_L0_POS TMP2_L0_pos
#define TEX_BIND_L0_SIZE TMP2_L0_size
#define TEX_BIND_L0_PT TMP2_L0_pt

#define TEX_BIND_L1_TEXOFF TMP2_L1_texOff
#define TEX_BIND_L1_TEX TMP2_L1_tex
#define TEX_BIND_L1_POS TMP2_L1_pos
#define TEX_BIND_L1_SIZE TMP2_L1_size
#define TEX_BIND_L1_PT TMP2_L1_pt

const float kernels[288] = float[288](
  +0.0203561f, -0.0021520f, +0.0344545f, -0.0659408f, +0.0365672f, +0.0119230f, +0.0529636f, -0.0055860f,
  -0.0268616f, +0.0400077f, +0.0215986f, -0.0261863f, -0.0284979f, +0.1721733f, +0.3156224f, +0.0151038f,
  +0.0423829f, -0.0088484f, +0.0132934f, -0.0423142f, -0.0175593f, +0.0127506f, +0.5866278f, +0.0162375f,
  +0.0034693f, +0.0034553f, +0.0414712f, -0.2808773f, +0.1929278f, -0.0043997f, -0.0813517f, -0.0871069f,
  +0.0872231f, +0.5108333f, -0.1085218f, +0.7035943f, +0.0207819f, -0.3231940f, +0.3651040f, -0.0447725f,
  +0.1267148f, -0.0848613f, -0.0842406f, +0.0529426f, -0.1072816f, -0.0151651f, -0.2153228f, +0.0020594f,
  -0.0172917f, -0.0335161f, -0.0182734f, +0.0248846f, +0.0247820f, -0.0464924f, -0.0002160f, +0.0370849f,
  -0.1494908f, -0.1155614f, +0.0719452f, -0.0114378f, +0.0120241f, -0.1631656f, -0.0067807f, -0.0596576f,
  +0.2148358f, -0.0956703f, -0.0441731f, -0.0795042f, -0.0738089f, +0.0748234f, -0.0740106f, +0.0221535f,
  -0.0716759f, +0.0452935f, +0.0299448f, +0.1237738f, -0.0474561f, -0.0456928f, +0.0648792f, +0.1079497f,
  +0.0914892f, +0.0045397f, +0.0836312f, +0.0160440f, +0.0899655f, -0.0599661f, +0.1657907f, -0.1870073f,
  -0.0012671f, -0.0831145f, +0.1075393f, +0.0059782f, +0.0716736f, +0.0069034f, -0.2066197f, +0.0520287f,
  +0.1032247f, +0.0708878f, +0.2084089f, -0.2131766f, +0.0928916f, -0.0597494f, -0.0324745f, -0.1937355f,
  +0.6186176f, -0.3547064f, -0.5809731f, -0.0605456f, +0.1511284f, +0.1632201f, +0.4095228f, -0.4653904f,
  +0.0639418f, -0.0623401f, +0.0632370f, +0.1222618f, +0.1184201f, -0.0069308f, -0.2114952f, -0.1056926f,
  -0.0200064f, -0.0048921f, +0.0851948f, -0.0571744f, +0.0607880f, -0.0703288f, -0.0236208f, +0.0373816f,
  -0.6383256f, +0.1818251f, +0.0077818f, +0.0935002f, +0.2520081f, +0.0499804f, +0.0350606f, -0.1483197f,
  -0.0762167f, +0.0427016f, -0.0367777f, +0.0202430f, +0.1732092f, -0.0612142f, -0.0630055f, -0.0086523f,
  -0.0049844f, +0.0359080f, -0.0527246f, +0.0050296f, +0.0074331f, -0.0249592f, +0.0439588f, +0.0140115f,
  +0.0511765f, +0.0645684f, -0.3674627f, +0.1595963f, -0.0065978f, -0.0433081f, +0.1431794f, -0.0173753f,
  -0.0346738f, +0.0454542f, +0.1214293f, +0.0142541f, +0.0046603f, -0.1256323f, +0.1531884f, +0.0058203f,
  +0.0511438f, -0.1432597f, +0.1586094f, -0.4328223f, +0.1432405f, +0.0866183f, -0.0907422f, -0.0669738f,
  -0.0083361f, -0.1381005f, -0.1793876f, +0.4044090f, -0.3222868f, +0.0282195f, -0.0481693f, -0.0007557f,
  +0.0377269f, +0.1688238f, +0.1639845f, -0.0129964f, +0.1130159f, -0.1580327f, +0.5186319f, -0.0634147f,
  -0.0460513f, +0.2126772f, -0.2479457f, -0.1982128f, +0.1448992f, +0.3223192f, +0.0208991f, +0.0869893f,
  -0.1529126f, -0.1188630f, -0.1938286f, +0.1528302f, -0.0296310f, -0.0312833f, +0.0271307f, +0.0969882f,
  +0.2369405f, +0.0668951f, +0.0169515f, +0.0709758f, -0.0665085f, -0.1558074f, -0.2831052f, -0.0648431f,
  -0.0000000f, +0.0000000f, +0.0000000f, +0.0000000f, +0.0000000f, -0.0000000f, -0.0000000f, -0.0000000f,
  -0.0000000f, +0.0000000f, +0.0000000f, +0.0000000f, +0.0000000f, +0.0000000f, -0.0000000f, +0.0000000f,
  -0.0000000f, -0.0000000f, -0.0000000f, -0.0000000f, +0.0000000f, +0.0000000f, -0.0000000f, -0.0000000f,
  +0.0000000f, +0.0000000f, +0.0000000f, +0.0000000f, -0.0000000f, +0.0000000f, +0.0000000f, -0.0000000f,
  +0.0000000f, -0.0000000f, -0.0000000f, +0.0000000f, +0.0000000f, -0.0000000f, +0.0000000f, -0.0000000f,
  +0.0000000f, -0.0000000f, +0.0000000f, -0.0000000f, -0.0000000f, -0.0000000f, +0.0000000f, -0.0000000f,
  -0.0000000f, -0.0000000f, -0.0000000f, -0.0000000f, +0.0000000f, +0.0000000f, +0.0000000f, +0.0000000f,
  -0.0000000f, -0.0000000f, -0.0000000f, +0.0000000f, -0.0000000f, -0.0000000f, +0.0000000f, -0.0000000f,
  -0.0000000f, -0.0000000f, -0.0000000f, -0.0000000f, -0.0000000f, +0.0000000f, +0.0000000f, -0.0000000f
);

const float biases[4] = float[4](
  +0.0839608f, +0.5819007f, +0.0040736f, +0.0000000f
);

vec4 hook() {
    const vec4 r[9][2] = vec4[9][2](
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 1.0f)))
    );

    float sum[4] = biases;
    for (int n = 0; n < 4; n++) {
        for (int i = 0; i < 9; i++) {
            const vec4 k0 = vec4(kernels[n * 8 * 9 + 8 * i + 0], kernels[n * 8 * 9 + 8 * i + 1], kernels[n * 8 * 9 + 8 * i + 2], kernels[n * 8 * 9 + 8 * i + 3]);
            const vec4 k1 = vec4(kernels[n * 8 * 9 + 8 * i + 4], kernels[n * 8 * 9 + 8 * i + 5], kernels[n * 8 * 9 + 8 * i + 6], kernels[n * 8 * 9 + 8 * i + 7]);
            sum[n] += (dot(k0, r[i][0]) + dot(k1, r[i][1]));
        }
    }

    return ACTIVE(vec4(sum[0], sum[1], sum[2], sum[3]));
}

//!HOOK LUMA
//!DESC ACNet Layer6 L1
//!WHEN OUTPUT.w LUMA.w / 1.2 > OUTPUT.h LUMA.h / 1.2 > *
//!BIND TMP2_L0
//!BIND TMP2_L1
//!SAVE TMP1_L1
//!COMPONENTS 4

#define ACTIVE(v) (max(v, 0.0f))

#define TEX_BIND_L0_TEXOFF TMP2_L0_texOff
#define TEX_BIND_L0_TEX TMP2_L0_tex
#define TEX_BIND_L0_POS TMP2_L0_pos
#define TEX_BIND_L0_SIZE TMP2_L0_size
#define TEX_BIND_L0_PT TMP2_L0_pt

#define TEX_BIND_L1_TEXOFF TMP2_L1_texOff
#define TEX_BIND_L1_TEX TMP2_L1_tex
#define TEX_BIND_L1_POS TMP2_L1_pos
#define TEX_BIND_L1_SIZE TMP2_L1_size
#define TEX_BIND_L1_PT TMP2_L1_pt

const float kernels[288] = float[288](
  +0.0326662f, -0.0567513f, -0.0831896f, -0.0789822f, +0.0032626f, -0.0969618f, +0.0107056f, -0.0317535f,
  -0.0243777f, -0.0340168f, -0.0909418f, +0.1704283f, +0.0947631f, -0.1457430f, -0.0778117f, +0.1020497f,
  +0.0320256f, +0.0541102f, -0.0489829f, +0.0650256f, +0.0644240f, -0.0126437f, +0.0679027f, -0.0694146f,
  +0.2168909f, -0.0430673f, +0.2656937f, -0.2665987f, +0.1039997f, -0.0305947f, -0.0319761f, +0.0079549f,
  +0.0429004f, -0.4315498f, +0.7931258f, +0.6881867f, -0.2351680f, -0.6098897f, +0.0477838f, -0.2489260f,
  +0.0141792f, +0.0334023f, -0.2110006f, -0.1185413f, -0.1846997f, +0.0166389f, -0.1247798f, +0.1851804f,
  -0.2237799f, -0.0295790f, -0.0553659f, -0.0576020f, +0.0412778f, +0.0603020f, +0.0181913f, -0.0410805f,
  -0.0113860f, +0.3842382f, -0.0844385f, +0.0946375f, +0.2291391f, +0.0292277f, -0.0667179f, +0.0873938f,
  +0.1066670f, -0.1473796f, +0.0214575f, -0.0340626f, -0.1329568f, -0.0705745f, +0.1060486f, -0.0220585f,
  +0.0000000f, +0.0000000f, +0.0000000f, +0.0000000f, -0.0000000f, +0.0000000f, +0.0000000f, -0.0000000f,
  -0.0000000f, +0.0000000f, +0.0000000f, -0.0000000f, -0.0000000f, +0.0000000f, +0.0000000f, -0.0000000f,
  +0.0000000f, +0.0000000f, -0.0000000f, -0.0000000f, -0.0000000f, +0.0000000f, -0.0000000f, -0.0000000f,
  +0.0000000f, -0.0000000f, -0.0000000f, -0.0000000f, -0.0000000f, +0.0000000f, -0.0000000f, +0.0000000f,
  +0.0000000f, +0.0000000f, -0.0000000f, -0.0000000f, -0.0000000f, -0.0000000f, +0.0000000f, +0.0000000f,
  +0.0000000f, +0.0000000f, -0.0000000f, +0.0000000f, +0.0000000f, +0.0000000f, +0.0000000f, -0.0000000f,
  -0.0000000f, -0.0000000f, +0.0000000f, -0.0000000f, -0.0000000f, +0.0000000f, +0.0000000f, -0.0000000f,
  +0.0000000f, +0.0000000f, +0.0000000f, -0.0000000f, -0.0000000f, +0.0000000f, +0.0000000f, +0.0000000f,
  -0.0000000f, +0.0000000f, -0.0000000f, +0.0000000f, -0.0000000f, +0.0000000f, -0.0000000f, -0.0000000f,
  -0.0000000f, +0.0000000f, +0.0000000f, +0.0000000f, +0.0000000f, -0.0000000f, +0.0000000f, +0.0000000f,
  +0.0000000f, -0.0000000f, +0.0000000f, -0.0000000f, +0.0000000f, +0.0000000f, -0.0000000f, -0.0000000f,
  -0.0000000f, -0.0000000f, +0.0000000f, -0.0000000f, +0.0000000f, -0.0000000f, +0.0000000f, -0.0000000f,
  -0.0000000f, +0.0000000f, +0.0000000f, +0.0000000f, -0.0000000f, -0.0000000f, +0.0000000f, -0.0000000f,
  -0.0000000f, +0.0000000f, -0.0000000f, +0.0000000f, -0.0000000f, -0.0000000f, +0.0000000f, -0.0000000f,
  +0.0000000f, -0.0000000f, +0.0000000f, -0.0000000f, +0.0000000f, -0.0000000f, -0.0000000f, +0.0000000f,
  +0.0000000f, -0.0000000f, +0.0000000f, -0.0000000f, -0.0000000f, +0.0000000f, +0.0000000f, -0.0000000f,
  -0.0000000f, -0.0000000f, +0.0000000f, +0.0000000f, -0.0000000f, +0.0000000f, -0.0000000f, -0.0000000f,
  +0.0000000f, +0.0000000f, +0.0000000f, +0.0000000f, +0.0000000f, -0.0000000f, -0.0000000f, +0.0000000f,
  -0.0304180f, +0.0865203f, +0.0327997f, +0.0609683f, -0.0197327f, -0.0604526f, +0.0322612f, -0.0059884f,
  +0.0509582f, -0.0265852f, +0.0491196f, +0.0604394f, +0.1325858f, +0.0283597f, +0.0139876f, +0.0189097f,
  -0.0029186f, -0.0107246f, +0.0909756f, -0.0249194f, -0.0135501f, -0.0612110f, +0.0759827f, -0.0306938f,
  -0.0249798f, +0.0950809f, +0.1623848f, +0.1613123f, -0.2024961f, -0.1744847f, +0.0034025f, +0.0453788f,
  +0.6034869f, -0.3737472f, -0.1380457f, +0.2022038f, +0.7507708f, +0.1480860f, +0.0532677f, -0.1204488f,
  +0.0235371f, -0.0209386f, +0.1191244f, -0.0163565f, -0.0323792f, +0.0554999f, +0.4882383f, -0.0093894f,
  +0.0925757f, -0.0986981f, +0.0126221f, +0.1210579f, -0.0500127f, -0.0943001f, -0.0080616f, -0.0248750f,
  +0.1948078f, +0.1220675f, +0.0616797f, +0.0208562f, -0.3697685f, -0.2283525f, -0.0919092f, +0.0671227f,
  +0.1065316f, +0.0364938f, -0.0263817f, -0.0506262f, -0.1906178f, +0.1027382f, +0.0295305f, -0.0008673f
);

const float biases[4] = float[4](
  +0.0271408f, -0.0000000f, -0.0000000f, +0.0341938f
);

vec4 hook() {
    const vec4 r[9][2] = vec4[9][2](
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 1.0f)))
    );

    float sum[4] = biases;
    for (int n = 0; n < 4; n++) {
        for (int i = 0; i < 9; i++) {
            const vec4 k0 = vec4(kernels[n * 8 * 9 + 8 * i + 0], kernels[n * 8 * 9 + 8 * i + 1], kernels[n * 8 * 9 + 8 * i + 2], kernels[n * 8 * 9 + 8 * i + 3]);
            const vec4 k1 = vec4(kernels[n * 8 * 9 + 8 * i + 4], kernels[n * 8 * 9 + 8 * i + 5], kernels[n * 8 * 9 + 8 * i + 6], kernels[n * 8 * 9 + 8 * i + 7]);
            sum[n] += (dot(k0, r[i][0]) + dot(k1, r[i][1]));
        }
    }

    return ACTIVE(vec4(sum[0], sum[1], sum[2], sum[3]));
}

//!HOOK LUMA
//!DESC ACNet Layer7 L0
//!WHEN OUTPUT.w LUMA.w / 1.2 > OUTPUT.h LUMA.h / 1.2 > *
//!BIND TMP1_L0
//!BIND TMP1_L1
//!SAVE TMP2_L0
//!COMPONENTS 4

#define ACTIVE(v) (max(v, 0.0f))

#define TEX_BIND_L0_TEXOFF TMP1_L0_texOff
#define TEX_BIND_L0_TEX TMP1_L0_tex
#define TEX_BIND_L0_POS TMP1_L0_pos
#define TEX_BIND_L0_SIZE TMP1_L0_size
#define TEX_BIND_L0_PT TMP1_L0_pt

#define TEX_BIND_L1_TEXOFF TMP1_L1_texOff
#define TEX_BIND_L1_TEX TMP1_L1_tex
#define TEX_BIND_L1_POS TMP1_L1_pos
#define TEX_BIND_L1_SIZE TMP1_L1_size
#define TEX_BIND_L1_PT TMP1_L1_pt

const float kernels[288] = float[288](
  -0.0000000f, +0.0000000f, +0.0000000f, -0.0000000f, +0.0000000f, +0.0000000f, +0.0000000f, +0.0000000f,
  +0.0000000f, -0.0000000f, -0.0000000f, -0.0000000f, +0.0000000f, -0.0000000f, -0.0000000f, -0.0000000f,
  +0.0000000f, -0.0000000f, -0.0000000f, -0.0000000f, +0.0000000f, +0.0000000f, +0.0000000f, -0.0000000f,
  +0.0000000f, +0.0000000f, -0.0000000f, -0.0000000f, +0.0000000f, +0.0000000f, +0.0000000f, -0.0000000f,
  +0.0000000f, +0.0000000f, -0.0000000f, +0.0000000f, +0.0000000f, -0.0000000f, +0.0000000f, +0.0000000f,
  -0.0000000f, +0.0000000f, +0.0000000f, -0.0000000f, -0.0000000f, +0.0000000f, +0.0000000f, +0.0000000f,
  -0.0000000f, +0.0000000f, +0.0000000f, +0.0000000f, -0.0000000f, +0.0000000f, -0.0000000f, -0.0000000f,
  +0.0000000f, +0.0000000f, -0.0000000f, -0.0000000f, -0.0000000f, +0.0000000f, +0.0000000f, -0.0000000f,
  +0.0000000f, +0.0000000f, -0.0000000f, -0.0000000f, +0.0000000f, +0.0000000f, +0.0000000f, -0.0000000f,
  -0.0510252f, +0.0479356f, -0.6062726f, +0.0000000f, -0.0444363f, +0.0000000f, +0.0000000f, +0.0550665f,
  +0.0446259f, +0.0141718f, +0.0198276f, +0.0000000f, -0.0218837f, -0.0000000f, +0.0000000f, -0.0248054f,
  -0.0204201f, -0.0003338f, +0.0248311f, -0.0000000f, +0.0119315f, -0.0000000f, -0.0000000f, -0.0099706f,
  +0.6843945f, -0.4961186f, -0.4464042f, +0.0000000f, +0.6093464f, +0.0000000f, +0.0000000f, -0.4284072f,
  +0.1320437f, +0.2784857f, -0.1249196f, -0.0000000f, +0.0923408f, -0.0000000f, +0.0000000f, +0.1708626f,
  +0.0148142f, +0.0172531f, -0.0212155f, +0.0000000f, -0.0097186f, -0.0000000f, -0.0000000f, +0.0028012f,
  -0.0406871f, +0.0740863f, +0.0246698f, +0.0000000f, +0.0360627f, +0.0000000f, +0.0000000f, +0.0106618f,
  +0.0735548f, +0.0036332f, +0.0185216f, +0.0000000f, -0.0639898f, +0.0000000f, -0.0000000f, +0.0181643f,
  -0.0230682f, -0.0028430f, -0.0142770f, +0.0000000f, +0.0212185f, -0.0000000f, +0.0000000f, -0.0010281f,
  -0.0588052f, +0.1069765f, +0.0022160f, +0.0000000f, +0.0050201f, -0.0000000f, -0.0000000f, -0.1257370f,
  +0.0837056f, +0.2294871f, +0.0926815f, -0.0000000f, -0.0855985f, -0.0000000f, -0.0000000f, -0.3389235f,
  +0.0049278f, +0.0336238f, +0.0285804f, +0.0000000f, -0.0368129f, -0.0000000f, -0.0000000f, -0.1268180f,
  -0.1618495f, +0.1754795f, +0.0442929f, -0.0000000f, -0.2517577f, +0.0000000f, -0.0000000f, -0.0341960f,
  +0.1759418f, +0.3951661f, -0.1332766f, +0.0000000f, +0.7271015f, +0.0000000f, -0.0000000f, +0.6314265f,
  +0.1697104f, +0.0673724f, +0.0421615f, -0.0000000f, -0.0906435f, -0.0000000f, -0.0000000f, -0.0842700f,
  -0.1124385f, +0.0637798f, -0.0203485f, +0.0000000f, -0.0238572f, -0.0000000f, -0.0000000f, +0.0094445f,
  -0.1260834f, +0.0979676f, +0.0132679f, -0.0000000f, -0.1662724f, -0.0000000f, -0.0000000f, +0.0862253f,
  +0.0496123f, -0.0827675f, -0.0214035f, +0.0000000f, -0.0554441f, -0.0000000f, -0.0000000f, +0.0052467f,
  +0.0000000f, -0.0000000f, -0.0000000f, -0.0000000f, +0.0000000f, -0.0000000f, +0.0000000f, -0.0000000f,
  -0.0000000f, -0.0000000f, +0.0000000f, -0.0000000f, +0.0000000f, +0.0000000f, -0.0000000f, +0.0000000f,
  -0.0000000f, +0.0000000f, -0.0000000f, -0.0000000f, -0.0000000f, -0.0000000f, -0.0000000f, +0.0000000f,
  -0.0000000f, -0.0000000f, +0.0000000f, +0.0000000f, +0.0000000f, -0.0000000f, -0.0000000f, -0.0000000f,
  -0.0000000f, -0.0000000f, +0.0000000f, -0.0000000f, +0.0000000f, +0.0000000f, -0.0000000f, -0.0000000f,
  +0.0000000f, +0.0000000f, -0.0000000f, -0.0000000f, +0.0000000f, -0.0000000f, -0.0000000f, +0.0000000f,
  +0.0000000f, +0.0000000f, +0.0000000f, -0.0000000f, -0.0000000f, -0.0000000f, -0.0000000f, -0.0000000f,
  -0.0000000f, +0.0000000f, -0.0000000f, -0.0000000f, +0.0000000f, -0.0000000f, -0.0000000f, -0.0000000f,
  -0.0000000f, +0.0000000f, -0.0000000f, -0.0000000f, +0.0000000f, +0.0000000f, -0.0000000f, -0.0000000f
);

const float biases[4] = float[4](
  +0.0000000f, -0.0194738f, -0.0670328f, +0.0000000f
);

vec4 hook() {
    const vec4 r[9][2] = vec4[9][2](
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 1.0f)))
    );

    float sum[4] = biases;
    for (int n = 0; n < 4; n++) {
        for (int i = 0; i < 9; i++) {
            const vec4 k0 = vec4(kernels[n * 8 * 9 + 8 * i + 0], kernels[n * 8 * 9 + 8 * i + 1], kernels[n * 8 * 9 + 8 * i + 2], kernels[n * 8 * 9 + 8 * i + 3]);
            const vec4 k1 = vec4(kernels[n * 8 * 9 + 8 * i + 4], kernels[n * 8 * 9 + 8 * i + 5], kernels[n * 8 * 9 + 8 * i + 6], kernels[n * 8 * 9 + 8 * i + 7]);
            sum[n] += (dot(k0, r[i][0]) + dot(k1, r[i][1]));
        }
    }

    return ACTIVE(vec4(sum[0], sum[1], sum[2], sum[3]));
}

//!HOOK LUMA
//!DESC ACNet Layer7 L1
//!WHEN OUTPUT.w LUMA.w / 1.2 > OUTPUT.h LUMA.h / 1.2 > *
//!BIND TMP1_L0
//!BIND TMP1_L1
//!SAVE TMP2_L1
//!COMPONENTS 4

#define ACTIVE(v) (max(v, 0.0f))

#define TEX_BIND_L0_TEXOFF TMP1_L0_texOff
#define TEX_BIND_L0_TEX TMP1_L0_tex
#define TEX_BIND_L0_POS TMP1_L0_pos
#define TEX_BIND_L0_SIZE TMP1_L0_size
#define TEX_BIND_L0_PT TMP1_L0_pt

#define TEX_BIND_L1_TEXOFF TMP1_L1_texOff
#define TEX_BIND_L1_TEX TMP1_L1_tex
#define TEX_BIND_L1_POS TMP1_L1_pos
#define TEX_BIND_L1_SIZE TMP1_L1_size
#define TEX_BIND_L1_PT TMP1_L1_pt

const float kernels[288] = float[288](
  +0.0699095f, -0.0154057f, -0.0026467f, +0.0000000f, -0.0265278f, -0.0000000f, +0.0000000f, +0.0680067f,
  -0.0444720f, -0.0283422f, -0.0178896f, -0.0000000f, +0.0239264f, -0.0000000f, -0.0000000f, +0.0252091f,
  -0.0144092f, +0.0323175f, -0.0621736f, +0.0000000f, +0.0096091f, -0.0000000f, -0.0000000f, -0.0068389f,
  -0.0425140f, -0.1499697f, -0.1033631f, +0.0000000f, +0.1470920f, +0.0000000f, +0.0000000f, +0.0904471f,
  -0.2363086f, -0.3449510f, -0.0159413f, -0.0000000f, +0.2111512f, +0.0000000f, -0.0000000f, +0.2624427f,
  +0.1161641f, -0.0179657f, -0.0643465f, -0.0000000f, +0.0183288f, -0.0000000f, -0.0000000f, +0.1833652f,
  +0.1455076f, -0.2132364f, +0.0391267f, +0.0000000f, +0.2297604f, +0.0000000f, +0.0000000f, +0.0420980f,
  -0.2375792f, -0.3860486f, +0.0457739f, -0.0000000f, -0.2915434f, +0.0000000f, -0.0000000f, +0.0027749f,
  -0.2032617f, -0.1397929f, -0.1323472f, -0.0000000f, -0.1001769f, +0.0000000f, +0.0000000f, +0.0190790f,
  +0.0150760f, -0.0139898f, -0.2651726f, +0.0000000f, +0.0658734f, +0.0000000f, -0.0000000f, +0.0372902f,
  +0.0535165f, +0.0310995f, -0.0477465f, +0.0000000f, +0.0377615f, +0.0000000f, -0.0000000f, +0.0321201f,
  +0.0150667f, -0.0116537f, -0.0712242f, +0.0000000f, -0.0136493f, +0.0000000f, -0.0000000f, +0.0334758f,
  -0.0780718f, -0.0085937f, -0.3642807f, +0.0000000f, +0.4584874f, +0.0000000f, -0.0000000f, -0.0853368f,
  -0.4752151f, -0.3957673f, -0.1797247f, -0.0000000f, +0.2485392f, +0.0000000f, -0.0000000f, +0.5264894f,
  +0.0774551f, +0.1834798f, -0.0353068f, -0.0000000f, +0.0491004f, -0.0000000f, -0.0000000f, -0.0763271f,
  +0.4534748f, -0.1485250f, -0.2308640f, +0.0000000f, +0.2526480f, +0.0000000f, -0.0000000f, -0.2159153f,
  -0.0913014f, +0.3204180f, -0.0398763f, +0.0000000f, +0.2600688f, +0.0000000f, -0.0000000f, +0.1052372f,
  +0.1576174f, +0.0173368f, -0.0515498f, -0.0000000f, -0.0408625f, -0.0000000f, -0.0000000f, +0.0221374f,
  +0.3554011f, -0.0389278f, +0.1159468f, +0.0000000f, -0.0734646f, -0.0000000f, +0.0000000f, -0.1512056f,
  -0.3164976f, -0.4993270f, -0.5876889f, +0.0000000f, +0.2763709f, +0.0000000f, -0.0000000f, +0.3667162f,
  +0.0866000f, +0.1768890f, -0.1393381f, -0.0000000f, +0.0820749f, +0.0000000f, -0.0000000f, +0.0085771f,
  -0.3170233f, +0.1363882f, -0.0807919f, +0.0000000f, -0.0191185f, +0.0000000f, -0.0000000f, -0.0039287f,
  +0.1544807f, +0.0974852f, +0.0279108f, -0.0000000f, +0.3073789f, -0.0000000f, -0.0000000f, +0.0861272f,
  +0.2579618f, +0.1619732f, -0.0576096f, -0.0000000f, -0.0760348f, -0.0000000f, -0.0000000f, -0.0409509f,
  +0.0122728f, -0.0528300f, -0.0283858f, +0.0000000f, +0.0934790f, -0.0000000f, -0.0000000f, -0.0162789f,
  +0.0172420f, +0.0430754f, +0.0126873f, +0.0000000f, -0.0517089f, +0.0000000f, +0.0000000f, -0.0463664f,
  +0.0602543f, -0.0558402f, +0.0075304f, -0.0000000f, -0.0206122f, -0.0000000f, -0.0000000f, +0.0046224f,
  -0.0282547f, +0.0383303f, +0.0432427f, +0.0000000f, +0.0639046f, -0.0000000f, +0.0000000f, -0.0554027f,
  -0.1724747f, +0.1184960f, +0.0881683f, -0.0000000f, +0.1046083f, +0.0000000f, -0.0000000f, -0.2846034f,
  -0.0183653f, -0.0160135f, +0.0819836f, +0.0000000f, +0.0387485f, +0.0000000f, -0.0000000f, +0.0364362f,
  -0.0626263f, +0.0682545f, +0.2081040f, -0.0000000f, -0.2286880f, -0.0000000f, -0.0000000f, +0.0224200f,
  +0.3911295f, -0.0748051f, -0.2365934f, -0.0000000f, -0.4808186f, +0.0000000f, +0.0000000f, +0.5573228f,
  -0.0914902f, -0.0606565f, -0.1436737f, -0.0000000f, -0.0998197f, -0.0000000f, -0.0000000f, -0.0783606f,
  +0.0699782f, -0.0323633f, -0.1323290f, +0.0000000f, +0.0801673f, +0.0000000f, +0.0000000f, -0.0679305f,
  -0.0242991f, -0.1447119f, -0.0269755f, -0.0000000f, +0.2110516f, +0.0000000f, -0.0000000f, -0.0978268f,
  +0.2199962f, +0.0757190f, +0.0116345f, +0.0000000f, +0.0100962f, -0.0000000f, -0.0000000f, +0.0136523f
);

const float biases[4] = float[4](
  +0.0931961f, -0.0027806f, +0.0044988f, -0.0018777f
);

vec4 hook() {
    const vec4 r[9][2] = vec4[9][2](
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 1.0f)))
    );

    float sum[4] = biases;
    for (int n = 0; n < 4; n++) {
        for (int i = 0; i < 9; i++) {
            const vec4 k0 = vec4(kernels[n * 8 * 9 + 8 * i + 0], kernels[n * 8 * 9 + 8 * i + 1], kernels[n * 8 * 9 + 8 * i + 2], kernels[n * 8 * 9 + 8 * i + 3]);
            const vec4 k1 = vec4(kernels[n * 8 * 9 + 8 * i + 4], kernels[n * 8 * 9 + 8 * i + 5], kernels[n * 8 * 9 + 8 * i + 6], kernels[n * 8 * 9 + 8 * i + 7]);
            sum[n] += (dot(k0, r[i][0]) + dot(k1, r[i][1]));
        }
    }

    return ACTIVE(vec4(sum[0], sum[1], sum[2], sum[3]));
}

//!HOOK LUMA
//!DESC ACNet Layer8 L0
//!WHEN OUTPUT.w LUMA.w / 1.2 > OUTPUT.h LUMA.h / 1.2 > *
//!BIND TMP2_L0
//!BIND TMP2_L1
//!SAVE TMP1_L0
//!COMPONENTS 4

#define ACTIVE(v) (max(v, 0.0f))

#define TEX_BIND_L0_TEXOFF TMP2_L0_texOff
#define TEX_BIND_L0_TEX TMP2_L0_tex
#define TEX_BIND_L0_POS TMP2_L0_pos
#define TEX_BIND_L0_SIZE TMP2_L0_size
#define TEX_BIND_L0_PT TMP2_L0_pt

#define TEX_BIND_L1_TEXOFF TMP2_L1_texOff
#define TEX_BIND_L1_TEX TMP2_L1_tex
#define TEX_BIND_L1_POS TMP2_L1_pos
#define TEX_BIND_L1_SIZE TMP2_L1_size
#define TEX_BIND_L1_PT TMP2_L1_pt

const float kernels[288] = float[288](
  -0.0000000f, -0.0106070f, -0.0206653f, +0.0000000f, +0.0273211f, -0.0078892f, +0.0076313f, -0.1780614f,
  -0.0000000f, -0.0963171f, -0.0248380f, +0.0000000f, +0.0348037f, +0.3024901f, -0.0125795f, +0.0692503f,
  +0.0000000f, +0.0004295f, -0.0203614f, +0.0000000f, -0.0450048f, -0.0088229f, +0.0101844f, +0.0045235f,
  +0.0000000f, +0.0151853f, +0.0265829f, -0.0000000f, -0.1306524f, +0.0183758f, +0.0065976f, -0.0981923f,
  +0.0000000f, -0.1115723f, +0.0735175f, -0.0000000f, -0.4469171f, -0.2258105f, +0.2198834f, -0.0568236f,
  +0.0000000f, +0.0570980f, +0.0152336f, +0.0000000f, -0.1146234f, +0.0818770f, +0.0327009f, +0.0084228f,
  -0.0000000f, +0.0071224f, -0.0179232f, -0.0000000f, -0.0414938f, -0.0374981f, +0.0173364f, +0.0141961f,
  -0.0000000f, +0.1928148f, -0.0432287f, -0.0000000f, +0.0180284f, -0.0017439f, -0.4328848f, +0.0120499f,
  -0.0000000f, +0.0452463f, +0.0103303f, +0.0000000f, -0.0219047f, -0.0395542f, -0.0638940f, -0.0189145f,
  -0.0000000f, -0.0185234f, -0.0137612f, +0.0000000f, -0.0507440f, +0.0218518f, -0.0078927f, +0.0065076f,
  -0.0000000f, -0.0365440f, -0.0481269f, -0.0000000f, -0.0724520f, +0.1092655f, -0.0057505f, +0.1463114f,
  -0.0000000f, -0.0156691f, -0.0185233f, -0.0000000f, -0.0124182f, +0.0379480f, +0.0087853f, +0.0071750f,
  +0.0000000f, +0.0068923f, +0.0771459f, -0.0000000f, -0.0264604f, -0.0089774f, +0.0186635f, +0.0186971f,
  -0.0000000f, +0.1605100f, +0.0365598f, +0.0000000f, -0.1472847f, -0.3650033f, +0.0907227f, +0.3469578f,
  +0.0000000f, +0.9905822f, -0.0020216f, +0.0000000f, -0.0345449f, +0.0615197f, -0.0361668f, -0.0014663f,
  +0.0000000f, +0.0008206f, +0.0547115f, -0.0000000f, -0.0085150f, +0.0005746f, +0.0846143f, -0.0302977f,
  +0.0000000f, +0.2182224f, +0.1039191f, +0.0000000f, -0.0047485f, +0.0049574f, +0.0435504f, -0.0068989f,
  -0.0000000f, -0.1143923f, +0.0198283f, +0.0000000f, -0.0104233f, +0.0168911f, -0.0877152f, -0.0071882f,
  -0.0000000f, +0.0123428f, -0.0999088f, +0.0000000f, +0.0415782f, -0.0621804f, +0.0244323f, +0.0128878f,
  +0.0000000f, -0.3218372f, -0.0203346f, +0.0000000f, -0.3760552f, +0.6468325f, -0.0320122f, +0.4350324f,
  +0.0000000f, -0.0273837f, -0.0296667f, +0.0000000f, -0.0742441f, -0.0695730f, +0.0223651f, -0.0425859f,
  +0.0000000f, +0.0105620f, -0.0649482f, -0.0000000f, -0.0016648f, -0.0233039f, -0.1135799f, +0.0539879f,
  +0.0000000f, -0.2020693f, +0.1542337f, +0.0000000f, -0.0246054f, +0.0491552f, +0.2918806f, +0.1136910f,
  -0.0000000f, +0.1833503f, +0.1256997f, -0.0000000f, +0.0217488f, -0.2596025f, +0.0631447f, +0.0138629f,
  +0.0000000f, -0.0013577f, +0.0022942f, +0.0000000f, +0.0034487f, -0.0121391f, -0.0463967f, +0.0106956f,
  -0.0000000f, -0.0271195f, +0.1136120f, +0.0000000f, -0.0837164f, +0.0444491f, +0.3425813f, -0.0576405f,
  -0.0000000f, -0.0327884f, +0.0090614f, -0.0000000f, -0.0037365f, -0.0310166f, +0.1318626f, +0.0051203f,
  +0.0000000f, -0.0107635f, +0.0303160f, -0.0000000f, -0.0568651f, +0.0454205f, +0.0116191f, -0.0718386f,
  -0.0000000f, -0.0231907f, +0.0207543f, +0.0000000f, -0.3900597f, -0.0362006f, -0.0247785f, -0.1393373f,
  -0.0000000f, -0.0634618f, -0.0029886f, +0.0000000f, -0.1469634f, +0.1250480f, +0.0109468f, +0.0193442f,
  +0.0000000f, -0.0054365f, +0.0803200f, -0.0000000f, +0.0459661f, -0.0078441f, +0.0350362f, -0.0131601f,
  -0.0000000f, +0.1905630f, +0.7837353f, -0.0000000f, -0.2935295f, -0.0919792f, +0.1521956f, +0.2414147f,
  -0.0000000f, -0.1594338f, +0.1199012f, -0.0000000f, -0.0574237f, -0.0449170f, -0.0426819f, -0.0146121f,
  -0.0000000f, -0.0079391f, +0.0240862f, +0.0000000f, -0.0020147f, +0.0003713f, +0.0077194f, -0.0228939f,
  -0.0000000f, +0.0521340f, +0.1672003f, +0.0000000f, -0.0509255f, +0.0017158f, -0.2531635f, -0.0219858f,
  +0.0000000f, +0.0066605f, +0.0282145f, -0.0000000f, +0.0131062f, -0.0099804f, +0.0137708f, -0.0092815f
);

const float biases[4] = float[4](
  -0.0032071f, +0.0067015f, -0.0013350f, +0.0513783f
);

vec4 hook() {
    const vec4 r[9][2] = vec4[9][2](
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 1.0f)))
    );

    float sum[4] = biases;
    for (int n = 0; n < 4; n++) {
        for (int i = 0; i < 9; i++) {
            const vec4 k0 = vec4(kernels[n * 8 * 9 + 8 * i + 0], kernels[n * 8 * 9 + 8 * i + 1], kernels[n * 8 * 9 + 8 * i + 2], kernels[n * 8 * 9 + 8 * i + 3]);
            const vec4 k1 = vec4(kernels[n * 8 * 9 + 8 * i + 4], kernels[n * 8 * 9 + 8 * i + 5], kernels[n * 8 * 9 + 8 * i + 6], kernels[n * 8 * 9 + 8 * i + 7]);
            sum[n] += (dot(k0, r[i][0]) + dot(k1, r[i][1]));
        }
    }

    return ACTIVE(vec4(sum[0], sum[1], sum[2], sum[3]));
}

//!HOOK LUMA
//!DESC ACNet Layer8 L1
//!WHEN OUTPUT.w LUMA.w / 1.2 > OUTPUT.h LUMA.h / 1.2 > *
//!BIND TMP2_L0
//!BIND TMP2_L1
//!SAVE TMP1_L1
//!COMPONENTS 4

#define ACTIVE(v) (max(v, 0.0f))

#define TEX_BIND_L0_TEXOFF TMP2_L0_texOff
#define TEX_BIND_L0_TEX TMP2_L0_tex
#define TEX_BIND_L0_POS TMP2_L0_pos
#define TEX_BIND_L0_SIZE TMP2_L0_size
#define TEX_BIND_L0_PT TMP2_L0_pt

#define TEX_BIND_L1_TEXOFF TMP2_L1_texOff
#define TEX_BIND_L1_TEX TMP2_L1_tex
#define TEX_BIND_L1_POS TMP2_L1_pos
#define TEX_BIND_L1_SIZE TMP2_L1_size
#define TEX_BIND_L1_PT TMP2_L1_pt

const float kernels[288] = float[288](
  -0.0000000f, +0.0105365f, -0.0000672f, -0.0000000f, +0.0014363f, -0.0424187f, -0.0228136f, +0.0224861f,
  +0.0000000f, +0.0575371f, +0.0097550f, -0.0000000f, -0.1480066f, -0.0339926f, +0.0169774f, +0.0398975f,
  -0.0000000f, -0.0311495f, +0.0000536f, +0.0000000f, -0.0371767f, -0.0467813f, -0.0382523f, +0.0206038f,
  -0.0000000f, -0.0063997f, +0.0264059f, -0.0000000f, -0.1026633f, +0.0519918f, -0.0020140f, -0.0214065f,
  +0.0000000f, -0.0311654f, +0.1341912f, +0.0000000f, +0.1815944f, -0.1346770f, -0.0391536f, -0.4098420f,
  -0.0000000f, +0.2496646f, -0.0445655f, +0.0000000f, -0.0131089f, +0.4420322f, +0.0412618f, +0.0932939f,
  -0.0000000f, -0.0141974f, +0.0095580f, +0.0000000f, -0.0025071f, -0.0096408f, +0.0026797f, +0.0280950f,
  +0.0000000f, +0.1188931f, -0.1900817f, -0.0000000f, -0.0008184f, -0.0562309f, +0.4703322f, +0.0177292f,
  +0.0000000f, -0.1243951f, +0.0499901f, -0.0000000f, -0.0344280f, -0.0450894f, -0.3071448f, -0.0141268f,
  +0.0000000f, +0.0010820f, +0.0522404f, +0.0000000f, -0.0958758f, +0.0307747f, -0.0175619f, -0.1983150f,
  -0.0000000f, +0.1871839f, -0.0298409f, -0.0000000f, -0.1017411f, -0.3231322f, +0.0106662f, -0.1995137f,
  +0.0000000f, +0.0140501f, +0.0110641f, +0.0000000f, -0.1235396f, +0.0489949f, -0.0044955f, +0.0521337f,
  +0.0000000f, -0.0019068f, -0.1329653f, -0.0000000f, -0.0711081f, -0.0221933f, +0.0577372f, +0.0809956f,
  -0.0000000f, -0.3191257f, +0.1258787f, +0.0000000f, -0.0380118f, -0.1689040f, -0.0285545f, +0.0561003f,
  -0.0000000f, -0.1955946f, -0.0643586f, -0.0000000f, -0.0507418f, +0.2365570f, -0.0071742f, +0.0028268f,
  -0.0000000f, +0.0213077f, +0.0401104f, +0.0000000f, -0.0115733f, +0.0097140f, +0.0127738f, -0.0121436f,
  +0.0000000f, +0.0648376f, -0.0136586f, +0.0000000f, +0.0372720f, -0.0305575f, -0.3079115f, +0.0172596f,
  -0.0000000f, +0.0192412f, +0.0168595f, -0.0000000f, +0.0033230f, +0.0181929f, -0.1288376f, -0.0084120f,
  +0.0000000f, -0.0185543f, +0.0132137f, -0.0000000f, +0.0411563f, +0.0041634f, -0.0205281f, +0.0464993f,
  +0.0000000f, +0.0470043f, +0.0008811f, -0.0000000f, -0.1398568f, -0.1658223f, +0.0015299f, +0.2171286f,
  -0.0000000f, -0.0023941f, -0.0053635f, -0.0000000f, +0.0048381f, +0.0562786f, -0.0269873f, -0.0045573f,
  -0.0000000f, +0.0169671f, -0.0473172f, +0.0000000f, -0.0457130f, -0.0333856f, +0.0011869f, -0.0710948f,
  -0.0000000f, -0.0951123f, +0.1347586f, +0.0000000f, +0.0858791f, +0.5617145f, +0.1035858f, -0.2888607f,
  +0.0000000f, +0.3497876f, +0.0319620f, +0.0000000f, +0.0171412f, -0.0087440f, -0.0798677f, +0.0153526f,
  +0.0000000f, -0.0199358f, -0.0208221f, -0.0000000f, +0.0032864f, +0.0192588f, -0.0827100f, +0.0074945f,
  +0.0000000f, -0.1896425f, -0.0976736f, -0.0000000f, -0.0257124f, -0.0468881f, +0.1842825f, +0.0229433f,
  +0.0000000f, +0.0199220f, -0.0124925f, -0.0000000f, +0.0067627f, -0.0239867f, +0.0031084f, -0.0123068f,
  +0.0000000f, +0.0025407f, -0.0233941f, +0.0000000f, -0.0363240f, +0.0114539f, -0.0009410f, +0.0897739f,
  +0.0000000f, -0.0841419f, +0.0181360f, -0.0000000f, -0.1932969f, +0.1691733f, +0.0042319f, +0.3361055f,
  +0.0000000f, +0.0011122f, +0.0064961f, +0.0000000f, -0.0217248f, -0.0332303f, +0.0030978f, +0.0215616f,
  +0.0000000f, -0.0110975f, +0.0208071f, -0.0000000f, +0.0092209f, -0.0100299f, -0.0339359f, +0.0400105f,
  +0.0000000f, +0.0245682f, +0.1731348f, +0.0000000f, +0.0697009f, -0.1196076f, +0.2178029f, -0.2747172f,
  +0.0000000f, -0.5387310f, +0.0217784f, +0.0000000f, -0.0635798f, -0.0057342f, +0.0280349f, +0.0611027f,
  -0.0000000f, +0.0106576f, +0.0321737f, -0.0000000f, -0.0008648f, -0.0134097f, +0.0481013f, -0.0033494f,
  -0.0000000f, +0.1167919f, -0.0793075f, -0.0000000f, -0.0569867f, -0.0018761f, +0.2795755f, +0.0160946f,
  +0.0000000f, +0.0010578f, -0.0104586f, +0.0000000f, +0.0045381f, +0.0073257f, -0.0452799f, +0.0092700f
);

const float biases[4] = float[4](
  +0.0011369f, +0.0066635f, -0.0032068f, +0.0006798f
);

vec4 hook() {
    const vec4 r[9][2] = vec4[9][2](
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 1.0f)))
    );

    float sum[4] = biases;
    for (int n = 0; n < 4; n++) {
        for (int i = 0; i < 9; i++) {
            const vec4 k0 = vec4(kernels[n * 8 * 9 + 8 * i + 0], kernels[n * 8 * 9 + 8 * i + 1], kernels[n * 8 * 9 + 8 * i + 2], kernels[n * 8 * 9 + 8 * i + 3]);
            const vec4 k1 = vec4(kernels[n * 8 * 9 + 8 * i + 4], kernels[n * 8 * 9 + 8 * i + 5], kernels[n * 8 * 9 + 8 * i + 6], kernels[n * 8 * 9 + 8 * i + 7]);
            sum[n] += (dot(k0, r[i][0]) + dot(k1, r[i][1]));
        }
    }

    return ACTIVE(vec4(sum[0], sum[1], sum[2], sum[3]));
}

//!HOOK LUMA
//!DESC ACNet Layer9 L0
//!WIDTH LUMA.w 2 *
//!HEIGHT LUMA.h 2 *
//!BIND TMP1_L0
//!BIND TMP1_L1
//!COMPONENTS 1

#define ACTIVE(v) (max(v, 0.0f))

#define TEX_BIND_L0_TEXOFF TMP1_L0_texOff
#define TEX_BIND_L0_TEX TMP1_L0_tex
#define TEX_BIND_L0_POS TMP1_L0_pos
#define TEX_BIND_L0_SIZE TMP1_L0_size
#define TEX_BIND_L0_PT TMP1_L0_pt

#define TEX_BIND_L1_TEXOFF TMP1_L1_texOff
#define TEX_BIND_L1_TEX TMP1_L1_tex
#define TEX_BIND_L1_POS TMP1_L1_pos
#define TEX_BIND_L1_SIZE TMP1_L1_size
#define TEX_BIND_L1_PT TMP1_L1_pt

const float kernels[32] = float[32](
  +0.4850889f, +0.0086111f, -0.2866911f, +0.3345127f, +0.1866145f, -0.3698996f, +0.1966396f, -0.0772036f,
  +0.0030601f, -0.3180580f, +0.0941340f, +0.2844653f, +0.1389778f, +0.1830711f, +0.1273153f, +0.2750769f,
  -0.1734543f, +0.2939309f, +0.0109096f, +0.2237730f, +0.2915245f, -0.0518386f, -0.5716754f, +0.0499312f,
  -0.1945134f, +0.0406567f, +0.2294908f, +0.2619063f, -0.7425680f, +0.2683021f, +0.2429726f, -0.1904126f
);

vec4 hook() {
    vec2 fcoord = fract(TEX_BIND_L0_POS * TEX_BIND_L0_SIZE);
    vec2 pos = TEX_BIND_L0_POS + (vec2(0.5f) - fcoord) * TEX_BIND_L0_PT;

    ivec2 icoord = ivec2(fcoord * vec2(2.0f));
    int index = icoord.y * 2 + icoord.x;

    vec4 r0 = TEX_BIND_L0_TEX(pos);
    vec4 r1 = TEX_BIND_L1_TEX(pos);

    vec4 k0 = vec4(kernels[8 * index + 0], kernels[8 * index + 1], kernels[8 * index + 2], kernels[8 * index + 3]);
    vec4 k1 = vec4(kernels[8 * index + 4], kernels[8 * index + 5], kernels[8 * index + 6], kernels[8 * index + 7]);

    return vec4(clamp(dot(r0, k0) + dot(r1, k1), 0.0f, 1.0f), 0.0f, 0.0f, 1.0f);
}
