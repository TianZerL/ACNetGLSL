//!HOOK LUMA
//!DESC ARNet b16 Layer0 L0
//!WHEN OUTPUT.w LUMA.w / 1.2 > OUTPUT.h LUMA.h / 1.2 > *
//!BIND LUMA
//!SAVE FEAT_L0
//!COMPONENTS 4

#define ACTIVE(v) (v)

#define TEX_BIND_L0_TEXOFF LUMA_texOff
#define TEX_BIND_L0_TEX LUMA_tex
#define TEX_BIND_L0_POS LUMA_pos
#define TEX_BIND_L0_SIZE LUMA_size
#define TEX_BIND_L0_PT LUMA_pt

const float kernels[36] = float[36](
  +0.3641446f, -0.8036978f, -0.0791923f, -0.3311754f, +0.0260572f, +0.5838839f, +0.4305308f, +0.2320984f,
  -0.3247811f, -0.7041417f, +0.3486182f, +0.4674401f, -0.5970983f, -0.1446970f, +0.1504158f, +0.2025110f,
  +0.0625754f, +0.8050008f, -0.0955542f, +0.3272168f, +0.1802481f, +0.3516432f, -0.5291985f, +0.2445685f,
  -0.3580487f, -0.1593373f, +0.0147277f, -0.5324848f, +0.2873729f, +0.5245063f, +0.0668208f, -0.1695386f,
  -0.3294556f, -0.5591077f, -0.5543819f, +0.8744119f
);

const float biases[4] = float[4](
  -0.0335362f, -0.0261780f, +0.0237420f, +0.0968628f
);

vec4 hook() {
    const vec4 r0 = vec4(
        TEX_BIND_L0_TEXOFF(vec2(-1.0f,-1.0f)).x,
        TEX_BIND_L0_TEXOFF(vec2( 0.0f,-1.0f)).x,
        TEX_BIND_L0_TEXOFF(vec2( 1.0f,-1.0f)).x,
        TEX_BIND_L0_TEXOFF(vec2(-1.0f, 0.0f)).x
    );
    const vec4 r4 = vec4(
        TEX_BIND_L0_TEXOFF(vec2( 0.0f, 0.0f)).x,
        TEX_BIND_L0_TEXOFF(vec2( 1.0f, 0.0f)).x,
        TEX_BIND_L0_TEXOFF(vec2(-1.0f, 1.0f)).x,
        TEX_BIND_L0_TEXOFF(vec2( 0.0f, 1.0f)).x
    );
    const float r8 = TEX_BIND_L0_TEXOFF(vec2( 1.0f, 1.0f)).x;

    float sum[4] = biases;
    for(int n = 0; n < 4; n++) {
        const vec4 k0 = vec4(kernels[n * 9 + 0], kernels[n * 9 + 1], kernels[n * 9 + 2], kernels[n * 9 + 3]);
        const vec4 k4 = vec4(kernels[n * 9 + 4], kernels[n * 9 + 5], kernels[n * 9 + 6], kernels[n * 9 + 7]);
        const float k8 = kernels[n * 9 + 8];
        sum[n] += (dot(r0, k0) + dot(r4, k4) + r8 * k8);
    }

    return ACTIVE(vec4(sum[0], sum[1], sum[2], sum[3]));
}

//!HOOK LUMA
//!DESC ARNet b16 Layer0 L1
//!WHEN OUTPUT.w LUMA.w / 1.2 > OUTPUT.h LUMA.h / 1.2 > *
//!BIND LUMA
//!SAVE FEAT_L1
//!COMPONENTS 4

#define ACTIVE(v) (v)

#define TEX_BIND_L0_TEXOFF LUMA_texOff
#define TEX_BIND_L0_TEX LUMA_tex
#define TEX_BIND_L0_POS LUMA_pos
#define TEX_BIND_L0_SIZE LUMA_size
#define TEX_BIND_L0_PT LUMA_pt

const float kernels[36] = float[36](
  -0.3126816f, +0.1006549f, +0.2752566f, -0.0290872f, -0.2936013f, -0.3408356f, -0.1632276f, +0.2737245f,
  -0.3046267f, +0.1131421f, -0.0682896f, -0.2054629f, -0.1342881f, -0.2152949f, -0.1397503f, +0.5956080f,
  -0.0236938f, +0.1835324f, +0.5464876f, -0.4879446f, -0.3033468f, +0.4682305f, +1.0967991f, +0.1273564f,
  +0.3086813f, -0.4680663f, -0.5593073f, -0.0516256f, -0.1516122f, +0.0002692f, -0.1703534f, +0.6022203f,
  -0.0375880f, +0.1209189f, +0.1750063f, -0.5490575f
);

const float biases[4] = float[4](
  +0.0486418f, +0.0227775f, -0.0276538f, +0.0350976f
);

vec4 hook() {
    const vec4 r0 = vec4(
        TEX_BIND_L0_TEXOFF(vec2(-1.0f,-1.0f)).x,
        TEX_BIND_L0_TEXOFF(vec2( 0.0f,-1.0f)).x,
        TEX_BIND_L0_TEXOFF(vec2( 1.0f,-1.0f)).x,
        TEX_BIND_L0_TEXOFF(vec2(-1.0f, 0.0f)).x
    );
    const vec4 r4 = vec4(
        TEX_BIND_L0_TEXOFF(vec2( 0.0f, 0.0f)).x,
        TEX_BIND_L0_TEXOFF(vec2( 1.0f, 0.0f)).x,
        TEX_BIND_L0_TEXOFF(vec2(-1.0f, 1.0f)).x,
        TEX_BIND_L0_TEXOFF(vec2( 0.0f, 1.0f)).x
    );
    const float r8 = TEX_BIND_L0_TEXOFF(vec2( 1.0f, 1.0f)).x;

    float sum[4] = biases;
    for(int n = 0; n < 4; n++) {
        const vec4 k0 = vec4(kernels[n * 9 + 0], kernels[n * 9 + 1], kernels[n * 9 + 2], kernels[n * 9 + 3]);
        const vec4 k4 = vec4(kernels[n * 9 + 4], kernels[n * 9 + 5], kernels[n * 9 + 6], kernels[n * 9 + 7]);
        const float k8 = kernels[n * 9 + 8];
        sum[n] += (dot(r0, k0) + dot(r4, k4) + r8 * k8);
    }

    return ACTIVE(vec4(sum[0], sum[1], sum[2], sum[3]));
}

//!HOOK LUMA
//!DESC ARNet b16 Layer1 L0
//!WHEN OUTPUT.w LUMA.w / 1.2 > OUTPUT.h LUMA.h / 1.2 > *
//!BIND FEAT_L0
//!BIND FEAT_L1
//!SAVE TMP1_L0
//!COMPONENTS 4

#define ACTIVE(v) (max(v, v * 0.2000000f))

#define TEX_BIND_L0_TEXOFF FEAT_L0_texOff
#define TEX_BIND_L0_TEX FEAT_L0_tex
#define TEX_BIND_L0_POS FEAT_L0_pos
#define TEX_BIND_L0_SIZE FEAT_L0_size
#define TEX_BIND_L0_PT FEAT_L0_pt

#define TEX_BIND_L1_TEXOFF FEAT_L1_texOff
#define TEX_BIND_L1_TEX FEAT_L1_tex
#define TEX_BIND_L1_POS FEAT_L1_pos
#define TEX_BIND_L1_SIZE FEAT_L1_size
#define TEX_BIND_L1_PT FEAT_L1_pt

const float kernels[288] = float[288](
  -0.1117611f, +0.0497371f, -0.4533333f, +0.0680916f, -0.0839216f, -0.4747832f, +0.0898977f, +0.7593147f,
  +0.0255315f, -0.0716143f, -0.1218453f, +0.1382767f, +0.1206582f, -0.0712184f, +0.1166939f, -0.4620023f,
  +0.0655020f, -0.1567032f, +0.2669954f, -0.1760048f, -0.0244460f, -0.4222563f, -0.1941157f, -0.2270366f,
  -0.4005122f, -0.2677913f, -0.1759320f, -0.0098492f, -0.2058844f, +0.0387271f, -0.0311898f, +0.2453205f,
  -0.1201554f, -0.1426803f, +0.6150652f, -0.0200299f, +0.0411463f, +0.1610703f, -0.1052585f, -0.4292247f,
  -0.0258568f, -0.0168428f, -0.2442185f, -0.2163622f, +0.0922423f, +0.2462081f, -0.0856327f, -0.0671711f,
  +0.2143882f, +0.2031612f, -0.0859260f, +0.3505938f, -0.2200299f, -0.1792076f, +0.3295665f, +0.2540830f,
  +0.7343073f, -0.2910653f, -0.1222259f, +0.0646598f, -0.2263589f, +0.2489399f, +0.2652099f, -0.4807757f,
  +0.1081153f, +0.0974839f, +0.1740125f, +0.0069983f, +0.0963068f, -0.2960290f, -0.2416905f, -0.0200176f,
  +0.2147689f, +0.1670365f, -0.2360446f, +0.0795679f, -0.0312005f, -0.2865815f, +0.1108292f, -0.7029471f,
  -0.4068326f, -0.1553506f, -0.6859486f, -0.1571745f, -0.1941785f, -0.3698871f, +0.1939807f, -0.4900218f,
  +0.1213821f, +0.1658632f, -0.0106672f, -0.1379404f, +0.0669045f, -0.1688994f, -0.2338210f, -0.0453533f,
  +0.1500443f, +0.1598291f, +0.7937480f, +0.1112748f, -0.0837600f, -0.1254748f, +0.1590972f, +0.3525434f,
  -0.5843797f, -0.3957216f, +0.2538501f, +0.2912461f, -0.1575488f, -0.8154575f, +0.5374278f, -0.0450471f,
  -0.3015049f, -0.1923276f, +0.0800797f, +0.0528499f, -0.1029946f, -0.2241754f, +0.3833562f, -0.0772095f,
  +0.0177665f, -0.0446010f, +0.1740640f, -0.1512309f, +0.2934816f, +0.4931729f, -0.0718079f, -0.1044944f,
  -0.1161562f, +0.2279441f, +0.6030838f, +0.0570260f, +0.3509236f, +0.3098672f, -0.2755837f, -0.2776143f,
  +0.0423178f, -0.2689826f, +0.1135445f, +0.3164251f, -0.1034290f, -0.3321041f, +0.0677725f, -0.1455352f,
  -0.2596866f, -0.1300575f, -0.1299880f, -0.2167987f, +0.1582423f, -0.4096043f, +0.1207661f, +0.9564242f,
  -0.2731767f, -0.1765508f, +0.2428367f, +0.3218119f, +0.1722542f, -0.5557659f, +0.6397746f, +0.3103420f,
  +0.0233657f, +0.0561650f, +0.3132127f, -0.0274819f, -0.0244581f, -0.5232596f, +0.5687244f, -0.4820256f,
  -0.2540736f, +0.2280049f, -0.2025038f, -0.2963508f, +0.1762197f, +0.1066371f, -0.0783039f, +0.2394039f,
  -0.0011365f, +0.0942820f, +0.2967010f, +0.0752443f, -0.0911679f, +0.0606104f, -0.1974591f, -0.5163309f,
  +0.0638812f, -0.2088908f, -0.3917204f, -0.1088441f, -0.1135546f, +0.0311993f, +0.2599695f, -0.3508252f,
  -0.0107690f, -0.0644510f, +0.0445643f, +0.0984106f, -0.0813347f, +0.1588048f, -0.0394073f, +0.5350828f,
  +0.0575985f, +0.0155148f, +0.0519022f, +0.0094271f, +0.1396838f, +0.0296554f, -0.2677083f, -0.1339817f,
  +0.1484238f, -0.0815497f, +0.2831165f, +0.1539273f, +0.0352469f, +0.0665207f, +0.0392613f, -0.1286237f,
  +0.0181273f, -0.1408851f, +0.1585185f, -0.0827431f, +0.2203869f, -0.0208031f, +0.1143934f, +0.0850373f,
  -0.0474829f, -0.1610679f, +0.1455075f, +0.3706422f, -0.1652131f, +0.0862636f, -0.1218035f, -0.7546829f,
  +0.3407008f, +0.3203837f, -0.3858258f, -0.0333546f, +0.1397076f, -0.1319698f, -0.1742897f, +0.3869680f,
  -0.1675781f, +0.0622459f, -0.1160666f, +0.1485948f, +0.0451827f, -0.0404415f, -0.0664693f, +0.2987877f,
  +0.4142017f, +0.0655433f, +0.9039233f, +0.0630621f, -0.0925834f, -0.1938546f, -0.1934483f, -0.5725452f,
  +0.0238455f, +0.0552444f, -0.2760638f, -0.2316198f, -0.1110553f, -0.6235749f, -0.0475093f, +0.6529343f,
  +0.1830796f, -0.0567197f, -0.0734926f, +0.2784793f, -0.1739694f, +0.1067006f, +0.2104506f, -0.1517409f,
  +0.7114930f, +0.1794064f, +0.5320268f, -0.1490407f, +0.3226279f, +0.2713229f, +0.0525280f, +0.1236587f,
  -0.1524095f, +0.4508843f, -0.3180123f, +0.2639916f, -0.0951320f, -0.4306194f, +0.1901136f, +0.7255561f
);

const float biases[4] = float[4](
  +0.0781117f, +0.0284437f, +0.1004649f, +0.0252395f
);

vec4 hook() {
    const vec4 r[9][2] = vec4[9][2](
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 1.0f)))
    );

    float sum[4] = biases;
    for (int n = 0; n < 4; n++) {
        for (int i = 0; i < 9; i++) {
            const vec4 k0 = vec4(kernels[n * 8 * 9 + 8 * i + 0], kernels[n * 8 * 9 + 8 * i + 1], kernels[n * 8 * 9 + 8 * i + 2], kernels[n * 8 * 9 + 8 * i + 3]);
            const vec4 k1 = vec4(kernels[n * 8 * 9 + 8 * i + 4], kernels[n * 8 * 9 + 8 * i + 5], kernels[n * 8 * 9 + 8 * i + 6], kernels[n * 8 * 9 + 8 * i + 7]);
            sum[n] += (dot(k0, r[i][0]) + dot(k1, r[i][1]));
        }
    }

    return ACTIVE(vec4(sum[0], sum[1], sum[2], sum[3]));
}

//!HOOK LUMA
//!DESC ARNet b16 Layer1 L1
//!WHEN OUTPUT.w LUMA.w / 1.2 > OUTPUT.h LUMA.h / 1.2 > *
//!BIND FEAT_L0
//!BIND FEAT_L1
//!SAVE TMP1_L1
//!COMPONENTS 4

#define ACTIVE(v) (max(v, v * 0.2000000f))

#define TEX_BIND_L0_TEXOFF FEAT_L0_texOff
#define TEX_BIND_L0_TEX FEAT_L0_tex
#define TEX_BIND_L0_POS FEAT_L0_pos
#define TEX_BIND_L0_SIZE FEAT_L0_size
#define TEX_BIND_L0_PT FEAT_L0_pt

#define TEX_BIND_L1_TEXOFF FEAT_L1_texOff
#define TEX_BIND_L1_TEX FEAT_L1_tex
#define TEX_BIND_L1_POS FEAT_L1_pos
#define TEX_BIND_L1_SIZE FEAT_L1_size
#define TEX_BIND_L1_PT FEAT_L1_pt

const float kernels[288] = float[288](
  +0.5444479f, +0.0458977f, +0.0233379f, +0.2307728f, +0.3925077f, +0.0018510f, +0.3816607f, -0.0236055f,
  +0.0234943f, -0.1095232f, +0.1572810f, -0.1710962f, -0.0029165f, -0.0458776f, -0.1472721f, +0.3013210f,
  +0.2367379f, -0.1362139f, -0.3125018f, -0.1146972f, +0.2649602f, +0.0725711f, -0.2504333f, +0.2406261f,
  +0.1906543f, -0.0176584f, +0.1756124f, +0.1868627f, +0.1750091f, -0.0313528f, -0.0031551f, +0.5017468f,
  -0.1790965f, -0.2227536f, -0.1028343f, +0.1515624f, +0.0296285f, +0.1734786f, -0.0505819f, -0.1570139f,
  -0.4029859f, +0.1256620f, +0.0425540f, +0.2163773f, +0.1112421f, -0.4992151f, +0.0169494f, -0.2896445f,
  +0.3567581f, +0.1612938f, +0.0660217f, +0.0831002f, +0.4868965f, +0.1164183f, -0.2644280f, +0.3756327f,
  -0.0169529f, -0.0030829f, +0.1721229f, -0.0749970f, +0.0806658f, +0.1465389f, +0.1837681f, -0.1396843f,
  +0.1579659f, -0.2573873f, +0.0081754f, +0.2244696f, +0.1524744f, -0.4049593f, -0.3324301f, +0.1750473f,
  +0.1375219f, +0.0584794f, -0.1279306f, -0.0277780f, +0.0967907f, -0.2072029f, -0.4364115f, -0.6591069f,
  +0.1279157f, +0.0465268f, -0.4741274f, +0.0308065f, +0.1458032f, +0.0228482f, -0.1782767f, -0.1395954f,
  -0.2485301f, +0.1490873f, -0.5802739f, +0.0320349f, +0.1667380f, +0.0641045f, +0.1048153f, -0.3310671f,
  +0.0591023f, -0.1897387f, -0.5327241f, +0.1532493f, +0.1194817f, -0.5119713f, -0.3643579f, +0.3716563f,
  -0.4259497f, +0.0403743f, +0.0246182f, +0.0600004f, +0.2124187f, -0.0704511f, -0.1509318f, -0.5685117f,
  +0.1034890f, -0.2099093f, -0.1504571f, +0.1034012f, -0.0366233f, -0.1074740f, -0.0446699f, +0.3520628f,
  -0.0467702f, -0.0689493f, -0.5982305f, +0.0969581f, -0.1489562f, -0.1052559f, -0.0494351f, +0.3099766f,
  -0.0959468f, -0.3195480f, -0.1691094f, +0.0112854f, +0.0545831f, -0.3729586f, -0.0160231f, -0.1362642f,
  -0.2572044f, +0.1068176f, -0.4861303f, -0.0800146f, +0.0792620f, +0.2901969f, -0.0643619f, +0.0882573f,
  +0.2342950f, +0.2553958f, +0.2008493f, -0.0230831f, -0.1663026f, -0.1440406f, +0.1762616f, -0.0781600f,
  -0.0482986f, -0.0008320f, +0.2223168f, +0.0132918f, -0.2736714f, -0.2284708f, -0.1840836f, +0.0370112f,
  +0.0571630f, +0.3459043f, +0.0988663f, -0.2755106f, +0.0600505f, +0.4307139f, +0.1553368f, -0.0777256f,
  +0.0623140f, -0.2503031f, +0.5103790f, +0.0813202f, +0.1615289f, -0.1309326f, -0.0723063f, +0.4592800f,
  -0.4157114f, -0.0868598f, +0.3772487f, +0.1518130f, -0.3505092f, -0.5529519f, +0.0556152f, +0.5730204f,
  -0.5769207f, -0.5356058f, +0.3877018f, +0.0192469f, -0.3315677f, -0.6467110f, +0.2352160f, -0.0824557f,
  +0.1726958f, -0.0831429f, -0.3742356f, +0.2185694f, +0.1832454f, +0.1209411f, +0.0926010f, +0.3451659f,
  +0.0823828f, -0.3936800f, -0.0294300f, -0.1121055f, -0.0762050f, +0.0835270f, -0.0007448f, -0.6764081f,
  -0.0250515f, -0.0231513f, -0.1844740f, +0.2683190f, +0.2506011f, -0.0550406f, -0.1257861f, -0.5112778f,
  +0.2330140f, +0.3002755f, -0.0131390f, +0.0148752f, -0.1684935f, -0.4289685f, +0.0877955f, -0.1808836f,
  +0.0503962f, +0.0598240f, -0.0385097f, -0.2228385f, +0.2838874f, -0.0802390f, -0.1785170f, +0.5078154f,
  -0.1103139f, -0.0380561f, +0.1280791f, -0.1106678f, +0.0693033f, +0.2633717f, -0.1298055f, -0.0287023f,
  -0.0771017f, -0.0218020f, -0.0435302f, -0.2094206f, -0.2890343f, +0.0053047f, -0.0543820f, +0.5171971f,
  -0.0082678f, -0.3033353f, -0.0576028f, -0.1787496f, +0.0170692f, -0.0914116f, +0.3066967f, -0.0842597f,
  -0.1060439f, +0.0306082f, +0.1204219f, -0.2399302f, +0.0704785f, -0.1359092f, -0.1260367f, -0.2361867f,
  +0.2307684f, +0.3522194f, +0.0491912f, +0.2685877f, +0.0326379f, +0.0073355f, -0.0321370f, -0.0138453f,
  -0.0898767f, +0.2999523f, +0.3777793f, -0.0809820f, +0.1092952f, -0.0332887f, +0.0111237f, -0.0344370f,
  -0.1930521f, -0.1535531f, -0.0846214f, +0.2931711f, -0.1443308f, -0.1754346f, +0.2034908f, -0.0186375f
);

const float biases[4] = float[4](
  -0.2248989f, -0.0984148f, -0.1476934f, +0.0213321f
);

vec4 hook() {
    const vec4 r[9][2] = vec4[9][2](
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 1.0f)))
    );

    float sum[4] = biases;
    for (int n = 0; n < 4; n++) {
        for (int i = 0; i < 9; i++) {
            const vec4 k0 = vec4(kernels[n * 8 * 9 + 8 * i + 0], kernels[n * 8 * 9 + 8 * i + 1], kernels[n * 8 * 9 + 8 * i + 2], kernels[n * 8 * 9 + 8 * i + 3]);
            const vec4 k1 = vec4(kernels[n * 8 * 9 + 8 * i + 4], kernels[n * 8 * 9 + 8 * i + 5], kernels[n * 8 * 9 + 8 * i + 6], kernels[n * 8 * 9 + 8 * i + 7]);
            sum[n] += (dot(k0, r[i][0]) + dot(k1, r[i][1]));
        }
    }

    return ACTIVE(vec4(sum[0], sum[1], sum[2], sum[3]));
}

//!HOOK LUMA
//!DESC ARNet b16 Layer2 L0
//!WHEN OUTPUT.w LUMA.w / 1.2 > OUTPUT.h LUMA.h / 1.2 > *
//!BIND TMP1_L0
//!BIND TMP1_L1
//!BIND FEAT_L0
//!SAVE TMP2_L0
//!COMPONENTS 4

#define ACTIVE(v) (v)

#define TEX_BIND_L0_TEXOFF TMP1_L0_texOff
#define TEX_BIND_L0_TEX TMP1_L0_tex
#define TEX_BIND_L0_POS TMP1_L0_pos
#define TEX_BIND_L0_SIZE TMP1_L0_size
#define TEX_BIND_L0_PT TMP1_L0_pt

#define TEX_BIND_L1_TEXOFF TMP1_L1_texOff
#define TEX_BIND_L1_TEX TMP1_L1_tex
#define TEX_BIND_L1_POS TMP1_L1_pos
#define TEX_BIND_L1_SIZE TMP1_L1_size
#define TEX_BIND_L1_PT TMP1_L1_pt

#define TEX_BIND_L2_TEXOFF FEAT_L0_texOff
#define TEX_BIND_L2_TEX FEAT_L0_tex
#define TEX_BIND_L2_POS FEAT_L0_pos
#define TEX_BIND_L2_SIZE FEAT_L0_size
#define TEX_BIND_L2_PT FEAT_L0_pt

const float kernels[288] = float[288](
  +0.2288686f, +0.0227588f, -0.0287758f, +0.4580338f, -0.2364426f, +0.1555470f, -0.0557860f, -0.1377355f,
  +0.3374715f, +0.2566155f, +0.0540642f, +0.2621942f, -0.0860656f, +0.0931071f, +0.0097302f, -0.2924284f,
  +0.1861097f, +0.1141981f, +0.1688662f, +0.1365303f, +0.0878991f, -0.0950108f, -0.2387311f, -0.0189383f,
  -0.2650591f, +0.2053159f, -0.1335127f, +0.3181776f, +0.2029958f, +0.2007782f, +0.0252990f, -0.0268642f,
  -0.1277499f, +0.3362909f, -0.4526182f, -0.0290193f, +0.0946274f, +0.1862272f, +0.1204765f, -0.0610035f,
  -0.0249755f, -0.0969663f, +0.2437811f, +0.0385277f, -0.0803025f, +0.2037536f, -0.1481994f, -0.2266928f,
  +0.1793656f, -0.0640592f, -0.0312082f, +0.1648240f, +0.0119539f, +0.3303444f, +0.0810546f, -0.2950016f,
  -0.0717111f, +0.1108485f, -0.3921806f, +0.3828760f, +0.2411779f, -0.1563421f, +0.0407799f, -0.2117327f,
  -0.4468505f, +0.0157886f, +0.0285608f, +0.0408833f, +0.2860075f, -0.0669464f, -0.2213038f, -0.0785180f,
  -0.0221284f, +0.1093184f, -0.0813084f, -0.0951165f, +0.3079745f, +0.3225411f, -0.0692766f, -0.1060999f,
  +0.3442892f, -0.0542219f, +0.0031944f, -0.0259546f, +0.0227814f, -0.1014614f, -0.0447799f, +0.3609056f,
  +0.0729813f, +0.0039585f, +0.0680325f, -0.0612077f, +0.4434736f, +0.3567059f, -0.1141598f, -0.3224396f,
  -0.1830336f, +0.2371459f, +0.2234449f, -0.0437382f, +0.1768634f, +0.4769045f, +0.1518736f, +0.0916135f,
  -0.0417849f, +0.3038228f, -0.2029462f, +0.0261023f, +0.2043200f, -0.1177781f, -0.0608890f, +0.1895577f,
  -0.1690125f, +0.1690194f, -0.0107064f, -0.0052431f, +0.2924349f, +0.7860818f, +0.1105319f, -0.3691144f,
  -0.2519048f, -0.0299350f, -0.3380310f, +0.1809977f, +0.3117265f, +0.0818444f, +0.2072014f, +0.0764513f,
  -0.2703535f, -0.4695120f, -0.4283459f, -0.1206465f, +0.2384135f, +0.5206295f, +0.2564910f, +0.2192463f,
  -0.0734067f, -0.2334348f, -0.0812045f, +0.0267381f, +0.1150445f, +0.1344598f, +0.1673186f, -0.3269764f,
  -0.0315207f, +0.1041080f, -0.1753459f, -0.3329607f, -0.0984505f, -0.3708186f, -0.0003335f, -0.1661060f,
  -0.0984213f, -0.0969937f, +0.0681041f, -0.0712914f, +0.0275551f, -0.0413996f, -0.1910893f, -0.0233105f,
  +0.0447747f, -0.1554402f, +0.0706683f, +0.0167967f, -0.1238930f, +0.1905519f, +0.0141839f, +0.0892112f,
  +0.3719699f, +0.0244772f, -0.0625204f, -0.1859704f, -0.0368351f, +0.1248251f, -0.4222140f, +0.2019216f,
  +0.1076645f, +0.4510283f, -0.0013683f, -0.1508083f, -0.2201775f, -0.0157929f, -0.5297014f, +0.2011348f,
  -0.1977568f, +0.1126835f, +0.0019190f, -0.0666604f, -0.2263243f, -0.2300517f, -0.2455900f, +0.0511057f,
  -0.2162585f, +0.1316019f, -0.1654616f, -0.2227226f, +0.0469875f, +0.2358235f, -0.1306108f, -0.0545075f,
  -0.2379940f, +0.1000794f, +0.4488299f, -0.2100794f, +0.1713574f, +0.1128668f, -0.1553934f, -0.2190872f,
  -0.3178287f, +0.1020107f, +0.2183357f, +0.0289738f, -0.1031820f, -0.0919604f, -0.0340514f, +0.0640678f,
  -0.0061103f, +0.3063149f, -0.0454307f, +0.2410455f, +0.0140419f, +0.3671286f, +0.1113074f, +0.1059695f,
  +0.1163810f, +0.3099114f, -0.0327688f, -0.3581270f, +0.3938960f, +0.0148956f, +0.0108536f, +0.1653141f,
  +0.0105146f, -0.0961971f, +0.0689109f, +0.0029350f, -0.0738536f, +0.0785271f, +0.0894969f, -0.0796073f,
  +0.0949483f, +0.0537645f, +0.0304909f, +0.5479857f, -0.0947560f, +0.3548699f, -0.4628071f, -0.1032736f,
  +0.2216361f, +0.5846791f, -0.1461641f, -0.2143386f, -0.0322662f, -0.3878374f, -0.5596194f, +0.1946305f,
  -0.2882514f, +0.0297639f, -0.1661787f, +0.0849388f, +0.3121110f, -0.0860836f, +0.1336576f, -0.0100752f,
  -0.0202510f, -0.0539171f, +0.0179007f, -0.1969016f, +0.2754195f, +0.1296970f, -0.0644556f, +0.2999113f,
  -0.0031043f, +0.0610771f, -0.0064174f, -0.2393740f, +0.2102802f, -0.1029117f, +0.1758794f, +0.1143330f,
  -0.1638701f, -0.2325456f, +0.1662132f, +0.2328115f, +0.0738146f, -0.1755392f, +0.1038476f, -0.2779828f
);

const float biases[4] = float[4](
  +0.1786606f, -0.0756758f, -0.0461738f, +0.2062104f
);

vec4 hook() {
    const vec4 r[9][2] = vec4[9][2](
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 1.0f)))
    );

    float sum[4] = biases;
    for (int n = 0; n < 4; n++) {
        for (int i = 0; i < 9; i++) {
            const vec4 k0 = vec4(kernels[n * 8 * 9 + 8 * i + 0], kernels[n * 8 * 9 + 8 * i + 1], kernels[n * 8 * 9 + 8 * i + 2], kernels[n * 8 * 9 + 8 * i + 3]);
            const vec4 k1 = vec4(kernels[n * 8 * 9 + 8 * i + 4], kernels[n * 8 * 9 + 8 * i + 5], kernels[n * 8 * 9 + 8 * i + 6], kernels[n * 8 * 9 + 8 * i + 7]);
            sum[n] += (dot(k0, r[i][0]) + dot(k1, r[i][1]));
        }
    }

    return ACTIVE(vec4(sum[0], sum[1], sum[2], sum[3]) * 0.2000000f + TEX_BIND_L2_TEXOFF(vec2(0.0f, 0.0f)));
}

//!HOOK LUMA
//!DESC ARNet b16 Layer2 L1
//!WHEN OUTPUT.w LUMA.w / 1.2 > OUTPUT.h LUMA.h / 1.2 > *
//!BIND TMP1_L0
//!BIND TMP1_L1
//!BIND FEAT_L1
//!SAVE TMP2_L1
//!COMPONENTS 4

#define ACTIVE(v) (v)

#define TEX_BIND_L0_TEXOFF TMP1_L0_texOff
#define TEX_BIND_L0_TEX TMP1_L0_tex
#define TEX_BIND_L0_POS TMP1_L0_pos
#define TEX_BIND_L0_SIZE TMP1_L0_size
#define TEX_BIND_L0_PT TMP1_L0_pt

#define TEX_BIND_L1_TEXOFF TMP1_L1_texOff
#define TEX_BIND_L1_TEX TMP1_L1_tex
#define TEX_BIND_L1_POS TMP1_L1_pos
#define TEX_BIND_L1_SIZE TMP1_L1_size
#define TEX_BIND_L1_PT TMP1_L1_pt

#define TEX_BIND_L2_TEXOFF FEAT_L1_texOff
#define TEX_BIND_L2_TEX FEAT_L1_tex
#define TEX_BIND_L2_POS FEAT_L1_pos
#define TEX_BIND_L2_SIZE FEAT_L1_size
#define TEX_BIND_L2_PT FEAT_L1_pt

const float kernels[288] = float[288](
  -0.3114766f, +0.2778060f, -0.0871780f, +0.0219290f, -0.3248979f, -0.2841755f, -0.3731203f, -0.0604451f,
  -0.0180942f, +0.1293977f, +0.1109600f, +0.0921097f, -0.1182526f, -0.4995360f, -0.0963591f, +0.0753148f,
  +0.1700735f, +0.0799746f, +0.0825372f, +0.0097662f, -0.2672488f, -0.1062251f, -0.0262302f, +0.2186248f,
  +0.0343142f, +0.2762283f, +0.0785450f, +0.1524191f, -0.0874071f, +0.0853834f, -0.6228787f, +0.2811499f,
  +0.1700866f, +0.3882847f, +0.2110958f, +0.0315819f, -0.2882912f, -0.0428824f, +0.0274455f, -0.0289525f,
  +0.3277680f, -0.1884843f, -0.1144061f, -0.1327949f, -0.2413053f, -0.1522061f, +0.0755659f, +0.3925675f,
  +0.1709445f, -0.1022740f, -0.0892239f, +0.1016280f, -0.0488812f, -0.1686372f, -0.1943223f, +0.2493822f,
  +0.3983233f, +0.3146776f, -0.1663420f, +0.2407963f, -0.2803600f, +0.2323506f, -0.0604258f, +0.3423217f,
  +0.0917561f, +0.0425147f, -0.3107361f, -0.0388744f, -0.2953019f, -0.1981048f, -0.0735516f, +0.1412335f,
  +0.0134112f, -0.1275079f, +0.0037144f, -0.1389182f, +0.0061176f, +0.0142471f, -0.0450965f, -0.2105073f,
  +0.1063406f, -0.2148211f, +0.2016081f, -0.2784093f, -0.1594821f, +0.2702017f, +0.1905817f, -0.0276144f,
  -0.0605183f, -0.1387279f, -0.2311540f, -0.2259624f, +0.0089441f, +0.3096263f, -0.2219700f, -0.1274792f,
  -0.1755720f, +0.0642766f, -0.1670511f, +0.0319726f, +0.2715178f, +0.1118066f, +0.6447324f, +0.0274787f,
  -0.2107797f, -0.7537243f, +0.1358457f, -0.3136199f, +0.1329675f, -0.1285317f, +0.5631236f, -0.1135330f,
  +0.0696040f, -0.2697462f, +0.1131295f, -0.3150797f, +0.1667512f, +0.1480201f, +0.2414801f, -0.0408041f,
  -0.0458107f, -0.1008156f, -0.0852158f, +0.2252355f, -0.0942345f, +0.4914693f, +0.1873759f, -0.1676042f,
  -0.4717382f, -0.2293181f, -0.4302578f, -0.1612148f, +0.0964625f, +0.3597157f, +0.1808286f, +0.0699844f,
  +0.0132128f, -0.2757807f, -0.0652960f, -0.1179741f, +0.1220006f, +0.0877919f, +0.0420342f, +0.1647258f,
  -0.0096780f, -0.0546077f, -0.0668114f, -0.1094660f, +0.5751218f, +0.3599762f, -0.3594603f, -0.1057725f,
  +0.0610315f, +0.4225146f, +0.2071832f, -0.1268415f, +0.3839254f, +0.1723783f, -0.2896087f, -0.4089599f,
  +0.2334255f, +0.3596467f, -0.0853880f, -0.0128305f, +0.4560277f, +0.0884206f, -0.2471597f, -0.1482618f,
  -0.1216073f, -0.0265205f, +0.1230669f, +0.0653971f, +0.5257630f, +0.2355490f, -0.4176565f, -0.4884401f,
  -0.3140813f, -0.2312677f, +0.3668854f, +0.1574048f, -0.0173007f, +0.2288247f, -0.2477393f, -0.3948510f,
  -0.1280420f, -0.1720909f, +0.3008702f, +0.1087943f, +0.1910079f, +0.4301318f, -0.1831028f, +0.0508891f,
  -0.0948358f, +0.0184757f, +0.3323456f, -0.0056891f, +0.1862023f, +0.1441395f, -0.1724194f, -0.1659748f,
  +0.0178596f, +0.0084983f, +0.1285987f, -0.0490591f, +0.0937409f, +0.3040236f, +0.0341395f, -0.6680885f,
  -0.0056981f, +0.1486599f, +0.0222776f, -0.2025062f, -0.0093768f, +0.6040838f, -0.0596602f, +0.0520813f,
  +0.0477041f, -0.0654554f, +0.0014035f, -0.2662298f, +0.0022337f, +0.2896203f, -0.0886943f, -0.0453548f,
  +0.0661006f, +0.3281204f, -0.1265746f, -0.3537080f, +0.1383878f, -0.0947011f, -0.5168031f, -0.0779605f,
  +0.2771029f, +0.1956848f, +0.0190715f, -0.0968551f, -0.3833006f, +0.2203923f, -0.0467670f, +0.0116030f,
  -0.3512492f, +0.1516625f, +0.0005715f, -0.4699550f, +0.0348803f, -0.3308506f, -0.0333622f, -0.1814350f,
  -0.1531425f, +0.1305156f, +0.0948019f, -0.2928039f, -0.2193663f, -0.1529702f, -0.0013554f, +0.0778885f,
  +0.2015404f, +0.2443417f, +0.1200648f, -0.3026485f, -0.0812569f, -0.1593532f, -0.4827179f, +0.1764165f,
  -0.0354385f, +0.0806388f, -0.0314253f, -0.0765500f, -0.0969972f, -0.0743834f, -0.0898006f, +0.1270173f,
  -0.0024640f, -0.0261463f, -0.2250900f, -0.1934161f, +0.0887025f, +0.0449773f, -0.1351982f, -0.0041002f,
  -0.2346448f, +0.4600258f, +0.1978304f, -0.4017287f, -0.1794382f, -0.1061083f, -0.3041812f, +0.3167558f
);

const float biases[4] = float[4](
  -0.0517628f, +0.3256735f, -0.1414094f, -0.1307697f
);

vec4 hook() {
    const vec4 r[9][2] = vec4[9][2](
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 1.0f)))
    );

    float sum[4] = biases;
    for (int n = 0; n < 4; n++) {
        for (int i = 0; i < 9; i++) {
            const vec4 k0 = vec4(kernels[n * 8 * 9 + 8 * i + 0], kernels[n * 8 * 9 + 8 * i + 1], kernels[n * 8 * 9 + 8 * i + 2], kernels[n * 8 * 9 + 8 * i + 3]);
            const vec4 k1 = vec4(kernels[n * 8 * 9 + 8 * i + 4], kernels[n * 8 * 9 + 8 * i + 5], kernels[n * 8 * 9 + 8 * i + 6], kernels[n * 8 * 9 + 8 * i + 7]);
            sum[n] += (dot(k0, r[i][0]) + dot(k1, r[i][1]));
        }
    }

    return ACTIVE(vec4(sum[0], sum[1], sum[2], sum[3]) * 0.2000000f + TEX_BIND_L2_TEXOFF(vec2(0.0f, 0.0f)));
}

//!HOOK LUMA
//!DESC ARNet b16 Layer3 L0
//!WHEN OUTPUT.w LUMA.w / 1.2 > OUTPUT.h LUMA.h / 1.2 > *
//!BIND TMP2_L0
//!BIND TMP2_L1
//!SAVE TMP1_L0
//!COMPONENTS 4

#define ACTIVE(v) (max(v, v * 0.2000000f))

#define TEX_BIND_L0_TEXOFF TMP2_L0_texOff
#define TEX_BIND_L0_TEX TMP2_L0_tex
#define TEX_BIND_L0_POS TMP2_L0_pos
#define TEX_BIND_L0_SIZE TMP2_L0_size
#define TEX_BIND_L0_PT TMP2_L0_pt

#define TEX_BIND_L1_TEXOFF TMP2_L1_texOff
#define TEX_BIND_L1_TEX TMP2_L1_tex
#define TEX_BIND_L1_POS TMP2_L1_pos
#define TEX_BIND_L1_SIZE TMP2_L1_size
#define TEX_BIND_L1_PT TMP2_L1_pt

const float kernels[288] = float[288](
  +0.1235866f, +0.0988696f, +0.3524577f, -0.1271487f, +0.0398541f, +0.4430550f, +0.1071920f, -0.4234475f,
  -0.3081838f, +0.1992153f, +0.4562375f, +0.0290029f, -0.3786440f, +0.1114165f, +0.5215055f, -0.3105020f,
  +0.1337499f, -0.0295973f, +0.0596439f, +0.1178512f, -0.0203747f, -0.1188736f, +0.2239923f, -0.2122244f,
  -0.0281866f, -0.2604373f, -0.4208131f, -0.2528677f, +0.1917892f, +0.1441595f, -0.3723403f, +0.1744224f,
  -0.3538559f, +0.4681034f, +0.1003605f, -0.0845805f, +0.1256411f, +0.2661952f, -0.3785365f, +0.4209007f,
  -0.0395889f, +0.0654124f, -0.3586490f, +0.1379739f, +0.0322154f, +0.1841214f, +0.1148134f, +0.4872113f,
  -0.4874910f, -0.0387305f, -0.7860373f, +0.0850150f, +0.2365423f, -0.0602678f, -0.5049394f, +0.0166832f,
  -0.2433202f, -0.2171765f, +0.2264379f, -0.3795299f, +0.3208147f, -0.4566290f, -0.1850655f, +0.0368922f,
  +0.1466203f, +0.1808008f, +0.1023657f, +0.0226911f, +0.2066045f, -0.4169746f, +0.0027838f, +0.0456131f,
  -0.4240207f, -0.0264189f, -0.5811320f, -0.1498821f, +0.3615629f, -0.2500986f, +0.0658016f, -0.4025368f,
  -0.0112551f, -0.2528614f, -0.5263292f, -0.1695974f, -0.0606451f, -0.2972257f, -0.0079287f, -0.0328462f,
  -0.1088672f, -0.0637332f, -0.4325394f, +0.0172794f, -0.1505874f, -0.0531841f, -0.2889340f, -0.0828702f,
  +0.1667969f, +0.2126388f, -0.2270418f, -0.0400185f, -0.1933134f, -0.2559032f, +0.1017073f, -0.3952509f,
  -0.0006167f, -0.2992111f, +0.0987601f, -0.2001623f, +0.1621871f, -0.1702811f, +0.0266304f, +0.2351996f,
  -0.1411068f, -0.0501338f, -0.1487497f, +0.3783729f, -0.0658520f, +0.0942574f, +0.1828564f, +0.0743369f,
  -0.0983589f, +0.2274885f, +0.2413037f, -0.2002152f, -0.1182452f, -0.0348193f, +0.0135109f, -0.1594829f,
  +0.0267376f, -0.1531980f, +0.1719140f, +0.0046044f, +0.3326768f, +0.1398478f, +0.0640815f, -0.3007438f,
  +0.0185753f, -0.0385070f, +0.1088410f, +0.3649696f, +0.0129699f, +0.3941160f, +0.1865339f, -0.0609232f,
  +0.1520722f, +0.1136190f, +0.2159465f, -0.1806855f, +0.0339906f, -0.2184107f, -0.0405408f, +1.0076872f,
  -0.0678635f, +0.1398577f, +0.3761152f, -0.0174773f, +0.0905564f, +0.0608068f, +0.1493748f, +0.2285911f,
  -0.0962824f, -0.0054302f, +0.1297384f, -0.2051261f, +0.1096167f, -0.0770607f, +0.0048884f, -0.1928439f,
  +0.2316876f, -0.0728658f, -0.4227130f, -0.1119079f, +0.0616808f, -0.2238346f, -0.2099682f, +0.0785067f,
  +0.0896360f, +0.3074575f, -0.0920757f, -0.3471420f, +0.2430059f, +0.1989477f, -0.3797943f, -0.7284365f,
  +0.0470915f, +0.3015591f, -0.0102811f, -0.2417904f, +0.0794732f, +0.1978755f, +0.1064955f, -0.2899715f,
  -0.2041835f, -0.1000824f, +0.2025943f, +0.3810231f, -0.2156651f, +0.4101211f, +0.2140080f, -0.3352046f,
  +0.2863047f, +0.0456851f, -0.3357576f, -0.3518388f, -0.3004059f, +0.6812321f, -0.5016516f, +0.1580376f,
  +0.2491534f, -0.0511401f, -0.2565867f, +0.0994648f, +0.2118547f, +0.4324754f, -0.2255787f, +0.0344886f,
  -0.1376463f, +0.0750232f, +0.1037973f, -0.0498573f, -0.0242656f, +0.2044034f, +0.0606921f, +0.0814131f,
  +0.0650748f, -0.1305708f, -0.0905188f, -0.1492162f, +0.2169854f, +0.0778759f, -0.0687083f, -0.1874280f,
  +0.0085330f, +0.0905568f, -0.1097877f, -0.0921882f, +0.5099042f, +0.2188130f, +0.0328607f, -0.4338150f,
  +0.2359326f, +0.3043596f, +0.1613371f, -0.1699816f, -0.0954051f, +0.0133953f, +0.0404726f, -0.1530245f,
  +0.3542633f, -0.2108388f, -0.1980853f, -0.2585464f, +0.1977178f, -0.2376027f, -0.0763353f, +0.3247620f,
  -0.2168232f, +0.1318713f, +0.0531015f, +0.1002636f, +0.6207806f, +0.0056694f, +0.0598706f, -0.4684381f,
  +0.1847708f, +0.1967784f, +0.3551391f, -0.0919007f, -0.2988783f, +0.0113579f, +0.0797742f, -0.2087191f,
  +0.4596019f, -0.1530275f, -0.3637112f, -0.0015833f, -0.1231384f, +0.0047002f, +0.2253272f, +0.1764648f,
  -0.0431998f, +0.4225224f, -0.5995259f, -0.0672932f, +0.2853495f, -0.2138345f, -0.0651933f, +0.2125277f
);

const float biases[4] = float[4](
  +0.0752261f, +0.0818085f, +0.0611136f, +0.0700287f
);

vec4 hook() {
    const vec4 r[9][2] = vec4[9][2](
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 1.0f)))
    );

    float sum[4] = biases;
    for (int n = 0; n < 4; n++) {
        for (int i = 0; i < 9; i++) {
            const vec4 k0 = vec4(kernels[n * 8 * 9 + 8 * i + 0], kernels[n * 8 * 9 + 8 * i + 1], kernels[n * 8 * 9 + 8 * i + 2], kernels[n * 8 * 9 + 8 * i + 3]);
            const vec4 k1 = vec4(kernels[n * 8 * 9 + 8 * i + 4], kernels[n * 8 * 9 + 8 * i + 5], kernels[n * 8 * 9 + 8 * i + 6], kernels[n * 8 * 9 + 8 * i + 7]);
            sum[n] += (dot(k0, r[i][0]) + dot(k1, r[i][1]));
        }
    }

    return ACTIVE(vec4(sum[0], sum[1], sum[2], sum[3]));
}

//!HOOK LUMA
//!DESC ARNet b16 Layer3 L1
//!WHEN OUTPUT.w LUMA.w / 1.2 > OUTPUT.h LUMA.h / 1.2 > *
//!BIND TMP2_L0
//!BIND TMP2_L1
//!SAVE TMP1_L1
//!COMPONENTS 4

#define ACTIVE(v) (max(v, v * 0.2000000f))

#define TEX_BIND_L0_TEXOFF TMP2_L0_texOff
#define TEX_BIND_L0_TEX TMP2_L0_tex
#define TEX_BIND_L0_POS TMP2_L0_pos
#define TEX_BIND_L0_SIZE TMP2_L0_size
#define TEX_BIND_L0_PT TMP2_L0_pt

#define TEX_BIND_L1_TEXOFF TMP2_L1_texOff
#define TEX_BIND_L1_TEX TMP2_L1_tex
#define TEX_BIND_L1_POS TMP2_L1_pos
#define TEX_BIND_L1_SIZE TMP2_L1_size
#define TEX_BIND_L1_PT TMP2_L1_pt

const float kernels[288] = float[288](
  -0.0909058f, +0.0062976f, +0.2277286f, +0.1609725f, -0.0819113f, -0.0530694f, +0.2417585f, +0.0045614f,
  -0.0007438f, +0.1586301f, -0.1544995f, -0.2876265f, +0.0539820f, -0.1464048f, +0.2301969f, -0.3214043f,
  -0.1770018f, -0.1664475f, -0.2491484f, -0.0725753f, +0.1619410f, -0.0341266f, +0.1776563f, -0.6773189f,
  +0.1897451f, -0.0835709f, +0.2300334f, +0.0611572f, +0.0482288f, -0.0045529f, -0.0097309f, +0.2368401f,
  -0.2094193f, +0.4314476f, +0.1171112f, -0.1131250f, +0.2725402f, +0.5045223f, +0.0361537f, -0.2891442f,
  -0.1757354f, -0.0257560f, +0.2232771f, +0.0449995f, +0.1980750f, -0.0436227f, -0.0062456f, -0.1227397f,
  -0.2847174f, +0.0065002f, +0.0020762f, -0.0327737f, -0.1609096f, +0.1667464f, +0.2525529f, -0.3578985f,
  -0.3906980f, +0.1848157f, -0.0234575f, -0.2333595f, -0.0470943f, +0.4692970f, -0.1533014f, -0.4473279f,
  -0.0743146f, -0.3114058f, +0.1477927f, +0.1068541f, +0.0693024f, +0.0003136f, -0.3052930f, -0.0508714f,
  +0.1769930f, -0.1026127f, -0.3073197f, -0.0991966f, -0.2644994f, -0.2743330f, +0.0778675f, +0.4690532f,
  +0.2405055f, +0.0828827f, -0.0893229f, +0.1636076f, -0.2876205f, -0.1604390f, +0.0346231f, -0.0418876f,
  +0.3151332f, -0.4185004f, +0.1435455f, +0.3831261f, +0.1503777f, -0.1533186f, +0.0297794f, +0.2705930f,
  +0.4655103f, -0.1301802f, -0.3027222f, -0.1773179f, -0.3964727f, -0.3842089f, +0.0289799f, +0.2819613f,
  +0.2417740f, +0.2302991f, -0.3778128f, +0.0650543f, -0.2997420f, +0.1715538f, +0.3846672f, +0.3047144f,
  +0.0928672f, -0.1454410f, -0.1408143f, -0.0902928f, -0.0516778f, +0.0197338f, -0.0383069f, +0.4138745f,
  +0.1101777f, +0.0935471f, -0.3104987f, -0.1204270f, -0.2422343f, +0.0423720f, +0.1100203f, -0.0520521f,
  +0.3565225f, +0.0194509f, +0.1963295f, -0.0331178f, +0.2024027f, +0.0208617f, -0.0076206f, -0.1302327f,
  +0.1886774f, -0.0543744f, +0.0923767f, -0.0612056f, +0.3732087f, -0.2096028f, +0.0378129f, -0.2680556f,
  -0.0148226f, -0.1549218f, +0.1351809f, -0.0696703f, +0.1073213f, -0.0047753f, -0.1703356f, +0.2219425f,
  +0.0413714f, -0.1023495f, -0.5043605f, +0.0582436f, -0.0026350f, -0.2064365f, -0.0137122f, -0.0137502f,
  +0.1296945f, -0.1924342f, -0.2267007f, +0.0844010f, +0.3609159f, +0.2300556f, -0.1890404f, +0.0299938f,
  -0.2888950f, -0.3568031f, -0.0874731f, +0.0314814f, +0.3497096f, -0.0607773f, -0.3513270f, +0.5190801f,
  -0.3751459f, +0.3966913f, -0.0971904f, +0.2172568f, +0.0640429f, -0.1149492f, -0.0142073f, -0.6325934f,
  -0.0993568f, +0.2061158f, +0.0142237f, +0.1733721f, +0.1626063f, -0.3000131f, -0.1276822f, -0.0725409f,
  -0.3878282f, -0.1712002f, +0.1843015f, -0.0512554f, -0.1553274f, +0.4973552f, -0.1424876f, -0.1501272f,
  +0.1795522f, +0.1752487f, +0.6500854f, -0.2377408f, +0.1237840f, -0.0949359f, -0.6559892f, +0.0926209f,
  -0.6109261f, +0.1115042f, +0.0534511f, -0.0509386f, +0.2146115f, +0.0320209f, +0.3073999f, +0.1156988f,
  +0.5607426f, -0.1474851f, +0.2997134f, -0.1301771f, -0.0719745f, -0.0344911f, -0.1711316f, +0.1574876f,
  -0.0987450f, -0.0156974f, +0.3064746f, +0.0687706f, -0.0193769f, -0.2784442f, +0.4938891f, +0.2357041f,
  +0.2069084f, -0.0364326f, -0.4899221f, +0.4100015f, +0.0698403f, -0.3522001f, +0.0974300f, +0.1128197f,
  +0.3798176f, -0.0228852f, +0.1398224f, -0.0917487f, -0.0908085f, +0.0203599f, -0.0412827f, +0.0255059f,
  +0.1478436f, +0.1548868f, +0.0278068f, +0.1341853f, -0.0813318f, +0.2006957f, -0.0901019f, +0.1346724f,
  -0.2639225f, +0.0922602f, -0.3765170f, +0.0403276f, +0.1254109f, -0.1655541f, +0.1942994f, +0.1946023f,
  -0.3057438f, +0.0805179f, -0.1630635f, +0.0732515f, -0.1876107f, -0.1688899f, +0.0896741f, +0.3374599f,
  -0.1556817f, +0.1234273f, -0.2944154f, -0.1239635f, +0.2287625f, +0.2631531f, +0.3888316f, +0.2727201f,
  +0.1333013f, +0.3245696f, -0.4548112f, +0.0592139f, +0.5034512f, -0.3444923f, -0.1036403f, -0.0735917f
);

const float biases[4] = float[4](
  +0.0713928f, +0.0337810f, -0.0819293f, +0.0188789f
);

vec4 hook() {
    const vec4 r[9][2] = vec4[9][2](
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 1.0f)))
    );

    float sum[4] = biases;
    for (int n = 0; n < 4; n++) {
        for (int i = 0; i < 9; i++) {
            const vec4 k0 = vec4(kernels[n * 8 * 9 + 8 * i + 0], kernels[n * 8 * 9 + 8 * i + 1], kernels[n * 8 * 9 + 8 * i + 2], kernels[n * 8 * 9 + 8 * i + 3]);
            const vec4 k1 = vec4(kernels[n * 8 * 9 + 8 * i + 4], kernels[n * 8 * 9 + 8 * i + 5], kernels[n * 8 * 9 + 8 * i + 6], kernels[n * 8 * 9 + 8 * i + 7]);
            sum[n] += (dot(k0, r[i][0]) + dot(k1, r[i][1]));
        }
    }

    return ACTIVE(vec4(sum[0], sum[1], sum[2], sum[3]));
}

//!HOOK LUMA
//!DESC ARNet b16 Layer4 L0
//!WHEN OUTPUT.w LUMA.w / 1.2 > OUTPUT.h LUMA.h / 1.2 > *
//!BIND TMP1_L0
//!BIND TMP1_L1
//!BIND TMP2_L0
//!SAVE TMP2_L0
//!COMPONENTS 4

#define ACTIVE(v) (v)

#define TEX_BIND_L0_TEXOFF TMP1_L0_texOff
#define TEX_BIND_L0_TEX TMP1_L0_tex
#define TEX_BIND_L0_POS TMP1_L0_pos
#define TEX_BIND_L0_SIZE TMP1_L0_size
#define TEX_BIND_L0_PT TMP1_L0_pt

#define TEX_BIND_L1_TEXOFF TMP1_L1_texOff
#define TEX_BIND_L1_TEX TMP1_L1_tex
#define TEX_BIND_L1_POS TMP1_L1_pos
#define TEX_BIND_L1_SIZE TMP1_L1_size
#define TEX_BIND_L1_PT TMP1_L1_pt

#define TEX_BIND_L2_TEXOFF TMP2_L0_texOff
#define TEX_BIND_L2_TEX TMP2_L0_tex
#define TEX_BIND_L2_POS TMP2_L0_pos
#define TEX_BIND_L2_SIZE TMP2_L0_size
#define TEX_BIND_L2_PT TMP2_L0_pt

const float kernels[288] = float[288](
  +0.0005519f, -0.0653181f, -0.1143470f, +0.5521669f, +0.1264359f, +0.0037552f, -0.2484161f, -0.2407537f,
  -0.0696481f, -0.3520645f, -0.0515801f, -0.1383304f, +0.1649479f, +0.0710605f, -0.5261690f, -0.0720996f,
  +0.3555823f, -0.0985890f, +0.1885380f, -0.0301474f, +0.1127660f, +0.2756698f, -0.2232070f, -0.3560095f,
  -0.0199203f, +0.0609237f, -0.1853890f, -0.0210863f, -0.1990658f, -0.3155918f, -0.1654080f, +0.2734545f,
  +0.2490963f, -0.1254153f, +0.1068846f, -0.1531372f, +0.1209935f, -0.3308300f, +0.4111617f, +0.1156293f,
  -0.0249780f, +0.1802290f, -0.0658118f, -0.0843255f, -0.0432144f, -0.2402065f, +0.0334397f, -0.2609204f,
  +0.0326835f, +0.2847930f, +0.0294357f, -0.2528607f, +0.1278721f, -0.5064684f, -0.0761361f, +0.2409607f,
  +0.2313879f, +0.3339465f, +0.1305981f, -0.1780588f, -0.3698243f, +0.0539178f, -0.3172061f, +0.2917394f,
  -0.1786156f, +0.0315050f, +0.1184645f, +0.1775795f, -0.3882340f, -0.0175008f, -0.1725986f, +0.3164686f,
  +0.3817508f, +0.1477178f, +0.1429612f, -0.2571779f, +0.0623677f, +0.0137918f, -0.0269094f, -0.1930893f,
  +0.0524654f, +0.3444633f, +0.0972541f, +0.2337621f, -0.3981754f, -0.0248600f, -0.0828382f, +0.1261581f,
  +0.1734919f, -0.1654081f, +0.1587571f, +0.2341725f, +0.0178148f, -0.2363283f, -0.0633789f, +0.0720157f,
  -0.2434358f, +0.1010023f, +0.2029425f, -0.3874004f, +0.0168718f, +0.1091583f, -0.2047848f, -0.1240174f,
  -0.4496170f, +0.3600585f, -0.0933038f, +0.0662607f, -0.4405416f, +0.0476115f, +0.1020183f, +0.0514584f,
  -0.2151100f, +0.1346384f, -0.2965294f, -0.0844626f, -0.3137832f, +0.0728389f, +0.2251581f, -0.0159359f,
  +0.0603918f, +0.0537614f, -0.0905342f, -0.2801270f, -0.0461384f, +0.1774509f, +0.0130404f, -0.2301341f,
  -0.3908788f, +0.1092564f, -0.0654026f, +0.2904159f, +0.1443301f, -0.0232788f, -0.2078246f, -0.0694967f,
  +0.3088823f, +0.0919742f, -0.0199098f, +0.2523153f, -0.0717037f, -0.0018863f, +0.0628029f, +0.0031591f,
  +0.2189117f, -0.1402372f, +0.5613467f, -0.3118570f, -0.3418815f, -0.0573196f, -0.0422602f, -0.0476032f,
  -0.1411522f, +0.0726264f, +0.2897012f, -0.1456834f, -0.1927406f, -0.1385176f, -0.2468273f, +0.3571386f,
  +0.1045734f, -0.0564755f, -0.0007501f, -0.1410267f, +0.0689584f, -0.1462024f, -0.1320273f, -0.1020495f,
  -0.2282177f, +0.1246826f, +0.2346001f, +0.2699067f, +0.1617019f, -0.0054923f, +0.0739740f, +0.1833354f,
  -0.3495834f, -0.2274102f, +0.3832667f, +0.0619516f, -0.0544793f, +0.3159861f, +0.1761092f, +0.3222627f,
  -0.2581039f, -0.0206704f, -0.1764163f, -0.0657154f, -0.3700220f, +0.0650856f, +0.1947300f, -0.0079540f,
  +0.1398565f, +0.0977798f, -0.0337047f, -0.0310801f, +0.3456388f, +0.0617825f, +0.0405553f, -0.3353998f,
  -0.1130336f, +0.0352866f, -0.0160942f, +0.0528201f, +0.0532658f, -0.3468896f, -0.0556755f, +0.1135891f,
  -0.3915371f, +0.1242514f, -0.1484961f, +0.0655277f, -0.1605856f, -0.1434516f, +0.0152007f, -0.2232497f,
  +0.0940356f, +0.3976055f, +0.3675248f, -0.0398281f, +0.1177702f, +0.0014447f, +0.0971325f, +0.0054709f,
  +0.0420431f, +0.1028464f, +0.5504405f, -0.1598418f, -0.3007389f, -0.1246876f, -0.1199089f, +0.1703006f,
  -0.1468260f, -0.1381210f, -0.2071991f, +0.1344557f, -0.0840617f, -0.2808999f, +0.1680796f, +0.3634896f,
  +0.1705592f, -0.1311628f, +0.5578187f, -0.2145941f, -0.0937602f, +0.3190685f, +0.0811065f, +0.1815989f,
  -0.1426445f, +0.3176143f, +0.0382473f, +0.2410537f, -0.2482483f, +0.1049837f, -0.3771440f, +0.1622992f,
  -0.0517907f, -0.0860972f, -0.1243422f, -0.0294660f, +0.0391597f, +0.1355465f, +0.3578244f, -0.0532060f,
  -0.1612533f, -0.2243769f, +0.1133277f, -0.4477670f, +0.2208360f, +0.2064053f, -0.0758153f, -0.3141544f,
  -0.2011138f, +0.4148361f, -0.0378479f, +0.2200056f, -0.0063024f, -0.1959361f, +0.1829378f, +0.1727738f,
  +0.0108792f, -0.0767276f, -0.0276054f, +0.1349389f, +0.2269927f, -0.1855467f, -0.1487307f, -0.0600760f
);

const float biases[4] = float[4](
  +0.1301722f, -0.0319860f, -0.0174730f, +0.1828127f
);

vec4 hook() {
    const vec4 r[9][2] = vec4[9][2](
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 1.0f)))
    );

    float sum[4] = biases;
    for (int n = 0; n < 4; n++) {
        for (int i = 0; i < 9; i++) {
            const vec4 k0 = vec4(kernels[n * 8 * 9 + 8 * i + 0], kernels[n * 8 * 9 + 8 * i + 1], kernels[n * 8 * 9 + 8 * i + 2], kernels[n * 8 * 9 + 8 * i + 3]);
            const vec4 k1 = vec4(kernels[n * 8 * 9 + 8 * i + 4], kernels[n * 8 * 9 + 8 * i + 5], kernels[n * 8 * 9 + 8 * i + 6], kernels[n * 8 * 9 + 8 * i + 7]);
            sum[n] += (dot(k0, r[i][0]) + dot(k1, r[i][1]));
        }
    }

    return ACTIVE(vec4(sum[0], sum[1], sum[2], sum[3]) * 0.2000000f + TEX_BIND_L2_TEXOFF(vec2(0.0f, 0.0f)));
}

//!HOOK LUMA
//!DESC ARNet b16 Layer4 L1
//!WHEN OUTPUT.w LUMA.w / 1.2 > OUTPUT.h LUMA.h / 1.2 > *
//!BIND TMP1_L0
//!BIND TMP1_L1
//!BIND TMP2_L1
//!SAVE TMP2_L1
//!COMPONENTS 4

#define ACTIVE(v) (v)

#define TEX_BIND_L0_TEXOFF TMP1_L0_texOff
#define TEX_BIND_L0_TEX TMP1_L0_tex
#define TEX_BIND_L0_POS TMP1_L0_pos
#define TEX_BIND_L0_SIZE TMP1_L0_size
#define TEX_BIND_L0_PT TMP1_L0_pt

#define TEX_BIND_L1_TEXOFF TMP1_L1_texOff
#define TEX_BIND_L1_TEX TMP1_L1_tex
#define TEX_BIND_L1_POS TMP1_L1_pos
#define TEX_BIND_L1_SIZE TMP1_L1_size
#define TEX_BIND_L1_PT TMP1_L1_pt

#define TEX_BIND_L2_TEXOFF TMP2_L1_texOff
#define TEX_BIND_L2_TEX TMP2_L1_tex
#define TEX_BIND_L2_POS TMP2_L1_pos
#define TEX_BIND_L2_SIZE TMP2_L1_size
#define TEX_BIND_L2_PT TMP2_L1_pt

const float kernels[288] = float[288](
  +0.2298704f, -0.1020054f, +0.5018646f, -0.2579079f, +0.0599418f, -0.1125375f, +0.0395244f, +0.1047825f,
  -0.1666290f, +0.3552327f, +0.2909089f, +0.0634110f, -0.1804860f, -0.0173183f, -0.0251564f, +0.0179548f,
  -0.1200673f, +0.1869307f, +0.4407322f, +0.0830782f, -0.0304328f, +0.0288039f, +0.4089199f, +0.5228438f,
  -0.1081753f, +0.1008549f, +0.2633913f, -0.2308598f, -0.0725719f, +0.0351431f, +0.0880956f, -0.0010963f,
  +0.1172617f, -0.2522469f, -0.1014226f, -0.4330159f, +0.1081128f, +0.1840984f, +0.3300121f, +0.2836300f,
  +0.3313591f, +0.1718622f, +0.2638940f, -0.0137996f, +0.2254054f, -0.1467128f, -0.4059652f, +0.0337162f,
  +0.0793215f, -0.0365581f, +0.1212406f, -0.5561142f, +0.0484829f, +0.5433341f, +0.1882429f, -0.0029525f,
  +0.2705720f, -0.2023321f, +0.0586707f, -0.0748216f, -0.1034915f, +0.4191990f, -0.1813865f, +0.1179853f,
  +0.1696157f, -0.2017802f, +0.0754457f, -0.2277905f, +0.1725472f, +0.2795733f, +0.1039312f, -0.1563903f,
  -0.0845414f, +0.1403031f, -0.2851572f, +0.1197556f, -0.0789724f, +0.0917776f, -0.1476125f, -0.0822705f,
  +0.2016452f, -0.2433084f, -0.4726509f, +0.0208912f, +0.0582844f, +0.2833686f, +0.4978578f, -0.3656660f,
  +0.1641741f, -0.0121013f, -0.0170891f, +0.2293680f, -0.0751258f, +0.1018884f, +0.1199211f, -0.1650740f,
  -0.2365329f, -0.2153756f, -0.3958512f, -0.2453065f, -0.0885628f, -0.3395272f, +0.0626538f, -0.0975196f,
  -0.0617408f, -0.1375434f, -0.2649802f, +0.0019102f, -0.0804227f, -0.4794521f, +0.0971797f, -0.4305737f,
  -0.0805560f, +0.1124635f, -0.1227628f, +0.0384805f, +0.1089025f, +0.0575597f, +0.3663723f, -0.1824167f,
  +0.0455459f, +0.1071692f, +0.0131016f, +0.2673229f, -0.0581426f, +0.2073882f, -0.0584143f, +0.3744951f,
  -0.1509778f, -0.1301075f, -0.1545392f, +0.6920162f, -0.2611296f, +0.1050984f, -0.0384663f, -0.2455964f,
  -0.1781199f, -0.0879575f, -0.0435334f, +0.1102862f, +0.1525676f, +0.1520225f, -0.0975354f, -0.0612197f,
  -0.1042020f, -0.0541718f, -0.0589075f, +0.2956356f, -0.2602836f, +0.2319683f, +0.1843020f, -0.0904999f,
  +0.3467166f, +0.2440155f, +0.0163179f, +0.0350909f, +0.1900195f, +0.0123236f, +0.0439189f, -0.4839493f,
  -0.1164837f, +0.2666740f, -0.2238582f, +0.0299234f, -0.0092007f, +0.0898609f, -0.1725323f, +0.0637145f,
  -0.0505235f, +0.3439486f, +0.0440446f, +0.2908017f, -0.3767287f, +0.1394985f, +0.3327847f, -0.1474473f,
  +0.5518993f, +0.1740190f, -0.2654389f, +0.1081142f, +0.1185521f, -0.0435830f, +0.0901486f, -0.3378840f,
  +0.2347466f, +0.2645149f, -0.1889936f, +0.2883946f, -0.1233422f, -0.3429902f, -0.1689451f, -0.4111707f,
  -0.2402110f, +0.3703610f, +0.0467069f, -0.3010302f, -0.0945986f, -0.0880970f, -0.0880755f, +0.0359693f,
  +0.1562091f, -0.1631561f, +0.2126801f, +0.0603390f, -0.3317119f, -0.0781239f, -0.0008046f, -0.1405682f,
  -0.0349904f, +0.1676086f, -0.0881300f, -0.1506992f, -0.5491346f, -0.5417234f, +0.1263279f, -0.0573240f,
  +0.2356180f, +0.0978869f, +0.6816356f, +0.3122024f, -0.0192606f, -0.0713784f, -0.0947886f, +0.1287592f,
  -0.0322064f, +0.1684164f, +0.5025269f, +0.2668862f, -0.2833777f, +0.0290334f, -0.1700629f, +0.0042191f,
  -0.1765884f, -0.0882303f, +0.1755738f, +0.1570130f, -0.0453703f, +0.0146055f, +0.1067127f, +0.1369377f,
  -0.2088713f, +0.4031784f, -0.0386682f, +0.1293485f, -0.0513042f, -0.0530604f, +0.0069879f, -0.0067040f,
  -0.6517355f, -0.2867866f, -0.1096476f, -0.5076585f, +0.1294348f, +0.0929643f, +0.3364444f, -0.1824720f,
  -0.0402529f, +0.2583124f, +0.7892210f, -0.1779466f, +0.0440608f, -0.2694016f, -0.1630486f, +0.0793485f,
  +0.2805806f, +0.2661386f, -0.0195747f, +0.0980600f, +0.3827292f, -0.2341811f, +0.1735137f, -0.1900680f,
  -0.1842873f, -0.2319068f, +0.2487727f, -0.2770087f, +0.0636096f, +0.4831159f, +0.1333265f, +0.0452201f,
  -0.5201477f, -0.1202466f, -0.0947775f, +0.0076814f, +0.1649969f, +0.4479340f, +0.2239661f, -0.2585643f
);

const float biases[4] = float[4](
  -0.1212060f, +0.3619395f, -0.0633413f, -0.1305794f
);

vec4 hook() {
    const vec4 r[9][2] = vec4[9][2](
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 1.0f)))
    );

    float sum[4] = biases;
    for (int n = 0; n < 4; n++) {
        for (int i = 0; i < 9; i++) {
            const vec4 k0 = vec4(kernels[n * 8 * 9 + 8 * i + 0], kernels[n * 8 * 9 + 8 * i + 1], kernels[n * 8 * 9 + 8 * i + 2], kernels[n * 8 * 9 + 8 * i + 3]);
            const vec4 k1 = vec4(kernels[n * 8 * 9 + 8 * i + 4], kernels[n * 8 * 9 + 8 * i + 5], kernels[n * 8 * 9 + 8 * i + 6], kernels[n * 8 * 9 + 8 * i + 7]);
            sum[n] += (dot(k0, r[i][0]) + dot(k1, r[i][1]));
        }
    }

    return ACTIVE(vec4(sum[0], sum[1], sum[2], sum[3]) * 0.2000000f + TEX_BIND_L2_TEXOFF(vec2(0.0f, 0.0f)));
}

//!HOOK LUMA
//!DESC ARNet b16 Layer5 L0
//!WHEN OUTPUT.w LUMA.w / 1.2 > OUTPUT.h LUMA.h / 1.2 > *
//!BIND TMP2_L0
//!BIND TMP2_L1
//!SAVE TMP1_L0
//!COMPONENTS 4

#define ACTIVE(v) (max(v, v * 0.2000000f))

#define TEX_BIND_L0_TEXOFF TMP2_L0_texOff
#define TEX_BIND_L0_TEX TMP2_L0_tex
#define TEX_BIND_L0_POS TMP2_L0_pos
#define TEX_BIND_L0_SIZE TMP2_L0_size
#define TEX_BIND_L0_PT TMP2_L0_pt

#define TEX_BIND_L1_TEXOFF TMP2_L1_texOff
#define TEX_BIND_L1_TEX TMP2_L1_tex
#define TEX_BIND_L1_POS TMP2_L1_pos
#define TEX_BIND_L1_SIZE TMP2_L1_size
#define TEX_BIND_L1_PT TMP2_L1_pt

const float kernels[288] = float[288](
  -0.3055989f, +0.3434686f, +0.1338955f, +0.1975467f, -0.4227863f, +0.0858662f, +0.2459824f, -0.2468309f,
  -0.3811321f, +0.2962648f, +0.0331416f, -0.3624253f, -0.0326661f, +0.6556592f, +0.4002754f, -0.2125979f,
  -0.4725893f, +0.3213241f, +0.1358833f, -0.3432060f, -0.3200683f, +0.1507779f, -0.0340511f, -0.2168830f,
  +0.1764747f, +0.0212414f, +0.1054149f, -0.0998417f, +0.0799314f, +0.0496098f, +0.0533131f, -0.5169007f,
  -0.0430863f, -0.1007495f, +0.3034816f, -0.2638273f, +0.1827773f, +0.6774018f, +0.1685449f, -0.7486493f,
  -0.4552210f, -0.0993414f, +0.0314402f, +0.1118963f, +0.1445070f, +0.1772168f, -0.0190049f, -0.1816674f,
  +0.1722122f, -0.0758058f, -0.0278652f, -0.1264957f, +0.2024580f, -0.1282924f, -0.1804907f, -0.0095790f,
  +0.2063304f, -0.3090280f, -0.0262797f, -0.0809749f, +0.1500341f, -0.3981720f, -0.3149081f, -0.5958989f,
  -0.0240480f, -0.4982641f, -0.0231432f, +0.1985399f, +0.3025954f, +0.0502630f, -0.4129718f, -0.1760948f,
  -0.0296458f, +0.0884375f, +0.0340799f, +0.1765604f, +0.1169643f, -0.1184429f, +0.1413966f, +0.0322473f,
  -0.0507080f, -0.2017034f, -0.3314176f, +0.0073236f, -0.0098189f, -0.1087935f, -0.2467691f, +0.3795791f,
  +0.3200012f, +0.2932410f, -0.2509927f, -0.0419236f, +0.3932722f, +0.2716707f, -0.3718369f, +0.5057066f,
  +0.5697383f, -0.0192687f, +0.4909574f, +0.3616133f, -0.2077571f, +0.1066006f, +0.3531724f, -0.0158469f,
  -0.4349095f, +0.0757768f, -0.7142417f, +0.0377814f, -0.3218099f, -0.3647185f, +0.3698658f, +0.8272562f,
  -0.0415648f, -0.2221289f, +0.1955313f, -0.0144092f, +0.5214716f, -0.3272204f, +0.0650750f, -0.3441975f,
  +0.2995573f, +0.3510825f, +0.0295908f, -0.0891808f, +0.1394015f, -0.0865928f, +0.0786080f, -0.3009090f,
  -0.4275613f, -0.0233496f, +0.3490165f, +0.0080401f, -0.1485553f, -0.3214898f, -0.1757935f, +0.1713068f,
  -0.0760770f, -0.1697382f, -0.1801164f, -0.1370250f, -0.2663503f, -0.1872033f, +0.0409638f, -0.2554610f,
  +0.0931860f, -0.0896646f, -0.0749520f, -0.2550645f, +0.1495607f, +0.2509798f, -0.1144861f, -0.3766346f,
  +0.2555350f, +0.0243381f, +0.7865302f, +0.1696132f, -0.1448570f, -0.3887694f, -0.0709550f, -0.9788603f,
  +0.4415722f, -0.0303368f, -0.2120071f, +0.1356915f, -0.3350882f, -0.0978517f, +0.1344156f, +0.3756260f,
  -0.3531370f, -0.0369060f, -0.1022134f, -0.0313255f, -0.0937100f, +0.1316857f, -0.1182517f, +0.0179305f,
  +0.3906838f, +0.1376981f, -0.3737002f, +0.1059895f, -0.0967523f, +0.2016356f, +0.3987180f, -0.1504515f,
  +0.5023018f, +0.4287337f, -0.7163276f, +0.3674902f, +0.1001371f, -0.4240083f, +0.3609580f, +0.6165922f,
  -0.1267821f, -0.0344941f, -0.0321272f, -0.2317104f, -0.0189795f, -0.0716882f, -0.3326221f, +0.0344229f,
  +0.0536338f, +0.0849810f, +0.0495806f, +0.1659108f, -0.2233313f, -0.1350226f, +0.2314484f, -0.2002561f,
  +0.1618200f, -0.0979094f, +0.0580661f, +0.0138486f, +0.0299425f, +0.3330151f, +0.1739967f, -0.0979007f,
  +0.1130590f, -0.2176815f, -0.1007196f, -0.0627698f, +0.0206750f, -0.0624387f, -0.2616260f, -0.1843635f,
  +0.2310144f, +0.1252237f, +0.2215612f, +0.1206803f, -0.3580124f, +0.5258148f, -0.0580873f, -0.3484459f,
  -0.0233746f, -0.0818143f, +0.3335026f, +0.0587937f, -0.3348309f, +0.1510029f, +0.1570943f, -0.0947777f,
  -0.3356180f, -0.0373932f, -0.3014157f, -0.0074977f, -0.0752983f, -0.0745768f, -0.1976293f, +0.1632470f,
  +0.0112347f, +0.1454943f, +0.2615919f, -0.0013639f, +0.0128607f, -0.1059206f, +0.1895423f, +0.1629844f,
  +0.3310073f, -0.1911019f, +0.6337670f, -0.1173901f, -0.0121856f, -0.1308122f, +0.2755212f, +0.3096524f,
  -0.4349194f, +0.0211079f, -0.5100082f, -0.2574722f, -0.0022996f, -0.0602373f, +0.2283795f, -0.1844101f,
  +0.1646600f, +0.2946740f, +0.2869884f, -0.0691441f, +0.3394067f, -0.0003411f, +0.0917355f, -0.1423354f,
  +0.1398679f, +0.1207108f, +0.0705858f, -0.3189686f, -0.0662443f, +0.0827883f, -0.0100720f, +0.1304495f
);

const float biases[4] = float[4](
  -0.0204577f, +0.0790454f, -0.1222971f, +0.1908042f
);

vec4 hook() {
    const vec4 r[9][2] = vec4[9][2](
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 1.0f)))
    );

    float sum[4] = biases;
    for (int n = 0; n < 4; n++) {
        for (int i = 0; i < 9; i++) {
            const vec4 k0 = vec4(kernels[n * 8 * 9 + 8 * i + 0], kernels[n * 8 * 9 + 8 * i + 1], kernels[n * 8 * 9 + 8 * i + 2], kernels[n * 8 * 9 + 8 * i + 3]);
            const vec4 k1 = vec4(kernels[n * 8 * 9 + 8 * i + 4], kernels[n * 8 * 9 + 8 * i + 5], kernels[n * 8 * 9 + 8 * i + 6], kernels[n * 8 * 9 + 8 * i + 7]);
            sum[n] += (dot(k0, r[i][0]) + dot(k1, r[i][1]));
        }
    }

    return ACTIVE(vec4(sum[0], sum[1], sum[2], sum[3]));
}

//!HOOK LUMA
//!DESC ARNet b16 Layer5 L1
//!WHEN OUTPUT.w LUMA.w / 1.2 > OUTPUT.h LUMA.h / 1.2 > *
//!BIND TMP2_L0
//!BIND TMP2_L1
//!SAVE TMP1_L1
//!COMPONENTS 4

#define ACTIVE(v) (max(v, v * 0.2000000f))

#define TEX_BIND_L0_TEXOFF TMP2_L0_texOff
#define TEX_BIND_L0_TEX TMP2_L0_tex
#define TEX_BIND_L0_POS TMP2_L0_pos
#define TEX_BIND_L0_SIZE TMP2_L0_size
#define TEX_BIND_L0_PT TMP2_L0_pt

#define TEX_BIND_L1_TEXOFF TMP2_L1_texOff
#define TEX_BIND_L1_TEX TMP2_L1_tex
#define TEX_BIND_L1_POS TMP2_L1_pos
#define TEX_BIND_L1_SIZE TMP2_L1_size
#define TEX_BIND_L1_PT TMP2_L1_pt

const float kernels[288] = float[288](
  -0.0245945f, -0.3410325f, -0.4590648f, -0.3727545f, +0.1233962f, -0.1461924f, -0.2343899f, -0.0216040f,
  +0.3196608f, +0.3928913f, +0.3700968f, -0.1736044f, +0.0293586f, -0.0000725f, -0.1739554f, -0.4865029f,
  +0.0000124f, +0.1555094f, +0.4547011f, +0.4598296f, +0.0246182f, +0.1679028f, +0.4024785f, +0.1184277f,
  -0.5559913f, +0.0141040f, -0.5382673f, +0.5926594f, -0.3216998f, +0.1145179f, -0.0658490f, +0.4136715f,
  -0.0620734f, -0.0910349f, -0.2106204f, -0.2906946f, -0.4130122f, +0.6025168f, -0.3441949f, -0.0471778f,
  -0.0125798f, -0.3815383f, +0.6219537f, -0.1379903f, +0.0919514f, -0.0591169f, -0.1152051f, -0.2399436f,
  +0.0358579f, +0.0662515f, +0.4421443f, +0.2355567f, -0.1208326f, +0.0932045f, +0.3485852f, +0.0500941f,
  -0.0353427f, +0.0087332f, -0.5475385f, +0.0009537f, -0.0377083f, +0.1326925f, -0.1685337f, +0.1973997f,
  +0.1187915f, -0.0492736f, -0.2163049f, -0.2181204f, +0.1393031f, -0.1449665f, -0.0607245f, +0.0514270f,
  +0.7701882f, +0.0059966f, -0.2666265f, -0.1146273f, +0.2944389f, +0.6313578f, -0.1882492f, -0.7066741f,
  +0.2108735f, +0.2012020f, -0.6993380f, -0.3878770f, +0.3994473f, +0.8858619f, -0.7279459f, -0.5017852f,
  -0.0833474f, +0.1507059f, +0.0294551f, +0.0847499f, -0.1664265f, +0.3107987f, -0.0273200f, -0.0469110f,
  -0.4360282f, -0.0264273f, -0.6075572f, -0.0604729f, -0.0422905f, -0.4795395f, +0.1989742f, +0.3942896f,
  -0.3219934f, +0.1975242f, +0.1697199f, -0.2930833f, +0.0099120f, -0.4726792f, +0.1350380f, -0.0108332f,
  +0.0089020f, -0.1631455f, +0.2202918f, -0.3545159f, +0.2607020f, +0.3007313f, -0.0418079f, -0.4021688f,
  -0.2005003f, +0.1678962f, +0.0953644f, -0.0444943f, +0.1236404f, -0.0657288f, +0.0576629f, -0.1497481f,
  +0.0676693f, +0.0676121f, -0.0167131f, +0.0306177f, -0.0796522f, -0.0363738f, +0.1038882f, -0.0471258f,
  +0.1822326f, -0.0750677f, +0.2378618f, -0.1634148f, +0.2228534f, +0.0309285f, -0.1211052f, -0.0486350f,
  -0.1812194f, +0.1347754f, -0.3838213f, -0.1443571f, +0.1629376f, -0.1326040f, +0.2504177f, +0.0837927f,
  +0.3288879f, +0.0879509f, +0.1501255f, -0.3415160f, +0.0933547f, +0.0046652f, -0.0158226f, -0.3958365f,
  -0.3326179f, +0.0600017f, +0.0823994f, -0.2480559f, -0.1176671f, +0.1534070f, -0.1286783f, +0.0356068f,
  -0.3380113f, -0.0397394f, -0.3596860f, +0.2325534f, +0.2168649f, -0.3643320f, +0.3230765f, +0.4304336f,
  +0.1586390f, -0.1430395f, +0.1036625f, -0.0963311f, -0.0862379f, -0.2748912f, +0.1039243f, -0.2472985f,
  +0.2464597f, -0.0118967f, -0.0660310f, -0.0710164f, -0.0314518f, +0.0830670f, -0.2011213f, +0.2142609f,
  -0.2059446f, +0.0472311f, -0.4062858f, +0.0471100f, +0.0877226f, -0.0765132f, +0.0640957f, -0.2133806f,
  +0.3688545f, +0.0883236f, +0.0088659f, +0.4419093f, -0.0695007f, +0.3124392f, +0.0391595f, -0.0387798f,
  -0.0324539f, -0.3011863f, +0.0115128f, -0.0159979f, -0.0265043f, +0.0968577f, -0.0454771f, -0.0349205f,
  +0.1638518f, +0.0923351f, +0.2580236f, +0.1800434f, -0.3393898f, +0.2169638f, -0.1538409f, +0.0768366f,
  +0.2191899f, -0.0940946f, +0.0816870f, -0.2901399f, -0.1104774f, +0.3887079f, +0.1189413f, +0.1576920f,
  -0.1852759f, +0.0069290f, +0.2303617f, -0.1548287f, -0.1574969f, +0.2349880f, -0.0791211f, -0.2435434f,
  +0.5697434f, -0.0113045f, +0.4867146f, -0.1086914f, +0.0480614f, -0.3615301f, +0.1480969f, +0.0209432f,
  -0.1482852f, +0.0807917f, +0.4471254f, +0.2372832f, +0.0334267f, -0.6604223f, +0.6069975f, -0.0095635f,
  +0.2044324f, -0.0071295f, +0.2587647f, -0.0967818f, +0.2493568f, -0.0430254f, -0.0337693f, +0.0898464f,
  -0.1967258f, +0.1061173f, +0.3581122f, -0.3090656f, +0.5556011f, +0.2895585f, +0.0383911f, +0.0584973f,
  -0.2252346f, +0.1873692f, +0.5677773f, +0.3710102f, +0.7269993f, -0.5266744f, -0.4714215f, +0.3038427f,
  -0.0706029f, +0.0509835f, -0.0399932f, +0.1146735f, +0.0944073f, -0.1861013f, +0.0863408f, -0.0571445f
);

const float biases[4] = float[4](
  -0.1084810f, +0.1292244f, +0.0630402f, +0.0152771f
);

vec4 hook() {
    const vec4 r[9][2] = vec4[9][2](
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 1.0f)))
    );

    float sum[4] = biases;
    for (int n = 0; n < 4; n++) {
        for (int i = 0; i < 9; i++) {
            const vec4 k0 = vec4(kernels[n * 8 * 9 + 8 * i + 0], kernels[n * 8 * 9 + 8 * i + 1], kernels[n * 8 * 9 + 8 * i + 2], kernels[n * 8 * 9 + 8 * i + 3]);
            const vec4 k1 = vec4(kernels[n * 8 * 9 + 8 * i + 4], kernels[n * 8 * 9 + 8 * i + 5], kernels[n * 8 * 9 + 8 * i + 6], kernels[n * 8 * 9 + 8 * i + 7]);
            sum[n] += (dot(k0, r[i][0]) + dot(k1, r[i][1]));
        }
    }

    return ACTIVE(vec4(sum[0], sum[1], sum[2], sum[3]));
}

//!HOOK LUMA
//!DESC ARNet b16 Layer6 L0
//!WHEN OUTPUT.w LUMA.w / 1.2 > OUTPUT.h LUMA.h / 1.2 > *
//!BIND TMP1_L0
//!BIND TMP1_L1
//!BIND TMP2_L0
//!SAVE TMP2_L0
//!COMPONENTS 4

#define ACTIVE(v) (v)

#define TEX_BIND_L0_TEXOFF TMP1_L0_texOff
#define TEX_BIND_L0_TEX TMP1_L0_tex
#define TEX_BIND_L0_POS TMP1_L0_pos
#define TEX_BIND_L0_SIZE TMP1_L0_size
#define TEX_BIND_L0_PT TMP1_L0_pt

#define TEX_BIND_L1_TEXOFF TMP1_L1_texOff
#define TEX_BIND_L1_TEX TMP1_L1_tex
#define TEX_BIND_L1_POS TMP1_L1_pos
#define TEX_BIND_L1_SIZE TMP1_L1_size
#define TEX_BIND_L1_PT TMP1_L1_pt

#define TEX_BIND_L2_TEXOFF TMP2_L0_texOff
#define TEX_BIND_L2_TEX TMP2_L0_tex
#define TEX_BIND_L2_POS TMP2_L0_pos
#define TEX_BIND_L2_SIZE TMP2_L0_size
#define TEX_BIND_L2_PT TMP2_L0_pt

const float kernels[288] = float[288](
  -0.0211902f, +0.3641546f, +0.0548687f, -0.2529587f, +0.2957305f, -0.0403796f, -0.0503553f, +0.3160609f,
  +0.2340388f, +0.4491000f, -0.2090847f, +0.1951968f, +0.4104233f, -0.0664584f, -0.0260993f, +0.2000330f,
  -0.0209100f, +0.0644605f, -0.1053396f, -0.0909449f, +0.2419111f, -0.0318715f, +0.4437499f, -0.1396254f,
  +0.5838560f, +0.0981397f, -0.4687327f, -0.0613468f, -0.2310484f, +0.1823972f, -0.3228640f, -0.0441696f,
  +0.2341604f, -0.0028625f, -0.0749483f, -0.3078462f, +0.3983978f, +0.4475920f, -0.3779455f, -0.2620756f,
  -0.4799543f, -0.1884847f, -0.1483297f, -0.1289788f, +0.1250350f, +0.1528760f, -0.1355607f, -0.0247695f,
  +0.0307958f, -0.0631389f, -0.3338312f, +0.0281881f, -0.2502027f, +0.0589504f, -0.1925464f, -0.0931869f,
  -0.3597847f, -0.1114983f, -0.2705306f, -0.0597592f, -0.0393495f, +0.3301521f, +0.0536360f, -0.2007373f,
  -0.0762527f, +0.1959186f, +0.0551378f, -0.1504827f, -0.0953684f, +0.0616982f, +0.2360844f, -0.0984307f,
  -0.1613905f, -0.0461812f, +0.0357584f, +0.1109440f, +0.0397431f, -0.0155721f, +0.0336371f, +0.1347960f,
  +0.3855110f, -0.1849448f, +0.0125876f, -0.0346558f, -0.1363085f, -0.0130692f, -0.3150083f, -0.1396335f,
  +0.0173553f, +0.0122315f, -0.0596702f, -0.0215546f, -0.1201955f, +0.2158089f, -0.1997866f, -0.3564646f,
  +0.0428098f, -0.3882535f, -0.1734085f, +0.0912869f, +0.0895739f, -0.2282907f, +0.3705880f, -0.2317465f,
  +0.2331285f, -0.1346449f, -0.2046676f, -0.1237897f, -0.1792563f, +0.0309996f, +0.2045980f, +0.0331388f,
  -0.0435554f, +0.1700309f, +0.1574308f, +0.2086110f, -0.0612134f, -0.1383370f, +0.2129695f, +0.0663654f,
  -0.1596181f, -0.2775849f, -0.2781076f, -0.1144811f, +0.4936281f, -0.1911629f, -0.0497816f, +0.0846918f,
  -0.0582030f, -0.1441038f, -0.7341474f, -0.1414258f, -0.4628493f, +0.0423124f, -0.2629238f, +0.4091924f,
  +0.0497232f, -0.1310217f, -0.2389347f, +0.1993707f, +0.0856464f, -0.2199866f, -0.0321927f, -0.0138685f,
  -0.1389277f, -0.1233399f, +0.1204058f, -0.1343011f, +0.1411987f, -0.0181847f, -0.0533930f, +0.0143622f,
  +0.1932356f, -0.5311664f, -0.1085554f, -0.2075552f, -0.1265841f, +0.0775708f, +0.1172869f, -0.2819031f,
  +0.0007624f, +0.3850377f, -0.0314317f, +0.1118373f, -0.0279207f, +0.1880355f, +0.0400791f, +0.3528868f,
  -0.0722617f, -0.1736370f, -0.0663285f, -0.2145381f, -0.4655033f, -0.1962009f, -0.0736375f, -0.3879893f,
  +0.1555578f, +0.0173091f, +0.2482948f, -0.1545698f, +0.1442955f, +0.0306397f, +0.2001163f, -0.5396647f,
  +0.1742902f, +0.2596532f, -0.1260009f, -0.0211831f, +0.0095608f, +0.4995241f, +0.1595933f, -0.3746029f,
  -0.4535257f, -0.0118168f, -0.1829349f, -0.0594117f, -0.2931632f, -0.1239727f, -0.0706394f, -0.0777453f,
  -0.0376133f, +0.3197027f, -0.2233864f, +0.1684494f, +0.1225533f, -0.3522851f, +0.0074843f, -0.1507678f,
  -0.1038432f, -0.0311835f, +0.0894554f, -0.1037704f, +0.1458214f, -0.4152832f, +0.2861476f, -0.2845537f,
  +0.2245019f, +0.3108782f, -0.0913422f, +0.2962182f, +0.0857018f, +0.1051805f, -0.0214071f, -0.0988227f,
  -0.0576858f, +0.0584475f, -0.0008818f, -0.1102993f, -0.0772288f, -0.0819285f, +0.0292717f, -0.2793774f,
  +0.0436799f, -0.2846153f, -0.0064750f, -0.1468752f, -0.0974680f, +0.0651013f, -0.0981995f, -0.2960091f,
  +0.2885279f, -0.2280314f, -0.3729365f, -0.0184413f, +0.1964695f, +0.0841122f, -0.0730571f, +0.1558616f,
  +0.3855505f, +0.0647358f, +0.5014320f, +0.1971777f, -0.1464868f, -0.2819188f, -0.2777696f, -0.6709861f,
  +0.1909358f, +0.1952600f, +0.1081118f, -0.1135775f, -0.0035214f, -0.4125293f, -0.4042310f, +0.2798375f,
  +0.2458827f, +0.1663523f, -0.1424636f, +0.1799532f, +0.2254053f, +0.0997895f, -0.0634941f, -0.0028275f,
  +0.2442404f, +0.1809870f, +0.1355134f, -0.1289862f, -0.2324183f, -0.1173160f, +0.1045876f, +0.1930505f,
  +0.1582155f, -0.2403293f, -0.3712031f, -0.1503588f, -0.0015112f, -0.3437375f, +0.0354262f, -0.0887656f
);

const float biases[4] = float[4](
  +0.1634068f, +0.0168390f, +0.0614357f, +0.1648214f
);

vec4 hook() {
    const vec4 r[9][2] = vec4[9][2](
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 1.0f)))
    );

    float sum[4] = biases;
    for (int n = 0; n < 4; n++) {
        for (int i = 0; i < 9; i++) {
            const vec4 k0 = vec4(kernels[n * 8 * 9 + 8 * i + 0], kernels[n * 8 * 9 + 8 * i + 1], kernels[n * 8 * 9 + 8 * i + 2], kernels[n * 8 * 9 + 8 * i + 3]);
            const vec4 k1 = vec4(kernels[n * 8 * 9 + 8 * i + 4], kernels[n * 8 * 9 + 8 * i + 5], kernels[n * 8 * 9 + 8 * i + 6], kernels[n * 8 * 9 + 8 * i + 7]);
            sum[n] += (dot(k0, r[i][0]) + dot(k1, r[i][1]));
        }
    }

    return ACTIVE(vec4(sum[0], sum[1], sum[2], sum[3]) * 0.2000000f + TEX_BIND_L2_TEXOFF(vec2(0.0f, 0.0f)));
}

//!HOOK LUMA
//!DESC ARNet b16 Layer6 L1
//!WHEN OUTPUT.w LUMA.w / 1.2 > OUTPUT.h LUMA.h / 1.2 > *
//!BIND TMP1_L0
//!BIND TMP1_L1
//!BIND TMP2_L1
//!SAVE TMP2_L1
//!COMPONENTS 4

#define ACTIVE(v) (v)

#define TEX_BIND_L0_TEXOFF TMP1_L0_texOff
#define TEX_BIND_L0_TEX TMP1_L0_tex
#define TEX_BIND_L0_POS TMP1_L0_pos
#define TEX_BIND_L0_SIZE TMP1_L0_size
#define TEX_BIND_L0_PT TMP1_L0_pt

#define TEX_BIND_L1_TEXOFF TMP1_L1_texOff
#define TEX_BIND_L1_TEX TMP1_L1_tex
#define TEX_BIND_L1_POS TMP1_L1_pos
#define TEX_BIND_L1_SIZE TMP1_L1_size
#define TEX_BIND_L1_PT TMP1_L1_pt

#define TEX_BIND_L2_TEXOFF TMP2_L1_texOff
#define TEX_BIND_L2_TEX TMP2_L1_tex
#define TEX_BIND_L2_POS TMP2_L1_pos
#define TEX_BIND_L2_SIZE TMP2_L1_size
#define TEX_BIND_L2_PT TMP2_L1_pt

const float kernels[288] = float[288](
  +0.0030618f, -0.0093446f, -0.0576558f, +0.3308878f, +0.2828910f, -0.0087590f, -0.0712924f, -0.0935635f,
  -0.1265496f, +0.0494668f, -0.0250230f, +0.0583443f, +0.0185043f, +0.2459783f, +0.1521118f, -0.1379256f,
  +0.5695707f, +0.1168965f, -0.1130248f, +0.6124926f, +0.0225294f, -0.1772335f, +0.2820927f, -0.3577974f,
  +0.4101912f, -0.0215667f, -0.0859357f, +0.4370401f, +0.5626362f, -0.1428830f, -0.0038812f, +0.1346903f,
  +0.0213907f, +0.3069586f, +0.1545036f, +0.3292350f, +0.2543455f, -0.2662231f, +0.1699757f, +0.1411033f,
  +0.3432320f, +0.1699436f, -0.0597502f, +0.3335872f, +0.0045617f, -0.1152919f, -0.1646837f, +0.2044101f,
  +0.4521282f, +0.0435353f, -0.0444156f, +0.1559636f, +0.3330050f, -0.0652447f, +0.0822232f, +0.1955060f,
  +0.0053706f, -0.1393184f, +0.1159139f, +0.1248872f, +0.5204070f, -0.5407256f, +0.4402269f, -0.1806105f,
  +0.1567059f, -0.1407733f, +0.2917640f, +0.1980458f, +0.0826246f, +0.1099483f, -0.0956560f, +0.0791161f,
  -0.2260849f, -0.1016041f, +0.0715684f, -0.0744340f, -0.1997090f, -0.0577243f, +0.1347932f, +0.0494057f,
  +0.0828195f, -0.2087260f, +0.0866581f, -0.1540159f, -0.4479586f, -0.0254912f, +0.0967225f, +0.2492134f,
  -0.1624694f, -0.0187701f, -0.0296220f, +0.0654682f, -0.2678645f, +0.1328290f, -0.1005086f, +0.1224037f,
  -0.0701576f, -0.0565072f, -0.3092051f, -0.1324374f, +0.0111421f, -0.1863552f, +0.0971873f, -0.1301833f,
  -0.4944125f, -0.2618298f, +0.1547138f, +0.0352999f, -0.1752433f, +0.2454369f, +0.1067853f, +0.2214534f,
  -0.3231695f, -0.0029269f, +0.1235765f, +0.0023904f, -0.2513429f, +0.2028731f, -0.0023783f, +0.1087122f,
  -0.3893757f, -0.2329207f, -0.2349116f, -0.0719675f, +0.0370399f, -0.0483107f, +0.0368493f, -0.0763268f,
  -0.3481539f, -0.0753592f, +0.1006559f, -0.2818367f, -0.2736977f, +0.2847663f, +0.2425638f, +0.0624787f,
  -0.2352154f, -0.0182464f, +0.0247021f, +0.0084546f, -0.0276268f, +0.0401426f, -0.0049643f, +0.1862939f,
  -0.0728438f, +0.0092074f, +0.0220258f, -0.2225352f, -0.0204459f, -0.0800113f, +0.1196307f, +0.1303551f,
  +0.0889227f, -0.4851582f, +0.0028369f, -0.0366614f, +0.1402037f, -0.1591923f, +0.0181964f, -0.0187516f,
  +0.0534070f, -0.1054200f, +0.0192882f, -0.2822626f, -0.2202775f, +0.2458043f, -0.3089354f, -0.2935265f,
  +0.1737157f, -0.3296257f, +0.4485607f, -0.5030515f, +0.0589866f, +0.0078073f, +0.3341636f, +0.1795569f,
  -0.4090807f, +0.2928595f, -0.0709501f, -0.1681595f, +0.1071101f, -0.2942844f, -0.3117376f, +0.5967328f,
  +0.3747691f, -0.3820494f, -0.2164168f, +0.2778246f, +0.1019745f, -0.3809031f, -0.1484633f, -0.2284450f,
  -0.1431364f, -0.2408778f, +0.1395226f, -0.1267187f, +0.3187636f, -0.1953879f, +0.4622884f, -0.2798732f,
  -0.1508627f, -0.1253126f, -0.2516044f, +0.2761340f, -0.4702201f, +0.3704106f, -0.2105359f, +0.1079921f,
  +0.3870335f, -0.0509163f, +0.0801771f, +0.2711382f, -0.0186648f, +0.4434547f, +0.1407985f, -0.3870636f,
  +0.0141484f, -0.0208657f, +0.0200261f, -0.0739926f, -0.4618464f, +0.2335972f, +0.0145902f, -0.2228384f,
  +0.5907176f, -0.0596165f, -0.1032564f, +0.2237999f, -0.0150950f, +0.1735084f, -0.0884290f, -0.7236675f,
  +0.4179365f, +0.1531186f, -0.0757257f, -0.0188476f, -0.1364648f, +0.1355158f, +0.1443348f, -0.1675036f,
  +0.1403113f, +0.4298749f, +0.2165493f, -0.0113018f, -0.3027913f, +0.0427228f, -0.0406544f, +0.2859121f,
  +0.2084278f, +0.5319890f, +0.4414139f, +0.1172323f, +0.6180241f, -0.4369923f, -0.2894630f, +0.5141284f,
  +0.5567848f, -0.4072119f, +0.1185784f, -0.1493458f, -0.1792627f, -0.2901148f, +0.1394414f, -0.4549710f,
  +0.3706627f, -0.1837305f, +0.0264280f, +0.2415792f, -0.0933477f, +0.1147823f, -0.0143748f, -0.0649371f,
  +0.5100696f, -0.2093491f, +0.4642074f, +0.1788404f, +0.4790623f, -0.4177486f, -0.1655856f, -0.1806795f,
  -0.0346186f, -0.0293342f, +0.4439158f, -0.3742459f, -0.0396130f, -0.1130309f, +0.0893298f, -0.1416301f
);

const float biases[4] = float[4](
  -0.2305419f, +0.3237599f, +0.1349826f, +0.0024184f
);

vec4 hook() {
    const vec4 r[9][2] = vec4[9][2](
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 1.0f)))
    );

    float sum[4] = biases;
    for (int n = 0; n < 4; n++) {
        for (int i = 0; i < 9; i++) {
            const vec4 k0 = vec4(kernels[n * 8 * 9 + 8 * i + 0], kernels[n * 8 * 9 + 8 * i + 1], kernels[n * 8 * 9 + 8 * i + 2], kernels[n * 8 * 9 + 8 * i + 3]);
            const vec4 k1 = vec4(kernels[n * 8 * 9 + 8 * i + 4], kernels[n * 8 * 9 + 8 * i + 5], kernels[n * 8 * 9 + 8 * i + 6], kernels[n * 8 * 9 + 8 * i + 7]);
            sum[n] += (dot(k0, r[i][0]) + dot(k1, r[i][1]));
        }
    }

    return ACTIVE(vec4(sum[0], sum[1], sum[2], sum[3]) * 0.2000000f + TEX_BIND_L2_TEXOFF(vec2(0.0f, 0.0f)));
}

//!HOOK LUMA
//!DESC ARNet b16 Layer7 L0
//!WHEN OUTPUT.w LUMA.w / 1.2 > OUTPUT.h LUMA.h / 1.2 > *
//!BIND TMP2_L0
//!BIND TMP2_L1
//!SAVE TMP1_L0
//!COMPONENTS 4

#define ACTIVE(v) (max(v, v * 0.2000000f))

#define TEX_BIND_L0_TEXOFF TMP2_L0_texOff
#define TEX_BIND_L0_TEX TMP2_L0_tex
#define TEX_BIND_L0_POS TMP2_L0_pos
#define TEX_BIND_L0_SIZE TMP2_L0_size
#define TEX_BIND_L0_PT TMP2_L0_pt

#define TEX_BIND_L1_TEXOFF TMP2_L1_texOff
#define TEX_BIND_L1_TEX TMP2_L1_tex
#define TEX_BIND_L1_POS TMP2_L1_pos
#define TEX_BIND_L1_SIZE TMP2_L1_size
#define TEX_BIND_L1_PT TMP2_L1_pt

const float kernels[288] = float[288](
  +0.1822913f, +0.1332107f, -0.0924201f, -0.0634016f, -0.2565283f, -0.2911779f, -0.2636850f, -0.0593788f,
  +0.0893590f, +0.1392853f, -0.2883135f, -0.0599409f, +0.1972837f, +0.0832569f, -0.0916473f, +0.1587610f,
  +0.0893489f, +0.1971150f, -0.1485725f, -0.2922868f, +0.0898125f, +0.1430845f, -0.1351377f, +0.0731360f,
  +0.1716276f, +0.0306281f, -0.0122016f, -0.1391993f, -0.0024580f, -0.2007997f, +0.1597958f, -0.2738653f,
  -0.5416812f, -0.0058700f, -0.0099278f, -0.3227782f, -0.0353778f, -0.2481974f, +0.7363719f, +0.1292550f,
  -0.2448841f, -0.0224987f, +0.1235384f, -0.0801061f, -0.1102797f, -0.2715414f, -0.1682522f, +0.2141645f,
  +0.1711170f, +0.1684273f, +0.2305218f, -0.0856784f, -0.0591913f, -0.3633698f, -0.0746705f, +0.0633643f,
  -0.1253086f, +0.1654409f, -0.0916674f, -0.1512308f, -0.1002791f, -0.4590815f, -0.2074495f, -0.1449265f,
  -0.0791721f, +0.0510985f, +0.1137986f, -0.2340246f, -0.1724157f, +0.0895013f, -0.0503613f, +0.0176656f,
  +0.2882033f, +0.1936056f, -0.0584392f, -0.0103164f, +0.0140609f, +0.3092816f, -0.2294584f, +0.1958698f,
  -0.3230495f, -0.3155755f, -0.2348820f, -0.0748954f, +0.2837555f, +0.2077331f, +0.3645281f, +0.1414587f,
  +0.0456545f, -0.2650363f, -0.1387640f, +0.1110765f, +0.2500519f, -0.1609639f, +0.2391558f, -0.3347197f,
  -0.0499637f, +0.2234885f, -0.2477453f, +0.1495666f, -0.4176694f, +0.1117594f, -0.0991062f, +0.2023712f,
  -0.2650765f, -0.3791625f, -0.1303433f, -0.1912749f, +0.0331771f, +0.0274215f, +0.0267218f, +0.4963848f,
  -0.1301880f, +0.2956558f, +0.0038519f, +0.0292103f, +0.7807173f, -0.1929310f, +0.0958056f, -0.4522006f,
  -0.2470455f, -0.0334836f, +0.2566208f, -0.1187669f, +0.1881689f, -0.2261348f, -0.1470349f, -0.0448676f,
  -0.0772340f, -0.3505729f, +0.3180873f, -0.1921401f, -0.5538230f, +0.1729029f, +0.2818276f, +0.1634876f,
  +0.4835620f, +0.1288128f, -0.0039115f, +0.0720762f, -0.0501157f, +0.1759387f, +0.2609200f, -0.2805069f,
  -0.2330353f, +0.0908980f, -0.4092494f, -0.0001920f, -0.2461118f, -0.0809250f, +0.1443069f, +0.0219058f,
  +0.1675436f, +0.1428768f, -0.2577927f, +0.0780322f, +0.2991742f, +0.1140393f, -0.0456226f, -0.2346502f,
  -0.1497910f, -0.1523082f, +0.3202498f, +0.1430051f, -0.1517265f, +0.4056941f, +0.0251599f, -0.2933587f,
  -0.1792874f, -0.0467538f, -0.0859944f, +0.0094060f, +0.1129683f, +0.2259718f, +0.1314116f, +0.1293407f,
  +0.1928183f, -0.0458243f, +0.4252096f, +0.1298248f, +0.1577831f, -0.1277053f, +0.2826008f, +0.1418002f,
  -0.0550500f, +0.0912234f, +0.2583851f, +0.1952252f, +0.0632049f, +0.1496156f, +0.2293729f, -0.1896438f,
  -0.0933352f, -0.1323272f, -0.1723648f, +0.0376284f, +0.1806763f, -0.0239803f, -0.1911622f, +0.0851232f,
  +0.3165461f, +0.1045434f, -0.0781865f, -0.0496791f, -0.1894497f, -0.2340233f, -0.1814395f, +0.0552350f,
  +0.1471571f, -0.2779627f, -0.1978884f, +0.1463494f, -0.1608127f, +0.0605056f, -0.0665886f, +0.0884515f,
  +0.0554029f, +0.2108229f, +0.1648146f, +0.0707535f, +0.0619498f, -0.2112255f, -0.2938930f, -0.0767068f,
  -0.5530147f, +0.0499587f, -0.6743774f, -0.0653592f, +0.1421600f, -0.6583634f, -0.0617189f, -0.1344843f,
  +0.1375671f, -0.1762924f, +0.0685889f, -0.0218498f, +0.1120861f, +0.0638222f, +0.0190627f, +0.0093207f,
  +0.1669274f, -0.1301769f, +0.3827069f, -0.0459512f, -0.1599339f, +0.1204644f, +0.1975944f, +0.4460943f,
  +0.2622597f, -0.1446114f, +0.1004618f, -0.5152233f, +0.4548843f, +0.2510015f, -0.4565005f, -0.8697302f,
  -0.0635150f, +0.1541617f, -0.1641845f, -0.1630593f, -0.1663150f, +0.0831076f, +0.2238904f, -0.3543147f,
  +0.3682549f, +0.0624711f, +0.4130154f, -0.0251061f, +0.3096721f, -0.0486480f, +0.2036183f, -0.3157495f,
  +0.3573950f, -0.2105610f, +0.4660560f, +0.1526525f, +0.1970294f, -0.0063062f, +0.3267197f, -0.0175682f,
  +0.2064515f, +0.1050806f, +0.0595326f, +0.0603528f, -0.1918641f, +0.1207265f, +0.0017387f, +0.0019312f
);

const float biases[4] = float[4](
  -0.6024258f, -0.0874644f, +0.1625950f, -0.1267865f
);

vec4 hook() {
    const vec4 r[9][2] = vec4[9][2](
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 1.0f)))
    );

    float sum[4] = biases;
    for (int n = 0; n < 4; n++) {
        for (int i = 0; i < 9; i++) {
            const vec4 k0 = vec4(kernels[n * 8 * 9 + 8 * i + 0], kernels[n * 8 * 9 + 8 * i + 1], kernels[n * 8 * 9 + 8 * i + 2], kernels[n * 8 * 9 + 8 * i + 3]);
            const vec4 k1 = vec4(kernels[n * 8 * 9 + 8 * i + 4], kernels[n * 8 * 9 + 8 * i + 5], kernels[n * 8 * 9 + 8 * i + 6], kernels[n * 8 * 9 + 8 * i + 7]);
            sum[n] += (dot(k0, r[i][0]) + dot(k1, r[i][1]));
        }
    }

    return ACTIVE(vec4(sum[0], sum[1], sum[2], sum[3]));
}

//!HOOK LUMA
//!DESC ARNet b16 Layer7 L1
//!WHEN OUTPUT.w LUMA.w / 1.2 > OUTPUT.h LUMA.h / 1.2 > *
//!BIND TMP2_L0
//!BIND TMP2_L1
//!SAVE TMP1_L1
//!COMPONENTS 4

#define ACTIVE(v) (max(v, v * 0.2000000f))

#define TEX_BIND_L0_TEXOFF TMP2_L0_texOff
#define TEX_BIND_L0_TEX TMP2_L0_tex
#define TEX_BIND_L0_POS TMP2_L0_pos
#define TEX_BIND_L0_SIZE TMP2_L0_size
#define TEX_BIND_L0_PT TMP2_L0_pt

#define TEX_BIND_L1_TEXOFF TMP2_L1_texOff
#define TEX_BIND_L1_TEX TMP2_L1_tex
#define TEX_BIND_L1_POS TMP2_L1_pos
#define TEX_BIND_L1_SIZE TMP2_L1_size
#define TEX_BIND_L1_PT TMP2_L1_pt

const float kernels[288] = float[288](
  +0.1245027f, -0.0484621f, -0.5392004f, -0.1363649f, +0.2241274f, -0.0758217f, -0.2517587f, +0.3303706f,
  +0.1468139f, +0.2715919f, +0.0170138f, +0.3602524f, +0.3051320f, +0.0681417f, +0.1117925f, -0.3089521f,
  +0.1392203f, +0.1739846f, -0.1258998f, -0.2276668f, +0.1043454f, +0.2573279f, -0.0607179f, +0.0202982f,
  +0.2190140f, -0.0868209f, -0.1740497f, -0.1832060f, +0.3312120f, -0.1197055f, -0.5023645f, -0.3933463f,
  -0.1198134f, +0.2704765f, -0.3744941f, +0.2879910f, +0.2756851f, -0.1052186f, +0.2367358f, -0.4831484f,
  +0.2082121f, +0.4916427f, -0.0586001f, -0.1564979f, +0.3440092f, -0.2568525f, +0.6162268f, +0.1618130f,
  +0.0772941f, -0.1968273f, +0.5222906f, +0.2687935f, -0.4554602f, +0.0918835f, +0.2041460f, -0.2286286f,
  -0.2245309f, -0.0100171f, +0.1689792f, +0.1126330f, +0.3057125f, +0.0989819f, +0.0929022f, -0.4856985f,
  +0.0581684f, +0.1908446f, +0.0754469f, -0.2446438f, -0.3275658f, -0.1867859f, +0.2827494f, -0.1559969f,
  -0.4392368f, +0.1351506f, +0.1312392f, +0.1679341f, +0.0480242f, +0.2006444f, +0.0091949f, +0.4957950f,
  -0.0739051f, -0.1974812f, -0.1533573f, -0.2203488f, -0.0540738f, +0.4171048f, -0.0843946f, -0.3820301f,
  -0.3209220f, -0.0130137f, -0.0116150f, +0.0156083f, +0.0672542f, +0.1058342f, +0.0703537f, -0.0947889f,
  +0.1317452f, +0.0124712f, -0.0468019f, -0.1886154f, -0.5070744f, -0.2391309f, -0.1561125f, +0.1611421f,
  +0.6758054f, +0.3907453f, -0.2507471f, +0.1520724f, -0.1558997f, +0.2975740f, -0.5104327f, -1.4367223f,
  +0.1269783f, +0.3171138f, -0.2452419f, -0.0101135f, -0.0656376f, +0.4536507f, +0.0745818f, +0.0725779f,
  +0.0803803f, -0.0972372f, +0.3858568f, +0.0169581f, -0.0632331f, +0.0723205f, +0.2556214f, -0.4059400f,
  +0.2601343f, -0.0761872f, -0.1634734f, -0.0976951f, +0.1870541f, -0.1463463f, +0.7139205f, -0.7118370f,
  -0.1321567f, -0.0410850f, -0.3134688f, -0.5774785f, -0.0076369f, -0.0196253f, +0.0346478f, +0.1280833f,
  -0.0253129f, +0.0957556f, +0.1856336f, +0.1563483f, +0.0486795f, +0.1284894f, +0.3117681f, +0.4293970f,
  +0.0704728f, +0.5155013f, +0.2782161f, -0.0930921f, -0.4068365f, -0.1649054f, +0.1347500f, +0.1929975f,
  +0.2091798f, -0.5476696f, +0.6129482f, +0.0455808f, +0.0882873f, +0.0382615f, -0.1802111f, +0.1462755f,
  -0.0782786f, -0.0074473f, +0.3019573f, +0.1323417f, +0.0109752f, +0.1195007f, +0.2642045f, +0.4660822f,
  -0.2011901f, +0.2109794f, -0.7657209f, -0.1427823f, -0.4355555f, -0.2091722f, +0.3664980f, -0.2026740f,
  +0.0757385f, -0.3114517f, -0.3323966f, +0.1982722f, +0.3332322f, -0.3080310f, -0.1702638f, -0.0010784f,
  -0.0651059f, -0.0004363f, -0.3286101f, +0.2177470f, +0.5290211f, +0.0797800f, -0.0463517f, +0.4152283f,
  -0.2322597f, -0.0135006f, -0.2903781f, -0.1810688f, +0.0722800f, +0.1466071f, -0.2415327f, +0.1392816f,
  +0.2573561f, -0.0499873f, +0.0146081f, +0.1087263f, +0.1436407f, -0.2114682f, -0.1647327f, +0.2925138f,
  +0.3114690f, +0.2476318f, +0.6914039f, -0.2813914f, +0.1187420f, -0.2176881f, +0.5155205f, -0.3866943f,
  +0.1780185f, +0.1418425f, +0.6815121f, +0.2726043f, -0.2873644f, -0.2678139f, +0.7379029f, +0.2486495f,
  +0.1631435f, -0.0211875f, +0.0237118f, +0.4074062f, -0.4058999f, -0.3077572f, -0.0673064f, -0.1066169f,
  +0.5847596f, +0.0850101f, -0.1344427f, -0.2467488f, +0.2773161f, +0.2738196f, +0.3931063f, -0.5459206f,
  +0.5811586f, +0.6006271f, -0.0247180f, +0.2083192f, -0.0229501f, +0.3893717f, +0.7512929f, +0.2743091f,
  -0.1069618f, -0.0090229f, -0.1362371f, +0.2328467f, +0.1461675f, -0.0281830f, -0.0238609f, +0.2348836f,
  -0.1002902f, +0.1606517f, -0.2345935f, -0.3357931f, +0.4708122f, -0.0880629f, +0.0736875f, -0.0576350f,
  -0.1283566f, +0.0684757f, -0.0755302f, +0.1727100f, +0.0579875f, +0.4512928f, -0.0698072f, +0.1277393f,
  -0.3596876f, +0.3702249f, -0.3956040f, +0.0346412f, +0.1269660f, -0.2365047f, -0.1191263f, +0.2098582f
);

const float biases[4] = float[4](
  -0.0697739f, -0.0517261f, +0.0042628f, -0.0874026f
);

vec4 hook() {
    const vec4 r[9][2] = vec4[9][2](
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 1.0f)))
    );

    float sum[4] = biases;
    for (int n = 0; n < 4; n++) {
        for (int i = 0; i < 9; i++) {
            const vec4 k0 = vec4(kernels[n * 8 * 9 + 8 * i + 0], kernels[n * 8 * 9 + 8 * i + 1], kernels[n * 8 * 9 + 8 * i + 2], kernels[n * 8 * 9 + 8 * i + 3]);
            const vec4 k1 = vec4(kernels[n * 8 * 9 + 8 * i + 4], kernels[n * 8 * 9 + 8 * i + 5], kernels[n * 8 * 9 + 8 * i + 6], kernels[n * 8 * 9 + 8 * i + 7]);
            sum[n] += (dot(k0, r[i][0]) + dot(k1, r[i][1]));
        }
    }

    return ACTIVE(vec4(sum[0], sum[1], sum[2], sum[3]));
}

//!HOOK LUMA
//!DESC ARNet b16 Layer8 L0
//!WHEN OUTPUT.w LUMA.w / 1.2 > OUTPUT.h LUMA.h / 1.2 > *
//!BIND TMP1_L0
//!BIND TMP1_L1
//!BIND TMP2_L0
//!SAVE TMP2_L0
//!COMPONENTS 4

#define ACTIVE(v) (v)

#define TEX_BIND_L0_TEXOFF TMP1_L0_texOff
#define TEX_BIND_L0_TEX TMP1_L0_tex
#define TEX_BIND_L0_POS TMP1_L0_pos
#define TEX_BIND_L0_SIZE TMP1_L0_size
#define TEX_BIND_L0_PT TMP1_L0_pt

#define TEX_BIND_L1_TEXOFF TMP1_L1_texOff
#define TEX_BIND_L1_TEX TMP1_L1_tex
#define TEX_BIND_L1_POS TMP1_L1_pos
#define TEX_BIND_L1_SIZE TMP1_L1_size
#define TEX_BIND_L1_PT TMP1_L1_pt

#define TEX_BIND_L2_TEXOFF TMP2_L0_texOff
#define TEX_BIND_L2_TEX TMP2_L0_tex
#define TEX_BIND_L2_POS TMP2_L0_pos
#define TEX_BIND_L2_SIZE TMP2_L0_size
#define TEX_BIND_L2_PT TMP2_L0_pt

const float kernels[288] = float[288](
  -0.4971094f, -0.0273723f, -0.4121617f, -0.1232440f, +0.0251733f, -0.0135590f, -0.3502807f, -0.1694879f,
  +0.1526390f, -0.4585278f, -0.1393253f, -0.3382280f, +0.1652939f, -0.0814757f, -0.1689973f, -0.1886668f,
  -0.0670047f, +0.0132229f, -0.0941344f, +0.0064810f, -0.1439747f, +0.0123812f, +0.0264672f, +0.1649475f,
  -0.1967613f, +0.6303737f, -0.0811511f, +0.0424076f, -0.2884275f, +0.1259285f, -0.3882219f, -0.2541429f,
  +1.2257988f, +0.0917039f, +0.0787817f, -0.1500700f, -0.3875076f, -0.1500962f, -0.0716762f, -0.3361877f,
  -0.1416879f, +0.2629986f, -0.1214792f, -0.0167794f, -0.1799503f, -0.2773584f, -0.3458620f, -0.4421717f,
  -0.4285913f, -0.1308360f, +0.0233472f, -0.0571289f, +0.0953204f, +0.0222029f, -0.0093939f, -0.1400775f,
  -0.1788978f, -0.2268780f, +0.1256624f, +0.3656144f, +0.1090700f, -0.2260304f, +0.1363293f, +0.0064583f,
  -0.2333175f, -0.0174068f, -0.2763075f, -0.0021652f, +0.2040146f, -0.0607953f, -0.0867328f, +0.0562998f,
  +0.1711064f, -0.1486772f, +0.0986535f, -0.0443629f, -0.0620329f, +0.0177163f, -0.1527359f, -0.3986159f,
  -0.1921321f, +0.0940497f, +0.0139726f, -0.0978500f, +0.1228974f, -0.1349281f, -0.1681242f, -0.2176320f,
  +0.1767141f, +0.0026207f, -0.1423142f, -0.3070551f, +0.2007699f, +0.1500199f, -0.0343001f, -0.0859044f,
  +0.3996401f, +0.1098684f, -0.0058196f, +0.0459692f, -0.5520502f, +0.0745556f, +0.0641806f, -0.1108431f,
  -0.2318540f, +0.4458745f, +0.4066002f, +0.2918401f, -0.7990886f, +0.0339892f, +0.1102769f, +0.0166602f,
  +0.2123809f, +0.2315420f, +0.2202328f, +0.3086166f, -0.0175753f, +0.1675243f, +0.0924151f, +0.0963444f,
  -0.5292124f, +0.2433251f, -0.0409236f, -0.0182544f, +0.0390789f, -0.0281704f, +0.0550759f, -0.2658477f,
  -0.1467498f, +0.5283504f, -0.5431489f, -0.2417824f, -0.2394856f, +0.0030883f, -0.0571118f, +0.2273539f,
  +0.0803971f, -0.0969784f, -0.3146370f, -0.2086051f, +0.0929605f, +0.0381949f, -0.2539099f, +0.2896182f,
  -0.4742355f, -0.1558963f, +0.0547575f, +0.0963380f, +0.0507298f, +0.0653847f, +0.5208465f, +0.3757448f,
  -0.3311421f, +0.0353998f, -0.2201786f, +0.0484541f, -0.0401683f, +0.0724649f, +0.1746475f, -0.2136824f,
  -0.0764419f, +0.1526022f, -0.2161200f, -0.1339754f, -0.0118830f, +0.3574747f, +0.0072548f, +0.2028238f,
  -0.0850827f, +0.3162500f, -0.1869856f, -0.1222556f, +0.2352210f, +0.2511561f, +0.4819345f, -0.0739149f,
  +1.1021036f, +0.1776775f, -0.1425280f, +0.0823395f, -0.3576170f, +0.1815950f, +0.1938677f, +0.1993091f,
  +0.2399902f, -0.1291085f, -0.1009431f, -0.1857536f, +0.2008960f, +0.2676565f, -0.1468453f, -0.1729290f,
  -0.0492264f, -0.0556660f, -0.1527621f, +0.1245661f, +0.0217826f, -0.1541435f, -0.0373139f, +0.3136655f,
  +0.2792475f, +0.2991931f, +0.3550176f, -0.2529065f, -0.0086582f, -0.0440013f, +0.0315367f, -0.2463167f,
  -0.1025341f, +0.1089662f, +0.1200997f, +0.2360541f, -0.0224601f, +0.0410452f, -0.0344971f, -0.3121500f,
  +0.1109884f, -0.1174757f, -0.0670664f, -0.1597960f, +0.0195521f, +0.0999502f, -0.2708865f, -0.3517111f,
  +0.0679201f, +0.3440601f, +0.0739620f, -0.2703231f, -0.1019875f, +0.3948438f, +0.3476094f, +0.2153316f,
  -0.2033086f, +0.0533881f, -0.1629007f, -0.0065687f, -0.0313724f, -0.0126970f, -0.2315684f, -0.0516219f,
  -0.2473224f, +0.1791773f, -0.1789599f, +0.0993516f, -0.6009834f, +0.4483340f, -0.1497729f, -0.1885431f,
  +0.0279225f, +0.0493558f, -0.2933509f, +0.5508739f, +0.1261461f, +0.7644079f, -0.0069545f, +0.1496751f,
  -0.3783770f, -0.1651516f, +0.1109108f, +0.1585817f, +0.1454665f, +0.0952193f, +0.0917125f, +0.2734222f,
  -0.1995687f, +0.1334550f, +0.2308048f, +0.1568628f, -0.0231838f, -0.0925635f, -0.1282643f, -0.1069364f,
  -0.0413567f, +0.3121429f, -0.1849846f, -0.6363608f, -0.1675363f, +0.2264804f, -0.1426443f, +0.0545470f,
  -0.0743938f, +0.1306732f, -0.1646727f, +0.0189763f, -0.1169793f, -0.2165402f, -0.0255822f, +0.2445323f
);

const float biases[4] = float[4](
  +0.0721585f, +0.0731277f, +0.0926796f, -0.0304165f
);

vec4 hook() {
    const vec4 r[9][2] = vec4[9][2](
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 1.0f)))
    );

    float sum[4] = biases;
    for (int n = 0; n < 4; n++) {
        for (int i = 0; i < 9; i++) {
            const vec4 k0 = vec4(kernels[n * 8 * 9 + 8 * i + 0], kernels[n * 8 * 9 + 8 * i + 1], kernels[n * 8 * 9 + 8 * i + 2], kernels[n * 8 * 9 + 8 * i + 3]);
            const vec4 k1 = vec4(kernels[n * 8 * 9 + 8 * i + 4], kernels[n * 8 * 9 + 8 * i + 5], kernels[n * 8 * 9 + 8 * i + 6], kernels[n * 8 * 9 + 8 * i + 7]);
            sum[n] += (dot(k0, r[i][0]) + dot(k1, r[i][1]));
        }
    }

    return ACTIVE(vec4(sum[0], sum[1], sum[2], sum[3]) * 0.2000000f + TEX_BIND_L2_TEXOFF(vec2(0.0f, 0.0f)));
}

//!HOOK LUMA
//!DESC ARNet b16 Layer8 L1
//!WHEN OUTPUT.w LUMA.w / 1.2 > OUTPUT.h LUMA.h / 1.2 > *
//!BIND TMP1_L0
//!BIND TMP1_L1
//!BIND TMP2_L1
//!SAVE TMP2_L1
//!COMPONENTS 4

#define ACTIVE(v) (v)

#define TEX_BIND_L0_TEXOFF TMP1_L0_texOff
#define TEX_BIND_L0_TEX TMP1_L0_tex
#define TEX_BIND_L0_POS TMP1_L0_pos
#define TEX_BIND_L0_SIZE TMP1_L0_size
#define TEX_BIND_L0_PT TMP1_L0_pt

#define TEX_BIND_L1_TEXOFF TMP1_L1_texOff
#define TEX_BIND_L1_TEX TMP1_L1_tex
#define TEX_BIND_L1_POS TMP1_L1_pos
#define TEX_BIND_L1_SIZE TMP1_L1_size
#define TEX_BIND_L1_PT TMP1_L1_pt

#define TEX_BIND_L2_TEXOFF TMP2_L1_texOff
#define TEX_BIND_L2_TEX TMP2_L1_tex
#define TEX_BIND_L2_POS TMP2_L1_pos
#define TEX_BIND_L2_SIZE TMP2_L1_size
#define TEX_BIND_L2_PT TMP2_L1_pt

const float kernels[288] = float[288](
  -0.2073595f, +0.2108953f, -0.0807204f, -0.1436426f, -0.4572678f, -0.1776171f, -0.1323092f, +0.2350197f,
  +0.1799140f, +0.0851016f, +0.0656756f, +0.1331681f, -0.1212045f, +0.1415701f, -0.2971328f, -0.2772233f,
  +0.3288888f, -0.1054318f, +0.0062767f, -0.2922167f, +0.0818730f, +0.0012243f, +0.0871707f, -0.2536144f,
  -0.3857996f, -0.0376093f, +0.0744667f, +0.0597732f, -0.0274269f, +0.2632874f, -0.1311747f, +0.1644337f,
  -0.5018844f, -0.0539671f, -0.0194698f, -0.2306583f, -0.3010972f, +0.2029699f, -0.1899672f, -0.0352214f,
  +0.3437733f, -0.0554384f, +0.1604270f, +0.0128074f, -0.2920670f, +0.0700580f, -0.1709476f, -0.1372643f,
  -0.2584636f, -0.0751553f, +0.0251693f, -0.2138093f, -0.2205758f, -0.0694556f, -0.1174551f, +0.0511906f,
  -0.3063386f, -0.1239718f, -0.1222078f, -0.0144582f, -0.3215303f, -0.0016974f, -0.2637622f, -0.0197359f,
  +0.2437426f, -0.1692856f, +0.3528968f, -0.0291900f, +0.0528332f, +0.2816814f, +0.0125549f, -0.0178681f,
  -0.0001843f, -0.1854526f, -0.1952237f, +0.0717804f, +0.0269291f, +0.1070456f, -0.0446699f, -0.0606916f,
  -0.3144606f, -0.1515781f, -0.0429799f, -0.1484989f, +0.1496835f, +0.0034235f, +0.0825530f, -0.2570198f,
  +0.1762891f, -0.1659688f, -0.0077371f, +0.2460081f, +0.2818268f, -0.0834254f, -0.0325735f, -0.0495649f,
  -0.4680562f, +0.2745936f, -0.0750521f, -0.0059694f, -0.0269317f, -0.4867041f, +0.5013565f, +0.0999795f,
  -0.0642622f, +0.1397635f, -0.0161991f, +0.1448128f, +0.1935844f, -0.4321004f, +0.3419423f, +0.0469069f,
  -0.2555697f, -0.1925665f, -0.1147983f, +0.2394938f, +0.4566756f, -0.1089360f, +0.0160427f, -0.1336792f,
  -0.4393598f, -0.0935979f, -0.4427597f, -0.0334839f, +0.1917476f, -0.2208270f, +0.0355739f, +0.1923062f,
  -0.0633022f, -0.0068293f, -0.1591268f, +0.4511752f, +0.1192847f, -0.1282080f, +0.2991507f, +0.2693989f,
  -0.0457943f, +0.1332792f, +0.0579166f, -0.1802728f, -0.1943374f, -0.1282772f, +0.3657991f, -0.0325591f,
  +0.0737927f, -0.1554381f, -0.0009426f, +0.1402780f, -0.2972626f, +0.3624822f, -0.1269756f, +0.3128912f,
  +0.0923975f, -0.5160077f, -0.1305476f, +0.1006818f, -0.0594903f, +0.3586756f, -0.3596852f, +0.1915633f,
  -0.0335605f, -0.3597332f, +0.1669091f, -0.2670610f, +0.2147750f, -0.0467296f, -0.3169085f, -0.3874817f,
  +0.1637702f, -0.5373359f, -0.5230446f, +0.1461299f, -0.2005752f, +0.0397427f, +0.2711691f, -0.2586931f,
  -2.5109377f, -0.2197464f, -0.0920371f, +0.2249736f, -0.1577476f, -0.3579230f, -0.1038360f, -1.0573095f,
  -0.3226567f, +0.1250881f, -0.0840724f, +0.2286597f, +0.1493514f, +0.0418794f, -0.2596444f, -0.1555366f,
  -0.0838892f, +0.0390522f, -0.5690928f, +0.0374043f, -0.1102695f, -0.0699779f, -0.3825826f, -0.2630602f,
  -0.1965405f, -0.1390859f, -0.3526629f, +0.0159476f, -0.0757509f, +0.2476477f, +0.3216560f, -0.7631517f,
  +0.3622358f, -0.0090388f, +0.0259031f, -0.2939683f, +0.1258983f, +0.0855263f, -0.0681503f, -0.5799010f,
  +0.4607556f, +0.0992654f, -0.1707592f, -0.3920420f, -0.0310909f, +0.5649875f, -0.2142825f, -0.1199619f,
  +0.3507450f, -0.2360196f, +0.0458337f, -0.0447063f, +0.2101638f, +0.4576547f, -0.2211187f, -0.4276336f,
  -0.0110674f, -0.3638179f, +0.0662583f, -0.3365514f, +0.3328045f, +0.1991950f, +0.1825375f, -0.3642033f,
  +0.4171513f, -0.2633907f, +0.1414658f, +0.2390343f, +0.1753690f, +0.5387642f, -0.1160360f, -0.5212897f,
  +0.0739185f, +0.0094022f, +0.3098021f, +0.6235252f, -0.2395090f, +0.5317870f, +0.3908173f, -0.5385031f,
  +0.0630322f, -0.2006966f, +0.1033927f, +0.1411003f, -0.0285171f, +0.7288516f, -0.3167354f, +0.0202020f,
  -0.1699097f, +0.1773136f, -0.2706094f, +0.1861152f, -0.2913110f, +0.3757742f, -0.0317363f, -0.4057367f,
  +0.2645992f, +0.2735652f, +0.4091818f, -0.0459441f, -0.1647398f, +0.1767275f, +0.1147995f, +0.0044963f,
  +0.0240398f, -0.1159845f, +0.0091814f, -0.0653140f, -0.1107182f, +0.2467122f, -0.3212890f, +0.0911590f
);

const float biases[4] = float[4](
  -0.1155341f, -0.0519467f, +0.0875433f, -0.0473710f
);

vec4 hook() {
    const vec4 r[9][2] = vec4[9][2](
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 1.0f)))
    );

    float sum[4] = biases;
    for (int n = 0; n < 4; n++) {
        for (int i = 0; i < 9; i++) {
            const vec4 k0 = vec4(kernels[n * 8 * 9 + 8 * i + 0], kernels[n * 8 * 9 + 8 * i + 1], kernels[n * 8 * 9 + 8 * i + 2], kernels[n * 8 * 9 + 8 * i + 3]);
            const vec4 k1 = vec4(kernels[n * 8 * 9 + 8 * i + 4], kernels[n * 8 * 9 + 8 * i + 5], kernels[n * 8 * 9 + 8 * i + 6], kernels[n * 8 * 9 + 8 * i + 7]);
            sum[n] += (dot(k0, r[i][0]) + dot(k1, r[i][1]));
        }
    }

    return ACTIVE(vec4(sum[0], sum[1], sum[2], sum[3]) * 0.2000000f + TEX_BIND_L2_TEXOFF(vec2(0.0f, 0.0f)));
}

//!HOOK LUMA
//!DESC ARNet b16 Layer9 L0
//!WHEN OUTPUT.w LUMA.w / 1.2 > OUTPUT.h LUMA.h / 1.2 > *
//!BIND TMP2_L0
//!BIND TMP2_L1
//!SAVE TMP1_L0
//!COMPONENTS 4

#define ACTIVE(v) (max(v, v * 0.2000000f))

#define TEX_BIND_L0_TEXOFF TMP2_L0_texOff
#define TEX_BIND_L0_TEX TMP2_L0_tex
#define TEX_BIND_L0_POS TMP2_L0_pos
#define TEX_BIND_L0_SIZE TMP2_L0_size
#define TEX_BIND_L0_PT TMP2_L0_pt

#define TEX_BIND_L1_TEXOFF TMP2_L1_texOff
#define TEX_BIND_L1_TEX TMP2_L1_tex
#define TEX_BIND_L1_POS TMP2_L1_pos
#define TEX_BIND_L1_SIZE TMP2_L1_size
#define TEX_BIND_L1_PT TMP2_L1_pt

const float kernels[288] = float[288](
  +0.1630610f, +0.1180176f, -0.2276511f, -0.3281288f, +0.3067002f, +0.0560481f, -0.0424077f, +0.1839813f,
  +0.3002594f, -0.1081529f, -0.2336700f, -0.0190391f, +0.1616999f, +0.1527447f, +0.0362995f, -0.3306339f,
  +0.0467353f, +0.1107733f, -0.0003964f, -0.0386710f, +0.0067255f, +0.0512776f, -0.0199986f, -0.0475864f,
  +0.1090318f, +0.3452353f, -0.1815119f, +0.0923077f, +0.1327994f, -0.0931366f, -0.2404962f, -0.0779048f,
  +0.5860800f, +0.3340424f, -0.2138579f, +0.3154154f, +0.0240219f, +0.0453584f, -0.3881178f, -0.4437716f,
  -0.1301810f, +0.3639177f, +0.0836255f, -0.2293501f, -0.0552874f, -0.1742390f, +0.1673376f, +0.0177269f,
  +0.2155941f, +0.0681026f, -0.2101076f, -0.2461691f, +0.1142035f, +0.1263453f, +0.1197554f, -0.3580515f,
  +0.1478831f, -0.0606517f, -0.1808595f, -0.2037394f, +0.1964202f, -0.1768789f, +0.1287861f, -0.2319389f,
  -0.1819213f, +0.0897938f, -0.1109784f, -0.1603835f, -0.0802865f, +0.2508449f, +0.2777129f, -0.1231973f,
  +0.1525482f, +0.3253841f, -0.2198526f, -0.3644925f, +0.1590231f, -0.0518285f, -0.0358420f, -0.1431198f,
  +0.2735291f, +0.2108860f, -0.0186361f, -0.2011510f, +0.1130494f, +0.1308524f, +0.0792590f, -0.1930747f,
  -0.0122978f, +0.1774951f, -0.4233083f, -0.0716200f, +0.2570221f, -0.0885990f, +0.0395818f, +0.1204481f,
  -0.0167449f, +0.1167162f, +0.2569335f, -0.0567992f, +0.2013107f, -0.0193451f, +0.1399458f, -0.0520319f,
  +0.5215546f, -0.0869086f, -0.4546189f, +0.1754513f, +0.7065614f, -0.1275303f, -0.0876695f, +0.0628594f,
  -0.2659644f, +0.2027378f, +0.1856527f, -0.1031285f, +0.5784341f, -0.2531491f, +0.2469644f, -0.0337205f,
  -0.0396790f, +0.1509978f, -0.0439381f, +0.0930087f, -0.2539282f, +0.2906598f, -0.2515339f, +0.3281117f,
  +0.0919634f, -0.1221788f, -0.3702992f, +0.4448400f, +0.2977026f, -0.2398773f, -0.2572897f, -0.3231704f,
  -0.1192008f, +0.1631911f, -0.4337971f, -0.0556290f, +0.3989743f, -0.3535236f, +0.2903219f, -0.5093221f,
  +0.1623837f, +0.5347219f, +0.0884842f, -0.3554173f, +0.0363222f, +0.4762307f, -0.0095017f, -0.9662210f,
  +0.4864115f, +0.4796817f, +0.1310322f, -0.2342760f, -0.1413434f, +0.5087044f, +0.0101898f, -0.5671698f,
  +0.1407352f, +0.1788513f, -0.1194541f, -0.0843498f, -0.0949360f, +0.1437945f, -0.2631164f, +0.0066770f,
  +0.3078155f, +0.1998434f, -0.5551178f, -0.3261657f, -0.0558065f, +0.2578635f, -0.2190621f, -0.8645203f,
  +0.0644483f, -0.3001190f, -0.4049366f, -0.4413891f, +0.4194449f, +0.2347357f, +0.3265994f, -0.1075088f,
  +0.1822554f, -0.0960485f, -0.2592083f, -0.0806514f, -0.0520119f, +0.0734814f, +0.0241653f, -0.0069072f,
  +0.2565056f, +0.0426591f, -0.6278986f, -0.3152812f, -0.1033925f, -0.0318213f, +0.0868634f, -0.3356697f,
  +0.1100432f, +0.0545054f, +0.0185828f, -0.1970108f, -0.0982976f, -0.1681608f, +0.3558567f, -0.4150397f,
  +0.1880096f, -0.2013093f, -0.3314824f, +0.2241758f, +0.2592208f, -0.2482538f, -0.0883653f, +0.0443536f,
  +0.3279225f, +0.2127141f, +0.2492074f, -0.2698346f, +0.0899674f, -0.0807769f, +0.3661315f, +0.0558791f,
  -0.3546271f, -0.4182427f, -0.2538860f, +0.3865939f, +0.1320349f, -0.4232751f, +0.2797497f, -0.0975754f,
  +0.0858061f, -0.0673603f, +0.4528873f, +0.0538635f, +0.2671645f, -0.2620794f, +0.0983324f, +0.2486792f,
  -0.0221736f, +0.0228785f, +0.6270175f, +0.1587784f, +0.3351064f, +0.4422593f, +0.2033444f, +0.1327830f,
  +0.0312501f, +0.2172256f, +0.1403034f, +0.4818254f, -0.3375344f, -0.3008836f, -0.4341989f, -0.6010815f,
  -0.2883028f, +0.0478703f, +0.3288041f, -0.1322480f, +0.1997141f, +0.0430337f, +0.1162856f, -0.1389133f,
  -0.1191802f, -0.0093105f, +0.5815751f, +0.3158322f, +0.0794874f, +0.3919084f, +0.2307817f, +0.3722783f,
  +0.1036136f, +0.1328773f, +0.5252883f, +0.0802556f, -0.2933967f, -0.0649955f, -0.2475425f, +0.3863333f,
  +0.0670686f, +0.4366630f, +0.1256800f, -0.0506057f, -0.1432769f, +0.2673098f, +0.0512019f, -0.0072997f
);

const float biases[4] = float[4](
  +0.1190788f, -0.1195190f, -0.0068324f, -0.0866452f
);

vec4 hook() {
    const vec4 r[9][2] = vec4[9][2](
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 1.0f)))
    );

    float sum[4] = biases;
    for (int n = 0; n < 4; n++) {
        for (int i = 0; i < 9; i++) {
            const vec4 k0 = vec4(kernels[n * 8 * 9 + 8 * i + 0], kernels[n * 8 * 9 + 8 * i + 1], kernels[n * 8 * 9 + 8 * i + 2], kernels[n * 8 * 9 + 8 * i + 3]);
            const vec4 k1 = vec4(kernels[n * 8 * 9 + 8 * i + 4], kernels[n * 8 * 9 + 8 * i + 5], kernels[n * 8 * 9 + 8 * i + 6], kernels[n * 8 * 9 + 8 * i + 7]);
            sum[n] += (dot(k0, r[i][0]) + dot(k1, r[i][1]));
        }
    }

    return ACTIVE(vec4(sum[0], sum[1], sum[2], sum[3]));
}

//!HOOK LUMA
//!DESC ARNet b16 Layer9 L1
//!WHEN OUTPUT.w LUMA.w / 1.2 > OUTPUT.h LUMA.h / 1.2 > *
//!BIND TMP2_L0
//!BIND TMP2_L1
//!SAVE TMP1_L1
//!COMPONENTS 4

#define ACTIVE(v) (max(v, v * 0.2000000f))

#define TEX_BIND_L0_TEXOFF TMP2_L0_texOff
#define TEX_BIND_L0_TEX TMP2_L0_tex
#define TEX_BIND_L0_POS TMP2_L0_pos
#define TEX_BIND_L0_SIZE TMP2_L0_size
#define TEX_BIND_L0_PT TMP2_L0_pt

#define TEX_BIND_L1_TEXOFF TMP2_L1_texOff
#define TEX_BIND_L1_TEX TMP2_L1_tex
#define TEX_BIND_L1_POS TMP2_L1_pos
#define TEX_BIND_L1_SIZE TMP2_L1_size
#define TEX_BIND_L1_PT TMP2_L1_pt

const float kernels[288] = float[288](
  +0.1121563f, -0.1550673f, -0.0777407f, +0.1783876f, -0.0855813f, -0.2763037f, -0.2110035f, -0.0612301f,
  +0.1151326f, +0.2076277f, -0.1281432f, +0.1729890f, -0.0613427f, +0.0386709f, -0.1449137f, +0.3722970f,
  +0.0146824f, +0.0216301f, -0.0705363f, +0.0505355f, -0.2192763f, +0.0442426f, -0.2329883f, +0.3103845f,
  +0.2623836f, +0.0856607f, +0.1053425f, +0.2497692f, -0.2425171f, -0.2086729f, +0.0793810f, -0.3433885f,
  -0.3844404f, -0.0740188f, +0.2334232f, +0.1015706f, -0.0636381f, +0.0756617f, +0.6794288f, -0.2899880f,
  +0.1265485f, +0.6273352f, +0.2604161f, -0.2346543f, +0.2049124f, +0.1146662f, +0.2463437f, +0.0730923f,
  -0.1318257f, -0.1250426f, +0.4459167f, -0.0777841f, +0.2123887f, -0.3173932f, -0.4380731f, -0.1042998f,
  -0.4119446f, +0.0735861f, +0.5529176f, +0.1198817f, +0.1973650f, -0.1659319f, -0.5417409f, -0.2523559f,
  -0.2447036f, -0.3190494f, +0.1500849f, +0.0477246f, +0.2642595f, -0.1014348f, -0.1002113f, -0.1658634f,
  -0.4330068f, -0.2438801f, -0.1371215f, +0.1320156f, +0.0862417f, +0.3053508f, +0.0257731f, -0.1008238f,
  -0.1221880f, +0.0707092f, -0.1266766f, +0.1753086f, -0.0833032f, -0.0104666f, +0.2133409f, -0.1204708f,
  +0.3935295f, +0.0949720f, -0.1956488f, +0.0848289f, +0.2115875f, +0.1828322f, +0.0027805f, +0.0709835f,
  -0.4169717f, -0.2676093f, -0.0412896f, +0.2590045f, +0.1169287f, +0.3086982f, -0.4053048f, -0.1390146f,
  +0.2997687f, +0.1232470f, -0.1633907f, +0.4896016f, -0.0973886f, -0.0068376f, -0.1326653f, +0.1189219f,
  +0.0347880f, -0.4551835f, -0.0214485f, +0.1501226f, -0.0014924f, -0.0456017f, +0.0272298f, -0.1185196f,
  -0.2867703f, +0.0582892f, -0.0446900f, +0.0463305f, -0.2209390f, +0.3146017f, -0.1558130f, +0.3554423f,
  -0.0129618f, -0.1644606f, -0.0915267f, +0.0857649f, +0.0026540f, +0.0731490f, +0.0108941f, +0.0354543f,
  +0.0499209f, +0.1596377f, -0.0311167f, +0.0552918f, +0.0763194f, +0.1508800f, +0.0494696f, +0.0964400f,
  -0.3119935f, +0.2547369f, -0.2133570f, +0.0282896f, -0.2777450f, +0.2813536f, +0.1296080f, -0.0750635f,
  +0.0881485f, +0.6296110f, +0.1824771f, -0.0104829f, -0.2459949f, -0.0474931f, -0.0063196f, -0.0541051f,
  -0.3440530f, -0.1993998f, +0.3328468f, +0.0128016f, -0.0586330f, -0.1044322f, +0.1324016f, -0.0469727f,
  -0.0779412f, +0.0844797f, +0.1081665f, -0.1257467f, +0.1235913f, -0.0262537f, -0.1645194f, -0.2225196f,
  -0.0008230f, -0.2404266f, -0.0366299f, +0.0702268f, +0.0343367f, +0.1044224f, +0.7465128f, -0.2175077f,
  +0.0974487f, -0.1805257f, +0.0770168f, +0.0041259f, -0.5646714f, -0.1361839f, +0.3089644f, +0.0529677f,
  +0.0173557f, -0.0748105f, -0.0658238f, +0.0366236f, +0.2379132f, +0.0245660f, +0.0250233f, +0.0984820f,
  +0.3190651f, +0.4470424f, +0.1389915f, +0.0925651f, +0.1372785f, -0.3850911f, -0.0892413f, -0.1199742f,
  +0.3360691f, -0.0056128f, -0.0466080f, +0.2465434f, +0.1425767f, -0.1446009f, +0.0447018f, +0.0394066f,
  +0.3452268f, +0.4150888f, -0.4657257f, +0.0639842f, -0.1276584f, -0.1228379f, +0.3250157f, -0.2562054f,
  +0.1168150f, +0.5485904f, +0.4304820f, -0.0702773f, +0.2656021f, -0.2623006f, -0.0113975f, +0.3400983f,
  +0.0227258f, -0.1357723f, -0.0959810f, -0.1727293f, +0.0043036f, +0.1896743f, -0.1109356f, +0.0593257f,
  +0.4657074f, +0.8347149f, +0.0870290f, +0.5276185f, +0.0630501f, -0.5331676f, -0.2490992f, -1.0264924f,
  -0.1146854f, +0.1033237f, +0.1229523f, +0.1635975f, +0.4230919f, -0.2332367f, +0.3783017f, +0.0146110f,
  +0.1865527f, +0.0554683f, +0.0901396f, -0.0850488f, +0.0140921f, +0.3157199f, -0.1304339f, +0.1744653f,
  -0.2158196f, -0.0762211f, +0.5472122f, +0.1147064f, +0.7963661f, -0.5324522f, -0.3144707f, -0.4115863f,
  +0.0368687f, +0.3213105f, +0.1432363f, +0.1322220f, -0.0699002f, +0.1862819f, +0.2858707f, -0.0569647f,
  -0.1557051f, -0.1749772f, -0.1714656f, +0.0038405f, +0.1722267f, -0.0710213f, -0.1060268f, +0.0683016f
);

const float biases[4] = float[4](
  +0.0677809f, -0.5092577f, +0.0924522f, -0.0440777f
);

vec4 hook() {
    const vec4 r[9][2] = vec4[9][2](
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 1.0f)))
    );

    float sum[4] = biases;
    for (int n = 0; n < 4; n++) {
        for (int i = 0; i < 9; i++) {
            const vec4 k0 = vec4(kernels[n * 8 * 9 + 8 * i + 0], kernels[n * 8 * 9 + 8 * i + 1], kernels[n * 8 * 9 + 8 * i + 2], kernels[n * 8 * 9 + 8 * i + 3]);
            const vec4 k1 = vec4(kernels[n * 8 * 9 + 8 * i + 4], kernels[n * 8 * 9 + 8 * i + 5], kernels[n * 8 * 9 + 8 * i + 6], kernels[n * 8 * 9 + 8 * i + 7]);
            sum[n] += (dot(k0, r[i][0]) + dot(k1, r[i][1]));
        }
    }

    return ACTIVE(vec4(sum[0], sum[1], sum[2], sum[3]));
}

//!HOOK LUMA
//!DESC ARNet b16 Layer10 L0
//!WHEN OUTPUT.w LUMA.w / 1.2 > OUTPUT.h LUMA.h / 1.2 > *
//!BIND TMP1_L0
//!BIND TMP1_L1
//!BIND TMP2_L0
//!SAVE TMP2_L0
//!COMPONENTS 4

#define ACTIVE(v) (v)

#define TEX_BIND_L0_TEXOFF TMP1_L0_texOff
#define TEX_BIND_L0_TEX TMP1_L0_tex
#define TEX_BIND_L0_POS TMP1_L0_pos
#define TEX_BIND_L0_SIZE TMP1_L0_size
#define TEX_BIND_L0_PT TMP1_L0_pt

#define TEX_BIND_L1_TEXOFF TMP1_L1_texOff
#define TEX_BIND_L1_TEX TMP1_L1_tex
#define TEX_BIND_L1_POS TMP1_L1_pos
#define TEX_BIND_L1_SIZE TMP1_L1_size
#define TEX_BIND_L1_PT TMP1_L1_pt

#define TEX_BIND_L2_TEXOFF TMP2_L0_texOff
#define TEX_BIND_L2_TEX TMP2_L0_tex
#define TEX_BIND_L2_POS TMP2_L0_pos
#define TEX_BIND_L2_SIZE TMP2_L0_size
#define TEX_BIND_L2_PT TMP2_L0_pt

const float kernels[288] = float[288](
  +0.1909463f, -0.5140820f, -0.2986071f, -0.1764628f, +0.1141882f, -0.2655147f, +0.0582640f, -0.1136366f,
  +0.1686165f, -0.4221223f, +0.2482405f, -0.5515814f, +0.3106007f, -0.0276070f, -0.4646143f, +0.2225571f,
  -0.3859876f, +0.0655916f, -0.3235420f, +0.0611804f, +0.4644206f, -0.0092479f, +0.0785269f, +0.6032048f,
  +0.1585176f, -0.0454531f, +0.2236547f, -0.1152430f, +0.1217439f, +0.2647910f, -0.1726745f, -0.3106436f,
  -0.3787564f, -0.0632205f, -0.0697263f, +0.0147825f, +0.0491047f, +0.1144552f, +0.1871841f, -0.4900880f,
  -0.0234667f, -0.0383932f, -0.1580852f, +0.1696157f, +0.2255615f, +0.1806795f, +0.1133602f, +0.6398314f,
  +0.2875019f, -0.2801063f, -0.3623867f, -0.2573970f, +0.2403083f, +0.0468923f, +0.2647720f, -0.1429411f,
  +0.1463874f, +0.0982734f, -0.3117971f, -0.5259826f, -0.0620974f, +0.5089445f, +0.1807819f, +0.1358586f,
  -0.2108285f, +0.0116752f, -0.0809506f, -0.3067864f, +0.0441322f, +0.2996084f, +0.1791258f, +0.0088991f,
  -0.2793367f, +0.2809145f, -0.1242339f, -0.0184781f, -0.0588054f, -0.2697269f, -0.0396125f, -0.0573647f,
  +0.0438398f, +0.2832586f, -0.3275786f, -0.2018587f, -0.1837637f, -0.1196266f, -0.0728149f, -0.0848820f,
  -0.0077791f, -0.0264217f, +0.0002488f, -0.3480211f, -0.1636362f, -0.2121170f, -0.0890403f, -0.5783081f,
  +0.2813034f, +0.2022791f, +0.1278087f, +0.0215277f, +0.0837111f, +0.2285417f, +0.0231773f, +0.0785728f,
  +0.3282188f, -0.1442935f, +0.2598981f, +0.3187690f, +0.4840996f, -0.1381867f, +0.4783840f, +0.2989681f,
  +0.1342101f, -0.5916988f, +0.2367625f, -0.3762956f, -0.3585447f, +0.2769733f, +0.2884854f, -0.7928445f,
  -0.0810063f, +0.1905689f, -0.0826152f, +0.1375313f, -0.1154022f, +0.0890645f, -0.2672009f, +0.0935399f,
  +0.1376050f, +0.2473595f, -0.0080318f, +0.3700400f, -0.1783001f, +0.1856586f, +0.0957437f, -0.4583815f,
  +0.1973346f, -0.2854734f, +0.2171692f, +0.3569744f, -0.4192148f, +0.4849249f, +0.0662623f, -0.3321585f,
  -0.4622965f, -0.1706431f, +0.3875524f, -0.0211166f, -0.0739975f, +0.2710959f, +0.0784047f, -0.1354181f,
  -0.0186426f, +0.3119667f, -0.3001265f, +0.0775754f, -0.3032635f, -0.0148348f, -0.1167646f, -0.0669039f,
  -0.0873904f, -0.2611602f, +0.2867034f, +0.1466611f, -0.2344871f, +0.0141971f, -0.0457550f, -0.5239134f,
  -0.2444990f, +0.0869512f, -0.1520004f, -0.0364913f, -0.0415614f, -0.0574302f, +0.3198755f, -0.1007911f,
  -0.0997024f, +0.1010965f, -0.0437218f, +0.4427754f, +0.3753805f, -0.1202219f, +0.2139367f, +0.0619868f,
  +0.1818801f, -0.2195302f, +0.4276321f, -0.4238934f, -0.1864203f, -0.1664627f, -0.0984063f, -0.6079627f,
  -0.0375929f, +0.3020676f, +0.3170167f, +0.0563399f, +0.1361575f, +0.0000367f, -0.0178788f, -0.1551929f,
  +0.2655272f, +0.0546644f, +0.0694919f, +0.1014555f, -0.0237716f, -0.1944018f, +0.1950763f, -0.2815226f,
  +0.2794313f, -0.0841721f, -0.4557332f, +0.0970356f, -0.1059773f, -0.3707092f, +0.2973048f, -0.3042503f,
  -0.1432608f, +0.1076123f, -0.5191901f, +0.0810111f, -0.2410058f, -0.0853068f, +0.3100875f, -0.0677464f,
  -0.1186572f, -0.4835031f, -0.2310179f, +0.1043289f, +0.0317968f, +0.0718010f, -0.1352163f, -0.1375329f,
  -0.0632782f, -0.0725783f, +0.1776202f, +0.0463451f, +0.0331495f, +0.4090447f, +0.0399104f, -0.2432957f,
  +0.1863449f, -0.1202482f, +0.0418263f, +0.1745119f, +0.2862297f, -0.0753675f, +0.2262926f, -0.0361312f,
  -0.1428819f, -0.2740697f, +0.4365326f, -0.2325498f, -0.2880750f, -0.1186803f, +0.1932456f, -0.0770203f,
  -0.0991035f, +0.0399776f, -0.0908155f, -0.2133178f, -0.1115503f, -0.2260097f, +0.0249800f, -0.2837003f,
  -0.0538353f, +0.0981426f, +0.0812613f, -0.0126643f, +0.2323413f, -0.0458916f, -0.3683525f, +0.0741491f,
  -0.1812403f, +0.2352995f, +0.2365347f, +0.2261239f, -0.3246374f, -0.1488715f, -0.1910297f, +0.0639452f,
  +0.1088346f, -0.0391358f, +0.2940956f, +0.0820585f, -0.0117910f, +0.0682606f, -0.0001690f, -0.3482634f
);

const float biases[4] = float[4](
  +0.1056959f, +0.0105523f, -0.0067131f, -0.0341191f
);

vec4 hook() {
    const vec4 r[9][2] = vec4[9][2](
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 1.0f)))
    );

    float sum[4] = biases;
    for (int n = 0; n < 4; n++) {
        for (int i = 0; i < 9; i++) {
            const vec4 k0 = vec4(kernels[n * 8 * 9 + 8 * i + 0], kernels[n * 8 * 9 + 8 * i + 1], kernels[n * 8 * 9 + 8 * i + 2], kernels[n * 8 * 9 + 8 * i + 3]);
            const vec4 k1 = vec4(kernels[n * 8 * 9 + 8 * i + 4], kernels[n * 8 * 9 + 8 * i + 5], kernels[n * 8 * 9 + 8 * i + 6], kernels[n * 8 * 9 + 8 * i + 7]);
            sum[n] += (dot(k0, r[i][0]) + dot(k1, r[i][1]));
        }
    }

    return ACTIVE(vec4(sum[0], sum[1], sum[2], sum[3]) * 0.2000000f + TEX_BIND_L2_TEXOFF(vec2(0.0f, 0.0f)));
}

//!HOOK LUMA
//!DESC ARNet b16 Layer10 L1
//!WHEN OUTPUT.w LUMA.w / 1.2 > OUTPUT.h LUMA.h / 1.2 > *
//!BIND TMP1_L0
//!BIND TMP1_L1
//!BIND TMP2_L1
//!SAVE TMP2_L1
//!COMPONENTS 4

#define ACTIVE(v) (v)

#define TEX_BIND_L0_TEXOFF TMP1_L0_texOff
#define TEX_BIND_L0_TEX TMP1_L0_tex
#define TEX_BIND_L0_POS TMP1_L0_pos
#define TEX_BIND_L0_SIZE TMP1_L0_size
#define TEX_BIND_L0_PT TMP1_L0_pt

#define TEX_BIND_L1_TEXOFF TMP1_L1_texOff
#define TEX_BIND_L1_TEX TMP1_L1_tex
#define TEX_BIND_L1_POS TMP1_L1_pos
#define TEX_BIND_L1_SIZE TMP1_L1_size
#define TEX_BIND_L1_PT TMP1_L1_pt

#define TEX_BIND_L2_TEXOFF TMP2_L1_texOff
#define TEX_BIND_L2_TEX TMP2_L1_tex
#define TEX_BIND_L2_POS TMP2_L1_pos
#define TEX_BIND_L2_SIZE TMP2_L1_size
#define TEX_BIND_L2_PT TMP2_L1_pt

const float kernels[288] = float[288](
  +0.2763391f, -0.1456159f, +0.2439121f, +0.3158580f, +0.1275547f, +0.1615819f, +0.1922237f, -0.2170177f,
  +0.0552945f, +0.2827663f, +0.2029988f, +0.0808904f, +0.5061983f, +0.4895043f, +0.0672931f, -0.1561467f,
  +0.0853643f, -0.1411236f, +0.3007432f, +0.1255894f, -0.0351667f, -0.2176413f, -0.3175772f, -0.3147352f,
  +0.3126088f, -0.0596459f, +0.0551958f, +0.2669258f, +0.1356959f, +0.6350301f, +0.2683861f, -0.3372007f,
  -0.0924540f, -0.0100702f, -0.4034735f, +0.0269414f, +0.2413511f, +0.5367159f, -0.0045335f, -0.1275528f,
  +0.0203752f, +0.0307732f, -0.3008805f, +0.3233282f, -0.0051369f, +0.3698404f, -0.0863559f, +0.0020629f,
  +0.0051436f, -0.0270570f, +0.1867131f, +0.1926087f, -0.0218810f, +0.1870426f, +0.2618289f, -0.1094839f,
  -0.0823407f, -0.2177489f, -0.2449246f, +0.0759281f, +0.2618653f, +0.4461984f, +0.2658827f, -0.0796778f,
  -0.1868346f, -0.1403787f, +0.3050211f, -0.1316165f, +0.1349561f, +0.0078052f, -0.1441382f, -0.1977449f,
  +0.0083340f, +0.2390510f, +0.0367744f, -0.2842568f, -0.0624125f, -0.3424878f, +0.0754824f, +0.2378178f,
  +0.0432693f, -0.0737350f, -0.0229408f, -0.2201375f, -0.2388980f, -0.0605839f, -0.1266683f, +0.2298575f,
  -0.0945189f, -0.1508496f, -0.0407058f, -0.0902652f, -0.1161444f, -0.4464890f, +0.0245109f, +0.1554184f,
  -0.0667065f, +0.2953483f, -0.1355238f, -0.0961694f, -0.3188911f, +0.2534725f, -0.0648285f, +0.0947168f,
  +0.0290250f, +0.0780549f, -0.0352878f, +0.1761422f, -0.2328718f, +0.1065691f, -0.1674850f, -0.1714746f,
  -0.0107069f, -0.0802736f, +0.1132250f, +0.0456503f, -0.3696017f, +0.2687560f, +0.1203431f, +0.1633773f,
  +0.0199957f, +0.0602483f, -0.0347880f, +0.0395828f, -0.0618279f, +0.1652247f, +0.1252104f, +0.0821900f,
  +0.1917307f, +0.1057533f, +0.2490151f, +0.1429443f, -0.3559955f, +0.4591415f, -0.0839164f, +0.0277619f,
  +0.2459245f, +0.1382286f, +0.0346851f, +0.2768933f, -0.0539888f, +0.1479614f, -0.0328838f, -0.0179813f,
  -0.1794204f, +0.1169764f, +0.0463340f, -0.1075547f, -0.0139962f, +0.0675272f, -0.0978796f, +0.0185731f,
  -0.1678522f, +0.3790589f, -0.0952870f, -0.3634316f, -0.4001491f, -0.0516289f, -0.4070424f, +0.4354083f,
  -0.0779933f, -0.1581837f, -0.2610287f, -0.3052250f, +0.2710881f, +0.1356602f, +0.1985899f, +0.3700628f,
  -0.1327423f, -0.5786985f, +0.0331080f, -0.4413089f, -0.1124873f, +0.0050761f, +0.2253851f, +0.0757573f,
  -0.2068963f, -0.5487882f, -0.8460485f, -0.1010741f, -0.6384633f, -0.1296059f, +0.0334660f, +0.8966448f,
  +0.3526703f, -0.1130722f, +0.0281953f, -0.2077927f, +0.0286411f, -0.1433752f, +0.3324887f, +0.1692565f,
  +0.0971935f, -0.2437140f, -0.2597179f, -0.0473532f, +0.2482488f, +0.0440883f, +0.2358660f, -0.1371091f,
  -0.0738741f, -0.3777935f, -0.0316050f, -0.6097423f, -0.1619945f, -0.0640836f, +0.1500975f, +0.4022078f,
  -0.0510630f, -0.0180234f, +0.2680689f, -0.3595972f, -0.1783033f, +0.2248933f, +0.1320817f, +0.4962780f,
  +0.2026895f, -0.2455775f, +0.0634097f, -0.0535355f, +0.0670099f, -0.2329968f, -0.2126038f, +0.1433501f,
  -0.1923179f, +0.1258171f, -0.0695873f, -0.0459363f, +0.2132835f, -0.2668969f, -0.2221888f, -0.1239126f,
  -0.0555924f, -0.4385475f, +0.0148420f, +0.1191107f, +0.0190081f, -0.3383047f, -0.3221568f, +0.2112055f,
  +0.0922521f, -0.0059890f, -0.1444322f, -0.3204978f, -0.2760737f, -0.0312194f, -0.2947294f, +0.0397493f,
  -0.0110207f, +0.0382555f, -0.4551136f, +0.5625378f, +0.3107876f, -0.4824350f, +0.0398963f, +0.1954164f,
  -0.3332019f, -0.4047998f, +0.0170523f, -0.1105877f, +0.0895418f, -0.4468141f, -0.0687891f, -0.3853186f,
  -0.0026650f, -0.1162794f, -0.1818542f, +0.0152154f, +0.0003842f, +0.0363252f, +0.2383369f, +0.0747440f,
  -0.1342038f, +0.1081938f, +0.3398889f, -0.0062820f, -0.0319040f, -0.2711152f, +0.1232464f, -0.0708613f,
  -0.4485053f, +0.0037889f, +0.4474595f, +0.0190611f, +0.0882108f, +0.0693566f, -0.1567819f, -0.0322927f
);

const float biases[4] = float[4](
  -0.0313596f, +0.0620264f, -0.0727795f, -0.0755543f
);

vec4 hook() {
    const vec4 r[9][2] = vec4[9][2](
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 1.0f)))
    );

    float sum[4] = biases;
    for (int n = 0; n < 4; n++) {
        for (int i = 0; i < 9; i++) {
            const vec4 k0 = vec4(kernels[n * 8 * 9 + 8 * i + 0], kernels[n * 8 * 9 + 8 * i + 1], kernels[n * 8 * 9 + 8 * i + 2], kernels[n * 8 * 9 + 8 * i + 3]);
            const vec4 k1 = vec4(kernels[n * 8 * 9 + 8 * i + 4], kernels[n * 8 * 9 + 8 * i + 5], kernels[n * 8 * 9 + 8 * i + 6], kernels[n * 8 * 9 + 8 * i + 7]);
            sum[n] += (dot(k0, r[i][0]) + dot(k1, r[i][1]));
        }
    }

    return ACTIVE(vec4(sum[0], sum[1], sum[2], sum[3]) * 0.2000000f + TEX_BIND_L2_TEXOFF(vec2(0.0f, 0.0f)));
}

//!HOOK LUMA
//!DESC ARNet b16 Layer11 L0
//!WHEN OUTPUT.w LUMA.w / 1.2 > OUTPUT.h LUMA.h / 1.2 > *
//!BIND TMP2_L0
//!BIND TMP2_L1
//!SAVE TMP1_L0
//!COMPONENTS 4

#define ACTIVE(v) (max(v, v * 0.2000000f))

#define TEX_BIND_L0_TEXOFF TMP2_L0_texOff
#define TEX_BIND_L0_TEX TMP2_L0_tex
#define TEX_BIND_L0_POS TMP2_L0_pos
#define TEX_BIND_L0_SIZE TMP2_L0_size
#define TEX_BIND_L0_PT TMP2_L0_pt

#define TEX_BIND_L1_TEXOFF TMP2_L1_texOff
#define TEX_BIND_L1_TEX TMP2_L1_tex
#define TEX_BIND_L1_POS TMP2_L1_pos
#define TEX_BIND_L1_SIZE TMP2_L1_size
#define TEX_BIND_L1_PT TMP2_L1_pt

const float kernels[288] = float[288](
  -0.3071096f, -0.0842514f, -0.2846468f, -0.0166125f, -0.0503627f, +0.4028787f, +0.2190198f, +0.1162682f,
  -0.2480215f, -0.5053489f, -0.4277541f, -0.0131867f, -0.2435294f, +0.5641068f, -0.5312747f, +0.1490103f,
  -0.1229231f, -0.0621577f, -0.1908208f, +0.0767270f, -0.4833301f, -0.0071037f, +0.1005132f, -0.3102368f,
  -0.2081890f, -0.3191077f, -0.1847010f, -0.0504686f, +0.3647589f, +0.4215302f, +0.4994490f, +0.4145437f,
  -0.4806607f, -0.4056774f, +0.1360438f, -0.2537358f, -0.2730275f, +0.1339361f, +0.6317105f, +0.5304804f,
  -0.0259787f, -0.3303792f, -0.3134323f, -0.2282878f, -0.0778733f, -0.0430834f, +0.0583885f, -0.6093177f,
  +0.1977325f, +0.0509977f, -0.2289212f, +0.1573921f, +0.1407720f, +0.0800237f, -0.1775365f, +0.0540214f,
  +0.2313543f, +0.2598636f, -0.0384348f, -0.1412644f, -0.4177814f, +0.0996496f, +0.5843228f, -0.1310970f,
  +0.1574566f, +0.0667096f, -0.2184773f, -0.2765898f, -0.1306614f, +0.0377190f, +0.2400356f, +0.0103209f,
  -0.0916171f, +0.0250147f, -0.4606817f, +0.0460886f, -0.0531281f, +0.0764605f, -0.1936372f, +0.1901505f,
  +0.2709610f, -0.1291519f, -0.0920802f, -0.2092992f, -0.2831905f, +0.1110755f, -0.5024761f, +0.0505724f,
  +0.1766336f, -0.2534345f, -0.0995129f, -0.2473476f, -0.1768263f, +0.0080752f, -0.1755984f, -0.1530442f,
  -0.2215061f, -0.1013556f, +0.1561933f, -0.0494657f, +0.0672786f, +0.2326133f, +0.2888232f, +0.2870911f,
  +0.0133542f, -0.5390338f, -0.0601209f, -0.2628171f, -0.6220257f, +0.0049136f, +0.5404166f, +0.1643116f,
  +0.1992691f, -0.5187697f, +0.2877309f, -0.1384056f, +0.2915827f, +0.1803594f, -0.4661190f, +0.0211550f,
  +0.0620472f, +0.0360782f, +0.0279306f, +0.2539440f, +0.1416797f, -0.0696520f, -0.0412999f, +0.1334958f,
  +0.2131568f, +0.3469731f, +0.1511644f, +0.0065625f, -0.1957752f, -0.1512178f, -0.2024905f, -0.2242095f,
  -0.0225040f, -0.3108280f, +0.2340969f, +0.0281653f, -0.0417273f, +0.0935964f, +0.2366854f, -0.1461733f,
  +0.1308597f, -0.2478957f, -0.6441061f, -0.0076963f, +0.1530524f, -0.1670864f, +0.4447763f, +0.1069662f,
  -0.5422034f, -0.1647209f, -0.4733005f, -0.4296736f, +0.1315162f, -0.1292717f, -0.3521175f, -0.0857384f,
  -0.1110109f, +0.2905044f, -0.1422561f, -0.3245433f, +0.5412567f, +0.3791676f, -0.0863839f, -0.4322612f,
  -0.0370572f, +0.0813557f, -0.1708393f, -0.1995413f, -0.2327409f, -0.0274901f, +0.6387352f, +0.0630445f,
  -0.0914671f, -0.5751857f, +0.1020566f, +0.4633705f, +0.1031638f, -0.0637721f, -0.2983302f, -0.0165479f,
  +0.2240966f, +0.3680496f, +0.0456972f, +0.0358711f, +0.3177549f, +0.1112385f, +0.1458234f, -0.3557160f,
  +0.0073433f, +0.1538422f, +0.2639630f, +0.1295884f, +0.0783269f, +0.0075840f, -0.0538208f, -0.0209221f,
  +0.2127270f, +0.0544847f, -0.0571810f, -0.2229617f, -0.1047041f, +0.0952308f, +0.0413667f, +0.2986967f,
  -0.1099753f, +0.2170247f, -0.1626510f, -0.1414908f, -0.1678835f, -0.0576468f, +0.1045935f, -0.3446659f,
  -0.0418788f, -0.0629635f, +0.0051107f, -0.0374180f, +0.1061310f, +0.1231975f, +0.3412835f, -0.0898373f,
  +0.0236844f, -0.0855533f, -0.1112813f, -0.0940017f, +0.2305624f, -0.2600143f, +0.4851374f, -0.2378960f,
  +0.0695262f, -0.0950084f, +0.0063421f, -0.1343486f, +0.0477603f, +0.0585927f, +0.3375522f, +0.0425702f,
  -0.2715639f, -0.1991664f, -0.4901187f, +0.0874423f, -0.1403405f, +0.0697550f, -0.0565926f, +0.3103430f,
  +0.0866877f, -0.0736798f, -0.1533158f, -0.1252386f, +0.0155651f, +0.0176694f, +0.3982935f, -0.1719347f,
  +0.1923071f, -0.1923540f, +0.0440443f, +0.2653643f, -0.0111085f, -0.2275039f, +0.3688329f, +0.0866782f,
  -0.0246447f, +0.0227142f, -0.4423452f, -0.4605130f, +0.2025525f, +0.1591477f, +0.3302678f, +0.2761264f,
  -0.0059731f, +0.3627846f, -0.4471844f, +0.0066678f, +0.4062585f, -0.0071906f, +0.0183560f, +0.1693665f,
  +0.4475273f, +0.1670257f, -0.4036581f, -0.2181183f, +0.0441059f, -0.1404687f, +0.0986029f, +0.2045597f
);

const float biases[4] = float[4](
  -0.0536255f, +0.0193197f, -0.0456410f, +0.0908763f
);

vec4 hook() {
    const vec4 r[9][2] = vec4[9][2](
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 1.0f)))
    );

    float sum[4] = biases;
    for (int n = 0; n < 4; n++) {
        for (int i = 0; i < 9; i++) {
            const vec4 k0 = vec4(kernels[n * 8 * 9 + 8 * i + 0], kernels[n * 8 * 9 + 8 * i + 1], kernels[n * 8 * 9 + 8 * i + 2], kernels[n * 8 * 9 + 8 * i + 3]);
            const vec4 k1 = vec4(kernels[n * 8 * 9 + 8 * i + 4], kernels[n * 8 * 9 + 8 * i + 5], kernels[n * 8 * 9 + 8 * i + 6], kernels[n * 8 * 9 + 8 * i + 7]);
            sum[n] += (dot(k0, r[i][0]) + dot(k1, r[i][1]));
        }
    }

    return ACTIVE(vec4(sum[0], sum[1], sum[2], sum[3]));
}

//!HOOK LUMA
//!DESC ARNet b16 Layer11 L1
//!WHEN OUTPUT.w LUMA.w / 1.2 > OUTPUT.h LUMA.h / 1.2 > *
//!BIND TMP2_L0
//!BIND TMP2_L1
//!SAVE TMP1_L1
//!COMPONENTS 4

#define ACTIVE(v) (max(v, v * 0.2000000f))

#define TEX_BIND_L0_TEXOFF TMP2_L0_texOff
#define TEX_BIND_L0_TEX TMP2_L0_tex
#define TEX_BIND_L0_POS TMP2_L0_pos
#define TEX_BIND_L0_SIZE TMP2_L0_size
#define TEX_BIND_L0_PT TMP2_L0_pt

#define TEX_BIND_L1_TEXOFF TMP2_L1_texOff
#define TEX_BIND_L1_TEX TMP2_L1_tex
#define TEX_BIND_L1_POS TMP2_L1_pos
#define TEX_BIND_L1_SIZE TMP2_L1_size
#define TEX_BIND_L1_PT TMP2_L1_pt

const float kernels[288] = float[288](
  +0.1056856f, -0.0898337f, +0.1101442f, +0.2104682f, -0.2098151f, -0.0643867f, -0.2181256f, -0.1947725f,
  -0.0624706f, +0.2019072f, -0.1586863f, +0.1427981f, +0.0201428f, +0.0247531f, -0.2155735f, +0.2898596f,
  +0.0161952f, +0.4971989f, +0.0283087f, -0.2470338f, +0.0433123f, +0.1720186f, -0.3352050f, +0.1602097f,
  +0.0821759f, +0.0161493f, -0.2949617f, -0.2388367f, -0.0055011f, -0.2779907f, -0.1235047f, -0.1159888f,
  -0.1994196f, +0.0207808f, -0.5807950f, -0.1544219f, +0.1805663f, -0.2269295f, +0.1000723f, -0.0360740f,
  -0.5606899f, +0.0325212f, +0.1483566f, +0.0888817f, +0.0986167f, +0.0569072f, +0.0284994f, -0.0471907f,
  -0.0063882f, -0.2768576f, -0.3489291f, -0.0431592f, -0.1485164f, -0.1692236f, +0.2196367f, -0.0353442f,
  -0.0189603f, -0.0169710f, +0.2698385f, +0.2186560f, +0.2622479f, -0.1758827f, -0.1750149f, -0.1495430f,
  -0.3076158f, -0.1821850f, -0.2947872f, +0.1195877f, +0.2562143f, -0.2212846f, -0.3677372f, +0.1049462f,
  -0.3371643f, -0.0134386f, -0.3222478f, -0.3051778f, +0.0221480f, +0.0902617f, -0.0876051f, +0.3577045f,
  -0.3922076f, -0.1879631f, -0.1812912f, +0.3510133f, +0.0515141f, +0.1488623f, -0.4450442f, +0.0389534f,
  -0.0812036f, -0.1863110f, -0.2028042f, +0.2077728f, +0.1306713f, -0.2379618f, -0.0815504f, +0.0546834f,
  -0.0744256f, -0.0746382f, -0.0049047f, +0.5548155f, -0.3528581f, -0.0089118f, +0.1997607f, +0.1809515f,
  +0.6609184f, +0.0263540f, +0.4131029f, +0.2879670f, +0.0412342f, +0.3189564f, -0.2498293f, -0.3986140f,
  +0.0497995f, +0.0871464f, -0.1815889f, -0.0558898f, -0.1010520f, -0.1442059f, -0.2275811f, -0.1441848f,
  +0.1886025f, +0.2771853f, +0.8312252f, -0.0632570f, -0.0514361f, +0.0860840f, +0.0911724f, -0.2779122f,
  -0.2134165f, -0.0366149f, +0.6419407f, -0.2475247f, -0.2633906f, +0.3444978f, +0.2932308f, -0.1537391f,
  -0.2210092f, +0.3659755f, +0.3249602f, -0.2002381f, -0.0566083f, -0.1733756f, +0.1416320f, -0.1744198f,
  +0.1583356f, -0.0233518f, -0.1913713f, +0.1060923f, -0.0364401f, -0.0840232f, +0.0853982f, +0.0267512f,
  +0.0648183f, -0.0623259f, +0.3213434f, +0.1317270f, +0.3263325f, +0.2798127f, +0.1400165f, +0.6896212f,
  +0.3162891f, -0.3453036f, +0.0459173f, -0.1114931f, +0.0471698f, +0.0701483f, -0.2091214f, +0.2291226f,
  +0.0079812f, -0.0505688f, +0.1478443f, +0.2707767f, -0.1188688f, -0.3842845f, -0.3639199f, -0.3736062f,
  -0.2876737f, +0.5469539f, +0.4045570f, -0.0115907f, +0.2181213f, +0.0454904f, -0.0898187f, +0.1123089f,
  -0.3036457f, +0.2823459f, +0.5365540f, -0.0209840f, +0.1474796f, +0.2386226f, +0.6672891f, +0.3273941f,
  +0.0829257f, -0.1833059f, +0.0091408f, +0.1592532f, -0.3220356f, -0.3897806f, -0.3291378f, -0.0064069f,
  -0.1144908f, -0.1573434f, +0.1328184f, +0.0102877f, +0.0750269f, -0.0463719f, -0.2578771f, -0.1031189f,
  -0.0882604f, -0.0660228f, +0.1909706f, +0.0611002f, +0.0000063f, -0.1268997f, +0.0557087f, -0.1257094f,
  -0.4796126f, +0.2537778f, +0.2385919f, -0.2142551f, -0.4697605f, +0.2662000f, -0.1029663f, -0.4047958f,
  -0.0502110f, +0.0481374f, -0.1822257f, -0.0480670f, -0.4839742f, +0.0518862f, -0.3766128f, -0.5018336f,
  -0.2150968f, +0.2004373f, +0.0480403f, -0.0485065f, +0.2685541f, -0.0145183f, -0.0112990f, -0.2554255f,
  +0.4016471f, +0.1069746f, -0.1991498f, -0.3015538f, +0.0324610f, +0.1232082f, -0.4480203f, +0.1669111f,
  +0.4739213f, +0.0684678f, -0.6902792f, -0.1978036f, -0.0385939f, +0.0787474f, +0.3959605f, +0.3060155f,
  -0.2665878f, -0.3084773f, +0.4380681f, -0.0810339f, -0.0476371f, +0.1501233f, +0.0076140f, +0.2806216f,
  +0.2051792f, -0.1161103f, +0.1758333f, +0.2052004f, +0.1975896f, +0.0070550f, +0.2666731f, -0.0699472f,
  +0.0752975f, +0.0217019f, +0.0102487f, +0.1173419f, +0.0364644f, -0.1903501f, -0.0970076f, -0.1338802f,
  -0.1306266f, -0.3512221f, +0.1733351f, +0.0637678f, +0.1294677f, +0.0135566f, -0.3472036f, -0.1684590f
);

const float biases[4] = float[4](
  +0.0899199f, -0.0810311f, +0.0540874f, -0.0122392f
);

vec4 hook() {
    const vec4 r[9][2] = vec4[9][2](
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 1.0f)))
    );

    float sum[4] = biases;
    for (int n = 0; n < 4; n++) {
        for (int i = 0; i < 9; i++) {
            const vec4 k0 = vec4(kernels[n * 8 * 9 + 8 * i + 0], kernels[n * 8 * 9 + 8 * i + 1], kernels[n * 8 * 9 + 8 * i + 2], kernels[n * 8 * 9 + 8 * i + 3]);
            const vec4 k1 = vec4(kernels[n * 8 * 9 + 8 * i + 4], kernels[n * 8 * 9 + 8 * i + 5], kernels[n * 8 * 9 + 8 * i + 6], kernels[n * 8 * 9 + 8 * i + 7]);
            sum[n] += (dot(k0, r[i][0]) + dot(k1, r[i][1]));
        }
    }

    return ACTIVE(vec4(sum[0], sum[1], sum[2], sum[3]));
}

//!HOOK LUMA
//!DESC ARNet b16 Layer12 L0
//!WHEN OUTPUT.w LUMA.w / 1.2 > OUTPUT.h LUMA.h / 1.2 > *
//!BIND TMP1_L0
//!BIND TMP1_L1
//!BIND TMP2_L0
//!SAVE TMP2_L0
//!COMPONENTS 4

#define ACTIVE(v) (v)

#define TEX_BIND_L0_TEXOFF TMP1_L0_texOff
#define TEX_BIND_L0_TEX TMP1_L0_tex
#define TEX_BIND_L0_POS TMP1_L0_pos
#define TEX_BIND_L0_SIZE TMP1_L0_size
#define TEX_BIND_L0_PT TMP1_L0_pt

#define TEX_BIND_L1_TEXOFF TMP1_L1_texOff
#define TEX_BIND_L1_TEX TMP1_L1_tex
#define TEX_BIND_L1_POS TMP1_L1_pos
#define TEX_BIND_L1_SIZE TMP1_L1_size
#define TEX_BIND_L1_PT TMP1_L1_pt

#define TEX_BIND_L2_TEXOFF TMP2_L0_texOff
#define TEX_BIND_L2_TEX TMP2_L0_tex
#define TEX_BIND_L2_POS TMP2_L0_pos
#define TEX_BIND_L2_SIZE TMP2_L0_size
#define TEX_BIND_L2_PT TMP2_L0_pt

const float kernels[288] = float[288](
  -0.1042730f, -0.1270958f, +0.1475279f, -0.3164757f, +0.3061430f, +0.1566719f, -0.0838796f, -0.2977979f,
  +0.0687662f, +0.2029303f, +0.1399010f, +0.1067402f, +0.1009886f, +0.3061071f, +0.1234542f, -0.0511598f,
  +0.2796049f, +0.0642748f, +0.1992251f, -0.1192357f, +0.1691123f, +0.1787471f, +0.1775657f, -0.0190853f,
  +0.4552706f, -0.4972343f, +0.0939525f, -0.1210083f, +0.0793437f, -0.1034122f, +0.1560858f, +0.1501974f,
  +0.2199673f, -0.2061715f, +0.3497461f, -0.3038862f, +0.0723334f, -0.0687315f, +0.5071378f, +0.1683499f,
  -0.2470557f, +0.0718789f, +0.0326383f, +0.0102567f, +0.1002429f, +0.2659718f, +0.0580888f, +0.1961896f,
  -0.0086621f, -0.4320590f, +0.2238844f, -0.2660210f, -0.0526021f, +0.3558846f, -0.3223404f, -0.1098801f,
  +0.4615812f, -0.2812036f, +0.3593296f, -0.4652528f, +0.1221573f, +0.5457628f, -0.1996865f, +0.0393429f,
  +0.2233354f, +0.0961550f, +0.1827523f, -0.1173915f, +0.1000251f, -0.0887092f, +0.0963207f, -0.0131928f,
  +0.3183510f, +0.2307567f, -0.0557690f, +0.2925089f, -0.0586162f, -0.2078356f, +0.3385691f, -0.1127607f,
  +0.0428185f, -0.0916044f, +0.1453834f, -0.0937021f, -0.0195703f, -0.1131076f, +0.0462319f, +0.0074593f,
  -0.1105123f, +0.0532172f, +0.1531920f, +0.1408032f, -0.0737874f, -0.3604145f, +0.1548133f, -0.3120543f,
  -0.4183185f, +0.4218073f, +0.1192408f, +0.1531793f, +0.1833239f, +0.0556032f, -0.2240582f, +0.1224387f,
  +0.1321674f, +0.4538050f, -0.5097232f, +0.2246234f, +0.3074031f, +0.0537109f, -0.1066684f, -0.3229954f,
  -0.0194990f, +0.0311682f, +0.1769381f, -0.0098350f, -0.0843698f, -0.4761271f, +0.1639058f, -0.0175258f,
  -0.2835693f, +0.2350936f, +0.1622901f, -0.0814796f, +0.0655218f, +0.2190321f, +0.1272980f, +0.0024275f,
  +0.1061309f, -0.1020778f, -0.3309425f, -0.1150042f, -0.0789104f, +0.2890668f, +0.0764599f, -0.2637838f,
  -0.2349626f, -0.0179933f, +0.5480072f, +0.0038737f, +0.0175967f, +0.0638354f, +0.0335804f, -0.1504572f,
  -0.1496615f, +0.1847705f, +0.0363938f, -0.1598446f, -0.0417202f, +0.1172610f, -0.1173188f, +0.0538279f,
  +0.0472989f, -0.3303826f, +0.0039037f, +0.2107024f, -0.1280192f, -0.2427722f, -0.0667290f, +0.0666533f,
  +0.2857892f, -0.1914635f, -0.0542744f, -0.2797145f, +0.4564494f, -0.0292113f, -0.0054602f, +0.1112734f,
  -0.5062076f, -0.0845365f, +0.0708610f, -0.3576911f, +0.0030842f, -0.2512006f, -0.5091323f, -0.2584192f,
  +0.3523036f, +0.1410163f, -0.5235700f, +0.0008529f, -0.1368601f, -0.5443370f, -0.1060414f, +0.1976751f,
  -0.3527129f, -0.3134836f, +0.2073810f, +0.0886720f, +0.2487801f, +0.1228715f, -0.1153273f, +0.2966708f,
  -0.2382532f, -0.3228403f, +0.2713267f, -0.4659067f, +0.1233007f, -0.4164898f, -0.1745703f, -0.1666511f,
  -0.0470724f, -0.2360975f, -0.3243029f, -0.2488392f, +0.0571331f, -0.1250571f, -0.0631918f, +0.0056814f,
  -0.2700168f, +0.0425234f, +0.1666947f, -0.2205877f, +0.3878793f, -0.1799798f, -0.2071997f, -0.1156488f,
  +0.1460278f, -0.0101065f, +0.1318458f, +0.1999119f, +0.1332428f, -0.0106559f, -0.0254787f, +0.0542861f,
  -0.1223809f, -0.3692656f, -0.0329774f, -0.0781011f, -0.2994137f, -0.2702061f, -0.2479393f, +0.2430657f,
  -0.0747527f, -0.0827109f, +0.0593462f, -0.0646450f, +0.0909766f, -0.2483077f, -0.2910398f, -0.1516328f,
  +0.1097616f, +0.3875340f, -0.1776022f, +0.0068185f, -0.1020589f, +0.0992118f, +0.0974223f, +0.2662954f,
  +0.2648467f, -0.1604313f, -0.0840359f, +0.2262328f, +0.2022633f, -0.2603108f, +0.2143241f, +0.4415263f,
  +0.0463617f, -0.3193661f, -0.1827373f, -0.2336385f, +0.2128952f, +0.0372774f, -0.1083388f, -0.0394428f,
  -0.4798974f, +0.2080195f, +0.0542536f, +0.2048564f, +0.2333442f, -0.0323656f, +0.0257815f, -0.1348606f,
  +0.1876565f, +0.1909419f, +0.3218445f, +0.1992342f, +0.0224647f, +0.0774402f, +0.2822779f, +0.2911193f,
  -0.1649998f, -0.0437712f, +0.1160082f, +0.0423096f, -0.2113376f, +0.2039188f, -0.2083200f, -0.0710995f
);

const float biases[4] = float[4](
  +0.0622876f, -0.0588464f, +0.0950959f, -0.0595569f
);

vec4 hook() {
    const vec4 r[9][2] = vec4[9][2](
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 1.0f)))
    );

    float sum[4] = biases;
    for (int n = 0; n < 4; n++) {
        for (int i = 0; i < 9; i++) {
            const vec4 k0 = vec4(kernels[n * 8 * 9 + 8 * i + 0], kernels[n * 8 * 9 + 8 * i + 1], kernels[n * 8 * 9 + 8 * i + 2], kernels[n * 8 * 9 + 8 * i + 3]);
            const vec4 k1 = vec4(kernels[n * 8 * 9 + 8 * i + 4], kernels[n * 8 * 9 + 8 * i + 5], kernels[n * 8 * 9 + 8 * i + 6], kernels[n * 8 * 9 + 8 * i + 7]);
            sum[n] += (dot(k0, r[i][0]) + dot(k1, r[i][1]));
        }
    }

    return ACTIVE(vec4(sum[0], sum[1], sum[2], sum[3]) * 0.2000000f + TEX_BIND_L2_TEXOFF(vec2(0.0f, 0.0f)));
}

//!HOOK LUMA
//!DESC ARNet b16 Layer12 L1
//!WHEN OUTPUT.w LUMA.w / 1.2 > OUTPUT.h LUMA.h / 1.2 > *
//!BIND TMP1_L0
//!BIND TMP1_L1
//!BIND TMP2_L1
//!SAVE TMP2_L1
//!COMPONENTS 4

#define ACTIVE(v) (v)

#define TEX_BIND_L0_TEXOFF TMP1_L0_texOff
#define TEX_BIND_L0_TEX TMP1_L0_tex
#define TEX_BIND_L0_POS TMP1_L0_pos
#define TEX_BIND_L0_SIZE TMP1_L0_size
#define TEX_BIND_L0_PT TMP1_L0_pt

#define TEX_BIND_L1_TEXOFF TMP1_L1_texOff
#define TEX_BIND_L1_TEX TMP1_L1_tex
#define TEX_BIND_L1_POS TMP1_L1_pos
#define TEX_BIND_L1_SIZE TMP1_L1_size
#define TEX_BIND_L1_PT TMP1_L1_pt

#define TEX_BIND_L2_TEXOFF TMP2_L1_texOff
#define TEX_BIND_L2_TEX TMP2_L1_tex
#define TEX_BIND_L2_POS TMP2_L1_pos
#define TEX_BIND_L2_SIZE TMP2_L1_size
#define TEX_BIND_L2_PT TMP2_L1_pt

const float kernels[288] = float[288](
  +0.1373991f, -0.1664245f, -0.2873584f, +0.0630584f, -0.2635753f, -0.0996166f, +0.0311955f, +0.2254902f,
  +0.1100796f, -0.0976456f, -0.0005464f, +0.0831718f, +0.0048809f, -0.0566882f, -0.1476951f, +0.0908713f,
  -0.0054858f, +0.1355162f, -0.0135676f, +0.0770225f, -0.0154837f, -0.0207298f, +0.1947926f, +0.3509229f,
  +0.0954074f, -0.0267414f, -0.1906442f, +0.0284086f, -0.2387124f, +0.1306308f, -0.0803327f, +0.0659667f,
  -0.0506518f, +0.2046749f, +0.1917644f, +0.0059778f, +0.0168488f, +0.3005833f, -0.0994089f, -0.0018667f,
  +0.1625432f, -0.0040685f, -0.2734047f, -0.0819991f, -0.0100536f, +0.6088635f, +0.3359644f, -0.0885435f,
  +0.1151745f, +0.0660932f, +0.0976288f, +0.1511738f, -0.2075226f, -0.1854531f, -0.2243368f, -0.0249139f,
  +0.1143486f, +0.1903220f, +0.1320508f, -0.1342956f, +0.0963042f, +0.3153816f, -0.1012990f, -0.0074681f,
  +0.1581281f, +0.2486297f, -0.0933139f, +0.4936191f, -0.0382145f, -0.4926094f, +0.2235705f, -0.1071730f,
  +0.1033769f, +0.1904667f, +0.1529629f, -0.0724131f, +0.2387014f, -0.0823179f, +0.1378564f, -0.0899107f,
  -0.1173993f, +0.1021622f, -0.0695041f, -0.2420722f, -0.0628639f, -0.2381296f, +0.0317154f, -0.1561877f,
  +0.0236306f, -0.1100348f, +0.1439174f, -0.3067397f, -0.0729566f, -0.1952960f, +0.1264277f, -0.0766758f,
  -0.1026265f, +0.1100180f, -0.1247062f, +0.0767465f, +0.3969593f, +0.1789650f, +0.1378026f, -0.1764011f,
  -0.5143707f, -0.0189357f, -0.1959975f, +0.0260405f, -0.0903258f, -0.0066961f, -0.1240043f, -0.0068890f,
  -0.2896258f, -0.0218598f, +0.0247063f, +0.3462772f, -0.2002443f, -0.1633589f, -0.1592230f, -0.0456615f,
  +0.2033937f, -0.0583407f, -0.2978525f, -0.1951669f, -0.1269517f, +0.2421987f, +0.1140254f, -0.0865055f,
  -0.5763342f, -0.0966827f, +0.0500643f, -0.0378169f, -0.3078279f, -0.3584989f, +0.0491755f, -0.0171371f,
  -0.3141927f, -0.0559892f, -0.1193396f, -0.1998211f, -0.0494938f, -0.3071780f, -0.3266065f, -0.1865830f,
  +0.0242401f, +0.1973680f, +0.1939189f, +0.1872378f, +0.1438728f, -0.1016721f, +0.0794567f, -0.1242859f,
  +0.1666517f, -0.0188770f, +0.1228862f, +0.4754182f, +0.0258275f, -0.2185213f, +0.1471128f, -0.1231656f,
  +0.1181430f, -0.0939275f, +0.0979060f, +0.2262670f, +0.2399745f, -0.0588372f, -0.0463136f, +0.2419844f,
  -0.7043076f, +0.4730785f, +0.2988142f, -0.1568539f, +0.1675983f, -0.3270706f, -0.3980947f, -0.0009554f,
  +0.1202493f, +0.2184623f, -0.3384849f, -0.0119100f, +0.4219678f, +0.2519674f, +0.3357213f, -0.3057925f,
  +0.2126034f, +0.2705441f, -0.0189913f, -0.2666518f, +0.0954111f, -0.1044077f, +0.7282950f, +0.3165742f,
  -0.2367986f, +0.0451825f, +0.1460666f, -0.0755965f, +0.1569323f, -0.0994445f, +0.4306276f, -0.1379793f,
  -0.3824418f, +0.3091509f, +0.2136996f, -0.1776502f, +0.4223725f, +0.0065334f, -0.1734567f, +0.1230836f,
  +0.3133565f, +0.1596126f, -0.1227016f, -0.2081480f, -0.1460877f, +0.1159538f, +0.3640914f, +0.4734206f,
  -0.0601202f, -0.1773094f, -0.1145122f, -0.0321784f, -0.4135819f, -0.0008415f, +0.0050341f, +0.4058493f,
  +0.2404930f, -0.0786575f, -0.1814677f, -0.2310251f, -0.0205246f, -0.3003516f, +0.0857933f, +0.1380065f,
  -0.1564648f, -0.1327192f, +0.2370982f, +0.2197556f, +0.1390186f, -0.1583045f, +0.1148297f, +0.2851482f,
  -0.2061740f, -0.0180216f, +0.2453021f, +0.2402589f, +0.2542985f, -0.2975972f, -0.2769720f, +0.4636748f,
  +0.5683928f, +0.3173346f, -0.5119255f, -0.1321107f, +0.1903104f, +0.4686476f, +0.0202436f, -0.1074257f,
  +0.0919787f, -0.0211182f, +0.1321296f, +0.0502077f, +0.0788082f, +0.1552664f, +0.6302471f, +0.3282956f,
  -0.5110233f, +0.1355887f, +0.4475112f, +0.1901172f, +0.2432540f, +0.0258812f, -0.0552424f, +0.3822121f,
  -0.2919378f, +0.2175187f, -0.1360299f, +0.0155758f, +0.2080939f, +0.3228692f, -0.3474948f, -0.0505443f,
  +0.3111627f, +0.0645443f, +0.3889208f, +0.4103093f, -0.1349576f, +0.1233285f, +0.1900646f, +0.0695266f
);

const float biases[4] = float[4](
  +0.0657458f, +0.1019368f, -0.1989109f, -0.0874846f
);

vec4 hook() {
    const vec4 r[9][2] = vec4[9][2](
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 1.0f)))
    );

    float sum[4] = biases;
    for (int n = 0; n < 4; n++) {
        for (int i = 0; i < 9; i++) {
            const vec4 k0 = vec4(kernels[n * 8 * 9 + 8 * i + 0], kernels[n * 8 * 9 + 8 * i + 1], kernels[n * 8 * 9 + 8 * i + 2], kernels[n * 8 * 9 + 8 * i + 3]);
            const vec4 k1 = vec4(kernels[n * 8 * 9 + 8 * i + 4], kernels[n * 8 * 9 + 8 * i + 5], kernels[n * 8 * 9 + 8 * i + 6], kernels[n * 8 * 9 + 8 * i + 7]);
            sum[n] += (dot(k0, r[i][0]) + dot(k1, r[i][1]));
        }
    }

    return ACTIVE(vec4(sum[0], sum[1], sum[2], sum[3]) * 0.2000000f + TEX_BIND_L2_TEXOFF(vec2(0.0f, 0.0f)));
}

//!HOOK LUMA
//!DESC ARNet b16 Layer13 L0
//!WHEN OUTPUT.w LUMA.w / 1.2 > OUTPUT.h LUMA.h / 1.2 > *
//!BIND TMP2_L0
//!BIND TMP2_L1
//!SAVE TMP1_L0
//!COMPONENTS 4

#define ACTIVE(v) (max(v, v * 0.2000000f))

#define TEX_BIND_L0_TEXOFF TMP2_L0_texOff
#define TEX_BIND_L0_TEX TMP2_L0_tex
#define TEX_BIND_L0_POS TMP2_L0_pos
#define TEX_BIND_L0_SIZE TMP2_L0_size
#define TEX_BIND_L0_PT TMP2_L0_pt

#define TEX_BIND_L1_TEXOFF TMP2_L1_texOff
#define TEX_BIND_L1_TEX TMP2_L1_tex
#define TEX_BIND_L1_POS TMP2_L1_pos
#define TEX_BIND_L1_SIZE TMP2_L1_size
#define TEX_BIND_L1_PT TMP2_L1_pt

const float kernels[288] = float[288](
  +0.1443187f, -0.0075923f, +0.2371287f, +0.1136200f, -0.4359613f, -0.2466250f, -0.2492844f, -0.3950868f,
  +0.3380199f, +0.1335141f, -0.0492958f, -0.1925775f, -0.1675401f, +0.1729242f, -0.0607596f, -0.2499647f,
  +0.4197081f, +0.0846549f, -0.2079459f, -0.1070233f, +0.1744275f, +0.1969084f, +0.0858367f, +0.2297030f,
  +0.4072903f, +0.1125601f, -0.1986163f, -0.1907901f, -0.0753178f, +0.1284999f, -0.1887215f, -0.0868569f,
  -0.0790819f, +0.1870430f, +0.4716367f, -0.1112131f, -0.3917105f, +0.5279201f, -0.1820765f, -0.1616544f,
  +0.3016974f, -0.1272333f, +0.3479486f, +0.0377852f, -0.2831527f, +0.3026949f, +0.5362634f, +0.1019750f,
  +0.0338930f, +0.1771468f, -0.0766865f, +0.1787971f, -0.0820381f, -0.3343301f, -0.0297393f, -0.0221043f,
  -0.5803942f, +0.4349675f, +0.2455198f, +0.2009553f, +0.1068843f, +0.0314492f, +0.0132282f, +0.0793492f,
  -0.1403956f, -0.2016235f, +0.3421193f, +0.2619387f, +0.2189709f, -0.1687574f, +0.6540815f, -0.2152537f,
  -0.3669334f, +0.0623257f, -0.0188035f, -0.1231116f, +0.2440638f, -0.3163623f, +0.1671445f, +0.1106521f,
  -0.1972663f, +0.0115029f, +0.1328585f, +0.2197424f, -0.1525485f, -0.2000789f, -0.0843602f, -0.1768467f,
  -0.0573649f, +0.0109447f, -0.1852846f, +0.4579085f, -0.2047199f, -0.2284186f, -0.0212108f, -0.0403368f,
  +0.0498854f, +0.1530927f, +0.4341805f, +0.2133389f, +0.1785064f, +0.1187683f, -0.3487661f, -0.0047828f,
  +0.3585391f, -0.2749363f, -0.2168319f, +0.2094571f, +0.3560422f, -0.1599809f, -0.3021568f, -0.0328518f,
  +0.2860104f, +0.1974040f, +0.3657441f, -0.0663623f, -0.6048872f, +0.1308965f, +0.3491971f, +0.2878383f,
  -0.2979408f, -0.2071302f, +0.0179117f, +0.1560682f, -0.1298816f, +0.2204299f, +0.0426563f, -0.1756226f,
  -0.2950527f, +0.0134017f, +0.1115978f, -0.3118115f, -0.1748600f, +0.4019392f, -0.0426820f, -0.1999743f,
  -0.0866779f, +0.4533078f, +0.3035416f, -0.0520951f, -0.7169145f, +0.4203682f, +0.0735047f, -0.0611673f,
  -0.1555109f, -0.0993068f, -0.2838838f, -0.0638672f, -0.1671995f, -0.2058334f, +0.7110631f, -0.5025341f,
  +0.5865799f, -0.0903936f, +0.0727983f, -0.0207660f, -0.0472548f, +0.5788663f, +0.2243886f, -0.6239586f,
  +0.1951849f, -0.4006189f, -0.3327002f, -0.3900896f, +0.2034377f, +0.0445590f, +0.4208887f, -0.4051146f,
  -0.1800904f, -0.0755840f, -0.5914689f, -0.5003219f, -0.2753999f, +0.0284340f, +0.0735673f, -0.4771171f,
  -0.6577024f, +0.0639089f, +0.0292723f, -0.0427464f, -0.2910523f, +0.1223928f, -0.2059327f, -0.1366187f,
  +0.1069392f, -0.0104670f, -0.1007138f, +0.0148804f, +0.0155386f, +0.1225921f, +0.2010398f, +0.0310302f,
  -0.2305993f, -0.2468883f, -0.3853544f, -0.1366372f, -0.0420582f, +0.2596574f, +0.1444514f, -0.0718691f,
  -0.2399879f, -0.0354079f, +0.3002309f, +0.0430773f, -0.1560948f, -0.0344354f, -0.4626983f, +0.1467956f,
  -0.2172317f, -0.0733311f, +0.2469413f, +0.1130572f, -0.2665012f, -0.1915186f, -0.1299869f, -0.2240049f,
  -0.5581507f, +0.0951048f, -0.1638296f, +0.4236220f, -0.1731273f, -0.0975165f, +0.0834260f, +0.1687011f,
  -0.6926373f, +0.1109114f, -0.3709412f, -0.1875877f, -0.1234563f, +0.0425888f, -0.1166173f, +0.0062202f,
  +0.1141018f, +0.4917953f, -0.0968873f, -0.2009362f, +0.2900710f, +0.0568940f, +0.3132406f, -0.0335217f,
  -0.2524900f, -0.0279220f, +0.0770524f, +0.3697911f, +0.1759700f, +0.3364586f, +0.1091172f, +0.2844340f,
  +0.1544019f, +0.5922051f, -0.2989182f, +0.7097232f, -0.1805997f, -0.3127047f, +0.2272224f, +0.2352453f,
  -0.2816957f, -0.0836873f, -0.1796451f, -0.1574128f, -0.0345746f, -0.1241662f, -0.1581594f, -0.0141210f,
  -0.2876879f, -0.0013828f, +0.5282462f, +0.0465960f, +0.2208899f, +0.1862777f, +0.0138139f, -0.0381093f,
  +0.0304376f, +0.0674456f, -0.0253084f, +0.4186880f, +0.0007732f, -0.1036597f, -0.6695383f, +0.2883002f,
  -0.5639954f, -0.1417969f, +0.0400051f, +0.2524969f, +0.1625615f, -0.1230314f, +0.1114175f, +0.1729814f
);

const float biases[4] = float[4](
  -0.0033217f, +0.0223414f, +0.0084966f, +0.0377740f
);

vec4 hook() {
    const vec4 r[9][2] = vec4[9][2](
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 1.0f)))
    );

    float sum[4] = biases;
    for (int n = 0; n < 4; n++) {
        for (int i = 0; i < 9; i++) {
            const vec4 k0 = vec4(kernels[n * 8 * 9 + 8 * i + 0], kernels[n * 8 * 9 + 8 * i + 1], kernels[n * 8 * 9 + 8 * i + 2], kernels[n * 8 * 9 + 8 * i + 3]);
            const vec4 k1 = vec4(kernels[n * 8 * 9 + 8 * i + 4], kernels[n * 8 * 9 + 8 * i + 5], kernels[n * 8 * 9 + 8 * i + 6], kernels[n * 8 * 9 + 8 * i + 7]);
            sum[n] += (dot(k0, r[i][0]) + dot(k1, r[i][1]));
        }
    }

    return ACTIVE(vec4(sum[0], sum[1], sum[2], sum[3]));
}

//!HOOK LUMA
//!DESC ARNet b16 Layer13 L1
//!WHEN OUTPUT.w LUMA.w / 1.2 > OUTPUT.h LUMA.h / 1.2 > *
//!BIND TMP2_L0
//!BIND TMP2_L1
//!SAVE TMP1_L1
//!COMPONENTS 4

#define ACTIVE(v) (max(v, v * 0.2000000f))

#define TEX_BIND_L0_TEXOFF TMP2_L0_texOff
#define TEX_BIND_L0_TEX TMP2_L0_tex
#define TEX_BIND_L0_POS TMP2_L0_pos
#define TEX_BIND_L0_SIZE TMP2_L0_size
#define TEX_BIND_L0_PT TMP2_L0_pt

#define TEX_BIND_L1_TEXOFF TMP2_L1_texOff
#define TEX_BIND_L1_TEX TMP2_L1_tex
#define TEX_BIND_L1_POS TMP2_L1_pos
#define TEX_BIND_L1_SIZE TMP2_L1_size
#define TEX_BIND_L1_PT TMP2_L1_pt

const float kernels[288] = float[288](
  +0.0551176f, -0.0926181f, +0.0496513f, -0.0744185f, +0.2994502f, -0.4404236f, +0.2394368f, +0.2651778f,
  -0.0577495f, -0.1289515f, +0.1378636f, +0.0170172f, +0.0726284f, -0.0928908f, +0.4587588f, +0.2187400f,
  -0.1067503f, +0.0895091f, +0.0229746f, +0.2521941f, +0.0259002f, -0.1513375f, +0.2529984f, -0.0596246f,
  +0.0214851f, +0.2817037f, +0.3901251f, -0.2358182f, +0.2401012f, +0.0418336f, +0.2586489f, -0.0654484f,
  +0.6706747f, +0.0321867f, -0.0264607f, +0.5627544f, -0.3999048f, +0.3860890f, -0.0041607f, +0.2774373f,
  -0.0260163f, -0.0838513f, -0.2300967f, +0.0151688f, -0.1555958f, -0.1791886f, +0.0145311f, -0.0453197f,
  -0.0338415f, +0.1196575f, +0.1046657f, -0.0836444f, +0.2632056f, +0.2548982f, +0.0101009f, +0.2756373f,
  +0.4553923f, +0.1225687f, +0.0363511f, -0.2446753f, -0.0653284f, -0.1553264f, -0.0709662f, +0.1116777f,
  +0.1627695f, -0.1915817f, +0.0669346f, +0.0286613f, -0.3302579f, +0.3743730f, -0.0133654f, -0.0384501f,
  +0.1875255f, +0.1828067f, -0.0700406f, -0.0517648f, -0.0897397f, -0.0692056f, -0.2699796f, +0.0975260f,
  +0.0834360f, +0.3444321f, -0.4326572f, -0.1470001f, +0.1097121f, +0.0394034f, -0.4372904f, -0.1761827f,
  -0.0603414f, +0.1028983f, -0.2004963f, -0.1753092f, +0.1273677f, +0.0906369f, +0.0370201f, -0.1158298f,
  +0.1049912f, +0.0285915f, +0.3775524f, +0.2196659f, -0.5015929f, +0.0713744f, -0.0831596f, -0.3597147f,
  +0.0390445f, +0.3866741f, -0.2362827f, -0.1800044f, -0.0508864f, +0.0709635f, +0.3525203f, +0.3900438f,
  -0.1423190f, -0.1885600f, +0.1231495f, -0.2044523f, +0.3047606f, +0.2119699f, -0.1970705f, +0.1248438f,
  -0.1506834f, -0.4183978f, -0.2120134f, +0.3459071f, -0.2376242f, -0.1339790f, +0.2417063f, -0.0559721f,
  -0.6965863f, -0.1371909f, +0.0356885f, +0.4232662f, +0.2162356f, -0.1594691f, -0.2934982f, -0.0808527f,
  -0.7880514f, -0.2158260f, +0.1716962f, -0.1422291f, +0.3754259f, -0.2129505f, -0.2809621f, -0.2156753f,
  +0.0259967f, +0.0120721f, +0.0873842f, +0.0979274f, -0.1837167f, +0.4705686f, -0.1487938f, -0.0338555f,
  -0.0332517f, -0.2387489f, +0.0341945f, -0.1644998f, -0.0687940f, +0.4289271f, -0.3179671f, +0.1338616f,
  -0.2396252f, -0.2978940f, +0.0788338f, -0.1032788f, -0.0835061f, +0.2482291f, -0.1270990f, -0.2298193f,
  -0.1208515f, -0.1861218f, -0.0008972f, +0.0291433f, -0.1697710f, -0.0894082f, -0.0804735f, +0.0192756f,
  +0.2048161f, -0.4345535f, +0.2795273f, -0.4045291f, +0.1732453f, +0.0396847f, -0.0374126f, -0.1150035f,
  +0.1121345f, -0.0026619f, +0.2066506f, +0.0054892f, -0.0623870f, +0.2089271f, -0.3847230f, +0.2417867f,
  +0.2550337f, +0.0220737f, +0.0658232f, +0.0906709f, -0.3340933f, +0.0797311f, -0.1250146f, +0.0024869f,
  -0.3252261f, +0.3700199f, -0.6287664f, -0.0165941f, -0.3249983f, -0.3501811f, +0.2645796f, +0.0517914f,
  -0.0464221f, +0.1110658f, +0.0779793f, -0.1642598f, -0.3012388f, +0.0359083f, -0.0461935f, +0.3752142f,
  -0.3662442f, -0.2783106f, -0.2954158f, -0.1042921f, -0.4013732f, -0.5365984f, -0.1513658f, +0.3169780f,
  +0.1567603f, +0.3575012f, -0.0772996f, +0.1477419f, +0.0283798f, +0.2745063f, +0.0049393f, -0.3818957f,
  -0.2024037f, -0.2401635f, -0.0558740f, -0.3719620f, -0.1503876f, +0.6541421f, -0.1393679f, -0.1423874f,
  -0.1919365f, -0.2424239f, -0.3883293f, +0.3104988f, -0.0549533f, -0.1672411f, -0.0367834f, +0.2611201f,
  +0.0528704f, +0.4045755f, +0.2852541f, +0.4893211f, +0.0302219f, +0.0328074f, -0.4648893f, +0.0865016f,
  -0.7625289f, +0.2734606f, -0.3294616f, -0.1303783f, +0.0219241f, +0.4639359f, -0.4951704f, -0.1809092f,
  -0.0103074f, -0.0717908f, -0.4217443f, +0.0808134f, -0.1657859f, -0.2172476f, +0.1524988f, -0.1106012f,
  -0.1515216f, -0.1981482f, +0.0196002f, +0.0435897f, +0.2604418f, -0.2515196f, +0.1843184f, +0.0304917f,
  -0.0583921f, -0.1064325f, +0.4694052f, -0.1745463f, +0.0781535f, +0.0511606f, -0.0036166f, +0.1927299f
);

const float biases[4] = float[4](
  -0.0144440f, +0.0240319f, +0.1401225f, -0.0059153f
);

vec4 hook() {
    const vec4 r[9][2] = vec4[9][2](
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 1.0f)))
    );

    float sum[4] = biases;
    for (int n = 0; n < 4; n++) {
        for (int i = 0; i < 9; i++) {
            const vec4 k0 = vec4(kernels[n * 8 * 9 + 8 * i + 0], kernels[n * 8 * 9 + 8 * i + 1], kernels[n * 8 * 9 + 8 * i + 2], kernels[n * 8 * 9 + 8 * i + 3]);
            const vec4 k1 = vec4(kernels[n * 8 * 9 + 8 * i + 4], kernels[n * 8 * 9 + 8 * i + 5], kernels[n * 8 * 9 + 8 * i + 6], kernels[n * 8 * 9 + 8 * i + 7]);
            sum[n] += (dot(k0, r[i][0]) + dot(k1, r[i][1]));
        }
    }

    return ACTIVE(vec4(sum[0], sum[1], sum[2], sum[3]));
}

//!HOOK LUMA
//!DESC ARNet b16 Layer14 L0
//!WHEN OUTPUT.w LUMA.w / 1.2 > OUTPUT.h LUMA.h / 1.2 > *
//!BIND TMP1_L0
//!BIND TMP1_L1
//!BIND TMP2_L0
//!SAVE TMP2_L0
//!COMPONENTS 4

#define ACTIVE(v) (v)

#define TEX_BIND_L0_TEXOFF TMP1_L0_texOff
#define TEX_BIND_L0_TEX TMP1_L0_tex
#define TEX_BIND_L0_POS TMP1_L0_pos
#define TEX_BIND_L0_SIZE TMP1_L0_size
#define TEX_BIND_L0_PT TMP1_L0_pt

#define TEX_BIND_L1_TEXOFF TMP1_L1_texOff
#define TEX_BIND_L1_TEX TMP1_L1_tex
#define TEX_BIND_L1_POS TMP1_L1_pos
#define TEX_BIND_L1_SIZE TMP1_L1_size
#define TEX_BIND_L1_PT TMP1_L1_pt

#define TEX_BIND_L2_TEXOFF TMP2_L0_texOff
#define TEX_BIND_L2_TEX TMP2_L0_tex
#define TEX_BIND_L2_POS TMP2_L0_pos
#define TEX_BIND_L2_SIZE TMP2_L0_size
#define TEX_BIND_L2_PT TMP2_L0_pt

const float kernels[288] = float[288](
  +0.0543261f, -0.2292328f, +0.0034616f, +0.1326256f, +0.0972189f, +0.4112140f, +0.2274760f, +0.0548898f,
  +0.3781521f, -0.2426378f, +0.1280740f, +0.2565724f, -0.2012430f, +0.2251609f, +0.1721924f, -0.0277928f,
  +0.2290193f, -0.2352465f, +0.0830506f, +0.2562909f, -0.0019680f, -0.0735071f, -0.0950839f, -0.1733854f,
  +0.2316857f, +0.1203683f, -0.1827421f, -0.1507016f, +0.0526075f, -0.2953179f, +0.0780340f, +0.4165240f,
  +0.5658262f, -0.2029427f, +0.2085290f, -0.0084399f, -0.1843870f, +0.1255674f, -0.0289121f, +0.8859781f,
  +0.1477581f, +0.1412051f, -0.2809758f, +0.5275986f, -0.1593958f, -0.2853038f, +0.1495295f, +0.1433954f,
  +0.3246379f, +0.0888553f, +0.0895589f, -0.1647444f, -0.1390895f, -0.3904799f, -0.0555495f, +0.1305122f,
  +0.2436878f, -0.1590713f, +0.5158142f, -0.0214925f, +0.1290904f, +0.2963848f, -0.3472246f, +0.1524768f,
  +0.2105191f, -0.0978711f, +0.2592393f, +0.3185878f, +0.0400377f, +0.0087298f, -0.0469729f, +0.0272271f,
  +0.0434246f, -0.6275989f, -0.2385640f, +0.0783713f, -0.2751243f, +0.1812974f, -0.1426942f, -0.1351415f,
  -0.3704841f, -0.2514511f, +0.0318538f, +0.0072904f, -0.3717977f, +0.3999022f, -0.2910939f, -0.2269894f,
  -0.4315575f, -0.2894771f, -0.0999341f, +0.0132115f, +0.0764663f, +0.3681580f, -0.1403479f, +0.1732525f,
  +0.1086004f, -0.3776314f, -0.0796239f, -0.0385000f, +0.0163784f, -0.1420716f, -0.1854838f, +0.0762249f,
  +0.0619178f, +0.2733344f, -0.1731191f, -0.3181987f, -0.0523684f, +0.0269766f, +0.4191332f, -0.5084471f,
  -0.3233753f, -0.4493661f, +0.0985278f, -0.2302078f, -0.1119524f, -0.1353167f, -0.1513126f, +0.0513156f,
  +0.1998828f, +0.2435750f, +0.1318189f, +0.0807067f, +0.1865768f, +0.1024004f, -0.0526267f, -0.0695199f,
  +0.2071526f, +0.4265369f, -0.4538250f, -0.0923695f, +0.0104850f, -0.0537288f, +0.0199542f, -0.3423979f,
  +0.0894305f, -0.0297281f, -0.6731496f, +0.0288204f, -0.0356709f, -0.0075879f, +0.0349053f, +0.0031921f,
  +0.1683187f, -0.1056186f, -0.3585849f, -0.1793041f, +0.1456208f, +0.0758930f, +0.3224573f, -0.1318009f,
  +0.0051892f, -0.0308126f, -0.2508037f, -0.0666909f, +0.0234133f, +0.0424686f, +0.7445599f, -0.1356721f,
  +0.5019729f, -0.1507255f, -0.2645614f, -0.6783484f, +0.1455467f, -0.2943622f, -0.1203065f, -0.5139616f,
  -0.2921187f, -0.1916931f, +0.1815788f, -0.1655999f, -0.1691174f, +0.0980603f, +0.0147208f, +0.3331851f,
  -0.3558137f, -0.1015800f, +0.2926250f, +0.0008182f, -0.1217177f, -0.0953515f, -0.3535053f, -0.3385736f,
  +0.5968804f, -0.0530303f, -0.2840948f, -0.1093664f, -0.4029482f, -0.7220144f, -0.1987941f, +0.2690093f,
  +0.4184625f, +0.2737890f, -0.2367490f, +0.0626670f, -0.0102061f, -0.4089040f, +0.0334050f, +0.0206022f,
  +0.3509317f, +0.0305338f, +0.0303327f, +0.1696605f, +0.2956093f, -0.4863023f, -0.2150821f, +0.0602809f,
  +0.6803735f, +0.0499531f, +0.0458365f, +0.2355563f, +0.0320747f, -0.4359043f, -0.0723090f, +0.0912280f,
  -0.1300804f, -0.1159278f, -0.0398732f, -0.0604771f, -0.2908647f, -0.1274909f, -0.0722910f, -0.0339398f,
  -0.1500158f, -0.0273073f, -0.1771263f, -0.3548961f, -0.1860931f, -0.1415253f, -0.1081075f, +0.0255762f,
  -0.2304311f, -0.0288339f, -0.0623387f, -0.1899371f, +0.3697234f, +0.1915917f, -0.0846841f, +0.1831313f,
  -0.2134552f, -0.1804963f, +0.0060502f, +0.0965393f, +0.0589709f, +0.2742843f, -0.1454058f, -0.1836868f,
  -0.0277109f, -0.0220749f, -0.0902749f, -0.1993728f, -0.1708084f, -0.0804910f, -0.1093557f, -0.8410905f,
  -0.1995959f, +0.2792650f, +0.4237537f, +0.0052086f, +0.2688292f, -0.1598786f, +0.1138223f, -0.1376793f,
  -0.1359838f, -0.0639548f, +0.0524801f, +0.0482728f, +0.0004453f, +0.3680046f, +0.2890713f, +0.0349312f,
  -0.0747374f, +0.3305231f, -0.4796307f, +0.3639732f, -0.1107544f, +0.0265159f, +0.1991651f, -0.1969336f,
  -0.0491886f, +0.2577679f, -0.4504349f, -0.3954941f, +0.0544926f, -0.0378900f, +0.0279382f, -0.0338854f
);

const float biases[4] = float[4](
  -0.0042061f, -0.1435903f, -0.0054680f, +0.0811644f
);

vec4 hook() {
    const vec4 r[9][2] = vec4[9][2](
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 1.0f)))
    );

    float sum[4] = biases;
    for (int n = 0; n < 4; n++) {
        for (int i = 0; i < 9; i++) {
            const vec4 k0 = vec4(kernels[n * 8 * 9 + 8 * i + 0], kernels[n * 8 * 9 + 8 * i + 1], kernels[n * 8 * 9 + 8 * i + 2], kernels[n * 8 * 9 + 8 * i + 3]);
            const vec4 k1 = vec4(kernels[n * 8 * 9 + 8 * i + 4], kernels[n * 8 * 9 + 8 * i + 5], kernels[n * 8 * 9 + 8 * i + 6], kernels[n * 8 * 9 + 8 * i + 7]);
            sum[n] += (dot(k0, r[i][0]) + dot(k1, r[i][1]));
        }
    }

    return ACTIVE(vec4(sum[0], sum[1], sum[2], sum[3]) * 0.2000000f + TEX_BIND_L2_TEXOFF(vec2(0.0f, 0.0f)));
}

//!HOOK LUMA
//!DESC ARNet b16 Layer14 L1
//!WHEN OUTPUT.w LUMA.w / 1.2 > OUTPUT.h LUMA.h / 1.2 > *
//!BIND TMP1_L0
//!BIND TMP1_L1
//!BIND TMP2_L1
//!SAVE TMP2_L1
//!COMPONENTS 4

#define ACTIVE(v) (v)

#define TEX_BIND_L0_TEXOFF TMP1_L0_texOff
#define TEX_BIND_L0_TEX TMP1_L0_tex
#define TEX_BIND_L0_POS TMP1_L0_pos
#define TEX_BIND_L0_SIZE TMP1_L0_size
#define TEX_BIND_L0_PT TMP1_L0_pt

#define TEX_BIND_L1_TEXOFF TMP1_L1_texOff
#define TEX_BIND_L1_TEX TMP1_L1_tex
#define TEX_BIND_L1_POS TMP1_L1_pos
#define TEX_BIND_L1_SIZE TMP1_L1_size
#define TEX_BIND_L1_PT TMP1_L1_pt

#define TEX_BIND_L2_TEXOFF TMP2_L1_texOff
#define TEX_BIND_L2_TEX TMP2_L1_tex
#define TEX_BIND_L2_POS TMP2_L1_pos
#define TEX_BIND_L2_SIZE TMP2_L1_size
#define TEX_BIND_L2_PT TMP2_L1_pt

const float kernels[288] = float[288](
  +0.1883990f, +0.2939402f, -0.0590341f, +0.0571456f, +0.1962920f, -0.1553024f, +0.0673710f, +0.0464386f,
  +0.0784357f, +0.2503513f, +0.0785558f, +0.0883297f, +0.3376720f, -0.1848468f, +0.3947823f, +0.1257055f,
  +0.1728569f, +0.0182988f, +0.1025504f, +0.0522365f, +0.0058425f, -0.1598007f, -0.1151729f, +0.1694837f,
  +0.1658070f, +0.0971555f, +0.0908644f, -0.0902497f, +0.1320018f, -0.2624759f, -0.0340915f, -0.2033487f,
  +0.2860513f, -0.1245917f, -0.0723691f, +0.1064397f, +0.2183893f, +0.2247919f, -0.2763949f, +0.1031777f,
  -0.3148486f, -0.1991822f, +0.2434169f, -0.2962286f, -0.3335313f, +0.0044845f, +0.0218771f, -0.0254125f,
  -0.0706104f, +0.0629749f, +0.1297501f, +0.2417347f, -0.0630495f, -0.0073087f, +0.0359887f, +0.1909949f,
  -0.1373666f, -0.3660402f, +0.0847499f, -0.0979189f, -0.1152619f, +0.0485182f, -0.0036003f, +0.1147054f,
  -0.0762116f, -0.2631128f, +0.0922777f, +0.2082662f, -0.0557355f, +0.1556814f, +0.1516697f, +0.1071017f,
  +0.0421007f, -0.3463813f, -0.0917664f, -0.0062624f, -0.1651913f, +0.0612378f, -0.5780063f, -0.0844079f,
  -0.1397354f, -0.3003806f, -0.0645832f, -0.1017653f, -0.1431765f, +0.2256166f, -0.1091550f, +0.0365931f,
  -0.2083902f, -0.1749838f, +0.0510513f, +0.0295433f, -0.0048917f, +0.3221872f, -0.3588810f, -0.0710517f,
  -0.0022816f, +0.1648773f, +0.0050674f, -0.0231032f, -0.1526548f, -0.0990512f, +0.3107235f, +0.0249888f,
  -0.3696400f, +0.1684478f, -0.1190313f, -0.2754054f, -0.2321913f, -0.3658116f, +0.4173765f, +0.1252701f,
  -0.4812156f, +0.0828278f, +0.1797671f, -0.1103949f, -0.1926554f, +0.1093919f, -0.0655286f, -0.2218310f,
  +0.0244687f, +0.2960935f, -0.1493785f, +0.0233937f, +0.3272225f, -0.0521963f, -0.0467872f, -0.2242067f,
  -0.1492640f, +0.4501137f, -0.3151485f, +0.2184289f, +0.0461113f, +0.0301678f, +0.1280063f, -0.1007235f,
  -0.1502334f, +0.1684392f, +0.1776468f, -0.0288325f, +0.3343911f, -0.1987459f, -0.1946752f, -0.0981957f,
  -0.0487252f, -0.3455918f, -0.3015289f, -0.1196335f, -0.0322133f, +0.3029666f, +0.1506641f, -0.1298054f,
  -0.0912516f, -0.1176489f, -0.0905897f, +0.2631013f, +0.0512625f, +0.4473749f, +0.0397841f, -0.3049356f,
  +0.0554177f, -0.2133376f, -0.3455978f, -0.4093544f, +0.1533127f, -0.0231314f, +0.0194811f, +0.0053075f,
  -0.1407721f, -0.2536567f, -0.1215346f, -0.0034525f, +0.0579833f, +0.3994325f, +0.1427253f, +0.2776800f,
  +0.0718529f, -0.3536547f, +0.1598740f, +0.0397158f, -0.3944695f, +0.5308644f, +0.0007902f, -0.0983507f,
  +0.0569747f, -0.0344515f, +0.0886394f, -0.0935942f, -0.1837849f, +0.0777726f, -0.1269001f, -0.0087626f,
  +0.3615372f, -0.0804607f, -0.1769436f, -0.2262465f, -0.2931666f, -0.3553628f, +0.0490460f, -0.1884775f,
  -0.1367734f, -0.3508837f, -0.0502114f, -0.0023465f, -0.2570203f, +0.5272182f, +0.0670400f, -0.0021711f,
  -0.2353567f, -0.2607961f, +0.0083214f, +0.0083533f, -0.1885199f, -0.0353877f, -0.1183214f, -0.0219488f,
  +0.3537999f, -0.0248317f, -0.3399802f, +0.0496433f, +0.2513229f, -0.1865685f, +0.0122511f, +0.0994823f,
  +0.3101428f, -0.2673855f, -0.2135779f, +0.0141517f, +0.3125835f, +0.0281783f, +0.2781206f, +0.1947846f,
  +0.0270104f, -0.1350926f, +0.0612074f, -0.0816099f, -0.3018700f, -0.0074062f, -0.6596906f, +0.0790395f,
  +0.4080581f, +0.0981130f, -0.1963032f, +0.1329750f, -0.0450205f, +0.1552596f, -0.2148076f, -0.0085821f,
  +0.1317071f, +0.0579811f, +0.1321038f, -0.2315861f, -0.3873392f, +0.2596013f, +0.4575773f, -0.1548660f,
  -0.3153716f, -0.2267374f, +0.4196558f, -0.2731953f, -0.2961053f, +0.1341385f, +0.0878069f, -0.1868251f,
  +0.0604092f, +0.2048331f, +0.1432320f, +0.0962904f, -0.1399785f, -0.1041624f, +0.2210889f, +0.0160784f,
  +0.1336191f, -0.3596177f, +0.3535310f, -0.5052245f, -0.0567736f, +0.3079133f, -0.2187307f, +0.0787493f,
  -0.2679618f, +0.0023645f, +0.1115986f, +0.1813744f, +0.0263286f, +0.2191798f, +0.1998781f, -0.2350260f
);

const float biases[4] = float[4](
  +0.1111004f, +0.0130686f, -0.1298770f, -0.1200497f
);

vec4 hook() {
    const vec4 r[9][2] = vec4[9][2](
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 1.0f)))
    );

    float sum[4] = biases;
    for (int n = 0; n < 4; n++) {
        for (int i = 0; i < 9; i++) {
            const vec4 k0 = vec4(kernels[n * 8 * 9 + 8 * i + 0], kernels[n * 8 * 9 + 8 * i + 1], kernels[n * 8 * 9 + 8 * i + 2], kernels[n * 8 * 9 + 8 * i + 3]);
            const vec4 k1 = vec4(kernels[n * 8 * 9 + 8 * i + 4], kernels[n * 8 * 9 + 8 * i + 5], kernels[n * 8 * 9 + 8 * i + 6], kernels[n * 8 * 9 + 8 * i + 7]);
            sum[n] += (dot(k0, r[i][0]) + dot(k1, r[i][1]));
        }
    }

    return ACTIVE(vec4(sum[0], sum[1], sum[2], sum[3]) * 0.2000000f + TEX_BIND_L2_TEXOFF(vec2(0.0f, 0.0f)));
}

//!HOOK LUMA
//!DESC ARNet b16 Layer15 L0
//!WHEN OUTPUT.w LUMA.w / 1.2 > OUTPUT.h LUMA.h / 1.2 > *
//!BIND TMP2_L0
//!BIND TMP2_L1
//!SAVE TMP1_L0
//!COMPONENTS 4

#define ACTIVE(v) (max(v, v * 0.2000000f))

#define TEX_BIND_L0_TEXOFF TMP2_L0_texOff
#define TEX_BIND_L0_TEX TMP2_L0_tex
#define TEX_BIND_L0_POS TMP2_L0_pos
#define TEX_BIND_L0_SIZE TMP2_L0_size
#define TEX_BIND_L0_PT TMP2_L0_pt

#define TEX_BIND_L1_TEXOFF TMP2_L1_texOff
#define TEX_BIND_L1_TEX TMP2_L1_tex
#define TEX_BIND_L1_POS TMP2_L1_pos
#define TEX_BIND_L1_SIZE TMP2_L1_size
#define TEX_BIND_L1_PT TMP2_L1_pt

const float kernels[288] = float[288](
  +0.0599890f, +0.2394282f, -0.0198380f, -0.0605535f, -0.1776819f, -0.0796691f, -0.0451144f, +0.0004758f,
  +0.0846866f, +0.1948009f, -0.1021154f, -0.2837125f, +0.1586303f, +0.0621503f, -0.0398392f, -0.0494245f,
  -0.0277749f, +0.0824351f, +0.0822052f, -0.0087938f, +0.0504373f, +0.0180420f, +0.1621218f, -0.0512019f,
  -0.4618059f, +0.3648122f, +0.2663815f, -0.1630516f, -0.1874000f, -0.2667358f, +0.2462513f, +0.6067502f,
  -0.0125990f, -0.2623615f, -0.0629323f, -0.0661435f, -0.3185277f, -0.1120549f, +0.1057312f, +0.0448984f,
  -0.1072549f, +0.0606573f, +0.0560462f, -0.0493459f, +0.1263452f, -0.0590743f, -0.2739362f, +0.1019937f,
  +0.0180265f, +0.2392831f, -0.0246079f, -0.0727495f, -0.3591796f, -0.1578910f, +0.1166958f, +0.0336432f,
  -0.0242614f, -0.0720764f, -0.0352728f, -0.0991030f, -0.1849718f, -0.1620070f, -0.1272034f, +0.0461705f,
  -0.0336513f, -0.0548137f, +0.0369661f, -0.0824323f, +0.0932954f, +0.0215253f, +0.2229263f, -0.1223200f,
  -0.2980809f, +0.1311779f, +0.2364634f, -0.1535652f, +0.2989062f, -0.1705811f, -0.1318210f, +0.0006770f,
  -0.0593757f, +0.0610670f, -0.3677537f, -0.0836783f, -0.1256136f, +0.4338583f, -0.4679721f, -0.0404454f,
  +0.3258012f, -0.0720431f, -0.1300716f, -0.0271751f, +0.0628011f, -0.0327729f, -0.0739910f, -0.2347495f,
  -0.1429254f, -0.1299603f, +0.0484580f, -0.0756498f, -0.1722327f, -0.2192709f, -0.2856153f, -0.1084015f,
  -0.3743235f, +0.2787936f, -0.3361468f, -0.3446092f, +0.2147546f, +0.0274726f, +0.0002914f, +0.3473751f,
  +0.2970972f, +0.0787888f, -0.2437572f, +0.0185803f, +0.0137899f, +0.0089482f, +0.0774210f, +0.0786589f,
  -0.1302151f, -0.2406758f, +0.2227565f, -0.2438609f, +0.0670835f, +0.1298206f, -0.1074114f, -0.1923383f,
  +0.3250430f, -0.3646896f, -0.4650043f, +0.1535710f, +0.1586620f, +0.3754638f, -0.0731462f, +0.4322140f,
  -0.0886642f, +0.0770681f, -0.0748121f, +0.0631331f, -0.0939443f, -0.0458413f, -0.0750092f, -0.0920544f,
  -0.1820322f, -0.0698379f, -0.1637701f, +0.3281140f, -0.1763140f, +0.3225743f, -0.0422861f, -0.0965381f,
  +0.5357220f, -0.0839242f, -0.2089766f, +0.5116503f, -0.3107743f, +0.6746964f, -0.1050255f, -0.3634588f,
  +0.1586999f, +0.1980358f, -0.2387432f, +0.5001664f, -0.2256955f, +0.3825731f, -0.2663485f, -0.1673359f,
  -0.5787152f, +0.1292716f, -0.2668543f, -0.1579277f, +0.0102962f, -0.1522889f, +0.2275450f, -0.2803780f,
  -0.6256067f, +0.5840998f, +0.2135036f, -0.5091419f, -0.1919218f, +0.1321832f, +0.7023727f, +0.1948047f,
  -0.1934989f, +0.1122986f, +0.3671781f, +0.0478514f, -0.1653011f, -0.0297815f, +0.4210887f, +0.2625310f,
  +0.2812293f, -0.1675526f, -0.2280226f, -0.2501352f, -0.0187318f, +0.0764841f, +0.1905813f, +0.0993397f,
  +0.1101168f, -0.0095246f, +0.1246323f, -0.3299524f, +0.0371322f, -0.0764053f, -0.1631043f, -0.0822790f,
  +0.2385417f, +0.1369969f, +0.0969806f, +0.1031234f, -0.0327602f, -0.0822319f, +0.0865006f, +0.0862826f,
  -0.1370087f, -0.1270611f, +0.1773235f, +0.1469557f, +0.3736225f, -0.2050726f, -0.0890539f, -0.0353755f,
  -0.2917766f, -0.0902761f, +0.3812180f, -0.0209734f, +0.3430560f, -0.3955059f, -0.0707639f, -0.0262371f,
  -0.1178697f, -0.3197011f, +0.3665217f, +0.3456736f, -0.0367325f, -0.1903276f, +0.0689806f, -0.0113104f,
  -0.1194327f, +0.0078654f, +0.0319383f, -0.2173561f, +0.0877460f, -0.3653892f, -0.0898124f, -0.1069750f,
  +0.0316082f, -0.1418623f, +0.1052028f, -0.1148648f, +0.2466968f, +0.0302814f, +0.1337867f, +0.1121741f,
  -0.0183484f, +0.3150432f, +0.1595448f, +0.0494061f, +0.3117246f, -0.1866207f, -0.1169874f, +0.1247742f,
  +0.1750071f, -0.0988253f, -0.2064822f, +0.1598899f, -0.0650015f, -0.4152602f, +0.0480687f, -0.0866181f,
  +0.2911673f, +0.0617504f, +0.0161250f, -0.1982775f, +0.1966064f, -0.1023774f, +0.0371536f, +0.0049624f,
  +0.1391913f, +0.0483568f, +0.3120474f, +0.2644021f, +0.2465400f, +0.1220321f, +0.2155363f, +0.1645369f
);

const float biases[4] = float[4](
  -0.6004348f, -0.1477163f, +0.0624112f, +0.0377272f
);

vec4 hook() {
    const vec4 r[9][2] = vec4[9][2](
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 1.0f)))
    );

    float sum[4] = biases;
    for (int n = 0; n < 4; n++) {
        for (int i = 0; i < 9; i++) {
            const vec4 k0 = vec4(kernels[n * 8 * 9 + 8 * i + 0], kernels[n * 8 * 9 + 8 * i + 1], kernels[n * 8 * 9 + 8 * i + 2], kernels[n * 8 * 9 + 8 * i + 3]);
            const vec4 k1 = vec4(kernels[n * 8 * 9 + 8 * i + 4], kernels[n * 8 * 9 + 8 * i + 5], kernels[n * 8 * 9 + 8 * i + 6], kernels[n * 8 * 9 + 8 * i + 7]);
            sum[n] += (dot(k0, r[i][0]) + dot(k1, r[i][1]));
        }
    }

    return ACTIVE(vec4(sum[0], sum[1], sum[2], sum[3]));
}

//!HOOK LUMA
//!DESC ARNet b16 Layer15 L1
//!WHEN OUTPUT.w LUMA.w / 1.2 > OUTPUT.h LUMA.h / 1.2 > *
//!BIND TMP2_L0
//!BIND TMP2_L1
//!SAVE TMP1_L1
//!COMPONENTS 4

#define ACTIVE(v) (max(v, v * 0.2000000f))

#define TEX_BIND_L0_TEXOFF TMP2_L0_texOff
#define TEX_BIND_L0_TEX TMP2_L0_tex
#define TEX_BIND_L0_POS TMP2_L0_pos
#define TEX_BIND_L0_SIZE TMP2_L0_size
#define TEX_BIND_L0_PT TMP2_L0_pt

#define TEX_BIND_L1_TEXOFF TMP2_L1_texOff
#define TEX_BIND_L1_TEX TMP2_L1_tex
#define TEX_BIND_L1_POS TMP2_L1_pos
#define TEX_BIND_L1_SIZE TMP2_L1_size
#define TEX_BIND_L1_PT TMP2_L1_pt

const float kernels[288] = float[288](
  +0.0301060f, -0.0378226f, -0.1285236f, +0.0180424f, +0.1070134f, +0.1096046f, -0.0580533f, +0.1135755f,
  -0.1083309f, +0.0229912f, +0.0779416f, -0.1218524f, +0.2307613f, -0.0861369f, +0.4782904f, +0.1549247f,
  -0.1758883f, -0.0439709f, +0.5337620f, -0.1514667f, +0.0999150f, -0.2934429f, +0.3178968f, +0.2861227f,
  +0.0458516f, +0.3389023f, -0.0690852f, +0.2302331f, -0.2570229f, -0.0279461f, -0.1483551f, +0.1263116f,
  +0.3463912f, -0.2451573f, +0.2058860f, +0.0908488f, -0.0731129f, -0.3281482f, -0.4825266f, -0.3871858f,
  -0.2766820f, +0.3290368f, +0.3535826f, -0.2665174f, +0.4930513f, -0.1869589f, +0.0098615f, -0.1171002f,
  -0.0130270f, -0.0043809f, +0.0889688f, +0.0641202f, +0.0762258f, +0.2196873f, -0.2019578f, +0.1873432f,
  +0.3597944f, -0.5631632f, -0.1656773f, +0.1445336f, -0.2660810f, -0.0223404f, -0.2535023f, +0.0382339f,
  -0.2888959f, -0.6804065f, -0.3819161f, -0.0773491f, +0.1839203f, -0.1767522f, -0.5205769f, +0.0179869f,
  +0.0226395f, +0.2152547f, -0.1142838f, +0.0735920f, -0.5650904f, -0.0205383f, -0.1096027f, -0.1889761f,
  +0.2346816f, -0.0193941f, -0.5021066f, +0.0240363f, +0.1731683f, +0.5600882f, -0.0209534f, +0.2799554f,
  -0.4712836f, +0.3812026f, +0.5660604f, -0.2220316f, -0.4656025f, +0.1428686f, -0.0088973f, -0.3458369f,
  +0.4267342f, -0.1567598f, -0.2349172f, -0.0286980f, -0.1050505f, -0.2567287f, +0.2647518f, +0.1167382f,
  -0.1461491f, -0.2993520f, -0.0925445f, +0.2639085f, +0.2315708f, +0.5610457f, -0.1490695f, -0.3224537f,
  -0.4245410f, +0.1760101f, +0.2200297f, -0.2861212f, -0.5774412f, +0.1755978f, +0.3044715f, -0.6094957f,
  +0.4123783f, -0.3807169f, +0.0161415f, +0.1943746f, +0.1703327f, +0.1635512f, +0.1298424f, -0.2406392f,
  -0.0329336f, +0.0488365f, -0.2549221f, -0.1333146f, -0.2058031f, +0.4371867f, +0.3352515f, +0.2338430f,
  -0.6150581f, +0.1891808f, -0.0842332f, -0.1762387f, -0.6177207f, +0.2994979f, +0.6358072f, -0.5726265f,
  +0.0447213f, +0.1181370f, +0.0397489f, -0.0044496f, -0.0760280f, -0.2243208f, -0.1246637f, -0.0733662f,
  +0.7614787f, +0.2261254f, +0.1880469f, +0.4076338f, +0.0746450f, +0.0195197f, -0.7715290f, -0.2751985f,
  +0.3068043f, +0.7513323f, +0.1462435f, +0.1582078f, +0.3950109f, -0.3318866f, +0.3598221f, +0.2792188f,
  -0.1737412f, -0.0286803f, +0.3383284f, -0.2494601f, -0.0763802f, -0.3355992f, -0.3009279f, -0.3770828f,
  +0.1780460f, +0.2375713f, +0.1047947f, +0.0501569f, +0.2025148f, -0.3238229f, -0.1256421f, -0.1964845f,
  -0.0973071f, +0.0732697f, -0.1638470f, +0.1023903f, +0.1827461f, -0.0395657f, +0.0320581f, +0.1149446f,
  +0.0058866f, -0.0776146f, -0.1352119f, -0.0076517f, -0.1152540f, -0.1035465f, -0.0058332f, -0.0160854f,
  -0.2863814f, -0.2090439f, -0.0020544f, -0.0218655f, +0.0511629f, -0.0770553f, +0.0264906f, -0.0424106f,
  +0.0126028f, +0.0717546f, +0.1608547f, +0.0208460f, +0.2436033f, +0.1121246f, -0.0269294f, +0.0706463f,
  +0.0994478f, -0.0609380f, +0.3426889f, +0.0785283f, +0.1376631f, +0.2405442f, +0.5444521f, +0.1340816f,
  +0.0221417f, -0.2563902f, -0.0420961f, -0.0815148f, +0.1457410f, -0.2906938f, +0.3516447f, +0.0522713f,
  -0.0687179f, -0.1305905f, +0.0839896f, +0.0578085f, -0.1885654f, +0.1671138f, -0.0245813f, +0.0200332f,
  -0.2592997f, -0.2050629f, -0.5788076f, +0.0344160f, -0.2152364f, -0.2253394f, +0.4286475f, +0.0767478f,
  +0.1871723f, -0.3495333f, +0.0580710f, -0.2821287f, -0.3046736f, +0.2572829f, +0.2570550f, -0.0256190f,
  -0.1581432f, -0.0872715f, +0.0533804f, -0.0508108f, +0.1305934f, +0.1464145f, -0.1504189f, -0.4320672f,
  +0.1968279f, +0.4364621f, -0.0967124f, +0.0102054f, +0.0237525f, +0.2700285f, -0.0233940f, +0.1977077f,
  +0.1202609f, +0.2693770f, +0.0956691f, -0.1741383f, +0.1113487f, +0.1213160f, +0.0141685f, -0.2379815f,
  -0.2679559f, -0.1767455f, +0.1534273f, -0.0143948f, -0.2778276f, +0.2841684f, +0.0157878f, +0.0558296f
);

const float biases[4] = float[4](
  -0.0399947f, -0.0897270f, -0.0017159f, +0.0857656f
);

vec4 hook() {
    const vec4 r[9][2] = vec4[9][2](
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 1.0f)))
    );

    float sum[4] = biases;
    for (int n = 0; n < 4; n++) {
        for (int i = 0; i < 9; i++) {
            const vec4 k0 = vec4(kernels[n * 8 * 9 + 8 * i + 0], kernels[n * 8 * 9 + 8 * i + 1], kernels[n * 8 * 9 + 8 * i + 2], kernels[n * 8 * 9 + 8 * i + 3]);
            const vec4 k1 = vec4(kernels[n * 8 * 9 + 8 * i + 4], kernels[n * 8 * 9 + 8 * i + 5], kernels[n * 8 * 9 + 8 * i + 6], kernels[n * 8 * 9 + 8 * i + 7]);
            sum[n] += (dot(k0, r[i][0]) + dot(k1, r[i][1]));
        }
    }

    return ACTIVE(vec4(sum[0], sum[1], sum[2], sum[3]));
}

//!HOOK LUMA
//!DESC ARNet b16 Layer16 L0
//!WHEN OUTPUT.w LUMA.w / 1.2 > OUTPUT.h LUMA.h / 1.2 > *
//!BIND TMP1_L0
//!BIND TMP1_L1
//!BIND TMP2_L0
//!SAVE TMP2_L0
//!COMPONENTS 4

#define ACTIVE(v) (v)

#define TEX_BIND_L0_TEXOFF TMP1_L0_texOff
#define TEX_BIND_L0_TEX TMP1_L0_tex
#define TEX_BIND_L0_POS TMP1_L0_pos
#define TEX_BIND_L0_SIZE TMP1_L0_size
#define TEX_BIND_L0_PT TMP1_L0_pt

#define TEX_BIND_L1_TEXOFF TMP1_L1_texOff
#define TEX_BIND_L1_TEX TMP1_L1_tex
#define TEX_BIND_L1_POS TMP1_L1_pos
#define TEX_BIND_L1_SIZE TMP1_L1_size
#define TEX_BIND_L1_PT TMP1_L1_pt

#define TEX_BIND_L2_TEXOFF TMP2_L0_texOff
#define TEX_BIND_L2_TEX TMP2_L0_tex
#define TEX_BIND_L2_POS TMP2_L0_pos
#define TEX_BIND_L2_SIZE TMP2_L0_size
#define TEX_BIND_L2_PT TMP2_L0_pt

const float kernels[288] = float[288](
  -0.1680032f, -0.0806882f, +0.0193862f, -0.3428153f, -0.0002043f, +0.0849278f, -0.0279356f, +0.0785351f,
  -0.1254242f, +0.0375323f, +0.1086668f, -0.1901484f, -0.2730461f, -0.1595125f, +0.0114392f, +0.0108161f,
  +0.0765907f, -0.1811065f, -0.0413334f, -0.1298553f, +0.1761322f, -0.1922089f, -0.0077251f, +0.1603269f,
  +0.3568440f, -0.2256740f, -0.4325801f, -0.1536045f, -0.0790368f, +0.1313764f, +0.1535200f, -0.0551404f,
  -0.2041463f, +0.1698808f, -0.3694027f, -0.2269317f, -0.5279060f, +0.4546579f, -0.3639039f, -0.3339922f,
  +0.3892131f, -0.1964246f, +0.2043901f, +0.3262264f, +0.1502546f, -0.1334664f, -0.3147630f, -0.1326800f,
  -0.0986870f, -0.2656163f, -0.1725574f, +0.1715600f, +0.0192291f, -0.0438326f, -0.1438488f, +0.0446169f,
  -0.5993094f, +0.1882825f, -0.4041410f, +0.2024080f, -0.0518254f, -0.4617087f, -0.2660540f, -0.0257061f,
  -0.2832710f, +0.0571756f, -0.3827406f, +0.2514217f, -0.1511694f, +0.0990267f, -0.1514157f, -0.1538896f,
  +0.0041029f, +0.1479965f, +0.1059387f, -0.3565172f, +0.3607300f, -0.3659653f, +0.0998276f, +0.1602244f,
  +0.0371779f, +0.5556501f, -0.1672826f, +0.0885426f, +0.3648183f, -0.0792291f, +0.1654842f, +0.1245756f,
  -0.7772492f, +0.0440069f, +0.0210788f, -0.3769097f, -0.0296722f, -0.1480298f, +0.1599505f, -0.1665318f,
  -0.1384678f, -0.0164538f, +0.2105484f, -0.1401998f, -0.3284586f, -0.2045432f, +0.2740295f, -0.0470910f,
  +0.1017873f, +0.2316348f, +0.2948276f, -0.0423931f, +0.2324795f, +0.3968677f, +0.0119319f, +0.6555247f,
  -1.1206394f, -0.1122157f, -0.1610578f, -0.2857026f, -0.1103805f, +0.0687362f, +0.1097805f, -0.0655312f,
  -0.3089674f, +0.0701984f, -0.0459167f, -0.0742395f, +0.0738223f, -0.0958277f, +0.2015538f, +0.1495563f,
  -0.7321630f, -0.0269966f, +0.0259302f, +0.0545110f, -0.0525307f, +0.1318410f, -0.1311484f, +0.2734848f,
  +0.0384034f, -0.0235353f, +0.0986475f, -0.2378514f, +0.1742585f, -0.0970487f, +0.0111879f, +0.0675961f,
  -0.2432526f, +0.1550598f, +0.2796732f, +0.0295576f, +0.6559432f, -0.5525649f, +0.0608960f, +0.1279660f,
  -0.2704844f, +0.0564332f, +0.1294780f, +0.1713328f, -0.1843173f, +0.0567921f, -0.0137469f, +0.0557274f,
  -0.4521813f, -0.1611186f, +0.1460065f, +0.3466202f, +0.2267203f, -0.2880839f, +0.0190404f, +0.3038368f,
  -0.0625212f, +0.0979591f, -0.0064316f, -0.0947393f, -0.2309483f, -0.8701534f, -0.2111422f, -0.0684248f,
  +0.3206161f, +0.2667758f, -0.3356256f, -0.2486169f, -0.6014585f, +0.3018280f, -0.0826193f, -0.1120407f,
  -0.1708360f, +0.0868705f, +0.2213828f, -0.0273694f, +0.1618411f, +0.1591310f, -0.4874533f, +0.4279106f,
  -0.1421234f, -0.1926075f, -0.2206271f, -0.4671319f, -0.3403243f, -0.7013176f, -0.5262588f, +0.0014174f,
  -0.0027155f, +0.2011151f, +0.8298097f, -0.1467195f, +0.0696836f, +0.6401297f, -0.3566594f, +0.0564736f,
  -0.4659120f, +0.0899628f, +0.4404232f, +0.0247015f, -0.0855061f, +0.2469801f, -0.2633498f, +0.1959181f,
  -0.2710421f, +0.0057335f, -0.1276693f, -0.0149209f, +0.1270275f, +0.1012334f, -0.1292752f, +0.2175050f,
  +0.0791329f, +0.1927610f, +0.3195207f, +0.2768406f, +0.0921041f, +0.3380904f, +0.0636360f, +0.0297101f,
  -0.1272107f, -0.1129724f, +0.0839552f, -0.1384007f, -0.1723596f, -0.2276836f, -0.1267281f, -0.0578076f,
  -0.0060078f, -0.0378582f, +0.1109138f, -0.0730277f, +0.1986686f, +0.2248331f, +0.0268769f, +0.1351776f,
  +0.4546663f, +0.3272204f, -0.0247082f, +0.1934406f, +0.3054264f, +0.0116959f, -0.0354630f, +0.3343461f,
  +0.5176369f, -0.3348238f, +0.0568322f, +0.0713259f, -0.3378535f, +0.3873048f, +0.0022697f, +0.6513277f,
  -0.1787551f, +0.1340717f, +0.2118502f, -0.0819480f, +0.0961336f, +0.0882419f, +0.1299091f, +0.0604749f,
  +0.7406219f, +0.1584800f, +0.6729808f, +0.2493232f, -0.0209625f, -0.2625157f, +0.1295961f, +0.0668917f,
  +0.4376687f, -0.0142575f, +0.3862138f, -0.2576691f, +0.1583229f, -0.0925515f, +0.0614893f, +0.0200783f
);

const float biases[4] = float[4](
  -0.0859664f, -0.1336676f, +0.0342493f, -0.1288197f
);

vec4 hook() {
    const vec4 r[9][2] = vec4[9][2](
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 1.0f)))
    );

    float sum[4] = biases;
    for (int n = 0; n < 4; n++) {
        for (int i = 0; i < 9; i++) {
            const vec4 k0 = vec4(kernels[n * 8 * 9 + 8 * i + 0], kernels[n * 8 * 9 + 8 * i + 1], kernels[n * 8 * 9 + 8 * i + 2], kernels[n * 8 * 9 + 8 * i + 3]);
            const vec4 k1 = vec4(kernels[n * 8 * 9 + 8 * i + 4], kernels[n * 8 * 9 + 8 * i + 5], kernels[n * 8 * 9 + 8 * i + 6], kernels[n * 8 * 9 + 8 * i + 7]);
            sum[n] += (dot(k0, r[i][0]) + dot(k1, r[i][1]));
        }
    }

    return ACTIVE(vec4(sum[0], sum[1], sum[2], sum[3]) * 0.2000000f + TEX_BIND_L2_TEXOFF(vec2(0.0f, 0.0f)));
}

//!HOOK LUMA
//!DESC ARNet b16 Layer16 L1
//!WHEN OUTPUT.w LUMA.w / 1.2 > OUTPUT.h LUMA.h / 1.2 > *
//!BIND TMP1_L0
//!BIND TMP1_L1
//!BIND TMP2_L1
//!SAVE TMP2_L1
//!COMPONENTS 4

#define ACTIVE(v) (v)

#define TEX_BIND_L0_TEXOFF TMP1_L0_texOff
#define TEX_BIND_L0_TEX TMP1_L0_tex
#define TEX_BIND_L0_POS TMP1_L0_pos
#define TEX_BIND_L0_SIZE TMP1_L0_size
#define TEX_BIND_L0_PT TMP1_L0_pt

#define TEX_BIND_L1_TEXOFF TMP1_L1_texOff
#define TEX_BIND_L1_TEX TMP1_L1_tex
#define TEX_BIND_L1_POS TMP1_L1_pos
#define TEX_BIND_L1_SIZE TMP1_L1_size
#define TEX_BIND_L1_PT TMP1_L1_pt

#define TEX_BIND_L2_TEXOFF TMP2_L1_texOff
#define TEX_BIND_L2_TEX TMP2_L1_tex
#define TEX_BIND_L2_POS TMP2_L1_pos
#define TEX_BIND_L2_SIZE TMP2_L1_size
#define TEX_BIND_L2_PT TMP2_L1_pt

const float kernels[288] = float[288](
  +0.0820508f, +0.1471342f, -0.0378665f, -0.2887912f, +0.1470720f, -0.0670796f, -0.1266108f, -0.1354039f,
  +0.1221893f, +0.2674251f, -0.1392984f, -0.0157959f, +0.2457375f, -0.1047205f, +0.3034658f, -0.1029543f,
  +0.7530658f, +0.2766362f, -0.0512189f, -0.0180998f, -0.1734858f, -0.2375306f, +0.1865163f, -0.0399069f,
  +0.0077605f, -0.4092776f, +0.2097162f, -0.1391758f, +0.1605077f, -0.0321690f, +0.1196862f, -0.1908237f,
  -0.1051510f, -0.0563017f, +0.4501581f, -0.1019607f, +0.4657682f, -0.2990888f, +0.2198309f, -0.1322933f,
  +0.7455748f, -0.1322188f, -0.0043002f, +0.1911281f, +0.2527265f, -0.0706328f, -0.0022263f, -0.0867433f,
  +0.0561550f, -0.0669213f, +0.3472824f, +0.0197777f, +0.2308436f, -0.0350651f, -0.1765574f, +0.0156667f,
  -0.3027262f, +0.1157246f, +0.0350173f, -0.1735657f, -0.0277395f, -0.4632088f, -0.0677315f, +0.0348712f,
  +0.2033828f, -0.1064903f, -0.1206975f, -0.3352656f, +0.1123465f, +0.0678608f, -0.3517728f, -0.1370342f,
  +0.3336178f, +0.0102190f, -0.0009372f, +0.0236109f, -0.0593821f, -0.4613707f, -0.0409420f, +0.0237677f,
  +0.0835376f, +0.0540883f, -0.1108225f, -0.0176474f, -0.0283222f, -0.3237280f, -0.0213148f, +0.0553735f,
  +0.4159162f, +0.1340810f, -0.0316758f, +0.0761559f, -0.1564962f, +0.1315400f, +0.1466134f, -0.0665141f,
  +0.1600177f, -0.0724604f, +0.1242074f, +0.1231239f, -0.4787909f, -0.3882550f, +0.0860786f, -0.0686966f,
  -0.2768825f, +0.0834795f, +0.0864313f, +0.1914096f, -0.0627487f, -0.5329657f, +0.1358415f, +0.0521131f,
  +0.3588741f, +0.1619380f, +0.1521297f, +0.1450909f, -0.3409535f, +0.1446990f, +0.1192970f, +0.0270084f,
  -0.1333854f, +0.0938957f, -0.3301299f, -0.1621222f, -0.2182186f, -0.0660299f, -0.0108673f, -0.0132814f,
  -0.5364275f, +0.1052797f, -0.5154930f, +0.2057204f, -0.2232295f, -0.0813058f, -0.1711505f, -0.0200783f,
  +0.2833650f, +0.1106510f, -0.2813740f, -0.0422421f, -0.1944745f, -0.0568016f, +0.0316377f, -0.1189136f,
  -0.0153428f, -0.0512691f, +0.0962715f, +0.0472556f, +0.4366921f, -0.1982393f, -0.0415778f, +0.0552053f,
  -0.7317479f, +0.0564821f, -0.0900225f, -0.3715768f, +0.2317951f, +0.3847603f, +0.0419613f, -0.0621673f,
  -0.7223944f, +0.0800375f, -0.0428258f, +0.1574682f, +0.1675936f, +0.0581124f, +0.0687928f, +0.0577993f,
  -0.0012983f, -0.3651868f, -0.2072038f, +0.1038747f, -0.1817461f, +0.0381980f, -0.2402068f, +0.1362878f,
  -0.5859588f, +0.2491290f, +0.3758747f, -0.0793768f, +0.2889929f, +0.3759967f, +0.1575177f, -0.5842358f,
  -1.1928681f, +0.0277456f, +0.0110826f, +0.0594225f, -0.0649415f, +0.0190515f, +0.5507612f, -0.2771357f,
  +0.0165390f, -0.1005728f, -0.1507948f, -0.1972072f, -0.2439125f, +0.2619231f, -0.6356403f, -0.1727185f,
  -0.3295806f, +0.1581365f, -0.5373387f, +0.0799717f, -0.2086677f, +0.3066291f, +0.5309596f, -0.3175365f,
  +0.2241273f, +0.1674318f, +0.1763107f, +0.2255637f, +0.0903555f, +0.1145004f, +0.3609537f, -0.2203773f,
  +0.0673777f, -0.0565548f, -0.2419312f, +0.1860518f, -0.1611503f, +0.0744826f, -0.0027077f, +0.1897314f,
  +0.1292827f, +0.0198949f, -0.1217065f, -0.0591389f, -0.2456511f, +0.3879564f, +0.0431926f, +0.1510234f,
  +0.1680833f, +0.1395011f, +0.0515024f, +0.1190940f, -0.2572078f, +0.1661730f, +0.1198026f, -0.0123337f,
  -0.0196523f, -0.0010119f, -0.0168164f, -0.0377720f, -0.0791410f, -0.2074767f, +0.1302982f, -0.0145673f,
  +0.2245915f, -0.0269800f, +0.2290091f, -0.2658749f, +0.1955943f, +0.2400135f, -0.0894553f, +0.1274398f,
  -1.1115699f, +0.1400840f, -0.1996282f, -0.1013961f, -0.1771851f, -0.2086075f, +0.0112262f, +0.2226434f,
  -0.0158372f, +0.2104971f, -0.3271146f, +0.2648714f, -0.1748402f, -0.0152146f, -0.0899861f, -0.0078707f,
  -0.1474959f, +0.2533056f, -0.1398688f, +0.2405526f, -0.0740691f, -0.1568687f, +0.1836616f, -0.1074138f,
  -0.1316695f, -0.3240687f, +0.0710085f, -0.1279498f, +0.2025686f, +0.0860504f, -0.0760830f, +0.0333902f
);

const float biases[4] = float[4](
  -0.0789740f, -0.0341020f, -0.1729293f, +0.0545820f
);

vec4 hook() {
    const vec4 r[9][2] = vec4[9][2](
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 1.0f)))
    );

    float sum[4] = biases;
    for (int n = 0; n < 4; n++) {
        for (int i = 0; i < 9; i++) {
            const vec4 k0 = vec4(kernels[n * 8 * 9 + 8 * i + 0], kernels[n * 8 * 9 + 8 * i + 1], kernels[n * 8 * 9 + 8 * i + 2], kernels[n * 8 * 9 + 8 * i + 3]);
            const vec4 k1 = vec4(kernels[n * 8 * 9 + 8 * i + 4], kernels[n * 8 * 9 + 8 * i + 5], kernels[n * 8 * 9 + 8 * i + 6], kernels[n * 8 * 9 + 8 * i + 7]);
            sum[n] += (dot(k0, r[i][0]) + dot(k1, r[i][1]));
        }
    }

    return ACTIVE(vec4(sum[0], sum[1], sum[2], sum[3]) * 0.2000000f + TEX_BIND_L2_TEXOFF(vec2(0.0f, 0.0f)));
}

//!HOOK LUMA
//!DESC ARNet b16 Layer17 L0
//!WHEN OUTPUT.w LUMA.w / 1.2 > OUTPUT.h LUMA.h / 1.2 > *
//!BIND TMP2_L0
//!BIND TMP2_L1
//!SAVE TMP1_L0
//!COMPONENTS 4

#define ACTIVE(v) (max(v, v * 0.2000000f))

#define TEX_BIND_L0_TEXOFF TMP2_L0_texOff
#define TEX_BIND_L0_TEX TMP2_L0_tex
#define TEX_BIND_L0_POS TMP2_L0_pos
#define TEX_BIND_L0_SIZE TMP2_L0_size
#define TEX_BIND_L0_PT TMP2_L0_pt

#define TEX_BIND_L1_TEXOFF TMP2_L1_texOff
#define TEX_BIND_L1_TEX TMP2_L1_tex
#define TEX_BIND_L1_POS TMP2_L1_pos
#define TEX_BIND_L1_SIZE TMP2_L1_size
#define TEX_BIND_L1_PT TMP2_L1_pt

const float kernels[288] = float[288](
  -0.0674220f, +0.0035723f, +0.0187714f, -0.0450716f, -0.1091359f, +0.1354263f, -0.1899049f, -0.4277302f,
  +0.2638785f, -0.3916823f, +0.3820193f, -0.3585659f, +0.0129518f, +0.2336775f, +0.5029643f, +0.1297325f,
  -0.0178240f, -0.3323328f, -0.2597254f, -0.2892321f, -0.2701703f, +0.0964669f, +0.0349920f, -0.0446304f,
  +0.4014493f, +0.0364476f, +0.0190260f, -0.3854376f, -0.2809640f, -0.0608085f, -0.3375797f, -0.3441686f,
  -0.0776388f, -0.2553051f, +0.8724335f, +0.1842041f, -0.4808923f, -0.0480798f, -0.2094910f, +0.1271425f,
  +0.4358284f, +0.1631735f, -0.3172795f, +0.4644891f, +0.3177470f, -0.0017206f, -0.1514377f, +0.2024202f,
  +0.3045619f, -0.1825856f, +0.2051413f, -0.0260357f, +0.0384558f, +0.1848861f, -0.3895993f, +0.1013486f,
  -0.1459097f, -0.3574277f, -0.0458106f, +0.0443117f, +0.2290903f, -0.1249363f, +0.0629633f, +0.1357001f,
  -0.1793981f, +0.1458152f, -0.5076433f, +0.0424166f, +0.0100154f, -0.2633398f, -0.2250375f, +0.0354275f,
  +0.0222508f, -0.0918975f, -0.1050968f, +0.0738690f, +0.0443862f, -0.2521093f, +0.4814881f, +0.1817249f,
  -0.2792471f, -0.1443224f, -0.3884432f, +0.0348124f, -0.0125270f, +0.2281755f, -0.2081419f, -0.3069983f,
  -0.2842308f, +0.1842057f, -0.1139611f, -0.1261384f, +0.1391058f, +0.3892317f, -0.1564627f, -0.1533198f,
  -0.2356124f, +0.1905038f, -0.2822382f, +0.5709882f, -0.1300281f, +0.2479183f, +0.5572698f, +0.4595679f,
  +0.2532868f, +0.0007084f, +0.6452466f, +0.5661091f, -0.4224117f, +0.4542980f, -0.4892668f, -0.5604776f,
  +0.0178694f, -0.0534489f, -0.4176284f, +0.4424709f, +0.6402146f, +0.3152714f, -0.1028995f, -0.5824665f,
  -0.3008254f, -0.0594004f, -0.1391081f, +0.0771419f, -0.0215495f, +0.2411200f, +0.2241739f, +0.2411016f,
  -0.3039791f, -0.0045869f, +0.0760059f, +0.0441084f, +0.0389391f, -0.0992556f, +0.5570757f, -0.0961677f,
  -0.2391383f, +0.3161026f, -0.2363172f, -0.0543467f, +0.3580218f, +0.1489483f, +0.2318625f, -0.2352576f,
  -0.0913065f, +0.0155026f, +0.2612857f, +0.0939210f, +0.1145777f, +0.0275436f, +0.0190797f, -0.1063809f,
  +0.1398554f, -0.1863161f, +0.4385844f, +0.1002137f, +0.2071852f, -0.4130614f, +0.1043338f, +0.2076983f,
  -0.0117661f, -0.5450177f, +0.3147680f, +0.4468916f, -0.2300414f, -0.2525474f, +0.2479627f, +0.1008875f,
  -0.0228487f, -0.1030626f, -0.1285076f, -0.1357391f, +0.0228878f, +0.1805006f, +0.1993326f, -0.0661708f,
  +0.1008950f, +0.1262205f, +0.5873798f, -0.4118234f, -0.0879480f, +0.0488317f, +0.4081076f, +0.3761216f,
  +0.3181759f, +0.0955133f, +0.2297484f, +0.0553777f, -0.3354177f, -0.3587246f, -0.4083520f, +0.0521084f,
  +0.0344114f, +0.1112705f, +0.1881240f, +0.0520432f, +0.1989788f, -0.1044436f, -0.3825556f, +0.0061093f,
  +0.3612897f, -0.1618724f, +0.1044036f, -0.2679520f, -0.2893356f, -0.2146779f, -0.1031353f, -0.4033220f,
  -0.1110832f, -0.1378665f, +0.2200589f, -0.1253759f, -0.0424361f, +0.0936147f, -0.2341887f, +0.1434285f,
  -0.0680938f, -0.0150016f, -0.1873868f, +0.0703527f, -0.0631601f, -0.0022070f, +0.2123064f, +0.0672729f,
  -0.0566810f, -0.3130868f, -0.3845420f, -0.2986307f, +0.1979480f, +0.1698180f, +0.1858201f, +0.0593007f,
  +0.0990206f, -0.1738600f, +0.3728075f, -0.0157562f, -0.3546834f, +0.1079223f, +0.0535201f, +0.0841293f,
  -0.1702149f, +0.2699880f, -0.2806212f, +0.0850344f, -0.1248907f, +0.1101382f, +0.3227904f, +0.3759734f,
  -0.5246293f, +0.0762736f, -0.0434147f, +0.1319508f, -0.0121961f, -0.0489595f, -0.2818857f, -0.2958052f,
  -0.1289077f, +0.1735831f, +0.2911347f, -0.0612709f, +0.0415496f, +0.0005714f, -0.2704472f, -0.3682109f,
  -0.0417136f, +0.1725542f, -0.1876469f, +0.2344454f, -0.0735235f, +0.2197248f, +0.3724523f, +0.3523563f,
  -0.3660271f, +0.3214290f, -0.4211611f, -0.0286015f, +0.3499995f, -0.0748265f, -0.2034972f, +0.0073126f,
  +0.1232724f, +0.1494488f, +0.0846191f, +0.2641415f, +0.0473105f, -0.2793745f, +0.1732855f, -0.1401873f
);

const float biases[4] = float[4](
  +0.0105691f, -0.2776823f, +0.0294132f, +0.0453184f
);

vec4 hook() {
    const vec4 r[9][2] = vec4[9][2](
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 1.0f)))
    );

    float sum[4] = biases;
    for (int n = 0; n < 4; n++) {
        for (int i = 0; i < 9; i++) {
            const vec4 k0 = vec4(kernels[n * 8 * 9 + 8 * i + 0], kernels[n * 8 * 9 + 8 * i + 1], kernels[n * 8 * 9 + 8 * i + 2], kernels[n * 8 * 9 + 8 * i + 3]);
            const vec4 k1 = vec4(kernels[n * 8 * 9 + 8 * i + 4], kernels[n * 8 * 9 + 8 * i + 5], kernels[n * 8 * 9 + 8 * i + 6], kernels[n * 8 * 9 + 8 * i + 7]);
            sum[n] += (dot(k0, r[i][0]) + dot(k1, r[i][1]));
        }
    }

    return ACTIVE(vec4(sum[0], sum[1], sum[2], sum[3]));
}

//!HOOK LUMA
//!DESC ARNet b16 Layer17 L1
//!WHEN OUTPUT.w LUMA.w / 1.2 > OUTPUT.h LUMA.h / 1.2 > *
//!BIND TMP2_L0
//!BIND TMP2_L1
//!SAVE TMP1_L1
//!COMPONENTS 4

#define ACTIVE(v) (max(v, v * 0.2000000f))

#define TEX_BIND_L0_TEXOFF TMP2_L0_texOff
#define TEX_BIND_L0_TEX TMP2_L0_tex
#define TEX_BIND_L0_POS TMP2_L0_pos
#define TEX_BIND_L0_SIZE TMP2_L0_size
#define TEX_BIND_L0_PT TMP2_L0_pt

#define TEX_BIND_L1_TEXOFF TMP2_L1_texOff
#define TEX_BIND_L1_TEX TMP2_L1_tex
#define TEX_BIND_L1_POS TMP2_L1_pos
#define TEX_BIND_L1_SIZE TMP2_L1_size
#define TEX_BIND_L1_PT TMP2_L1_pt

const float kernels[288] = float[288](
  +0.2540919f, +0.0615992f, +0.0206365f, +0.0258614f, -0.0278016f, +0.0455239f, -0.0015849f, -0.0517151f,
  +0.3992600f, -0.3610296f, -0.1983186f, -0.0699840f, +0.1496396f, +0.7940878f, -0.0706926f, -0.3694428f,
  +0.2115933f, -0.0593313f, -0.1260603f, +0.0390669f, +0.0769503f, +0.2477250f, +0.0135148f, -0.1776735f,
  +0.1040710f, -0.2592387f, +0.4235467f, -0.2339393f, +0.3011625f, +0.2232401f, -0.1053094f, -0.2551082f,
  +0.3736948f, -0.8091941f, -0.1212105f, -0.2501189f, +0.0129770f, -0.0644497f, +0.4624046f, +0.0310691f,
  +0.2663518f, -0.0325522f, +0.0054497f, +0.1537983f, -0.3383894f, -0.2226847f, +0.0156422f, +0.2882063f,
  -0.0087508f, +0.1026356f, +0.1054673f, -0.1436826f, +0.0261698f, +0.1600106f, -0.2288703f, +0.0357868f,
  +0.0758032f, +0.2417121f, -0.3321431f, -0.5116575f, -0.2339659f, -0.1752665f, -0.2188110f, +0.4302197f,
  -0.1901901f, -0.1780317f, -0.2164041f, -0.2681935f, -0.4744498f, -0.2868285f, -0.4865484f, +0.1738587f,
  -0.1882973f, +0.1092305f, -0.3145058f, -0.4823339f, +0.1970551f, -0.0573421f, +0.2923736f, -0.1316863f,
  +0.1573266f, -0.3817531f, +0.0778192f, +0.0774975f, -0.1064251f, +0.2186236f, -0.1676261f, -0.3245335f,
  +0.0466466f, +0.1873265f, -0.0131856f, +0.0748941f, +0.0258800f, -0.1709557f, -0.0447501f, +0.1443627f,
  -0.1516479f, -0.4464977f, -0.1884977f, +0.1807011f, -0.1294860f, +0.0216370f, +0.3071847f, -0.1321091f,
  +0.1371096f, -0.8681047f, -0.1823466f, -0.0527832f, +0.3064470f, +0.0803991f, +0.1045253f, +0.2608671f,
  +0.0030087f, +0.0654686f, -0.1950669f, +0.1143900f, -0.4535372f, -0.1410163f, -0.1968051f, -0.1200158f,
  -0.2422954f, +0.3429454f, +0.0227766f, -0.3159835f, +0.3993573f, +0.0672468f, -0.1981937f, +0.0332329f,
  +0.3287041f, +0.5777367f, +0.1085701f, -0.0244356f, +0.2106449f, -0.0003621f, +0.0244395f, +0.2959219f,
  +0.2905703f, +0.3643697f, -0.3014731f, -0.0547484f, -0.1154651f, -0.0779613f, +0.0102780f, +0.1797045f,
  -0.0963764f, -0.0359088f, -0.2720920f, -0.2834784f, -0.0945818f, +0.0334672f, -0.1275918f, -0.0325017f,
  -0.1727519f, -0.6795470f, -0.1027750f, +0.0411315f, -0.0459480f, +0.2035760f, +0.2454858f, -0.4102059f,
  +0.0871825f, -0.2945240f, +0.1286035f, +0.1031291f, -0.1242958f, +0.0113954f, -0.0768885f, +0.0347769f,
  +0.1245261f, +0.1332746f, +0.2912717f, -0.3339754f, +0.2991895f, -0.3849046f, -0.1360728f, +0.1515394f,
  +0.0484371f, -0.2561954f, -0.7527201f, +0.0154726f, +0.3348646f, +0.0954231f, -0.5795618f, -0.0492020f,
  -0.1891159f, -0.1904110f, -0.0585752f, +0.1825156f, -0.2951412f, +0.1009915f, +0.1955998f, +0.0082819f,
  -0.0610109f, +0.6279034f, +0.0774255f, -0.0889417f, +0.0364916f, -0.3953165f, +0.1667855f, -0.0750481f,
  -0.1482651f, +0.3020416f, +0.2594504f, +0.1199247f, +0.3269099f, -0.0046020f, -0.1579530f, -0.3650357f,
  +0.2145464f, -0.0120269f, +0.4145732f, +0.2786247f, +0.1279835f, -0.1779720f, -0.0698417f, -0.3125440f,
  -0.0679421f, +0.1310805f, +0.3751942f, -0.2137376f, -0.0960237f, -0.0773771f, -0.1455518f, -0.2182551f,
  -0.0976918f, +0.1160521f, +0.0715464f, -0.0334714f, +0.2226011f, -0.0534059f, +0.1773681f, +0.3993958f,
  -0.1977543f, -0.2893223f, -0.4008239f, +0.1160676f, -0.2381665f, -0.2271517f, +0.2901198f, +0.1299915f,
  +0.2564992f, +0.3094306f, +0.3228386f, -0.0851916f, +0.1990248f, +0.3837307f, -0.6687825f, -0.0855050f,
  -0.1848602f, -0.6297835f, +0.6080527f, +0.0526762f, +0.0086315f, +0.3495751f, +1.1367058f, +0.7282122f,
  -0.2361649f, +0.0346549f, -0.6061047f, +0.2039357f, -0.3485473f, -0.2303642f, -0.1864752f, -0.2113673f,
  +0.1618880f, +0.2572433f, +0.5381857f, +0.0196241f, +0.2356181f, -0.1118896f, -0.4339306f, -0.1568564f,
  +0.2560685f, -0.2843515f, +0.2114817f, +0.0948582f, -0.0547584f, +0.0135971f, +0.1736674f, +0.1447359f,
  -0.2427363f, +0.2127496f, -0.0956267f, +0.1943456f, -0.0643314f, +0.0095602f, +0.1687107f, -0.1909220f
);

const float biases[4] = float[4](
  +0.0258393f, +0.0629831f, +0.0235072f, -0.0568523f
);

vec4 hook() {
    const vec4 r[9][2] = vec4[9][2](
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 1.0f)))
    );

    float sum[4] = biases;
    for (int n = 0; n < 4; n++) {
        for (int i = 0; i < 9; i++) {
            const vec4 k0 = vec4(kernels[n * 8 * 9 + 8 * i + 0], kernels[n * 8 * 9 + 8 * i + 1], kernels[n * 8 * 9 + 8 * i + 2], kernels[n * 8 * 9 + 8 * i + 3]);
            const vec4 k1 = vec4(kernels[n * 8 * 9 + 8 * i + 4], kernels[n * 8 * 9 + 8 * i + 5], kernels[n * 8 * 9 + 8 * i + 6], kernels[n * 8 * 9 + 8 * i + 7]);
            sum[n] += (dot(k0, r[i][0]) + dot(k1, r[i][1]));
        }
    }

    return ACTIVE(vec4(sum[0], sum[1], sum[2], sum[3]));
}

//!HOOK LUMA
//!DESC ARNet b16 Layer18 L0
//!WHEN OUTPUT.w LUMA.w / 1.2 > OUTPUT.h LUMA.h / 1.2 > *
//!BIND TMP1_L0
//!BIND TMP1_L1
//!BIND TMP2_L0
//!SAVE TMP2_L0
//!COMPONENTS 4

#define ACTIVE(v) (v)

#define TEX_BIND_L0_TEXOFF TMP1_L0_texOff
#define TEX_BIND_L0_TEX TMP1_L0_tex
#define TEX_BIND_L0_POS TMP1_L0_pos
#define TEX_BIND_L0_SIZE TMP1_L0_size
#define TEX_BIND_L0_PT TMP1_L0_pt

#define TEX_BIND_L1_TEXOFF TMP1_L1_texOff
#define TEX_BIND_L1_TEX TMP1_L1_tex
#define TEX_BIND_L1_POS TMP1_L1_pos
#define TEX_BIND_L1_SIZE TMP1_L1_size
#define TEX_BIND_L1_PT TMP1_L1_pt

#define TEX_BIND_L2_TEXOFF TMP2_L0_texOff
#define TEX_BIND_L2_TEX TMP2_L0_tex
#define TEX_BIND_L2_POS TMP2_L0_pos
#define TEX_BIND_L2_SIZE TMP2_L0_size
#define TEX_BIND_L2_PT TMP2_L0_pt

const float kernels[288] = float[288](
  -0.0642257f, +0.1408440f, -0.0606691f, +0.0629899f, +0.3617057f, -0.1698583f, +0.0540210f, -0.0859685f,
  -0.2562275f, +0.0830148f, -0.0995447f, +0.5109779f, +0.0743667f, -0.1413581f, -0.3236741f, -0.1990158f,
  -0.1395002f, +0.0229663f, +0.2436676f, +0.3373329f, +0.0054877f, +0.0530524f, -0.2418046f, +0.0597524f,
  +0.0662696f, +0.0133679f, +0.0826095f, +0.1415676f, +0.2022991f, -0.1534142f, -0.1158622f, -0.1061890f,
  +0.1678787f, +0.4424903f, +0.1200629f, +0.0895623f, -0.1416852f, +0.0714238f, -0.2102499f, -0.1434892f,
  +0.2055239f, +0.1465447f, +0.3030907f, -0.2303388f, -0.2578832f, +0.1202919f, -0.1037537f, -0.1555479f,
  +0.2262088f, +0.0066590f, +0.2325670f, -0.2217240f, +0.1724732f, -0.2525224f, -0.0011668f, -0.1417206f,
  -0.0882632f, +0.1885700f, +0.4000766f, -0.3021824f, -0.1035901f, -0.0279798f, -0.0242559f, +0.0617028f,
  +0.1892086f, -0.0104740f, +0.3395213f, -0.1152004f, -0.2626903f, -0.0280124f, -0.1646666f, +0.0064149f,
  -0.0553666f, -0.3221517f, -0.0517736f, -0.2007264f, +0.2301616f, -0.1735905f, -0.2004517f, -0.0907754f,
  +0.3242398f, +0.1854775f, -0.2430580f, -0.4711484f, +0.1167460f, -0.1612966f, -0.1031992f, +0.4635513f,
  +0.1045845f, +0.1511236f, -0.1251081f, -0.1893419f, +0.1534196f, -0.0032852f, -0.1410154f, -0.0560361f,
  +0.0031942f, +0.3458885f, +0.1197139f, -0.0919744f, +0.1247229f, +0.0981960f, -0.0933829f, +0.1873281f,
  +0.2388526f, -0.2999524f, +0.0800119f, +0.0440243f, +0.7315576f, +0.5508667f, -0.0786652f, +0.5860514f,
  -0.0130030f, +0.1517781f, -0.2827731f, -0.3330424f, +0.0487024f, +0.1612571f, -0.3439940f, -0.0141486f,
  -0.0197435f, -0.0881012f, +0.2513018f, +0.0161598f, -0.2509188f, -0.0583207f, -0.0134319f, -0.1871981f,
  +0.3655003f, +0.2987219f, +0.1196412f, +0.0463453f, +0.1613470f, +0.1256603f, +0.0638662f, -0.0885475f,
  +0.0987914f, +0.1588349f, -0.1508304f, -0.0939021f, -0.3267929f, +0.1859300f, -0.3024530f, -0.1090477f,
  -0.0275395f, -0.2843936f, +0.1259789f, -0.0469638f, -0.2316459f, +0.0399366f, -0.2914521f, -0.2146725f,
  -0.2487467f, -0.2366859f, -0.0252390f, +0.3542966f, +0.2325751f, -0.0608667f, -0.2605167f, -0.2917731f,
  -0.1159373f, -0.0782558f, +0.3058358f, +0.2730810f, +0.1041511f, -0.0715760f, -0.3878468f, +0.2569759f,
  -0.2487154f, +0.0049322f, -0.1742095f, -0.3225649f, -0.5103866f, +0.1286058f, +0.0159387f, -0.2037874f,
  -0.3007769f, -0.9477267f, -0.0281129f, -0.2222984f, +0.1529275f, +0.5398698f, -0.0523311f, -0.3883595f,
  -0.1587525f, +0.0193561f, -0.0931380f, +0.2018472f, -0.1902013f, +0.2064040f, +0.2669618f, +0.3267062f,
  -0.3154976f, -0.4011629f, -0.2809648f, -0.0355177f, +0.0458917f, -0.0914398f, +0.0652636f, -0.0552904f,
  -0.1108672f, +0.2682014f, -0.3753849f, +0.0865304f, +0.1191621f, -0.1591875f, +0.3780842f, +0.2538408f,
  -0.0708237f, -0.2997626f, +0.0401360f, -0.0237262f, -0.0904727f, +0.2244842f, +0.3196139f, +0.0522561f,
  +0.0480609f, -0.1817073f, +0.1128397f, -0.2656496f, -0.0904231f, -0.0578151f, +0.0318704f, +0.0446179f,
  -0.0161981f, -0.1337164f, +0.1294383f, -0.1961588f, -0.1251065f, -0.0981970f, +0.0293231f, -0.0549014f,
  -0.1078154f, -0.1444443f, +0.1591228f, +0.0989870f, -0.1020573f, -0.0057453f, +0.4083755f, +0.2596915f,
  -0.4492301f, -0.2964928f, +0.0956673f, -0.2346381f, -0.3483980f, +0.1289599f, -0.2056585f, -0.0225896f,
  -0.4217820f, -0.7895127f, -0.5287217f, -0.4923331f, -0.4212954f, +0.1425687f, -0.1250449f, -0.1077110f,
  -0.0298131f, -0.1098940f, -0.5774109f, +0.1922842f, -0.1041804f, +0.1553703f, +0.3182769f, +0.0872537f,
  -0.2896571f, +0.0307766f, -0.1135770f, +0.4155474f, +0.0775558f, -0.2743901f, -0.0978573f, -0.2618257f,
  -0.1165120f, -0.1474276f, -0.0083173f, +0.6772060f, +0.0964397f, -0.0512783f, -0.1501981f, +0.1062420f,
  -0.2887865f, +0.1994392f, +0.0476179f, +0.1413561f, +0.1842563f, -0.1505948f, +0.1590394f, -0.0327265f
);

const float biases[4] = float[4](
  +0.0166883f, -0.0686633f, -0.0207061f, -0.0987451f
);

vec4 hook() {
    const vec4 r[9][2] = vec4[9][2](
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 1.0f)))
    );

    float sum[4] = biases;
    for (int n = 0; n < 4; n++) {
        for (int i = 0; i < 9; i++) {
            const vec4 k0 = vec4(kernels[n * 8 * 9 + 8 * i + 0], kernels[n * 8 * 9 + 8 * i + 1], kernels[n * 8 * 9 + 8 * i + 2], kernels[n * 8 * 9 + 8 * i + 3]);
            const vec4 k1 = vec4(kernels[n * 8 * 9 + 8 * i + 4], kernels[n * 8 * 9 + 8 * i + 5], kernels[n * 8 * 9 + 8 * i + 6], kernels[n * 8 * 9 + 8 * i + 7]);
            sum[n] += (dot(k0, r[i][0]) + dot(k1, r[i][1]));
        }
    }

    return ACTIVE(vec4(sum[0], sum[1], sum[2], sum[3]) * 0.2000000f + TEX_BIND_L2_TEXOFF(vec2(0.0f, 0.0f)));
}

//!HOOK LUMA
//!DESC ARNet b16 Layer18 L1
//!WHEN OUTPUT.w LUMA.w / 1.2 > OUTPUT.h LUMA.h / 1.2 > *
//!BIND TMP1_L0
//!BIND TMP1_L1
//!BIND TMP2_L1
//!SAVE TMP2_L1
//!COMPONENTS 4

#define ACTIVE(v) (v)

#define TEX_BIND_L0_TEXOFF TMP1_L0_texOff
#define TEX_BIND_L0_TEX TMP1_L0_tex
#define TEX_BIND_L0_POS TMP1_L0_pos
#define TEX_BIND_L0_SIZE TMP1_L0_size
#define TEX_BIND_L0_PT TMP1_L0_pt

#define TEX_BIND_L1_TEXOFF TMP1_L1_texOff
#define TEX_BIND_L1_TEX TMP1_L1_tex
#define TEX_BIND_L1_POS TMP1_L1_pos
#define TEX_BIND_L1_SIZE TMP1_L1_size
#define TEX_BIND_L1_PT TMP1_L1_pt

#define TEX_BIND_L2_TEXOFF TMP2_L1_texOff
#define TEX_BIND_L2_TEX TMP2_L1_tex
#define TEX_BIND_L2_POS TMP2_L1_pos
#define TEX_BIND_L2_SIZE TMP2_L1_size
#define TEX_BIND_L2_PT TMP2_L1_pt

const float kernels[288] = float[288](
  -0.0580699f, -0.3318332f, +0.1324029f, -0.0723584f, +0.0920951f, -0.2288580f, -0.2986113f, -0.8166835f,
  -0.4928980f, -0.2537371f, -0.0770288f, +0.0670120f, +0.0357992f, -0.4260347f, +0.2067388f, +0.0947118f,
  -0.0192663f, -0.1092038f, -0.1551964f, -0.2927229f, -0.2406929f, -0.0919379f, -0.1413566f, -0.3466004f,
  -0.2848581f, -0.2540993f, +0.0392935f, -0.1352388f, -0.2418345f, +0.5164255f, +0.0691495f, -0.4008144f,
  +0.5257621f, +0.7309721f, -0.0088896f, +0.0848879f, -0.5262472f, -0.1867508f, +0.0900458f, +0.3888231f,
  +0.4549408f, -0.0054818f, +0.4940384f, -0.2287534f, -0.4175491f, +0.4158491f, -0.3606208f, -0.0081356f,
  +0.1597606f, +0.0221468f, +0.0365703f, -0.1190397f, -0.1135521f, +0.3072410f, -0.1681650f, -0.3507016f,
  +0.2334042f, +0.1141608f, +0.0357852f, -0.1559841f, +0.0055456f, +0.1702991f, -0.3169119f, -0.1482865f,
  +0.3849382f, -0.2193645f, +0.0304546f, -0.2908513f, -0.2364852f, +0.2209039f, -0.0318249f, -0.2192561f,
  +0.1044055f, +0.0446627f, +0.1347459f, -0.0916122f, -0.0360136f, +0.0782527f, -0.0302032f, +0.2039891f,
  +0.1922758f, +0.4069013f, +0.1767275f, -0.0033352f, +0.2405884f, -0.0022741f, +0.3154396f, +0.3985154f,
  +0.0470726f, +0.0613010f, +0.0990473f, -0.2599806f, -0.0105573f, -0.0394004f, +0.1122276f, +0.2960974f,
  +0.1274806f, +0.2538438f, +0.1483868f, +0.1063249f, +0.1897409f, +0.0403499f, +0.1223883f, +0.1242939f,
  +0.2760155f, +0.2408075f, -0.0228670f, +0.0118351f, +0.5523455f, +0.2474153f, +0.0619665f, -0.1230280f,
  +0.0020614f, +0.3102599f, -0.3444614f, -0.2728736f, +0.1140906f, +0.0117369f, +0.1129441f, -0.1163677f,
  -0.0014991f, +0.1841291f, +0.1322716f, +0.0088441f, +0.0947059f, +0.0528266f, +0.1701111f, +0.0573554f,
  -0.1860808f, -0.0580467f, -0.2264425f, -0.1309203f, -0.0343082f, +0.0928394f, +0.1801051f, +0.0684348f,
  -0.0193325f, +0.2921776f, -0.1846725f, -0.1714676f, +0.3615201f, +0.0510523f, -0.0737703f, -0.1608369f,
  +0.1119639f, +0.0270756f, +0.0815809f, -0.3253191f, -0.1194969f, +0.2618428f, -0.2353522f, -0.0333897f,
  -0.0936645f, -0.2852182f, -0.2376067f, +0.0935651f, -0.0966687f, +0.0091561f, -0.3319107f, -0.2592881f,
  -0.2905142f, -0.1073706f, -0.0446182f, +0.1606137f, +0.2628700f, -0.0516786f, -0.1134105f, +0.3073908f,
  -0.2773089f, -0.1557795f, +0.1457555f, -0.0148249f, -0.3099073f, +0.2021438f, -0.3435945f, -0.0928501f,
  -0.2428706f, -0.0477564f, -0.0177066f, +0.0022614f, -0.4146129f, +0.1267102f, -0.0610658f, -0.1972451f,
  -0.2025256f, -0.1372911f, -0.2393607f, +0.1329566f, +0.1506986f, -0.4432167f, -0.0370639f, +0.0941006f,
  -0.0783238f, -0.1024238f, -0.1817885f, -0.1081324f, -0.0473872f, +0.0499572f, +0.0120001f, -0.3973952f,
  -0.1245824f, -0.0274234f, -0.0844793f, +0.1530048f, +0.2933793f, -0.1048080f, +0.0615446f, +0.3025786f,
  +0.0394025f, +0.0361223f, +0.2696347f, +0.0010182f, +0.0250198f, -0.3470162f, +0.0541144f, +0.0885832f,
  +0.0864843f, -0.1167989f, -0.1172506f, +0.3842463f, +0.2314458f, -0.4250538f, -0.0703541f, +0.1024543f,
  +0.0998780f, +0.1042224f, +0.3357137f, +0.0780450f, +0.1825691f, -0.2107922f, +0.3392013f, +0.6234534f,
  +0.0469215f, -0.0956533f, -0.1606191f, -0.2374175f, -0.0047449f, -0.1330027f, -0.0608791f, -0.0117177f,
  -0.4844814f, -0.1526695f, -0.1457922f, +0.1357103f, -0.2574697f, -0.1228411f, +0.1420392f, +0.3479288f,
  +0.0811080f, +0.0059913f, +0.5132731f, +0.1202632f, -0.3662884f, -0.0488003f, -0.0150892f, +0.4865168f,
  +0.2016109f, -0.1314432f, +0.0584753f, -0.2107657f, -0.1898817f, -0.1350249f, +0.0504719f, -0.0561521f,
  +0.0724149f, -0.2798072f, -0.3377021f, +0.0366310f, +0.2512532f, -0.2400233f, -0.2458561f, -0.3775077f,
  +0.4167942f, +0.1213149f, +0.0302694f, +0.0114291f, +0.4506804f, +0.1821911f, -0.0509229f, +0.0273538f,
  +0.2546288f, +0.1081768f, -0.3487812f, -0.1168488f, -0.3540116f, +0.0330063f, -0.1729629f, -0.1023667f
);

const float biases[4] = float[4](
  +0.0423903f, -0.1082996f, -0.0773990f, +0.0267808f
);

vec4 hook() {
    const vec4 r[9][2] = vec4[9][2](
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 1.0f)))
    );

    float sum[4] = biases;
    for (int n = 0; n < 4; n++) {
        for (int i = 0; i < 9; i++) {
            const vec4 k0 = vec4(kernels[n * 8 * 9 + 8 * i + 0], kernels[n * 8 * 9 + 8 * i + 1], kernels[n * 8 * 9 + 8 * i + 2], kernels[n * 8 * 9 + 8 * i + 3]);
            const vec4 k1 = vec4(kernels[n * 8 * 9 + 8 * i + 4], kernels[n * 8 * 9 + 8 * i + 5], kernels[n * 8 * 9 + 8 * i + 6], kernels[n * 8 * 9 + 8 * i + 7]);
            sum[n] += (dot(k0, r[i][0]) + dot(k1, r[i][1]));
        }
    }

    return ACTIVE(vec4(sum[0], sum[1], sum[2], sum[3]) * 0.2000000f + TEX_BIND_L2_TEXOFF(vec2(0.0f, 0.0f)));
}

//!HOOK LUMA
//!DESC ARNet b16 Layer19 L0
//!WHEN OUTPUT.w LUMA.w / 1.2 > OUTPUT.h LUMA.h / 1.2 > *
//!BIND TMP2_L0
//!BIND TMP2_L1
//!SAVE TMP1_L0
//!COMPONENTS 4

#define ACTIVE(v) (max(v, v * 0.2000000f))

#define TEX_BIND_L0_TEXOFF TMP2_L0_texOff
#define TEX_BIND_L0_TEX TMP2_L0_tex
#define TEX_BIND_L0_POS TMP2_L0_pos
#define TEX_BIND_L0_SIZE TMP2_L0_size
#define TEX_BIND_L0_PT TMP2_L0_pt

#define TEX_BIND_L1_TEXOFF TMP2_L1_texOff
#define TEX_BIND_L1_TEX TMP2_L1_tex
#define TEX_BIND_L1_POS TMP2_L1_pos
#define TEX_BIND_L1_SIZE TMP2_L1_size
#define TEX_BIND_L1_PT TMP2_L1_pt

const float kernels[288] = float[288](
  -0.0988293f, -0.0534797f, -0.1314956f, -0.0328565f, +0.1941525f, -0.0265708f, -0.0247085f, +0.1469912f,
  +0.0022314f, +0.0707848f, +0.0594512f, +0.0677611f, -0.2843420f, +0.1357800f, -0.0813028f, -0.3295755f,
  +0.0211878f, -0.3177347f, -0.0676449f, +0.0201816f, +0.1333745f, -0.1884116f, +0.0640669f, +0.0895692f,
  -0.0448785f, +0.2632519f, -0.2117780f, -0.0942430f, +0.0736408f, -0.1160548f, +0.0337833f, +0.0472298f,
  +0.3303885f, +0.0296722f, +0.1545024f, -0.2221270f, -0.1984924f, -0.4824026f, -0.1592730f, -0.3589906f,
  +0.0377256f, -0.0932852f, +0.1926346f, -0.3979867f, +0.5195513f, +0.1337395f, -0.5234126f, +0.3149659f,
  +0.1291136f, -0.2589283f, +0.0440093f, -0.2446035f, +0.1788020f, +0.0467419f, +0.2214553f, -0.0760567f,
  +0.1503793f, -0.3359048f, +0.4167655f, -0.1143405f, +0.3859783f, +0.1024443f, -0.2649616f, -0.1232531f,
  +0.3229211f, -0.5662314f, +0.2647163f, +0.2817633f, +0.3745473f, +0.3180225f, -0.4470238f, +0.2124473f,
  -0.0648170f, -0.1470545f, +0.0657362f, +0.1335942f, +0.2125568f, +0.0390983f, +0.0257571f, -0.0675277f,
  -0.0697511f, -0.2757028f, -0.1779826f, +0.0984815f, -0.3613822f, -0.2588774f, +0.2919650f, +0.3165120f,
  +0.3136022f, -0.1139463f, +0.1403882f, +0.2029081f, -0.3018378f, -0.1991976f, -0.0612483f, +0.3105535f,
  -0.3416016f, -0.0415941f, -0.2829015f, -0.1719307f, +0.1435269f, +0.2505623f, -0.2371317f, +0.0459041f,
  -0.5015575f, +0.8317940f, +0.1118578f, +0.1016186f, -0.0451863f, -0.4360335f, +0.3246602f, +0.3764597f,
  -0.1968509f, -0.3635920f, +0.1151725f, -0.0001495f, -0.4620681f, +0.4243912f, -0.1417300f, -0.1418098f,
  -0.2794159f, +0.2627873f, -0.3322310f, +0.0797250f, +0.2627942f, +0.0967994f, +0.0908342f, +0.3691913f,
  -0.2607811f, +0.2033451f, +0.3835273f, +0.3104311f, -0.0706854f, +0.1614793f, +0.0965026f, +0.2307204f,
  +0.8325954f, -0.2429698f, +0.4790916f, +0.1865169f, +0.0040738f, +0.0413243f, +0.6038902f, -0.4975367f,
  -0.0584508f, +0.0039284f, -0.1012451f, -0.0358817f, +0.0760666f, -0.0110451f, +0.2553775f, +0.0955453f,
  -0.2977684f, -0.2651994f, -0.0303822f, +0.1167665f, -0.2034674f, +0.2674328f, +0.0088168f, +0.0157781f,
  +0.0555111f, -0.0224362f, +0.0267040f, -0.1049085f, +0.2725149f, -0.1664297f, -0.0935970f, +0.1244756f,
  +0.1710940f, -0.0488726f, +0.0341187f, -0.1745520f, +0.2061243f, -0.2674209f, -0.0282675f, -0.2562733f,
  +0.8476744f, +0.0243448f, -0.3940482f, +0.0651467f, +0.3084683f, -0.1144991f, +0.1758003f, -0.2337579f,
  +0.2527930f, +0.2063486f, -0.1915775f, +0.0845455f, -0.0619900f, -0.0121552f, -0.0268114f, -0.0605605f,
  -0.1650157f, +0.1744905f, +0.2760292f, -0.2513239f, +0.1378475f, +0.1115673f, +0.0137496f, +0.0013542f,
  -0.0005713f, +0.1671107f, -0.0198326f, -0.4858104f, +0.0196290f, +0.0039614f, -0.1979128f, +0.5253046f,
  -0.0617275f, -0.2472032f, -0.3222133f, +0.0260777f, -0.3122802f, -0.1354909f, -0.4819926f, -0.0032800f,
  -0.0754782f, -0.2302959f, -0.2051903f, +0.0134934f, -0.0114405f, +0.0818064f, +0.0696587f, +0.0404626f,
  +0.2260375f, +0.0639048f, +0.0030320f, -0.0227360f, -0.1517172f, -0.2339984f, +0.0844251f, +0.0646960f,
  -0.0833397f, -0.0688834f, -0.0864368f, +0.0660612f, -0.1102710f, +0.0651881f, +0.0164376f, +0.1463753f,
  -0.0526772f, +0.4080626f, -0.3557031f, +0.2674108f, -0.0851063f, -0.2363588f, +0.3777815f, +0.4154050f,
  -0.3721317f, -0.1384366f, +0.9519671f, -0.1153804f, -0.4381957f, +0.1856427f, -0.0212556f, +0.5247809f,
  -0.1098092f, -0.0981598f, +0.0405593f, -0.0150837f, +0.1388040f, +0.4126610f, -0.0325562f, -0.3535464f,
  -0.2237937f, +0.4063358f, -0.4140223f, +0.2082222f, -0.5915130f, +0.1668971f, -0.1816401f, +0.5103843f,
  -0.3768727f, -0.4169305f, +0.8212150f, +0.0062319f, -0.3648779f, +0.4179514f, +0.1697646f, -0.2342656f,
  +0.3468708f, -0.2503993f, -0.0327661f, +0.1371584f, +0.1452057f, -0.0699311f, +0.3108396f, -0.4090298f
);

const float biases[4] = float[4](
  -0.0674748f, +0.0061104f, +0.0150326f, -0.0246347f
);

vec4 hook() {
    const vec4 r[9][2] = vec4[9][2](
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 1.0f)))
    );

    float sum[4] = biases;
    for (int n = 0; n < 4; n++) {
        for (int i = 0; i < 9; i++) {
            const vec4 k0 = vec4(kernels[n * 8 * 9 + 8 * i + 0], kernels[n * 8 * 9 + 8 * i + 1], kernels[n * 8 * 9 + 8 * i + 2], kernels[n * 8 * 9 + 8 * i + 3]);
            const vec4 k1 = vec4(kernels[n * 8 * 9 + 8 * i + 4], kernels[n * 8 * 9 + 8 * i + 5], kernels[n * 8 * 9 + 8 * i + 6], kernels[n * 8 * 9 + 8 * i + 7]);
            sum[n] += (dot(k0, r[i][0]) + dot(k1, r[i][1]));
        }
    }

    return ACTIVE(vec4(sum[0], sum[1], sum[2], sum[3]));
}

//!HOOK LUMA
//!DESC ARNet b16 Layer19 L1
//!WHEN OUTPUT.w LUMA.w / 1.2 > OUTPUT.h LUMA.h / 1.2 > *
//!BIND TMP2_L0
//!BIND TMP2_L1
//!SAVE TMP1_L1
//!COMPONENTS 4

#define ACTIVE(v) (max(v, v * 0.2000000f))

#define TEX_BIND_L0_TEXOFF TMP2_L0_texOff
#define TEX_BIND_L0_TEX TMP2_L0_tex
#define TEX_BIND_L0_POS TMP2_L0_pos
#define TEX_BIND_L0_SIZE TMP2_L0_size
#define TEX_BIND_L0_PT TMP2_L0_pt

#define TEX_BIND_L1_TEXOFF TMP2_L1_texOff
#define TEX_BIND_L1_TEX TMP2_L1_tex
#define TEX_BIND_L1_POS TMP2_L1_pos
#define TEX_BIND_L1_SIZE TMP2_L1_size
#define TEX_BIND_L1_PT TMP2_L1_pt

const float kernels[288] = float[288](
  -0.1737029f, +0.1048267f, +0.2058122f, -0.4036897f, -0.0577266f, -0.2089492f, -0.1186843f, -0.2357163f,
  +0.1422078f, +0.2072040f, -0.2607559f, +0.0067582f, +0.4558287f, -0.0132805f, +0.0088441f, -0.0226681f,
  -0.1818201f, +0.2008136f, -0.1703765f, -0.0414453f, +0.3394259f, +0.1948994f, -0.0425613f, -0.2052398f,
  +0.0465695f, -0.1361366f, +0.3046536f, +0.0615448f, -0.1797193f, -0.1761810f, -0.1395636f, -0.3565843f,
  -0.2617719f, -0.2575094f, -0.0560574f, -0.0893387f, -0.3335633f, -0.4455979f, +0.0113372f, +0.4399724f,
  +0.0684705f, +0.1653188f, +0.0938840f, -0.0451889f, +0.0596947f, +0.1114463f, -0.1787568f, -0.1204991f,
  +0.3041680f, -0.0689783f, +0.4446448f, -0.0575638f, -0.0054315f, +0.1125724f, -0.2958696f, -0.2569006f,
  +0.3224664f, -0.4377961f, +0.2619644f, -0.0355371f, -0.4589852f, -0.1371249f, -0.3106384f, -0.0505332f,
  +0.0079927f, -0.1581438f, -0.0825291f, -0.0673366f, +0.0220560f, +0.1612603f, -0.0797059f, +0.0176437f,
  +0.1538197f, +0.1963733f, +0.1122546f, -0.2970775f, +0.1216229f, -0.0431995f, +0.2456733f, -0.3521165f,
  -0.2439000f, -0.0467854f, -0.3895484f, -0.2013009f, -0.1792988f, -0.0800619f, +0.3080302f, -0.1777107f,
  -0.2354219f, +0.1303524f, -0.1838479f, +0.0325190f, -0.3052840f, -0.3076390f, -0.1971690f, +0.0777675f,
  +0.1513636f, -0.6581360f, +0.2277699f, +0.0395095f, +0.6979393f, +0.0734201f, +0.2586820f, +0.0514537f,
  -0.1852954f, -0.4839232f, +0.0646261f, +0.2532479f, -0.1076308f, -0.0777427f, +0.8468846f, +0.0489660f,
  +0.1735054f, +0.4685797f, -0.3154072f, -0.0098139f, -0.1867300f, +0.1407110f, +0.1973150f, -0.4191689f,
  -0.0107697f, -0.1606559f, +0.8249652f, -0.1665245f, +0.4051487f, +0.1279615f, -0.3837962f, +0.0387591f,
  -0.0040161f, +0.3264410f, +0.6338732f, -0.1844930f, +0.3232559f, -0.0786673f, +0.2268326f, +0.0034201f,
  +0.2182783f, +0.7006355f, -0.2461074f, +0.3214849f, +0.4461767f, -0.1618593f, -0.3881398f, +0.1281450f,
  +0.2100240f, +0.1026924f, +0.2745075f, -0.0386503f, +0.0771482f, +0.0110269f, -0.3149974f, -0.2203205f,
  -0.1337006f, +0.1611461f, +0.2022948f, -0.0202163f, +0.3155642f, -0.1648043f, -0.0473746f, +0.2354619f,
  -0.0615494f, +0.2630468f, -0.2111230f, +0.0250143f, -0.0579479f, -0.1394830f, +0.0929846f, -0.0216648f,
  +0.2257083f, -0.4416029f, +0.3223720f, -0.0031523f, -0.3298297f, -0.0601782f, -0.4547280f, -0.5121388f,
  +0.0113467f, +0.3815200f, +0.0095856f, +0.1098167f, -0.0540153f, +0.0130712f, +0.3127308f, +0.4998946f,
  -0.3878021f, -0.3946215f, -0.0483448f, -0.0211174f, -0.1520177f, +0.1077347f, -0.0581633f, -0.2065414f,
  +0.1652290f, -0.3063068f, +0.1659234f, -0.0653644f, +0.1129490f, -0.0183540f, +0.0731225f, -0.1392108f,
  +0.2317491f, +0.3742608f, -0.1506550f, -0.1691615f, +0.1602200f, +0.0481388f, -0.1675895f, +0.3013772f,
  +0.0779421f, -0.2427918f, +0.0347469f, +0.1892868f, +0.0664885f, -0.0265922f, +0.0793478f, +0.1270216f,
  +0.0127590f, +0.1182871f, -0.2135329f, -0.1680456f, +0.1640119f, +0.0031732f, +0.1830073f, +0.0026070f,
  -0.2567413f, -0.1346754f, -0.0236862f, -0.1901868f, +0.1226168f, -0.1656286f, -0.0024297f, +0.1207538f,
  -0.3301395f, +0.2414506f, +0.0464985f, -0.0621263f, -0.0629606f, -0.0916743f, +0.1312627f, +0.4332579f,
  -0.0949901f, +0.1815064f, -0.1826501f, +0.2511913f, +0.2323626f, -0.0042194f, +0.4335172f, +0.1643201f,
  -0.0410247f, +0.5219734f, -0.1371397f, -0.0387524f, -0.4625505f, +0.2207241f, -0.3737238f, +0.1502149f,
  -0.1604598f, -0.1355457f, -0.4537253f, +0.2400244f, +0.1352780f, +0.3144055f, -0.5139345f, -1.0490662f,
  +0.1364691f, -0.0535873f, +0.0144184f, +0.0295638f, +0.3375633f, +0.0441540f, +0.0984567f, +0.1058828f,
  +0.0132214f, -0.0761181f, +0.1883082f, +0.1652876f, -0.2283089f, +0.0669207f, +0.1697687f, -0.0014048f,
  +0.2602978f, -0.3164918f, +0.2625242f, -0.0242896f, +0.5246277f, +0.1651387f, +0.1665296f, -0.2641550f
);

const float biases[4] = float[4](
  +0.0704354f, -0.0326222f, +0.0542560f, -0.1523797f
);

vec4 hook() {
    const vec4 r[9][2] = vec4[9][2](
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 1.0f)))
    );

    float sum[4] = biases;
    for (int n = 0; n < 4; n++) {
        for (int i = 0; i < 9; i++) {
            const vec4 k0 = vec4(kernels[n * 8 * 9 + 8 * i + 0], kernels[n * 8 * 9 + 8 * i + 1], kernels[n * 8 * 9 + 8 * i + 2], kernels[n * 8 * 9 + 8 * i + 3]);
            const vec4 k1 = vec4(kernels[n * 8 * 9 + 8 * i + 4], kernels[n * 8 * 9 + 8 * i + 5], kernels[n * 8 * 9 + 8 * i + 6], kernels[n * 8 * 9 + 8 * i + 7]);
            sum[n] += (dot(k0, r[i][0]) + dot(k1, r[i][1]));
        }
    }

    return ACTIVE(vec4(sum[0], sum[1], sum[2], sum[3]));
}

//!HOOK LUMA
//!DESC ARNet b16 Layer20 L0
//!WHEN OUTPUT.w LUMA.w / 1.2 > OUTPUT.h LUMA.h / 1.2 > *
//!BIND TMP1_L0
//!BIND TMP1_L1
//!BIND TMP2_L0
//!SAVE TMP2_L0
//!COMPONENTS 4

#define ACTIVE(v) (v)

#define TEX_BIND_L0_TEXOFF TMP1_L0_texOff
#define TEX_BIND_L0_TEX TMP1_L0_tex
#define TEX_BIND_L0_POS TMP1_L0_pos
#define TEX_BIND_L0_SIZE TMP1_L0_size
#define TEX_BIND_L0_PT TMP1_L0_pt

#define TEX_BIND_L1_TEXOFF TMP1_L1_texOff
#define TEX_BIND_L1_TEX TMP1_L1_tex
#define TEX_BIND_L1_POS TMP1_L1_pos
#define TEX_BIND_L1_SIZE TMP1_L1_size
#define TEX_BIND_L1_PT TMP1_L1_pt

#define TEX_BIND_L2_TEXOFF TMP2_L0_texOff
#define TEX_BIND_L2_TEX TMP2_L0_tex
#define TEX_BIND_L2_POS TMP2_L0_pos
#define TEX_BIND_L2_SIZE TMP2_L0_size
#define TEX_BIND_L2_PT TMP2_L0_pt

const float kernels[288] = float[288](
  -0.1122435f, -0.0844656f, +0.0350743f, -0.2589274f, -0.0227155f, +0.1330732f, +0.1742149f, +0.2524518f,
  +0.1387337f, +0.2787457f, -0.0416539f, +0.4889602f, -0.1085246f, +0.1349203f, +0.1845429f, -0.0293508f,
  -0.1876779f, +0.1614158f, +0.1734722f, -0.4185752f, +0.0795277f, +0.0951455f, +0.0553641f, +0.0451482f,
  -0.1663662f, +0.0527627f, -0.0705017f, -0.0677708f, -0.2788353f, -0.0965731f, +0.2807304f, +0.9524471f,
  -0.1574144f, -0.2133083f, -0.5882733f, +0.1892663f, +0.3401068f, -0.0143568f, +0.0986483f, +0.3087791f,
  -0.0387770f, +0.0695844f, -0.0083601f, -0.0202246f, -0.0984713f, -0.1640364f, -0.2309380f, +0.1150371f,
  -0.0507531f, +0.1481849f, +0.0333269f, +0.1063608f, -0.0322251f, +0.0397868f, -0.0779625f, +0.2834704f,
  +0.2125016f, -0.2152326f, +0.0602467f, +0.0012717f, +0.0582620f, -0.3052664f, -0.0028938f, +0.0934782f,
  +0.0210992f, +0.0454366f, -0.0168132f, +0.0236873f, +0.0103430f, -0.0029907f, -0.0836724f, -0.1318146f,
  +0.3491526f, -0.3433115f, -0.0803425f, +0.0279051f, -0.0945217f, +0.1079479f, -0.0151842f, -0.2526233f,
  +0.0573926f, +0.2861021f, +0.0567153f, +0.6827241f, -0.2611097f, +0.0008571f, -0.1773662f, +0.0003905f,
  +0.1576274f, -0.1904973f, +0.0575791f, +0.4274297f, +0.0271079f, -0.1880005f, +0.0213513f, -0.0771079f,
  +0.0544400f, +0.0900410f, +0.0997903f, +0.2077634f, -0.1409196f, -0.2645648f, +0.3383834f, +0.2421642f,
  +0.0498068f, +0.3920293f, +0.0419396f, +0.2145440f, +0.0074518f, +0.2019623f, -0.0676317f, -0.3461997f,
  -0.0218945f, +0.0894056f, +0.0990682f, -0.1203861f, -0.0049994f, +0.2353169f, +0.4149467f, -0.2517397f,
  -0.1821667f, -0.2544624f, +0.2585979f, +0.1706704f, -0.0953674f, -0.1214739f, -0.1791530f, -0.2376487f,
  -0.0501092f, +0.1696609f, +0.1196827f, -0.0906635f, +0.1480972f, +0.0766339f, -0.2399526f, -0.2785901f,
  -0.0528443f, -0.0059244f, +0.1981585f, +0.0636465f, +0.1479314f, -0.1288478f, -0.1613375f, -0.2036994f,
  -0.3886173f, -0.3158159f, +0.3256213f, +0.1126026f, +0.0360431f, -0.1744011f, +0.1596351f, -0.0200433f,
  -0.2018982f, +0.2048063f, +0.2959744f, +0.2227325f, -0.5799627f, -0.4942891f, +0.4516001f, -0.0840666f,
  +0.0662994f, +0.1599588f, -0.1987723f, -0.3383842f, -0.4035724f, -0.2120959f, -0.0056417f, -0.0167891f,
  -0.0604080f, -0.5214003f, +0.1319881f, -0.2004746f, -0.0722002f, -0.1021876f, +0.0131047f, +0.4481390f,
  +0.1283880f, -0.6901393f, +0.0862131f, -0.1138953f, +0.0402088f, +0.3401049f, -0.2429890f, +0.3336024f,
  -0.2119380f, -0.1656200f, -0.2729124f, -0.6483148f, -0.0542825f, +0.1532199f, -0.2272277f, -0.2163712f,
  +0.0849774f, +0.0281353f, -0.1470800f, +0.3130388f, +0.2901705f, -0.3390355f, +0.3519621f, -0.1599390f,
  +0.0880910f, -0.0359518f, +0.2179910f, -0.0223295f, +0.5516968f, -0.0797994f, -0.2433769f, -0.2918981f,
  -0.0052452f, +0.0088052f, +0.0319202f, +0.1048487f, +0.0130124f, -0.3427186f, +0.0082040f, +0.0522425f,
  -0.0409146f, -0.0257115f, +0.1027367f, +0.3400410f, +0.0806199f, -0.3840722f, -0.0415748f, +0.0733864f,
  +0.0768869f, +0.3859112f, +0.5001762f, +0.3462873f, +0.2600843f, -0.0460484f, +0.1503630f, -0.0141826f,
  -0.0047141f, -0.0120417f, +0.3248306f, -0.2552809f, -0.1088501f, +0.2782489f, -0.0378799f, -0.2003585f,
  +0.4192503f, -0.3164374f, -0.0301480f, +0.2669926f, +0.2512888f, -0.0902944f, +0.2132208f, -0.4317228f,
  -0.3145445f, -0.5065094f, +0.1511753f, -0.1984407f, -0.1104027f, -0.0998050f, -0.3479812f, +0.0994343f,
  -0.0508860f, +0.3878665f, +0.1223794f, -0.2986495f, -0.1746638f, +0.0231036f, +0.0560453f, -0.0505548f,
  +0.0900394f, -0.3081941f, -0.0588041f, +0.0278047f, +0.4396398f, +0.0366815f, +0.0381967f, -0.1321013f,
  -0.1739252f, +0.2496433f, -0.0320281f, +0.1173851f, +0.0097765f, +0.0106557f, -0.1733361f, +0.0187038f,
  +0.1072346f, +0.1434026f, -0.0114724f, -0.1225081f, +0.0472139f, +0.1916628f, -0.0711576f, -0.0799164f
);

const float biases[4] = float[4](
  +0.0020150f, -0.0997867f, -0.0559973f, -0.0666980f
);

vec4 hook() {
    const vec4 r[9][2] = vec4[9][2](
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 1.0f)))
    );

    float sum[4] = biases;
    for (int n = 0; n < 4; n++) {
        for (int i = 0; i < 9; i++) {
            const vec4 k0 = vec4(kernels[n * 8 * 9 + 8 * i + 0], kernels[n * 8 * 9 + 8 * i + 1], kernels[n * 8 * 9 + 8 * i + 2], kernels[n * 8 * 9 + 8 * i + 3]);
            const vec4 k1 = vec4(kernels[n * 8 * 9 + 8 * i + 4], kernels[n * 8 * 9 + 8 * i + 5], kernels[n * 8 * 9 + 8 * i + 6], kernels[n * 8 * 9 + 8 * i + 7]);
            sum[n] += (dot(k0, r[i][0]) + dot(k1, r[i][1]));
        }
    }

    return ACTIVE(vec4(sum[0], sum[1], sum[2], sum[3]) * 0.2000000f + TEX_BIND_L2_TEXOFF(vec2(0.0f, 0.0f)));
}

//!HOOK LUMA
//!DESC ARNet b16 Layer20 L1
//!WHEN OUTPUT.w LUMA.w / 1.2 > OUTPUT.h LUMA.h / 1.2 > *
//!BIND TMP1_L0
//!BIND TMP1_L1
//!BIND TMP2_L1
//!SAVE TMP2_L1
//!COMPONENTS 4

#define ACTIVE(v) (v)

#define TEX_BIND_L0_TEXOFF TMP1_L0_texOff
#define TEX_BIND_L0_TEX TMP1_L0_tex
#define TEX_BIND_L0_POS TMP1_L0_pos
#define TEX_BIND_L0_SIZE TMP1_L0_size
#define TEX_BIND_L0_PT TMP1_L0_pt

#define TEX_BIND_L1_TEXOFF TMP1_L1_texOff
#define TEX_BIND_L1_TEX TMP1_L1_tex
#define TEX_BIND_L1_POS TMP1_L1_pos
#define TEX_BIND_L1_SIZE TMP1_L1_size
#define TEX_BIND_L1_PT TMP1_L1_pt

#define TEX_BIND_L2_TEXOFF TMP2_L1_texOff
#define TEX_BIND_L2_TEX TMP2_L1_tex
#define TEX_BIND_L2_POS TMP2_L1_pos
#define TEX_BIND_L2_SIZE TMP2_L1_size
#define TEX_BIND_L2_PT TMP2_L1_pt

const float kernels[288] = float[288](
  -0.1652090f, +0.0006517f, +0.3018907f, +0.3145879f, +0.1656195f, +0.0898485f, +0.0618231f, -0.0732148f,
  -0.4556200f, -0.3745332f, -0.1104158f, -0.3274597f, +0.5196850f, +0.1515679f, -0.2729716f, +0.4214603f,
  +0.1008856f, -0.2677888f, -0.6697605f, +0.2078940f, +0.3170288f, +0.2423816f, -0.1672282f, +0.1280406f,
  -0.1939871f, +0.1511218f, -0.0202259f, +0.2067142f, -0.1359757f, +0.1817148f, +0.3100334f, -0.1523474f,
  +0.3650453f, -0.1016955f, -0.2229109f, -0.3544991f, +0.4975539f, +0.3115422f, +0.4171907f, +0.1649999f,
  -0.4005383f, -0.3377373f, +0.1077112f, -0.2292012f, +0.4098304f, +0.3531847f, +0.4475022f, -0.1208345f,
  -0.0267482f, -0.0426908f, -0.1830437f, -0.0977119f, -0.3819707f, +0.0237587f, +0.1215226f, +0.2220697f,
  +0.0662747f, -0.0969092f, +0.0154820f, +0.0384864f, -0.0852174f, +0.2826018f, -0.1881026f, -0.0199461f,
  -0.2269701f, +0.0744696f, -0.0433551f, -0.0403273f, -0.0884241f, -0.0020737f, -0.0762762f, +0.0879971f,
  -0.0308162f, -0.1060014f, -0.1614507f, -0.1028634f, +0.0486729f, +0.0674101f, +0.0176783f, -0.2222780f,
  +0.1878342f, +0.0799949f, -0.1985603f, -0.1366916f, +0.0986219f, +0.0814785f, -0.2080990f, -0.2401461f,
  -0.1000150f, -0.0889002f, -0.2912713f, +0.2581829f, -0.2029368f, -0.0614924f, -0.0936187f, -0.0697214f,
  +0.2648523f, +0.4789620f, -0.0304011f, +0.0366195f, +0.0168005f, -0.0705741f, -0.1567976f, -0.1795022f,
  +0.3493896f, +0.2627722f, +0.2811726f, +0.1612375f, +0.1038643f, -0.0055312f, -0.1481500f, -0.3517040f,
  +0.1459904f, +0.2800302f, +0.3847024f, -0.2372116f, -0.2767330f, -0.0481440f, +0.1210076f, +0.0488237f,
  -0.2356357f, +0.2667015f, +0.2224616f, -0.1441556f, -0.2036375f, +0.0654227f, -0.0515041f, -0.0653885f,
  -0.2524454f, +0.1527161f, -0.0766920f, -0.0100021f, +0.1911169f, -0.0375489f, +0.0804648f, -0.0528894f,
  +0.0985837f, -0.0373935f, +0.0397398f, +0.1883111f, -0.1871158f, +0.0301023f, +0.0152974f, -0.1489272f,
  +0.1809812f, -0.0929624f, +0.0584172f, -0.0981146f, -0.0143182f, -0.2044150f, +0.0699540f, +0.1170379f,
  +0.4865115f, +0.1353298f, +0.0725089f, +0.2045653f, -0.0507246f, -0.1834622f, +0.4280706f, -0.1373598f,
  -0.0508342f, +0.2555338f, +0.0031069f, +0.2706454f, -0.1582619f, -0.1489899f, +0.0793537f, -0.0471660f,
  -0.5880326f, -0.1771328f, +0.2250911f, -0.0834538f, -0.1136037f, -0.0888085f, -0.0994837f, +0.3768544f,
  -0.2213184f, -0.3808632f, -0.0943608f, -0.3675241f, +0.0873440f, -0.3836798f, -0.5399945f, +0.2581070f,
  +0.0551841f, +0.0160473f, +0.0328686f, +0.4734530f, +0.0154980f, -0.1961239f, +0.1905528f, -0.0777325f,
  +0.0436127f, +0.2002050f, +0.1751140f, +0.2854472f, +0.1764822f, -0.0681911f, +0.0517054f, -0.0514823f,
  +0.2419829f, -0.0687381f, -0.1372366f, +0.0760251f, +0.2033792f, -0.0834106f, +0.2137948f, +0.0617827f,
  +0.0296095f, +0.0247484f, -0.0852484f, +0.1400825f, +0.0051306f, +0.0350796f, +0.1080509f, -0.1430735f,
  +0.2870743f, +0.1976735f, +0.0898621f, +0.0302378f, +0.1317048f, +0.3115737f, -0.1276383f, +0.1749303f,
  +0.1205804f, -0.4340740f, -0.5541652f, -0.6565434f, +0.2167179f, +0.3099045f, -0.2542808f, +0.2118114f,
  +0.0318115f, -0.1706949f, -0.1271881f, -0.1257265f, -0.0121352f, +0.1256510f, +0.0512837f, +0.1573713f,
  -0.1892003f, -0.6455504f, -0.0724596f, -0.1509369f, +0.4440786f, -0.1971746f, +0.4187843f, +0.5219854f,
  -0.0549368f, +0.1703833f, +0.0772856f, -0.2339988f, -0.0780006f, +0.2387275f, -0.6341161f, +0.0861234f,
  -0.1465363f, -0.1229981f, -0.0015436f, +0.2865457f, +0.0394755f, +0.2215974f, -0.0924628f, +0.0935745f,
  +0.4660473f, -0.2072543f, -0.4003172f, +0.0902451f, +0.2074738f, +0.1430176f, +0.0029015f, -0.3255717f,
  +0.1983507f, -0.1976408f, +0.0734835f, -0.1702093f, -0.3929116f, -0.0360012f, -0.4611743f, -0.0261742f,
  -0.1162055f, +0.0158162f, +0.0248402f, -0.1347612f, -0.1369297f, +0.2814912f, -0.0980922f, -0.0415890f
);

const float biases[4] = float[4](
  -0.0596853f, -0.0912820f, -0.0619955f, +0.0496345f
);

vec4 hook() {
    const vec4 r[9][2] = vec4[9][2](
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 1.0f)))
    );

    float sum[4] = biases;
    for (int n = 0; n < 4; n++) {
        for (int i = 0; i < 9; i++) {
            const vec4 k0 = vec4(kernels[n * 8 * 9 + 8 * i + 0], kernels[n * 8 * 9 + 8 * i + 1], kernels[n * 8 * 9 + 8 * i + 2], kernels[n * 8 * 9 + 8 * i + 3]);
            const vec4 k1 = vec4(kernels[n * 8 * 9 + 8 * i + 4], kernels[n * 8 * 9 + 8 * i + 5], kernels[n * 8 * 9 + 8 * i + 6], kernels[n * 8 * 9 + 8 * i + 7]);
            sum[n] += (dot(k0, r[i][0]) + dot(k1, r[i][1]));
        }
    }

    return ACTIVE(vec4(sum[0], sum[1], sum[2], sum[3]) * 0.2000000f + TEX_BIND_L2_TEXOFF(vec2(0.0f, 0.0f)));
}

//!HOOK LUMA
//!DESC ARNet b16 Layer21 L0
//!WHEN OUTPUT.w LUMA.w / 1.2 > OUTPUT.h LUMA.h / 1.2 > *
//!BIND TMP2_L0
//!BIND TMP2_L1
//!SAVE TMP1_L0
//!COMPONENTS 4

#define ACTIVE(v) (max(v, v * 0.2000000f))

#define TEX_BIND_L0_TEXOFF TMP2_L0_texOff
#define TEX_BIND_L0_TEX TMP2_L0_tex
#define TEX_BIND_L0_POS TMP2_L0_pos
#define TEX_BIND_L0_SIZE TMP2_L0_size
#define TEX_BIND_L0_PT TMP2_L0_pt

#define TEX_BIND_L1_TEXOFF TMP2_L1_texOff
#define TEX_BIND_L1_TEX TMP2_L1_tex
#define TEX_BIND_L1_POS TMP2_L1_pos
#define TEX_BIND_L1_SIZE TMP2_L1_size
#define TEX_BIND_L1_PT TMP2_L1_pt

const float kernels[288] = float[288](
  +0.0484234f, +0.1769309f, +0.0275153f, +0.4070226f, -0.1029077f, +0.1708983f, -0.0956267f, +0.1461771f,
  +0.2405374f, +0.3084727f, -0.0384257f, -0.0428953f, -0.1555199f, +0.0047364f, +0.2640818f, +0.3567390f,
  +0.2501733f, +0.2658318f, -0.1280316f, -0.1194511f, +0.2041127f, +0.0932161f, -0.0131028f, +0.1795660f,
  +0.4333214f, +0.0091171f, -0.2884758f, +0.1746463f, -0.1577685f, -0.3301512f, -0.3406095f, +0.0513540f,
  -0.2631344f, +0.1265831f, +0.1406947f, +0.1969193f, -0.1907534f, -0.1628435f, +1.1097057f, -0.1589326f,
  -0.1437007f, +0.1050212f, +0.4697899f, -0.3661822f, +0.2066153f, -0.1344431f, +0.5789112f, +0.1364828f,
  -0.0529171f, -0.1261000f, -0.2565058f, +0.2645158f, -0.1897413f, +0.0346574f, +0.0815261f, +0.0526780f,
  -0.1612506f, -0.1549928f, -0.2053835f, -0.2350779f, -0.0421060f, -0.0749473f, +0.1519828f, +0.0652604f,
  +0.0646149f, -0.1367540f, +0.0847259f, -0.2397742f, +0.0288056f, +0.1953192f, +0.2974529f, +0.1002192f,
  -0.1354697f, -0.1622593f, -0.3042533f, -0.4476228f, -0.0282345f, +0.0363714f, +0.1179282f, +0.1303346f,
  +0.1164146f, -0.0714601f, -0.1600084f, -0.1551114f, -0.0053146f, +0.1003890f, -0.1498413f, -0.2030140f,
  +0.1028618f, -0.1861386f, -0.2099473f, -0.0882630f, +0.0940998f, +0.0053167f, +0.3259867f, +0.0654886f,
  -0.0384050f, -0.2893349f, -0.1442592f, -0.0220889f, -0.2887133f, +0.2065699f, -0.1797859f, -0.1601391f,
  -0.0883139f, +0.2328899f, -0.3898476f, -0.3387999f, +0.3768912f, -0.2949418f, +0.0023525f, +0.0959912f,
  +0.1333528f, -0.4441879f, -0.0663178f, -0.2946845f, +0.0466456f, +0.0595351f, +0.2191728f, +0.2890705f,
  -0.2390098f, +0.1813475f, -0.2394480f, -0.1685498f, +0.0845993f, +0.0476484f, +0.2271691f, +0.2799192f,
  +0.0682340f, +0.3532066f, -0.4797101f, -0.1509302f, +0.3118818f, -0.0171056f, +0.0503825f, +0.3548562f,
  +0.0207311f, -0.1021056f, +0.0010044f, -0.3009377f, -0.2874915f, +0.1466850f, +0.0095850f, +0.0371148f,
  -0.3666376f, +0.0154011f, +0.2909119f, -0.4251004f, -0.5220003f, -0.1887465f, -0.0923905f, -0.9235600f,
  -0.2376955f, -0.1245999f, -0.5082626f, +0.4703508f, +0.3186035f, +0.0225380f, +0.7879000f, +0.0392871f,
  +0.4303639f, +0.1004489f, +0.6443771f, -0.0571405f, -0.3515631f, +0.4670311f, +0.2109837f, +0.0812966f,
  -0.0811589f, +0.1225500f, +0.6796603f, -0.3952536f, -0.1337256f, +0.0524451f, -0.1549377f, -0.2297298f,
  -0.0544605f, -1.0329568f, +0.2236490f, +0.7341617f, +0.2300835f, -0.2939134f, -0.0333999f, -0.5643232f,
  +0.0932594f, +0.0959072f, -0.0154237f, +0.2152926f, +0.0516077f, +0.1757429f, +0.5502490f, -0.3795485f,
  +0.1012163f, +0.9332036f, +0.4885399f, -0.1065988f, +0.2007148f, +0.3758087f, +0.0118686f, +0.5200038f,
  -0.2731820f, -0.2068647f, +0.6529670f, -0.2986330f, -0.0302412f, -0.2989025f, +0.5984126f, -0.3055661f,
  +0.1097139f, -0.0184377f, -0.0831132f, +0.6372063f, +0.1337469f, -0.1441403f, -0.2486427f, -0.4685737f,
  +0.0377951f, -0.3326685f, +0.0735419f, +0.0263309f, +0.1187693f, -0.1222251f, +0.4506774f, -0.0998359f,
  +0.1291602f, -0.1243536f, -0.0552051f, +0.2177887f, -0.4657628f, +0.2167305f, -0.1056898f, +0.3831851f,
  -0.0376060f, -0.0743592f, +0.3052909f, -0.1096791f, -0.5587891f, +0.6582533f, +0.3011216f, -0.5129725f,
  +0.1928542f, +0.0217812f, +0.4735992f, +0.2936473f, +0.3471506f, +0.1164562f, +0.2179326f, +0.2900671f,
  -0.3045708f, -0.1887939f, +0.1717416f, +0.4019962f, -1.7186477f, +0.4173006f, -0.3427290f, -0.4900382f,
  -0.1998463f, -0.0437754f, +0.1973316f, -0.0337457f, +0.7049056f, -0.4944561f, +1.0101646f, -0.4766307f,
  -0.0674415f, +0.1276445f, -0.2579401f, +0.0688456f, -0.3000086f, +0.2192519f, +0.1309008f, +0.0657823f,
  -0.3424096f, -0.1508491f, +0.4077801f, +0.1147437f, -0.0592297f, -0.1921590f, +0.2710727f, -0.8201059f,
  -0.3042151f, +1.0362415f, +0.3373751f, +0.0140762f, +0.2117543f, -0.0676955f, +0.1738053f, +0.2477655f
);

const float biases[4] = float[4](
  -0.0389509f, +0.1112504f, -0.1362266f, -0.0900488f
);

vec4 hook() {
    const vec4 r[9][2] = vec4[9][2](
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 1.0f)))
    );

    float sum[4] = biases;
    for (int n = 0; n < 4; n++) {
        for (int i = 0; i < 9; i++) {
            const vec4 k0 = vec4(kernels[n * 8 * 9 + 8 * i + 0], kernels[n * 8 * 9 + 8 * i + 1], kernels[n * 8 * 9 + 8 * i + 2], kernels[n * 8 * 9 + 8 * i + 3]);
            const vec4 k1 = vec4(kernels[n * 8 * 9 + 8 * i + 4], kernels[n * 8 * 9 + 8 * i + 5], kernels[n * 8 * 9 + 8 * i + 6], kernels[n * 8 * 9 + 8 * i + 7]);
            sum[n] += (dot(k0, r[i][0]) + dot(k1, r[i][1]));
        }
    }

    return ACTIVE(vec4(sum[0], sum[1], sum[2], sum[3]));
}

//!HOOK LUMA
//!DESC ARNet b16 Layer21 L1
//!WHEN OUTPUT.w LUMA.w / 1.2 > OUTPUT.h LUMA.h / 1.2 > *
//!BIND TMP2_L0
//!BIND TMP2_L1
//!SAVE TMP1_L1
//!COMPONENTS 4

#define ACTIVE(v) (max(v, v * 0.2000000f))

#define TEX_BIND_L0_TEXOFF TMP2_L0_texOff
#define TEX_BIND_L0_TEX TMP2_L0_tex
#define TEX_BIND_L0_POS TMP2_L0_pos
#define TEX_BIND_L0_SIZE TMP2_L0_size
#define TEX_BIND_L0_PT TMP2_L0_pt

#define TEX_BIND_L1_TEXOFF TMP2_L1_texOff
#define TEX_BIND_L1_TEX TMP2_L1_tex
#define TEX_BIND_L1_POS TMP2_L1_pos
#define TEX_BIND_L1_SIZE TMP2_L1_size
#define TEX_BIND_L1_PT TMP2_L1_pt

const float kernels[288] = float[288](
  -0.0671815f, +0.1439859f, -0.0624931f, -0.1027214f, -0.0001269f, +0.4250630f, -0.2455950f, -0.6293874f,
  +0.2452046f, +0.3977089f, +0.1537009f, +0.3487552f, -0.1824219f, +0.0808596f, +0.2052289f, -0.3072028f,
  -0.0141450f, +0.1805589f, +0.2148714f, -0.0071703f, -0.1864078f, -0.0972178f, +0.1810275f, +0.0287483f,
  -0.3264950f, -0.1963477f, -0.3574445f, +0.5145590f, -0.5853798f, +0.3415390f, +0.0727335f, -0.7871523f,
  -0.0529312f, +0.4445299f, -0.1187657f, -0.0868382f, +0.5921662f, -0.5491710f, +0.6353021f, +0.0887927f,
  -0.2994317f, -0.4336412f, +0.3000586f, -0.2507265f, -0.0992325f, -0.0792920f, -0.1134290f, +0.0367175f,
  -0.1565701f, -0.2725792f, +0.0915675f, +0.2476501f, +0.2523053f, -0.0255248f, +0.3643353f, -0.2394805f,
  -0.1400953f, +0.6604646f, -0.0011059f, -0.2034560f, -0.0061028f, -0.1433151f, +0.1125321f, -0.0280963f,
  -0.0833226f, +0.1521057f, +0.2814603f, -0.0798662f, -0.2507787f, +0.0784669f, +0.0253103f, +0.0879663f,
  -0.3484025f, -0.1231427f, +0.1986815f, -0.0241603f, +0.3845114f, +0.0509727f, -0.0574512f, +0.0271349f,
  -0.4754704f, +0.2637016f, -0.1945728f, +0.1413831f, +0.2380924f, +0.5861395f, -0.3369672f, -0.2474622f,
  -0.3403232f, +0.1484506f, +0.0740025f, +0.3885232f, +0.0210477f, +0.4242534f, +0.2311132f, -0.0988920f,
  -0.2124463f, -0.1814186f, +0.0334277f, +0.5780575f, -0.5684170f, -0.2507678f, -0.1898635f, -0.5305672f,
  +0.0167652f, -0.1653955f, +0.4174615f, +0.8303042f, -0.7555956f, -0.2465570f, +0.7582974f, -0.2450756f,
  +0.2966647f, -0.4242747f, +0.3391428f, +0.4499195f, +0.0495102f, -0.2789589f, +0.5611775f, +0.2824716f,
  +0.1075992f, +0.1741760f, +0.1530084f, +0.0348412f, +0.0743890f, +0.0776009f, -0.1418592f, +0.1661613f,
  -0.1182097f, +0.6108027f, +0.7015022f, -0.7755448f, +0.2657632f, -0.1360762f, -0.0897222f, +0.1946627f,
  +0.2795595f, -0.0944664f, -0.0641714f, -0.2725233f, -0.2444738f, -0.2166069f, -0.1051985f, -0.2677872f,
  -0.2172246f, +0.1728019f, -0.0326458f, +0.1031270f, +0.0159832f, -0.4966032f, -0.1968488f, +0.0539718f,
  -0.4116851f, +0.0150755f, -0.0581344f, +0.1343936f, +0.0221218f, -0.7704761f, +0.3803168f, +0.4608876f,
  -0.0350726f, -0.2157391f, +0.3832875f, +0.0609109f, -0.1607291f, +0.1443926f, -0.0050664f, +0.3437904f,
  -0.1556789f, +0.1871316f, +0.1038780f, +0.1252824f, +0.2496871f, +0.1978933f, +0.2698952f, +0.3374868f,
  -0.1193343f, +0.0494048f, +0.0038697f, +0.5210133f, +0.4666311f, -0.1302630f, -0.3950696f, -0.6143907f,
  +0.0175641f, +0.4426902f, -0.0654486f, +0.2649191f, +0.4102657f, -0.2151113f, -0.0558314f, -0.4412777f,
  -0.1430504f, -0.1129817f, -0.1309417f, +0.0734854f, +0.2679328f, +0.1502931f, +0.2285368f, -0.0870254f,
  +0.2338921f, -0.3461143f, +0.2964755f, +0.2494853f, +0.3104127f, +0.4978152f, +0.5188075f, +0.1646622f,
  -0.0300616f, -0.0008036f, +0.0155258f, +0.1574669f, +0.1476383f, -0.1055539f, -0.0119770f, +0.1862976f,
  -0.1048212f, +0.1058800f, +0.1649525f, +0.0438547f, +0.2677090f, -0.0153555f, +0.3663820f, -0.1295970f,
  -0.1426273f, +0.0068477f, -0.1672251f, +0.0907928f, -0.0264014f, +0.1393653f, +0.0208901f, +0.0601012f,
  +0.0713462f, +0.2962668f, -0.1536070f, +0.4051232f, -0.1916509f, -0.2610870f, +0.0212388f, -0.0590315f,
  -0.0319847f, -0.4585406f, -0.3767962f, +0.0682403f, -0.1111708f, -0.0791763f, +0.2494157f, +0.2466671f,
  +0.2094095f, +0.1370855f, -0.4817896f, +0.2621927f, +0.1285032f, -0.2815267f, +0.1600654f, +0.6784583f,
  +0.1122767f, -0.2359933f, -0.3293093f, +0.5339349f, +0.2527817f, -0.0605826f, +0.1506116f, +0.1529140f,
  -0.1891400f, -0.0451939f, -0.0522418f, -0.2111353f, +0.2216342f, +0.0670821f, +0.0429950f, +0.2035138f,
  +0.0987478f, +0.0280051f, +0.1582906f, -0.2487579f, +0.1516124f, -0.1661778f, +0.0583532f, -0.0603807f,
  +0.2658605f, +0.2563360f, -0.1336523f, +0.0310805f, +0.3422499f, -0.1224014f, -0.1415384f, -0.1356110f
);

const float biases[4] = float[4](
  -0.0303930f, -0.0460843f, -0.0405610f, +0.1242878f
);

vec4 hook() {
    const vec4 r[9][2] = vec4[9][2](
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 1.0f)))
    );

    float sum[4] = biases;
    for (int n = 0; n < 4; n++) {
        for (int i = 0; i < 9; i++) {
            const vec4 k0 = vec4(kernels[n * 8 * 9 + 8 * i + 0], kernels[n * 8 * 9 + 8 * i + 1], kernels[n * 8 * 9 + 8 * i + 2], kernels[n * 8 * 9 + 8 * i + 3]);
            const vec4 k1 = vec4(kernels[n * 8 * 9 + 8 * i + 4], kernels[n * 8 * 9 + 8 * i + 5], kernels[n * 8 * 9 + 8 * i + 6], kernels[n * 8 * 9 + 8 * i + 7]);
            sum[n] += (dot(k0, r[i][0]) + dot(k1, r[i][1]));
        }
    }

    return ACTIVE(vec4(sum[0], sum[1], sum[2], sum[3]));
}

//!HOOK LUMA
//!DESC ARNet b16 Layer22 L0
//!WHEN OUTPUT.w LUMA.w / 1.2 > OUTPUT.h LUMA.h / 1.2 > *
//!BIND TMP1_L0
//!BIND TMP1_L1
//!BIND TMP2_L0
//!SAVE TMP2_L0
//!COMPONENTS 4

#define ACTIVE(v) (v)

#define TEX_BIND_L0_TEXOFF TMP1_L0_texOff
#define TEX_BIND_L0_TEX TMP1_L0_tex
#define TEX_BIND_L0_POS TMP1_L0_pos
#define TEX_BIND_L0_SIZE TMP1_L0_size
#define TEX_BIND_L0_PT TMP1_L0_pt

#define TEX_BIND_L1_TEXOFF TMP1_L1_texOff
#define TEX_BIND_L1_TEX TMP1_L1_tex
#define TEX_BIND_L1_POS TMP1_L1_pos
#define TEX_BIND_L1_SIZE TMP1_L1_size
#define TEX_BIND_L1_PT TMP1_L1_pt

#define TEX_BIND_L2_TEXOFF TMP2_L0_texOff
#define TEX_BIND_L2_TEX TMP2_L0_tex
#define TEX_BIND_L2_POS TMP2_L0_pos
#define TEX_BIND_L2_SIZE TMP2_L0_size
#define TEX_BIND_L2_PT TMP2_L0_pt

const float kernels[288] = float[288](
  -0.1054939f, -0.0543725f, -0.0538637f, +0.0889739f, +0.1282291f, -0.0901652f, -0.1715889f, +0.1340983f,
  +0.0731446f, +0.2263241f, +0.0655440f, +0.2255004f, -0.1463069f, -0.1216245f, -0.1582689f, -0.0047631f,
  -0.0632763f, +0.3917949f, -0.1734367f, -0.0727149f, +0.0073288f, +0.2913812f, +0.0366858f, -0.0255601f,
  +0.0350741f, -0.1788097f, +0.0733301f, +0.0238286f, -0.1660419f, -0.0442914f, +0.3919654f, -0.1165350f,
  -0.3212028f, +0.2744986f, +0.2884800f, +0.2891932f, -0.0047638f, -0.0873552f, +0.7963580f, -0.4606574f,
  -0.4377949f, -0.1330354f, -0.2481758f, -0.0831873f, +0.2931459f, +0.1528009f, -0.1191543f, -0.0113431f,
  -0.1458334f, -0.0966978f, -0.0580300f, -0.1321719f, +0.1556029f, +0.0875477f, -0.0757077f, +0.1915448f,
  -0.4734309f, +0.1664536f, +0.0157901f, -0.0549968f, -0.0552916f, +0.7739663f, -0.1218947f, +0.1232243f,
  -0.2370085f, +0.2892150f, +0.0986636f, +0.0253296f, +0.3906153f, +0.4791086f, +0.0468845f, -0.0110444f,
  -0.0850413f, +0.2347492f, -0.3720659f, -0.5652595f, -0.0357689f, +0.4197414f, +0.1917007f, +0.1969146f,
  -0.2634356f, -0.0867618f, -0.1819557f, -0.0638557f, -0.2978864f, -0.2221109f, -0.0767511f, -0.0041505f,
  +0.1201737f, -0.0125137f, +0.3230011f, +0.1821295f, -0.0539522f, -0.1980303f, +0.1376967f, -0.0117597f,
  -0.2743201f, +0.5606654f, -0.2125521f, +0.2605208f, +0.0338851f, -0.0040842f, +0.1574281f, +0.3291863f,
  -0.0618657f, -0.0886601f, +0.3157898f, +0.1576238f, -0.3988210f, +0.6789559f, +0.6952525f, +0.2689683f,
  +0.1100482f, +0.1294505f, -0.0254406f, -0.0423739f, +0.6041343f, +0.5877128f, +0.3614283f, +0.4378232f,
  -0.0663928f, +0.0794727f, +0.0100113f, +0.0423777f, +0.4087248f, +0.4584775f, -0.4395523f, +0.2593462f,
  -0.1322903f, +0.2316011f, -0.0221764f, +0.2613936f, +0.3356206f, +0.1788330f, +0.2890094f, +0.1838308f,
  -0.0942094f, +0.0201635f, -0.0869665f, -0.0240737f, +0.1462663f, +0.1380483f, +0.0448055f, -0.1122650f,
  -0.0720656f, -0.1961226f, +0.0557688f, -0.1719177f, -0.0265537f, +0.5090688f, -0.2115607f, +0.0584083f,
  -0.2039431f, +0.2717670f, +0.5752090f, -0.3588043f, -0.1952202f, -0.5150730f, +0.3194713f, -0.2053688f,
  +0.1757750f, +0.3838457f, +0.3684740f, -0.2426931f, -0.1323925f, +0.1703875f, -0.1622986f, +0.1396076f,
  -0.2107178f, -0.0855917f, -0.1277442f, -0.6276754f, +0.0721869f, +0.1844888f, +0.0444384f, +0.1940443f,
  -0.3096168f, -0.0737301f, -0.7388420f, +1.4372674f, -0.4167035f, +0.2739626f, +0.3596286f, +0.4946965f,
  +0.0895839f, -0.1762305f, +0.4399331f, -0.7174386f, +0.6813976f, +0.5637161f, +0.2588703f, +0.4270580f,
  -0.0784823f, -0.0216457f, +0.3732342f, +0.0788647f, +0.1508033f, +0.3337516f, +0.1848414f, -0.2836044f,
  -0.1823351f, +0.1276481f, +0.1046630f, +0.7319051f, +0.2406596f, +0.1645015f, -0.1620296f, -0.1047318f,
  +0.0172031f, +0.1377395f, +0.6229156f, +0.2791137f, +0.0763265f, -0.1386077f, -0.2252020f, -0.3818088f,
  -0.3711084f, +0.2409610f, +0.3656039f, +0.0795724f, -0.1374302f, +0.0405862f, +0.0567233f, -0.3767160f,
  -0.1562388f, +0.2724224f, +0.4484314f, +0.4177303f, -0.2518303f, -0.2587518f, -0.6185763f, +0.1750909f,
  -0.4300461f, -0.0053695f, +0.2319453f, +0.1126415f, -0.3325498f, -0.3086366f, -0.2466501f, +0.0811374f,
  -0.5658307f, +0.3837844f, +0.1326468f, +0.3653640f, -0.4441671f, +0.1905368f, +0.0825402f, -0.3503878f,
  -0.1598855f, +0.6388178f, +0.1158031f, +0.3543059f, -0.4359862f, +1.2524958f, +0.2215078f, -0.1169266f,
  -0.2644304f, -0.3297535f, +0.6983377f, +0.1392124f, +0.8485132f, +0.4660571f, +0.3501790f, -0.1568875f,
  -0.4705485f, +0.3150776f, +0.2462269f, +0.4490574f, -0.0550689f, -0.0604103f, -0.1681570f, -0.3233791f,
  -0.1476658f, +0.1392330f, -0.0415032f, -0.1271666f, +0.4501845f, -0.3437147f, -0.0816747f, -0.0041633f,
  -0.2089798f, -0.2474459f, +0.2276780f, -0.1371400f, +0.1234888f, +0.2170770f, -0.0832422f, -0.1593626f
);

const float biases[4] = float[4](
  -0.1331084f, +0.0196098f, +0.0006274f, -0.0495525f
);

vec4 hook() {
    const vec4 r[9][2] = vec4[9][2](
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 1.0f)))
    );

    float sum[4] = biases;
    for (int n = 0; n < 4; n++) {
        for (int i = 0; i < 9; i++) {
            const vec4 k0 = vec4(kernels[n * 8 * 9 + 8 * i + 0], kernels[n * 8 * 9 + 8 * i + 1], kernels[n * 8 * 9 + 8 * i + 2], kernels[n * 8 * 9 + 8 * i + 3]);
            const vec4 k1 = vec4(kernels[n * 8 * 9 + 8 * i + 4], kernels[n * 8 * 9 + 8 * i + 5], kernels[n * 8 * 9 + 8 * i + 6], kernels[n * 8 * 9 + 8 * i + 7]);
            sum[n] += (dot(k0, r[i][0]) + dot(k1, r[i][1]));
        }
    }

    return ACTIVE(vec4(sum[0], sum[1], sum[2], sum[3]) * 0.2000000f + TEX_BIND_L2_TEXOFF(vec2(0.0f, 0.0f)));
}

//!HOOK LUMA
//!DESC ARNet b16 Layer22 L1
//!WHEN OUTPUT.w LUMA.w / 1.2 > OUTPUT.h LUMA.h / 1.2 > *
//!BIND TMP1_L0
//!BIND TMP1_L1
//!BIND TMP2_L1
//!SAVE TMP2_L1
//!COMPONENTS 4

#define ACTIVE(v) (v)

#define TEX_BIND_L0_TEXOFF TMP1_L0_texOff
#define TEX_BIND_L0_TEX TMP1_L0_tex
#define TEX_BIND_L0_POS TMP1_L0_pos
#define TEX_BIND_L0_SIZE TMP1_L0_size
#define TEX_BIND_L0_PT TMP1_L0_pt

#define TEX_BIND_L1_TEXOFF TMP1_L1_texOff
#define TEX_BIND_L1_TEX TMP1_L1_tex
#define TEX_BIND_L1_POS TMP1_L1_pos
#define TEX_BIND_L1_SIZE TMP1_L1_size
#define TEX_BIND_L1_PT TMP1_L1_pt

#define TEX_BIND_L2_TEXOFF TMP2_L1_texOff
#define TEX_BIND_L2_TEX TMP2_L1_tex
#define TEX_BIND_L2_POS TMP2_L1_pos
#define TEX_BIND_L2_SIZE TMP2_L1_size
#define TEX_BIND_L2_PT TMP2_L1_pt

const float kernels[288] = float[288](
  -0.1533210f, +0.0931452f, -0.0712566f, -0.2764647f, +0.1450013f, +0.0287204f, -0.1654905f, +0.1358211f,
  +0.0526738f, -0.1936946f, +0.0691366f, +0.0425977f, +0.1013460f, -0.2208526f, +0.1959984f, +0.1990400f,
  +0.3985869f, +0.1936836f, +0.4283109f, +0.0861050f, -0.0872456f, -0.2100758f, +0.2649313f, +0.0857160f,
  -0.5169452f, +0.1485431f, -0.0474954f, +0.0665471f, -0.2356793f, +0.2223005f, -0.3223960f, -0.0041781f,
  +0.0087375f, -0.3222003f, -0.4778882f, +0.4562866f, -0.5007577f, +0.8917530f, -0.6537960f, -0.2176392f,
  -0.0898665f, +0.0151263f, -0.1515711f, -0.1917876f, +0.5928938f, +0.4515245f, -0.4332729f, +0.4643874f,
  -0.3020487f, +0.0939714f, +0.2301046f, +0.1797253f, -0.0044491f, -0.1133985f, -0.2045821f, +0.0246448f,
  +0.1298419f, -0.5109690f, -0.3762492f, -0.2626971f, +0.4499832f, -0.0817950f, -0.2422048f, +0.2068932f,
  +0.0837313f, +0.0513644f, +0.0821562f, -0.0348806f, +0.0588624f, -0.2695857f, -0.2573677f, -0.0403505f,
  +0.0618655f, -0.0801180f, +0.0309194f, -0.3746974f, +0.0752011f, +0.3118456f, +0.1573448f, +0.1740889f,
  +0.0572791f, -0.1158916f, +0.2601202f, +0.0692279f, -0.0405146f, -0.0952030f, +0.0746087f, +0.1094402f,
  +0.1108167f, -0.1058459f, +0.1850365f, +0.1548001f, +0.0789684f, +0.0126442f, +0.1048341f, -0.2581672f,
  +0.3195782f, +0.1897215f, -0.1220416f, -0.1172309f, +0.0853655f, +0.5327910f, +0.0116219f, +0.3146049f,
  -0.2556921f, +0.1881530f, +0.2262990f, +0.2441739f, -0.2597235f, -0.1703894f, +0.3410963f, +0.3702071f,
  +0.0200272f, -0.1896504f, +0.1399896f, -0.2078980f, -0.0245551f, +0.3996590f, +0.2627346f, -0.0191724f,
  +0.2645777f, -0.0504901f, -0.0333724f, -0.0449823f, +0.3885227f, +0.0531075f, -0.0450445f, +0.2401794f,
  +0.1432927f, -0.4450918f, +0.4602852f, -0.1870101f, -0.1002710f, +0.1657093f, +0.3343942f, +0.2420605f,
  +0.0970423f, +0.1901033f, +0.3882191f, +0.2695822f, +0.2992169f, -0.1459398f, +0.4743694f, +0.0905799f,
  +0.1490951f, -0.1947265f, +0.4439542f, +0.4066181f, -0.0584729f, +0.1589491f, -0.1353498f, -0.0732656f,
  +0.1432820f, -0.0393832f, +0.3775340f, -0.3975678f, +0.1176710f, +0.0103593f, -0.2161892f, +0.0053450f,
  +0.1261452f, +0.0270602f, +0.4601419f, -0.0150174f, -0.1494107f, +0.1901896f, -0.2637049f, -0.3935626f,
  +0.1912612f, -0.3204122f, +0.0304404f, -0.3297627f, -0.1590834f, +0.3261982f, +0.4884899f, -0.1460289f,
  -0.1652957f, +0.0917284f, -1.0048710f, -0.5280440f, +0.7382269f, -0.4947340f, -0.5049651f, +0.3346783f,
  +0.2335201f, +0.0963952f, +0.4729165f, +0.3595249f, -0.7537110f, -0.2805420f, +0.4556753f, -0.2413497f,
  -0.0290536f, -0.2604967f, -0.0655210f, -0.5378901f, -0.0288144f, +0.4807457f, +0.1997198f, -0.1580280f,
  -0.0108392f, +0.3343930f, +0.3834883f, +0.6489527f, -0.1179434f, -0.0921912f, +0.4653386f, +0.2265561f,
  +0.0351437f, -0.0413319f, +0.2216686f, +0.1636911f, -0.2550834f, +0.2772343f, +0.2049460f, -0.3846244f,
  -0.2079085f, +0.2574149f, -0.1820438f, -0.0575616f, -0.0877071f, -0.1242082f, -0.2939187f, +0.1670637f,
  +0.0038051f, -0.1437448f, -0.2079772f, +0.5678130f, -0.0619890f, -0.4287457f, +0.4410665f, +0.2544547f,
  +0.1477418f, -0.2602652f, +0.0492182f, +0.3716310f, +0.0552541f, -0.2070744f, +0.2219844f, -0.0234197f,
  -0.2870659f, -0.0434152f, +0.0930454f, +0.5373985f, +0.0080084f, +0.2886653f, -0.2347503f, -0.3455928f,
  +0.1301583f, -0.2937835f, -0.3913358f, -0.2368423f, +0.4973187f, +1.2241446f, -0.9872268f, -0.2708676f,
  -0.0986659f, +0.1412938f, -0.5157930f, +0.3795681f, -0.1209156f, +0.3449599f, +0.0256471f, +0.1236652f,
  -0.1362122f, +0.1607343f, +0.1943946f, -0.5413406f, -0.2400142f, -0.0832931f, +0.2424675f, +0.0505135f,
  -0.1345771f, +0.3018783f, -0.3557153f, +0.3411196f, +0.1005549f, -0.4307227f, -0.0745570f, +0.1641623f,
  -0.1527549f, -0.0483471f, -0.4610013f, +0.0663792f, -0.3950425f, +0.2027948f, -0.1576829f, +0.0449711f
);

const float biases[4] = float[4](
  -0.1136330f, -0.2865188f, +0.0118814f, -0.0552680f
);

vec4 hook() {
    const vec4 r[9][2] = vec4[9][2](
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 1.0f)))
    );

    float sum[4] = biases;
    for (int n = 0; n < 4; n++) {
        for (int i = 0; i < 9; i++) {
            const vec4 k0 = vec4(kernels[n * 8 * 9 + 8 * i + 0], kernels[n * 8 * 9 + 8 * i + 1], kernels[n * 8 * 9 + 8 * i + 2], kernels[n * 8 * 9 + 8 * i + 3]);
            const vec4 k1 = vec4(kernels[n * 8 * 9 + 8 * i + 4], kernels[n * 8 * 9 + 8 * i + 5], kernels[n * 8 * 9 + 8 * i + 6], kernels[n * 8 * 9 + 8 * i + 7]);
            sum[n] += (dot(k0, r[i][0]) + dot(k1, r[i][1]));
        }
    }

    return ACTIVE(vec4(sum[0], sum[1], sum[2], sum[3]) * 0.2000000f + TEX_BIND_L2_TEXOFF(vec2(0.0f, 0.0f)));
}

//!HOOK LUMA
//!DESC ARNet b16 Layer23 L0
//!WHEN OUTPUT.w LUMA.w / 1.2 > OUTPUT.h LUMA.h / 1.2 > *
//!BIND TMP2_L0
//!BIND TMP2_L1
//!SAVE TMP1_L0
//!COMPONENTS 4

#define ACTIVE(v) (max(v, v * 0.2000000f))

#define TEX_BIND_L0_TEXOFF TMP2_L0_texOff
#define TEX_BIND_L0_TEX TMP2_L0_tex
#define TEX_BIND_L0_POS TMP2_L0_pos
#define TEX_BIND_L0_SIZE TMP2_L0_size
#define TEX_BIND_L0_PT TMP2_L0_pt

#define TEX_BIND_L1_TEXOFF TMP2_L1_texOff
#define TEX_BIND_L1_TEX TMP2_L1_tex
#define TEX_BIND_L1_POS TMP2_L1_pos
#define TEX_BIND_L1_SIZE TMP2_L1_size
#define TEX_BIND_L1_PT TMP2_L1_pt

const float kernels[288] = float[288](
  -0.0346487f, -0.0514680f, +0.0408157f, -0.1164242f, -0.0520211f, +0.1751501f, +0.1075725f, -0.1287591f,
  -0.3020876f, +0.2054946f, -0.2168980f, +0.1336285f, +0.2407273f, -0.1230175f, +0.4268911f, +0.0110866f,
  -0.2069282f, -0.1042633f, -0.0585520f, +0.0062426f, +0.1101851f, -0.0295462f, -0.0905626f, -0.0710893f,
  -0.2752307f, +0.0804463f, +0.2337180f, +0.0969345f, +0.4368280f, -0.1762615f, +0.1589241f, -0.3560303f,
  +0.1321052f, +0.4415022f, -0.6378402f, +0.5013139f, +0.3658186f, -0.3488391f, +0.6937863f, -0.8589253f,
  -0.0625618f, +0.0552391f, +0.2454624f, -0.1900359f, +0.0624148f, +0.1015720f, +0.1633010f, +0.1677035f,
  -0.2588193f, +0.0272350f, +0.2513597f, -0.2104658f, +0.3331694f, +0.0047992f, -0.0404913f, +0.0031761f,
  -0.0314593f, -0.1559283f, +0.1500129f, -0.0209807f, +0.3287602f, +0.0183411f, -0.0765733f, -0.3031914f,
  -0.0499625f, +0.1139330f, +0.0688096f, -0.0972787f, -0.0877626f, +0.1052868f, -0.1452990f, +0.0018886f,
  +0.1121785f, +0.0410254f, +0.1026139f, -0.1193260f, +0.2331836f, -0.0165287f, -0.0603203f, -0.0971008f,
  +0.0561638f, +0.1758950f, +0.0155845f, -0.2226773f, +0.2154956f, -0.2898450f, +0.2157760f, +0.2430158f,
  -0.0506476f, -0.1386037f, +0.0604232f, -0.2063012f, +0.0099760f, +0.5314281f, +0.2457130f, -0.0071980f,
  +0.4251807f, -0.1033921f, -0.0823636f, -0.1343998f, -0.0745672f, -0.2641409f, -0.2462538f, -0.1399487f,
  +0.1239435f, -0.1137599f, +0.4590365f, -0.0900132f, -0.3031740f, +0.1879040f, +0.6292743f, +0.0121013f,
  -0.1283344f, +0.0382521f, +0.2027517f, -0.3476508f, +0.1176944f, -0.0180109f, +0.8798540f, +0.1378418f,
  +0.2143468f, -0.3510724f, +0.0863838f, -0.1312659f, -0.3668148f, -0.0152079f, -0.1068719f, -0.1406403f,
  +0.1980912f, +0.2011257f, -0.0548777f, -0.1437625f, -0.2766526f, -0.0578290f, +0.2278860f, -0.0257802f,
  +0.0161412f, -0.3367129f, +0.2814428f, -0.0684980f, +0.0686716f, +0.1840673f, +0.4451579f, -0.0141047f,
  +0.1274954f, +0.0387915f, +0.0264224f, -0.1172175f, +0.0396255f, -0.3733788f, -0.0076525f, +0.0715769f,
  +0.1085228f, -0.1380954f, -0.1419440f, -0.0188642f, +0.3929863f, -0.0439490f, +0.1930876f, +0.0328845f,
  +0.1403170f, -0.0524453f, -0.0329475f, +0.0082861f, +0.3060490f, +0.1583933f, +0.0059836f, -0.1386788f,
  +0.2249998f, -0.0319772f, -0.0729608f, -0.0654679f, -0.5323701f, +0.2668177f, -0.2502871f, +0.1194836f,
  +0.0299997f, -0.3628412f, -0.7173746f, +0.0705567f, -0.0719908f, -0.1000381f, -0.5143870f, -0.0650628f,
  +0.0940214f, +0.1196055f, +0.2020536f, -0.5469091f, -0.0608506f, +0.0440365f, +0.0759450f, +0.6627591f,
  -0.3038605f, +0.2876694f, -0.2115386f, +0.0264712f, -0.0354756f, -0.2224082f, +0.1377451f, -0.0318359f,
  +0.0318429f, +0.0262827f, +0.0922519f, +0.3060372f, +0.1065221f, +0.0622769f, -0.0979562f, -0.3100258f,
  -0.1229575f, -0.0476404f, +0.0205554f, +0.0634101f, -0.3947218f, -0.0263648f, -0.2269533f, +0.0073910f,
  -0.3669643f, +0.0938158f, -0.2916323f, +0.1457558f, +0.1396521f, +0.3484488f, -0.0538267f, -0.0877786f,
  -0.2506553f, +0.2401882f, -0.2449734f, -0.3136536f, +0.2303166f, +0.1375173f, -0.2561635f, -0.2925048f,
  -0.0918375f, -0.1388582f, -0.1049252f, +0.0379228f, -0.0039604f, -0.0550537f, -0.2641255f, +0.0480618f,
  -0.0251960f, +0.1849664f, +0.1691236f, +0.0360799f, -0.7410418f, +0.1725347f, -0.1074330f, -0.0499888f,
  +0.4432961f, +0.1958174f, +0.1206162f, -0.2526371f, -0.1986708f, +0.2003278f, -0.0919519f, +0.4643982f,
  -0.1562213f, +0.2343068f, -0.0880761f, +0.1035561f, +0.0806737f, -0.0032941f, -0.2826993f, -0.3116999f,
  -0.2749079f, +0.1363980f, -0.0564207f, +0.0079242f, +0.1272315f, +0.0730013f, +0.0271103f, -0.0386238f,
  +0.0266966f, +0.2597567f, +0.0091706f, +0.0514814f, -0.4849065f, +0.0147232f, -0.1147452f, +0.1643817f,
  -0.0503375f, +0.0769629f, +0.0021779f, +0.0410280f, +0.0164058f, -0.1527122f, -0.1210960f, +0.0554675f
);

const float biases[4] = float[4](
  -0.0838789f, -0.0636616f, +0.0184271f, +0.0279574f
);

vec4 hook() {
    const vec4 r[9][2] = vec4[9][2](
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 1.0f)))
    );

    float sum[4] = biases;
    for (int n = 0; n < 4; n++) {
        for (int i = 0; i < 9; i++) {
            const vec4 k0 = vec4(kernels[n * 8 * 9 + 8 * i + 0], kernels[n * 8 * 9 + 8 * i + 1], kernels[n * 8 * 9 + 8 * i + 2], kernels[n * 8 * 9 + 8 * i + 3]);
            const vec4 k1 = vec4(kernels[n * 8 * 9 + 8 * i + 4], kernels[n * 8 * 9 + 8 * i + 5], kernels[n * 8 * 9 + 8 * i + 6], kernels[n * 8 * 9 + 8 * i + 7]);
            sum[n] += (dot(k0, r[i][0]) + dot(k1, r[i][1]));
        }
    }

    return ACTIVE(vec4(sum[0], sum[1], sum[2], sum[3]));
}

//!HOOK LUMA
//!DESC ARNet b16 Layer23 L1
//!WHEN OUTPUT.w LUMA.w / 1.2 > OUTPUT.h LUMA.h / 1.2 > *
//!BIND TMP2_L0
//!BIND TMP2_L1
//!SAVE TMP1_L1
//!COMPONENTS 4

#define ACTIVE(v) (max(v, v * 0.2000000f))

#define TEX_BIND_L0_TEXOFF TMP2_L0_texOff
#define TEX_BIND_L0_TEX TMP2_L0_tex
#define TEX_BIND_L0_POS TMP2_L0_pos
#define TEX_BIND_L0_SIZE TMP2_L0_size
#define TEX_BIND_L0_PT TMP2_L0_pt

#define TEX_BIND_L1_TEXOFF TMP2_L1_texOff
#define TEX_BIND_L1_TEX TMP2_L1_tex
#define TEX_BIND_L1_POS TMP2_L1_pos
#define TEX_BIND_L1_SIZE TMP2_L1_size
#define TEX_BIND_L1_PT TMP2_L1_pt

const float kernels[288] = float[288](
  +0.1310275f, +0.0367071f, +0.2160603f, -0.2372194f, +0.0675421f, -0.6869435f, -0.0956070f, +0.0273508f,
  +0.0595867f, -0.0650698f, -0.1597616f, -0.0411972f, +0.1428136f, -0.4870256f, +0.5224868f, +0.4024820f,
  -0.1422293f, +0.0622461f, -0.0312815f, +0.0078445f, -0.0759734f, +0.1018336f, +0.2262436f, -0.1150951f,
  +0.0594329f, +0.0181219f, -0.3004823f, -0.2099192f, +0.0316119f, -0.1468864f, +0.0694968f, +0.0914634f,
  -0.0919541f, -0.6122069f, -0.0720933f, -0.2437723f, +0.7357512f, -0.0023274f, -0.3854826f, -0.4684740f,
  -0.2730269f, +0.1994387f, -0.1768892f, +0.4388762f, +0.2004777f, -0.1109936f, -0.1644594f, -0.5558707f,
  +0.2749266f, +0.0781956f, -0.0908412f, -0.0169331f, +0.2359755f, +0.0283901f, +0.0656663f, +0.2599328f,
  +0.0385847f, -0.3402183f, -0.5389740f, +0.3840396f, -0.1431203f, +0.2097241f, +0.0627533f, +0.2119471f,
  +0.0589647f, +0.1678579f, -0.1199429f, +0.3423179f, +0.4697611f, -0.2198978f, +0.0811683f, +0.0921472f,
  +0.2085359f, -0.0917200f, -0.2308038f, +0.1118910f, -0.1480359f, +0.5795176f, +0.3847192f, +0.3457412f,
  +0.1733046f, -0.4486950f, -0.1585572f, -0.1366631f, +0.0750117f, +0.5990747f, +0.1032488f, -0.2645535f,
  +0.1451906f, -0.1275787f, +0.0785231f, +0.0875286f, -0.0039608f, -0.1340210f, +0.2483948f, +0.2170391f,
  -0.1772678f, +0.1003175f, -0.0857725f, +0.4022422f, +0.2763183f, +0.3479194f, +0.4339412f, +0.1217315f,
  +0.7613576f, +0.0418025f, -0.7374715f, +0.7869580f, +0.8049942f, +0.7011135f, -0.7791439f, -0.7373551f,
  +0.2498862f, -0.2160907f, -0.2283364f, +0.2059652f, +0.0842617f, +0.0732375f, +0.0199894f, +0.0032155f,
  -0.0110651f, +0.0375439f, +0.1659586f, +0.0903726f, +0.2923613f, +0.2312171f, +0.2125759f, +0.0709164f,
  -0.1530963f, -0.2966875f, +0.0345159f, -0.0250272f, +0.0743187f, +0.2421964f, +0.0144323f, +0.0233761f,
  -0.0770319f, +0.0569624f, -0.0051751f, +0.0275566f, -0.0356618f, -0.0394687f, -0.0972224f, -0.0762370f,
  -0.0531177f, -0.0953964f, -0.0640914f, -0.0375621f, -0.0917194f, +0.3631355f, +0.0433220f, -0.0144950f,
  +0.2871306f, -0.0811132f, -0.1313211f, +0.1569000f, -0.1019156f, +0.0863267f, +0.1216006f, +0.3041608f,
  +0.1066638f, -0.2571358f, -0.1541013f, +0.0611300f, +0.2102861f, +0.0882434f, -0.0264089f, -0.0496834f,
  -0.0475335f, -0.0157824f, -0.4808860f, +0.2683087f, -0.0318759f, +0.2666021f, +0.4025442f, +0.1761733f,
  +0.2647475f, -0.2361780f, +0.5236664f, +0.4887229f, +0.1087066f, +0.7442388f, -0.2381970f, -0.6094275f,
  +0.5008317f, +0.1897973f, -0.5644324f, +0.0411946f, +0.3212242f, +0.4848071f, +0.0914922f, -0.4317019f,
  +0.0187994f, -0.0221255f, -0.0716593f, +0.0771687f, +0.2067054f, +0.3831206f, -0.0411392f, +0.2348078f,
  +0.1491495f, -0.1269092f, +0.6037601f, +0.3961085f, +0.3924750f, +0.3609429f, +0.2138814f, +0.0328734f,
  +0.2180555f, -0.4355544f, -0.3260817f, +0.1385304f, -0.1037195f, +0.2821672f, -0.3069042f, -0.0678851f,
  +0.0174140f, +0.0673874f, +0.0370220f, +0.1510877f, -0.1208792f, +0.1233712f, -0.1020498f, -0.1423942f,
  -0.1085722f, +0.0452866f, +0.3048923f, -0.1488555f, -0.3736042f, +0.3513594f, -0.1874181f, -0.2324063f,
  -0.0698966f, +0.2210492f, +0.0457229f, -0.1273178f, -0.2385961f, -0.1499519f, -0.0789842f, +0.0964609f,
  -0.2025759f, +0.1259035f, -0.1250245f, +0.4349769f, -0.5340779f, +0.3542612f, +0.0596840f, -0.0816597f,
  -0.6056061f, +0.0636268f, -0.1598018f, -0.4690447f, -0.1526478f, +0.1489011f, -0.3251166f, -0.3717004f,
  -0.5938871f, -0.3006938f, +0.2479710f, -0.1556014f, +0.0456748f, +0.0740116f, -0.2405330f, -0.0775480f,
  +0.0599085f, +0.0042893f, -0.1839449f, +0.1595372f, -0.0876079f, +0.1846355f, -0.1035110f, +0.1823656f,
  -0.2470531f, -0.1388170f, -0.1135609f, +0.0390768f, +0.2745201f, -0.0423231f, -0.0718683f, +0.0617677f,
  +0.0516788f, +0.0445362f, -0.0517269f, -0.0064813f, +0.0412860f, +0.0611605f, -0.0802082f, +0.1078749f
);

const float biases[4] = float[4](
  +0.0736892f, -0.2472184f, -0.3144954f, +0.0942337f
);

vec4 hook() {
    const vec4 r[9][2] = vec4[9][2](
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 1.0f)))
    );

    float sum[4] = biases;
    for (int n = 0; n < 4; n++) {
        for (int i = 0; i < 9; i++) {
            const vec4 k0 = vec4(kernels[n * 8 * 9 + 8 * i + 0], kernels[n * 8 * 9 + 8 * i + 1], kernels[n * 8 * 9 + 8 * i + 2], kernels[n * 8 * 9 + 8 * i + 3]);
            const vec4 k1 = vec4(kernels[n * 8 * 9 + 8 * i + 4], kernels[n * 8 * 9 + 8 * i + 5], kernels[n * 8 * 9 + 8 * i + 6], kernels[n * 8 * 9 + 8 * i + 7]);
            sum[n] += (dot(k0, r[i][0]) + dot(k1, r[i][1]));
        }
    }

    return ACTIVE(vec4(sum[0], sum[1], sum[2], sum[3]));
}

//!HOOK LUMA
//!DESC ARNet b16 Layer24 L0
//!WHEN OUTPUT.w LUMA.w / 1.2 > OUTPUT.h LUMA.h / 1.2 > *
//!BIND TMP1_L0
//!BIND TMP1_L1
//!BIND TMP2_L0
//!SAVE TMP2_L0
//!COMPONENTS 4

#define ACTIVE(v) (v)

#define TEX_BIND_L0_TEXOFF TMP1_L0_texOff
#define TEX_BIND_L0_TEX TMP1_L0_tex
#define TEX_BIND_L0_POS TMP1_L0_pos
#define TEX_BIND_L0_SIZE TMP1_L0_size
#define TEX_BIND_L0_PT TMP1_L0_pt

#define TEX_BIND_L1_TEXOFF TMP1_L1_texOff
#define TEX_BIND_L1_TEX TMP1_L1_tex
#define TEX_BIND_L1_POS TMP1_L1_pos
#define TEX_BIND_L1_SIZE TMP1_L1_size
#define TEX_BIND_L1_PT TMP1_L1_pt

#define TEX_BIND_L2_TEXOFF TMP2_L0_texOff
#define TEX_BIND_L2_TEX TMP2_L0_tex
#define TEX_BIND_L2_POS TMP2_L0_pos
#define TEX_BIND_L2_SIZE TMP2_L0_size
#define TEX_BIND_L2_PT TMP2_L0_pt

const float kernels[288] = float[288](
  -0.0977701f, -0.2164457f, +0.0012398f, -0.0497157f, +0.0497135f, +0.1806200f, -0.0824535f, -0.2624586f,
  +0.0487486f, -0.0906893f, +0.0589848f, -0.4047633f, -0.0032969f, +0.3039296f, -0.5037508f, +0.2952522f,
  -0.1962786f, -0.0744249f, +0.0384973f, +0.0157714f, +0.2705642f, +0.0934307f, +0.0695479f, +0.0565531f,
  -0.0544556f, +0.0086826f, +0.0398889f, -0.1455989f, +0.3021449f, -0.4109871f, +0.2487255f, +0.1905066f,
  -0.0348401f, +0.0697411f, -0.1923563f, -0.9163262f, +0.0182109f, -0.2821663f, +0.5416986f, +0.7705680f,
  +0.2285294f, +0.1401557f, +0.1438951f, -0.1994167f, +0.2045557f, +0.1788667f, +0.1225156f, -0.0467990f,
  +0.1218887f, +0.1429187f, -0.1473843f, +0.0160667f, +0.0806336f, +0.1864083f, +0.0103051f, +0.0124736f,
  -0.2211913f, +0.3869608f, +0.0048845f, +0.1408185f, +0.0633605f, +0.0800359f, -0.2229693f, +0.2216138f,
  -0.0872191f, +0.0758132f, +0.0561642f, +0.4830911f, -0.1231068f, -0.0381837f, +0.0233381f, +0.1033645f,
  -0.0964947f, -0.1197821f, +0.3939239f, -0.0622721f, -0.0230988f, +0.1362893f, +0.0267812f, -0.0998070f,
  -0.0773538f, -0.4988236f, -0.0414481f, +0.0313677f, -0.4168042f, +0.0247730f, -0.1204116f, +0.3270371f,
  -0.0209364f, -0.2845888f, +0.0302474f, -0.2026761f, -0.1872388f, -0.2637754f, -0.1453402f, -0.2159803f,
  -0.2126046f, -0.2667141f, -0.3006127f, +0.0004450f, -0.0581200f, +0.3603171f, -0.0106379f, +0.0506345f,
  -0.2263324f, -0.5351908f, +0.2878386f, -0.5921975f, +0.1560975f, -0.1895421f, -0.1114488f, -0.0230641f,
  -0.4395114f, -0.4493077f, +0.2807926f, -0.1370440f, -0.1933545f, -0.2467669f, +0.2055118f, -0.2969089f,
  -0.1395018f, +0.1360620f, +0.2844017f, -0.0417683f, +0.4771925f, +0.2525196f, +0.2801719f, -0.2558875f,
  -0.1813396f, -0.1861431f, +0.2093116f, -0.3162729f, +0.2575123f, +0.2639646f, +0.2285286f, -0.0642802f,
  -0.1103518f, -0.3522696f, +0.1281753f, -0.6426746f, +0.0769189f, -0.0065041f, +0.1863972f, -0.1528392f,
  +0.0369327f, -0.0966294f, -0.0068881f, -0.0715874f, +0.0514459f, +0.1825663f, -0.0970073f, +0.0019938f,
  -0.0828834f, -0.0885906f, +0.0843723f, +0.0817029f, -0.1601226f, -0.0568771f, -0.9670902f, -0.0040579f,
  +0.0352417f, -0.1881547f, +0.3169940f, +0.2694354f, +0.2219561f, +0.2848479f, -0.1537918f, +0.1365771f,
  +0.1095117f, +0.1574346f, +0.1239179f, -0.0208741f, -0.0802182f, +0.4177452f, +0.0662772f, -0.1034670f,
  -0.2743434f, -0.3512282f, +0.6560726f, -0.2519814f, -0.3443762f, +0.8041664f, -1.2197356f, -0.1079448f,
  +0.8625798f, -0.2690919f, +0.2786340f, +0.0353749f, +0.2944180f, +0.3452810f, +0.2132352f, +0.4323733f,
  +0.0032080f, +0.0972156f, -0.1881589f, +0.1958887f, +0.1121193f, -0.2930640f, +0.0840467f, +0.0457835f,
  +0.0076374f, +0.1336284f, +0.2721123f, -0.1484627f, +0.1939316f, -0.0941786f, -0.0895818f, -0.1829783f,
  +0.1207969f, +0.0043146f, +0.0694776f, +0.0088138f, -0.0293227f, +0.1584284f, +0.0031391f, -0.0735970f,
  +0.0452688f, +0.1095055f, -0.0202353f, -0.2775439f, -0.3608617f, -0.0408774f, -0.1979386f, +0.2020508f,
  -0.0888856f, -0.2258340f, -0.3635447f, +0.0763947f, +0.0071952f, +0.1305976f, -0.4510810f, -0.0645372f,
  -0.2895816f, +0.0244439f, +0.1722845f, -0.0222838f, +0.1893465f, +0.1579140f, +0.0104967f, -0.1999319f,
  +0.2849361f, -0.2494855f, +0.2049602f, -0.1882256f, -0.1996632f, -0.0757850f, -0.0178127f, +0.3303297f,
  +0.1231051f, -0.3356434f, +0.0995378f, +0.1039431f, +0.0379315f, -0.6619563f, -0.0971383f, +0.2018178f,
  +0.2931509f, -0.4088075f, +0.1461749f, +0.0754795f, +0.0744900f, -0.2174927f, -0.3677177f, -0.4941440f,
  +0.0584974f, +0.2618303f, +0.1459259f, +0.0066859f, -0.0292198f, -0.2698403f, -0.1316669f, -0.0046384f,
  +0.3892967f, -0.3944348f, -0.0668447f, +0.2853630f, -0.2058639f, -0.0358286f, +0.2060854f, +0.2817639f,
  +0.2054585f, +0.3054610f, +0.1095737f, -0.0534182f, -0.0725521f, -0.1673344f, +0.0040891f, -0.2362826f
);

const float biases[4] = float[4](
  +0.0127967f, +0.0746289f, -0.1974299f, -0.0502048f
);

vec4 hook() {
    const vec4 r[9][2] = vec4[9][2](
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 1.0f)))
    );

    float sum[4] = biases;
    for (int n = 0; n < 4; n++) {
        for (int i = 0; i < 9; i++) {
            const vec4 k0 = vec4(kernels[n * 8 * 9 + 8 * i + 0], kernels[n * 8 * 9 + 8 * i + 1], kernels[n * 8 * 9 + 8 * i + 2], kernels[n * 8 * 9 + 8 * i + 3]);
            const vec4 k1 = vec4(kernels[n * 8 * 9 + 8 * i + 4], kernels[n * 8 * 9 + 8 * i + 5], kernels[n * 8 * 9 + 8 * i + 6], kernels[n * 8 * 9 + 8 * i + 7]);
            sum[n] += (dot(k0, r[i][0]) + dot(k1, r[i][1]));
        }
    }

    return ACTIVE(vec4(sum[0], sum[1], sum[2], sum[3]) * 0.2000000f + TEX_BIND_L2_TEXOFF(vec2(0.0f, 0.0f)));
}

//!HOOK LUMA
//!DESC ARNet b16 Layer24 L1
//!WHEN OUTPUT.w LUMA.w / 1.2 > OUTPUT.h LUMA.h / 1.2 > *
//!BIND TMP1_L0
//!BIND TMP1_L1
//!BIND TMP2_L1
//!SAVE TMP2_L1
//!COMPONENTS 4

#define ACTIVE(v) (v)

#define TEX_BIND_L0_TEXOFF TMP1_L0_texOff
#define TEX_BIND_L0_TEX TMP1_L0_tex
#define TEX_BIND_L0_POS TMP1_L0_pos
#define TEX_BIND_L0_SIZE TMP1_L0_size
#define TEX_BIND_L0_PT TMP1_L0_pt

#define TEX_BIND_L1_TEXOFF TMP1_L1_texOff
#define TEX_BIND_L1_TEX TMP1_L1_tex
#define TEX_BIND_L1_POS TMP1_L1_pos
#define TEX_BIND_L1_SIZE TMP1_L1_size
#define TEX_BIND_L1_PT TMP1_L1_pt

#define TEX_BIND_L2_TEXOFF TMP2_L1_texOff
#define TEX_BIND_L2_TEX TMP2_L1_tex
#define TEX_BIND_L2_POS TMP2_L1_pos
#define TEX_BIND_L2_SIZE TMP2_L1_size
#define TEX_BIND_L2_PT TMP2_L1_pt

const float kernels[288] = float[288](
  -0.1170264f, +0.1417078f, +0.4405101f, +0.1597295f, -0.1569103f, +0.0503956f, +0.4123341f, +0.1119938f,
  -0.1695892f, -0.2557568f, -0.2117316f, +0.1572314f, +0.2543039f, -0.1237621f, +0.1754771f, -0.1684480f,
  -0.2175373f, -0.0809910f, +0.0864867f, -0.0127046f, -0.4306555f, -0.3116831f, -0.2713647f, +0.0144232f,
  -0.2283032f, +0.0679632f, +0.0371618f, +0.0163761f, +0.2579684f, -0.4076751f, -0.0603772f, +0.1771949f,
  -0.9804788f, +0.0259040f, -0.5304098f, +0.1319800f, +0.6430145f, -0.7962398f, +0.3079010f, -0.1881085f,
  -0.5240692f, +0.0519693f, +0.2906224f, +0.3777653f, +0.3027830f, -0.1435784f, +0.0368577f, +0.0987219f,
  -0.0571501f, +0.0011571f, -0.0897774f, -0.0877210f, +0.0555216f, -0.1280145f, -0.0951245f, +0.3806981f,
  -0.1598406f, +0.0012481f, -0.3052154f, -0.1110731f, +0.1080474f, +0.2404765f, +0.0971872f, +0.5383244f,
  -0.1892955f, +0.0281567f, -0.0751114f, +0.0668030f, -0.0643919f, -0.0974203f, -0.0073203f, +0.3400298f,
  -0.0821292f, +0.0189075f, +0.1696901f, +0.1563439f, -0.0597874f, +0.1282753f, -0.1345633f, -0.0243746f,
  +0.0002315f, -0.1698821f, +0.1001668f, -0.1589767f, -0.1310675f, +0.0626343f, -0.3190289f, +0.2369852f,
  +0.1322209f, -0.1756501f, +0.1155949f, +0.0513323f, -0.1158240f, +0.0679797f, -0.3868322f, -0.1737601f,
  +0.0176444f, -0.2159814f, -0.2661415f, +0.0830746f, +0.1230032f, +0.2362683f, -0.3317510f, -0.0451295f,
  -0.1942604f, -0.1154377f, +0.1596647f, +0.1339191f, +0.3307526f, +0.2803741f, -0.3642406f, +0.0179916f,
  +0.2360674f, -0.1760552f, -0.0975000f, -0.2052225f, +0.1155430f, +0.0041333f, -0.0497169f, -0.2670786f,
  +0.0513840f, +0.0537941f, +0.1909102f, +0.0265628f, -0.0273361f, +0.3340675f, +0.0997310f, +0.0565253f,
  -0.0802610f, +0.0497551f, +0.2099372f, -0.1776173f, +0.2101499f, -0.3596473f, +0.1868901f, -0.3769273f,
  +0.0825790f, -0.0816816f, +0.2731467f, -0.1140042f, +0.0159814f, -0.0325654f, +0.0029852f, +0.0734665f,
  +0.1182600f, -0.0384017f, +0.1008497f, -0.1828524f, -0.1018392f, -0.0006934f, +0.0741059f, +0.0385935f,
  -0.1417068f, +0.2286684f, -0.0056666f, -0.0296402f, +0.4241269f, +0.0122738f, -0.1503140f, -0.1927427f,
  +0.0296096f, +0.0708420f, +0.0339806f, -0.1431212f, +0.1469180f, +0.0287241f, +0.2255369f, +0.2179974f,
  +0.2156343f, +0.0482566f, -0.1440729f, -0.1965827f, +0.1258011f, -0.0199975f, -0.1129098f, +0.1692300f,
  -0.8386586f, -0.1220258f, +0.5470359f, -0.0217378f, +0.7698365f, +0.6509754f, +0.6149972f, +0.3620557f,
  -0.2926506f, +0.0605671f, -0.0930523f, -0.0762657f, -0.0534894f, -0.2636429f, -0.3282665f, -0.4686057f,
  +0.1544625f, -0.0263883f, -0.0063530f, +0.0238239f, -0.2526749f, -0.1339746f, +0.0908582f, +0.1169712f,
  +0.1168207f, +0.3374976f, -0.0818930f, +0.2307054f, -0.3414196f, -0.2971800f, -0.1165825f, -0.1490940f,
  +0.2156058f, +0.0964699f, -0.0304749f, +0.2024011f, -0.0504359f, -0.2226902f, -0.0462167f, -0.1542189f,
  -0.1244697f, +0.1914612f, +0.1092072f, +0.0856558f, +0.0327608f, +0.0360601f, +0.1733035f, +0.0746904f,
  +0.1088735f, -0.1291858f, -0.0412488f, -0.4726636f, -0.1909671f, -0.0839916f, +0.1123444f, +0.0096311f,
  +0.0274828f, -0.1450068f, -0.0316142f, -0.0016434f, -0.4029524f, -0.0553743f, -0.2902781f, -0.3430799f,
  -0.0981446f, +0.1167057f, +0.1370404f, +0.0759827f, +0.2153418f, -0.7733162f, +0.6692433f, +0.0876168f,
  -0.0442506f, -0.0505945f, -0.1191074f, -0.2557822f, +0.5072667f, +0.3670640f, +0.9546178f, -0.1070599f,
  +0.2384401f, +0.0691285f, -0.1487288f, -0.0075185f, -0.0010363f, -0.0468314f, -0.1771996f, -0.0297267f,
  -0.0653002f, -0.0758121f, -0.1643665f, -0.0374161f, +0.3031408f, -0.5469754f, -0.0665912f, +0.3677826f,
  +0.1232062f, -0.3069364f, -0.1278619f, +0.1184093f, -0.1528552f, +0.2405417f, -0.1676596f, +0.3950291f,
  +0.2133508f, -0.0529885f, +0.0575741f, +0.0955807f, +0.1944808f, -0.1119790f, -0.0021322f, +0.3114784f
);

const float biases[4] = float[4](
  -0.0991339f, -0.0372856f, +0.0379319f, +0.0257896f
);

vec4 hook() {
    const vec4 r[9][2] = vec4[9][2](
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 1.0f)))
    );

    float sum[4] = biases;
    for (int n = 0; n < 4; n++) {
        for (int i = 0; i < 9; i++) {
            const vec4 k0 = vec4(kernels[n * 8 * 9 + 8 * i + 0], kernels[n * 8 * 9 + 8 * i + 1], kernels[n * 8 * 9 + 8 * i + 2], kernels[n * 8 * 9 + 8 * i + 3]);
            const vec4 k1 = vec4(kernels[n * 8 * 9 + 8 * i + 4], kernels[n * 8 * 9 + 8 * i + 5], kernels[n * 8 * 9 + 8 * i + 6], kernels[n * 8 * 9 + 8 * i + 7]);
            sum[n] += (dot(k0, r[i][0]) + dot(k1, r[i][1]));
        }
    }

    return ACTIVE(vec4(sum[0], sum[1], sum[2], sum[3]) * 0.2000000f + TEX_BIND_L2_TEXOFF(vec2(0.0f, 0.0f)));
}

//!HOOK LUMA
//!DESC ARNet b16 Layer25 L0
//!WHEN OUTPUT.w LUMA.w / 1.2 > OUTPUT.h LUMA.h / 1.2 > *
//!BIND TMP2_L0
//!BIND TMP2_L1
//!SAVE TMP1_L0
//!COMPONENTS 4

#define ACTIVE(v) (max(v, v * 0.2000000f))

#define TEX_BIND_L0_TEXOFF TMP2_L0_texOff
#define TEX_BIND_L0_TEX TMP2_L0_tex
#define TEX_BIND_L0_POS TMP2_L0_pos
#define TEX_BIND_L0_SIZE TMP2_L0_size
#define TEX_BIND_L0_PT TMP2_L0_pt

#define TEX_BIND_L1_TEXOFF TMP2_L1_texOff
#define TEX_BIND_L1_TEX TMP2_L1_tex
#define TEX_BIND_L1_POS TMP2_L1_pos
#define TEX_BIND_L1_SIZE TMP2_L1_size
#define TEX_BIND_L1_PT TMP2_L1_pt

const float kernels[288] = float[288](
  -0.2931885f, +0.0816435f, +0.3014037f, -0.1451150f, -0.1150615f, -0.1186088f, -0.1665988f, -0.0122488f,
  +0.0552277f, +0.2833061f, +0.5308967f, -0.1142705f, -0.2400067f, -0.3998511f, -0.1550719f, +0.4598710f,
  +0.0941418f, -0.2585809f, -0.1180845f, +0.2802015f, +0.0860006f, -0.2141042f, -0.4205601f, -0.1103094f,
  +0.0293138f, -0.1516078f, -0.3252575f, -0.1442761f, +0.2661456f, -0.3048972f, +0.0171525f, -0.2438402f,
  -0.1325412f, +0.0543985f, -0.8303614f, -0.5452181f, -0.2715384f, +0.1359429f, -0.2659029f, -0.2595981f,
  -0.4444113f, +0.5579977f, +0.0067795f, -0.2572290f, +0.2762324f, +0.0689318f, +0.3548324f, -0.3949870f,
  +0.1977331f, +0.0068301f, +0.0436143f, +0.1789424f, +0.1207455f, +0.0978700f, -0.0646888f, +0.0853883f,
  +0.2182069f, -0.2659845f, -0.0233410f, +0.2805724f, +0.0166727f, +0.1336553f, -0.1083467f, +0.0917151f,
  +0.1501713f, -0.2738799f, -0.1719426f, +0.2817493f, -0.0851869f, +0.0724769f, -0.0279022f, -0.0733919f,
  +0.1762643f, -0.1791904f, +0.2184756f, -0.0789997f, +0.3289398f, -0.0397376f, -0.0814980f, -0.0100734f,
  -0.1514050f, +0.3078132f, +0.0969797f, -0.0239469f, -0.3078996f, -0.1343925f, +0.3441424f, +0.6364857f,
  +0.1136354f, -0.3489076f, -0.1292184f, +0.2181676f, +0.0770676f, +0.3459533f, -0.5937691f, -0.3029183f,
  +0.6321461f, -0.2098500f, +0.2278972f, -0.0537234f, +0.2724108f, -0.0996453f, -0.1003418f, -0.0405254f,
  -0.5682305f, +0.1728933f, +0.4385868f, -0.4406601f, -0.2079660f, -0.0774882f, +0.5408524f, +0.3047648f,
  -0.2324177f, +0.1625852f, -0.0319633f, +0.0018637f, +0.3278114f, +0.4806156f, -0.0626518f, -0.0593218f,
  +0.2810299f, +0.0574703f, +0.0051588f, +0.0773756f, -0.1489915f, -0.0047609f, +0.2325797f, +0.0232382f,
  -0.1132384f, +0.1494034f, +0.0962506f, -0.0876793f, -0.0294275f, -0.0778863f, -0.2155806f, +0.0803775f,
  -0.2046352f, +0.0587870f, +0.0304311f, -0.0547471f, -0.0208274f, +0.1231837f, +0.2359540f, -0.2050587f,
  -0.0086717f, +0.2327229f, +0.1661089f, -0.2293970f, -0.0434151f, -0.0719239f, -0.0286937f, +0.0403713f,
  -0.1136731f, +0.2423965f, +0.0688883f, +0.0000057f, +0.0071211f, -0.1526415f, +0.1837968f, +0.0395096f,
  +0.0941684f, +0.1482875f, +0.0241028f, +0.0028571f, -0.0470761f, -0.1582716f, -0.0053683f, -0.0807264f,
  -0.4229739f, -0.1538396f, +0.4297219f, +0.3241901f, -0.3185256f, -0.2997430f, +0.1113021f, -0.0022864f,
  +0.2212799f, -0.3956129f, +0.1229285f, +0.1278319f, -0.3732613f, -0.0075781f, -0.1523753f, +0.2883475f,
  +0.2158860f, -0.0018119f, +0.1092389f, +0.0010486f, -0.2005668f, -0.1029945f, -0.0821025f, +0.2781622f,
  -0.1762339f, +0.3121889f, -0.0301137f, -0.3925439f, -0.1324277f, -0.1616522f, +0.6468862f, +0.1513170f,
  +0.1514165f, +0.1037860f, -0.0201194f, +0.0155319f, +0.0667032f, -0.1856703f, +0.0047793f, -0.0714617f,
  +0.1747908f, +0.0921966f, -0.0850448f, +0.1169624f, -0.0067110f, -0.0947847f, +0.0893803f, +0.1895505f,
  -0.1796204f, -0.2810668f, +0.0419346f, +0.1294068f, -0.1119997f, +0.2138124f, +0.0296382f, -0.1453281f,
  -0.0658248f, -0.1287722f, -0.0818154f, +0.1909118f, -0.4776802f, +0.5297458f, -0.0550705f, +0.0797718f,
  -0.1971730f, -0.3196862f, -0.0198264f, -0.0553081f, -0.0345136f, +0.5802457f, -0.1776581f, -0.1969237f,
  -0.0944884f, -0.0181534f, +0.2475040f, -0.2372833f, +0.3958237f, -0.4035977f, -0.1223519f, -0.0051757f,
  -0.4376352f, +0.5876693f, +0.2732055f, +0.2485081f, -0.4246986f, -0.0546027f, +0.4733842f, +0.6509728f,
  +0.0782075f, -0.5488813f, -0.0906840f, +0.3318460f, +0.0653246f, +0.4603620f, -0.2828391f, -0.2249836f,
  +0.1192949f, -0.2234402f, +0.3102358f, -0.0605026f, -0.1797354f, -0.2244121f, -0.2513940f, -0.2995997f,
  -0.1552795f, +0.2420905f, +0.2998212f, -0.4854974f, -0.5480046f, -0.1174948f, -0.1801414f, +0.0527934f,
  -0.1662353f, -0.0937945f, +0.4088078f, -0.1738286f, +0.1141742f, +0.2416415f, +0.2325439f, -0.1554136f
);

const float biases[4] = float[4](
  +0.0236365f, +0.0206338f, -0.0983276f, +0.0640739f
);

vec4 hook() {
    const vec4 r[9][2] = vec4[9][2](
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 1.0f)))
    );

    float sum[4] = biases;
    for (int n = 0; n < 4; n++) {
        for (int i = 0; i < 9; i++) {
            const vec4 k0 = vec4(kernels[n * 8 * 9 + 8 * i + 0], kernels[n * 8 * 9 + 8 * i + 1], kernels[n * 8 * 9 + 8 * i + 2], kernels[n * 8 * 9 + 8 * i + 3]);
            const vec4 k1 = vec4(kernels[n * 8 * 9 + 8 * i + 4], kernels[n * 8 * 9 + 8 * i + 5], kernels[n * 8 * 9 + 8 * i + 6], kernels[n * 8 * 9 + 8 * i + 7]);
            sum[n] += (dot(k0, r[i][0]) + dot(k1, r[i][1]));
        }
    }

    return ACTIVE(vec4(sum[0], sum[1], sum[2], sum[3]));
}

//!HOOK LUMA
//!DESC ARNet b16 Layer25 L1
//!WHEN OUTPUT.w LUMA.w / 1.2 > OUTPUT.h LUMA.h / 1.2 > *
//!BIND TMP2_L0
//!BIND TMP2_L1
//!SAVE TMP1_L1
//!COMPONENTS 4

#define ACTIVE(v) (max(v, v * 0.2000000f))

#define TEX_BIND_L0_TEXOFF TMP2_L0_texOff
#define TEX_BIND_L0_TEX TMP2_L0_tex
#define TEX_BIND_L0_POS TMP2_L0_pos
#define TEX_BIND_L0_SIZE TMP2_L0_size
#define TEX_BIND_L0_PT TMP2_L0_pt

#define TEX_BIND_L1_TEXOFF TMP2_L1_texOff
#define TEX_BIND_L1_TEX TMP2_L1_tex
#define TEX_BIND_L1_POS TMP2_L1_pos
#define TEX_BIND_L1_SIZE TMP2_L1_size
#define TEX_BIND_L1_PT TMP2_L1_pt

const float kernels[288] = float[288](
  -0.0605249f, -0.0737681f, -0.2204454f, +0.1853300f, -0.1779560f, +0.1933243f, +0.1451081f, +0.0458021f,
  -0.2430165f, +0.0475050f, +0.0763201f, -0.0492987f, -0.0651969f, +0.1005218f, -0.2145806f, -0.3114665f,
  +0.0622339f, -0.1120041f, -0.0529673f, +0.0114907f, -0.0146919f, +0.0018967f, -0.0719721f, +0.0312452f,
  -0.0730256f, +0.4494570f, -0.0029117f, +0.0988081f, -0.0412800f, +0.2972407f, +0.0873530f, +0.0983975f,
  -0.1933808f, +0.1897548f, +0.0375913f, -0.1035997f, -0.3388708f, +0.0053288f, -0.4642353f, -0.7422708f,
  +0.0379233f, -0.0844554f, -0.1521182f, +0.0619984f, +0.0260534f, -0.0135383f, -0.0774562f, +0.0251872f,
  -0.2703528f, +0.2136906f, +0.0299903f, -0.0934451f, +0.3122928f, -0.1961920f, +0.0076630f, -0.2321772f,
  -0.1901107f, +0.0539453f, -0.1460735f, -0.5557852f, +0.2966093f, -0.1031215f, -0.0053906f, +0.1495133f,
  -0.3431363f, +0.0193883f, +0.1204136f, -0.1764865f, +0.1153543f, -0.0062577f, +0.0059979f, -0.2790942f,
  -0.2721626f, -0.0342519f, -0.1257005f, +0.0574332f, -0.1301871f, +0.2718218f, +0.1042968f, -0.0862234f,
  +0.0573962f, -0.0249420f, -0.2590640f, +0.4318404f, -0.7858590f, +0.4478875f, +0.0900689f, +0.2780489f,
  +0.3527102f, -0.0143793f, -0.1900301f, -0.1528028f, +0.0064610f, +0.3775583f, -0.3648877f, -0.1983889f,
  -0.1868862f, +0.2100559f, -0.0669003f, +0.1018205f, +0.0026009f, +0.1802419f, +0.2287331f, +0.0978634f,
  +0.1248715f, +0.3780546f, +0.6900954f, +0.5908649f, -0.1863270f, +0.5202103f, +0.3858448f, +0.2955329f,
  +0.2576463f, -0.2809967f, +0.0632062f, +0.3106289f, -0.6494706f, +0.3126722f, -0.1866349f, -0.0258777f,
  -0.0391941f, +0.0658318f, +0.0115002f, -0.0363456f, +0.0624402f, +0.0656243f, +0.0053029f, -0.0261927f,
  +0.0039183f, -0.0654364f, +0.2777396f, +0.0274545f, -0.2479657f, +0.2314230f, -0.0975034f, +0.1572375f,
  +0.0477200f, -0.2716968f, +0.2597904f, -0.0282058f, -0.0993077f, +0.0777510f, +0.0512360f, -0.0925539f,
  +0.2509966f, +0.1830417f, +0.0893031f, -0.1827909f, +0.0758869f, -0.1517901f, -0.0586435f, +0.1149128f,
  -0.2661839f, +0.0344456f, +0.0166200f, +0.0190840f, +0.3256827f, -0.0134872f, +0.0525142f, -0.1414005f,
  -0.2209649f, -0.2579523f, -0.0095929f, +0.2247609f, +0.2027153f, -0.1155412f, -0.4080160f, -0.4016018f,
  +0.1463512f, -0.1056061f, +0.2641796f, +0.0539022f, -0.4143474f, -0.0467377f, -0.1352295f, +0.0817675f,
  -0.0227479f, -0.3314552f, -0.4947558f, +0.0136796f, +0.8380576f, -0.1257302f, +0.8556817f, -0.4092508f,
  -0.1592561f, +0.2310042f, +0.2562435f, -0.2368350f, +0.2091112f, +0.1554506f, +0.0601092f, +0.0745846f,
  -0.2067577f, +0.1027670f, -0.1396310f, +0.0136696f, -0.1016022f, -0.0321018f, +0.1295205f, -0.0042649f,
  +0.0470899f, +0.1955019f, -0.0336576f, +0.1834911f, +0.0740053f, +0.1039115f, +0.0527059f, +0.0625645f,
  +0.1940843f, +0.1560816f, -0.0935830f, +0.0955615f, -0.1254174f, +0.1517171f, +0.1581157f, +0.2529953f,
  -0.1527421f, -0.1480675f, +0.3819546f, -0.2407389f, +0.1645103f, -0.1983108f, -0.2254324f, -0.2035707f,
  +0.0284924f, -0.0693414f, +0.2195825f, +0.1860508f, -0.0332421f, -0.6932633f, +0.3396521f, +0.5587736f,
  -0.1227996f, -0.1365020f, +0.0401173f, +0.1522458f, -0.2213005f, +0.0358178f, +0.3899828f, +0.1166694f,
  -0.3797112f, +0.1760247f, -0.4869820f, +0.0156865f, -0.3587116f, -0.1616316f, +0.2518947f, +0.1161197f,
  -0.4122922f, +0.7257912f, -0.2959151f, -0.2315923f, +0.4458728f, +0.1042440f, +0.4485311f, -0.6329305f,
  +0.0547211f, -0.2246794f, -0.0963839f, +0.0141891f, +0.4147946f, +0.2403283f, -0.0764343f, -0.2865280f,
  +0.1740443f, +0.0621421f, +0.4239275f, +0.2238009f, +0.3658396f, +0.2170245f, +0.2618824f, -0.0451820f,
  +0.5339879f, -0.1528879f, +0.4419768f, +0.4250801f, +0.3129462f, +0.4621275f, +0.1532131f, -0.0817658f,
  +0.1150407f, -0.3216359f, +0.0046145f, -0.0210954f, -0.0378192f, +0.3316050f, -0.0492532f, +0.0752170f
);

const float biases[4] = float[4](
  +0.0107770f, -0.1510156f, +0.0538830f, -0.0840866f
);

vec4 hook() {
    const vec4 r[9][2] = vec4[9][2](
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 1.0f)))
    );

    float sum[4] = biases;
    for (int n = 0; n < 4; n++) {
        for (int i = 0; i < 9; i++) {
            const vec4 k0 = vec4(kernels[n * 8 * 9 + 8 * i + 0], kernels[n * 8 * 9 + 8 * i + 1], kernels[n * 8 * 9 + 8 * i + 2], kernels[n * 8 * 9 + 8 * i + 3]);
            const vec4 k1 = vec4(kernels[n * 8 * 9 + 8 * i + 4], kernels[n * 8 * 9 + 8 * i + 5], kernels[n * 8 * 9 + 8 * i + 6], kernels[n * 8 * 9 + 8 * i + 7]);
            sum[n] += (dot(k0, r[i][0]) + dot(k1, r[i][1]));
        }
    }

    return ACTIVE(vec4(sum[0], sum[1], sum[2], sum[3]));
}

//!HOOK LUMA
//!DESC ARNet b16 Layer26 L0
//!WHEN OUTPUT.w LUMA.w / 1.2 > OUTPUT.h LUMA.h / 1.2 > *
//!BIND TMP1_L0
//!BIND TMP1_L1
//!BIND TMP2_L0
//!SAVE TMP2_L0
//!COMPONENTS 4

#define ACTIVE(v) (v)

#define TEX_BIND_L0_TEXOFF TMP1_L0_texOff
#define TEX_BIND_L0_TEX TMP1_L0_tex
#define TEX_BIND_L0_POS TMP1_L0_pos
#define TEX_BIND_L0_SIZE TMP1_L0_size
#define TEX_BIND_L0_PT TMP1_L0_pt

#define TEX_BIND_L1_TEXOFF TMP1_L1_texOff
#define TEX_BIND_L1_TEX TMP1_L1_tex
#define TEX_BIND_L1_POS TMP1_L1_pos
#define TEX_BIND_L1_SIZE TMP1_L1_size
#define TEX_BIND_L1_PT TMP1_L1_pt

#define TEX_BIND_L2_TEXOFF TMP2_L0_texOff
#define TEX_BIND_L2_TEX TMP2_L0_tex
#define TEX_BIND_L2_POS TMP2_L0_pos
#define TEX_BIND_L2_SIZE TMP2_L0_size
#define TEX_BIND_L2_PT TMP2_L0_pt

const float kernels[288] = float[288](
  -0.0075296f, -0.0164849f, -0.1640154f, +0.1855502f, +0.0456141f, +0.1899998f, +0.0789606f, -0.4219351f,
  +0.0146344f, +0.1932263f, -0.4318834f, +0.1885482f, -0.2881352f, +0.0065902f, -0.0656908f, +0.3732640f,
  -0.0029717f, +0.1469264f, +0.1073066f, +0.0263017f, -0.0202884f, +0.0166768f, +0.0244844f, -0.2153385f,
  -0.1931430f, +0.3747658f, -0.0190934f, +0.2125898f, -0.0101679f, -0.4858274f, +0.1000139f, +0.1902168f,
  +0.2362401f, +0.3405026f, +0.0539452f, -0.1768744f, +0.2423801f, -0.0742258f, +0.1868371f, -1.1856596f,
  -0.0704983f, +0.1099688f, +0.6443316f, +0.0297586f, +0.1195859f, +0.0419129f, -0.2226865f, +0.0783403f,
  -0.0118685f, +0.0930452f, +0.0879578f, +0.1145765f, -0.1170997f, -0.2363552f, +0.2836458f, +0.1321937f,
  +0.2750124f, -0.1939980f, -0.0429748f, +0.3218893f, -0.0212302f, +0.0535665f, +0.3025901f, +0.1522914f,
  +0.0838040f, -0.2043450f, -0.0578745f, +0.1818640f, -0.0124966f, +0.0297829f, -0.0209814f, +0.1731876f,
  -0.0437097f, -0.1165498f, -0.1627548f, -0.2352314f, -0.0029941f, +0.2366546f, -0.0295591f, -0.0229572f,
  +0.1225141f, +0.0586912f, -0.0718355f, +0.3185607f, -0.0352280f, +0.1479165f, -0.0543817f, +0.2139903f,
  -0.1316977f, +0.0504169f, -0.3731448f, -0.4121419f, -0.1197921f, -0.1695031f, -0.0697578f, -0.0937993f,
  -0.3776101f, -0.0149167f, +0.0649325f, -0.3937531f, -0.0089073f, +0.0584095f, -0.1340339f, +0.6608868f,
  -0.1640646f, +0.2365966f, +0.2706842f, +0.1968974f, +0.0393864f, -0.2844885f, +0.1025600f, -0.1771370f,
  +0.2075656f, +0.1261646f, +0.4402356f, -0.1822093f, -0.5726271f, -0.0295711f, +0.1782487f, -0.0891297f,
  -0.2379857f, +0.0527357f, +0.1883781f, -0.1280458f, -0.1543281f, +0.1208921f, +0.0704242f, +0.3488878f,
  -0.4899636f, -0.1170470f, +0.0168538f, -0.2100972f, +0.1449389f, +0.1523480f, -0.2053344f, -0.1360975f,
  -0.0208449f, +0.2145271f, +0.0459019f, -0.1532065f, +0.0209348f, -0.0170096f, +0.0295848f, -0.1233340f,
  +0.0386915f, +0.0394180f, +0.1061570f, +0.1834576f, -0.0888658f, -0.0330469f, -0.0244182f, -0.1394025f,
  +0.0053647f, -0.0158765f, -0.1574620f, -0.3100367f, -0.4771725f, -0.0245196f, -0.2289773f, +0.1784055f,
  +0.0016421f, -0.1769240f, -0.4213473f, +0.3276980f, -0.2045087f, -0.0409019f, +0.2509556f, -0.3176951f,
  -0.1271668f, -0.0211001f, +0.1114894f, +0.1672123f, -0.0159252f, -0.3912142f, +0.1861073f, -0.1802315f,
  +0.8339694f, -0.8511921f, -0.4333099f, -0.0251982f, -0.0736075f, -0.4479892f, +0.0766259f, -0.9552088f,
  +0.0491320f, -0.0018823f, +0.1079413f, +0.4290735f, +0.0286456f, -0.0380797f, -0.3184036f, -0.5114731f,
  +0.0997149f, +0.0584150f, +0.0119162f, +0.0174039f, +0.0449570f, +0.1675851f, +0.1528804f, +0.0473218f,
  -0.4106566f, -0.2253744f, +0.0044512f, -0.1940148f, -0.1922558f, +0.3765627f, -0.0275579f, -0.0676962f,
  -0.0579526f, +0.0367904f, +0.0680739f, -0.0498242f, +0.0846988f, +0.0955702f, -0.0268111f, +0.1056676f,
  -0.1296643f, -0.0554484f, +0.0137054f, -0.0829750f, +0.1188070f, +0.0043439f, +0.0898243f, +0.0428390f,
  +0.0462281f, +0.1241890f, -0.0657300f, +0.2461237f, +0.0942355f, -0.1367709f, -0.0436568f, +0.4121960f,
  -0.1144108f, -0.0276760f, +0.0344165f, +0.1146177f, +0.0331095f, -0.1244857f, +0.1649221f, -0.2547076f,
  +0.2202474f, +0.1010123f, +0.1308830f, +0.0513775f, -0.0095217f, -0.1026106f, +0.1322817f, -0.0126797f,
  +0.4562014f, +0.0718980f, +0.1000375f, -0.0369514f, +0.2371044f, -0.5832555f, -0.4545367f, -0.8231093f,
  +0.2149562f, -0.1420419f, -0.2337956f, -0.0700073f, -0.2689328f, -0.0022048f, -0.4456863f, -0.1594132f,
  -0.3098552f, +0.4458823f, +0.0029498f, +0.0471530f, +0.0458186f, -0.2634339f, -0.1858455f, +0.2352115f,
  -0.1408540f, +0.0963518f, -0.0846729f, +0.1495114f, -0.0506569f, -0.0834617f, -0.4335855f, +0.0819744f,
  -0.2135473f, -0.0684420f, -0.0356495f, -0.0112614f, -0.1464988f, -0.0202299f, +0.0234697f, +0.2204731f
);

const float biases[4] = float[4](
  -0.0556650f, +0.0817662f, -0.0149306f, -0.0506125f
);

vec4 hook() {
    const vec4 r[9][2] = vec4[9][2](
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 1.0f)))
    );

    float sum[4] = biases;
    for (int n = 0; n < 4; n++) {
        for (int i = 0; i < 9; i++) {
            const vec4 k0 = vec4(kernels[n * 8 * 9 + 8 * i + 0], kernels[n * 8 * 9 + 8 * i + 1], kernels[n * 8 * 9 + 8 * i + 2], kernels[n * 8 * 9 + 8 * i + 3]);
            const vec4 k1 = vec4(kernels[n * 8 * 9 + 8 * i + 4], kernels[n * 8 * 9 + 8 * i + 5], kernels[n * 8 * 9 + 8 * i + 6], kernels[n * 8 * 9 + 8 * i + 7]);
            sum[n] += (dot(k0, r[i][0]) + dot(k1, r[i][1]));
        }
    }

    return ACTIVE(vec4(sum[0], sum[1], sum[2], sum[3]) * 0.2000000f + TEX_BIND_L2_TEXOFF(vec2(0.0f, 0.0f)));
}

//!HOOK LUMA
//!DESC ARNet b16 Layer26 L1
//!WHEN OUTPUT.w LUMA.w / 1.2 > OUTPUT.h LUMA.h / 1.2 > *
//!BIND TMP1_L0
//!BIND TMP1_L1
//!BIND TMP2_L1
//!SAVE TMP2_L1
//!COMPONENTS 4

#define ACTIVE(v) (v)

#define TEX_BIND_L0_TEXOFF TMP1_L0_texOff
#define TEX_BIND_L0_TEX TMP1_L0_tex
#define TEX_BIND_L0_POS TMP1_L0_pos
#define TEX_BIND_L0_SIZE TMP1_L0_size
#define TEX_BIND_L0_PT TMP1_L0_pt

#define TEX_BIND_L1_TEXOFF TMP1_L1_texOff
#define TEX_BIND_L1_TEX TMP1_L1_tex
#define TEX_BIND_L1_POS TMP1_L1_pos
#define TEX_BIND_L1_SIZE TMP1_L1_size
#define TEX_BIND_L1_PT TMP1_L1_pt

#define TEX_BIND_L2_TEXOFF TMP2_L1_texOff
#define TEX_BIND_L2_TEX TMP2_L1_tex
#define TEX_BIND_L2_POS TMP2_L1_pos
#define TEX_BIND_L2_SIZE TMP2_L1_size
#define TEX_BIND_L2_PT TMP2_L1_pt

const float kernels[288] = float[288](
  +0.0903105f, -0.1893686f, +0.0338613f, +0.2029255f, -0.2617071f, -0.0894069f, +0.1055210f, +0.1610129f,
  +0.0476720f, -0.2068687f, -0.2393829f, +0.1353927f, -0.3352865f, -0.1797986f, -0.1198417f, -0.3686025f,
  -0.1077132f, -0.0579743f, +0.3448592f, +0.0855139f, -0.4341950f, -0.1369289f, -0.0179123f, -0.2753952f,
  +0.2307661f, -0.3863457f, +0.0073158f, +0.3154152f, +0.0311525f, +0.2865505f, -0.1022514f, -0.2782595f,
  +0.3508543f, -0.3810028f, -0.1481437f, +0.1250397f, +0.2652242f, -0.1008360f, -0.4598543f, -0.6468633f,
  -0.1571875f, -0.0634226f, +0.3286900f, +0.1294646f, +0.0628581f, +0.0305569f, +0.3256935f, +0.0039042f,
  -0.1326964f, -0.1241612f, -0.0661096f, +0.0499395f, -0.1554176f, +0.1326786f, +0.0508986f, -0.0055697f,
  -0.1010661f, -0.0309026f, +0.1052975f, +0.0061589f, -0.1407104f, +0.3998530f, -0.1681506f, +0.1972840f,
  -0.0003460f, +0.0013289f, -0.2086412f, -0.0668380f, -0.0347881f, +0.1102537f, -0.1178610f, +0.1092387f,
  +0.1186127f, -0.0318460f, +0.1186501f, +0.0190483f, -0.2289442f, +0.0702878f, +0.0638539f, +0.0363421f,
  +0.1072594f, -0.1475433f, +0.0076272f, -0.0039759f, +0.0087593f, +0.0401999f, -0.0818964f, -0.0316926f,
  -0.0087218f, -0.1372122f, -0.1186072f, +0.1171177f, -0.0380667f, -0.1548657f, -0.0939905f, +0.1293122f,
  -0.0975113f, -0.2867240f, -0.0293086f, +0.1092266f, -0.1826110f, +0.0070042f, +0.1628014f, +0.0088060f,
  -0.0364908f, -0.4038027f, -0.4390433f, -0.2183485f, -0.0143212f, -0.1412999f, +0.1464143f, +0.3299726f,
  +0.1298186f, +0.0979507f, +0.1700055f, -0.0958783f, -0.1034462f, +0.0828851f, -0.1790736f, -0.1543349f,
  +0.0870514f, +0.1208912f, +0.2260008f, +0.2736380f, -0.3098602f, -0.3656423f, +0.3240317f, +0.2775149f,
  +0.2462513f, -0.0043109f, +0.0392067f, +0.1676715f, +0.2737733f, -0.4501760f, -0.0043608f, -0.1518939f,
  -0.0390530f, -0.0179648f, +0.1384492f, +0.0195900f, -0.0633940f, +0.0861652f, +0.1217414f, +0.0914569f,
  -0.0867255f, +0.1772321f, +0.0634514f, +0.3228974f, -0.0609324f, -0.2089390f, -0.1607293f, -0.1243548f,
  -0.0191833f, +0.2226206f, -0.1846657f, -0.0212198f, +0.0468357f, -0.0306663f, -0.2055939f, -0.4169877f,
  +0.0153618f, +0.0532264f, -0.2980962f, +0.2419726f, -0.0725040f, -0.1034325f, -0.0487491f, -0.0447755f,
  -0.2946089f, +0.2362300f, -0.0558296f, -0.3085932f, -0.0650872f, -0.0832693f, +0.0798513f, -0.0201389f,
  +0.3864217f, -0.5476504f, -0.0599740f, +0.9985583f, +0.1008651f, -0.3969190f, -0.3916528f, -0.1090817f,
  +0.0686697f, -0.1079161f, -0.0167176f, -0.0077408f, +0.1442168f, -0.1673491f, -0.2884339f, +0.1559146f,
  +0.3313067f, +0.3363466f, -0.1457117f, +0.1267690f, +0.1477828f, -0.0865076f, +0.0355421f, -0.1567751f,
  +0.2718043f, -0.0452077f, -0.1498031f, +0.3808157f, +0.0417393f, -0.2895773f, +0.0958206f, +0.2757549f,
  +0.1127520f, -0.1508769f, -0.0196797f, +0.1529622f, -0.0522045f, -0.0517938f, -0.0429185f, +0.0663381f,
  +0.1120209f, -0.0115075f, +0.0841599f, -0.0956632f, +0.0590620f, +0.2163306f, +0.1192755f, +0.2651075f,
  +0.0132677f, -0.0194432f, +0.1970284f, -0.0577374f, +0.0471098f, -0.1063949f, -0.1261501f, +0.0072013f,
  +0.0056285f, +0.0824247f, +0.3366525f, -0.1198592f, +0.0281398f, +0.0729704f, -0.0425932f, +0.1536386f,
  +0.4886817f, -0.6872641f, +0.0399096f, +0.3330219f, +0.0751401f, +0.0762158f, +0.0773345f, -0.3974317f,
  +0.4297223f, -0.1660641f, -0.2683922f, +0.7107266f, +1.1671797f, -0.1594354f, +0.6997910f, -0.8397405f,
  +0.0286547f, -0.1600556f, +0.4377783f, +0.1551846f, -0.0064925f, -0.0195778f, +0.1675075f, -0.1499165f,
  +0.1884146f, -0.0876437f, -0.1437699f, -0.2347233f, +0.1259272f, +0.5280725f, +0.2214222f, -0.3162750f,
  -0.3722623f, -0.1166115f, +0.0049762f, -0.1980925f, -0.0736140f, +0.2311938f, +0.1822565f, +0.2311103f,
  -0.1039005f, +0.1294136f, -0.1909832f, -0.0182861f, +0.0049812f, +0.0682628f, -0.1130178f, -0.1888306f
);

const float biases[4] = float[4](
  -0.0504518f, +0.0186486f, -0.0913090f, -0.0311233f
);

vec4 hook() {
    const vec4 r[9][2] = vec4[9][2](
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 1.0f)))
    );

    float sum[4] = biases;
    for (int n = 0; n < 4; n++) {
        for (int i = 0; i < 9; i++) {
            const vec4 k0 = vec4(kernels[n * 8 * 9 + 8 * i + 0], kernels[n * 8 * 9 + 8 * i + 1], kernels[n * 8 * 9 + 8 * i + 2], kernels[n * 8 * 9 + 8 * i + 3]);
            const vec4 k1 = vec4(kernels[n * 8 * 9 + 8 * i + 4], kernels[n * 8 * 9 + 8 * i + 5], kernels[n * 8 * 9 + 8 * i + 6], kernels[n * 8 * 9 + 8 * i + 7]);
            sum[n] += (dot(k0, r[i][0]) + dot(k1, r[i][1]));
        }
    }

    return ACTIVE(vec4(sum[0], sum[1], sum[2], sum[3]) * 0.2000000f + TEX_BIND_L2_TEXOFF(vec2(0.0f, 0.0f)));
}

//!HOOK LUMA
//!DESC ARNet b16 Layer27 L0
//!WHEN OUTPUT.w LUMA.w / 1.2 > OUTPUT.h LUMA.h / 1.2 > *
//!BIND TMP2_L0
//!BIND TMP2_L1
//!SAVE TMP1_L0
//!COMPONENTS 4

#define ACTIVE(v) (max(v, v * 0.2000000f))

#define TEX_BIND_L0_TEXOFF TMP2_L0_texOff
#define TEX_BIND_L0_TEX TMP2_L0_tex
#define TEX_BIND_L0_POS TMP2_L0_pos
#define TEX_BIND_L0_SIZE TMP2_L0_size
#define TEX_BIND_L0_PT TMP2_L0_pt

#define TEX_BIND_L1_TEXOFF TMP2_L1_texOff
#define TEX_BIND_L1_TEX TMP2_L1_tex
#define TEX_BIND_L1_POS TMP2_L1_pos
#define TEX_BIND_L1_SIZE TMP2_L1_size
#define TEX_BIND_L1_PT TMP2_L1_pt

const float kernels[288] = float[288](
  -0.1256560f, -0.3267313f, -0.3098155f, +0.3473103f, -0.0584117f, +0.5193886f, +0.2780306f, -0.1056532f,
  -0.5438129f, -0.5111239f, +0.4962771f, +0.5893883f, -0.6199037f, -0.1321615f, -0.3254571f, +0.2794827f,
  +0.3522774f, -0.1202162f, +0.0454623f, -0.0247379f, +0.0714204f, +0.4003035f, -0.0018128f, -0.1006337f,
  +0.1618395f, +0.2999112f, -0.1925743f, -0.0771590f, -0.0050431f, +0.1350366f, +0.2168272f, +0.3870191f,
  -0.2164429f, +0.5918431f, +1.0408753f, -0.1925182f, -0.6971301f, -0.2012235f, +1.0688713f, +0.4023683f,
  +0.0023252f, -0.0860350f, -0.1170866f, +0.0727664f, -0.0819971f, +0.3175340f, -0.0840052f, -0.0337595f,
  +0.1309038f, -0.0359894f, +0.0897692f, +0.0042029f, +0.2406531f, -0.1604413f, +0.0639218f, -0.2267683f,
  +0.1219363f, -0.0824541f, +0.1993475f, +0.0127375f, +0.1195864f, -0.1399713f, -0.2050305f, +0.1219063f,
  -0.0608859f, -0.0489801f, +0.0064278f, -0.0604018f, +0.2794925f, +0.0690418f, +0.0332368f, -0.2751578f,
  -0.1812832f, -0.1579371f, +0.1926434f, +0.1497039f, +0.1181114f, -0.0279308f, -0.3171559f, -0.1737784f,
  -0.2683697f, -0.3783815f, -0.2967881f, -0.0362400f, -0.5343949f, +0.3232884f, +0.0070796f, +0.4223256f,
  -0.3026497f, -0.3795342f, -0.3563168f, +0.2757597f, -0.1031856f, +0.0036799f, -0.2800615f, -0.0608700f,
  -0.5626200f, +0.4065130f, -0.3422274f, +0.1855703f, -0.4823676f, +0.2263884f, +0.1440474f, +0.1851058f,
  -0.7071835f, +1.4698274f, +0.6140259f, +0.1212304f, +0.0711030f, +0.1302681f, -0.1441332f, -0.8374323f,
  +0.8138393f, +0.3671575f, -0.1156835f, +0.3131361f, +0.1310626f, +0.5016077f, +0.2777604f, +0.0118860f,
  -0.1785224f, +0.4962843f, +0.0636967f, -0.1380072f, +0.2169573f, -0.0166757f, +0.2900334f, -0.0924572f,
  -0.1429030f, -0.0863897f, -0.1135752f, -0.3851099f, +0.6763928f, -0.1422005f, +0.3336251f, -0.1690582f,
  -0.5729360f, -0.3416575f, +0.0289446f, -0.2024472f, +0.0576956f, -0.0573805f, -0.2429720f, -0.4297183f,
  -0.0062781f, -0.0276935f, +0.2055065f, -0.1445800f, +0.1136167f, -0.1199594f, -0.1299812f, -0.0560506f,
  -0.0661821f, +0.1059504f, +0.1466748f, -0.0604307f, +0.1019486f, -0.2857692f, +0.0561513f, +0.1672449f,
  +0.4062579f, +0.2781851f, -0.1230090f, -0.2548545f, +0.3885362f, +0.3234048f, -0.0236786f, -0.0863271f,
  +0.0963849f, -0.0740371f, -0.0340631f, -0.2262650f, -0.0209109f, -0.2104165f, -0.2673113f, -0.1482466f,
  -0.3529163f, -0.3144705f, -0.0848950f, -0.1501540f, -0.0141662f, -0.0482160f, -0.0752361f, +0.2161396f,
  +0.1916393f, -0.2839159f, +0.1388036f, -0.1517445f, -0.3764149f, +0.7442643f, -0.8585865f, +0.7621446f,
  +0.0886424f, -0.0268206f, +0.0455097f, +0.0051489f, -0.0743172f, -0.1073310f, -0.1164407f, -0.0295766f,
  -0.0397211f, -0.1493305f, -0.1652502f, -0.0396539f, -0.6275111f, +0.0479712f, -0.2572152f, +0.2511158f,
  -0.2379565f, +0.0576606f, -0.0666134f, +0.0222699f, +0.1886541f, +0.0670455f, +0.1778475f, +0.0415610f,
  +0.1163804f, +0.0398664f, -0.0185605f, +0.0083800f, -0.1897288f, +0.0011982f, +0.0108461f, +0.1305088f,
  +0.1464984f, +0.0532571f, -0.1010023f, -0.1090318f, +0.3012790f, -0.0851162f, +0.0387830f, -0.0271878f,
  -0.0144241f, -0.0152203f, +0.0108618f, +0.0887733f, -0.0490886f, -0.0239801f, -0.0715498f, +0.0026690f,
  -0.2435696f, -0.0991638f, -0.0225939f, +0.4123105f, -0.3504136f, +0.2196800f, +0.2207666f, +0.2175105f,
  +0.2574618f, -0.6275231f, -0.0647265f, +0.5052297f, -0.2071839f, +0.2115946f, -0.2446250f, -0.5525116f,
  +0.4397010f, +0.2460320f, +0.1250988f, -0.4082744f, +0.0198109f, +0.0701368f, +0.1401373f, +0.2056419f,
  -0.2710708f, +0.4617299f, +0.1942843f, +0.0941080f, -0.4138049f, +0.0836773f, +0.2729260f, +0.5913579f,
  -0.2384890f, +0.2054173f, +0.9393233f, +0.3181930f, -0.7841976f, -0.0271203f, +0.9702873f, +0.0470178f,
  +0.1666318f, +0.0272016f, -0.2178700f, +0.0358489f, +0.2737580f, +0.1481961f, -0.0978412f, -0.0332564f
);

const float biases[4] = float[4](
  -0.0011672f, -0.0420600f, +0.0403657f, -0.0763386f
);

vec4 hook() {
    const vec4 r[9][2] = vec4[9][2](
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 1.0f)))
    );

    float sum[4] = biases;
    for (int n = 0; n < 4; n++) {
        for (int i = 0; i < 9; i++) {
            const vec4 k0 = vec4(kernels[n * 8 * 9 + 8 * i + 0], kernels[n * 8 * 9 + 8 * i + 1], kernels[n * 8 * 9 + 8 * i + 2], kernels[n * 8 * 9 + 8 * i + 3]);
            const vec4 k1 = vec4(kernels[n * 8 * 9 + 8 * i + 4], kernels[n * 8 * 9 + 8 * i + 5], kernels[n * 8 * 9 + 8 * i + 6], kernels[n * 8 * 9 + 8 * i + 7]);
            sum[n] += (dot(k0, r[i][0]) + dot(k1, r[i][1]));
        }
    }

    return ACTIVE(vec4(sum[0], sum[1], sum[2], sum[3]));
}

//!HOOK LUMA
//!DESC ARNet b16 Layer27 L1
//!WHEN OUTPUT.w LUMA.w / 1.2 > OUTPUT.h LUMA.h / 1.2 > *
//!BIND TMP2_L0
//!BIND TMP2_L1
//!SAVE TMP1_L1
//!COMPONENTS 4

#define ACTIVE(v) (max(v, v * 0.2000000f))

#define TEX_BIND_L0_TEXOFF TMP2_L0_texOff
#define TEX_BIND_L0_TEX TMP2_L0_tex
#define TEX_BIND_L0_POS TMP2_L0_pos
#define TEX_BIND_L0_SIZE TMP2_L0_size
#define TEX_BIND_L0_PT TMP2_L0_pt

#define TEX_BIND_L1_TEXOFF TMP2_L1_texOff
#define TEX_BIND_L1_TEX TMP2_L1_tex
#define TEX_BIND_L1_POS TMP2_L1_pos
#define TEX_BIND_L1_SIZE TMP2_L1_size
#define TEX_BIND_L1_PT TMP2_L1_pt

const float kernels[288] = float[288](
  +0.0514245f, +0.0348452f, -0.1481325f, -0.1125436f, +0.0516157f, +0.0857665f, +0.2542073f, -0.0447937f,
  +0.0312717f, +0.0607759f, -0.0666074f, +0.0587942f, +0.0536403f, -0.0424439f, +0.0523669f, -0.0336114f,
  -0.1409051f, -0.1347430f, +0.0199879f, -0.0246728f, -0.1364598f, -0.0783415f, -0.1165822f, +0.0817835f,
  +0.0004073f, -0.0670934f, -1.0612862f, -0.0398997f, +0.6082085f, -0.0404749f, +0.0224907f, -0.1328299f,
  +0.1178073f, +0.1618076f, +0.2636808f, -0.1292624f, -0.4091343f, -0.2857666f, -0.0511870f, +0.8856586f,
  +0.0152869f, -0.0883419f, -0.0804351f, +0.2692559f, -0.2397838f, +0.0088774f, -0.2233334f, +0.0033148f,
  -0.0198424f, -0.1864883f, -0.1403512f, -0.1293369f, +0.9131573f, -0.0548391f, -0.1745307f, -0.2102393f,
  +0.2189261f, -0.1255773f, -0.0243766f, +0.0255689f, -0.1609233f, -0.1201472f, -0.3744136f, +0.2710215f,
  -0.0445283f, -0.0356050f, +0.0945742f, -0.0250521f, -0.0233715f, -0.0033417f, +0.0307549f, +0.0121989f,
  -0.0547163f, -0.3122023f, -0.2105262f, +0.3700160f, -0.6642175f, +0.4302033f, +0.0657623f, +0.3049479f,
  +0.2799271f, +0.1374642f, -0.0741737f, +0.2757480f, -0.3555646f, +0.1904511f, +0.0988280f, +0.0566403f,
  +0.0569515f, -0.1445049f, -0.2093336f, +0.2778316f, -0.3012909f, +0.3620676f, +0.1027707f, -0.1731480f,
  -0.1344526f, +0.3710778f, -0.1803432f, +0.5340357f, -0.2482193f, +0.2102587f, +0.4330177f, +0.3527235f,
  -0.2587206f, +0.1747963f, +0.3194928f, +0.8354683f, -0.2457898f, +0.1143229f, -0.1209389f, -0.3044624f,
  +0.4400805f, -0.2660228f, -0.3883558f, +0.2399518f, +0.0021531f, +0.1545099f, -0.0518193f, -0.3358780f,
  -0.0807000f, -0.0376101f, +0.3110171f, +0.1182749f, +0.2486764f, +0.0513121f, +0.1956444f, +0.0683846f,
  +0.0636076f, +0.3145334f, +0.5530070f, +0.1388496f, +0.2772865f, -0.0045663f, +0.2920438f, -0.2223162f,
  +0.2033882f, -0.1228929f, +0.4387564f, -0.2603374f, -0.4205422f, +0.0562941f, +0.0069891f, -0.1333863f,
  -0.0626592f, +0.1292339f, +0.0706399f, +0.0020422f, +0.1665305f, -0.3290139f, +0.0291634f, +0.0148951f,
  +0.0260090f, +0.1166159f, -0.0044563f, +0.0222247f, +0.0107408f, +0.0943380f, -0.0015542f, -0.1838874f,
  -0.1793421f, +0.2064358f, +0.1322722f, -0.0387356f, +0.1607562f, -0.3413023f, +0.1630178f, -0.1609722f,
  -0.0377811f, -0.0476395f, +0.6968607f, -0.3104001f, +0.0335273f, -0.1879369f, -0.2363460f, -0.1615538f,
  +0.2502882f, -0.2254779f, +0.2306784f, +0.0434303f, -0.0538366f, -0.3634924f, +0.1622263f, +0.7333446f,
  -0.1472807f, -0.2866957f, +0.0577626f, +0.0778146f, -0.1894299f, -0.0895853f, -0.0404968f, +0.3688364f,
  +0.0887550f, -0.1196815f, +0.2774496f, +0.1315991f, -0.6243777f, -0.0509186f, +0.0077471f, +0.1129095f,
  -0.0840985f, +0.0760219f, -0.4017030f, -0.3575374f, -0.5855339f, -0.1315657f, -0.1461103f, -0.2340626f,
  -0.1699666f, +0.1743333f, +0.1546377f, +0.2277610f, +0.0863237f, -0.2738939f, +0.2706288f, -0.1823119f,
  +0.1998606f, -0.2800639f, -0.3393209f, +0.3938866f, -0.0171647f, +0.0702994f, +0.2366649f, +0.5538082f,
  +0.1937661f, -0.0943201f, -0.1397344f, -0.0968268f, +0.2657312f, -0.0008425f, -0.1353494f, -0.3153530f,
  +0.0977605f, +0.0770438f, -0.1200319f, +0.1528891f, -0.0656412f, +0.1599386f, +0.1774826f, +0.1882098f,
  -0.3012955f, +0.0247761f, -0.0640828f, +0.1384786f, -0.4501458f, +0.2834340f, -0.4319149f, -0.5314716f,
  -0.3273034f, +0.8554764f, -0.5932838f, +0.1391519f, +0.0270664f, +0.0044530f, -0.4349647f, -0.3977013f,
  +0.1730430f, +0.0945457f, -0.0100081f, -0.0481920f, -0.1510460f, +0.0370129f, -0.0055463f, +0.0961137f,
  +0.3844695f, +0.5063478f, +0.5228298f, +0.0884016f, -0.3357145f, +0.1691859f, +0.0144219f, +0.6489064f,
  -0.2849366f, -0.4806043f, +0.4813317f, -0.6598023f, -1.0814209f, -0.0107349f, -0.1189617f, +0.2389733f,
  -0.2186570f, -0.0811330f, +0.1025247f, -0.0925151f, +0.2173036f, +0.0353163f, +0.1073134f, -0.2277933f
);

const float biases[4] = float[4](
  +0.0557006f, -0.0466019f, -0.5339519f, -0.1026351f
);

vec4 hook() {
    const vec4 r[9][2] = vec4[9][2](
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 1.0f)))
    );

    float sum[4] = biases;
    for (int n = 0; n < 4; n++) {
        for (int i = 0; i < 9; i++) {
            const vec4 k0 = vec4(kernels[n * 8 * 9 + 8 * i + 0], kernels[n * 8 * 9 + 8 * i + 1], kernels[n * 8 * 9 + 8 * i + 2], kernels[n * 8 * 9 + 8 * i + 3]);
            const vec4 k1 = vec4(kernels[n * 8 * 9 + 8 * i + 4], kernels[n * 8 * 9 + 8 * i + 5], kernels[n * 8 * 9 + 8 * i + 6], kernels[n * 8 * 9 + 8 * i + 7]);
            sum[n] += (dot(k0, r[i][0]) + dot(k1, r[i][1]));
        }
    }

    return ACTIVE(vec4(sum[0], sum[1], sum[2], sum[3]));
}

//!HOOK LUMA
//!DESC ARNet b16 Layer28 L0
//!WHEN OUTPUT.w LUMA.w / 1.2 > OUTPUT.h LUMA.h / 1.2 > *
//!BIND TMP1_L0
//!BIND TMP1_L1
//!BIND TMP2_L0
//!SAVE TMP2_L0
//!COMPONENTS 4

#define ACTIVE(v) (v)

#define TEX_BIND_L0_TEXOFF TMP1_L0_texOff
#define TEX_BIND_L0_TEX TMP1_L0_tex
#define TEX_BIND_L0_POS TMP1_L0_pos
#define TEX_BIND_L0_SIZE TMP1_L0_size
#define TEX_BIND_L0_PT TMP1_L0_pt

#define TEX_BIND_L1_TEXOFF TMP1_L1_texOff
#define TEX_BIND_L1_TEX TMP1_L1_tex
#define TEX_BIND_L1_POS TMP1_L1_pos
#define TEX_BIND_L1_SIZE TMP1_L1_size
#define TEX_BIND_L1_PT TMP1_L1_pt

#define TEX_BIND_L2_TEXOFF TMP2_L0_texOff
#define TEX_BIND_L2_TEX TMP2_L0_tex
#define TEX_BIND_L2_POS TMP2_L0_pos
#define TEX_BIND_L2_SIZE TMP2_L0_size
#define TEX_BIND_L2_PT TMP2_L0_pt

const float kernels[288] = float[288](
  +0.0400838f, +0.4239298f, +0.0064825f, +0.1173495f, -0.1089670f, -0.0975718f, -0.2574138f, +0.0606003f,
  +0.2250564f, -0.4699804f, +0.0183040f, -0.0978125f, -0.0824391f, -0.3562072f, -0.1449506f, -0.2940370f,
  +0.0131187f, -0.0256795f, -0.2872502f, -0.2744057f, +0.1786031f, -0.2532778f, -0.0521238f, -0.0502607f,
  -0.1913464f, +0.0279586f, -0.9541420f, +0.0246895f, -0.0857434f, -0.0571598f, +0.4389464f, +0.2079479f,
  -0.6912279f, +0.9941990f, +0.0959371f, +0.1083541f, +0.2540902f, +0.6028185f, +0.1558375f, -0.4989051f,
  -0.2816974f, +0.1494649f, -0.0708630f, -0.0721766f, +0.4157708f, +0.1810533f, +0.1790555f, -0.5900018f,
  +0.1144924f, -0.0405528f, -0.3287448f, -0.0151608f, -0.0346143f, +0.1303151f, +0.1124506f, +0.0834770f,
  -0.1802075f, -0.2198774f, -0.0508643f, +0.0270910f, +0.2410594f, +0.2946013f, -0.4303094f, -0.2272695f,
  -0.0976058f, +0.0195656f, +0.0976109f, -0.2184176f, -0.2022419f, +0.0437431f, -0.0397722f, -0.2499283f,
  -0.0519826f, +0.0172758f, +0.0176430f, -0.2636919f, -0.0777230f, +0.0819473f, +0.0817239f, +0.0040470f,
  -0.0724655f, -0.2051395f, -0.0830354f, +0.2481611f, -0.1291297f, +0.0139359f, -0.2979023f, -0.0587901f,
  +0.0274232f, -0.0167500f, +0.1750818f, -0.1037236f, +0.0654989f, +0.2218881f, +0.1282432f, -0.3167267f,
  +0.4807742f, +0.0871723f, +0.3675002f, +0.1525495f, -0.0730704f, +0.4629819f, +0.6137902f, -0.2180524f,
  -0.3961147f, -0.7147306f, -0.0459480f, -0.4830587f, -0.3407330f, +0.4912778f, -0.2566585f, +0.1652375f,
  +0.0622321f, -0.0620841f, -0.0538226f, +0.2628806f, +0.0796174f, +0.2714192f, -0.3405891f, +0.3310866f,
  -0.4320267f, -0.3903745f, -0.0324749f, -0.0568437f, -0.0671778f, +0.0053772f, -0.0583688f, -0.0857494f,
  +0.3032570f, -0.1352218f, -0.0162065f, +0.0541987f, -0.2928168f, +0.0728762f, -0.0771819f, +0.2315777f,
  +0.2436670f, -0.1831453f, -0.0378384f, +0.1844478f, -0.1197455f, -0.0753799f, -0.0179858f, -0.0112936f,
  -0.0051597f, +0.1089933f, -0.1578233f, +0.0827594f, +0.0066950f, +0.1095388f, -0.1637802f, +0.1081230f,
  +0.1265520f, -0.4222235f, +0.4705657f, +0.2219452f, +0.0227872f, -0.0441998f, +0.5110496f, +0.1748861f,
  +0.2501186f, +0.0986801f, -0.1439486f, -0.8408607f, -0.1597999f, +0.0171950f, -0.3992636f, -0.3120759f,
  -0.1246748f, +0.1322112f, +0.2770678f, -0.1958614f, +0.0505020f, +0.3903303f, -0.0649764f, -0.0069303f,
  +0.8801638f, +0.9152569f, +0.4489019f, -0.7021895f, +0.0947031f, +1.1507096f, +0.5353299f, +0.3938796f,
  -0.2937011f, -0.3815227f, -0.4595483f, -0.2918679f, +1.2892790f, -0.1832625f, -0.3041245f, -0.2867317f,
  +0.0383344f, -0.1217631f, +0.2045414f, +0.0397320f, +0.0774346f, +0.1678321f, -0.3285281f, +0.0659557f,
  +0.8778180f, +0.3608529f, +0.0982923f, +0.1891461f, +0.1844552f, +0.2155075f, +0.3305205f, -0.1223988f,
  +0.0629414f, +0.7019626f, -0.0635079f, +0.2727109f, +0.2308969f, +0.0135044f, -0.1270092f, +0.0132181f,
  +0.0297378f, +0.2694533f, -0.0240815f, +0.2236278f, +0.2326920f, +0.2362589f, +0.1297619f, -0.0444042f,
  +0.1591664f, -0.4977725f, +0.2491701f, +0.1471361f, +0.0602495f, +0.1682967f, +0.4623141f, -0.3917845f,
  +0.2921780f, +0.3034922f, -0.2622244f, -0.4022277f, +0.3534583f, +0.0940251f, -0.2260996f, +0.0960671f,
  -0.1042383f, +0.1253737f, +0.2742262f, -0.3502030f, +0.0020276f, +0.3778358f, -0.2726303f, -0.0432722f,
  -0.3552426f, +0.3982107f, -0.0080145f, +0.0030603f, -0.1338705f, +0.7583171f, -0.7006019f, +0.1136085f,
  -0.7755374f, -0.1765234f, +0.1977025f, -0.0040460f, +0.0424495f, +0.1648239f, -0.1247659f, -0.5954991f,
  +0.3886355f, +0.1298176f, +0.0328141f, +0.0611181f, +0.0228005f, -0.0121698f, +0.2070165f, -0.0916861f,
  +0.3690421f, +0.1576636f, -0.0512518f, -0.3193561f, -0.1438621f, +0.1976724f, -0.2258060f, +0.7204208f,
  +0.4096261f, -0.0228552f, +0.0309253f, +0.2593684f, +0.0430492f, -0.0462662f, -0.0235868f, -0.3866433f
);

const float biases[4] = float[4](
  -0.0701988f, -0.0333914f, -0.2248807f, -0.0324957f
);

vec4 hook() {
    const vec4 r[9][2] = vec4[9][2](
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 1.0f)))
    );

    float sum[4] = biases;
    for (int n = 0; n < 4; n++) {
        for (int i = 0; i < 9; i++) {
            const vec4 k0 = vec4(kernels[n * 8 * 9 + 8 * i + 0], kernels[n * 8 * 9 + 8 * i + 1], kernels[n * 8 * 9 + 8 * i + 2], kernels[n * 8 * 9 + 8 * i + 3]);
            const vec4 k1 = vec4(kernels[n * 8 * 9 + 8 * i + 4], kernels[n * 8 * 9 + 8 * i + 5], kernels[n * 8 * 9 + 8 * i + 6], kernels[n * 8 * 9 + 8 * i + 7]);
            sum[n] += (dot(k0, r[i][0]) + dot(k1, r[i][1]));
        }
    }

    return ACTIVE(vec4(sum[0], sum[1], sum[2], sum[3]) * 0.2000000f + TEX_BIND_L2_TEXOFF(vec2(0.0f, 0.0f)));
}

//!HOOK LUMA
//!DESC ARNet b16 Layer28 L1
//!WHEN OUTPUT.w LUMA.w / 1.2 > OUTPUT.h LUMA.h / 1.2 > *
//!BIND TMP1_L0
//!BIND TMP1_L1
//!BIND TMP2_L1
//!SAVE TMP2_L1
//!COMPONENTS 4

#define ACTIVE(v) (v)

#define TEX_BIND_L0_TEXOFF TMP1_L0_texOff
#define TEX_BIND_L0_TEX TMP1_L0_tex
#define TEX_BIND_L0_POS TMP1_L0_pos
#define TEX_BIND_L0_SIZE TMP1_L0_size
#define TEX_BIND_L0_PT TMP1_L0_pt

#define TEX_BIND_L1_TEXOFF TMP1_L1_texOff
#define TEX_BIND_L1_TEX TMP1_L1_tex
#define TEX_BIND_L1_POS TMP1_L1_pos
#define TEX_BIND_L1_SIZE TMP1_L1_size
#define TEX_BIND_L1_PT TMP1_L1_pt

#define TEX_BIND_L2_TEXOFF TMP2_L1_texOff
#define TEX_BIND_L2_TEX TMP2_L1_tex
#define TEX_BIND_L2_POS TMP2_L1_pos
#define TEX_BIND_L2_SIZE TMP2_L1_size
#define TEX_BIND_L2_PT TMP2_L1_pt

const float kernels[288] = float[288](
  -0.0690757f, +0.0264399f, -0.2519184f, -0.1786567f, +0.0498997f, -0.0303051f, -0.0395113f, +0.0885376f,
  -0.0266232f, -0.0942290f, +0.4954029f, +0.3155512f, -0.0817155f, +0.0733219f, +0.6020161f, -0.1977592f,
  +0.0974389f, +0.0286813f, +0.0459043f, +0.4338527f, -0.4032810f, +0.0548610f, -0.0064129f, +0.4093721f,
  +0.1501695f, +0.2148402f, -0.2775522f, -0.1668774f, +0.0598624f, +0.2197931f, -0.1844058f, +0.1155555f,
  -0.1084245f, +0.1060893f, -0.0800029f, +0.1413310f, +0.0470257f, +0.1851572f, +0.3817425f, -0.1027358f,
  +0.3611229f, -0.2580461f, -0.2593767f, -0.0714886f, -0.0683096f, -0.0503856f, -0.2067327f, +0.1598146f,
  +0.1670205f, +0.0575741f, +0.0651053f, +0.0328896f, +0.1136955f, -0.0265814f, -0.0136952f, -0.0760548f,
  -0.1665219f, +0.3838164f, -0.0368070f, +0.0839785f, -0.0154779f, -0.0293777f, +0.0976620f, -0.0930637f,
  +0.0168983f, -0.0227225f, +0.0051136f, +0.0963559f, +0.1488647f, -0.0656177f, -0.0022789f, +0.1469259f,
  +0.1208453f, -0.1245933f, -0.1450797f, -0.2063871f, +0.0737590f, -0.1184614f, +0.1997946f, +0.1848535f,
  +0.0134827f, +0.3933726f, +0.0437388f, +0.0334897f, +0.0433165f, +0.0480854f, +0.1698371f, -0.0079115f,
  +0.1290947f, -0.0586388f, +0.0695261f, -0.4450883f, -0.1142689f, +0.0953956f, -0.2204090f, -0.3988278f,
  +0.3644529f, +0.2783169f, -0.0379454f, +0.2912336f, +0.1626747f, +0.2532175f, +0.2248403f, +0.1687003f,
  +0.2668049f, +0.2921112f, -0.2010776f, +0.0809263f, +0.3329118f, +0.5404317f, +0.5467904f, -0.6023270f,
  -0.1906189f, -0.0325105f, -0.0848319f, +0.3894058f, +0.1471456f, -0.0055172f, -0.1220373f, +0.3919084f,
  -0.4480338f, +0.2007436f, -0.4245385f, +0.0116398f, +0.2671221f, -0.3137231f, +0.5125629f, -0.0214738f,
  -0.3403945f, -0.6883430f, +0.0953431f, -0.1593928f, -0.1119054f, +0.1506018f, -0.3187099f, +0.1646241f,
  -0.1582327f, +0.1875007f, +0.0798928f, -0.0891656f, -0.0118714f, +0.0760532f, -0.0134032f, -0.4468871f,
  -0.0723912f, +0.1034004f, -0.2251989f, +0.2250053f, -0.0582222f, -0.0332997f, -0.2255079f, +0.1234419f,
  -0.1676407f, -0.0496792f, +0.2622387f, +0.0565437f, +0.1959155f, -0.0764778f, -0.2191521f, +0.1840568f,
  +0.0329684f, +0.0247883f, -0.1756310f, -0.3105040f, +0.2081115f, -0.1049751f, -0.1528075f, +0.4314514f,
  -0.0916469f, -0.0079960f, +0.6224400f, +0.3378299f, +0.1185940f, -0.0780533f, -0.0175916f, +0.1437283f,
  +0.9375754f, -0.3673706f, -0.5306918f, -0.7026398f, +0.1622945f, -0.2850715f, -0.4447457f, -0.2069246f,
  -0.3844760f, +0.0969366f, +0.1653240f, -0.0911789f, +0.0165766f, -0.0440572f, +0.0056373f, +0.0560755f,
  -0.2291611f, +0.0684201f, -0.2188470f, -0.0647258f, -0.0382408f, +0.1470701f, -0.0756794f, +0.2102631f,
  +0.2145803f, +0.2793728f, -0.0221952f, +0.1414428f, +0.1661924f, +0.1387157f, -0.1674191f, -0.3089710f,
  +0.0469440f, +0.0399187f, -0.0184758f, -0.1027392f, -0.1199419f, +0.0943948f, -0.1190310f, +0.0367450f,
  -0.0789031f, -0.1534084f, +0.0952005f, -0.1504326f, -0.0176829f, -0.1234046f, -0.1093875f, -0.0541837f,
  +0.1310080f, +0.3458701f, +0.1047665f, +0.2989573f, +0.0038172f, -0.0786132f, +0.0232414f, -0.2622178f,
  -0.0914630f, +0.0130969f, +0.1296826f, +0.1779722f, -0.2171820f, +0.1576884f, +0.0087953f, -0.0707072f,
  +0.0856313f, +0.4274255f, -0.8141330f, -0.0153899f, +0.0401657f, -0.0438247f, -0.6569721f, +0.0074239f,
  -0.4403799f, -0.0889764f, -0.2308045f, +0.1867735f, -1.0368621f, -0.2526904f, -0.4364620f, -0.2083675f,
  +0.2009608f, -0.2007307f, -0.0038847f, -0.1463594f, -0.3751089f, +0.0105626f, -0.0364541f, -0.1780036f,
  +0.1671623f, -0.1613059f, +0.1954253f, +0.0237592f, -0.0617903f, -0.0102754f, -0.0569285f, -0.0119792f,
  -0.0773265f, +0.7762781f, -0.1138571f, +0.0666293f, -0.0302071f, -0.1566435f, +0.1893280f, -0.2347187f,
  -0.0262523f, -0.1005027f, -0.0361201f, +0.2812853f, +0.0572312f, +0.1323683f, -0.0011017f, -0.0188527f
);

const float biases[4] = float[4](
  +0.0178692f, +0.1082019f, -0.0797562f, +0.0850847f
);

vec4 hook() {
    const vec4 r[9][2] = vec4[9][2](
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 1.0f)))
    );

    float sum[4] = biases;
    for (int n = 0; n < 4; n++) {
        for (int i = 0; i < 9; i++) {
            const vec4 k0 = vec4(kernels[n * 8 * 9 + 8 * i + 0], kernels[n * 8 * 9 + 8 * i + 1], kernels[n * 8 * 9 + 8 * i + 2], kernels[n * 8 * 9 + 8 * i + 3]);
            const vec4 k1 = vec4(kernels[n * 8 * 9 + 8 * i + 4], kernels[n * 8 * 9 + 8 * i + 5], kernels[n * 8 * 9 + 8 * i + 6], kernels[n * 8 * 9 + 8 * i + 7]);
            sum[n] += (dot(k0, r[i][0]) + dot(k1, r[i][1]));
        }
    }

    return ACTIVE(vec4(sum[0], sum[1], sum[2], sum[3]) * 0.2000000f + TEX_BIND_L2_TEXOFF(vec2(0.0f, 0.0f)));
}

//!HOOK LUMA
//!DESC ARNet b16 Layer29 L0
//!WHEN OUTPUT.w LUMA.w / 1.2 > OUTPUT.h LUMA.h / 1.2 > *
//!BIND TMP2_L0
//!BIND TMP2_L1
//!SAVE TMP1_L0
//!COMPONENTS 4

#define ACTIVE(v) (max(v, v * 0.2000000f))

#define TEX_BIND_L0_TEXOFF TMP2_L0_texOff
#define TEX_BIND_L0_TEX TMP2_L0_tex
#define TEX_BIND_L0_POS TMP2_L0_pos
#define TEX_BIND_L0_SIZE TMP2_L0_size
#define TEX_BIND_L0_PT TMP2_L0_pt

#define TEX_BIND_L1_TEXOFF TMP2_L1_texOff
#define TEX_BIND_L1_TEX TMP2_L1_tex
#define TEX_BIND_L1_POS TMP2_L1_pos
#define TEX_BIND_L1_SIZE TMP2_L1_size
#define TEX_BIND_L1_PT TMP2_L1_pt

const float kernels[288] = float[288](
  -0.1082446f, -0.2038112f, -0.2159415f, +0.0612434f, -0.2501732f, -0.0589029f, -0.3610104f, +0.1739025f,
  -0.1420610f, +0.1148209f, +0.0233108f, -0.1285073f, -0.2849027f, +0.0808730f, -0.2733661f, +0.4019402f,
  -0.1486117f, -0.1491575f, -0.1018747f, -0.0357813f, -0.3954117f, +0.2725216f, -0.4863682f, +0.0751694f,
  +0.1363136f, -0.3190032f, +0.2452655f, -0.2755746f, +0.1478904f, -0.0957756f, -0.5708981f, -0.0583199f,
  +0.0218957f, -0.3403579f, +0.3357861f, -0.2645985f, -0.2984901f, -0.1485886f, -0.3243635f, +0.0665839f,
  -0.6558583f, -0.2309043f, -0.1312660f, +0.1155590f, -0.7869933f, +0.3882937f, -0.4167583f, +0.1197762f,
  -0.1714495f, -0.1042762f, +0.0570217f, +0.2289666f, -0.0579777f, +0.0519698f, +0.2017665f, -0.1841405f,
  -0.0606454f, -0.0500716f, -0.2715167f, -0.1168638f, -0.1197270f, +0.0656714f, -0.3056664f, +0.1927513f,
  -0.4267941f, +0.0032337f, -0.0378497f, -0.0670253f, +0.2167055f, +0.2128941f, +0.1924725f, -0.1569067f,
  -0.0244136f, -0.0220828f, -0.0164906f, +0.1420724f, -0.1048797f, +0.1394060f, +0.2985583f, +0.0089222f,
  +0.0736066f, -0.2990621f, +0.2046019f, +0.2847067f, -0.4205968f, +0.0094673f, +0.4109709f, +0.2532575f,
  +0.0061046f, -0.3146039f, +0.1845468f, +0.1294556f, -0.2293073f, -0.4167681f, +0.3211141f, +0.3874544f,
  -0.1654733f, +0.2128750f, -0.0860290f, +0.3286899f, +0.2234657f, +0.1148788f, +0.5643452f, -0.1629866f,
  -0.0067773f, +1.0710971f, -0.7543945f, +0.0509971f, +0.1357385f, -0.4159005f, -0.1256388f, -0.5444536f,
  +0.1107702f, +0.0403699f, -0.1221855f, +0.0272266f, +0.4231542f, -0.1292939f, +0.5547932f, +0.1218255f,
  -0.0960746f, -0.0115714f, +0.0522382f, +0.0050343f, +0.7392476f, -0.0694540f, +0.4306471f, -0.3615886f,
  +0.4244187f, -0.0219790f, +0.3789338f, +0.0140860f, +0.2668777f, +0.1078590f, +0.0317993f, +0.0586231f,
  +0.1192936f, -0.0026352f, +0.1837359f, +0.0805607f, -0.0735539f, -0.1828564f, -0.0111143f, -0.3910856f,
  +0.1174217f, +0.0134430f, -0.0313368f, +0.0633442f, -0.0247411f, +0.0582882f, +0.1712530f, +0.0760155f,
  +0.0737110f, +0.1527882f, +0.0350189f, -0.0416892f, -0.0427434f, -0.0955178f, +0.1980699f, +0.0527390f,
  -0.0553519f, -0.0280311f, +0.0417985f, +0.0215243f, +0.0040870f, -0.0103854f, -0.0814888f, -0.0211169f,
  -0.0079003f, +0.3204251f, -0.2076264f, -0.0549917f, +0.3998283f, +0.0877029f, +0.2307756f, -0.0146498f,
  -0.3469146f, -0.2861178f, +0.0992957f, +0.1204841f, -0.2624105f, -0.2962384f, -0.4907444f, +0.2244981f,
  +0.1205843f, -0.1145132f, -0.1322162f, +0.1695569f, -0.1694554f, +0.1754977f, -0.2988057f, +0.1271967f,
  +0.4178320f, +0.0999019f, -0.2659442f, -0.0742281f, +0.1608615f, +0.2585521f, -0.4073720f, +0.3196227f,
  -0.2531101f, +0.6163012f, +0.1832696f, +0.0952102f, -0.5684109f, -0.4315062f, +0.6123982f, -0.5705245f,
  +0.1165742f, +0.0596555f, +0.1505235f, -0.0815827f, +0.0378951f, +0.1966944f, +0.1597914f, +0.0214449f,
  +0.1828972f, +0.0751578f, -0.0325881f, -0.1411432f, -0.2265321f, +0.0464464f, +0.1790445f, +0.3984043f,
  -0.0148439f, +0.3729836f, -0.1162778f, +0.1327204f, -0.0831597f, +0.0550700f, +0.2474447f, +0.0609124f,
  +0.1389791f, +0.1956473f, -0.0677511f, -0.1547629f, -0.1128135f, +0.0356212f, +0.2306583f, -0.0964708f,
  -0.2242542f, +0.1641923f, -0.0820993f, -0.3081566f, -0.3596498f, -0.0755439f, +0.1509620f, +0.2799680f,
  -0.0666151f, +0.5458967f, +0.0952431f, +0.4243764f, -0.0323739f, -0.2494843f, +0.0572608f, -0.0114421f,
  -0.0925692f, +0.5634395f, -0.0367649f, -0.3486897f, -0.2576706f, -0.1788944f, +0.1327301f, -0.3120674f,
  +0.0029684f, -0.0254468f, -0.2029307f, +0.0550937f, -0.2848395f, -0.1350031f, +0.2024660f, +0.2147178f,
  -0.0971101f, +0.4729589f, -0.0737507f, -0.0628835f, -0.3461811f, +0.0756347f, +0.3419712f, +0.2666339f,
  -0.0202651f, +0.0637761f, -0.2210587f, -0.2508179f, -0.2060336f, -0.0497234f, +0.1462168f, +0.0165548f
);

const float biases[4] = float[4](
  +0.1325645f, -0.0767345f, -0.0828659f, -0.0118747f
);

vec4 hook() {
    const vec4 r[9][2] = vec4[9][2](
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 1.0f)))
    );

    float sum[4] = biases;
    for (int n = 0; n < 4; n++) {
        for (int i = 0; i < 9; i++) {
            const vec4 k0 = vec4(kernels[n * 8 * 9 + 8 * i + 0], kernels[n * 8 * 9 + 8 * i + 1], kernels[n * 8 * 9 + 8 * i + 2], kernels[n * 8 * 9 + 8 * i + 3]);
            const vec4 k1 = vec4(kernels[n * 8 * 9 + 8 * i + 4], kernels[n * 8 * 9 + 8 * i + 5], kernels[n * 8 * 9 + 8 * i + 6], kernels[n * 8 * 9 + 8 * i + 7]);
            sum[n] += (dot(k0, r[i][0]) + dot(k1, r[i][1]));
        }
    }

    return ACTIVE(vec4(sum[0], sum[1], sum[2], sum[3]));
}

//!HOOK LUMA
//!DESC ARNet b16 Layer29 L1
//!WHEN OUTPUT.w LUMA.w / 1.2 > OUTPUT.h LUMA.h / 1.2 > *
//!BIND TMP2_L0
//!BIND TMP2_L1
//!SAVE TMP1_L1
//!COMPONENTS 4

#define ACTIVE(v) (max(v, v * 0.2000000f))

#define TEX_BIND_L0_TEXOFF TMP2_L0_texOff
#define TEX_BIND_L0_TEX TMP2_L0_tex
#define TEX_BIND_L0_POS TMP2_L0_pos
#define TEX_BIND_L0_SIZE TMP2_L0_size
#define TEX_BIND_L0_PT TMP2_L0_pt

#define TEX_BIND_L1_TEXOFF TMP2_L1_texOff
#define TEX_BIND_L1_TEX TMP2_L1_tex
#define TEX_BIND_L1_POS TMP2_L1_pos
#define TEX_BIND_L1_SIZE TMP2_L1_size
#define TEX_BIND_L1_PT TMP2_L1_pt

const float kernels[288] = float[288](
  +0.0672722f, +0.1839928f, -0.2669408f, +0.1222405f, -0.0820451f, +0.2231855f, +0.2485455f, -0.1823599f,
  -0.0101246f, -0.4289708f, -0.7454442f, +0.4320837f, +0.2327485f, +0.2434876f, +0.8265442f, -0.4240703f,
  +0.1837149f, -0.0703848f, +0.2342721f, -0.1093421f, -0.1551086f, -0.1939059f, +0.5457989f, +0.5632895f,
  -0.2525261f, -0.1555763f, +0.0779918f, +0.4424701f, +0.0678613f, -0.1357118f, +0.4846726f, +0.2651105f,
  +0.0950275f, +1.0571204f, +0.2490691f, +0.1917828f, +0.6941354f, -0.0122471f, +0.4139971f, +0.1822804f,
  +0.2793658f, +0.2887105f, -0.0765736f, +0.1414981f, +0.3778500f, +0.0003177f, +0.1957211f, +0.0105704f,
  +0.0994070f, +0.1466333f, +0.1011996f, -0.1490557f, -0.1033605f, +0.0069321f, -0.2164640f, -0.0006944f,
  -0.2157914f, -0.1963510f, +0.0363164f, -0.1136369f, +0.0669094f, -0.0104287f, +0.2534528f, -0.4460947f,
  -0.1085118f, +0.1083425f, +0.1685373f, -0.0737169f, -0.0776331f, -0.0999205f, +0.1441762f, -0.2366897f,
  +0.0992822f, -0.0193557f, +0.0885218f, -0.3031190f, +0.3585819f, -0.2482643f, -0.2040038f, -0.0621740f,
  +0.1178375f, +0.0425774f, -0.0647986f, -0.1160584f, -0.2106711f, +0.0909275f, -0.2507267f, +0.3797915f,
  -0.0881351f, -0.1635447f, -0.0182341f, +0.1169442f, -0.3212109f, -0.0532357f, -0.2544853f, +0.2411177f,
  +0.3377857f, -0.1135523f, +0.7051974f, -0.5004969f, +0.1657549f, +0.0563862f, -0.2674158f, -0.0615194f,
  -0.1503675f, +0.0071510f, +0.1866597f, -0.2060173f, -0.3385059f, +0.1485783f, +0.4168257f, +0.2878547f,
  -0.3557245f, -0.2916738f, -0.0096614f, +0.1226400f, -0.1643517f, +0.2148257f, -0.4434199f, -0.4782896f,
  +0.0313757f, +0.0155418f, -0.0745872f, +0.0412719f, -0.5719118f, +0.0418969f, +0.0115527f, +0.1660195f,
  +0.0283234f, +0.3240746f, -0.0073780f, +0.1360849f, -0.2712818f, +0.0740903f, +0.2612287f, +0.3289898f,
  +0.0173061f, -0.0730862f, +0.0625392f, +0.0793863f, +0.0746646f, +0.0753640f, +0.0595040f, +0.0288689f,
  -0.1431798f, -0.0110305f, +0.0148126f, -0.0530636f, +0.0098661f, +0.0163818f, -0.2398599f, -0.0068357f,
  -0.1123654f, -0.0839598f, +0.1560538f, -0.0692421f, -0.2150156f, -0.1182926f, -0.3774447f, +0.3733349f,
  -0.0332608f, -0.1949822f, -0.0948951f, +0.0844565f, -0.0377005f, +0.0823061f, -0.3145224f, -0.0472643f,
  +0.2420719f, -0.2248062f, +0.0563878f, -0.2068245f, -0.3305571f, +0.1276305f, -0.4811638f, +0.0774200f,
  +0.3775832f, +0.2872828f, +0.0838208f, -0.2388130f, -0.2168537f, +0.4081173f, -0.1507314f, -0.2928866f,
  -0.1758287f, +0.5788508f, +0.0306533f, -0.1328899f, +0.0266515f, +0.2229672f, +0.2372853f, -0.2043848f,
  -0.1174713f, -0.1665439f, -0.5467373f, -0.2083917f, -0.0195232f, -0.3101618f, -0.5549916f, -0.2555043f,
  -1.1059828f, -0.4891605f, -0.2964479f, +0.1184192f, +0.9488151f, +0.1160934f, +0.2176129f, -0.1354933f,
  -0.0432331f, -0.2953898f, -0.0997885f, +0.0338623f, -0.3994180f, -0.0404058f, -0.3651343f, +0.1983802f,
  -0.1617663f, -0.0679908f, -0.0307687f, +0.0135943f, -0.1896386f, -0.0070348f, -0.2328423f, +0.1463985f,
  -0.1867075f, +0.1539369f, +0.0714951f, +0.0715407f, -0.1816799f, +0.2245790f, -0.2932744f, +0.0739979f,
  -0.1398273f, +0.0061114f, -0.0418520f, +0.0463125f, +0.0588879f, +0.0341416f, -0.1074223f, -0.2260013f,
  +0.1727175f, -0.3443001f, +0.1289651f, -0.6003852f, +0.0480007f, +0.0204680f, -0.8854438f, +0.0508576f,
  +0.2160782f, -0.4775459f, +0.0043341f, +0.0771703f, -0.4292720f, -0.2481382f, -0.0923813f, +0.4454639f,
  +0.2276122f, +0.2866128f, +0.0562835f, -0.1258505f, -0.0465991f, +0.0223725f, +0.2364164f, +0.1927575f,
  -0.0031015f, -0.1609605f, -0.3220652f, +0.1282427f, -0.1596726f, -0.1355751f, +0.0973336f, -0.3156549f,
  +0.3191778f, -0.1522782f, -0.0177991f, +0.1589937f, -0.2531848f, -0.0662986f, -0.4776128f, +0.3134438f,
  +0.1192646f, -0.3212759f, -0.1150070f, +0.1867002f, -0.1503010f, -0.2689258f, -0.2569947f, -0.1485192f
);

const float biases[4] = float[4](
  -0.1209699f, +0.0364433f, +0.0756607f, +0.0399279f
);

vec4 hook() {
    const vec4 r[9][2] = vec4[9][2](
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 1.0f)))
    );

    float sum[4] = biases;
    for (int n = 0; n < 4; n++) {
        for (int i = 0; i < 9; i++) {
            const vec4 k0 = vec4(kernels[n * 8 * 9 + 8 * i + 0], kernels[n * 8 * 9 + 8 * i + 1], kernels[n * 8 * 9 + 8 * i + 2], kernels[n * 8 * 9 + 8 * i + 3]);
            const vec4 k1 = vec4(kernels[n * 8 * 9 + 8 * i + 4], kernels[n * 8 * 9 + 8 * i + 5], kernels[n * 8 * 9 + 8 * i + 6], kernels[n * 8 * 9 + 8 * i + 7]);
            sum[n] += (dot(k0, r[i][0]) + dot(k1, r[i][1]));
        }
    }

    return ACTIVE(vec4(sum[0], sum[1], sum[2], sum[3]));
}

//!HOOK LUMA
//!DESC ARNet b16 Layer30 L0
//!WHEN OUTPUT.w LUMA.w / 1.2 > OUTPUT.h LUMA.h / 1.2 > *
//!BIND TMP1_L0
//!BIND TMP1_L1
//!BIND TMP2_L0
//!SAVE TMP2_L0
//!COMPONENTS 4

#define ACTIVE(v) (v)

#define TEX_BIND_L0_TEXOFF TMP1_L0_texOff
#define TEX_BIND_L0_TEX TMP1_L0_tex
#define TEX_BIND_L0_POS TMP1_L0_pos
#define TEX_BIND_L0_SIZE TMP1_L0_size
#define TEX_BIND_L0_PT TMP1_L0_pt

#define TEX_BIND_L1_TEXOFF TMP1_L1_texOff
#define TEX_BIND_L1_TEX TMP1_L1_tex
#define TEX_BIND_L1_POS TMP1_L1_pos
#define TEX_BIND_L1_SIZE TMP1_L1_size
#define TEX_BIND_L1_PT TMP1_L1_pt

#define TEX_BIND_L2_TEXOFF TMP2_L0_texOff
#define TEX_BIND_L2_TEX TMP2_L0_tex
#define TEX_BIND_L2_POS TMP2_L0_pos
#define TEX_BIND_L2_SIZE TMP2_L0_size
#define TEX_BIND_L2_PT TMP2_L0_pt

const float kernels[288] = float[288](
  +0.0856778f, +0.1319154f, +0.0128361f, -0.0381104f, -0.0143607f, +0.0933099f, +0.2299824f, -0.3546545f,
  +0.0240174f, -0.2128211f, +0.0346046f, -0.0373169f, +0.6001412f, -0.5512024f, +1.0613179f, -0.5540364f,
  -0.2049926f, +0.0226710f, +0.0530269f, -0.0859497f, +0.0994999f, +0.0095094f, +0.4890684f, -0.1591685f,
  +0.2787256f, +0.0462068f, +0.2093910f, -0.3017317f, +0.1348020f, +0.1096717f, +0.0532664f, -0.4018711f,
  +0.3706743f, -0.2423985f, +0.1719518f, +0.0487172f, +0.8277600f, +0.4117154f, -0.0538909f, +0.3445392f,
  -0.1894054f, -0.0207096f, -0.1505194f, -0.0479138f, +0.0134516f, +0.0892706f, +0.0168964f, +0.2189576f,
  +0.1370602f, +0.0183628f, +0.1650516f, -0.1332612f, -0.0220499f, -0.1505471f, +0.0292743f, -0.0818673f,
  +0.2131133f, -0.0982402f, +0.0261565f, -0.0035475f, +0.0326876f, +0.1109711f, -0.1402940f, +0.0086997f,
  +0.1363878f, +0.0981045f, -0.0472945f, -0.0547391f, -0.0377746f, -0.0577460f, +0.0928596f, -0.0160174f,
  -0.0557373f, +0.1176746f, -0.1054217f, -0.1515565f, +0.1378226f, +0.1900985f, -0.1141658f, +0.2193755f,
  -0.0832731f, -0.0865773f, -0.9256557f, -0.1054301f, -0.0503009f, -0.0009338f, -0.0682906f, -0.2578686f,
  +0.0709202f, +0.1484339f, -0.2607903f, -0.0515575f, +0.0085394f, -0.0790003f, -0.1455185f, -0.1306573f,
  +0.2400127f, +0.1183826f, +0.0466234f, -0.0266626f, -0.3004809f, +0.1848761f, -0.0088002f, -0.0464080f,
  -0.3009107f, -0.2769935f, +0.0861342f, -0.1841037f, +0.3258185f, +0.0212443f, +0.0779962f, +0.0320505f,
  -0.1551570f, +0.1356155f, +0.0282714f, +0.0084535f, -0.1772121f, -0.0151764f, -0.1154577f, -0.2044489f,
  -0.2645737f, +0.0063750f, -0.0993242f, -0.0297265f, -0.2186292f, +0.1417876f, -0.0950269f, -0.0907140f,
  -0.2613942f, +0.2155643f, +0.0063875f, -0.1162479f, -0.0925992f, +0.1905231f, -0.1108794f, -0.0182556f,
  -0.2104954f, +0.0105935f, -0.0865725f, -0.0775656f, -0.0367985f, -0.0374026f, -0.1217185f, -0.0619951f,
  +0.0322544f, +0.0111386f, +0.1039563f, +0.1041337f, +0.0299170f, -0.0560009f, -0.0329283f, -0.1565734f,
  +0.6207716f, +0.1527388f, +0.6685035f, -0.1936526f, +0.0095137f, -0.2702403f, +0.0405960f, -0.1722114f,
  -0.3264942f, -0.1395702f, +1.0482188f, +0.1193871f, +0.1424299f, +0.2600851f, +0.4980328f, -0.0511715f,
  +0.1070314f, -0.1294333f, +0.0043532f, +0.1531515f, +0.2287471f, +0.0245398f, -0.0310573f, -0.1028222f,
  -0.2057174f, -1.5675627f, +0.1743563f, +0.2244463f, +0.2676404f, -0.4305677f, -0.0538071f, -0.1684106f,
  -0.5463178f, -0.0268327f, +0.3149928f, -0.0537990f, +0.6881711f, -0.2033297f, +0.1489352f, -0.3112784f,
  +0.0666277f, +0.0277866f, -0.0520270f, +0.1124781f, +0.1645526f, +0.1114081f, +0.0642479f, +0.0982917f,
  -0.0651822f, +0.2539415f, +0.0316942f, +0.1062763f, -0.4071311f, -0.1360673f, +0.0561005f, -0.0306278f,
  -0.0381678f, +0.0560242f, -0.0431465f, +0.1789038f, +0.1928637f, +0.0888389f, -0.2490377f, +0.0103529f,
  +0.2154746f, +0.1677605f, -0.1244445f, +0.1942933f, -0.0021347f, +0.0846417f, -0.0282830f, -0.2087963f,
  +0.0248937f, -0.1119446f, +0.0850336f, +0.1289282f, +0.2932198f, -0.1941520f, +0.2139692f, -0.2701965f,
  -0.2813958f, +0.1105672f, -0.3400201f, +0.0391620f, +0.1454479f, +0.1324025f, +0.2185457f, -0.0068504f,
  -0.1970503f, -0.4735363f, -0.1981868f, +0.3040400f, -0.0550116f, +0.0714004f, +0.1432309f, +0.0491705f,
  -0.1513129f, -0.2294169f, -0.1032637f, +0.1082963f, -0.1014330f, +0.3736908f, -0.2225594f, -0.4763632f,
  +0.0487457f, -0.0682884f, +0.0733510f, +0.1439614f, +0.2696085f, +0.0614080f, +0.1652502f, +0.2861065f,
  +0.0441791f, +0.0306368f, -0.1223946f, +0.2004662f, +0.1064107f, -0.0067921f, -0.1842447f, -0.0823336f,
  -0.0112708f, -0.0433621f, -0.0898002f, +0.0831154f, +0.2164444f, +0.1251738f, +0.2345622f, +0.0245473f,
  -0.1366655f, -0.0031521f, -0.1801874f, -0.0495069f, -0.2405418f, +0.2414669f, +0.0412165f, +0.2313848f
);

const float biases[4] = float[4](
  +0.0383096f, +0.0231679f, +0.0307912f, -0.0133147f
);

vec4 hook() {
    const vec4 r[9][2] = vec4[9][2](
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 1.0f)))
    );

    float sum[4] = biases;
    for (int n = 0; n < 4; n++) {
        for (int i = 0; i < 9; i++) {
            const vec4 k0 = vec4(kernels[n * 8 * 9 + 8 * i + 0], kernels[n * 8 * 9 + 8 * i + 1], kernels[n * 8 * 9 + 8 * i + 2], kernels[n * 8 * 9 + 8 * i + 3]);
            const vec4 k1 = vec4(kernels[n * 8 * 9 + 8 * i + 4], kernels[n * 8 * 9 + 8 * i + 5], kernels[n * 8 * 9 + 8 * i + 6], kernels[n * 8 * 9 + 8 * i + 7]);
            sum[n] += (dot(k0, r[i][0]) + dot(k1, r[i][1]));
        }
    }

    return ACTIVE(vec4(sum[0], sum[1], sum[2], sum[3]) * 0.2000000f + TEX_BIND_L2_TEXOFF(vec2(0.0f, 0.0f)));
}

//!HOOK LUMA
//!DESC ARNet b16 Layer30 L1
//!WHEN OUTPUT.w LUMA.w / 1.2 > OUTPUT.h LUMA.h / 1.2 > *
//!BIND TMP1_L0
//!BIND TMP1_L1
//!BIND TMP2_L1
//!SAVE TMP2_L1
//!COMPONENTS 4

#define ACTIVE(v) (v)

#define TEX_BIND_L0_TEXOFF TMP1_L0_texOff
#define TEX_BIND_L0_TEX TMP1_L0_tex
#define TEX_BIND_L0_POS TMP1_L0_pos
#define TEX_BIND_L0_SIZE TMP1_L0_size
#define TEX_BIND_L0_PT TMP1_L0_pt

#define TEX_BIND_L1_TEXOFF TMP1_L1_texOff
#define TEX_BIND_L1_TEX TMP1_L1_tex
#define TEX_BIND_L1_POS TMP1_L1_pos
#define TEX_BIND_L1_SIZE TMP1_L1_size
#define TEX_BIND_L1_PT TMP1_L1_pt

#define TEX_BIND_L2_TEXOFF TMP2_L1_texOff
#define TEX_BIND_L2_TEX TMP2_L1_tex
#define TEX_BIND_L2_POS TMP2_L1_pos
#define TEX_BIND_L2_SIZE TMP2_L1_size
#define TEX_BIND_L2_PT TMP2_L1_pt

const float kernels[288] = float[288](
  -0.0325661f, -0.0651917f, -0.0446612f, +0.1307777f, +0.1689914f, +0.0245139f, +0.1613633f, -0.0267046f,
  -0.0786492f, -0.0152912f, +0.0857745f, +0.2236143f, +0.1008451f, +0.0520386f, -0.2420513f, +0.3314373f,
  +0.0940321f, -0.1338838f, -0.1179949f, -0.0127447f, -0.2176520f, +0.2502793f, -0.4662738f, +0.1377270f,
  +0.2304775f, -0.0012238f, +0.1135138f, +0.1161211f, -0.0887459f, +0.1696009f, -0.0052804f, -0.0237715f,
  +0.1625271f, +0.3058350f, +0.1164038f, +0.1617329f, -0.2164690f, -0.0342513f, +0.0636002f, -0.0380562f,
  -0.0451875f, +0.1363139f, -0.1026609f, +0.0610338f, -0.2673567f, -0.0661115f, -0.2469326f, -0.0441782f,
  +0.0495425f, +0.1222704f, +0.0704757f, +0.0732493f, -0.0693474f, -0.0586552f, +0.0207978f, -0.0238613f,
  +0.1086962f, +0.0534693f, +0.0147596f, +0.1262105f, -0.0306794f, +0.0283237f, -0.0375919f, +0.1062302f,
  +0.1853068f, +0.0065426f, +0.0217010f, +0.0060356f, -0.0626039f, +0.0292439f, -0.0272148f, +0.0260187f,
  -0.0109247f, -0.1599745f, +0.1295254f, +0.1500646f, +0.0707733f, -0.1916140f, +0.0977477f, +0.1115106f,
  +0.1503681f, +0.0561812f, -0.0848242f, +0.0892822f, -0.1444793f, -0.1632264f, -0.0679092f, +0.0088330f,
  -0.1307461f, -0.1200665f, +0.2282276f, +0.0529424f, +0.0726555f, +0.0228804f, +0.1760344f, +0.1205626f,
  -0.2978564f, +0.3164952f, +0.0120503f, +0.0538995f, -0.3397295f, -0.2812953f, +0.0210410f, +0.0375154f,
  +0.1681833f, +0.1709369f, -0.0983459f, -0.1191341f, -0.0813200f, -0.2450465f, -0.0993589f, +0.1070588f,
  +0.0985807f, +0.4374115f, +0.0315120f, -0.0703215f, +0.0824564f, +0.0772530f, +0.1065447f, +0.0543000f,
  +0.0797481f, -0.0763845f, +0.2127852f, -0.0436830f, -0.1366432f, -0.2398243f, -0.1127106f, -0.2588047f,
  +0.1066831f, -0.2121815f, -0.0479979f, -0.1528470f, +0.2370299f, +0.1855168f, -0.0254718f, -0.1856034f,
  -0.1542689f, -0.1876262f, -0.1420984f, -0.0388277f, +0.0644488f, +0.1539014f, +0.0536029f, -0.0288380f,
  -0.1922286f, -0.0686511f, -0.0093005f, -0.0625357f, -0.1305126f, -0.1228175f, -0.0208628f, -0.0600798f,
  +0.2259273f, -0.0147163f, +0.3084796f, -0.0124066f, +0.2638016f, -0.1382217f, +0.0949346f, +0.2313243f,
  -0.1854492f, -0.0962619f, +0.2445555f, -0.0414521f, +0.1032913f, -0.0334034f, +0.3614555f, -0.0211891f,
  +0.3200698f, +0.3257859f, +0.0238668f, -0.0563542f, +0.1472688f, +0.0031736f, -0.2384228f, -0.3886332f,
  +0.0553791f, -0.3710575f, +0.2443529f, -0.0932385f, -0.2721061f, -0.0524663f, +0.0260730f, -0.0561202f,
  +0.2543602f, -0.1100737f, +0.0391988f, -0.0396403f, +0.1914158f, -0.0713109f, +0.1205268f, +0.4883993f,
  +0.2930617f, -0.0152880f, +0.1612035f, -0.0148126f, +0.1662752f, -0.1473248f, +0.1205327f, -0.0496132f,
  +0.0197224f, -0.2056929f, -0.0705776f, -0.0136990f, +0.1760790f, +0.1597735f, -0.0524143f, +0.0552811f,
  +0.1998532f, +0.1227589f, +0.0356430f, +0.0217963f, -0.0174527f, +0.0424901f, +0.1228348f, +0.1793348f,
  -0.0072871f, -0.1081365f, -0.0229616f, -0.0441042f, +0.1278051f, -0.1738785f, +0.0782971f, +0.1767567f,
  -0.1868777f, -0.1388998f, -0.4389141f, +0.2254017f, +0.0602558f, -0.0807267f, +0.3272922f, -0.3730897f,
  +0.1491908f, -0.0206306f, +0.1517141f, +0.0226965f, -0.1101083f, +0.1354822f, -0.4356367f, +0.1031306f,
  -0.2438736f, +0.0016382f, -0.3897275f, +0.1597143f, -0.3423872f, +0.5586466f, -0.1615813f, -0.0510712f,
  +0.1829877f, -0.7231429f, +0.1724910f, +0.1647287f, +1.0994858f, +0.0871937f, +0.6252746f, -0.5287644f,
  +0.0220186f, -0.1203630f, +0.0138725f, -0.0508120f, -0.3539252f, -0.1109185f, -0.3721454f, -0.0935179f,
  +0.0768493f, +0.2055738f, +0.0211006f, +0.0929138f, -0.0743122f, -0.1685549f, -0.0759640f, -0.0377825f,
  -0.6035944f, +0.0303197f, -0.0972354f, +0.0016394f, +0.1279188f, -0.0775599f, -0.1220992f, -0.0395642f,
  +0.0474639f, +0.1383117f, -0.0212997f, -0.0979071f, -0.1455894f, +0.0499373f, -0.0747143f, -0.2012859f
);

const float biases[4] = float[4](
  +0.0298079f, -0.0046813f, +0.0072353f, +0.0099559f
);

vec4 hook() {
    const vec4 r[9][2] = vec4[9][2](
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 1.0f)))
    );

    float sum[4] = biases;
    for (int n = 0; n < 4; n++) {
        for (int i = 0; i < 9; i++) {
            const vec4 k0 = vec4(kernels[n * 8 * 9 + 8 * i + 0], kernels[n * 8 * 9 + 8 * i + 1], kernels[n * 8 * 9 + 8 * i + 2], kernels[n * 8 * 9 + 8 * i + 3]);
            const vec4 k1 = vec4(kernels[n * 8 * 9 + 8 * i + 4], kernels[n * 8 * 9 + 8 * i + 5], kernels[n * 8 * 9 + 8 * i + 6], kernels[n * 8 * 9 + 8 * i + 7]);
            sum[n] += (dot(k0, r[i][0]) + dot(k1, r[i][1]));
        }
    }

    return ACTIVE(vec4(sum[0], sum[1], sum[2], sum[3]) * 0.2000000f + TEX_BIND_L2_TEXOFF(vec2(0.0f, 0.0f)));
}

//!HOOK LUMA
//!DESC ARNet b16 Layer31 L0
//!WHEN OUTPUT.w LUMA.w / 1.2 > OUTPUT.h LUMA.h / 1.2 > *
//!BIND TMP2_L0
//!BIND TMP2_L1
//!SAVE TMP1_L0
//!COMPONENTS 4

#define ACTIVE(v) (max(v, v * 0.2000000f))

#define TEX_BIND_L0_TEXOFF TMP2_L0_texOff
#define TEX_BIND_L0_TEX TMP2_L0_tex
#define TEX_BIND_L0_POS TMP2_L0_pos
#define TEX_BIND_L0_SIZE TMP2_L0_size
#define TEX_BIND_L0_PT TMP2_L0_pt

#define TEX_BIND_L1_TEXOFF TMP2_L1_texOff
#define TEX_BIND_L1_TEX TMP2_L1_tex
#define TEX_BIND_L1_POS TMP2_L1_pos
#define TEX_BIND_L1_SIZE TMP2_L1_size
#define TEX_BIND_L1_PT TMP2_L1_pt

const float kernels[288] = float[288](
  -0.0860060f, -0.1659975f, +0.0413050f, -0.0314303f, +0.0421470f, -0.1095614f, -0.0778513f, -0.0168319f,
  -0.0687308f, -0.2144133f, -0.1309671f, +0.1002953f, +0.4204046f, +0.2022253f, +0.0783936f, -0.1253302f,
  -0.0301170f, +0.0358518f, +0.0368757f, +0.0072173f, -0.0963588f, +0.0808457f, -0.0188816f, -0.1084629f,
  +0.0261070f, +0.1453860f, +0.1644716f, +0.1433121f, +0.2041913f, +0.0033717f, +0.3413202f, -0.2296649f,
  +0.5110902f, +0.5654920f, +0.1777104f, -0.0685862f, +0.4474205f, -0.2017550f, +0.5758725f, -0.3490078f,
  -0.1229957f, -0.1998022f, -0.0121065f, +0.0021233f, -0.1256984f, -0.0133894f, -0.1776373f, +0.1629042f,
  -0.1078881f, +0.0811385f, -0.0289770f, +0.0173070f, +0.0088719f, -0.0714338f, +0.1364305f, -0.0228694f,
  -0.1616501f, -0.0679256f, +0.0144545f, +0.0049255f, -0.0680351f, -0.0099546f, +0.1458450f, -0.1878453f,
  +0.0320892f, +0.0911067f, -0.0337511f, -0.0278263f, -0.0883783f, +0.0055454f, +0.0292528f, -0.0505752f,
  +0.0426955f, +0.0524633f, -0.0284645f, +0.0105105f, -0.0719028f, +0.0493945f, +0.1177927f, -0.0170451f,
  -0.1884347f, -0.1708761f, -0.1176453f, +0.2688765f, -0.3288615f, +0.0849274f, +0.1011097f, +0.3069937f,
  -0.0444199f, +0.1278526f, +0.0987768f, +0.1142379f, -0.0388680f, -0.0661432f, -0.0379562f, -0.2779941f,
  -0.0932346f, +0.1951520f, +0.0779964f, +0.1355160f, +0.0640429f, -0.0165325f, +0.2675897f, +0.0224382f,
  -0.1568256f, +0.5740465f, -0.1517925f, +0.2590086f, -0.6555982f, +0.0405260f, +0.6240009f, -0.0353439f,
  -0.0301220f, +0.0246285f, -0.2697350f, +0.3782522f, +0.0841392f, -0.0938055f, -0.0535324f, -0.5870361f,
  +0.0769431f, +0.1647852f, +0.1199586f, +0.0515326f, +0.1251434f, +0.0841673f, +0.1942541f, +0.0085943f,
  -0.0108788f, +0.4296856f, +0.5066373f, +0.2194605f, -0.1282462f, +0.0959633f, +0.4501149f, -0.0148563f,
  +0.2541581f, +0.2628285f, +0.1039334f, -0.0922441f, -0.4466111f, +0.2011579f, +0.0510190f, +0.0601970f,
  +0.1517133f, -0.0024361f, +0.0033866f, +0.0036649f, -0.2703812f, -0.2697905f, -0.0464556f, +0.1967420f,
  +0.0559906f, -0.0159479f, -0.1184491f, -0.0572599f, +0.1157184f, +0.2314623f, -0.0750433f, -0.0270611f,
  +0.0506496f, +0.1508248f, +0.0672086f, -0.0606774f, +0.0681918f, -0.1049188f, +0.1223492f, +0.0455073f,
  -0.1424010f, +0.1623625f, -0.0810349f, +0.2143010f, -0.1404414f, -0.0093743f, -0.0512549f, +0.3818147f,
  -0.0131828f, -0.1918952f, -0.3247699f, +0.2231069f, -0.5839156f, +0.0261179f, -0.2679637f, -0.1141868f,
  -0.0794431f, +0.1445874f, +0.0188317f, +0.0884418f, -0.2435607f, -0.1088210f, +0.1750243f, +0.3722348f,
  +0.2467805f, +0.0074035f, +0.0121220f, +0.2241096f, +0.0453592f, +0.1032654f, +0.4997911f, +0.2857380f,
  +0.2458989f, +0.5706866f, -0.6920799f, +0.0073464f, -0.0087168f, -0.1594228f, -0.5349940f, -0.3191125f,
  -0.0948067f, +0.0044415f, +0.1729923f, +0.1525226f, -0.1396427f, -0.2752661f, +0.3702573f, +0.0721089f,
  +0.2217763f, +0.0808816f, -0.2212151f, -0.1722383f, +0.1492141f, +0.2423333f, -0.1899346f, -0.0574085f,
  -0.4309643f, +0.0295223f, +0.0479227f, +0.1062611f, -1.0086315f, -0.4046775f, +0.0130773f, +0.6525794f,
  -0.0020623f, -0.2855538f, -0.1502814f, +0.1690301f, -0.0290041f, +0.2479524f, -0.4326462f, +0.1557708f,
  +0.3471459f, +0.0829368f, -0.3886804f, +0.0751297f, +0.4123423f, -0.1823473f, +0.0764138f, +0.1150379f,
  -0.9353616f, +0.1634494f, +0.7087633f, +0.2862257f, -0.7652121f, +0.2196206f, +0.3844776f, -0.3213051f,
  +0.1129319f, -0.1625071f, +0.0962987f, -0.2688949f, +0.0285433f, +0.0575549f, -0.3027449f, -0.2734576f,
  -0.1267274f, -0.0134810f, -0.4789903f, +0.0203296f, -0.2358173f, -0.0104543f, -0.1634100f, +0.4223688f,
  -0.1419182f, +0.1385956f, +0.2222793f, +0.3017545f, -0.3746317f, -0.0003620f, +0.1880239f, -0.0785246f,
  -0.0949860f, -0.0767430f, -0.2312919f, +0.0253849f, -0.0987624f, +0.0717261f, -0.1319180f, +0.1586083f
);

const float biases[4] = float[4](
  +0.0071084f, -0.0652472f, -0.1412116f, +0.0115541f
);

vec4 hook() {
    const vec4 r[9][2] = vec4[9][2](
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 1.0f)))
    );

    float sum[4] = biases;
    for (int n = 0; n < 4; n++) {
        for (int i = 0; i < 9; i++) {
            const vec4 k0 = vec4(kernels[n * 8 * 9 + 8 * i + 0], kernels[n * 8 * 9 + 8 * i + 1], kernels[n * 8 * 9 + 8 * i + 2], kernels[n * 8 * 9 + 8 * i + 3]);
            const vec4 k1 = vec4(kernels[n * 8 * 9 + 8 * i + 4], kernels[n * 8 * 9 + 8 * i + 5], kernels[n * 8 * 9 + 8 * i + 6], kernels[n * 8 * 9 + 8 * i + 7]);
            sum[n] += (dot(k0, r[i][0]) + dot(k1, r[i][1]));
        }
    }

    return ACTIVE(vec4(sum[0], sum[1], sum[2], sum[3]));
}

//!HOOK LUMA
//!DESC ARNet b16 Layer31 L1
//!WHEN OUTPUT.w LUMA.w / 1.2 > OUTPUT.h LUMA.h / 1.2 > *
//!BIND TMP2_L0
//!BIND TMP2_L1
//!SAVE TMP1_L1
//!COMPONENTS 4

#define ACTIVE(v) (max(v, v * 0.2000000f))

#define TEX_BIND_L0_TEXOFF TMP2_L0_texOff
#define TEX_BIND_L0_TEX TMP2_L0_tex
#define TEX_BIND_L0_POS TMP2_L0_pos
#define TEX_BIND_L0_SIZE TMP2_L0_size
#define TEX_BIND_L0_PT TMP2_L0_pt

#define TEX_BIND_L1_TEXOFF TMP2_L1_texOff
#define TEX_BIND_L1_TEX TMP2_L1_tex
#define TEX_BIND_L1_POS TMP2_L1_pos
#define TEX_BIND_L1_SIZE TMP2_L1_size
#define TEX_BIND_L1_PT TMP2_L1_pt

const float kernels[288] = float[288](
  +0.1291068f, -0.0692442f, +0.0346485f, -0.1512346f, +0.2957079f, -0.0733997f, -0.2104730f, -0.1818011f,
  -0.1186160f, -0.1189556f, +0.1269843f, -0.0402318f, -0.0444419f, -0.7516012f, +0.1182113f, +0.5210275f,
  +0.2718711f, -0.0510288f, -0.1620510f, -0.0430441f, +0.0024951f, +0.2972161f, -0.3603931f, +0.0755236f,
  +0.2868284f, -0.2137594f, +0.1167192f, +0.0070831f, -0.2004436f, +0.0012142f, -0.2754370f, +0.0563757f,
  +0.0170523f, -0.1730840f, +0.9338781f, -0.4276546f, -0.0228243f, +0.3606500f, +0.4653671f, +0.0803218f,
  -0.0654923f, -0.2957555f, +0.1441614f, -0.1476906f, -0.0890808f, +0.1619424f, -0.3543779f, -0.3727323f,
  -0.0974580f, -0.1840251f, -0.2025519f, -0.1313161f, -0.5180153f, +0.0421584f, -0.2191948f, +0.0636743f,
  +0.3285834f, +0.1195749f, +0.2573299f, +0.4279614f, -0.2901624f, +0.0016095f, +0.2180756f, +0.1949134f,
  -0.2146614f, +0.1777551f, -0.2089238f, +0.0142242f, +0.5119746f, +0.1807494f, +0.2625746f, -0.1605144f,
  -0.0838606f, -0.2217367f, -0.2029534f, +0.1647232f, -0.1319918f, +0.0179007f, -0.0039394f, +0.1099443f,
  +0.0669134f, +0.1097182f, -0.0023477f, -0.1367441f, -0.5176495f, -0.1772106f, +0.1924813f, +0.3801076f,
  +0.1792355f, -0.2899846f, -0.0927061f, -0.1304519f, -0.2371213f, +0.0619237f, +0.0028021f, +0.3006744f,
  +0.2149765f, +0.5413938f, +0.1400216f, +0.2076874f, -0.0398035f, -0.0327907f, +0.1746121f, -0.1525531f,
  -0.0094580f, +0.4701960f, +0.1108372f, +0.0308680f, -0.3276428f, +0.1575840f, -0.4748643f, -0.3060612f,
  -0.5083047f, +0.0668081f, +0.0984944f, +0.2253094f, -0.3055093f, +0.0648270f, -0.2054112f, -0.0552432f,
  +0.0497853f, +0.0830445f, +0.2547700f, -0.1081399f, -0.1426533f, +0.0659729f, -0.0907218f, +0.1860876f,
  -0.4339728f, -0.3286659f, +0.3805027f, -0.2217465f, -0.1574050f, +0.1969388f, +0.2045155f, +0.2160498f,
  -0.0365483f, +0.0579810f, +0.2044638f, -0.1584593f, -0.3825316f, +0.2018903f, +0.0669852f, -0.1113879f,
  -0.0109491f, -0.0245573f, -0.0974639f, -0.0199411f, +0.4173069f, +0.1547384f, +0.0723086f, -0.3118547f,
  -0.2539102f, -0.3160138f, -0.0423565f, +0.2024699f, -0.1944769f, +0.1217233f, -0.0247650f, +0.3402912f,
  +0.0366236f, +0.0593851f, +0.0511224f, -0.0713879f, -0.0556869f, +0.0035912f, -0.1346373f, -0.0182175f,
  -0.0093592f, +0.0258593f, +0.0005354f, -0.0583981f, +0.7999325f, -0.1198943f, +0.0859249f, -0.4623356f,
  +0.1420151f, +0.0644192f, +0.1332367f, -0.1628930f, +0.4029177f, +0.0965635f, +0.2562693f, +0.2170196f,
  -0.0119634f, +0.0339691f, +0.0599033f, -0.1544458f, -0.1959566f, -0.0606905f, +0.0023404f, -0.0654952f,
  +0.0725518f, -0.0829031f, -0.0713181f, +0.0187557f, +0.3600932f, -0.1133569f, +0.0905295f, -0.2910856f,
  +0.0670771f, -0.2103927f, -0.0084871f, +0.1329048f, -0.3386983f, +0.0858757f, -0.4462803f, +0.3576373f,
  +0.0169236f, -0.0926300f, -0.0450177f, +0.0859408f, -0.0280511f, -0.0400946f, -0.0012034f, +0.0137821f,
  -0.0183240f, -0.1197553f, +0.0103738f, +0.0359306f, -0.2588371f, +0.0075894f, -0.1140202f, +0.1997882f,
  +0.0053879f, -0.2075048f, +0.1168713f, -0.1897055f, +0.4291023f, +0.1449154f, -0.2412065f, -0.2692978f,
  +0.1712630f, +0.2749058f, +0.0329012f, -0.1462266f, +0.0902537f, -0.1049927f, +0.3323072f, -0.0967647f,
  +0.0155196f, -0.0928289f, +0.0054036f, -0.0016755f, -0.3625583f, +0.0126824f, -0.1711787f, +0.1324371f,
  +0.2322560f, -0.0906208f, +0.3427151f, +0.0533655f, +0.6334279f, -0.0951188f, +0.0535056f, -0.3266049f,
  -0.0562794f, +0.2093457f, +0.1484050f, -0.2730744f, -0.0121181f, -0.0726030f, +0.5043276f, -0.2245380f,
  +0.0092737f, +0.0335598f, +0.1032555f, -0.0587454f, -0.3178656f, +0.0784659f, -0.2065556f, +0.1307542f,
  -0.1832903f, -0.0921206f, +0.2115358f, -0.1260103f, +0.2710509f, +0.1478765f, +0.1217540f, -0.1048857f,
  +0.2225561f, -0.0289619f, -0.0139259f, -0.0264352f, -0.2447338f, -0.0493057f, -0.0008581f, +0.0923042f
);

const float biases[4] = float[4](
  +0.0674751f, +0.0453801f, +0.0407250f, +0.0376207f
);

vec4 hook() {
    const vec4 r[9][2] = vec4[9][2](
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 1.0f)))
    );

    float sum[4] = biases;
    for (int n = 0; n < 4; n++) {
        for (int i = 0; i < 9; i++) {
            const vec4 k0 = vec4(kernels[n * 8 * 9 + 8 * i + 0], kernels[n * 8 * 9 + 8 * i + 1], kernels[n * 8 * 9 + 8 * i + 2], kernels[n * 8 * 9 + 8 * i + 3]);
            const vec4 k1 = vec4(kernels[n * 8 * 9 + 8 * i + 4], kernels[n * 8 * 9 + 8 * i + 5], kernels[n * 8 * 9 + 8 * i + 6], kernels[n * 8 * 9 + 8 * i + 7]);
            sum[n] += (dot(k0, r[i][0]) + dot(k1, r[i][1]));
        }
    }

    return ACTIVE(vec4(sum[0], sum[1], sum[2], sum[3]));
}

//!HOOK LUMA
//!DESC ARNet b16 Layer32 L0
//!WHEN OUTPUT.w LUMA.w / 1.2 > OUTPUT.h LUMA.h / 1.2 > *
//!BIND TMP1_L0
//!BIND TMP1_L1
//!BIND TMP2_L0
//!BIND FEAT_L0
//!SAVE TMP2_L0
//!COMPONENTS 4

#define ACTIVE(v) (v)

#define TEX_BIND_L0_TEXOFF TMP1_L0_texOff
#define TEX_BIND_L0_TEX TMP1_L0_tex
#define TEX_BIND_L0_POS TMP1_L0_pos
#define TEX_BIND_L0_SIZE TMP1_L0_size
#define TEX_BIND_L0_PT TMP1_L0_pt

#define TEX_BIND_L1_TEXOFF TMP1_L1_texOff
#define TEX_BIND_L1_TEX TMP1_L1_tex
#define TEX_BIND_L1_POS TMP1_L1_pos
#define TEX_BIND_L1_SIZE TMP1_L1_size
#define TEX_BIND_L1_PT TMP1_L1_pt

#define TEX_BIND_L2_TEXOFF TMP2_L0_texOff
#define TEX_BIND_L2_TEX TMP2_L0_tex
#define TEX_BIND_L2_POS TMP2_L0_pos
#define TEX_BIND_L2_SIZE TMP2_L0_size
#define TEX_BIND_L2_PT TMP2_L0_pt

#define TEX_BIND_L3_TEXOFF FEAT_L0_texOff
#define TEX_BIND_L3_TEX FEAT_L0_tex
#define TEX_BIND_L3_POS FEAT_L0_pos
#define TEX_BIND_L3_SIZE FEAT_L0_size
#define TEX_BIND_L3_PT FEAT_L0_pt

const float kernels[288] = float[288](
  -0.0651800f, -0.4889637f, -0.2324600f, -0.1917264f, +0.2133386f, -0.1761479f, -0.1394606f, -0.2138243f,
  +0.0965394f, +0.2372996f, -0.0961790f, +0.4709803f, -0.4551603f, -0.3527989f, -0.3934991f, +0.0267499f,
  +0.1836127f, -0.0227953f, +0.0029871f, -0.2940052f, +0.3609344f, -0.1567545f, -0.2941120f, +0.0967565f,
  -0.1278180f, +0.2788777f, -0.2286667f, -0.0810386f, +0.0853608f, -0.2283336f, +0.0764840f, +0.2886243f,
  -0.8345477f, +0.2638206f, +0.4448070f, -0.6333801f, +0.7864649f, +0.3039505f, -0.2481451f, -0.7766562f,
  -0.4329332f, -0.1370490f, +0.0057482f, +0.0295438f, +0.0571732f, +0.1262693f, -0.4219630f, +0.1002515f,
  +0.1225935f, -0.0459867f, -0.1089816f, +0.2449966f, -0.3450053f, -0.1496132f, +0.2273255f, +0.1426461f,
  -0.1081166f, +0.0114563f, +0.0611660f, -0.0241632f, +0.0758708f, -0.1854783f, +0.0521361f, +0.1168214f,
  -0.0479947f, +0.0395605f, -0.0540181f, +0.0918583f, -0.2129040f, -0.1279853f, -0.0148493f, +0.1034168f,
  -0.2572996f, +0.2076538f, +0.2501906f, +0.1191253f, +0.0694463f, +0.2893667f, +0.0795176f, +0.0517315f,
  -0.3231145f, +0.2309446f, +0.0679196f, +0.0124131f, +0.0743554f, -0.1318041f, +0.4009346f, +0.1930043f,
  +0.0431822f, +0.0122564f, -0.0977177f, +0.0452955f, -0.0584436f, +0.1178216f, +0.2356656f, -0.0916156f,
  -0.2975034f, -0.2830534f, -0.2407824f, -0.1508389f, +0.3473140f, +0.7038754f, -0.0388692f, -0.0659080f,
  -0.3252818f, -0.1286102f, -0.2656307f, +0.1162611f, +0.0464272f, -0.2773433f, -0.1049139f, +0.1190079f,
  +0.0510644f, +0.0859389f, +0.0857707f, -0.1407244f, +0.1976580f, +0.1355358f, -0.1032095f, +0.0375099f,
  -0.2017439f, -0.0332528f, +0.1852361f, +0.0968832f, +0.2567153f, +0.0589482f, +0.0680314f, -0.0829957f,
  +0.1051700f, +0.0122815f, +0.0274193f, -0.1707649f, +0.0499674f, +0.0175535f, +0.2014161f, +0.0999069f,
  +0.0423057f, +0.0134636f, +0.1266953f, +0.0545317f, +0.0534368f, +0.2785312f, -0.1441464f, +0.0112505f,
  +0.0923683f, +0.1350135f, -0.0134211f, -0.0038767f, +0.0757500f, -0.0454816f, +0.0159242f, -0.0400985f,
  +0.3737399f, +0.4328392f, -1.4141482f, +0.5231359f, -0.3682704f, -0.1111175f, -0.1577896f, -0.1918043f,
  -0.0295812f, +0.0794461f, -0.3531459f, -0.2054158f, +0.4365599f, -0.2113874f, -0.3683584f, +0.1615529f,
  +0.1358741f, -0.4425545f, +0.2186083f, +0.4669288f, -0.0903580f, -0.0852890f, -0.2918388f, -0.2405929f,
  +0.1877564f, -0.4747452f, -0.2024958f, +1.1916285f, -0.8887711f, +0.0279239f, -1.1363025f, -1.0013120f,
  -0.0705602f, -0.0187865f, -0.3030739f, +0.3020372f, +0.0925430f, -0.1475272f, -0.1048628f, +0.0644523f,
  -0.1242353f, -0.0026711f, -0.0065762f, -0.2895895f, +0.3628013f, +0.2782744f, -0.0852369f, -0.1869682f,
  +0.4779805f, -0.1395039f, +0.0556931f, -0.1934194f, +0.1102650f, +0.3833154f, +0.3336012f, +0.0432134f,
  -0.2156356f, -0.0543127f, +0.0593338f, +0.0652549f, +0.0206764f, +0.1442493f, -0.0503504f, -0.0592264f,
  +0.0472264f, +0.5099123f, +0.0669904f, +0.1790659f, -0.0846167f, +0.1538511f, +0.0171059f, +0.0085959f,
  +0.2914525f, +0.2180279f, +0.4426031f, +0.3142214f, -0.3352738f, -0.0198691f, -0.0720760f, +0.0744890f,
  +0.0698445f, -0.0539201f, +0.4129465f, -0.3864265f, +0.3862216f, -0.1747000f, +0.0049765f, -0.0765407f,
  +0.2161481f, +0.3042171f, +0.4160366f, +0.0505459f, +0.1881086f, +0.2385038f, +0.1704869f, +0.3648865f,
  -0.1711177f, -0.4365266f, -0.1205914f, -0.1133835f, +0.2963135f, -0.2319841f, -0.1382572f, -0.1210771f,
  +0.1304080f, +0.0350948f, -0.2757378f, -0.0374224f, +0.0218473f, +0.2423752f, -0.4287002f, +0.0926715f,
  +0.0738013f, +0.0732587f, +0.1735687f, +0.0767698f, -0.0356239f, +0.0323039f, +0.1345298f, +0.0355552f,
  -0.3474971f, +0.0334403f, +0.0684523f, -0.4679053f, +0.3123744f, +0.1066850f, +0.0574456f, -0.0065457f,
  +0.1914377f, -0.1870778f, +0.0887532f, -0.1033757f, +0.0482886f, +0.3053607f, +0.0700057f, +0.1161751f
);

const float biases[4] = float[4](
  -0.0140527f, -0.0041299f, +0.0759601f, +0.0362531f
);

vec4 hook() {
    const vec4 r[9][2] = vec4[9][2](
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 1.0f)))
    );

    float sum[4] = biases;
    for (int n = 0; n < 4; n++) {
        for (int i = 0; i < 9; i++) {
            const vec4 k0 = vec4(kernels[n * 8 * 9 + 8 * i + 0], kernels[n * 8 * 9 + 8 * i + 1], kernels[n * 8 * 9 + 8 * i + 2], kernels[n * 8 * 9 + 8 * i + 3]);
            const vec4 k1 = vec4(kernels[n * 8 * 9 + 8 * i + 4], kernels[n * 8 * 9 + 8 * i + 5], kernels[n * 8 * 9 + 8 * i + 6], kernels[n * 8 * 9 + 8 * i + 7]);
            sum[n] += (dot(k0, r[i][0]) + dot(k1, r[i][1]));
        }
    }

    return ACTIVE(vec4(sum[0], sum[1], sum[2], sum[3]) * 0.2000000f + TEX_BIND_L2_TEXOFF(vec2(0.0f, 0.0f)) + TEX_BIND_L3_TEXOFF(vec2(0.0f, 0.0f)));
}

//!HOOK LUMA
//!DESC ARNet b16 Layer32 L1
//!WHEN OUTPUT.w LUMA.w / 1.2 > OUTPUT.h LUMA.h / 1.2 > *
//!BIND TMP1_L0
//!BIND TMP1_L1
//!BIND TMP2_L1
//!BIND FEAT_L1
//!SAVE TMP2_L1
//!COMPONENTS 4

#define ACTIVE(v) (v)

#define TEX_BIND_L0_TEXOFF TMP1_L0_texOff
#define TEX_BIND_L0_TEX TMP1_L0_tex
#define TEX_BIND_L0_POS TMP1_L0_pos
#define TEX_BIND_L0_SIZE TMP1_L0_size
#define TEX_BIND_L0_PT TMP1_L0_pt

#define TEX_BIND_L1_TEXOFF TMP1_L1_texOff
#define TEX_BIND_L1_TEX TMP1_L1_tex
#define TEX_BIND_L1_POS TMP1_L1_pos
#define TEX_BIND_L1_SIZE TMP1_L1_size
#define TEX_BIND_L1_PT TMP1_L1_pt

#define TEX_BIND_L2_TEXOFF TMP2_L1_texOff
#define TEX_BIND_L2_TEX TMP2_L1_tex
#define TEX_BIND_L2_POS TMP2_L1_pos
#define TEX_BIND_L2_SIZE TMP2_L1_size
#define TEX_BIND_L2_PT TMP2_L1_pt

#define TEX_BIND_L3_TEXOFF FEAT_L1_texOff
#define TEX_BIND_L3_TEX FEAT_L1_tex
#define TEX_BIND_L3_POS FEAT_L1_pos
#define TEX_BIND_L3_SIZE FEAT_L1_size
#define TEX_BIND_L3_PT FEAT_L1_pt

const float kernels[288] = float[288](
  +0.0820382f, +0.0062192f, +0.0989287f, +0.2205147f, -0.0737709f, +0.0933560f, +0.0552323f, +0.2121556f,
  -0.1986098f, +0.2430117f, -0.0564508f, -0.0690039f, +0.0468554f, +0.0606150f, +0.0517190f, -0.0078528f,
  -0.0522313f, +0.0291298f, -0.1666458f, +0.0369528f, +0.0321116f, +0.1536025f, -0.0954961f, +0.0938360f,
  -0.1391152f, -0.1727436f, -0.1459347f, +0.0687643f, +0.0649994f, +0.3169666f, -0.0332766f, +0.1690117f,
  -0.1810545f, +0.3386510f, -0.0499356f, -0.0707039f, +0.0363748f, +0.0385054f, -0.2819758f, -0.0852577f,
  +0.1482185f, +0.1602995f, +0.0276039f, +0.0787280f, -0.1126372f, -0.0915264f, -0.1957988f, -0.0392933f,
  +0.0387901f, -0.1153643f, -0.0024329f, -0.0964876f, +0.0457159f, +0.1938075f, +0.1805229f, +0.1118971f,
  -0.2772396f, -0.0433083f, -0.0447833f, +0.1887088f, -0.1127826f, -0.0686760f, +0.0704911f, -0.0522485f,
  -0.0581460f, +0.0347892f, +0.0087850f, -0.0566423f, -0.0027361f, -0.0002970f, +0.0128548f, +0.1020225f,
  +0.0967119f, +0.1548511f, -0.1222397f, +0.1352347f, -0.0543899f, +0.0062092f, -0.0007066f, -0.0340221f,
  -0.1530950f, +0.2057035f, -0.2890207f, +0.0717444f, +0.1601970f, -0.0355092f, -0.1835763f, +0.2447442f,
  +0.0207118f, +0.0654807f, +0.1176605f, +0.0620500f, +0.0317940f, -0.2255086f, +0.0057434f, +0.1059775f,
  -0.2213687f, +0.5600796f, -0.0742419f, -0.3445267f, -0.0386969f, -0.1826480f, -0.2007287f, +0.1333000f,
  +0.2418067f, +0.2623640f, +0.2050461f, +0.5583039f, -0.4446415f, -0.2757158f, -0.3619371f, -0.2780003f,
  +0.0678582f, -0.0103050f, -0.2075488f, -0.1005543f, +0.0949881f, +0.1716674f, -0.0119744f, +0.0877432f,
  +0.0868662f, +0.0555666f, +0.0169539f, +0.2105046f, -0.2972241f, -0.4231254f, +0.2626189f, +0.1968565f,
  -0.2868373f, +0.0460844f, +0.2119538f, -0.4146871f, +0.5416648f, +0.0756076f, -0.1247896f, -0.0689443f,
  +0.1995050f, -0.1443523f, +0.0522686f, +0.1831304f, -0.1075989f, +0.1357016f, -0.2245966f, +0.1474197f,
  +0.0094045f, -0.2851893f, -0.2316107f, -0.0696600f, +0.0081584f, -0.2687195f, -0.0320065f, +0.1058698f,
  -0.0500868f, +0.0731870f, -0.0978548f, +0.0134083f, -0.1550227f, +0.2865981f, -0.1793188f, +0.2201703f,
  +0.0401100f, -0.0856764f, +0.2664413f, -0.1576304f, +0.1678555f, -0.2403358f, -0.1763788f, +0.0499110f,
  +0.2383357f, -0.0993317f, -0.0898928f, -0.0425911f, -0.1503685f, -0.5049062f, -0.0727779f, -0.2708579f,
  +0.0666675f, +0.0680668f, +0.0652265f, +0.3215003f, -0.1291128f, -0.3727786f, +0.0374026f, -0.0540561f,
  -0.3238417f, -0.1576057f, +0.0660647f, -0.0192032f, -0.0771436f, -0.0643236f, +0.1002476f, +0.0902845f,
  +0.0012885f, -0.0331458f, -0.0953835f, -0.0018804f, -0.1402369f, -0.1654094f, -0.1152814f, -0.0590045f,
  -0.0534956f, +0.1747978f, +0.0385849f, +0.2623651f, -0.2204166f, +0.1695812f, -0.0072545f, +0.0690178f,
  +0.1538886f, -0.0133848f, -0.1587210f, -0.0759577f, -0.0321906f, -0.2477534f, +0.0385089f, -0.0395507f,
  +0.2191121f, +0.1915999f, +0.0976336f, +0.2029733f, -0.0746821f, -0.0218106f, -0.1288809f, +0.1423285f,
  +0.0580378f, +0.2498861f, -0.0055024f, -0.1618052f, +0.1977431f, -0.3136664f, -0.2618020f, +0.1194222f,
  +0.1388206f, +0.0556548f, +0.1016777f, -0.0420658f, +0.0111660f, +0.1790146f, -0.0919944f, +0.0871806f,
  -0.4788158f, -0.6381663f, -0.1878130f, -0.2525109f, +0.3152640f, +0.1848225f, +0.1234101f, +0.6030192f,
  -0.0705547f, -0.1494246f, -0.3079889f, +0.2737450f, +0.1349641f, -0.7149765f, -0.3373952f, +0.3749809f,
  +0.5991158f, +0.0494808f, +0.1081047f, +0.2382888f, -0.2483531f, +0.0855519f, +0.1074538f, -0.0151116f,
  +0.2313890f, -0.3065141f, -0.0368997f, -0.0206760f, +0.0329101f, +0.1551726f, +0.1550593f, +0.1838556f,
  +0.0376835f, +0.2049772f, -0.0400943f, +0.4783567f, -0.4505561f, +0.0476576f, +0.0759106f, -0.0809172f,
  +0.2668512f, +0.0434429f, +0.0063587f, -0.1370824f, +0.0245920f, +0.0283241f, +0.1431638f, +0.0779092f
);

const float biases[4] = float[4](
  +0.0393375f, -0.0136826f, -0.0059021f, -0.0226174f
);

vec4 hook() {
    const vec4 r[9][2] = vec4[9][2](
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 1.0f)))
    );

    float sum[4] = biases;
    for (int n = 0; n < 4; n++) {
        for (int i = 0; i < 9; i++) {
            const vec4 k0 = vec4(kernels[n * 8 * 9 + 8 * i + 0], kernels[n * 8 * 9 + 8 * i + 1], kernels[n * 8 * 9 + 8 * i + 2], kernels[n * 8 * 9 + 8 * i + 3]);
            const vec4 k1 = vec4(kernels[n * 8 * 9 + 8 * i + 4], kernels[n * 8 * 9 + 8 * i + 5], kernels[n * 8 * 9 + 8 * i + 6], kernels[n * 8 * 9 + 8 * i + 7]);
            sum[n] += (dot(k0, r[i][0]) + dot(k1, r[i][1]));
        }
    }

    return ACTIVE(vec4(sum[0], sum[1], sum[2], sum[3]) * 0.2000000f + TEX_BIND_L2_TEXOFF(vec2(0.0f, 0.0f)) + TEX_BIND_L3_TEXOFF(vec2(0.0f, 0.0f)));
}

//!HOOK LUMA
//!DESC ARNet b16 Layer33 L0
//!WHEN OUTPUT.w LUMA.w / 1.2 > OUTPUT.h LUMA.h / 1.2 > *
//!BIND TMP2_L0
//!BIND TMP2_L1
//!SAVE TMP1_L0
//!COMPONENTS 4

#define ACTIVE(v) (v)

#define TEX_BIND_L0_TEXOFF TMP2_L0_texOff
#define TEX_BIND_L0_TEX TMP2_L0_tex
#define TEX_BIND_L0_POS TMP2_L0_pos
#define TEX_BIND_L0_SIZE TMP2_L0_size
#define TEX_BIND_L0_PT TMP2_L0_pt

#define TEX_BIND_L1_TEXOFF TMP2_L1_texOff
#define TEX_BIND_L1_TEX TMP2_L1_tex
#define TEX_BIND_L1_POS TMP2_L1_pos
#define TEX_BIND_L1_SIZE TMP2_L1_size
#define TEX_BIND_L1_PT TMP2_L1_pt

const float kernels[288] = float[288](
  +0.0209450f, -0.0325142f, +0.0486878f, -0.0212331f, +0.0164131f, +0.0565594f, -0.0807478f, -0.0347869f,
  -0.0150050f, +0.2324238f, +0.1223318f, -0.0679288f, -0.1012299f, -0.3283781f, +0.1792924f, +0.1273416f,
  +0.1046382f, +0.0370927f, -0.0497687f, -0.0481580f, +0.0106978f, +0.0674541f, -0.0789373f, +0.0020213f,
  +0.0215002f, -0.0497096f, +0.0238477f, -0.0792762f, +0.0887938f, -0.0797482f, -0.0879693f, -0.0314527f,
  -0.2448881f, +0.0431980f, +0.0363068f, -0.1671755f, -0.1449447f, -0.0269696f, +0.3847722f, -0.0859659f,
  -0.0944941f, +0.0291944f, +0.0119927f, -0.0340616f, -0.1452902f, +0.1412243f, +0.0104221f, -0.0286028f,
  +0.0137832f, -0.0296233f, +0.0415372f, +0.0174419f, -0.0225817f, +0.0136893f, +0.0159323f, -0.0669773f,
  +0.1250357f, +0.0309708f, -0.0338949f, +0.0245593f, -0.2997513f, -0.0697111f, -0.0538003f, +0.1072869f,
  -0.1124288f, +0.0205171f, -0.0105881f, +0.0026759f, +0.1513655f, +0.0466938f, +0.1131357f, -0.0752814f,
  +0.0290836f, +0.0352999f, +0.0505060f, -0.0030321f, -0.0147587f, -0.0411963f, +0.0186243f, -0.0007871f,
  +0.0476741f, +0.2255679f, +0.0440180f, -0.0477618f, -0.1071943f, -0.0934315f, +0.1153811f, -0.0388488f,
  -0.0238530f, +0.0075690f, -0.0008431f, +0.0102723f, +0.0129553f, +0.0304119f, +0.0422518f, +0.0515217f,
  +0.0200470f, -0.0305748f, +0.0769286f, +0.0164286f, -0.1444936f, +0.0075691f, -0.0752453f, +0.1009539f,
  -0.3250177f, +0.0337498f, -0.4189493f, -0.0382785f, -0.0607757f, -0.1375088f, +0.2440419f, -0.1202462f,
  +0.0122315f, +0.2002624f, +0.0083454f, -0.0500773f, +0.0554906f, +0.0407265f, +0.2012704f, +0.0731885f,
  -0.0058922f, -0.0182039f, -0.0040767f, +0.0078923f, -0.0770658f, +0.0019334f, -0.0299043f, +0.0273099f,
  +0.0770086f, +0.0436896f, -0.0428683f, -0.0188144f, +0.0847683f, -0.0799741f, +0.0467254f, -0.0898256f,
  -0.0142147f, -0.0214491f, +0.0399598f, -0.0151619f, -0.0803028f, -0.0207526f, -0.0473810f, +0.0091550f,
  +0.0187255f, -0.0371502f, +0.0069206f, -0.0284197f, +0.0835163f, +0.0261337f, -0.0597281f, -0.0489525f,
  -0.0145830f, +0.0910908f, +0.0151829f, +0.0228292f, -0.0597776f, -0.0645685f, +0.0924996f, +0.0337039f,
  +0.0370797f, +0.1096753f, -0.0037493f, -0.0634204f, -0.0281382f, +0.0231207f, +0.0332884f, +0.0056464f,
  +0.0993705f, -0.0578558f, +0.0834102f, -0.0437042f, +0.0359482f, -0.0897024f, -0.1295544f, +0.0363800f,
  -0.1390660f, +0.1074087f, +0.1200574f, -0.1268628f, -0.0625160f, -0.2091764f, +0.3393344f, +0.2399082f,
  -0.0242161f, -0.1287334f, -0.0253789f, -0.0086254f, -0.1180233f, +0.0927500f, -0.1057612f, -0.0120305f,
  +0.0072922f, -0.0845362f, +0.0510515f, -0.0053183f, -0.2634181f, +0.0017188f, -0.0932510f, +0.0117436f,
  +0.2311920f, +0.0740028f, -0.0114820f, +0.0748899f, -0.2499554f, -0.1879970f, +0.1823391f, -0.1041447f,
  -0.0595714f, +0.1310040f, +0.0167645f, -0.0500449f, +0.1264207f, +0.0713914f, +0.1817977f, -0.0679413f,
  -0.0093916f, -0.0210876f, +0.0015746f, +0.0050762f, -0.0661622f, -0.0071107f, -0.0362066f, +0.0296820f,
  +0.0188268f, +0.1332534f, -0.0176120f, +0.0409388f, -0.0001853f, +0.1168840f, +0.1094585f, -0.0732437f,
  -0.0032282f, +0.0908187f, +0.0465699f, -0.0667652f, +0.0134636f, -0.0308925f, +0.1130888f, -0.0442103f,
  +0.0029791f, -0.0027799f, +0.0776279f, -0.0868433f, +0.0525851f, -0.0675672f, -0.0652176f, -0.0446633f,
  -0.0982557f, +0.0834463f, -0.2100393f, +0.0940808f, -0.1134213f, -0.2784122f, +0.2003530f, +0.2120124f,
  +0.0084964f, -0.0095450f, -0.0552611f, +0.0123823f, -0.1678356f, +0.0857291f, -0.0183943f, +0.3198918f,
  +0.0721250f, +0.0411564f, +0.0578413f, +0.1060655f, -0.0000952f, -0.0326214f, +0.1637008f, -0.0410413f,
  +0.0610866f, -0.0027337f, -0.1560250f, -0.1429094f, -0.3128097f, -0.0967952f, -0.1053658f, -0.0223833f,
  +0.0425755f, +0.0264839f, +0.0809569f, +0.0084372f, -0.0070432f, -0.0872266f, +0.0387499f, -0.0553375f
);

const float biases[4] = float[4](
  +0.1108628f, +0.0724183f, +0.0964408f, +0.0653192f
);

vec4 hook() {
    const vec4 r[9][2] = vec4[9][2](
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 1.0f)))
    );

    float sum[4] = biases;
    for (int n = 0; n < 4; n++) {
        for (int i = 0; i < 9; i++) {
            const vec4 k0 = vec4(kernels[n * 8 * 9 + 8 * i + 0], kernels[n * 8 * 9 + 8 * i + 1], kernels[n * 8 * 9 + 8 * i + 2], kernels[n * 8 * 9 + 8 * i + 3]);
            const vec4 k1 = vec4(kernels[n * 8 * 9 + 8 * i + 4], kernels[n * 8 * 9 + 8 * i + 5], kernels[n * 8 * 9 + 8 * i + 6], kernels[n * 8 * 9 + 8 * i + 7]);
            sum[n] += (dot(k0, r[i][0]) + dot(k1, r[i][1]));
        }
    }

    return ACTIVE(vec4(sum[0], sum[1], sum[2], sum[3]));
}

//!HOOK LUMA
//!DESC ACNet b16 Layer34 L0
//!WIDTH LUMA.w 2 *
//!HEIGHT LUMA.h 2 *
//!BIND TMP1_L0
//!COMPONENTS 1

#define TEX_BIND_L0_TEXOFF TMP1_L0_texOff
#define TEX_BIND_L0_TEX TMP1_L0_tex
#define TEX_BIND_L0_POS TMP1_L0_pos
#define TEX_BIND_L0_SIZE TMP1_L0_size
#define TEX_BIND_L0_PT TMP1_L0_pt

vec4 hook() {
    vec2 fcoord = fract(TEX_BIND_L0_POS * TEX_BIND_L0_SIZE);
    vec2 pos = TEX_BIND_L0_POS + (vec2(0.5f) - fcoord) * TEX_BIND_L0_PT;

    ivec2 icoord = ivec2(fcoord * vec2(2.0f));
    int index = icoord.y * 2 + icoord.x;

    vec4 r = TEX_BIND_L0_TEX(pos);

    return vec4(clamp(float[4](r.x, r.y, r.z, r.w)[index], 0.0f, 1.0f), 0.0f, 0.0f, 1.0f);
}
