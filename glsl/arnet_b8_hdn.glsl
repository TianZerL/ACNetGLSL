//!HOOK LUMA
//!DESC ARNet b8 Layer0 L0
//!WHEN OUTPUT.w LUMA.w / 1.2 > OUTPUT.h LUMA.h / 1.2 > *
//!BIND LUMA
//!SAVE FEAT_L0
//!COMPONENTS 4

#define ACTIVE(v) (v)

#define TEX_BIND_L0_TEXOFF LUMA_texOff
#define TEX_BIND_L0_TEX LUMA_tex
#define TEX_BIND_L0_POS LUMA_pos
#define TEX_BIND_L0_SIZE LUMA_size
#define TEX_BIND_L0_PT LUMA_pt

const float kernels[36] = float[36](
  -0.0700158f, +0.4415122f, -0.5134112f, -0.7694165f, -0.3936599f, +0.0018523f, +0.2476678f, -0.0896018f,
  +0.2422174f, -0.0987214f, -0.1455769f, +0.6865664f, +0.7903975f, -0.6782202f, -0.3891829f, +0.1219715f,
  -0.3104000f, -0.3035257f, -0.3404290f, -0.6199630f, +0.7241663f, +0.6135918f, -0.2745941f, -0.1654325f,
  +0.1455836f, +0.3723129f, -0.4801668f, +0.6006140f, +0.2093495f, -0.2213839f, +0.5679414f, -0.1374718f,
  -0.3499088f, -0.2372531f, -0.2002145f, -0.0694304f
);

const float biases[4] = float[4](
  +0.0077387f, +0.0399411f, +0.0027573f, -0.0036509f
);

vec4 hook() {
    const vec4 r0 = vec4(
        TEX_BIND_L0_TEXOFF(vec2(-1.0f,-1.0f)).x,
        TEX_BIND_L0_TEXOFF(vec2( 0.0f,-1.0f)).x,
        TEX_BIND_L0_TEXOFF(vec2( 1.0f,-1.0f)).x,
        TEX_BIND_L0_TEXOFF(vec2(-1.0f, 0.0f)).x
    );
    const vec4 r4 = vec4(
        TEX_BIND_L0_TEXOFF(vec2( 0.0f, 0.0f)).x,
        TEX_BIND_L0_TEXOFF(vec2( 1.0f, 0.0f)).x,
        TEX_BIND_L0_TEXOFF(vec2(-1.0f, 1.0f)).x,
        TEX_BIND_L0_TEXOFF(vec2( 0.0f, 1.0f)).x
    );
    const float r8 = TEX_BIND_L0_TEXOFF(vec2( 1.0f, 1.0f)).x;

    float sum[4] = biases;
    for(int n = 0; n < 4; n++) {
        const vec4 k0 = vec4(kernels[n * 9 + 0], kernels[n * 9 + 1], kernels[n * 9 + 2], kernels[n * 9 + 3]);
        const vec4 k4 = vec4(kernels[n * 9 + 4], kernels[n * 9 + 5], kernels[n * 9 + 6], kernels[n * 9 + 7]);
        const float k8 = kernels[n * 9 + 8];
        sum[n] += (dot(r0, k0) + dot(r4, k4) + r8 * k8);
    }

    return ACTIVE(vec4(sum[0], sum[1], sum[2], sum[3]));
}

//!HOOK LUMA
//!DESC ARNet b8 Layer0 L1
//!WHEN OUTPUT.w LUMA.w / 1.2 > OUTPUT.h LUMA.h / 1.2 > *
//!BIND LUMA
//!SAVE FEAT_L1
//!COMPONENTS 4

#define ACTIVE(v) (v)

#define TEX_BIND_L0_TEXOFF LUMA_texOff
#define TEX_BIND_L0_TEX LUMA_tex
#define TEX_BIND_L0_POS LUMA_pos
#define TEX_BIND_L0_SIZE LUMA_size
#define TEX_BIND_L0_PT LUMA_pt

const float kernels[36] = float[36](
  +0.4318263f, -0.8424419f, +0.7730514f, -0.1652798f, +0.0560975f, +0.3144271f, +0.2371309f, -0.0665478f,
  -0.2518055f, +0.0241266f, -0.2084122f, +0.1755609f, -0.2496180f, +0.4103389f, -0.3686407f, -0.0555841f,
  +0.3159688f, -0.1070067f, +0.0125057f, -0.3571698f, -0.2802780f, +0.1829564f, +0.7538602f, -0.0438347f,
  -0.3272779f, +0.5653500f, -0.1314542f, -0.5564492f, +0.4538505f, +0.0157019f, -0.1954238f, -0.0202352f,
  +0.5376091f, -0.2769113f, +0.5212792f, +0.3269993f
);

const float biases[4] = float[4](
  -0.0628658f, +0.0214872f, -0.0598829f, -0.0620569f
);

vec4 hook() {
    const vec4 r0 = vec4(
        TEX_BIND_L0_TEXOFF(vec2(-1.0f,-1.0f)).x,
        TEX_BIND_L0_TEXOFF(vec2( 0.0f,-1.0f)).x,
        TEX_BIND_L0_TEXOFF(vec2( 1.0f,-1.0f)).x,
        TEX_BIND_L0_TEXOFF(vec2(-1.0f, 0.0f)).x
    );
    const vec4 r4 = vec4(
        TEX_BIND_L0_TEXOFF(vec2( 0.0f, 0.0f)).x,
        TEX_BIND_L0_TEXOFF(vec2( 1.0f, 0.0f)).x,
        TEX_BIND_L0_TEXOFF(vec2(-1.0f, 1.0f)).x,
        TEX_BIND_L0_TEXOFF(vec2( 0.0f, 1.0f)).x
    );
    const float r8 = TEX_BIND_L0_TEXOFF(vec2( 1.0f, 1.0f)).x;

    float sum[4] = biases;
    for(int n = 0; n < 4; n++) {
        const vec4 k0 = vec4(kernels[n * 9 + 0], kernels[n * 9 + 1], kernels[n * 9 + 2], kernels[n * 9 + 3]);
        const vec4 k4 = vec4(kernels[n * 9 + 4], kernels[n * 9 + 5], kernels[n * 9 + 6], kernels[n * 9 + 7]);
        const float k8 = kernels[n * 9 + 8];
        sum[n] += (dot(r0, k0) + dot(r4, k4) + r8 * k8);
    }

    return ACTIVE(vec4(sum[0], sum[1], sum[2], sum[3]));
}

//!HOOK LUMA
//!DESC ARNet b8 Layer1 L0
//!WHEN OUTPUT.w LUMA.w / 1.2 > OUTPUT.h LUMA.h / 1.2 > *
//!BIND FEAT_L0
//!BIND FEAT_L1
//!SAVE TMP1_L0
//!COMPONENTS 4

#define ACTIVE(v) (max(v, v * 0.2000000f))

#define TEX_BIND_L0_TEXOFF FEAT_L0_texOff
#define TEX_BIND_L0_TEX FEAT_L0_tex
#define TEX_BIND_L0_POS FEAT_L0_pos
#define TEX_BIND_L0_SIZE FEAT_L0_size
#define TEX_BIND_L0_PT FEAT_L0_pt

#define TEX_BIND_L1_TEXOFF FEAT_L1_texOff
#define TEX_BIND_L1_TEX FEAT_L1_tex
#define TEX_BIND_L1_POS FEAT_L1_pos
#define TEX_BIND_L1_SIZE FEAT_L1_size
#define TEX_BIND_L1_PT FEAT_L1_pt

const float kernels[288] = float[288](
  -0.1446697f, +0.0547552f, +0.3586360f, -0.0317097f, -0.0384407f, +0.1223258f, -0.0538821f, -0.3271312f,
  -0.2982461f, +0.2137129f, -0.0625222f, +0.4240987f, +0.0956539f, -0.2460687f, +0.3388394f, +0.1458692f,
  -0.0856384f, -0.1195193f, +0.0418250f, -0.1835640f, +0.0559516f, -0.3012762f, +0.3232217f, +0.1722354f,
  +0.1794097f, +0.3079035f, +0.1938810f, +0.1391485f, -0.1621594f, -0.1255629f, +0.2660192f, +0.5200283f,
  -0.4721641f, -0.1867399f, +0.0582859f, -0.0896277f, +0.0081983f, +0.5813100f, +0.1275249f, +0.1972716f,
  -0.0804405f, +0.0248418f, -0.3650086f, +0.1515483f, -0.0872056f, -0.2088523f, +0.2712245f, -0.0115972f,
  +0.0955044f, +0.0178351f, +0.3884311f, +0.0231486f, -0.1526488f, +0.5515719f, +0.0315912f, -0.1532572f,
  -0.0556107f, +0.0178788f, -0.0342961f, +0.1767575f, -0.4677089f, -0.1232984f, +0.0918140f, +0.2808473f,
  +0.2417491f, +0.1005153f, -0.2594088f, +0.1686773f, +0.2825200f, +0.2577845f, +0.0097189f, -0.0545050f,
  +0.1194696f, +0.1206752f, -0.0422061f, -0.0274537f, -0.2662688f, -0.2432638f, -0.0567479f, +0.0591137f,
  +0.0411353f, -0.3085863f, +0.0237613f, -0.0431190f, +0.0146963f, +0.0465514f, -0.1728108f, -0.0221116f,
  +0.2649499f, -0.3868766f, +0.1258776f, -0.2774896f, -0.2284026f, +0.0272347f, -0.0791615f, +0.2109988f,
  +0.2804297f, -0.0127613f, -0.1575004f, +0.0268817f, -0.5220501f, +0.7348960f, -0.2230811f, -0.1637325f,
  -0.1434320f, +0.2901977f, -0.1670530f, +0.0923521f, -0.0798986f, -0.0920442f, -0.0727718f, +0.0381430f,
  +0.2068930f, +0.0975474f, +0.2269220f, -0.1674453f, -0.0184531f, +0.4070435f, +0.2041208f, -0.1955195f,
  +0.2013013f, +0.1498243f, +0.0269554f, +0.2041313f, -0.5075306f, +0.4844849f, +0.0094286f, -0.2408417f,
  -0.0825698f, +0.4008025f, -0.4797959f, +0.4347301f, -0.0854341f, -0.1887608f, -0.3363421f, +0.2128596f,
  +0.1667482f, +0.0376502f, -0.0246344f, -0.0039033f, -0.0545800f, +0.1132418f, +0.1244789f, +0.0741186f,
  -0.0446475f, -0.1538782f, +0.1583531f, +0.1165236f, +0.0681655f, +0.0067115f, -0.0354944f, +0.1237437f,
  -0.2718844f, -0.4004095f, +0.0292913f, +0.1511810f, +0.2544226f, +0.4659014f, +0.3729675f, +0.1948431f,
  +0.0075554f, +0.0953186f, -0.1395013f, +0.1951281f, -0.0248716f, +0.1017408f, +0.0817313f, -0.0719857f,
  +0.1967416f, -0.1966916f, +0.1279281f, -0.1757168f, +0.1671434f, -0.3588578f, +0.1477247f, -0.1804822f,
  -0.3258850f, -0.3637208f, -0.3339517f, +0.1478061f, +0.3763862f, +0.6844206f, +0.6554052f, -0.4997952f,
  -0.1754913f, +0.0050077f, +0.1102538f, +0.0180100f, +0.2942246f, -0.3021865f, -0.2992603f, +0.1185614f,
  +0.0817057f, -0.1675770f, +0.0032688f, -0.2096431f, -0.4438963f, -0.1739476f, +0.2422997f, -0.4374040f,
  +0.1063654f, -0.0905288f, +0.3541711f, +0.1167015f, +0.0112150f, -0.6018971f, -0.0608915f, +0.2011003f,
  -0.2142129f, -0.1449030f, -0.0110007f, -0.1218396f, -0.0397641f, -0.2016946f, +0.3096742f, -0.2694997f,
  -0.2456559f, -0.4508716f, +0.3533973f, -0.3321416f, +0.3413503f, +0.4630486f, +0.1863070f, -0.1466491f,
  -0.0377891f, +0.0402898f, +0.0284093f, +0.1467391f, -0.0009178f, -0.7111168f, +0.0093559f, -0.3987557f,
  -0.2301521f, +0.0557810f, +0.1687397f, +0.2427704f, -0.1778927f, -0.7222262f, -0.0369528f, +0.1542471f,
  -0.0675480f, +0.0530976f, +0.2171925f, +0.2172695f, -0.0161409f, +0.2845293f, -0.2060918f, +0.0429923f,
  +0.1367363f, +0.1225793f, -0.1949904f, +0.6322644f, -0.2659760f, -0.8998978f, -0.5417250f, +0.2591809f,
  +0.4476967f, -0.0060763f, -0.4819730f, -0.1357643f, +0.3750517f, +0.4365986f, -0.3082404f, -0.0849223f,
  +0.0031217f, -0.0450574f, +0.0437437f, -0.2749004f, -0.1819965f, -0.4451816f, +0.0168468f, -0.0034957f,
  -0.1636464f, -0.0319737f, +0.0148133f, -0.0036207f, +0.2382242f, -0.0059888f, +0.0540346f, -0.1785132f,
  -0.2394888f, +0.0426558f, -0.1023472f, -0.0128678f, -0.2883718f, +0.3711055f, +0.0834100f, +0.0178303f
);

const float biases[4] = float[4](
  +0.0551249f, -0.2023488f, +0.1960711f, +0.0055569f
);

vec4 hook() {
    const vec4 r[9][2] = vec4[9][2](
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 1.0f)))
    );

    float sum[4] = biases;
    for (int n = 0; n < 4; n++) {
        for (int i = 0; i < 9; i++) {
            const vec4 k0 = vec4(kernels[n * 8 * 9 + 8 * i + 0], kernels[n * 8 * 9 + 8 * i + 1], kernels[n * 8 * 9 + 8 * i + 2], kernels[n * 8 * 9 + 8 * i + 3]);
            const vec4 k1 = vec4(kernels[n * 8 * 9 + 8 * i + 4], kernels[n * 8 * 9 + 8 * i + 5], kernels[n * 8 * 9 + 8 * i + 6], kernels[n * 8 * 9 + 8 * i + 7]);
            sum[n] += (dot(k0, r[i][0]) + dot(k1, r[i][1]));
        }
    }

    return ACTIVE(vec4(sum[0], sum[1], sum[2], sum[3]));
}

//!HOOK LUMA
//!DESC ARNet b8 Layer1 L1
//!WHEN OUTPUT.w LUMA.w / 1.2 > OUTPUT.h LUMA.h / 1.2 > *
//!BIND FEAT_L0
//!BIND FEAT_L1
//!SAVE TMP1_L1
//!COMPONENTS 4

#define ACTIVE(v) (max(v, v * 0.2000000f))

#define TEX_BIND_L0_TEXOFF FEAT_L0_texOff
#define TEX_BIND_L0_TEX FEAT_L0_tex
#define TEX_BIND_L0_POS FEAT_L0_pos
#define TEX_BIND_L0_SIZE FEAT_L0_size
#define TEX_BIND_L0_PT FEAT_L0_pt

#define TEX_BIND_L1_TEXOFF FEAT_L1_texOff
#define TEX_BIND_L1_TEX FEAT_L1_tex
#define TEX_BIND_L1_POS FEAT_L1_pos
#define TEX_BIND_L1_SIZE FEAT_L1_size
#define TEX_BIND_L1_PT FEAT_L1_pt

const float kernels[288] = float[288](
  +0.0117651f, +0.1801537f, +0.0665276f, +0.0617719f, -0.0843593f, -0.1081501f, +0.3501443f, -0.0049988f,
  -0.1266301f, +0.1798818f, +0.1229780f, +0.2533651f, -0.2644665f, -0.4961765f, -0.1364257f, -0.0736458f,
  -0.0532710f, -0.0173336f, +0.0582357f, +0.2428962f, +0.1239584f, -0.1791042f, +0.0613629f, +0.1773455f,
  +0.1067142f, +0.0239811f, +0.1921390f, -0.1374024f, -0.0062238f, +0.0422908f, +0.1093135f, +0.0156420f,
  +0.0329412f, -0.3349024f, +0.0318643f, +0.1436707f, +0.2406401f, -0.0849270f, +0.2501879f, +0.2075905f,
  -0.1974086f, -0.1199826f, -0.0890592f, -0.0235821f, -0.1133392f, +0.5229195f, -0.0267264f, -0.1897315f,
  +0.3121949f, -0.0039694f, +0.1707792f, +0.1061310f, -0.0436706f, -0.0617586f, -0.1630394f, +0.1406533f,
  -0.3211993f, -0.0639835f, +0.0824274f, +0.2799793f, +0.1564839f, -0.0367808f, +0.1369521f, -0.0423162f,
  +0.0352171f, +0.2020762f, +0.0322296f, +0.0255293f, -0.0466312f, +0.2296580f, +0.1104125f, +0.2289636f,
  -0.1269517f, +0.1149659f, -0.2666796f, -0.1641761f, +0.1653547f, +0.0083780f, -0.0281031f, +0.0495590f,
  +0.0229518f, -0.1419594f, -0.1367000f, +0.1447638f, +0.1611104f, +0.3177517f, -0.0362648f, +0.2547373f,
  +0.4153059f, -0.1860121f, -0.0697192f, -0.2600867f, +0.2040717f, +0.8671963f, -0.1125741f, +0.0918193f,
  -0.2299151f, -0.2755319f, -0.2194972f, -0.0359875f, +0.0495322f, -0.6851914f, +0.0949078f, -0.0233641f,
  -0.3059143f, -0.3526107f, -0.1320770f, +0.0075870f, +0.1751515f, +0.1439728f, +0.4001258f, +0.3444978f,
  -0.2327568f, -0.0317568f, +0.0924421f, +0.4126425f, +0.0082567f, +0.5335079f, -0.0123726f, -0.2069446f,
  +0.1548711f, +0.1064462f, -0.0193405f, +0.3029038f, +0.1925258f, -0.0877714f, +0.1198396f, +0.0855617f,
  +0.1856307f, +0.2690598f, +0.3008414f, +0.0594557f, +0.0816715f, +0.0888277f, -0.0564390f, +0.0012717f,
  -0.0062066f, -0.0245895f, -0.0297744f, +0.1635667f, +0.1965700f, -0.0183129f, +0.0062131f, +0.1435098f,
  -0.0109048f, +0.0070254f, +0.1156515f, -0.0441176f, -0.0200650f, -0.2665173f, +0.0997551f, +0.1611046f,
  +0.2341984f, +0.1005516f, -0.1011063f, -0.1848964f, +0.2185127f, +0.2763718f, +0.0432380f, +0.0716172f,
  +0.1422718f, +0.3932878f, -0.1229302f, -0.1271603f, -0.0487188f, -0.0581075f, +0.0510489f, +0.0621919f,
  +0.0408847f, +0.0408060f, -0.0617880f, +0.0192655f, +0.2417192f, +0.2280391f, -0.0844844f, +0.1148912f,
  -0.2440489f, -0.0778809f, -0.1203401f, +0.2353886f, -0.1207757f, -0.6573063f, +0.0917971f, -0.0590744f,
  -0.0367522f, +0.0153003f, -0.0770003f, -0.0864362f, -0.0371480f, -0.0037528f, -0.0377869f, -0.0011716f,
  -0.1946556f, -0.2564660f, +0.0804330f, -0.1020170f, +0.1310346f, -0.0521086f, +0.0078266f, -0.0237403f,
  +0.0564099f, -0.0317324f, -0.1846747f, +0.1249808f, +0.0413680f, +0.1585003f, -0.0345378f, +0.0085166f,
  -0.0758013f, -0.0529463f, -0.0058141f, +0.0167553f, +0.0104471f, +0.2293182f, -0.1653339f, +0.2097551f,
  -0.1464542f, -0.1337339f, -0.0715892f, -0.0499151f, -0.1498861f, -0.1809111f, -0.0615087f, -0.0351065f,
  -0.1313603f, +0.0243160f, -0.2048358f, +0.0185739f, -0.0128863f, +0.1017289f, -0.4325909f, +0.0505589f,
  -0.0794197f, -0.0345326f, +0.0741530f, -0.0864834f, -0.1187705f, -0.0010555f, +0.1570424f, +0.1916740f,
  -0.2850797f, -0.0200054f, -0.1264480f, -0.0109289f, +0.0433027f, +0.0150799f, -0.2153116f, +0.0146107f,
  -0.0260225f, -0.2160029f, +0.1453797f, +0.0251119f, -0.1093089f, -0.0030704f, -0.1272037f, +0.3020905f,
  +0.2413058f, -0.2311504f, -0.1452751f, -0.4087802f, +0.1011605f, +0.6620095f, -0.0580547f, +0.3795940f,
  +0.0122218f, -0.0100224f, -0.0307911f, -0.0399206f, -0.0910583f, -0.1918500f, -0.0188035f, +0.0100581f,
  -0.0846934f, +0.0978169f, +0.1100870f, -0.3753964f, +0.0025560f, -0.0718100f, +0.1968100f, -0.3428883f,
  +0.2102916f, +0.0184367f, -0.0129849f, -0.1610331f, -0.2505589f, +0.4894923f, +0.0000286f, -0.2620574f
);

const float biases[4] = float[4](
  +0.0953916f, +0.1772730f, +0.1279179f, +0.0644629f
);

vec4 hook() {
    const vec4 r[9][2] = vec4[9][2](
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 1.0f)))
    );

    float sum[4] = biases;
    for (int n = 0; n < 4; n++) {
        for (int i = 0; i < 9; i++) {
            const vec4 k0 = vec4(kernels[n * 8 * 9 + 8 * i + 0], kernels[n * 8 * 9 + 8 * i + 1], kernels[n * 8 * 9 + 8 * i + 2], kernels[n * 8 * 9 + 8 * i + 3]);
            const vec4 k1 = vec4(kernels[n * 8 * 9 + 8 * i + 4], kernels[n * 8 * 9 + 8 * i + 5], kernels[n * 8 * 9 + 8 * i + 6], kernels[n * 8 * 9 + 8 * i + 7]);
            sum[n] += (dot(k0, r[i][0]) + dot(k1, r[i][1]));
        }
    }

    return ACTIVE(vec4(sum[0], sum[1], sum[2], sum[3]));
}

//!HOOK LUMA
//!DESC ARNet b8 Layer2 L0
//!WHEN OUTPUT.w LUMA.w / 1.2 > OUTPUT.h LUMA.h / 1.2 > *
//!BIND TMP1_L0
//!BIND TMP1_L1
//!BIND FEAT_L0
//!SAVE TMP2_L0
//!COMPONENTS 4

#define ACTIVE(v) (v)

#define TEX_BIND_L0_TEXOFF TMP1_L0_texOff
#define TEX_BIND_L0_TEX TMP1_L0_tex
#define TEX_BIND_L0_POS TMP1_L0_pos
#define TEX_BIND_L0_SIZE TMP1_L0_size
#define TEX_BIND_L0_PT TMP1_L0_pt

#define TEX_BIND_L1_TEXOFF TMP1_L1_texOff
#define TEX_BIND_L1_TEX TMP1_L1_tex
#define TEX_BIND_L1_POS TMP1_L1_pos
#define TEX_BIND_L1_SIZE TMP1_L1_size
#define TEX_BIND_L1_PT TMP1_L1_pt

#define TEX_BIND_L2_TEXOFF FEAT_L0_texOff
#define TEX_BIND_L2_TEX FEAT_L0_tex
#define TEX_BIND_L2_POS FEAT_L0_pos
#define TEX_BIND_L2_SIZE FEAT_L0_size
#define TEX_BIND_L2_PT FEAT_L0_pt

const float kernels[288] = float[288](
  -0.0626916f, +0.0135663f, +0.0989461f, +0.0163831f, -0.0722731f, +0.1356228f, +0.0323610f, +0.0984084f,
  -0.1228262f, -0.0972820f, -0.1968073f, -0.0675447f, +0.1822486f, +0.0245432f, -0.1999858f, +0.0215703f,
  +0.1070818f, -0.0294319f, +0.1889595f, -0.1120897f, +0.0295971f, +0.1310865f, -0.0369266f, +0.0878731f,
  +0.0038715f, -0.2141718f, +0.1220176f, -0.1601619f, +0.1641216f, +0.1474115f, +0.0130960f, +0.0852950f,
  +0.1819557f, +0.0555755f, +0.1362817f, +0.0063492f, +0.2736271f, -0.0866647f, +0.4119869f, -0.0872464f,
  +0.4564452f, -0.2062006f, -0.1280976f, +0.0663635f, -0.0805516f, +0.2626639f, +0.0614665f, +0.0517992f,
  +0.0538405f, +0.0383703f, -0.2368408f, -0.0916861f, +0.0568047f, -0.0576483f, +0.1042321f, -0.1061048f,
  +0.0286084f, -0.3440386f, +0.2018300f, -0.2992571f, -0.2647845f, +0.0885065f, +0.1969625f, -0.0645622f,
  -0.1698385f, +0.2838775f, -0.2170934f, -0.1618844f, -0.0860593f, +0.1750431f, +0.0649409f, -0.1874878f,
  -0.2147042f, +0.2080700f, -0.0947347f, +0.1209321f, -0.1617855f, +0.3304413f, -0.1148545f, +0.1339176f,
  -0.0603065f, +0.1369330f, +0.0954271f, +0.2211557f, -0.0411841f, +0.0698831f, +0.0552348f, +0.3511031f,
  -0.3004199f, +0.4013317f, -0.2947714f, +0.0508475f, +0.0911885f, -0.2330130f, -0.0213066f, -0.1680204f,
  +0.1284981f, -0.3070156f, -0.1832458f, +0.1368451f, -0.3502520f, -0.2351507f, -0.2214537f, +0.2946833f,
  +0.0100286f, -0.3421168f, -0.1896997f, -0.4368403f, +0.3198838f, -0.1055086f, -0.1957204f, -0.1335327f,
  -0.1407600f, +0.0293322f, +0.4074333f, +0.1729376f, +0.3565148f, -0.0529384f, -0.0225805f, -0.1681276f,
  -0.0510452f, -0.0647427f, -0.1437849f, -0.0735661f, -0.1222068f, -0.1084102f, +0.1261446f, -0.0651916f,
  +0.2883334f, +0.1327023f, +0.4506022f, -0.1963277f, +0.2447487f, +0.3427629f, -0.1210596f, -0.0244385f,
  +0.1607275f, -0.4278806f, +0.2051396f, +0.1906611f, -0.0804587f, +0.1718660f, +0.5040628f, +0.0193336f,
  +0.0461987f, -0.5098733f, -0.0607961f, +0.1086451f, +0.3555855f, +0.0377678f, -0.0422000f, -0.3096803f,
  -0.0091074f, +0.1368082f, +0.4428835f, +0.1877851f, -0.1693361f, -0.1878608f, -0.0065651f, -0.2974925f,
  -0.1083609f, -0.1230550f, -0.1176441f, +0.0521652f, -0.0219259f, -0.2246825f, -0.0124939f, -0.3028605f,
  -0.0032008f, +0.1347276f, -0.1768186f, +0.4321246f, -0.3009390f, +0.4374891f, +0.0260860f, -0.1702725f,
  -0.2710772f, +0.1015940f, -0.0392815f, +0.5046902f, -0.0110100f, +0.1731979f, +0.1700487f, -0.3041539f,
  -0.2270355f, +0.1729605f, -0.0326104f, -0.2562621f, -0.0380840f, +0.1725542f, -0.0561199f, -0.1065501f,
  -0.1483232f, -0.4119658f, -0.1121282f, -0.0083389f, +0.0245623f, +0.0838129f, +0.0594993f, +0.0462971f,
  -0.4143305f, -0.3569341f, +0.1331810f, -0.5761254f, -0.3630602f, -0.1883609f, -0.1639542f, +0.1393565f,
  +0.0421952f, -0.2518640f, +0.0966294f, -0.3163913f, +0.3480732f, +0.2182786f, +0.4057310f, -0.1383217f,
  -0.1526568f, -0.1892824f, -0.0743739f, -0.0198778f, -0.3447258f, -0.3014426f, -0.0911041f, -0.2152635f,
  +0.3111421f, +0.0292159f, +0.0816091f, -0.4388075f, -0.1039480f, -0.2152026f, -0.0702274f, -0.2815898f,
  +0.0072159f, +0.2663889f, +0.0549351f, -0.1214830f, -0.0018859f, +0.0538632f, +0.0881027f, +0.1672151f,
  -0.2689621f, +0.3211048f, +0.2147837f, -0.3395669f, -0.1191085f, -0.2120536f, -0.3141544f, -0.1539526f,
  -0.2307582f, -0.1335113f, -0.5323757f, -0.6489283f, -0.3463644f, -0.1499726f, -0.0669243f, -0.3189243f,
  +0.1014983f, -0.2825150f, +0.1200157f, -0.1005423f, -0.1718174f, +0.1296153f, +0.0513850f, -0.0266218f,
  -0.0626620f, -0.1184694f, +0.1824380f, -0.2993484f, +0.0282513f, -0.0210296f, +0.1342445f, -0.1442519f,
  +0.1713673f, +0.0899192f, +0.1135691f, +0.2473204f, +0.1749636f, +0.3215434f, +0.1440225f, -0.0733384f,
  +0.0578716f, +0.2054198f, +0.1789051f, +0.1502034f, +0.0525595f, +0.1626378f, +0.2682641f, +0.0986397f
);

const float biases[4] = float[4](
  +0.1902865f, +0.0484911f, +0.1233419f, +0.1988578f
);

vec4 hook() {
    const vec4 r[9][2] = vec4[9][2](
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 1.0f)))
    );

    float sum[4] = biases;
    for (int n = 0; n < 4; n++) {
        for (int i = 0; i < 9; i++) {
            const vec4 k0 = vec4(kernels[n * 8 * 9 + 8 * i + 0], kernels[n * 8 * 9 + 8 * i + 1], kernels[n * 8 * 9 + 8 * i + 2], kernels[n * 8 * 9 + 8 * i + 3]);
            const vec4 k1 = vec4(kernels[n * 8 * 9 + 8 * i + 4], kernels[n * 8 * 9 + 8 * i + 5], kernels[n * 8 * 9 + 8 * i + 6], kernels[n * 8 * 9 + 8 * i + 7]);
            sum[n] += (dot(k0, r[i][0]) + dot(k1, r[i][1]));
        }
    }

    return ACTIVE(vec4(sum[0], sum[1], sum[2], sum[3]) * 0.2000000f + TEX_BIND_L2_TEXOFF(vec2(0.0f, 0.0f)));
}

//!HOOK LUMA
//!DESC ARNet b8 Layer2 L1
//!WHEN OUTPUT.w LUMA.w / 1.2 > OUTPUT.h LUMA.h / 1.2 > *
//!BIND TMP1_L0
//!BIND TMP1_L1
//!BIND FEAT_L1
//!SAVE TMP2_L1
//!COMPONENTS 4

#define ACTIVE(v) (v)

#define TEX_BIND_L0_TEXOFF TMP1_L0_texOff
#define TEX_BIND_L0_TEX TMP1_L0_tex
#define TEX_BIND_L0_POS TMP1_L0_pos
#define TEX_BIND_L0_SIZE TMP1_L0_size
#define TEX_BIND_L0_PT TMP1_L0_pt

#define TEX_BIND_L1_TEXOFF TMP1_L1_texOff
#define TEX_BIND_L1_TEX TMP1_L1_tex
#define TEX_BIND_L1_POS TMP1_L1_pos
#define TEX_BIND_L1_SIZE TMP1_L1_size
#define TEX_BIND_L1_PT TMP1_L1_pt

#define TEX_BIND_L2_TEXOFF FEAT_L1_texOff
#define TEX_BIND_L2_TEX FEAT_L1_tex
#define TEX_BIND_L2_POS FEAT_L1_pos
#define TEX_BIND_L2_SIZE FEAT_L1_size
#define TEX_BIND_L2_PT FEAT_L1_pt

const float kernels[288] = float[288](
  -0.0158781f, +0.3662105f, -0.1951834f, +0.0620932f, -0.1368681f, +0.0856143f, -0.1758136f, +0.1034359f,
  -0.0845026f, +0.0305628f, +0.2613613f, -0.0383542f, -0.1891499f, +0.2994334f, +0.0692317f, +0.0721167f,
  -0.2455073f, +0.2354935f, +0.0366826f, +0.0316521f, +0.0979587f, -0.4452313f, -0.0458034f, -0.1796678f,
  +0.1358993f, +0.2886764f, -0.1584561f, -0.0158738f, +0.2132505f, +0.1607773f, -0.2309073f, +0.1921202f,
  -0.0746889f, +0.0685993f, -0.3735856f, +0.1809815f, +0.0079204f, +0.2190811f, +0.0402842f, +0.1806378f,
  -0.2932692f, +0.0571567f, +0.0031978f, -0.2998259f, -0.0043136f, -0.1210637f, -0.0485406f, -0.3570110f,
  -0.0779268f, +0.4410997f, -0.0993908f, -0.1995582f, -0.3316579f, -0.0959262f, -0.1553589f, +0.2057386f,
  +0.2315404f, -0.2395629f, -0.1472468f, +0.2053129f, +0.0585676f, +0.0115845f, +0.0550018f, +0.2286052f,
  -0.2165037f, +0.0080470f, +0.3123165f, -0.3959049f, +0.1494121f, -0.0187014f, -0.0948844f, -0.1647835f,
  -0.1999532f, +0.2400432f, -0.2660474f, +0.2435432f, +0.1270896f, +0.1490193f, -0.1397699f, +0.0292888f,
  -0.2867260f, -0.2057488f, +0.1887841f, +0.3060902f, -0.1515395f, +0.4117917f, +0.0862449f, -0.2690994f,
  -0.3535120f, -0.0108789f, -0.0625158f, +0.2855185f, -0.1658363f, +0.1636311f, -0.0810392f, +0.0062700f,
  -0.0685441f, +0.0629320f, +0.0356527f, +0.4080251f, +0.0783835f, +0.4023846f, -0.5472671f, +0.1646998f,
  +0.0192052f, -0.2514401f, +0.2530490f, +0.8709750f, -0.2884455f, -0.0598287f, +0.0875977f, +0.0951262f,
  +0.1033396f, -0.1782599f, +0.0057109f, +0.2135131f, -0.1730772f, +0.2073624f, +0.1098057f, +0.1049708f,
  -0.0248410f, -0.1950630f, +0.0321333f, +0.2523358f, -0.0020671f, +0.1733592f, +0.1422271f, +0.0676152f,
  -0.3581846f, +0.1392939f, -0.4959267f, +0.3857522f, +0.0942368f, -0.0449283f, +0.3200082f, +0.1327216f,
  +0.0412161f, +0.0734917f, -0.0962726f, +0.2172059f, -0.1102706f, +0.0476421f, +0.0208983f, +0.0231478f,
  -0.0050916f, +0.0972637f, +0.0796902f, -0.0041802f, -0.0986641f, +0.0360902f, +0.1727580f, +0.3613221f,
  -0.0014994f, -0.1607931f, +0.2611125f, +0.0842471f, -0.1024258f, +0.1159140f, -0.1178784f, +0.5559691f,
  -0.1023591f, +0.0272776f, +0.1545348f, +0.1827007f, +0.0708631f, +0.1126060f, +0.1099482f, +0.3296413f,
  -0.0515888f, +0.2723456f, -0.2524135f, -0.1738938f, +0.2535892f, +0.1450303f, -0.0333094f, -0.3022123f,
  -0.5453140f, +0.1671384f, +0.0282227f, +0.1350769f, -0.0024773f, -0.3598469f, +0.2326455f, -0.2369818f,
  +0.1176354f, -0.0021249f, +0.0529328f, +0.3809034f, -0.1122491f, -0.1502538f, -0.1200922f, +0.1285337f,
  -0.0407860f, -0.0976659f, +0.2867730f, -0.0409049f, -0.1162902f, +0.1557163f, -0.0378022f, +0.0805502f,
  -0.4479953f, +0.1041996f, -0.3294829f, -0.1816116f, -0.1724449f, +0.0239179f, +0.0428048f, +0.0441831f,
  +0.2767075f, -0.1887281f, -0.1412491f, +0.1608119f, +0.1168944f, +0.0724788f, -0.1897086f, +0.0010168f,
  +0.1558831f, -0.3737324f, +0.3685182f, +0.1065144f, +0.0037496f, +0.1731100f, +0.0836335f, +0.1586162f,
  -0.3863729f, +0.5234266f, -0.1602639f, +0.2592977f, +0.1871329f, -0.0775107f, -0.2407672f, +0.0128082f,
  -0.0769471f, +0.2991819f, -0.2248201f, +0.0807884f, -0.2101289f, +0.0187981f, -0.1851772f, -0.1509562f,
  +0.1792841f, -0.1075222f, -0.0003069f, -0.1182479f, -0.2090315f, -0.1034192f, +0.2582705f, +0.2202587f,
  +0.2338826f, +0.6679620f, +0.8435618f, +0.0670253f, -0.0828073f, -0.1938253f, -0.1067230f, -0.3333764f,
  -0.4467592f, +0.2174687f, -0.3082024f, -0.0717461f, -0.3005713f, -0.0095874f, +0.2619717f, -0.0252506f,
  -0.1507001f, -0.7014604f, +0.2508298f, +0.1857738f, +0.2037619f, +0.0404389f, +0.0964400f, -0.0369038f,
  -0.3312270f, +0.2857792f, -0.2695183f, -0.4593614f, -0.0602714f, -0.5561484f, +0.1517481f, -0.3160013f,
  +0.0205623f, +0.3075381f, -0.0095373f, -0.2002224f, -0.1143243f, -0.0255564f, -0.5054046f, -0.2572326f
);

const float biases[4] = float[4](
  +0.2125317f, -0.2329511f, -0.0992967f, +0.1194709f
);

vec4 hook() {
    const vec4 r[9][2] = vec4[9][2](
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 1.0f)))
    );

    float sum[4] = biases;
    for (int n = 0; n < 4; n++) {
        for (int i = 0; i < 9; i++) {
            const vec4 k0 = vec4(kernels[n * 8 * 9 + 8 * i + 0], kernels[n * 8 * 9 + 8 * i + 1], kernels[n * 8 * 9 + 8 * i + 2], kernels[n * 8 * 9 + 8 * i + 3]);
            const vec4 k1 = vec4(kernels[n * 8 * 9 + 8 * i + 4], kernels[n * 8 * 9 + 8 * i + 5], kernels[n * 8 * 9 + 8 * i + 6], kernels[n * 8 * 9 + 8 * i + 7]);
            sum[n] += (dot(k0, r[i][0]) + dot(k1, r[i][1]));
        }
    }

    return ACTIVE(vec4(sum[0], sum[1], sum[2], sum[3]) * 0.2000000f + TEX_BIND_L2_TEXOFF(vec2(0.0f, 0.0f)));
}

//!HOOK LUMA
//!DESC ARNet b8 Layer3 L0
//!WHEN OUTPUT.w LUMA.w / 1.2 > OUTPUT.h LUMA.h / 1.2 > *
//!BIND TMP2_L0
//!BIND TMP2_L1
//!SAVE TMP1_L0
//!COMPONENTS 4

#define ACTIVE(v) (max(v, v * 0.2000000f))

#define TEX_BIND_L0_TEXOFF TMP2_L0_texOff
#define TEX_BIND_L0_TEX TMP2_L0_tex
#define TEX_BIND_L0_POS TMP2_L0_pos
#define TEX_BIND_L0_SIZE TMP2_L0_size
#define TEX_BIND_L0_PT TMP2_L0_pt

#define TEX_BIND_L1_TEXOFF TMP2_L1_texOff
#define TEX_BIND_L1_TEX TMP2_L1_tex
#define TEX_BIND_L1_POS TMP2_L1_pos
#define TEX_BIND_L1_SIZE TMP2_L1_size
#define TEX_BIND_L1_PT TMP2_L1_pt

const float kernels[288] = float[288](
  -0.1429152f, -0.0107708f, +0.0616235f, -0.2734596f, -0.0441153f, -0.3910512f, -0.1661035f, +0.0602692f,
  -0.0962793f, -0.0666018f, -0.2737311f, +0.1212088f, +0.2834148f, -0.4207764f, +0.0737073f, -0.1966250f,
  -0.0965433f, +0.0063649f, -0.0398758f, +0.3820407f, +0.1614702f, -0.2337810f, -0.2522071f, +0.1715716f,
  -0.0283804f, -0.0104124f, -0.8938429f, +0.0714171f, +0.1444399f, -0.3926848f, -0.1917909f, -0.2557331f,
  -0.0598882f, -0.3894455f, -0.3852202f, -0.1911242f, -0.1946295f, +0.0260921f, -0.1080588f, -0.0227480f,
  +0.3060423f, -0.0848468f, +0.1113817f, -0.4218705f, -0.2929507f, +0.3594661f, -0.0397777f, +0.3796798f,
  +0.1952359f, +0.0502957f, +0.2931085f, -0.0674404f, +0.4067081f, -0.5722570f, -0.1068362f, -0.1905149f,
  +0.1016151f, -0.1279297f, +0.8233601f, -0.6299423f, +0.4464844f, +0.8294287f, -0.0938441f, -0.2825065f,
  +0.0229145f, -0.0491548f, +0.1995505f, +0.3403246f, +0.0663372f, +0.2685009f, -0.0312794f, +0.4260902f,
  -0.1555177f, -0.0591060f, +0.3121616f, +0.4560837f, +0.1071871f, -0.0742977f, +0.1207035f, +0.2645017f,
  +0.2145258f, +0.0388651f, +0.0437548f, -0.0360067f, -0.0587422f, +0.0952373f, +0.1902033f, +0.1037706f,
  +0.0141141f, -0.0890174f, -0.1294983f, -0.0555191f, -0.0385177f, +0.3077911f, -0.2506894f, -0.1868799f,
  -0.2222246f, +0.0761200f, -0.2485199f, -0.0253993f, -0.2632498f, +0.2581894f, +0.0690738f, -0.0960590f,
  +0.2915075f, -0.5991877f, -0.3185238f, -0.5471997f, +0.2599501f, +0.0702439f, +0.1218677f, -0.0965232f,
  +0.0724119f, -0.3320404f, +0.0573817f, +0.1326550f, +0.1820703f, -0.1441709f, -0.1970343f, -0.1092090f,
  -0.1670894f, +0.0232403f, -0.5313100f, -0.1743444f, -0.2161802f, +0.6615637f, +0.4412760f, -0.0752108f,
  -0.0073142f, +0.4798000f, +0.1225605f, -0.4060865f, -0.2010582f, +0.4864709f, -0.0585460f, +0.2294829f,
  +0.1212355f, -0.0480776f, +0.2413811f, -0.1395260f, +0.0032077f, +0.1810767f, -0.0928774f, +0.0602833f,
  +0.0534854f, -0.1181541f, +0.0901467f, -0.3398743f, -0.0601310f, -0.2045068f, -0.2257097f, -0.1373672f,
  -0.5861269f, -0.1296054f, -0.1953706f, +0.1573706f, +0.1432245f, -0.1830702f, -0.1306560f, -0.1540628f,
  -0.1407930f, -0.0006928f, -0.0038943f, +0.1279865f, +0.0657202f, -0.3901742f, -0.1173828f, +0.2425240f,
  +0.3524359f, +0.4383865f, -0.3647085f, +0.0026230f, +0.4063606f, -0.7338132f, -0.3377412f, -0.1997559f,
  +0.2152316f, -0.4201794f, -0.7952960f, -0.7093932f, +0.5665135f, +0.5878484f, +0.1271030f, +0.4590102f,
  +0.0386623f, -0.0422956f, +0.2522937f, -0.0642623f, -0.3461284f, +0.1173361f, +0.2836549f, +0.4443625f,
  -0.2425224f, +0.0934394f, +0.0838502f, -0.1856221f, +0.5709676f, -0.2804834f, -0.1224108f, +0.1062221f,
  +0.0828805f, +0.0814258f, -0.1125681f, -0.4767579f, -0.0156858f, +0.6764196f, -0.0453082f, -0.0123309f,
  +0.4874307f, +0.2461881f, +0.2111352f, +0.0209904f, +0.1898800f, +0.2980604f, -0.1935588f, +0.0697357f,
  +0.2408859f, -0.1282513f, +0.0169245f, +0.0275340f, +0.2420828f, -0.2471419f, +0.1417354f, -0.0425667f,
  -0.2685930f, -0.2164504f, -0.0026938f, -0.0115308f, -0.1917271f, -0.0107809f, -0.1999329f, -0.1014574f,
  +0.0154456f, +0.1499409f, -0.0503980f, +0.1015554f, +0.0660783f, -0.0767353f, -0.1489694f, +0.0373289f,
  -0.0810806f, -0.4701028f, +0.1018436f, -0.1437956f, -0.1398587f, +0.0185570f, +0.1216642f, -0.7433707f,
  -0.3535209f, -0.3044779f, -0.5782022f, +0.2330246f, +0.3244728f, +0.7449009f, -0.5384409f, -0.0750850f,
  -0.1097365f, +0.0673702f, +0.4664034f, -0.0260604f, -0.6838496f, -0.3401785f, -0.1427397f, +0.6029640f,
  -0.0620121f, -0.0804599f, -0.4764369f, +0.0334004f, -0.4637489f, +0.0144796f, +0.5026540f, -0.0254290f,
  +0.1101373f, +0.5818588f, -0.0353324f, -0.2544403f, +0.0865302f, +0.5828859f, -0.1819764f, +0.0668980f,
  +0.2085886f, -0.1321875f, +0.2072425f, -0.4575484f, +0.1022661f, +0.6504683f, -0.2203659f, +0.1481861f
);

const float biases[4] = float[4](
  -0.0158403f, +0.0368985f, +0.0242244f, -0.0345324f
);

vec4 hook() {
    const vec4 r[9][2] = vec4[9][2](
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 1.0f)))
    );

    float sum[4] = biases;
    for (int n = 0; n < 4; n++) {
        for (int i = 0; i < 9; i++) {
            const vec4 k0 = vec4(kernels[n * 8 * 9 + 8 * i + 0], kernels[n * 8 * 9 + 8 * i + 1], kernels[n * 8 * 9 + 8 * i + 2], kernels[n * 8 * 9 + 8 * i + 3]);
            const vec4 k1 = vec4(kernels[n * 8 * 9 + 8 * i + 4], kernels[n * 8 * 9 + 8 * i + 5], kernels[n * 8 * 9 + 8 * i + 6], kernels[n * 8 * 9 + 8 * i + 7]);
            sum[n] += (dot(k0, r[i][0]) + dot(k1, r[i][1]));
        }
    }

    return ACTIVE(vec4(sum[0], sum[1], sum[2], sum[3]));
}

//!HOOK LUMA
//!DESC ARNet b8 Layer3 L1
//!WHEN OUTPUT.w LUMA.w / 1.2 > OUTPUT.h LUMA.h / 1.2 > *
//!BIND TMP2_L0
//!BIND TMP2_L1
//!SAVE TMP1_L1
//!COMPONENTS 4

#define ACTIVE(v) (max(v, v * 0.2000000f))

#define TEX_BIND_L0_TEXOFF TMP2_L0_texOff
#define TEX_BIND_L0_TEX TMP2_L0_tex
#define TEX_BIND_L0_POS TMP2_L0_pos
#define TEX_BIND_L0_SIZE TMP2_L0_size
#define TEX_BIND_L0_PT TMP2_L0_pt

#define TEX_BIND_L1_TEXOFF TMP2_L1_texOff
#define TEX_BIND_L1_TEX TMP2_L1_tex
#define TEX_BIND_L1_POS TMP2_L1_pos
#define TEX_BIND_L1_SIZE TMP2_L1_size
#define TEX_BIND_L1_PT TMP2_L1_pt

const float kernels[288] = float[288](
  -0.0600932f, -0.0451096f, +0.1722427f, +0.0303192f, +0.2035197f, +0.1576448f, -0.0077989f, +0.0363301f,
  -0.1286851f, -0.1424123f, -0.3034633f, -0.0182220f, +0.1895670f, +0.1790784f, -0.3551942f, +0.0683264f,
  -0.0188488f, +0.2499802f, +0.3085536f, -0.1868699f, -0.2235858f, -0.3279982f, +0.1800305f, +0.0697535f,
  +0.0857840f, -0.1081673f, -0.2660059f, -0.0461871f, -0.0797181f, +0.2644642f, +0.1018429f, -0.0127364f,
  -0.0946535f, -0.0017059f, +0.0546994f, -0.0789674f, +0.2221700f, -0.6921191f, -0.1638264f, -0.0917920f,
  +0.4083715f, -0.2207352f, -0.2369236f, -0.5422086f, +0.4969994f, +0.8559960f, +0.2016378f, +0.3945116f,
  -0.1608918f, -0.0261436f, -0.1836357f, +0.2162956f, -0.3284160f, +0.6321447f, +0.0553290f, -0.0634973f,
  +0.1214208f, -0.1823583f, +0.3023685f, -0.5181173f, +0.5246170f, -0.2899470f, +0.2526660f, -0.0834405f,
  -0.0247041f, +0.4174193f, -0.5316439f, -0.3659836f, -0.5620670f, +0.1438046f, -0.0685857f, +0.0514154f,
  +0.1069036f, +0.0626299f, +0.2675512f, +0.2629760f, -0.1893764f, +0.3847645f, -0.0156827f, +0.1373010f,
  +0.9857923f, +0.2398443f, +0.4026200f, -0.3426214f, -0.1274446f, +0.1291401f, +0.1503247f, -0.3052992f,
  +0.4151117f, +0.1501044f, -0.1962300f, -0.1152254f, +0.2621306f, +0.1345910f, +0.2329319f, +0.0208486f,
  +0.1077859f, -0.4732206f, +0.2048684f, +0.1514015f, +0.2413389f, +0.0205494f, +0.3579460f, +0.3832941f,
  -0.2907170f, -0.1744585f, +0.2629752f, -0.1950570f, +0.1713265f, +0.0276993f, +0.4632827f, -0.1382675f,
  -0.1465362f, -0.0619817f, +0.3675045f, +0.4588720f, -0.3651000f, -0.2503836f, +0.2027672f, +0.5416315f,
  +0.0321796f, -0.1232798f, +0.0600067f, +0.2622423f, -0.2266855f, +0.4027570f, +0.0324741f, -0.1470468f,
  -0.0858138f, +0.5295713f, -0.6268055f, -0.3140142f, -0.1105679f, +0.3361167f, +0.4363074f, -0.0605005f,
  -0.0836369f, +0.1601845f, -0.1363002f, +0.0842614f, +0.1449863f, -0.2379715f, +0.2300526f, +0.0159848f,
  +0.1928436f, +0.0401357f, +0.2270594f, -0.1152635f, +0.0088896f, +0.2149625f, +0.1886789f, -0.0591172f,
  +0.2991487f, -0.0724448f, -0.1498299f, +0.0512657f, -0.2730448f, +0.1771703f, +0.2040717f, -0.0612496f,
  -0.1330739f, +0.1216406f, -0.4844937f, +0.3085666f, +0.0523537f, +0.0331867f, -0.1339399f, +0.3102015f,
  +0.0859103f, -0.5288411f, +0.0851532f, +0.2834786f, -0.3933050f, +0.3155580f, +0.0021384f, -0.1028433f,
  -0.0882597f, +0.4919403f, +0.0395258f, +0.3323513f, -0.3595732f, -0.0532726f, -0.4059736f, -0.1122041f,
  +0.6691105f, -0.2416083f, +0.4222040f, -0.4077400f, +0.1921534f, +0.2843577f, -0.1159838f, +0.2977592f,
  +0.2146370f, -0.2988325f, +0.3104702f, -0.1196318f, -0.0460549f, -0.3610873f, -0.1073860f, -0.2502825f,
  -0.1515417f, -0.2374181f, +0.0224962f, -0.0235145f, -0.1742617f, -1.1470472f, +0.1561458f, -0.0303852f,
  -0.2934320f, +0.1207630f, +0.2532795f, +0.4538975f, -0.3353077f, +0.0241130f, -0.3332137f, +0.2606895f,
  +0.2092717f, +0.1215136f, +0.0464510f, +0.0765700f, -0.3244151f, -0.2580058f, -0.0968263f, -0.0860899f,
  -0.3664221f, +0.2204066f, -0.2931555f, -0.0320314f, -0.2575554f, +0.0349238f, +0.2337742f, -0.0063385f,
  -0.1502784f, -0.0117752f, +0.1237466f, +0.2671160f, +0.0275021f, -0.1816077f, -0.1545257f, +0.2778557f,
  -0.1547470f, +0.0810191f, -0.5230678f, +0.2899700f, -0.0913577f, +0.0798170f, +0.0699841f, -0.3273827f,
  -0.2657390f, +0.0894998f, -0.2610865f, +0.0933793f, -0.2461833f, -0.0966094f, -0.1933462f, +0.2166755f,
  +0.0425596f, -0.0752226f, +0.1928092f, -0.4553996f, -0.1644228f, +0.3592243f, +0.0678124f, +0.5256729f,
  -0.0746709f, +0.0593276f, -0.3862071f, -0.0212825f, +0.2120434f, +0.2392453f, +0.3191722f, -0.1815533f,
  -0.2277272f, -0.2118661f, -0.2060279f, -0.0283388f, -0.0870466f, +0.4007285f, +0.3152151f, -0.1139578f,
  +0.1550957f, +0.1898067f, +0.0165627f, -0.1234912f, +0.0804090f, -0.1064962f, -0.0115445f, +0.0435094f
);

const float biases[4] = float[4](
  +0.0860246f, +0.0545270f, -0.0668993f, +0.0995301f
);

vec4 hook() {
    const vec4 r[9][2] = vec4[9][2](
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 1.0f)))
    );

    float sum[4] = biases;
    for (int n = 0; n < 4; n++) {
        for (int i = 0; i < 9; i++) {
            const vec4 k0 = vec4(kernels[n * 8 * 9 + 8 * i + 0], kernels[n * 8 * 9 + 8 * i + 1], kernels[n * 8 * 9 + 8 * i + 2], kernels[n * 8 * 9 + 8 * i + 3]);
            const vec4 k1 = vec4(kernels[n * 8 * 9 + 8 * i + 4], kernels[n * 8 * 9 + 8 * i + 5], kernels[n * 8 * 9 + 8 * i + 6], kernels[n * 8 * 9 + 8 * i + 7]);
            sum[n] += (dot(k0, r[i][0]) + dot(k1, r[i][1]));
        }
    }

    return ACTIVE(vec4(sum[0], sum[1], sum[2], sum[3]));
}

//!HOOK LUMA
//!DESC ARNet b8 Layer4 L0
//!WHEN OUTPUT.w LUMA.w / 1.2 > OUTPUT.h LUMA.h / 1.2 > *
//!BIND TMP1_L0
//!BIND TMP1_L1
//!BIND TMP2_L0
//!SAVE TMP2_L0
//!COMPONENTS 4

#define ACTIVE(v) (v)

#define TEX_BIND_L0_TEXOFF TMP1_L0_texOff
#define TEX_BIND_L0_TEX TMP1_L0_tex
#define TEX_BIND_L0_POS TMP1_L0_pos
#define TEX_BIND_L0_SIZE TMP1_L0_size
#define TEX_BIND_L0_PT TMP1_L0_pt

#define TEX_BIND_L1_TEXOFF TMP1_L1_texOff
#define TEX_BIND_L1_TEX TMP1_L1_tex
#define TEX_BIND_L1_POS TMP1_L1_pos
#define TEX_BIND_L1_SIZE TMP1_L1_size
#define TEX_BIND_L1_PT TMP1_L1_pt

#define TEX_BIND_L2_TEXOFF TMP2_L0_texOff
#define TEX_BIND_L2_TEX TMP2_L0_tex
#define TEX_BIND_L2_POS TMP2_L0_pos
#define TEX_BIND_L2_SIZE TMP2_L0_size
#define TEX_BIND_L2_PT TMP2_L0_pt

const float kernels[288] = float[288](
  -0.1139397f, -0.3439996f, +0.0428791f, +0.0108916f, +0.0458330f, -0.0273042f, -0.1641759f, +0.1573804f,
  +0.0236671f, +0.1475948f, -0.0447001f, +0.2879631f, -0.3094409f, +0.0894369f, -0.1947322f, -0.1579394f,
  -0.2408657f, +0.0123695f, +0.3189008f, +0.0091241f, -0.1546188f, +0.0246815f, -0.2354423f, +0.1843815f,
  -0.0040437f, -0.3109771f, -0.0812299f, +0.1843774f, +0.1395196f, +0.1218810f, -0.1313170f, +0.0350747f,
  -0.2656709f, -0.3454357f, -0.4127566f, +0.6459669f, -0.0724970f, +0.1519768f, -0.2790319f, +0.3756227f,
  -0.1729518f, -0.3098711f, -0.1546327f, +0.3555539f, -0.1609110f, +0.0306987f, -0.2393588f, +0.4087450f,
  +0.0805846f, -0.2484059f, +0.0189613f, +0.1185426f, +0.0380856f, +0.0911203f, +0.0077803f, +0.0775311f,
  +0.0016000f, -0.3811631f, -0.1236367f, +0.2188156f, +0.0724473f, +0.1286944f, +0.0154642f, -0.2161652f,
  -0.2722877f, +0.1162410f, -0.1685736f, +0.0707718f, +0.0194750f, -0.2015313f, +0.0662008f, -0.2502089f,
  +0.1746094f, +0.2817547f, -0.1488764f, +0.1555160f, -0.0661963f, -0.1390308f, +0.3667863f, -0.1009242f,
  +0.4630893f, +0.2877420f, -0.4473447f, +0.0232745f, +0.3618741f, -0.1829980f, +0.4062894f, -0.2470436f,
  +0.3027431f, -0.1155559f, -0.4352088f, -0.0617014f, +0.2572687f, +0.1025859f, +0.2259806f, -0.3173394f,
  +0.2371303f, +0.1698688f, -0.0164032f, +0.0123998f, +0.0370335f, +0.1352609f, +0.4083911f, -0.1214868f,
  +0.7173134f, -0.0596872f, -0.3056215f, -0.0952421f, -0.2178992f, +0.1406101f, +0.2481940f, +0.2876760f,
  +0.0380547f, +0.2840848f, +0.0462512f, -0.2752815f, +0.3252176f, +0.1121584f, +0.1853000f, +0.0459723f,
  +0.1249192f, +0.1857821f, -0.0374795f, -0.0906643f, -0.0633899f, +0.0003309f, +0.0667868f, -0.0930628f,
  +0.1320568f, +0.2459470f, +0.0165915f, -0.2941123f, +0.2077143f, -0.0689400f, -0.0635144f, +0.1623701f,
  +0.1610470f, +0.1909061f, -0.0321509f, -0.2294011f, -0.1088051f, -0.3254645f, -0.1685320f, +0.0617800f,
  -0.2799734f, -0.0728746f, +0.0926432f, -0.1312004f, -0.5258745f, -0.0322807f, -0.1979808f, +0.3883485f,
  -0.1322833f, -0.0298905f, +0.1497161f, -0.4669619f, -0.2640699f, +0.1591693f, -0.3172996f, +0.3341506f,
  -0.0400263f, +0.4028443f, +0.0068872f, -0.0683709f, -0.0680277f, +0.1263735f, -0.2551419f, +0.0783983f,
  -0.2433320f, +0.2116264f, -0.0242022f, -0.0104888f, -0.2064316f, -0.0346528f, -0.5147136f, -0.0344739f,
  +0.1905508f, +0.2954127f, +0.1540354f, -0.4894083f, -0.2584664f, -0.0538069f, +0.1579087f, +0.4413437f,
  -0.1623874f, +0.1769620f, +0.3705982f, -0.1535003f, -0.0617400f, +0.1453078f, -0.1835831f, +0.2650072f,
  +0.0379759f, -0.0880349f, -0.0234698f, -0.0785080f, -0.4390000f, +0.0084102f, +0.0980322f, +0.1925485f,
  +0.0788338f, +0.1820787f, +0.2757010f, -0.2656710f, +0.0700866f, -0.0636751f, -0.1052665f, -0.1910312f,
  -0.1310797f, +0.1047264f, +0.2462535f, -0.2329342f, -0.0047964f, -0.0153719f, -0.1797751f, -0.0496823f,
  +0.0681642f, +0.0053179f, +0.0869032f, +0.1846274f, +0.1874994f, +0.1374535f, -0.0078823f, -0.0781944f,
  +0.0012432f, +0.1604827f, +0.3630138f, +0.4430989f, +0.2867665f, +0.0983960f, -0.1163482f, -0.1330399f,
  -0.1618608f, -0.1220483f, +0.0704575f, +0.2839191f, +0.0658900f, -0.1060658f, +0.2033438f, -0.0306137f,
  -0.1128586f, -0.3709911f, -0.0480360f, +0.1477613f, +0.4158724f, -0.0408428f, -0.1175217f, +0.0869146f,
  +0.4220616f, +0.1979827f, -0.1152736f, -0.3279105f, -0.0867846f, -0.0969778f, -0.5383235f, +0.0315833f,
  -0.1685458f, +0.1315382f, +0.2913265f, -0.0573428f, -0.0870898f, -0.2675686f, +0.1149678f, -0.3316370f,
  +0.0261919f, -0.0722795f, -0.0047899f, -0.0351565f, +0.0327533f, -0.0826227f, +0.0259516f, -0.0151769f,
  -0.2414310f, -0.1079060f, +0.1099988f, +0.0564977f, +0.1429055f, -0.2743385f, -0.1432404f, -0.0710921f,
  +0.0067477f, -0.1528403f, +0.1232611f, +0.1099138f, -0.0374775f, -0.1700499f, +0.0862159f, -0.0313732f
);

const float biases[4] = float[4](
  -0.0076949f, -0.0187370f, -0.0253483f, +0.0719890f
);

vec4 hook() {
    const vec4 r[9][2] = vec4[9][2](
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 1.0f)))
    );

    float sum[4] = biases;
    for (int n = 0; n < 4; n++) {
        for (int i = 0; i < 9; i++) {
            const vec4 k0 = vec4(kernels[n * 8 * 9 + 8 * i + 0], kernels[n * 8 * 9 + 8 * i + 1], kernels[n * 8 * 9 + 8 * i + 2], kernels[n * 8 * 9 + 8 * i + 3]);
            const vec4 k1 = vec4(kernels[n * 8 * 9 + 8 * i + 4], kernels[n * 8 * 9 + 8 * i + 5], kernels[n * 8 * 9 + 8 * i + 6], kernels[n * 8 * 9 + 8 * i + 7]);
            sum[n] += (dot(k0, r[i][0]) + dot(k1, r[i][1]));
        }
    }

    return ACTIVE(vec4(sum[0], sum[1], sum[2], sum[3]) * 0.2000000f + TEX_BIND_L2_TEXOFF(vec2(0.0f, 0.0f)));
}

//!HOOK LUMA
//!DESC ARNet b8 Layer4 L1
//!WHEN OUTPUT.w LUMA.w / 1.2 > OUTPUT.h LUMA.h / 1.2 > *
//!BIND TMP1_L0
//!BIND TMP1_L1
//!BIND TMP2_L1
//!SAVE TMP2_L1
//!COMPONENTS 4

#define ACTIVE(v) (v)

#define TEX_BIND_L0_TEXOFF TMP1_L0_texOff
#define TEX_BIND_L0_TEX TMP1_L0_tex
#define TEX_BIND_L0_POS TMP1_L0_pos
#define TEX_BIND_L0_SIZE TMP1_L0_size
#define TEX_BIND_L0_PT TMP1_L0_pt

#define TEX_BIND_L1_TEXOFF TMP1_L1_texOff
#define TEX_BIND_L1_TEX TMP1_L1_tex
#define TEX_BIND_L1_POS TMP1_L1_pos
#define TEX_BIND_L1_SIZE TMP1_L1_size
#define TEX_BIND_L1_PT TMP1_L1_pt

#define TEX_BIND_L2_TEXOFF TMP2_L1_texOff
#define TEX_BIND_L2_TEX TMP2_L1_tex
#define TEX_BIND_L2_POS TMP2_L1_pos
#define TEX_BIND_L2_SIZE TMP2_L1_size
#define TEX_BIND_L2_PT TMP2_L1_pt

const float kernels[288] = float[288](
  +0.0102956f, -0.1575068f, +0.1700231f, -0.0686407f, +0.3433550f, -0.1973199f, +0.4680630f, -0.0388006f,
  +0.0587208f, -0.0209063f, -0.2738711f, +0.1604709f, +0.2216389f, -0.0739016f, +0.2368476f, +0.0700510f,
  +0.6741095f, +0.1431098f, -0.6986791f, +0.2491126f, +0.1783553f, +0.3125850f, +0.2727470f, -0.2975209f,
  +0.0665337f, -0.0246031f, -0.1527354f, +0.2088282f, +0.4660720f, +0.0441718f, +0.2002623f, -0.4014588f,
  +0.5642279f, -0.0413313f, -1.0947746f, -0.6259841f, +0.4851341f, -0.3074947f, +0.1437951f, +0.3928882f,
  +0.6306854f, +0.2023494f, -0.7883692f, +0.1712287f, -0.0043068f, +0.2355395f, +0.2621229f, +0.0990184f,
  +0.0632780f, +0.0909908f, -0.0380237f, -0.0713381f, -0.0821482f, -0.0837058f, +0.0508754f, -0.0943018f,
  -0.0851328f, +0.0997027f, -0.0136944f, -0.2246964f, +0.1365112f, -0.1980079f, -0.2055784f, +0.1868640f,
  +0.1380710f, -0.1832956f, -0.0191902f, -0.1009835f, +0.0141832f, -0.1076977f, -0.0254628f, +0.1305652f,
  -0.1169980f, +0.1889006f, +0.0952275f, -0.1319571f, -0.2948410f, -0.0796898f, +0.0414700f, -0.0620631f,
  +0.0874481f, -0.0470361f, +0.1737838f, -0.8670017f, +0.1512194f, -0.0915481f, +0.1485865f, -0.2042885f,
  +0.0209966f, +0.1681014f, -0.0698738f, -0.3225976f, -0.0360672f, -0.1236724f, +0.0975251f, -0.0793089f,
  -0.0158377f, +0.0563233f, -0.0051476f, -0.0877927f, -0.5718015f, -0.1928732f, -0.1202197f, -0.1159968f,
  -0.1460644f, +0.1482195f, +0.4036136f, -0.2489301f, +0.3852436f, -0.8949580f, +0.4305813f, +0.5880990f,
  -0.0302265f, -0.1116325f, +0.0528076f, -0.1999731f, -0.1867741f, -0.2822284f, -0.0920708f, +0.1707112f,
  -0.0898410f, +0.0197309f, -0.0500908f, +0.0428802f, +0.0169339f, -0.0579410f, -0.0233958f, -0.1328513f,
  +0.0472865f, +0.1459478f, -0.1160285f, -0.0511839f, +0.0012251f, -0.1225129f, -0.1097882f, +0.0173259f,
  +0.2530341f, +0.1477108f, -0.1420955f, -0.0511026f, -0.0930930f, -0.0830804f, -0.1469931f, +0.0316122f,
  +0.2912171f, +0.3013740f, -0.2125768f, +0.4305993f, +0.0997037f, -0.0092678f, +0.0117328f, -0.3176568f,
  +0.3935258f, +0.1130058f, -0.2202513f, +0.1080463f, -0.1714622f, +0.1094842f, -0.0541860f, -0.4826182f,
  +0.0831151f, -0.0723890f, +0.2219632f, -0.2553939f, -0.1730463f, +0.1762687f, +0.2942465f, -0.1970028f,
  +0.2363832f, -0.0532646f, -0.1066503f, +0.1569112f, -0.5827339f, -0.1314484f, +0.0691376f, +0.2276625f,
  +0.5450267f, +0.1591808f, -0.3763725f, +0.2364620f, -0.7132080f, -0.7087442f, -0.1680406f, +0.2297018f,
  +0.1194051f, -0.1317895f, +0.1396487f, -0.0346565f, +0.0134837f, +0.0467808f, +0.0601892f, +0.0962183f,
  +0.1326829f, -0.0515161f, -0.1745125f, +0.0273023f, -0.2484708f, -0.1590691f, -0.1196097f, +0.2299467f,
  +0.2421121f, +0.0109928f, -0.2019260f, -0.0138107f, -0.2158656f, -0.1217900f, -0.2635542f, -0.3117167f,
  -0.0245609f, +0.1390833f, +0.1471619f, -0.0096249f, -0.0925842f, -0.1345670f, -0.0747809f, +0.1917616f,
  +0.0212019f, -0.0941093f, -0.1851864f, +0.0828540f, -0.2554527f, +0.0401493f, -0.0925856f, +0.1361600f,
  +0.1581648f, -0.1781804f, -0.0771800f, +0.0831740f, +0.3133794f, +0.0205952f, -0.0517356f, -0.2159713f,
  -0.1854124f, +0.0029072f, -0.0173915f, +0.4188780f, +0.1087600f, -0.1635033f, +0.0649389f, +0.1075131f,
  +0.0489038f, -0.2295517f, +0.0139522f, +0.0275000f, +0.1148198f, -0.3448162f, -0.3014294f, -0.3133000f,
  +0.1791072f, +0.1009438f, -0.2131062f, +0.6731258f, +0.3714246f, -0.7311778f, -0.2362882f, +0.0898690f,
  +0.1775603f, -0.3722428f, -0.4552534f, +0.5830269f, +0.0901506f, -0.1580978f, -0.1098139f, +0.0774575f,
  +0.0832534f, -0.1861965f, -0.0145128f, +0.1630815f, -0.1919395f, +0.0153539f, -0.1831532f, +0.3152669f,
  +0.2069570f, -0.3970515f, -0.0372765f, +0.1656749f, +0.3012249f, +0.1708599f, +0.0265998f, +0.0001838f,
  +0.0800016f, -0.1338411f, -0.2208354f, +0.1783745f, +0.0652095f, +0.0453858f, +0.1724805f, +0.0670104f
);

const float biases[4] = float[4](
  +0.0121972f, +0.0352046f, +0.2597087f, +0.0787601f
);

vec4 hook() {
    const vec4 r[9][2] = vec4[9][2](
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 1.0f)))
    );

    float sum[4] = biases;
    for (int n = 0; n < 4; n++) {
        for (int i = 0; i < 9; i++) {
            const vec4 k0 = vec4(kernels[n * 8 * 9 + 8 * i + 0], kernels[n * 8 * 9 + 8 * i + 1], kernels[n * 8 * 9 + 8 * i + 2], kernels[n * 8 * 9 + 8 * i + 3]);
            const vec4 k1 = vec4(kernels[n * 8 * 9 + 8 * i + 4], kernels[n * 8 * 9 + 8 * i + 5], kernels[n * 8 * 9 + 8 * i + 6], kernels[n * 8 * 9 + 8 * i + 7]);
            sum[n] += (dot(k0, r[i][0]) + dot(k1, r[i][1]));
        }
    }

    return ACTIVE(vec4(sum[0], sum[1], sum[2], sum[3]) * 0.2000000f + TEX_BIND_L2_TEXOFF(vec2(0.0f, 0.0f)));
}

//!HOOK LUMA
//!DESC ARNet b8 Layer5 L0
//!WHEN OUTPUT.w LUMA.w / 1.2 > OUTPUT.h LUMA.h / 1.2 > *
//!BIND TMP2_L0
//!BIND TMP2_L1
//!SAVE TMP1_L0
//!COMPONENTS 4

#define ACTIVE(v) (max(v, v * 0.2000000f))

#define TEX_BIND_L0_TEXOFF TMP2_L0_texOff
#define TEX_BIND_L0_TEX TMP2_L0_tex
#define TEX_BIND_L0_POS TMP2_L0_pos
#define TEX_BIND_L0_SIZE TMP2_L0_size
#define TEX_BIND_L0_PT TMP2_L0_pt

#define TEX_BIND_L1_TEXOFF TMP2_L1_texOff
#define TEX_BIND_L1_TEX TMP2_L1_tex
#define TEX_BIND_L1_POS TMP2_L1_pos
#define TEX_BIND_L1_SIZE TMP2_L1_size
#define TEX_BIND_L1_PT TMP2_L1_pt

const float kernels[288] = float[288](
  -0.4485003f, -0.2896232f, +0.0263657f, -0.2510238f, +0.2048896f, +0.2839111f, +0.0637936f, -0.1749485f,
  +0.0549724f, +0.1840921f, +0.2726902f, +0.1850703f, -0.4482566f, -0.1096575f, -0.2653679f, +0.3332638f,
  +0.0591658f, +0.0463099f, -0.2197264f, -0.1756573f, +0.2301110f, -0.1088903f, -0.0345916f, -0.3484438f,
  +0.1855141f, +0.2090337f, -0.0219708f, +0.1468936f, -0.1539548f, +0.0795126f, -0.1152148f, -0.0913899f,
  -0.3205147f, +0.0809588f, +0.1376554f, +0.3914025f, -0.6158153f, -0.1280446f, +0.5282522f, +0.1794756f,
  -0.2591340f, -0.1808346f, +0.0433512f, +0.3167509f, -0.2394114f, -0.3434589f, +0.1788058f, +0.0042859f,
  -0.0793505f, -0.3141558f, +0.0613533f, +0.1282144f, -0.2864841f, -0.1177271f, +0.2125790f, -0.1982229f,
  -0.3016839f, -0.1625732f, -0.1664074f, -0.0077569f, -0.1796073f, -0.2116292f, +0.0978210f, +0.0336661f,
  -0.1655547f, +0.0181843f, -0.3273133f, -0.0388422f, -0.0684201f, -0.1299143f, +0.0777945f, -0.2598852f,
  +0.1197378f, +0.0011793f, +0.2157003f, +0.1011343f, -0.2108256f, +0.2924612f, +0.1270572f, -0.1289684f,
  +0.3851039f, -0.2509728f, +0.1872546f, +0.0735654f, -0.2328085f, -0.1985541f, -0.1689291f, -0.0002442f,
  -0.0286630f, -0.0760578f, -0.1913552f, -0.0156935f, -0.0854616f, -0.1775087f, -0.1959002f, -0.0763725f,
  -0.3324378f, -0.3164663f, -0.2760979f, +0.3014767f, -0.5527003f, +0.0049973f, +0.1554399f, -0.4602061f,
  -0.1420031f, -0.1399298f, +0.6194994f, +0.8627242f, -1.0434779f, -0.1349145f, -0.4522254f, -0.5439873f,
  -0.2745568f, -0.0991043f, -0.0463986f, -0.1938025f, -0.4108668f, +0.2715458f, -0.0868811f, -0.2966119f,
  +0.0603519f, -0.3842724f, +0.1632434f, -0.1650210f, -0.1196855f, -0.0959494f, +0.1937062f, -0.2741123f,
  -0.0962848f, -0.2833652f, +0.3681621f, +0.1605912f, -0.4069875f, -0.4133180f, -0.1110268f, -0.2567360f,
  -0.2992156f, -0.1389589f, +0.1846614f, -0.0905394f, -0.0710405f, +0.1182012f, -0.0640804f, +0.0620214f,
  -0.1665913f, -0.0394432f, -0.1360258f, -0.3554158f, +0.2562048f, -0.0370359f, +0.0459064f, +0.1081078f,
  -0.2701622f, +0.3721088f, +0.6524134f, +0.5283558f, -0.1702788f, -0.1478331f, +0.3633593f, +0.1518886f,
  +0.1103096f, +0.2293963f, -0.4517326f, -0.2230286f, -0.0505665f, +0.3186802f, -0.0171402f, -0.3328215f,
  -0.0689862f, -0.1684045f, -0.0456157f, -0.2082877f, +0.3494039f, -0.0084775f, +0.1252471f, +0.0458682f,
  -0.5135347f, +0.5281532f, -0.3298317f, -0.8626949f, -0.2125032f, -0.5492528f, -0.0217046f, -0.2444687f,
  -0.0706794f, +0.2917312f, +0.2827660f, -0.0619646f, +0.0254387f, +0.0286026f, +0.0751779f, -0.1690707f,
  +0.0571596f, -0.0308432f, +0.0742949f, +0.1866674f, +0.3538485f, +0.1404056f, -0.3357091f, -0.0303538f,
  -0.0319945f, +0.0704507f, -0.1393380f, -0.1348938f, -0.0719850f, +0.2054949f, -0.0939099f, +0.0635687f,
  +0.1427906f, -0.1300436f, +0.0251251f, +0.0294545f, +0.3818023f, -0.0904034f, +0.1160962f, +0.1920978f,
  +0.1947794f, +0.4296075f, -0.0250299f, +0.1046514f, +0.0127043f, +0.1002367f, +0.0480566f, +0.2698761f,
  +0.0494146f, +0.3788643f, +0.2046102f, -0.1241891f, -0.0701691f, +0.0146709f, +0.4358099f, +0.1447760f,
  -0.0093694f, +0.1306555f, -0.1773202f, -0.2984326f, +0.2053261f, +0.2450155f, +0.1966156f, -0.1918194f,
  -0.4294277f, -0.4846964f, -0.0945919f, -0.2222586f, +0.1794865f, -0.2524811f, +0.0337889f, -0.1212365f,
  -1.0383103f, -0.6994893f, -0.3736246f, -0.3977949f, +0.0496387f, +0.1340416f, +0.6876118f, -0.0712912f,
  +0.3879359f, +0.1841150f, -0.3681335f, +0.1580462f, +0.2996877f, +0.0711280f, +0.0629409f, +0.1206479f,
  -0.1742962f, -0.0300634f, -0.1866579f, -0.0144607f, +0.0623347f, -0.0366281f, +0.0636094f, -0.1961658f,
  +0.0873752f, +0.1230197f, -0.5769987f, +0.1677468f, -0.7244267f, -0.4020633f, +0.0855633f, +0.1530191f,
  -0.1098231f, -0.0369881f, -0.1306304f, +0.2111732f, +0.1289533f, -0.1436728f, +0.0541577f, +0.0440663f
);

const float biases[4] = float[4](
  +0.0970696f, -0.0554926f, +0.0385734f, +0.1282708f
);

vec4 hook() {
    const vec4 r[9][2] = vec4[9][2](
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 1.0f)))
    );

    float sum[4] = biases;
    for (int n = 0; n < 4; n++) {
        for (int i = 0; i < 9; i++) {
            const vec4 k0 = vec4(kernels[n * 8 * 9 + 8 * i + 0], kernels[n * 8 * 9 + 8 * i + 1], kernels[n * 8 * 9 + 8 * i + 2], kernels[n * 8 * 9 + 8 * i + 3]);
            const vec4 k1 = vec4(kernels[n * 8 * 9 + 8 * i + 4], kernels[n * 8 * 9 + 8 * i + 5], kernels[n * 8 * 9 + 8 * i + 6], kernels[n * 8 * 9 + 8 * i + 7]);
            sum[n] += (dot(k0, r[i][0]) + dot(k1, r[i][1]));
        }
    }

    return ACTIVE(vec4(sum[0], sum[1], sum[2], sum[3]));
}

//!HOOK LUMA
//!DESC ARNet b8 Layer5 L1
//!WHEN OUTPUT.w LUMA.w / 1.2 > OUTPUT.h LUMA.h / 1.2 > *
//!BIND TMP2_L0
//!BIND TMP2_L1
//!SAVE TMP1_L1
//!COMPONENTS 4

#define ACTIVE(v) (max(v, v * 0.2000000f))

#define TEX_BIND_L0_TEXOFF TMP2_L0_texOff
#define TEX_BIND_L0_TEX TMP2_L0_tex
#define TEX_BIND_L0_POS TMP2_L0_pos
#define TEX_BIND_L0_SIZE TMP2_L0_size
#define TEX_BIND_L0_PT TMP2_L0_pt

#define TEX_BIND_L1_TEXOFF TMP2_L1_texOff
#define TEX_BIND_L1_TEX TMP2_L1_tex
#define TEX_BIND_L1_POS TMP2_L1_pos
#define TEX_BIND_L1_SIZE TMP2_L1_size
#define TEX_BIND_L1_PT TMP2_L1_pt

const float kernels[288] = float[288](
  -0.3386730f, -0.0988887f, -0.2118649f, -0.0204272f, -0.0629987f, -0.0142236f, -0.1205398f, +0.0414192f,
  +0.1527977f, +0.2100623f, +0.1626254f, +0.3259092f, -0.1381519f, -0.7478235f, -0.1792649f, +0.1155935f,
  +0.2753774f, +0.0064117f, -0.4874233f, -0.8490511f, -0.3547993f, +0.3549308f, -0.2390867f, +0.0159967f,
  +0.2397902f, -0.4246645f, +0.1682377f, -0.0623788f, -0.1395747f, -0.5508812f, +0.2453778f, -0.2105770f,
  -0.0960942f, -0.4619884f, +0.1098474f, -0.3038846f, -0.6255031f, -0.8428894f, +0.4533162f, -0.1062255f,
  -0.1171828f, -0.1997926f, +0.7194389f, +0.3908295f, -0.1833308f, -0.3674655f, -0.1753528f, -0.2359453f,
  +0.1966492f, -0.0893053f, +0.3460652f, +0.0241404f, +0.3089447f, +0.4312815f, -0.3620597f, -0.0887917f,
  -0.0044020f, +0.1136681f, +0.0445099f, +0.1356088f, +0.0771177f, +0.4021416f, -0.1528558f, +0.2477843f,
  +0.3961319f, +0.0254589f, -0.0703044f, -0.0003160f, +0.1675829f, -0.0798602f, +0.1032111f, -0.1521390f,
  +0.2936361f, +0.0863771f, +0.2905022f, +0.2755674f, -0.5607314f, -0.0225688f, -0.2527412f, +0.1464029f,
  +0.1260390f, -0.1886201f, +0.4340373f, +0.1315214f, -0.3136842f, -0.1257511f, -0.0258149f, +0.1170192f,
  -0.1052548f, -0.1943328f, -0.0317764f, +0.0612081f, -0.0447430f, -0.0930656f, -0.0128815f, +0.3767709f,
  +0.2850488f, +0.5060054f, +0.2425124f, +0.7704085f, +0.5477066f, +0.1169395f, -0.0774516f, -0.0622456f,
  +0.1697012f, -0.0812559f, -0.3901139f, -0.6898613f, +0.1699179f, +0.4079044f, +0.2010206f, -0.3202055f,
  -0.1236420f, -0.2352046f, +0.3426583f, -0.1641078f, -0.2711348f, +0.0952750f, +0.1948255f, -0.0177544f,
  -0.1859696f, -0.3299129f, +0.5185276f, -0.1868952f, -0.5326371f, -0.3874113f, -0.3403786f, -0.5603418f,
  -0.1517392f, -0.1599934f, +0.4988623f, -0.1611296f, -0.2408663f, +0.0019010f, -0.2151433f, -0.4739767f,
  -0.0449030f, -0.2206734f, +0.2921841f, +0.0121798f, -0.0619255f, -0.1097637f, -0.2775841f, -0.0716201f,
  +0.2000339f, +0.0236437f, +0.1004376f, +0.2399895f, +0.0085056f, -0.2662308f, -0.2632372f, +0.2813680f,
  +0.1524871f, +0.1280117f, +0.0580925f, +0.2325293f, +0.0520096f, +0.3177954f, +0.1042406f, -0.3136501f,
  +0.0291400f, -0.0771624f, -0.1341612f, +0.1067456f, +0.0612965f, -0.2854939f, +0.0604507f, +0.2292682f,
  -0.2862431f, +0.4910168f, +0.2414309f, -0.0087256f, +0.1400326f, -0.1578547f, -0.0909656f, +0.4412995f,
  -0.4316870f, -0.1733564f, +0.6547351f, +0.0430970f, -0.4028044f, +0.1155012f, +0.1725394f, +0.8672255f,
  -0.0785151f, +0.1400952f, +0.0410964f, -0.0487866f, -0.2214397f, -0.1207789f, +0.1606208f, -0.1112494f,
  -0.0782954f, +0.0552713f, +0.1230105f, -0.0342609f, -0.0173230f, -0.3249596f, -0.0891678f, +0.1921121f,
  +0.0163678f, -0.1590464f, +0.0227853f, +0.2347695f, +0.2284177f, +0.0743587f, +0.0076753f, +0.0689508f,
  -0.1928745f, +0.0985227f, -0.1620124f, +0.0014241f, -0.3116935f, -0.0272178f, -0.1483180f, -0.0277698f,
  +0.1244577f, +0.1708840f, -0.1009570f, +0.1912255f, -0.0347351f, -0.1543508f, -0.1090764f, +0.0334139f,
  -0.0403704f, -0.1652729f, -0.0239422f, -0.0186612f, +0.3466148f, -0.2986354f, +0.1599811f, +0.1829550f,
  -0.0828398f, -0.0502928f, +0.1727046f, -0.0144090f, -0.2808552f, +0.0305592f, -0.2172373f, -0.0375188f,
  -0.1707993f, -0.2482340f, +0.0439898f, -0.3273683f, -0.0132299f, -0.2286536f, +0.1615990f, -0.1419839f,
  -0.0092797f, +0.3736288f, +0.0756884f, -0.0503409f, -0.4809467f, +1.2332648f, +0.1743566f, -0.0835273f,
  -0.3251974f, -0.1239252f, +0.3219257f, -0.5024894f, -0.2716674f, +0.3591934f, -0.2070111f, -0.4878417f,
  -0.1229962f, -0.1235053f, -0.0083633f, -0.0142563f, -0.1191496f, +0.1007515f, -0.1440929f, -0.0495655f,
  +0.6441928f, +0.2234547f, +0.0804170f, +0.5326797f, +0.0092348f, +0.3283645f, -0.0271283f, +0.2248075f,
  +0.0766797f, -0.5614902f, +0.8565065f, -0.6209677f, +0.2606412f, +0.7190413f, -0.5866241f, +0.2746110f
);

const float biases[4] = float[4](
  -0.0413480f, -0.0711549f, +0.0777953f, -0.0457398f
);

vec4 hook() {
    const vec4 r[9][2] = vec4[9][2](
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 1.0f)))
    );

    float sum[4] = biases;
    for (int n = 0; n < 4; n++) {
        for (int i = 0; i < 9; i++) {
            const vec4 k0 = vec4(kernels[n * 8 * 9 + 8 * i + 0], kernels[n * 8 * 9 + 8 * i + 1], kernels[n * 8 * 9 + 8 * i + 2], kernels[n * 8 * 9 + 8 * i + 3]);
            const vec4 k1 = vec4(kernels[n * 8 * 9 + 8 * i + 4], kernels[n * 8 * 9 + 8 * i + 5], kernels[n * 8 * 9 + 8 * i + 6], kernels[n * 8 * 9 + 8 * i + 7]);
            sum[n] += (dot(k0, r[i][0]) + dot(k1, r[i][1]));
        }
    }

    return ACTIVE(vec4(sum[0], sum[1], sum[2], sum[3]));
}

//!HOOK LUMA
//!DESC ARNet b8 Layer6 L0
//!WHEN OUTPUT.w LUMA.w / 1.2 > OUTPUT.h LUMA.h / 1.2 > *
//!BIND TMP1_L0
//!BIND TMP1_L1
//!BIND TMP2_L0
//!SAVE TMP2_L0
//!COMPONENTS 4

#define ACTIVE(v) (v)

#define TEX_BIND_L0_TEXOFF TMP1_L0_texOff
#define TEX_BIND_L0_TEX TMP1_L0_tex
#define TEX_BIND_L0_POS TMP1_L0_pos
#define TEX_BIND_L0_SIZE TMP1_L0_size
#define TEX_BIND_L0_PT TMP1_L0_pt

#define TEX_BIND_L1_TEXOFF TMP1_L1_texOff
#define TEX_BIND_L1_TEX TMP1_L1_tex
#define TEX_BIND_L1_POS TMP1_L1_pos
#define TEX_BIND_L1_SIZE TMP1_L1_size
#define TEX_BIND_L1_PT TMP1_L1_pt

#define TEX_BIND_L2_TEXOFF TMP2_L0_texOff
#define TEX_BIND_L2_TEX TMP2_L0_tex
#define TEX_BIND_L2_POS TMP2_L0_pos
#define TEX_BIND_L2_SIZE TMP2_L0_size
#define TEX_BIND_L2_PT TMP2_L0_pt

const float kernels[288] = float[288](
  +0.0837978f, +0.1228003f, -0.0703560f, -0.0641955f, -0.0114976f, +0.0341556f, +0.0738451f, -0.0889870f,
  -0.2173307f, +0.0479817f, +0.0552499f, -0.1548571f, -0.1405636f, -0.0947215f, -0.0134073f, -0.0878708f,
  -0.0765336f, -0.0590452f, -0.2614890f, +0.2675529f, +0.0400965f, +0.1565124f, +0.1227051f, +0.0617972f,
  +0.2919439f, +0.0327167f, -0.1849756f, +0.0549802f, +0.0871376f, -0.0802403f, +0.2551367f, +0.2131240f,
  -0.1224511f, +0.4748722f, +0.5186946f, -0.0873114f, -0.3997144f, -0.0971506f, +0.2587027f, +0.7342435f,
  -0.0256682f, -0.1654560f, -0.0771313f, -0.2500388f, +0.0576827f, -0.6784151f, -0.2076958f, +0.3415822f,
  +0.2429565f, -0.1881298f, +0.1686770f, -0.2987445f, -0.5862010f, -0.0735452f, -0.1471525f, +0.2864482f,
  +0.0273571f, +0.0951716f, -0.3569725f, -0.0258856f, +0.2207982f, +0.0894978f, +0.0917075f, +0.4269906f,
  +0.0999278f, +0.3059257f, -0.0067933f, -0.0302431f, +0.0509592f, -0.5163913f, +0.0050394f, -0.0125880f,
  -0.1074231f, -0.0680856f, -0.0005870f, +0.0323924f, +0.1713931f, +0.2156942f, -0.1641935f, -0.0255682f,
  -0.0037067f, +0.1583618f, +0.3636796f, -0.2396927f, -0.0664513f, -0.1057256f, -0.1510347f, +0.7256795f,
  +0.1324693f, -0.0830375f, +0.1237970f, -0.1674386f, +0.0575014f, +0.0537142f, -0.0146521f, +0.0713788f,
  +0.1714237f, -0.3078176f, -0.0154755f, +0.2518731f, -0.3118394f, +0.1951932f, -0.4976570f, -0.1742524f,
  +0.4461607f, +0.2679656f, -0.5095267f, +0.0454172f, +0.3256690f, +0.3742370f, +0.0462822f, -0.4030805f,
  +0.0554243f, +0.1022632f, +0.3456986f, +0.3430159f, -0.1335451f, -0.2751708f, +0.2557717f, -0.2283329f,
  -0.1965269f, -0.1663342f, +0.0952403f, +0.1766184f, -0.5435716f, +0.2378875f, -0.1327623f, -0.3473993f,
  -0.0164669f, +0.0567362f, -0.4255880f, +0.2778110f, +0.1764101f, +0.4611917f, +0.2502491f, -0.3237811f,
  -0.0025665f, -0.3915097f, +0.1281750f, -0.0826244f, -0.2243414f, +0.3225988f, +0.0942075f, +0.0594802f,
  +0.1693374f, -0.1377837f, -0.1106098f, +0.0854496f, +0.0476285f, -0.0351115f, +0.0052801f, +0.1565940f,
  +0.0512933f, +0.0001084f, -0.2596486f, +0.4332353f, +0.0535875f, -0.1692436f, -0.0184839f, +0.2616470f,
  +0.0043522f, +0.0350817f, -0.1765784f, -0.0098283f, -0.0505094f, -0.2191754f, -0.0632518f, +0.0065503f,
  -0.0088947f, +0.1333554f, +0.0769563f, +0.1273901f, +0.0411008f, -0.0096039f, -0.0893413f, -0.4161371f,
  +0.3724894f, -0.3727649f, +0.4161079f, +0.4558195f, -0.3320303f, -0.0962021f, -0.3298940f, +0.1414223f,
  +0.0256304f, -0.3550074f, -0.1918486f, +0.2701477f, +0.0550550f, +0.1492547f, -0.3946017f, +0.1477745f,
  +0.3261469f, -0.1867614f, +0.1222759f, -0.0096918f, -0.2095493f, +0.0323957f, +0.0625371f, +0.1484586f,
  -0.2677585f, -0.4405666f, -0.5216265f, -0.2314677f, +0.2903211f, +0.2342519f, -0.5945342f, +0.4083353f,
  +0.3564124f, -0.0176070f, -0.0108903f, +0.0935008f, -0.1024462f, -0.0368331f, -0.1091155f, +0.0581661f,
  -0.4079652f, +0.0366355f, +0.3528140f, -0.2226549f, +0.0284045f, +0.0154743f, -0.2485954f, +0.4920169f,
  -0.1987036f, -0.2829289f, -0.0373719f, -0.1120981f, +0.2220590f, -0.0547982f, -0.1054202f, -0.0988572f,
  +0.0616206f, -0.0037112f, +0.0096426f, +0.0307521f, +0.1108930f, +0.1268080f, -0.0383231f, +0.2466425f,
  -0.1946778f, +0.2400093f, -0.1019288f, +0.4299186f, -0.1670454f, +0.2099292f, +0.1553068f, -0.3243133f,
  -0.3228043f, +0.2425779f, +0.5559786f, -0.4121478f, -0.5208183f, +0.1542216f, +0.3963597f, -0.7344834f,
  +0.1107932f, -0.1152642f, -0.0030243f, +0.2643866f, -0.2103690f, +0.2509025f, -0.0010583f, -0.1244840f,
  -0.0443482f, +0.0807245f, -0.0671165f, +0.2289605f, +0.3688083f, +0.0317427f, +0.3125349f, -0.1330657f,
  +0.0056187f, +0.0582256f, +0.1668646f, -0.1764855f, +0.1994069f, -0.1096077f, +0.0171686f, -0.2672063f,
  +0.2793400f, -0.1699596f, -0.1828416f, -0.1236377f, +0.0221664f, +0.3996775f, -0.4010464f, +0.0270952f
);

const float biases[4] = float[4](
  -0.0161754f, -0.0434815f, -0.0986065f, +0.1646352f
);

vec4 hook() {
    const vec4 r[9][2] = vec4[9][2](
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 1.0f)))
    );

    float sum[4] = biases;
    for (int n = 0; n < 4; n++) {
        for (int i = 0; i < 9; i++) {
            const vec4 k0 = vec4(kernels[n * 8 * 9 + 8 * i + 0], kernels[n * 8 * 9 + 8 * i + 1], kernels[n * 8 * 9 + 8 * i + 2], kernels[n * 8 * 9 + 8 * i + 3]);
            const vec4 k1 = vec4(kernels[n * 8 * 9 + 8 * i + 4], kernels[n * 8 * 9 + 8 * i + 5], kernels[n * 8 * 9 + 8 * i + 6], kernels[n * 8 * 9 + 8 * i + 7]);
            sum[n] += (dot(k0, r[i][0]) + dot(k1, r[i][1]));
        }
    }

    return ACTIVE(vec4(sum[0], sum[1], sum[2], sum[3]) * 0.2000000f + TEX_BIND_L2_TEXOFF(vec2(0.0f, 0.0f)));
}

//!HOOK LUMA
//!DESC ARNet b8 Layer6 L1
//!WHEN OUTPUT.w LUMA.w / 1.2 > OUTPUT.h LUMA.h / 1.2 > *
//!BIND TMP1_L0
//!BIND TMP1_L1
//!BIND TMP2_L1
//!SAVE TMP2_L1
//!COMPONENTS 4

#define ACTIVE(v) (v)

#define TEX_BIND_L0_TEXOFF TMP1_L0_texOff
#define TEX_BIND_L0_TEX TMP1_L0_tex
#define TEX_BIND_L0_POS TMP1_L0_pos
#define TEX_BIND_L0_SIZE TMP1_L0_size
#define TEX_BIND_L0_PT TMP1_L0_pt

#define TEX_BIND_L1_TEXOFF TMP1_L1_texOff
#define TEX_BIND_L1_TEX TMP1_L1_tex
#define TEX_BIND_L1_POS TMP1_L1_pos
#define TEX_BIND_L1_SIZE TMP1_L1_size
#define TEX_BIND_L1_PT TMP1_L1_pt

#define TEX_BIND_L2_TEXOFF TMP2_L1_texOff
#define TEX_BIND_L2_TEX TMP2_L1_tex
#define TEX_BIND_L2_POS TMP2_L1_pos
#define TEX_BIND_L2_SIZE TMP2_L1_size
#define TEX_BIND_L2_PT TMP2_L1_pt

const float kernels[288] = float[288](
  -0.0480192f, -0.2969893f, +0.1336672f, -0.0545328f, +0.0049819f, -0.0083337f, -0.1489416f, -0.0915811f,
  +0.0377952f, -0.0476420f, -0.2267192f, +0.4347041f, +0.2389686f, +0.1349314f, -0.0045808f, +1.1562297f,
  +0.0230997f, -0.0178704f, -0.1099872f, -0.0045551f, +0.1341480f, +0.1674170f, -0.1383377f, +0.4487801f,
  +0.1694575f, +0.1244902f, -0.2222444f, +0.0480458f, +0.4150299f, -0.0566650f, +0.1340993f, -0.1781713f,
  +0.2210416f, +1.2807415f, +0.4503357f, +0.0164509f, -0.7245322f, -0.0241423f, +0.2203586f, -0.2198701f,
  +0.1382687f, -0.1037645f, +0.1976086f, -0.3553028f, -0.5197915f, -1.1169542f, -0.2210086f, -0.0333417f,
  -0.0603924f, -0.0398625f, +0.0613768f, +0.0597036f, +0.1969680f, -0.1071965f, +0.1272919f, +0.0811834f,
  +0.3487567f, -0.4743166f, -0.3531028f, -0.1077426f, +1.2399319f, +0.3499266f, -0.0543786f, +0.4732583f,
  -0.1428157f, -0.0374575f, -0.2793452f, +0.1981535f, +0.2848783f, +0.2610678f, -0.0424308f, -0.0247312f,
  -0.1780666f, -0.0764164f, +0.1059838f, -0.0082293f, +0.0510012f, +0.0497708f, -0.0691466f, -0.2069260f,
  +0.1806094f, -0.0991425f, -0.1169770f, +0.1138442f, -0.0432156f, +0.0917319f, +0.3513722f, -0.5772040f,
  +0.0384610f, +0.2370598f, +0.1936051f, -0.0930207f, -0.0591109f, +0.1384089f, -0.0525561f, -0.0069601f,
  +0.0035229f, +0.0715425f, -0.0109876f, +0.2197452f, +0.2560833f, +0.0248414f, +0.0283563f, -0.6743633f,
  -0.0355835f, -0.1643798f, +0.0685644f, -0.0737913f, +0.7070861f, +0.1114925f, -0.0629651f, +0.1305373f,
  -0.0230026f, -0.3384741f, -0.1884027f, -0.1142339f, +0.1354882f, -0.2816782f, +0.3161365f, +0.0262210f,
  +0.1471877f, -0.0920974f, +0.2381026f, -0.1225381f, -0.4506027f, -0.0489130f, -0.1068204f, -0.1877686f,
  +0.5321126f, -0.1738788f, -0.2089577f, +0.2418212f, +0.2928930f, +0.3117441f, -0.0222854f, +0.2599406f,
  -0.3820901f, +0.1779692f, +0.2432909f, +0.1319453f, -0.2264188f, -0.0730731f, +0.1423303f, -0.2131742f,
  -0.1668005f, +0.0780224f, -0.0612428f, -0.0784910f, +0.0700720f, -0.0040043f, +0.0918196f, -0.0401110f,
  +0.2417475f, -0.1001880f, -0.2940814f, +0.1120172f, -0.2625085f, +0.2599124f, +0.2697006f, -0.6918952f,
  +0.3287065f, -0.2968368f, +0.0468890f, +0.2566511f, -0.2448170f, +0.7580748f, -0.0240709f, -0.3712974f,
  -0.6387618f, +0.1121799f, +0.2320660f, -0.3795120f, -0.2250140f, -0.0489505f, -0.2416834f, -0.2879688f,
  -0.6997658f, +0.1737015f, -0.6051766f, +0.4259717f, +0.0613552f, -0.0402723f, -0.6187090f, +0.1913875f,
  +0.1175164f, -0.0976547f, +0.0397128f, +0.1505624f, +0.0022897f, +0.3148589f, -0.2815292f, -0.1238094f,
  -0.0659828f, +0.4333858f, +0.1435637f, +0.0571757f, -0.1550246f, +0.0206602f, -0.1933767f, -0.1140681f,
  -0.1729901f, +0.2496056f, -0.1279887f, -0.1262649f, -0.1085534f, -0.2724461f, -0.5179994f, -0.3618224f,
  +0.1657248f, -0.1731247f, +0.1792776f, +0.0988267f, -0.1345438f, +0.1840142f, +0.2587881f, -0.0943250f,
  -0.1947421f, +0.2500208f, +0.0941024f, -0.1124555f, +0.1277525f, +0.0962339f, -0.0114116f, +0.4171290f,
  +0.0434246f, +0.0274844f, +0.0107663f, -0.3154007f, +0.0654466f, +0.1149488f, -0.2002873f, -0.2657950f,
  +0.1430213f, -0.0852249f, +0.2044977f, -0.2746769f, -0.1006238f, -0.0991804f, +0.0524012f, -0.0535082f,
  +0.1403732f, -0.0647887f, -0.1657988f, +0.3068703f, -0.3250451f, +0.1836344f, +0.1134135f, -0.7991945f,
  +0.1728500f, +0.1182549f, +0.1519824f, +1.0628239f, +0.1471221f, +0.1731014f, -0.2956628f, +0.4545491f,
  +0.0033782f, +0.4430089f, +0.2698188f, +0.0351302f, -0.0736906f, -0.1955278f, -0.2449650f, -0.0127308f,
  +0.4675455f, -0.1270074f, +0.2645365f, -0.2392617f, -0.3844974f, -0.0832593f, -0.3223610f, +0.3325529f,
  -0.1826235f, -0.1826553f, +0.0674206f, +0.1322234f, -0.4408806f, -0.2020036f, +0.0312647f, +0.4210984f,
  +0.1887006f, +0.0469155f, -0.1989143f, -0.1211969f, -0.0772172f, -0.0432869f, -0.0378824f, -0.0708598f
);

const float biases[4] = float[4](
  -0.1321409f, -0.1218317f, +0.3376743f, -0.0901326f
);

vec4 hook() {
    const vec4 r[9][2] = vec4[9][2](
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 1.0f)))
    );

    float sum[4] = biases;
    for (int n = 0; n < 4; n++) {
        for (int i = 0; i < 9; i++) {
            const vec4 k0 = vec4(kernels[n * 8 * 9 + 8 * i + 0], kernels[n * 8 * 9 + 8 * i + 1], kernels[n * 8 * 9 + 8 * i + 2], kernels[n * 8 * 9 + 8 * i + 3]);
            const vec4 k1 = vec4(kernels[n * 8 * 9 + 8 * i + 4], kernels[n * 8 * 9 + 8 * i + 5], kernels[n * 8 * 9 + 8 * i + 6], kernels[n * 8 * 9 + 8 * i + 7]);
            sum[n] += (dot(k0, r[i][0]) + dot(k1, r[i][1]));
        }
    }

    return ACTIVE(vec4(sum[0], sum[1], sum[2], sum[3]) * 0.2000000f + TEX_BIND_L2_TEXOFF(vec2(0.0f, 0.0f)));
}

//!HOOK LUMA
//!DESC ARNet b8 Layer7 L0
//!WHEN OUTPUT.w LUMA.w / 1.2 > OUTPUT.h LUMA.h / 1.2 > *
//!BIND TMP2_L0
//!BIND TMP2_L1
//!SAVE TMP1_L0
//!COMPONENTS 4

#define ACTIVE(v) (max(v, v * 0.2000000f))

#define TEX_BIND_L0_TEXOFF TMP2_L0_texOff
#define TEX_BIND_L0_TEX TMP2_L0_tex
#define TEX_BIND_L0_POS TMP2_L0_pos
#define TEX_BIND_L0_SIZE TMP2_L0_size
#define TEX_BIND_L0_PT TMP2_L0_pt

#define TEX_BIND_L1_TEXOFF TMP2_L1_texOff
#define TEX_BIND_L1_TEX TMP2_L1_tex
#define TEX_BIND_L1_POS TMP2_L1_pos
#define TEX_BIND_L1_SIZE TMP2_L1_size
#define TEX_BIND_L1_PT TMP2_L1_pt

const float kernels[288] = float[288](
  -0.2567507f, +0.1563071f, -0.2132602f, -0.0271939f, -0.3977104f, -0.0136334f, -0.0795753f, -0.1410238f,
  -0.5408407f, -0.4151800f, -0.1113154f, +0.4026290f, +0.4027892f, -0.4903623f, +0.0685149f, +0.0172041f,
  -0.1156913f, -0.0059044f, +0.0617901f, +0.1340732f, +0.0125551f, -0.0741592f, -0.0310692f, +0.0373031f,
  -0.6121635f, +0.2888093f, -0.2954848f, +0.0439149f, -0.0099424f, -0.1043395f, +0.0160874f, +0.0152175f,
  +0.5704173f, +0.5527768f, +0.0288239f, -0.1921191f, -0.5402111f, +0.0495442f, +0.3769072f, +0.3630660f,
  -0.0386134f, -0.2332191f, -0.4309284f, +0.0898608f, +0.0318272f, +0.1106695f, -0.3299167f, -0.2209314f,
  -0.1819821f, +0.2175285f, -0.1198257f, -0.1927454f, +0.0747443f, +0.0414492f, +0.2741353f, +0.0268848f,
  +0.1132095f, +0.1128106f, +0.3903039f, +0.1058626f, -0.4213954f, +0.1591374f, -0.2681766f, -0.0763671f,
  -0.0926534f, -0.0894161f, -0.2238590f, +0.0243761f, +0.1897155f, +0.3504835f, -0.3264002f, -0.0439836f,
  -0.1048949f, +0.0278259f, -0.0265876f, +0.0236982f, +0.2591749f, -0.2429533f, +0.0364378f, -0.0896453f,
  -0.1608291f, -0.1564866f, -0.1351034f, -0.2236260f, -0.0245816f, -0.1106170f, -0.0446748f, -0.0969756f,
  +0.3529746f, +0.1257883f, +0.0390132f, +0.0676204f, -0.2524864f, +0.1414654f, -0.2250391f, +0.2351116f,
  -0.3876467f, +0.0402083f, -0.2194863f, -0.1558855f, -0.0570598f, -0.2621818f, +0.1370118f, +0.0755428f,
  -0.1421641f, +0.4704390f, +0.0676847f, +0.0222483f, +0.0384640f, -0.1026134f, -0.3902408f, +0.0440191f,
  +0.3586767f, +0.6811851f, -0.0834068f, -0.3777685f, -0.5428386f, +0.2250673f, -0.1290689f, +0.6001269f,
  -0.3112714f, +0.1107192f, -0.0635058f, -0.0933759f, +0.1594399f, -0.1439349f, +0.1920357f, +0.1383902f,
  -0.2669422f, -0.0485594f, +0.0264852f, +0.0873902f, -0.0301385f, +0.2214562f, +0.4493863f, +0.0551940f,
  +0.0042861f, +0.1020392f, -0.0838308f, +0.0122774f, -0.3815260f, +0.0806054f, +0.1376278f, -0.0858602f,
  +0.6300163f, -0.0226949f, -0.1331652f, +0.0170299f, -0.1719837f, +0.1547112f, -0.5006530f, -0.0996333f,
  +0.1657931f, -0.0893612f, -0.0083282f, +0.0887563f, +0.0785784f, -0.1130612f, +0.5597920f, +0.0787391f,
  -0.2541717f, -0.1627779f, -0.1567530f, +0.1787338f, -0.0221154f, -0.0759518f, -0.0921875f, -0.1360981f,
  +0.7455910f, +0.0182476f, -0.4537641f, +0.3399923f, +0.2660988f, +0.5859911f, -0.7846029f, -0.1695876f,
  +0.0086845f, -0.2537112f, -0.2182854f, -0.4687149f, +0.5744613f, -0.1938288f, +0.9803799f, +0.5870879f,
  -0.2194252f, -0.4907155f, +0.3154083f, +0.4827900f, +0.0713794f, -0.1474352f, +0.0141194f, +0.0606610f,
  +0.2925186f, +0.2391901f, -0.1116795f, -0.0000561f, +0.1700283f, +0.0983530f, -0.7682979f, +0.1250959f,
  -0.0176401f, -0.1892859f, -0.2302842f, +0.3076715f, -0.0461561f, +0.0365063f, -0.0268826f, +0.1973636f,
  -0.1685373f, -0.1067552f, +0.2337682f, +0.2312844f, +0.1738699f, -0.1812595f, +0.3046601f, +0.1306010f,
  -0.3138147f, +0.3446566f, -0.3052410f, +0.0190207f, -0.3268355f, +0.0871202f, +0.0137344f, -0.0481463f,
  -0.1103928f, -0.1261914f, +0.4401189f, +0.2856140f, -0.0275583f, -0.0877980f, +0.1690660f, +0.0581499f,
  -0.0074221f, +0.1235776f, -0.0616281f, +0.1774418f, +0.0785758f, +0.0930490f, +0.0929986f, -0.0363117f,
  +0.0766082f, +0.1482462f, +0.1118373f, -0.0572375f, +0.4362931f, +0.3592513f, -0.0276846f, +0.0661367f,
  -0.2115325f, -0.2155974f, +0.0017830f, +0.3943861f, +0.4653872f, +0.0388690f, -0.0437273f, -0.1286732f,
  -0.0601029f, +0.2421744f, -0.0756508f, -0.2831803f, +0.1927129f, +0.1099270f, -0.0146509f, +0.3825010f,
  -0.5786352f, -0.0605181f, -0.0439002f, -0.0318805f, +0.0170960f, -0.2008424f, +0.3388708f, +0.0115577f,
  +0.2031288f, +0.2886376f, -0.1919822f, -0.1713952f, -0.3173038f, -0.2833888f, +0.3370800f, +0.3567726f,
  +0.0396464f, +0.1038807f, -0.1568391f, +0.0707803f, +0.0513561f, -0.0204444f, +0.2238488f, +0.0146699f
);

const float biases[4] = float[4](
  +0.0192088f, +0.1030052f, -0.0178327f, +0.0133222f
);

vec4 hook() {
    const vec4 r[9][2] = vec4[9][2](
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 1.0f)))
    );

    float sum[4] = biases;
    for (int n = 0; n < 4; n++) {
        for (int i = 0; i < 9; i++) {
            const vec4 k0 = vec4(kernels[n * 8 * 9 + 8 * i + 0], kernels[n * 8 * 9 + 8 * i + 1], kernels[n * 8 * 9 + 8 * i + 2], kernels[n * 8 * 9 + 8 * i + 3]);
            const vec4 k1 = vec4(kernels[n * 8 * 9 + 8 * i + 4], kernels[n * 8 * 9 + 8 * i + 5], kernels[n * 8 * 9 + 8 * i + 6], kernels[n * 8 * 9 + 8 * i + 7]);
            sum[n] += (dot(k0, r[i][0]) + dot(k1, r[i][1]));
        }
    }

    return ACTIVE(vec4(sum[0], sum[1], sum[2], sum[3]));
}

//!HOOK LUMA
//!DESC ARNet b8 Layer7 L1
//!WHEN OUTPUT.w LUMA.w / 1.2 > OUTPUT.h LUMA.h / 1.2 > *
//!BIND TMP2_L0
//!BIND TMP2_L1
//!SAVE TMP1_L1
//!COMPONENTS 4

#define ACTIVE(v) (max(v, v * 0.2000000f))

#define TEX_BIND_L0_TEXOFF TMP2_L0_texOff
#define TEX_BIND_L0_TEX TMP2_L0_tex
#define TEX_BIND_L0_POS TMP2_L0_pos
#define TEX_BIND_L0_SIZE TMP2_L0_size
#define TEX_BIND_L0_PT TMP2_L0_pt

#define TEX_BIND_L1_TEXOFF TMP2_L1_texOff
#define TEX_BIND_L1_TEX TMP2_L1_tex
#define TEX_BIND_L1_POS TMP2_L1_pos
#define TEX_BIND_L1_SIZE TMP2_L1_size
#define TEX_BIND_L1_PT TMP2_L1_pt

const float kernels[288] = float[288](
  +0.1333325f, -0.2263825f, +0.0345736f, -0.0164817f, +0.2544743f, -0.0802588f, -0.2004665f, +0.0372048f,
  +0.3039897f, +0.1818281f, -0.0874376f, +0.0827996f, -0.1753800f, +0.0032223f, -0.0558240f, +0.0669738f,
  +0.0249128f, +0.0312382f, -0.1299172f, -0.1380051f, +0.1273482f, -0.1406362f, -0.0796427f, -0.0531649f,
  -0.0753138f, +0.2122836f, -0.2012318f, +0.2721263f, -0.3718166f, -0.1065836f, +0.5237659f, +0.3303609f,
  +0.2293560f, +0.4809557f, +0.0866938f, +0.2641781f, -0.4258652f, +0.0616358f, -0.1915038f, +0.4141433f,
  +0.1407791f, -0.0602891f, +0.1087625f, +0.3528048f, -0.1828072f, -0.0281781f, +0.0587382f, +0.1016679f,
  +0.1659870f, +0.0512361f, +0.0955614f, +0.3249902f, +0.5305201f, -0.0403145f, -0.6964614f, +0.2924994f,
  -0.0708580f, -0.5386670f, -0.0397312f, +0.2700192f, -0.1426447f, +0.0658518f, -0.4509002f, +0.1647954f,
  -0.2098190f, +0.0807712f, +0.0604011f, -0.3200563f, -0.1779456f, +0.1374367f, -0.0381777f, +0.1070166f,
  -0.3047490f, -0.0521662f, +0.1885842f, +0.1711644f, -0.1118143f, -0.1191987f, +0.2736398f, -0.0544069f,
  +0.2407006f, +0.2969412f, -0.1577233f, -0.0022681f, +0.0830700f, -0.0572868f, -0.0119662f, +0.1242670f,
  -0.4441174f, +0.2947657f, -0.2075441f, -0.1405378f, +0.2319292f, +0.0777787f, +0.1593480f, -0.1027871f,
  -0.1880504f, -0.3330327f, +0.2903270f, +0.0782683f, -0.4527892f, +0.0800833f, +0.3978038f, -0.0878400f,
  +0.1562114f, -0.0745044f, +0.0219071f, +0.2187872f, -0.2751162f, +0.1140553f, -0.0554958f, -0.1266668f,
  -0.2160633f, -0.1283056f, +0.0555940f, +0.5491865f, -0.4834287f, +0.0523761f, +0.0399353f, -0.0843261f,
  -0.2865426f, -0.1391451f, -0.0129304f, +0.0312345f, +0.0284570f, +0.0277661f, -0.0062862f, +0.0129664f,
  +0.3227113f, +0.1879661f, -0.1320601f, -0.3478748f, +0.0204687f, -0.1190263f, +0.2230651f, -0.1617006f,
  -0.3541089f, +0.0961288f, -0.0929545f, -0.3060063f, +0.2223459f, +0.0274985f, +0.1208318f, -0.1689624f,
  +0.0335683f, +0.0118080f, +0.0128824f, +0.1147636f, -0.1530933f, -0.0596942f, -0.0309957f, +0.1329557f,
  +0.2215739f, +0.1958567f, -0.1128183f, +0.0174204f, -0.1560847f, +0.2196877f, -0.1513706f, -0.1236683f,
  +0.1334358f, +0.1525464f, +0.0564043f, -0.0629789f, +0.1894878f, +0.2062261f, +0.3530664f, -0.1569854f,
  +0.3109663f, +0.1915917f, -0.0748053f, -0.0703035f, +0.0656048f, +0.0121333f, -0.1651288f, +0.0595202f,
  +0.0792640f, -0.1324692f, -0.0096015f, +0.0963858f, +0.6864481f, +0.3575782f, +0.0722014f, -0.0675099f,
  -0.5384414f, +0.4145316f, +0.6154495f, +0.0772700f, +0.4520211f, +0.1557656f, +1.1107439f, +0.4633693f,
  -0.2861752f, +0.1180927f, -0.2039717f, -0.1576911f, +0.2601913f, +0.0558864f, -0.0963911f, -0.0242210f,
  +0.2042056f, +0.2151336f, -0.2962728f, -0.0298105f, +0.1959436f, +0.3430972f, -0.2086937f, +0.0707852f,
  -0.3403800f, +0.1707422f, +0.1381108f, -0.1366216f, -0.1628799f, -0.2428949f, +0.0553362f, +0.2092216f,
  -0.0051929f, +0.3706553f, -0.3807410f, +0.1327480f, -0.1362113f, -0.6658013f, -0.0639529f, -0.0529164f,
  -0.2235696f, +0.2058214f, -0.1390996f, -0.2920911f, +0.1112446f, +0.0396104f, +0.0787816f, +0.3554680f,
  -0.0161013f, +0.1306559f, +0.2838498f, -0.0615025f, +0.0185493f, +0.4999280f, -0.0997193f, +0.0237561f,
  +0.1105708f, +0.0208475f, +0.1949993f, +0.2382119f, -0.4294605f, +0.7775013f, -0.1616194f, +0.0845731f,
  -0.3002150f, +0.1289071f, +0.4359085f, +0.2150573f, -0.3501693f, +0.3929138f, +0.3738209f, +0.1497105f,
  +0.1349958f, +0.5946887f, +0.0361868f, -0.1839449f, -0.2736488f, +0.3750514f, +0.1065420f, +0.1856677f,
  -0.0009412f, +0.0012831f, +0.0624064f, +0.2563846f, +0.2183768f, +0.5181851f, +0.2394181f, +0.0692425f,
  -0.2218576f, +0.2122343f, +0.0059303f, +0.4717582f, -0.0894293f, -0.0923079f, +0.5583220f, +0.2941370f,
  +0.3323103f, +0.3376265f, -0.4311843f, +0.0117109f, -0.0341523f, +0.1869116f, -0.3420934f, +0.3135560f
);

const float biases[4] = float[4](
  +0.0319075f, +0.1539991f, +0.0485794f, -0.0536483f
);

vec4 hook() {
    const vec4 r[9][2] = vec4[9][2](
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 1.0f)))
    );

    float sum[4] = biases;
    for (int n = 0; n < 4; n++) {
        for (int i = 0; i < 9; i++) {
            const vec4 k0 = vec4(kernels[n * 8 * 9 + 8 * i + 0], kernels[n * 8 * 9 + 8 * i + 1], kernels[n * 8 * 9 + 8 * i + 2], kernels[n * 8 * 9 + 8 * i + 3]);
            const vec4 k1 = vec4(kernels[n * 8 * 9 + 8 * i + 4], kernels[n * 8 * 9 + 8 * i + 5], kernels[n * 8 * 9 + 8 * i + 6], kernels[n * 8 * 9 + 8 * i + 7]);
            sum[n] += (dot(k0, r[i][0]) + dot(k1, r[i][1]));
        }
    }

    return ACTIVE(vec4(sum[0], sum[1], sum[2], sum[3]));
}

//!HOOK LUMA
//!DESC ARNet b8 Layer8 L0
//!WHEN OUTPUT.w LUMA.w / 1.2 > OUTPUT.h LUMA.h / 1.2 > *
//!BIND TMP1_L0
//!BIND TMP1_L1
//!BIND TMP2_L0
//!SAVE TMP2_L0
//!COMPONENTS 4

#define ACTIVE(v) (v)

#define TEX_BIND_L0_TEXOFF TMP1_L0_texOff
#define TEX_BIND_L0_TEX TMP1_L0_tex
#define TEX_BIND_L0_POS TMP1_L0_pos
#define TEX_BIND_L0_SIZE TMP1_L0_size
#define TEX_BIND_L0_PT TMP1_L0_pt

#define TEX_BIND_L1_TEXOFF TMP1_L1_texOff
#define TEX_BIND_L1_TEX TMP1_L1_tex
#define TEX_BIND_L1_POS TMP1_L1_pos
#define TEX_BIND_L1_SIZE TMP1_L1_size
#define TEX_BIND_L1_PT TMP1_L1_pt

#define TEX_BIND_L2_TEXOFF TMP2_L0_texOff
#define TEX_BIND_L2_TEX TMP2_L0_tex
#define TEX_BIND_L2_POS TMP2_L0_pos
#define TEX_BIND_L2_SIZE TMP2_L0_size
#define TEX_BIND_L2_PT TMP2_L0_pt

const float kernels[288] = float[288](
  -0.0704773f, +0.1911399f, +0.0631234f, -0.1542268f, +0.0673671f, -0.1517983f, +0.1670780f, +0.1758455f,
  -0.0473705f, +0.1546143f, -0.2919859f, -0.0250095f, +0.0735180f, -0.3566751f, -0.0653211f, +0.1296378f,
  +0.1153051f, +0.2541907f, +0.9728196f, +0.0314302f, -0.3379135f, -0.1495723f, +0.1935100f, +0.0126676f,
  -0.1735289f, +0.1928985f, +0.0241366f, -0.1142645f, -0.0498184f, +0.2138307f, +0.4042879f, -0.2140790f,
  -0.5583992f, +0.2556005f, -0.3504613f, +0.1676291f, -0.4489140f, -0.0536595f, -0.4026763f, -0.4597153f,
  +0.1366346f, +0.3335066f, +0.6042343f, -0.1063257f, -0.6623689f, +0.2385664f, -0.0141637f, -0.3423090f,
  +0.1081448f, -0.2225364f, -0.0788956f, -0.0485854f, +0.0949506f, -0.0840402f, -0.0584138f, -0.0564159f,
  +0.6696758f, -0.0399519f, +0.5093747f, +0.0071964f, +0.1371406f, +0.1362894f, -0.1514098f, -0.3589353f,
  -0.0330250f, +0.0934820f, -0.4851074f, +0.2360964f, +0.0998939f, -0.1111990f, -0.1199710f, +0.0987657f,
  -0.0143279f, +0.0253522f, +0.0652772f, -0.0168746f, -0.0200806f, -0.1591997f, -0.0925528f, -0.1847739f,
  +0.3360752f, -0.1857496f, +0.0473281f, -0.0241252f, -0.0592592f, +0.1161582f, -0.1061888f, -0.5488173f,
  +0.0120460f, -0.0874659f, -0.6608664f, +0.1172235f, +0.1355965f, +0.0465200f, -0.2579663f, -0.1803830f,
  +0.1217594f, -0.4511836f, -0.3756874f, +0.1959610f, +0.0935199f, -0.4562786f, -0.5497456f, -0.1403727f,
  -0.2228726f, -0.5661542f, +0.5924829f, +0.6757243f, -0.2786110f, +0.4103570f, -0.2152915f, +0.1910015f,
  -0.0500474f, -0.2833595f, -0.3712215f, -0.0394947f, +0.1807008f, -0.0136669f, +0.1327094f, +0.2737810f,
  +0.0063382f, +0.0877151f, -0.1719487f, -0.1937951f, -0.1408678f, -0.5150247f, +0.0791777f, +0.0077687f,
  +0.1871616f, +0.0239308f, +0.4495910f, +0.1123003f, -0.2647555f, -0.2135609f, +0.3459732f, +0.3275784f,
  -0.2227675f, -0.0567876f, -0.1970191f, -0.2578441f, -0.1008211f, +0.2026709f, +0.0741349f, -0.0208994f,
  +0.2122432f, +0.0148257f, +0.0528218f, -0.0252286f, +0.0122218f, +0.1908614f, -0.2278270f, -0.0060183f,
  -0.0824995f, +0.3354949f, +0.5341182f, +0.0345321f, -0.2581530f, +0.2653765f, -0.1662378f, -0.2483699f,
  +0.0508441f, -0.1359167f, -0.2406212f, -0.1021570f, -0.2409226f, +0.1327269f, -0.0245488f, -0.0048840f,
  +0.4431983f, -0.0402738f, -0.1152318f, -0.1702042f, +0.0233416f, -0.0941455f, -0.1261061f, -0.0894925f,
  -0.1661875f, -0.5727069f, +0.4551525f, -0.2946627f, +0.1874187f, +0.1408794f, -0.2418719f, -0.2260155f,
  +0.0060541f, +0.2705764f, +0.1569067f, -0.2978833f, +0.0898039f, +0.0145618f, +0.2213652f, +0.0806288f,
  +0.1591180f, +0.0326853f, +0.0251557f, -0.2578577f, -0.1257503f, +0.1400914f, -0.0748025f, -0.0783347f,
  +0.1018185f, +0.1872978f, +0.5150900f, -0.1155539f, -0.0408555f, +0.3161952f, -0.0196233f, +0.0884492f,
  +0.2047449f, -0.2193852f, -0.3821728f, +0.2022738f, -0.0366559f, -0.2522769f, +0.1354885f, -0.1007327f,
  +0.2727945f, +0.2226020f, -0.0509898f, +0.0767754f, -0.1407371f, +0.1957336f, -0.1948918f, -0.5489770f,
  +0.0681932f, -0.5553740f, -0.4253708f, +0.1916194f, -0.2512065f, -0.1432146f, -0.0779556f, -0.0338614f,
  +0.2380643f, +0.2776124f, +0.4184536f, +0.0134787f, +0.0484286f, +0.1026130f, +0.0472433f, -0.0665015f,
  +0.0498309f, +0.1990933f, +0.0374768f, +0.0372299f, -0.1097023f, -0.4653745f, -0.2106603f, +0.2042903f,
  +0.8453774f, -0.3355123f, +0.1790045f, -0.7112220f, -0.2547338f, -0.2835879f, +0.0518468f, +0.4096639f,
  +0.1369465f, +0.2249884f, +0.3545878f, +0.1750649f, +0.1845140f, -0.0822939f, -0.0089625f, +0.0260163f,
  -0.3896858f, +0.1022146f, +0.0273151f, +0.0969899f, -0.1557924f, -0.1967895f, -0.0826189f, +0.0828568f,
  -0.2644467f, -0.2022981f, -0.2289815f, -0.2302353f, -0.1006933f, -0.2294524f, +0.3214984f, +0.3898609f,
  +0.1586736f, +0.1841860f, +0.4559902f, -0.0956181f, +0.0100191f, -0.0164369f, -0.1842753f, +0.0281308f
);

const float biases[4] = float[4](
  -0.0674289f, +0.0249919f, -0.1784919f, +0.1275979f
);

vec4 hook() {
    const vec4 r[9][2] = vec4[9][2](
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 1.0f)))
    );

    float sum[4] = biases;
    for (int n = 0; n < 4; n++) {
        for (int i = 0; i < 9; i++) {
            const vec4 k0 = vec4(kernels[n * 8 * 9 + 8 * i + 0], kernels[n * 8 * 9 + 8 * i + 1], kernels[n * 8 * 9 + 8 * i + 2], kernels[n * 8 * 9 + 8 * i + 3]);
            const vec4 k1 = vec4(kernels[n * 8 * 9 + 8 * i + 4], kernels[n * 8 * 9 + 8 * i + 5], kernels[n * 8 * 9 + 8 * i + 6], kernels[n * 8 * 9 + 8 * i + 7]);
            sum[n] += (dot(k0, r[i][0]) + dot(k1, r[i][1]));
        }
    }

    return ACTIVE(vec4(sum[0], sum[1], sum[2], sum[3]) * 0.2000000f + TEX_BIND_L2_TEXOFF(vec2(0.0f, 0.0f)));
}

//!HOOK LUMA
//!DESC ARNet b8 Layer8 L1
//!WHEN OUTPUT.w LUMA.w / 1.2 > OUTPUT.h LUMA.h / 1.2 > *
//!BIND TMP1_L0
//!BIND TMP1_L1
//!BIND TMP2_L1
//!SAVE TMP2_L1
//!COMPONENTS 4

#define ACTIVE(v) (v)

#define TEX_BIND_L0_TEXOFF TMP1_L0_texOff
#define TEX_BIND_L0_TEX TMP1_L0_tex
#define TEX_BIND_L0_POS TMP1_L0_pos
#define TEX_BIND_L0_SIZE TMP1_L0_size
#define TEX_BIND_L0_PT TMP1_L0_pt

#define TEX_BIND_L1_TEXOFF TMP1_L1_texOff
#define TEX_BIND_L1_TEX TMP1_L1_tex
#define TEX_BIND_L1_POS TMP1_L1_pos
#define TEX_BIND_L1_SIZE TMP1_L1_size
#define TEX_BIND_L1_PT TMP1_L1_pt

#define TEX_BIND_L2_TEXOFF TMP2_L1_texOff
#define TEX_BIND_L2_TEX TMP2_L1_tex
#define TEX_BIND_L2_POS TMP2_L1_pos
#define TEX_BIND_L2_SIZE TMP2_L1_size
#define TEX_BIND_L2_PT TMP2_L1_pt

const float kernels[288] = float[288](
  +0.1702521f, +0.0016625f, -0.3302039f, -0.1383855f, +0.0335812f, -0.1965588f, +0.3118869f, +0.2046125f,
  +0.6188105f, -0.0435168f, +0.0949391f, -0.1033638f, +0.1590420f, -0.0325820f, +0.0507023f, -0.4541824f,
  -0.0482027f, +0.1563147f, +0.0693923f, +0.0413116f, -0.4946027f, +0.0889981f, -0.4014331f, -0.2753353f,
  -0.0592781f, +0.3706796f, -0.0814187f, -0.0672140f, -0.1184626f, +0.0097770f, -0.1085448f, +0.1140467f,
  +0.6093025f, -0.3017933f, +0.1479699f, -0.2447468f, +0.3306667f, -0.1362544f, -0.6015324f, -0.3953557f,
  -0.0299400f, +0.1244270f, -0.1785517f, +0.0802695f, +0.2792568f, +0.3245242f, +0.2809958f, -0.1523716f,
  +0.2055079f, +0.4822506f, +0.1525896f, -0.2288652f, -0.0926037f, -0.0100951f, -0.0957169f, +0.1666582f,
  -0.4346662f, -0.2576063f, -0.0168265f, -0.2814898f, -0.0725342f, -0.0405048f, +0.0681055f, -0.0353106f,
  +0.3109849f, +0.0522346f, +0.2736463f, -0.1408806f, -0.2268565f, -0.1007291f, +0.2364284f, -0.0835956f,
  +0.1016744f, -0.0761273f, -0.0172946f, +0.0576728f, -0.0024916f, -0.2008331f, +0.1146264f, -0.1735433f,
  +0.0629895f, -0.0264041f, +0.5631068f, +0.1211555f, -0.0823116f, +0.1782919f, +0.0121300f, -0.0503638f,
  -0.0439996f, +0.1919959f, -0.1412073f, -0.0747482f, -0.1075267f, +0.0411454f, -0.0129321f, -0.0828711f,
  -0.1315632f, +0.1051493f, -0.0193247f, -0.0651602f, -0.1588695f, +0.3358901f, -0.1944318f, -0.1524232f,
  +0.0267266f, -0.2400482f, +0.3444744f, +0.4670219f, -0.0007532f, +0.0470499f, -0.3352726f, -0.4376264f,
  +0.2009547f, -0.1631367f, +0.0230554f, +0.4775432f, -0.2495736f, +0.0917918f, +0.3735012f, -0.2236907f,
  -0.1060015f, +0.2317749f, -0.1051019f, -0.0414832f, +0.0223220f, -0.0482225f, -0.3463919f, -0.1307944f,
  +0.0310901f, +0.1325804f, +0.1419335f, -0.0984852f, -0.0555281f, -0.1026120f, -0.0719591f, -0.2388185f,
  -0.0176738f, -0.1605946f, +0.1329122f, -0.2792721f, -0.2476777f, -0.1171661f, +0.0673906f, -0.0260519f,
  -0.2285257f, -0.3093987f, +0.0214345f, -0.0930971f, -0.0930641f, +0.0712741f, +0.1609931f, +0.4511688f,
  +0.1059581f, -0.2586786f, -0.3456287f, -0.1991799f, +0.3218869f, +0.1730350f, +0.4083126f, +0.6669313f,
  -0.1572687f, -0.1287605f, -0.0170578f, +0.0016193f, +0.3110430f, +0.0010416f, -0.1386835f, +0.3998711f,
  +0.2827677f, -0.1258156f, -0.2943507f, -0.1957617f, -0.0239845f, -0.2067103f, -0.6026982f, +0.0081964f,
  +0.0399124f, +0.2059794f, +0.8084666f, +0.1151124f, +0.0475334f, +0.1547851f, +0.0310284f, +0.0335832f,
  -0.0463746f, -0.1539427f, -0.6237997f, +0.0869619f, +0.3079128f, -0.1182543f, +0.0788500f, +0.0080981f,
  +0.3075003f, +0.3421064f, +0.2919943f, -0.1704187f, -0.0637054f, +0.1150911f, -0.1262743f, +0.1680453f,
  -0.0563103f, -0.0645766f, -0.0160567f, -0.1413915f, +0.0724024f, -0.0721720f, -0.1764200f, +0.2354192f,
  +0.1827181f, -0.1153015f, +0.0634817f, +0.1463564f, -0.0122777f, -0.1667238f, -0.0801869f, -0.0998847f,
  -0.0322861f, +0.1936465f, -0.1015487f, -0.0679751f, -0.1453375f, +0.4348034f, +0.0006945f, -0.1945719f,
  +0.0886104f, +0.2738742f, -0.3003082f, +0.0371235f, -0.1668976f, -0.2816762f, -0.0233504f, -0.0161481f,
  +0.1068017f, -0.0554061f, +0.3708978f, +0.1315616f, -0.2341326f, -0.1073182f, -0.0699254f, -0.2359991f,
  -0.1244272f, -0.1182735f, -0.0045471f, -0.1134928f, -0.1265766f, -0.3309155f, -0.5457966f, +0.0677462f,
  -0.1311623f, +0.0225904f, +0.1259177f, +0.0179072f, -0.3987984f, -0.2142003f, +0.3700098f, -0.4258679f,
  +0.1602025f, +0.0215780f, -0.5029861f, -0.1757860f, -0.5230644f, +0.0332157f, -0.0431555f, -0.1897708f,
  -0.2458983f, -0.1000690f, +0.0540877f, +0.0964559f, -0.0422873f, +0.2504306f, -0.2787871f, -0.1880008f,
  -0.0289211f, +0.0720574f, -0.2687277f, +0.1005678f, +0.0756599f, -0.2491946f, -0.0088185f, -0.1500826f,
  -0.0047728f, +0.0798803f, -0.5297701f, +0.1219026f, +0.1452659f, -0.0070097f, -0.0182190f, +0.0707632f
);

const float biases[4] = float[4](
  +0.0499946f, +0.1357699f, -0.0611704f, +0.1233285f
);

vec4 hook() {
    const vec4 r[9][2] = vec4[9][2](
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 1.0f)))
    );

    float sum[4] = biases;
    for (int n = 0; n < 4; n++) {
        for (int i = 0; i < 9; i++) {
            const vec4 k0 = vec4(kernels[n * 8 * 9 + 8 * i + 0], kernels[n * 8 * 9 + 8 * i + 1], kernels[n * 8 * 9 + 8 * i + 2], kernels[n * 8 * 9 + 8 * i + 3]);
            const vec4 k1 = vec4(kernels[n * 8 * 9 + 8 * i + 4], kernels[n * 8 * 9 + 8 * i + 5], kernels[n * 8 * 9 + 8 * i + 6], kernels[n * 8 * 9 + 8 * i + 7]);
            sum[n] += (dot(k0, r[i][0]) + dot(k1, r[i][1]));
        }
    }

    return ACTIVE(vec4(sum[0], sum[1], sum[2], sum[3]) * 0.2000000f + TEX_BIND_L2_TEXOFF(vec2(0.0f, 0.0f)));
}

//!HOOK LUMA
//!DESC ARNet b8 Layer9 L0
//!WHEN OUTPUT.w LUMA.w / 1.2 > OUTPUT.h LUMA.h / 1.2 > *
//!BIND TMP2_L0
//!BIND TMP2_L1
//!SAVE TMP1_L0
//!COMPONENTS 4

#define ACTIVE(v) (max(v, v * 0.2000000f))

#define TEX_BIND_L0_TEXOFF TMP2_L0_texOff
#define TEX_BIND_L0_TEX TMP2_L0_tex
#define TEX_BIND_L0_POS TMP2_L0_pos
#define TEX_BIND_L0_SIZE TMP2_L0_size
#define TEX_BIND_L0_PT TMP2_L0_pt

#define TEX_BIND_L1_TEXOFF TMP2_L1_texOff
#define TEX_BIND_L1_TEX TMP2_L1_tex
#define TEX_BIND_L1_POS TMP2_L1_pos
#define TEX_BIND_L1_SIZE TMP2_L1_size
#define TEX_BIND_L1_PT TMP2_L1_pt

const float kernels[288] = float[288](
  +0.0651736f, +0.1873292f, +0.1011051f, +0.0871744f, -0.3316905f, -0.0024289f, +0.1047596f, +0.0023461f,
  -0.2258562f, +0.3062133f, -0.2583999f, +0.1292441f, +0.1516641f, -0.1858399f, +0.6344252f, +0.6028228f,
  +0.1124174f, -0.2388533f, -0.1540593f, +0.3256661f, +0.3095708f, +0.1645854f, -0.1908506f, -0.0047716f,
  +0.3044641f, +0.0336762f, +0.1441651f, +0.4388158f, +0.0545178f, -0.1353343f, +0.0684924f, +0.1231104f,
  -0.6134953f, +0.5184503f, -0.1554117f, -0.6362434f, +0.1434892f, -0.4532852f, -0.0986280f, +0.4466585f,
  +0.2423536f, -0.0138490f, -0.3018036f, +0.7278628f, +0.5378352f, -0.4560544f, -0.2203753f, +0.5369205f,
  +0.0259398f, +0.0778592f, +0.0088529f, -0.0317182f, -0.0609940f, +0.1463910f, +0.0079517f, +0.0218298f,
  -0.0379301f, +0.1344771f, +0.0576486f, -0.0530563f, -0.1168446f, -0.0347730f, -0.0263716f, -0.0330010f,
  +0.0763170f, +0.0674862f, -0.0512251f, +0.0404248f, -0.0843494f, +0.0773830f, +0.0170674f, -0.1226876f,
  +0.2737889f, +0.0319148f, -0.0056067f, +0.1705554f, -0.0781346f, +0.0467840f, +0.1530546f, -0.0297208f,
  -0.1676953f, -0.3815183f, -0.1873132f, -0.2157561f, +0.0793177f, -0.1543354f, +0.0184641f, +0.2070713f,
  -0.0849462f, -0.1424792f, +0.0049550f, +0.1516737f, +0.0931736f, -0.0772782f, +0.0800324f, +0.3118543f,
  -0.0579731f, -0.0687424f, -0.3647510f, -0.0183904f, -0.0510431f, -0.0036361f, -0.3730555f, +0.0717289f,
  -0.2855574f, +0.0141769f, +0.0158956f, -0.8088478f, +0.4410206f, -0.4493865f, -0.5791184f, +0.1874979f,
  +0.2201812f, -0.4862957f, +0.2686913f, -0.1095029f, +0.3755389f, -0.0881586f, +0.5256717f, +0.2744102f,
  -0.0074333f, +0.0181334f, -0.0210786f, +0.1622474f, -0.0286535f, -0.1787341f, +0.0547163f, +0.0486383f,
  -0.0298956f, +0.0410135f, -0.2151200f, -0.0127420f, +0.0691860f, -0.3928452f, -0.5284889f, +0.0589013f,
  +0.2072904f, -0.1378978f, -0.0625514f, +0.5227408f, +0.0238297f, -0.1060436f, +0.1321247f, +0.3717295f,
  -0.3519753f, +0.0377395f, -0.2704955f, -0.0095786f, +0.2272209f, -0.0195083f, -0.1179857f, +0.1344253f,
  +0.4569987f, -0.6421696f, -0.0215013f, -0.0078852f, +0.0567087f, -0.2869359f, +0.1173778f, -0.0055352f,
  +0.0577013f, +0.1981143f, -0.0775687f, +0.2184659f, -0.0897037f, +0.1575711f, -0.3182722f, -0.1597237f,
  -0.0273208f, +0.0150330f, -0.3134185f, -0.1053690f, +0.0944395f, +0.0625164f, -0.3182374f, -0.0424404f,
  -0.4307038f, -0.3695823f, -0.1273431f, -0.5894299f, -0.0341570f, -0.3453459f, -0.0665821f, -0.1649077f,
  -0.3525733f, +0.4166895f, -0.4731905f, +0.2415634f, +0.1120130f, -0.0680660f, -0.0985864f, +0.1756172f,
  -0.1345518f, +0.0302309f, -0.0238744f, -0.0740332f, -0.1730133f, -0.0974976f, +0.1227269f, +0.1449540f,
  +0.1263760f, +0.0952139f, +0.2064234f, -0.1518342f, -0.3208733f, -0.0688132f, -0.0016456f, -0.0669213f,
  +0.3012110f, -0.2804809f, +0.2057956f, +0.0201985f, +0.1595766f, -0.1153025f, -0.2399077f, -0.2705070f,
  +0.0957739f, -0.3986430f, +0.0193166f, -0.1168597f, -0.0525473f, +0.0842397f, -0.0936341f, -0.0293712f,
  +0.5076823f, +0.1422031f, -0.2179601f, -0.5250986f, -0.0526523f, +0.2835185f, -0.1374691f, -0.0100961f,
  +0.7642166f, +0.4445719f, -0.5963830f, -0.3792098f, -0.5582646f, +0.3566700f, -0.2403787f, +0.3218001f,
  +0.0316673f, -0.0153742f, -0.1305749f, +0.0492739f, +0.2650776f, +0.2182881f, -0.0503806f, -0.0295282f,
  +0.1507625f, +0.2084782f, -0.2487983f, -0.6455086f, +1.0303389f, -0.4285976f, -0.5146219f, +0.6088957f,
  +0.2280962f, +0.1700919f, +0.5785877f, -0.4431508f, +0.2834487f, +0.2084616f, +0.5273525f, +0.6075864f,
  -0.0054424f, +0.4042175f, -0.1278815f, +0.0218179f, +0.0765503f, +0.2514301f, -0.0716716f, -0.1251481f,
  -0.1058282f, -0.0426467f, +0.0705052f, +0.3886646f, +0.0563049f, -0.1626235f, -0.3069479f, +0.1532052f,
  -0.1122691f, -0.0038235f, +0.2077957f, +0.7410091f, +0.0533223f, -0.2524046f, -0.5483589f, -0.0812490f
);

const float biases[4] = float[4](
  +0.1061331f, +0.1295549f, +0.0876814f, +0.0897696f
);

vec4 hook() {
    const vec4 r[9][2] = vec4[9][2](
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 1.0f)))
    );

    float sum[4] = biases;
    for (int n = 0; n < 4; n++) {
        for (int i = 0; i < 9; i++) {
            const vec4 k0 = vec4(kernels[n * 8 * 9 + 8 * i + 0], kernels[n * 8 * 9 + 8 * i + 1], kernels[n * 8 * 9 + 8 * i + 2], kernels[n * 8 * 9 + 8 * i + 3]);
            const vec4 k1 = vec4(kernels[n * 8 * 9 + 8 * i + 4], kernels[n * 8 * 9 + 8 * i + 5], kernels[n * 8 * 9 + 8 * i + 6], kernels[n * 8 * 9 + 8 * i + 7]);
            sum[n] += (dot(k0, r[i][0]) + dot(k1, r[i][1]));
        }
    }

    return ACTIVE(vec4(sum[0], sum[1], sum[2], sum[3]));
}

//!HOOK LUMA
//!DESC ARNet b8 Layer9 L1
//!WHEN OUTPUT.w LUMA.w / 1.2 > OUTPUT.h LUMA.h / 1.2 > *
//!BIND TMP2_L0
//!BIND TMP2_L1
//!SAVE TMP1_L1
//!COMPONENTS 4

#define ACTIVE(v) (max(v, v * 0.2000000f))

#define TEX_BIND_L0_TEXOFF TMP2_L0_texOff
#define TEX_BIND_L0_TEX TMP2_L0_tex
#define TEX_BIND_L0_POS TMP2_L0_pos
#define TEX_BIND_L0_SIZE TMP2_L0_size
#define TEX_BIND_L0_PT TMP2_L0_pt

#define TEX_BIND_L1_TEXOFF TMP2_L1_texOff
#define TEX_BIND_L1_TEX TMP2_L1_tex
#define TEX_BIND_L1_POS TMP2_L1_pos
#define TEX_BIND_L1_SIZE TMP2_L1_size
#define TEX_BIND_L1_PT TMP2_L1_pt

const float kernels[288] = float[288](
  -0.0759760f, -0.1492410f, +0.1445210f, -0.0779688f, +0.1437872f, -0.0737183f, +0.0417542f, +0.0518981f,
  +0.3299554f, -0.0908904f, -0.1695090f, -0.1091153f, -0.0380862f, +0.0678896f, -0.0778288f, -0.2089795f,
  -0.0614987f, +0.0734357f, +0.0527468f, +0.0903095f, +0.2228753f, -0.2472633f, +0.1598687f, -0.1082407f,
  -0.0107294f, -0.2357932f, -0.2024322f, +0.0042830f, -0.0603242f, -0.5046374f, +0.1509814f, +0.2843812f,
  +0.0306963f, -0.2607761f, -0.3186130f, +0.1853974f, -0.2510841f, -0.1669421f, +0.2017202f, -0.3974356f,
  +0.1110292f, -0.2836798f, +0.1345952f, +0.1685926f, +0.1013210f, +0.1194976f, +0.1806367f, -0.1220130f,
  -0.1294885f, +0.0468315f, -0.2468340f, -0.3461485f, +0.1685081f, -0.1493190f, -0.1849168f, +0.2517619f,
  -0.0798988f, -0.3279989f, +0.1032274f, -0.3517520f, -0.0111961f, +0.0570634f, +0.2229797f, -0.0982378f,
  -0.2349908f, -0.3501958f, +0.2998317f, +0.1930263f, -0.0382395f, -0.1977359f, -0.5345923f, -0.0557016f,
  -0.2196171f, -0.0433182f, -0.2749331f, +0.0311528f, +0.1328723f, +0.0636265f, -0.1594555f, -0.0405302f,
  -0.1432058f, -0.2567974f, -0.5272381f, -0.0474358f, -0.1677553f, -0.0490903f, -0.0997714f, -0.0128190f,
  +0.0604064f, -0.0552912f, -0.0593825f, +0.3635811f, +0.3918128f, -0.1608729f, -0.1886426f, -0.2832982f,
  -0.1481719f, +0.0642505f, -0.1149991f, +0.1351294f, +0.0545596f, -0.3993266f, +0.0334902f, +0.3799433f,
  -0.2860852f, +0.3364047f, -0.3989330f, +0.2349115f, -0.2729085f, +0.0359676f, -0.0334104f, +0.1414667f,
  +0.3813050f, +0.0529143f, -0.1531458f, +0.3038769f, +0.5802417f, -0.1462440f, -0.0602299f, +0.0175686f,
  +0.0215012f, +0.1927892f, -0.2341421f, +0.0784914f, -0.0020314f, +0.1230214f, -0.0119266f, -0.0883675f,
  -0.2370463f, +0.0705786f, -0.3706453f, +0.2052079f, +0.1296822f, -0.0360545f, -0.2161478f, +0.0392911f,
  +0.0510612f, -0.0890189f, -0.1840808f, +0.2719856f, +0.1301625f, -0.2296327f, -0.1601515f, +0.0209691f,
  +0.1454871f, +0.0849109f, +0.1247782f, -0.1176306f, -0.3028292f, +0.1863085f, -0.0383774f, -0.4203719f,
  -0.2489864f, +0.2685958f, -0.4434707f, +0.3705846f, -0.2886541f, -0.3786601f, -0.1715319f, +0.1019156f,
  +0.1085808f, +0.4815614f, -0.0171389f, -0.0897035f, -0.2248228f, +0.3380799f, -0.0631562f, -0.1016930f,
  +0.4710247f, +0.0078262f, +0.0021092f, -0.0991450f, -0.1786540f, +0.5686015f, -0.0864698f, -0.5028857f,
  +0.2644199f, +0.1841025f, -0.4193375f, +0.1874280f, -0.8304981f, -0.3755886f, -1.1446978f, -0.5226822f,
  +0.4140540f, +0.2390425f, -0.5354674f, +0.0023236f, -0.6920000f, +0.1802114f, +0.1502950f, +0.2830381f,
  +0.6153675f, -0.6330469f, +0.7059621f, +0.1960875f, -0.3106823f, +0.0111704f, -0.1099023f, -0.3138649f,
  +0.1814025f, -0.0059838f, +0.6648588f, +0.2392160f, -0.0862545f, +0.2566695f, +0.1934617f, +0.3205374f,
  -0.3842183f, +0.0420329f, +0.7875510f, +0.3153800f, +0.0695768f, -0.1886222f, -0.1690819f, +0.6600865f,
  +0.0183129f, +0.2445494f, -0.0257368f, +0.0072140f, -0.2385359f, +0.0890797f, +0.2855589f, +0.0019581f,
  -0.0259612f, -0.1887840f, +0.0613001f, +0.2873918f, +0.1204061f, -0.1278311f, +0.1345744f, +0.0194190f,
  -0.0564003f, +0.2428053f, -0.1551738f, -0.0140988f, -0.0547380f, +0.1168881f, -0.1322158f, +0.1630038f,
  -0.5013993f, +0.1648196f, -0.2697087f, -0.1183084f, -0.0928567f, +0.0494004f, +0.1505850f, +0.3096298f,
  +0.1487390f, +0.0821550f, -0.3996919f, -0.2722139f, -0.2361754f, +0.3316005f, -0.0709023f, -0.0428612f,
  +0.1018333f, +0.1417764f, -0.1379801f, +0.0881447f, +0.0992405f, +0.1216586f, -0.1253714f, +0.1571174f,
  -0.4685573f, +0.1867055f, -0.2164927f, -0.2752952f, +0.1994658f, -0.0672639f, -0.0545101f, +0.2692021f,
  -0.3577471f, -0.1884755f, -0.5228154f, +0.1417705f, +0.1099179f, +0.0749396f, +0.4997885f, -0.2050002f,
  -0.1710226f, +0.0725268f, -0.1439786f, -0.0128493f, -0.2044621f, +0.0272531f, +0.1900819f, +0.0575350f
);

const float biases[4] = float[4](
  +0.0682601f, +0.1295744f, -0.1484029f, +0.0686874f
);

vec4 hook() {
    const vec4 r[9][2] = vec4[9][2](
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 1.0f)))
    );

    float sum[4] = biases;
    for (int n = 0; n < 4; n++) {
        for (int i = 0; i < 9; i++) {
            const vec4 k0 = vec4(kernels[n * 8 * 9 + 8 * i + 0], kernels[n * 8 * 9 + 8 * i + 1], kernels[n * 8 * 9 + 8 * i + 2], kernels[n * 8 * 9 + 8 * i + 3]);
            const vec4 k1 = vec4(kernels[n * 8 * 9 + 8 * i + 4], kernels[n * 8 * 9 + 8 * i + 5], kernels[n * 8 * 9 + 8 * i + 6], kernels[n * 8 * 9 + 8 * i + 7]);
            sum[n] += (dot(k0, r[i][0]) + dot(k1, r[i][1]));
        }
    }

    return ACTIVE(vec4(sum[0], sum[1], sum[2], sum[3]));
}

//!HOOK LUMA
//!DESC ARNet b8 Layer10 L0
//!WHEN OUTPUT.w LUMA.w / 1.2 > OUTPUT.h LUMA.h / 1.2 > *
//!BIND TMP1_L0
//!BIND TMP1_L1
//!BIND TMP2_L0
//!SAVE TMP2_L0
//!COMPONENTS 4

#define ACTIVE(v) (v)

#define TEX_BIND_L0_TEXOFF TMP1_L0_texOff
#define TEX_BIND_L0_TEX TMP1_L0_tex
#define TEX_BIND_L0_POS TMP1_L0_pos
#define TEX_BIND_L0_SIZE TMP1_L0_size
#define TEX_BIND_L0_PT TMP1_L0_pt

#define TEX_BIND_L1_TEXOFF TMP1_L1_texOff
#define TEX_BIND_L1_TEX TMP1_L1_tex
#define TEX_BIND_L1_POS TMP1_L1_pos
#define TEX_BIND_L1_SIZE TMP1_L1_size
#define TEX_BIND_L1_PT TMP1_L1_pt

#define TEX_BIND_L2_TEXOFF TMP2_L0_texOff
#define TEX_BIND_L2_TEX TMP2_L0_tex
#define TEX_BIND_L2_POS TMP2_L0_pos
#define TEX_BIND_L2_SIZE TMP2_L0_size
#define TEX_BIND_L2_PT TMP2_L0_pt

const float kernels[288] = float[288](
  -0.1501101f, -0.2264618f, +0.1656386f, +0.1809969f, -0.0174042f, -0.3055457f, -0.2058027f, +0.1400617f,
  +0.0731899f, -0.1703710f, +0.1299403f, -0.0824378f, -0.0269964f, +0.0451142f, -0.2410785f, +0.4794082f,
  -0.0569260f, +0.0914452f, +0.1220580f, -0.0485634f, +0.0035839f, -0.1010356f, -0.1162246f, -0.0251356f,
  -0.0507820f, +0.0267408f, +0.2240991f, -0.1638890f, +0.0599668f, -0.0675655f, -0.0067780f, -0.3816454f,
  -0.1476601f, +0.2235519f, +0.2601918f, -0.2698646f, +0.0854019f, +0.0842025f, -0.3617816f, +0.0617375f,
  -0.3029248f, -0.0527481f, -0.1157540f, -0.2351095f, -0.4096547f, +0.3804311f, -0.2440287f, +0.0479988f,
  +0.1755990f, +0.0695051f, -0.0626291f, -0.0601287f, -0.2076109f, -0.0477372f, +0.1063199f, +0.0385067f,
  -0.3216814f, +0.3477526f, -0.0806998f, -0.3919282f, -0.3448400f, -0.2436735f, -0.0138155f, +0.2554534f,
  -0.2361992f, -0.0864108f, +0.0534442f, +0.0791624f, -0.3274032f, +0.1207929f, +0.2259308f, -0.0278508f,
  +0.0672050f, -0.2344918f, +0.0617177f, +0.1234873f, -0.0939049f, +0.1552280f, +0.0191374f, -0.0004912f,
  +0.1232556f, -0.0783895f, -0.1838863f, -0.4390424f, -0.0542625f, +0.0729545f, +0.1490134f, -0.1108397f,
  +0.0017926f, -0.2107238f, -0.0841191f, +0.1712224f, -0.0543454f, -0.0409330f, +0.3707741f, -0.1753130f,
  +0.0185918f, -0.0702060f, +0.0693318f, +0.1764211f, +0.3289606f, -0.0820040f, +0.1103392f, +0.2407640f,
  -0.4420519f, +0.2354741f, +0.1920868f, +0.2826566f, +0.2686747f, -0.4871570f, +0.2586980f, +0.0485551f,
  +0.0548823f, +0.1680161f, +0.0703812f, +0.2382296f, +0.1622655f, +0.1928929f, +0.5360508f, -0.0605852f,
  +0.1364476f, -0.0435599f, -0.1748516f, +0.1249086f, -0.2305084f, -0.2570342f, -0.1801796f, -0.0880611f,
  -0.1531015f, +0.2558740f, +0.3530374f, +0.1721599f, -0.1893442f, -0.1364877f, -0.0284995f, +0.3162748f,
  -0.1841276f, +0.0760558f, +0.0628286f, -0.0081540f, -0.0579915f, +0.1239156f, +0.1699085f, +0.0138236f,
  -0.0696932f, +0.2451616f, -0.2112991f, +0.1730206f, -0.0849206f, +0.0162971f, -0.0326751f, -0.0469647f,
  -0.2527591f, +0.1894758f, -0.6368728f, +0.2627894f, -0.1203975f, +0.3744663f, -0.1732330f, +0.6416013f,
  -0.0629508f, -0.0872653f, -0.0873652f, -0.0249622f, -0.1089404f, +0.0732162f, -0.4113353f, -0.1403058f,
  -0.3175394f, -0.4323678f, +0.3569775f, +0.0751165f, -0.0323996f, +0.0024282f, +0.3978220f, +0.0812091f,
  -0.0735000f, -0.0600705f, -0.1192104f, -0.0866660f, +0.0563671f, -0.1371693f, +0.1138322f, +0.4363284f,
  -0.0244370f, +0.2680282f, +0.1686954f, +0.1286969f, +0.0775512f, -0.1805323f, -0.4553220f, +0.0707984f,
  -0.3350642f, -0.3940651f, +0.1995947f, +0.4463035f, -0.1241102f, -0.0065600f, -0.0546735f, +0.2422103f,
  -0.3883037f, +0.0649098f, -0.0982771f, +0.3537153f, -0.2013451f, +0.2716228f, +0.2762870f, -0.0599459f,
  -0.0379391f, -0.0151832f, -0.0419728f, +0.0407234f, -0.1268471f, +0.3725873f, -0.0590862f, -0.0685055f,
  +0.2367799f, -0.0717699f, -0.1112953f, -0.6165187f, -0.1642768f, -0.0114200f, +0.5211574f, +0.0216395f,
  +0.1378578f, -0.2622731f, +0.3291279f, +0.2497582f, +0.3467667f, -0.3450147f, +0.1073258f, -0.3481904f,
  +0.1766641f, -0.2424435f, -0.2038423f, +0.1904152f, +0.3278554f, -0.0526104f, +0.1344295f, +0.2698621f,
  -0.4055768f, -0.2449785f, +0.1881571f, +0.4879323f, -0.0673683f, -0.0536573f, -0.3366000f, +0.1614243f,
  +0.1952217f, +0.0985347f, -0.1630305f, +0.3269944f, -0.0016964f, -0.2189662f, -0.1008596f, +0.4015491f,
  +0.0782701f, -0.1716148f, -0.2407625f, +0.1246948f, +0.0657233f, +0.1635558f, +0.0894017f, -0.0637557f,
  -0.1641192f, +0.1092597f, -0.2667312f, -0.1134014f, +0.0317188f, -0.1650067f, -0.2365679f, -0.0406641f,
  -0.3220689f, -0.1156552f, +0.4393016f, +0.4668742f, +0.0465439f, +0.2071907f, -0.3308601f, -0.0256479f,
  +0.0401386f, +0.0127449f, -0.1279408f, +0.2587619f, +0.0773016f, +0.0667221f, -0.1075531f, -0.0724213f
);

const float biases[4] = float[4](
  -0.0292321f, -0.1223582f, -0.0300267f, -0.1229843f
);

vec4 hook() {
    const vec4 r[9][2] = vec4[9][2](
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 1.0f)))
    );

    float sum[4] = biases;
    for (int n = 0; n < 4; n++) {
        for (int i = 0; i < 9; i++) {
            const vec4 k0 = vec4(kernels[n * 8 * 9 + 8 * i + 0], kernels[n * 8 * 9 + 8 * i + 1], kernels[n * 8 * 9 + 8 * i + 2], kernels[n * 8 * 9 + 8 * i + 3]);
            const vec4 k1 = vec4(kernels[n * 8 * 9 + 8 * i + 4], kernels[n * 8 * 9 + 8 * i + 5], kernels[n * 8 * 9 + 8 * i + 6], kernels[n * 8 * 9 + 8 * i + 7]);
            sum[n] += (dot(k0, r[i][0]) + dot(k1, r[i][1]));
        }
    }

    return ACTIVE(vec4(sum[0], sum[1], sum[2], sum[3]) * 0.2000000f + TEX_BIND_L2_TEXOFF(vec2(0.0f, 0.0f)));
}

//!HOOK LUMA
//!DESC ARNet b8 Layer10 L1
//!WHEN OUTPUT.w LUMA.w / 1.2 > OUTPUT.h LUMA.h / 1.2 > *
//!BIND TMP1_L0
//!BIND TMP1_L1
//!BIND TMP2_L1
//!SAVE TMP2_L1
//!COMPONENTS 4

#define ACTIVE(v) (v)

#define TEX_BIND_L0_TEXOFF TMP1_L0_texOff
#define TEX_BIND_L0_TEX TMP1_L0_tex
#define TEX_BIND_L0_POS TMP1_L0_pos
#define TEX_BIND_L0_SIZE TMP1_L0_size
#define TEX_BIND_L0_PT TMP1_L0_pt

#define TEX_BIND_L1_TEXOFF TMP1_L1_texOff
#define TEX_BIND_L1_TEX TMP1_L1_tex
#define TEX_BIND_L1_POS TMP1_L1_pos
#define TEX_BIND_L1_SIZE TMP1_L1_size
#define TEX_BIND_L1_PT TMP1_L1_pt

#define TEX_BIND_L2_TEXOFF TMP2_L1_texOff
#define TEX_BIND_L2_TEX TMP2_L1_tex
#define TEX_BIND_L2_POS TMP2_L1_pos
#define TEX_BIND_L2_SIZE TMP2_L1_size
#define TEX_BIND_L2_PT TMP2_L1_pt

const float kernels[288] = float[288](
  -0.0216872f, -0.2986867f, +0.0462694f, +0.1094014f, -0.1867734f, +0.2099182f, +0.1709260f, +0.1893790f,
  +0.1207105f, +0.2199030f, +0.0476536f, -0.4487312f, +0.2679249f, +0.0299921f, +0.4923305f, +0.0873183f,
  +0.0730091f, +0.0358779f, -0.2219346f, -0.2484070f, +0.1853314f, +0.0552708f, +0.3100514f, +0.0618051f,
  -0.0921352f, -0.0790659f, -0.1488762f, -0.0694584f, -0.4254391f, +0.0130341f, +0.0249543f, -0.0776047f,
  +0.2334433f, -0.0660005f, -0.3887143f, -0.1276823f, +0.5841577f, -0.0092083f, -0.1115682f, +0.4324462f,
  +0.0895340f, -0.0453814f, +0.1296653f, +0.2000508f, +0.3094447f, -0.2580153f, -0.4479429f, +0.2047109f,
  -0.4782281f, -0.1455085f, +0.3411105f, +0.1493900f, -0.2820086f, +0.0537485f, -0.1055784f, +0.2011926f,
  -0.6093017f, +0.0210581f, -0.1518007f, -0.0161909f, +0.1716507f, -0.0769107f, -0.1877494f, +0.0917071f,
  -0.0160142f, +0.1013383f, -0.2682083f, -0.0994937f, -0.2351614f, +0.2067562f, -0.0838244f, -0.0413272f,
  +0.1775650f, -0.1510565f, +0.0296064f, -0.0129959f, +0.1046144f, +0.1179180f, +0.1313844f, +0.0995349f,
  -0.0077402f, -0.0473212f, -0.2769013f, +0.4706693f, -0.2199712f, -0.0788818f, -0.3666115f, -0.2341772f,
  -0.0255620f, -0.2799997f, -0.3286441f, -0.0523772f, +0.0136879f, +0.0186109f, -0.1561721f, +0.1544038f,
  -0.4980514f, -0.3489359f, +0.2917287f, +1.2211367f, -0.3088068f, -0.0225384f, -0.3751496f, +0.0862140f,
  +0.1371732f, +0.3541958f, +0.1663361f, +0.2706724f, -0.0703602f, -0.1401266f, -0.3023987f, +0.0528957f,
  +0.1338331f, +0.3898040f, +0.1980831f, +0.3328054f, +0.4021705f, -0.3223304f, -0.4821190f, +0.1086472f,
  -0.5480354f, -0.1403729f, +0.0226664f, -0.2090833f, -0.0676597f, +0.4772981f, +0.2126784f, -0.0006334f,
  -0.1815651f, +0.1470482f, +0.3463116f, -0.5654447f, -0.1158912f, -0.1069895f, +0.3782750f, -0.0024202f,
  -0.0805938f, +0.1048872f, +0.1528541f, -0.0777422f, -0.2272132f, +0.2694317f, +0.1205755f, +0.1952392f,
  +0.0170270f, +0.0667686f, +0.1682592f, +0.1363717f, +0.1577701f, -0.1888591f, -0.3840763f, -0.0886621f,
  -0.0604165f, +0.1997043f, +0.1453023f, +0.1028591f, -0.1435499f, -0.0730437f, -0.3853007f, -0.5262145f,
  -0.0671581f, +0.0251347f, -0.1193646f, +0.1348118f, -0.0798927f, +0.1670990f, -0.2027708f, -0.0470206f,
  +0.5976785f, -0.2995235f, -0.1182557f, -0.0301897f, -0.1840570f, -0.1749523f, -0.1915632f, +0.1273409f,
  +0.3384770f, +0.3208334f, +0.0556389f, -0.0986972f, -0.4040484f, +0.2633233f, -0.3673455f, -0.1473252f,
  -0.2761832f, +0.1255523f, +0.1398050f, +0.0350563f, -0.0899338f, -0.0142878f, -0.3618208f, +0.0275160f,
  -0.3096676f, -0.1563664f, +0.0255489f, +0.0114602f, -0.1491552f, +0.0038609f, -0.1771042f, -0.1584874f,
  -0.8823665f, -0.1454417f, +0.4579113f, +0.4876838f, -0.1472013f, +0.4918955f, +0.0392046f, -0.1631980f,
  -0.0966437f, -0.0643577f, +0.0187387f, +0.0625810f, -0.0958745f, +0.2197515f, -0.1114866f, +0.1665705f,
  +0.0186400f, -0.2609288f, +0.1324581f, -0.2296158f, +0.3767560f, -0.0452003f, +0.2291967f, +0.0649691f,
  +0.1756170f, -0.0798595f, +0.0866035f, -0.0652322f, +0.0060107f, +0.1271400f, +0.3119954f, -0.0158793f,
  +0.0699596f, -0.0038511f, -0.0808668f, -0.1420714f, +0.1139951f, +0.1412862f, +0.5205225f, -0.1642504f,
  -0.3090618f, -0.3988478f, -0.0001972f, +0.6514713f, +0.2922301f, +0.3678475f, -0.1803461f, -0.3244282f,
  -0.3761926f, +0.0312961f, +0.3930073f, -0.0911174f, +0.1112683f, -0.1489815f, +0.1790834f, -0.3684376f,
  -0.3535650f, +0.1144413f, +0.1735041f, -0.2403459f, -0.1826062f, -0.2356752f, +0.5549499f, +0.3352190f,
  -0.4882211f, -0.0089730f, +0.1798572f, -0.4191378f, +0.1847348f, +0.4316283f, +0.4403261f, +0.1529621f,
  -0.1260306f, +0.0629806f, -0.0444193f, -0.6165249f, -0.1696322f, +0.2518612f, -0.1735248f, -0.2380565f,
  +0.1362507f, -0.1194288f, +0.1466678f, +0.0920730f, +0.0449433f, +0.1527199f, +0.1319495f, -0.1778562f
);

const float biases[4] = float[4](
  +0.0144947f, -0.0269945f, +0.0160119f, +0.1226957f
);

vec4 hook() {
    const vec4 r[9][2] = vec4[9][2](
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 1.0f)))
    );

    float sum[4] = biases;
    for (int n = 0; n < 4; n++) {
        for (int i = 0; i < 9; i++) {
            const vec4 k0 = vec4(kernels[n * 8 * 9 + 8 * i + 0], kernels[n * 8 * 9 + 8 * i + 1], kernels[n * 8 * 9 + 8 * i + 2], kernels[n * 8 * 9 + 8 * i + 3]);
            const vec4 k1 = vec4(kernels[n * 8 * 9 + 8 * i + 4], kernels[n * 8 * 9 + 8 * i + 5], kernels[n * 8 * 9 + 8 * i + 6], kernels[n * 8 * 9 + 8 * i + 7]);
            sum[n] += (dot(k0, r[i][0]) + dot(k1, r[i][1]));
        }
    }

    return ACTIVE(vec4(sum[0], sum[1], sum[2], sum[3]) * 0.2000000f + TEX_BIND_L2_TEXOFF(vec2(0.0f, 0.0f)));
}

//!HOOK LUMA
//!DESC ARNet b8 Layer11 L0
//!WHEN OUTPUT.w LUMA.w / 1.2 > OUTPUT.h LUMA.h / 1.2 > *
//!BIND TMP2_L0
//!BIND TMP2_L1
//!SAVE TMP1_L0
//!COMPONENTS 4

#define ACTIVE(v) (max(v, v * 0.2000000f))

#define TEX_BIND_L0_TEXOFF TMP2_L0_texOff
#define TEX_BIND_L0_TEX TMP2_L0_tex
#define TEX_BIND_L0_POS TMP2_L0_pos
#define TEX_BIND_L0_SIZE TMP2_L0_size
#define TEX_BIND_L0_PT TMP2_L0_pt

#define TEX_BIND_L1_TEXOFF TMP2_L1_texOff
#define TEX_BIND_L1_TEX TMP2_L1_tex
#define TEX_BIND_L1_POS TMP2_L1_pos
#define TEX_BIND_L1_SIZE TMP2_L1_size
#define TEX_BIND_L1_PT TMP2_L1_pt

const float kernels[288] = float[288](
  +0.3613853f, +0.0647468f, -0.0470898f, +0.4867231f, -0.0581613f, +0.2454870f, -0.4513976f, +0.0452577f,
  +0.8330168f, +1.1028790f, -0.0993893f, +0.2458025f, -0.1898367f, -0.6207407f, -0.1838630f, -0.5921722f,
  +0.3400896f, +0.3352927f, -0.3660514f, -0.0851754f, +0.0805536f, -0.3654842f, +0.0829751f, -0.6639582f,
  +0.0571985f, -0.0644283f, +0.1347664f, +0.0014365f, -0.2139402f, +0.6427572f, +0.2511550f, -0.7357932f,
  -0.0225415f, -0.6665002f, +1.0274268f, -0.2999492f, -0.5324984f, +0.4257946f, +0.2077473f, -0.5359625f,
  -0.0240576f, -0.3676401f, -0.6345511f, -0.3494079f, +0.2736635f, +0.2056665f, -0.7247792f, -0.6224996f,
  +0.5949033f, +0.0506048f, +0.7097359f, +0.0431426f, +0.1434143f, +0.2342524f, +0.4221523f, -0.3436897f,
  +0.4855737f, -0.0368261f, +1.0991005f, +0.1091198f, +0.0445441f, +0.0792564f, +0.0547622f, -0.2469114f,
  +0.3524117f, +0.3206617f, -0.6234748f, +0.3102276f, -0.0377564f, +0.3977820f, +0.3050453f, +0.3696829f,
  +0.1169305f, +0.0214230f, +0.4667312f, +0.3599183f, -0.1972486f, -0.0305672f, +0.2825440f, -0.0652240f,
  +0.2894364f, +0.2845916f, -0.0925994f, +0.2713543f, +0.3245099f, -0.0035035f, +0.0447357f, +0.4329958f,
  +0.0524161f, +0.1114145f, +0.0428315f, +0.2325107f, -0.1020920f, -0.2155977f, +0.0134594f, +0.1918230f,
  -0.0977742f, -0.1904745f, -0.4897573f, +0.1327931f, -0.0769951f, -0.1377899f, -0.0098529f, -0.0647066f,
  +0.1922031f, -0.3852941f, +0.1649409f, -0.2954378f, +0.6864099f, +0.6796964f, -0.0140742f, -0.6368966f,
  -0.4186358f, -0.2619271f, +0.0941132f, -0.0692522f, -0.1864566f, +0.0897552f, -0.1872034f, +0.3115214f,
  +0.0324798f, -0.0593836f, +0.1432902f, -0.1905390f, -0.1503837f, -0.3499423f, +0.1728123f, +0.3771525f,
  +0.2706866f, +0.4928848f, +0.2517572f, +0.2140339f, +0.1695409f, +0.1427198f, +0.0945730f, -0.0786954f,
  +0.2138336f, -0.2062896f, -0.1583364f, +0.5481409f, +0.1605800f, +0.5335345f, -0.6360853f, +0.3321034f,
  -0.3197313f, -0.0606910f, +0.7487901f, +0.1321028f, -0.0102600f, +0.5580961f, +0.2070155f, -0.4179014f,
  -0.6643180f, -0.0204210f, +0.0326347f, +0.2982853f, +0.3654698f, +0.9924904f, +0.2516704f, +0.3235326f,
  -0.3310645f, -0.0540711f, +0.3947176f, +0.4355458f, +0.1395178f, +0.3708897f, +0.1100913f, +0.2047069f,
  +0.3713660f, +0.0356448f, +0.0782822f, +0.1927007f, -0.4971393f, +0.2293127f, +0.2536950f, -0.2667359f,
  +0.7870677f, +0.3968947f, -0.3432708f, +0.6628931f, +0.3802462f, -0.0670382f, -0.0852415f, +0.0642648f,
  +0.2352960f, +0.0781584f, -0.3220641f, -0.0364137f, +0.0948112f, +0.4044861f, -0.0901089f, +0.2028172f,
  +0.0021009f, -0.1217100f, +0.0963838f, -0.2496945f, -0.2054338f, -0.1066017f, -0.1724288f, -0.0602942f,
  -0.0128698f, -0.0379271f, +0.3651571f, -0.3085182f, -0.3541368f, -0.1201685f, -0.0682361f, -0.0925048f,
  +0.0914350f, +0.0711974f, -0.0853243f, -0.1304574f, +0.0344262f, -0.1861853f, +0.0207267f, +0.1152515f,
  -0.0123723f, -0.0616330f, +0.0411746f, -0.2401883f, +0.2663944f, -0.0255964f, +0.0874415f, +0.0435137f,
  -0.2821163f, -0.3259183f, -0.4272936f, -0.2859448f, -0.2603794f, -0.2032104f, -0.1801586f, +0.1431590f,
  -0.1452149f, -0.0329666f, +0.1530910f, +0.0533402f, +0.1392270f, -0.2118667f, +0.0662667f, -0.1318848f,
  -0.2553578f, -0.0008304f, -0.2128096f, -0.3707379f, +0.5937360f, -0.1007956f, -0.2290609f, +0.2050395f,
  -0.3964841f, -0.2181209f, -0.0014171f, -0.1638113f, +0.3763161f, -0.0880968f, -0.2918910f, -0.0021990f,
  -0.0126953f, -0.3208114f, -0.1184315f, -0.5227265f, +0.1688545f, +0.0693768f, +0.2631526f, +0.2973665f,
  +0.2982928f, +0.0857322f, -0.0060087f, -0.0018525f, +0.0782818f, +0.1974819f, +0.0071458f, -0.0756764f,
  +0.1734679f, -0.3178881f, +0.2858438f, +0.0884980f, +0.1874730f, -0.0482736f, +0.0534873f, -0.4988698f,
  +0.0167361f, -0.0117191f, +0.1581515f, +0.0293151f, -0.1008385f, +0.1079602f, +0.0195222f, -0.0615136f
);

const float biases[4] = float[4](
  -0.2337766f, -0.0310992f, -0.0261537f, +0.0545673f
);

vec4 hook() {
    const vec4 r[9][2] = vec4[9][2](
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 1.0f)))
    );

    float sum[4] = biases;
    for (int n = 0; n < 4; n++) {
        for (int i = 0; i < 9; i++) {
            const vec4 k0 = vec4(kernels[n * 8 * 9 + 8 * i + 0], kernels[n * 8 * 9 + 8 * i + 1], kernels[n * 8 * 9 + 8 * i + 2], kernels[n * 8 * 9 + 8 * i + 3]);
            const vec4 k1 = vec4(kernels[n * 8 * 9 + 8 * i + 4], kernels[n * 8 * 9 + 8 * i + 5], kernels[n * 8 * 9 + 8 * i + 6], kernels[n * 8 * 9 + 8 * i + 7]);
            sum[n] += (dot(k0, r[i][0]) + dot(k1, r[i][1]));
        }
    }

    return ACTIVE(vec4(sum[0], sum[1], sum[2], sum[3]));
}

//!HOOK LUMA
//!DESC ARNet b8 Layer11 L1
//!WHEN OUTPUT.w LUMA.w / 1.2 > OUTPUT.h LUMA.h / 1.2 > *
//!BIND TMP2_L0
//!BIND TMP2_L1
//!SAVE TMP1_L1
//!COMPONENTS 4

#define ACTIVE(v) (max(v, v * 0.2000000f))

#define TEX_BIND_L0_TEXOFF TMP2_L0_texOff
#define TEX_BIND_L0_TEX TMP2_L0_tex
#define TEX_BIND_L0_POS TMP2_L0_pos
#define TEX_BIND_L0_SIZE TMP2_L0_size
#define TEX_BIND_L0_PT TMP2_L0_pt

#define TEX_BIND_L1_TEXOFF TMP2_L1_texOff
#define TEX_BIND_L1_TEX TMP2_L1_tex
#define TEX_BIND_L1_POS TMP2_L1_pos
#define TEX_BIND_L1_SIZE TMP2_L1_size
#define TEX_BIND_L1_PT TMP2_L1_pt

const float kernels[288] = float[288](
  -0.2388466f, +0.0153617f, +0.1138495f, +0.1997500f, -0.0877795f, +0.2718335f, +0.1858594f, -0.1593424f,
  -0.4841357f, -0.4412329f, +0.1913500f, +0.3252335f, +0.0909092f, -0.2319038f, +0.2474774f, +0.3833912f,
  -0.1749642f, -0.0459699f, -0.0830548f, -0.0242557f, +0.0783516f, +0.0243058f, -0.0207657f, +0.0457278f,
  -0.0205117f, +0.4019574f, +0.1059370f, +0.5878130f, -0.3392062f, -0.1644657f, +0.1269279f, +0.2447570f,
  -0.1568568f, -0.2071997f, +0.3594201f, +0.1749216f, -0.2245326f, -0.0425082f, -0.7699546f, -0.1977078f,
  -0.0990454f, +0.1009352f, -0.0849119f, -0.0935493f, -0.0691446f, +0.2513159f, +0.1888869f, +0.0408995f,
  -0.1094838f, -0.3209866f, +0.2348627f, -0.0330370f, -0.1541722f, -0.0704988f, -0.1401225f, -0.2631347f,
  -0.1128760f, -0.5687261f, +0.3338338f, -0.0916774f, +0.0764627f, -0.2135314f, -0.4554792f, -0.0223629f,
  -0.0725199f, +0.0655417f, -0.2400035f, +0.0925375f, +0.1319615f, -0.0064266f, -0.0686853f, +0.0587019f,
  -0.3444879f, -0.1625916f, -0.3794747f, -0.3520156f, +0.0118002f, +0.1214709f, -0.1630057f, -0.0822378f,
  -0.5817435f, -0.1347594f, +0.1374547f, +0.1795155f, -0.1466528f, +0.0293665f, -0.0178608f, -0.1250473f,
  +0.0223821f, -0.1744628f, -0.1113280f, -0.0806426f, +0.0885091f, +0.1771636f, -0.1641246f, +0.1251588f,
  -0.2929894f, +0.3490797f, -0.4226565f, -0.2648137f, +0.0809153f, -0.2863040f, +0.2155041f, +0.2107935f,
  -0.2873167f, -0.6732174f, +0.0664186f, -0.0863327f, -0.1527414f, -0.0443067f, -0.1754452f, +0.1947017f,
  -0.2836767f, +0.3608063f, +0.1175266f, +0.0658197f, -0.2654639f, -0.2192138f, +0.0315654f, -0.2936888f,
  -0.3861812f, +0.3272336f, +0.0106531f, -0.1509594f, -0.0817598f, -0.1825816f, +0.1226165f, +0.1636451f,
  -0.2552942f, +0.0100666f, -0.0889551f, +0.1588800f, -0.2916995f, +0.0887056f, -0.0764965f, +0.1487208f,
  +0.0742725f, +0.0813093f, -0.2118086f, -0.1201544f, +0.0936540f, -0.0368498f, +0.0792160f, +0.0723034f,
  +0.1033688f, -0.0761447f, -0.0724283f, +0.1291684f, +0.0442359f, -0.3745977f, +0.1744958f, +0.1131044f,
  +0.2339532f, -0.0327290f, +0.5088538f, +0.4489183f, -0.1251038f, -0.6678240f, +0.5145891f, +0.1570242f,
  -0.0802026f, +0.0524129f, -0.0975318f, -0.1302245f, +0.1770481f, -0.1611269f, +0.1146989f, -0.0732964f,
  -0.1117763f, +0.0113327f, -0.1419424f, +0.0140452f, -0.2194873f, +0.0379347f, -0.1670349f, +0.1009139f,
  +0.1165620f, +0.0429329f, +0.0496183f, +0.0939504f, -0.2757300f, +0.5885549f, -0.4048631f, -0.0911969f,
  -0.1651279f, -0.2157322f, -0.0846266f, +0.2903777f, -0.2328996f, -0.0145109f, +0.0941330f, -0.1680950f,
  +0.0091092f, +0.0840595f, -0.1004740f, +0.1386558f, +0.0836583f, -0.1225709f, -0.0872859f, +0.3034232f,
  +0.0117922f, -0.2935885f, -0.0114338f, -0.2443348f, +0.2508771f, -0.2494510f, -0.2331168f, +0.2393738f,
  -0.2721875f, -0.1002334f, +0.2590820f, +0.4074335f, -0.0207040f, +0.0362313f, -0.1656841f, +0.2612148f,
  -0.0663599f, -0.0391139f, +0.2214348f, +0.3288702f, -0.0518630f, -0.3485763f, +0.1280520f, +0.3033511f,
  +0.3983942f, +0.0817148f, +0.1205519f, +0.1854554f, -0.0746224f, +0.2833304f, -0.0160840f, -0.1080777f,
  +0.1593854f, +0.2194458f, +0.2026314f, +0.2438906f, -0.0972961f, -0.0656848f, +0.0450915f, +0.1340995f,
  -0.1027834f, -0.5668681f, -0.1384424f, +0.0329788f, -0.5213732f, -0.5153777f, -0.4489070f, +0.1843291f,
  +0.8283944f, +0.2578373f, +0.3218748f, +0.8018731f, +0.8256407f, +0.3317065f, +0.4093166f, +0.2708146f,
  -0.5733778f, -0.3393570f, +0.0904644f, +0.1028922f, -0.0103639f, +0.2143712f, -0.0382754f, +0.1525749f,
  +0.0227389f, -0.2405270f, -0.0425843f, -0.1081315f, -0.0771185f, -0.0946251f, -0.1601245f, +0.1771763f,
  +0.3321139f, +0.2181430f, +0.0290403f, +0.0118513f, +0.2316282f, -0.1085896f, -0.1416102f, +0.4016988f,
  +0.0293134f, -0.4142580f, +0.3251628f, +0.1346800f, +0.4201715f, +0.0359041f, -0.6495021f, +0.2006169f
);

const float biases[4] = float[4](
  +0.0495337f, +0.0135060f, +0.1437060f, -0.0218302f
);

vec4 hook() {
    const vec4 r[9][2] = vec4[9][2](
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 1.0f)))
    );

    float sum[4] = biases;
    for (int n = 0; n < 4; n++) {
        for (int i = 0; i < 9; i++) {
            const vec4 k0 = vec4(kernels[n * 8 * 9 + 8 * i + 0], kernels[n * 8 * 9 + 8 * i + 1], kernels[n * 8 * 9 + 8 * i + 2], kernels[n * 8 * 9 + 8 * i + 3]);
            const vec4 k1 = vec4(kernels[n * 8 * 9 + 8 * i + 4], kernels[n * 8 * 9 + 8 * i + 5], kernels[n * 8 * 9 + 8 * i + 6], kernels[n * 8 * 9 + 8 * i + 7]);
            sum[n] += (dot(k0, r[i][0]) + dot(k1, r[i][1]));
        }
    }

    return ACTIVE(vec4(sum[0], sum[1], sum[2], sum[3]));
}

//!HOOK LUMA
//!DESC ARNet b8 Layer12 L0
//!WHEN OUTPUT.w LUMA.w / 1.2 > OUTPUT.h LUMA.h / 1.2 > *
//!BIND TMP1_L0
//!BIND TMP1_L1
//!BIND TMP2_L0
//!SAVE TMP2_L0
//!COMPONENTS 4

#define ACTIVE(v) (v)

#define TEX_BIND_L0_TEXOFF TMP1_L0_texOff
#define TEX_BIND_L0_TEX TMP1_L0_tex
#define TEX_BIND_L0_POS TMP1_L0_pos
#define TEX_BIND_L0_SIZE TMP1_L0_size
#define TEX_BIND_L0_PT TMP1_L0_pt

#define TEX_BIND_L1_TEXOFF TMP1_L1_texOff
#define TEX_BIND_L1_TEX TMP1_L1_tex
#define TEX_BIND_L1_POS TMP1_L1_pos
#define TEX_BIND_L1_SIZE TMP1_L1_size
#define TEX_BIND_L1_PT TMP1_L1_pt

#define TEX_BIND_L2_TEXOFF TMP2_L0_texOff
#define TEX_BIND_L2_TEX TMP2_L0_tex
#define TEX_BIND_L2_POS TMP2_L0_pos
#define TEX_BIND_L2_SIZE TMP2_L0_size
#define TEX_BIND_L2_PT TMP2_L0_pt

const float kernels[288] = float[288](
  -0.0964664f, -0.2166819f, +0.3301182f, +0.2204288f, -0.0804978f, -0.2540064f, +0.0615083f, +0.1506360f,
  -0.2944032f, -0.0681674f, -0.3366102f, +0.1385155f, -0.0050058f, -0.4640921f, -0.1218957f, -0.7651149f,
  +0.2254881f, +0.1043703f, +0.1360448f, -0.0566123f, +0.1805654f, -0.0407533f, +0.1348067f, +0.0187480f,
  +0.2624701f, +0.5470533f, -0.2618665f, +0.1104639f, +0.2879020f, +0.3185579f, +0.3120978f, -0.3508520f,
  +0.3845047f, -0.2024541f, +0.3198322f, -0.2758136f, +0.0205792f, +0.3928797f, +0.0897846f, -0.1075731f,
  +0.2051992f, +0.1526366f, +0.1548349f, +0.0893443f, +0.1207371f, -0.1644640f, -0.0099864f, +0.0239789f,
  -0.0027659f, +0.2973571f, +0.1123722f, -0.0163089f, +0.0640966f, +0.0364285f, -0.0628893f, +0.2635130f,
  -0.0053304f, +0.4321090f, +0.6409107f, +0.1889744f, +0.4782104f, +0.2562922f, -0.2486984f, -0.3705331f,
  -0.0583213f, +0.1006380f, +0.1777637f, -0.0321002f, +0.0731403f, +0.1990735f, -0.0450507f, -0.4816584f,
  -0.0277783f, +0.1457956f, -0.0150344f, +0.1649194f, +0.0062552f, +0.0554372f, +0.1302543f, -0.1507697f,
  +0.3577445f, +0.1736460f, -0.1537289f, -0.0323070f, +0.1670170f, -0.0523572f, -0.0154890f, +0.1817350f,
  +0.0047434f, +0.0065747f, -0.1790833f, -0.0725266f, +0.2820782f, -0.1090767f, -0.1441340f, +0.0106993f,
  +0.0708504f, +0.0317664f, -0.3003602f, +0.1092945f, +0.0345499f, -0.2020643f, +0.1059805f, -0.2994717f,
  +0.1650581f, -0.0298729f, +0.0469509f, +0.4463546f, +0.3275442f, +0.2972359f, -0.0832758f, +0.4859673f,
  -0.4578620f, +0.4048627f, +0.2009684f, -0.1371441f, -0.5111287f, -0.1143490f, +0.1106633f, +0.4489265f,
  -0.1173210f, +0.0627447f, +0.1481782f, -0.0687973f, +0.0009441f, -0.0732256f, +0.3247176f, -0.1920834f,
  -0.2465513f, -0.3202270f, -0.1306883f, +0.1727160f, +0.2666951f, +0.1297508f, +0.1883965f, +0.4767123f,
  +0.0869622f, +0.1360808f, -0.1482456f, +0.1263742f, -0.2146851f, +0.1281525f, +0.2457088f, +0.1977993f,
  -0.1294152f, +0.1442592f, +0.0794204f, -0.0214282f, +0.0481304f, +0.0436705f, +0.1239648f, +0.0300599f,
  -0.4521518f, -0.0148800f, -0.0482375f, -0.0614973f, -0.0618705f, +0.2130508f, -0.2085133f, +0.4332792f,
  +0.0425159f, +0.0915714f, +0.0751209f, +0.0698668f, -0.3255148f, +0.1206347f, +0.1391910f, +0.3054596f,
  +0.4543708f, -0.0509545f, +0.4316774f, +0.1508294f, -0.1535000f, -0.0363657f, +0.0178087f, -0.4506555f,
  -0.1466362f, +0.7654756f, +0.3852826f, -0.1246819f, -0.0461901f, +0.4135314f, -0.0347305f, +0.1970308f,
  -0.3474267f, +0.2460629f, +0.2600741f, +0.1880614f, +0.0573415f, +0.3142759f, +0.1745083f, +0.2126736f,
  +0.5220573f, -0.1512634f, -0.6117042f, -0.4967043f, -0.0156498f, +0.0349654f, +0.3926297f, +0.0368986f,
  +0.0113954f, -0.4009150f, -0.3464207f, +0.2977829f, -0.1285360f, -0.0966699f, -0.4217331f, +1.2767593f,
  -0.0714253f, +0.3905191f, +0.3735174f, +0.1256723f, -0.7678816f, +0.4878101f, +0.3704224f, -0.0333788f,
  -0.4326245f, +0.0705823f, -0.6733035f, -0.3269388f, +0.0437594f, +0.2527163f, -0.2181007f, +0.2071008f,
  -0.7164880f, -0.4053110f, -0.0213687f, -0.4444425f, +0.0278452f, -0.1292493f, +0.1922610f, -0.8799552f,
  -0.0568294f, -0.0619555f, -0.1427355f, +0.2325805f, -0.1404555f, +0.1879630f, -0.0913704f, +0.2139161f,
  +0.4409796f, -0.5932534f, +0.3972010f, +0.3858118f, +0.0137434f, -0.5050097f, -0.2248150f, +0.6257352f,
  +0.5208113f, -1.1638167f, +0.4919360f, -0.0858688f, -0.3896339f, -0.4268724f, +0.2042106f, +0.2266689f,
  +0.0086899f, -0.0276350f, -0.0191175f, +0.1143086f, -0.7450960f, +0.4332581f, -0.0196184f, +0.0505722f,
  +0.0007824f, -0.2400509f, +0.2265535f, +0.1430640f, +0.1810399f, +0.1428165f, +0.0560433f, -0.3247225f,
  +0.0039643f, -0.1852113f, +0.0965423f, +0.2503969f, -0.4168113f, +0.2173309f, -0.0997051f, -0.2078740f,
  -0.2769405f, -0.0760399f, -0.3941449f, -0.0401593f, +0.0746231f, +0.0516150f, -0.2413553f, +0.3053350f
);

const float biases[4] = float[4](
  -0.0843775f, +0.0424607f, +0.0503250f, +0.0489652f
);

vec4 hook() {
    const vec4 r[9][2] = vec4[9][2](
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 1.0f)))
    );

    float sum[4] = biases;
    for (int n = 0; n < 4; n++) {
        for (int i = 0; i < 9; i++) {
            const vec4 k0 = vec4(kernels[n * 8 * 9 + 8 * i + 0], kernels[n * 8 * 9 + 8 * i + 1], kernels[n * 8 * 9 + 8 * i + 2], kernels[n * 8 * 9 + 8 * i + 3]);
            const vec4 k1 = vec4(kernels[n * 8 * 9 + 8 * i + 4], kernels[n * 8 * 9 + 8 * i + 5], kernels[n * 8 * 9 + 8 * i + 6], kernels[n * 8 * 9 + 8 * i + 7]);
            sum[n] += (dot(k0, r[i][0]) + dot(k1, r[i][1]));
        }
    }

    return ACTIVE(vec4(sum[0], sum[1], sum[2], sum[3]) * 0.2000000f + TEX_BIND_L2_TEXOFF(vec2(0.0f, 0.0f)));
}

//!HOOK LUMA
//!DESC ARNet b8 Layer12 L1
//!WHEN OUTPUT.w LUMA.w / 1.2 > OUTPUT.h LUMA.h / 1.2 > *
//!BIND TMP1_L0
//!BIND TMP1_L1
//!BIND TMP2_L1
//!SAVE TMP2_L1
//!COMPONENTS 4

#define ACTIVE(v) (v)

#define TEX_BIND_L0_TEXOFF TMP1_L0_texOff
#define TEX_BIND_L0_TEX TMP1_L0_tex
#define TEX_BIND_L0_POS TMP1_L0_pos
#define TEX_BIND_L0_SIZE TMP1_L0_size
#define TEX_BIND_L0_PT TMP1_L0_pt

#define TEX_BIND_L1_TEXOFF TMP1_L1_texOff
#define TEX_BIND_L1_TEX TMP1_L1_tex
#define TEX_BIND_L1_POS TMP1_L1_pos
#define TEX_BIND_L1_SIZE TMP1_L1_size
#define TEX_BIND_L1_PT TMP1_L1_pt

#define TEX_BIND_L2_TEXOFF TMP2_L1_texOff
#define TEX_BIND_L2_TEX TMP2_L1_tex
#define TEX_BIND_L2_POS TMP2_L1_pos
#define TEX_BIND_L2_SIZE TMP2_L1_size
#define TEX_BIND_L2_PT TMP2_L1_pt

const float kernels[288] = float[288](
  +0.2137340f, +0.1136280f, -0.1752216f, +0.0721336f, +0.0739040f, -0.0786984f, +0.2516343f, -0.1540855f,
  -0.3968437f, -0.1405198f, -0.3740462f, -0.3329006f, +0.3422932f, +0.3159488f, -0.0786469f, -0.2317539f,
  -0.0353715f, -0.2201660f, -0.4310533f, -0.1075064f, -0.0172889f, +0.2268090f, +0.0096934f, +0.0078968f,
  -0.1829794f, -0.3352101f, -0.4079467f, -0.2353509f, +0.0205586f, +0.1346123f, +0.2686949f, -0.1937035f,
  +0.2758659f, -0.6840670f, -0.1020094f, -0.0251067f, -0.0587357f, +0.3225938f, +0.5083711f, -0.6173535f,
  +0.6315175f, -0.1164953f, +0.1675281f, -0.4704441f, +0.0416556f, -0.4508602f, -0.0722810f, +0.4938565f,
  +0.0147043f, -0.0667333f, -0.2128018f, -0.2024061f, -0.0382461f, +0.0220450f, +0.1604778f, -0.1241783f,
  +0.2895822f, -0.1021258f, -0.6663288f, +0.1062964f, -0.0933935f, +0.1736146f, +0.0714651f, +0.2185586f,
  -0.3150653f, -0.1072989f, -0.1081511f, -0.2296179f, +0.0217951f, -0.0763955f, +0.1077418f, +0.2288467f,
  -0.0238019f, +0.2573565f, -0.3905841f, -0.2503998f, +0.1433724f, +0.0576326f, -0.0872688f, -0.5027733f,
  -0.3715126f, -0.4935136f, +0.2436540f, -0.1519285f, +0.2395046f, +0.2589027f, +0.1616020f, +0.1166488f,
  +0.2876281f, -0.0525360f, +0.1503768f, +0.0966959f, -0.4330340f, +0.1808542f, +0.1907402f, +0.2724925f,
  +0.2776296f, -0.2593241f, +0.4649516f, -0.0731519f, -0.1550535f, -0.0376233f, +0.0823009f, -0.2263201f,
  -0.0273177f, +0.1837058f, -0.4618711f, -0.1581411f, +0.3271334f, -0.0674201f, -0.6527091f, +0.1073104f,
  -0.6897523f, +0.3372037f, +0.2062711f, -0.0247228f, +0.1763729f, +0.3130059f, -0.1911784f, +0.1254608f,
  +0.3250862f, -0.0277981f, -0.1256702f, -0.3275874f, -0.1391635f, -0.0514125f, -0.1737954f, +0.0999243f,
  -0.2097783f, -0.2344239f, -0.0005856f, +0.1520840f, -0.0600320f, -0.2693269f, +0.3307275f, +0.4532439f,
  +0.1277804f, +0.1956864f, +0.1955048f, -0.0344700f, -0.3326638f, +0.1595950f, +0.0774105f, +0.0076271f,
  -0.2185298f, -0.1892028f, +0.3935951f, -0.0690365f, -0.0496133f, -0.3215198f, +0.1991274f, -0.2889163f,
  +0.3506568f, +0.2914820f, +0.4079674f, +0.0058639f, -0.2969554f, +0.2315080f, +0.2278560f, +0.4041164f,
  -0.1904824f, +0.1218977f, +0.1016760f, -0.0746011f, +0.0560959f, -0.1508887f, +0.0071226f, +0.0473289f,
  +0.0107861f, +0.1395576f, -0.1404928f, -0.3284693f, -0.2144024f, -0.1664057f, -0.1228165f, -0.0902472f,
  -0.0795239f, +0.2585595f, -0.6804316f, +0.1707940f, +0.2766909f, +0.0433234f, +0.0689970f, +1.3585569f,
  -0.3426786f, +0.2435449f, -0.1622418f, +0.3500254f, +0.0834032f, +0.2858244f, +0.0442266f, -0.6390126f,
  -0.0477306f, -0.0825155f, +0.1338001f, +0.0250524f, -0.0504285f, +0.2375281f, -0.0067814f, +0.0786672f,
  +0.0809387f, -0.0908008f, -0.4395148f, +0.0713996f, -0.5009006f, -0.3607326f, -0.5235990f, +0.2606193f,
  +0.2128013f, +0.0973900f, -0.2892037f, -0.2978661f, -0.2363039f, -0.0447290f, -0.0903528f, +0.0200219f,
  -0.4623253f, +0.2387534f, -0.3641752f, -0.1408582f, +0.1287800f, +0.0264919f, -0.3051551f, -0.5772151f,
  +0.0926751f, +0.2640320f, -0.3122790f, +0.0677194f, +0.2911286f, -0.0578668f, -0.0984050f, -0.0450184f,
  +0.0449348f, -0.0076443f, -0.2090679f, -0.3568399f, +0.5955597f, -0.2045793f, -0.1424063f, -0.2779963f,
  +0.7712591f, -0.3024632f, +0.6029971f, -0.0653607f, -0.0093686f, +0.2060958f, +0.2567826f, +0.3316194f,
  +0.7160578f, -0.1464383f, +0.2908400f, +0.2674336f, +0.6705787f, +0.0668450f, +0.1808343f, -0.7941647f,
  +0.4617214f, -0.2907446f, -0.2603057f, -0.1088644f, -0.0784014f, -0.1047613f, -0.2595536f, +0.0137078f,
  +0.5394032f, +0.0490098f, -0.5416192f, -0.3138090f, +0.0854540f, +0.0462056f, -0.1084866f, -0.0348468f,
  +0.2976160f, +0.2314136f, +0.5470576f, -0.2522905f, -0.4116155f, -0.0841470f, -0.0719717f, +0.2552008f,
  -0.1284570f, -0.0227964f, -0.1140065f, +0.1047802f, +0.1398073f, +0.2232959f, +0.1100009f, -0.0817575f
);

const float biases[4] = float[4](
  +0.1091364f, +0.0581783f, +0.1513538f, +0.2028713f
);

vec4 hook() {
    const vec4 r[9][2] = vec4[9][2](
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 1.0f)))
    );

    float sum[4] = biases;
    for (int n = 0; n < 4; n++) {
        for (int i = 0; i < 9; i++) {
            const vec4 k0 = vec4(kernels[n * 8 * 9 + 8 * i + 0], kernels[n * 8 * 9 + 8 * i + 1], kernels[n * 8 * 9 + 8 * i + 2], kernels[n * 8 * 9 + 8 * i + 3]);
            const vec4 k1 = vec4(kernels[n * 8 * 9 + 8 * i + 4], kernels[n * 8 * 9 + 8 * i + 5], kernels[n * 8 * 9 + 8 * i + 6], kernels[n * 8 * 9 + 8 * i + 7]);
            sum[n] += (dot(k0, r[i][0]) + dot(k1, r[i][1]));
        }
    }

    return ACTIVE(vec4(sum[0], sum[1], sum[2], sum[3]) * 0.2000000f + TEX_BIND_L2_TEXOFF(vec2(0.0f, 0.0f)));
}

//!HOOK LUMA
//!DESC ARNet b8 Layer13 L0
//!WHEN OUTPUT.w LUMA.w / 1.2 > OUTPUT.h LUMA.h / 1.2 > *
//!BIND TMP2_L0
//!BIND TMP2_L1
//!SAVE TMP1_L0
//!COMPONENTS 4

#define ACTIVE(v) (max(v, v * 0.2000000f))

#define TEX_BIND_L0_TEXOFF TMP2_L0_texOff
#define TEX_BIND_L0_TEX TMP2_L0_tex
#define TEX_BIND_L0_POS TMP2_L0_pos
#define TEX_BIND_L0_SIZE TMP2_L0_size
#define TEX_BIND_L0_PT TMP2_L0_pt

#define TEX_BIND_L1_TEXOFF TMP2_L1_texOff
#define TEX_BIND_L1_TEX TMP2_L1_tex
#define TEX_BIND_L1_POS TMP2_L1_pos
#define TEX_BIND_L1_SIZE TMP2_L1_size
#define TEX_BIND_L1_PT TMP2_L1_pt

const float kernels[288] = float[288](
  +0.0483106f, -0.1556028f, +0.0907729f, +0.1275823f, +0.0870971f, -0.2791786f, +0.1111034f, +0.2372993f,
  -0.0593363f, -0.2885941f, +0.1673954f, +0.0757988f, +0.1341953f, -0.1585465f, +0.2220963f, +0.3756319f,
  -0.3388383f, +0.0062051f, +0.2665971f, -0.1388040f, +0.0242329f, +0.0378395f, -0.2296993f, -0.0877064f,
  -0.1334118f, +0.0047710f, -0.2242808f, -0.2985515f, +0.4788235f, +0.1814149f, +0.0197014f, -0.0638358f,
  +0.0901438f, +0.2271398f, -0.4350837f, -0.0975023f, +0.3855486f, +0.1011644f, +0.2614586f, +0.3021068f,
  -0.4818875f, -0.2469252f, +0.0974682f, -0.4864787f, +0.2498342f, -0.0294751f, +0.2177533f, -0.2006131f,
  -0.1796076f, +0.2084839f, -0.2120520f, -0.1088002f, -0.2018022f, +0.2290768f, -0.1105180f, -0.0791357f,
  -0.0643298f, +0.0345067f, +0.2144977f, -0.0258036f, -0.2838038f, -0.0796570f, +0.0674899f, -0.0164760f,
  -0.0037676f, -0.1329171f, -0.0350703f, +0.0398091f, +0.2296862f, +0.2233259f, -0.0004213f, -0.0977794f,
  -0.0184990f, +0.0633348f, +0.2858171f, +0.2134136f, -0.0910996f, -0.1024793f, +0.0908801f, -0.0916012f,
  +0.0468666f, -0.1136084f, +0.4182096f, +0.1080606f, +0.3940665f, -0.3329762f, +0.0892994f, +0.1518902f,
  +0.0314748f, -0.1013062f, +0.5251877f, +0.4388271f, +0.2102023f, -0.3443051f, +0.3835702f, +0.3795343f,
  +0.1345817f, -0.2391287f, +0.2316687f, +0.0983813f, -0.0335834f, +0.4801944f, -0.1063466f, -0.3880394f,
  +0.3780912f, +0.1764929f, -0.2634347f, +0.0391758f, -0.1464052f, +1.2314419f, +0.0570869f, -0.6959309f,
  +0.3292374f, +0.0813151f, -0.3858400f, -0.4803879f, -0.1080661f, +0.8115209f, -0.1127536f, -0.4832609f,
  -0.2468277f, -0.0470167f, -0.0247732f, -0.0443497f, -0.1330580f, -0.2162033f, -0.1033032f, +0.2043374f,
  +0.0705096f, +0.1238118f, +0.1494898f, +0.0911972f, -0.3002563f, -0.4855516f, -0.1985685f, +0.7376895f,
  +0.4096811f, +0.2132654f, +0.4476872f, +0.5721370f, -0.1344689f, -0.0538439f, -0.1172649f, +0.4539194f,
  -0.1403859f, -0.2204187f, +0.1413487f, +0.0883306f, -0.0428998f, -0.2348213f, +0.0301433f, +0.1992491f,
  -0.1922507f, -0.0825430f, +0.3424680f, +0.0319290f, +0.3065113f, +0.1021711f, -0.0472750f, +0.0758067f,
  -0.2204731f, -0.2923311f, +0.3035426f, -0.1226909f, +0.0291411f, -0.0252076f, -0.0112980f, +0.1400288f,
  -0.4431219f, +0.1050430f, -0.2448238f, -0.1522299f, +0.0866927f, +0.0311504f, -0.1110715f, +0.2146327f,
  +0.5011644f, +0.6210922f, +0.0198595f, -0.3815050f, +0.2919258f, +0.4718660f, +0.3862898f, -0.0158608f,
  -0.2758616f, -0.0951774f, +0.2007514f, -0.1241221f, +0.1363123f, -0.1397519f, -0.0949453f, +0.0556554f,
  +0.0420983f, +0.0583082f, -0.1953790f, -0.0460174f, +0.3436721f, +0.0961869f, +0.0615502f, -0.0314398f,
  +0.2310562f, -0.3720358f, +0.3094390f, +0.2029880f, +0.1912217f, +0.0787375f, -0.2292140f, -0.1670084f,
  -0.0840884f, -0.2304723f, +0.0596174f, +0.2068456f, +0.1251124f, +0.1649535f, -0.2855859f, +0.0592577f,
  +0.0044535f, +0.0522443f, -0.3013039f, -0.1924614f, -0.4738772f, +0.1119383f, +0.2027064f, -0.0384352f,
  +0.4423589f, +0.4100922f, +0.1210578f, +0.2299824f, -0.6286520f, +0.2393678f, +0.3635056f, +0.3721414f,
  +0.7872451f, +0.3231953f, -0.3384325f, +0.2204518f, -0.1927565f, +0.1801080f, +0.1984035f, +0.2778040f,
  -0.0851012f, -0.1241506f, -1.0116431f, -0.2261902f, +0.3012311f, -0.1752599f, -0.5220473f, -0.5917549f,
  -0.2464908f, +0.3823639f, -0.7849947f, -0.0940823f, +0.4361868f, +0.2936434f, +0.6614691f, +0.0764736f,
  -0.3957865f, -0.0290096f, -0.0296850f, +0.1370720f, +0.0113986f, +0.6173684f, +0.1610339f, +0.4953973f,
  +0.4767410f, +0.0840613f, -0.1819863f, +0.0463922f, +0.0291819f, -0.0779113f, +0.6345776f, +0.0060340f,
  +0.6343291f, +1.0863454f, -0.5630020f, -0.1404779f, +0.3274408f, +0.0561237f, +0.9434088f, +0.0284124f,
  +0.1562191f, +0.0092152f, +0.3694268f, +0.2477721f, -0.2688666f, +0.2233346f, -0.2908218f, +0.4563454f
);

const float biases[4] = float[4](
  +0.0735937f, -0.0251158f, +0.0716431f, -0.2412743f
);

vec4 hook() {
    const vec4 r[9][2] = vec4[9][2](
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 1.0f)))
    );

    float sum[4] = biases;
    for (int n = 0; n < 4; n++) {
        for (int i = 0; i < 9; i++) {
            const vec4 k0 = vec4(kernels[n * 8 * 9 + 8 * i + 0], kernels[n * 8 * 9 + 8 * i + 1], kernels[n * 8 * 9 + 8 * i + 2], kernels[n * 8 * 9 + 8 * i + 3]);
            const vec4 k1 = vec4(kernels[n * 8 * 9 + 8 * i + 4], kernels[n * 8 * 9 + 8 * i + 5], kernels[n * 8 * 9 + 8 * i + 6], kernels[n * 8 * 9 + 8 * i + 7]);
            sum[n] += (dot(k0, r[i][0]) + dot(k1, r[i][1]));
        }
    }

    return ACTIVE(vec4(sum[0], sum[1], sum[2], sum[3]));
}

//!HOOK LUMA
//!DESC ARNet b8 Layer13 L1
//!WHEN OUTPUT.w LUMA.w / 1.2 > OUTPUT.h LUMA.h / 1.2 > *
//!BIND TMP2_L0
//!BIND TMP2_L1
//!SAVE TMP1_L1
//!COMPONENTS 4

#define ACTIVE(v) (max(v, v * 0.2000000f))

#define TEX_BIND_L0_TEXOFF TMP2_L0_texOff
#define TEX_BIND_L0_TEX TMP2_L0_tex
#define TEX_BIND_L0_POS TMP2_L0_pos
#define TEX_BIND_L0_SIZE TMP2_L0_size
#define TEX_BIND_L0_PT TMP2_L0_pt

#define TEX_BIND_L1_TEXOFF TMP2_L1_texOff
#define TEX_BIND_L1_TEX TMP2_L1_tex
#define TEX_BIND_L1_POS TMP2_L1_pos
#define TEX_BIND_L1_SIZE TMP2_L1_size
#define TEX_BIND_L1_PT TMP2_L1_pt

const float kernels[288] = float[288](
  -0.2256066f, -0.1697732f, +0.1698222f, +0.2377118f, -0.1096706f, -0.1167415f, -0.1061620f, +0.2270478f,
  -0.2678879f, -0.1830358f, +0.4335651f, -0.0691479f, +0.6543666f, -0.3014479f, -0.0831352f, -0.0399273f,
  -0.4445455f, -0.2834992f, +0.4755800f, +0.0238562f, -0.0300759f, +0.0315577f, +0.0235377f, +0.0733346f,
  +0.1752496f, +0.2308350f, -0.1536440f, +0.1831776f, +0.1765341f, +0.2353609f, +0.1469481f, +0.1000460f,
  -0.1645621f, -0.1548994f, +0.0571360f, -0.3095730f, -0.2652126f, -0.0706097f, +0.0799928f, -0.2441629f,
  -0.2431462f, -0.2384136f, -0.0952881f, -0.5018783f, +0.2498413f, -0.2140797f, -0.1555914f, -0.1720588f,
  -0.3101017f, +0.1504924f, +0.0190016f, -0.0839120f, -0.1702627f, -0.2056868f, +0.0395825f, +0.1810911f,
  -0.0838535f, +0.2891232f, -0.3783751f, +0.1570410f, -0.0324384f, +0.2393264f, +0.3291497f, +0.0223388f,
  +0.0923407f, +0.2453353f, -0.3055216f, +0.2453488f, -0.0620974f, +0.3295340f, +0.3234960f, +0.1916513f,
  +0.0974429f, +0.0958560f, +0.0840524f, +0.0358592f, +0.0141593f, +0.2687429f, -0.0262508f, -0.1409352f,
  -0.1941779f, -0.1200821f, -0.3721381f, -0.0783548f, -0.1384342f, -0.1487293f, -0.1972581f, -0.0834842f,
  -0.1547533f, -0.1421424f, -0.0170284f, -0.2891042f, +0.2601018f, -0.0912237f, -0.0242419f, -0.2443314f,
  -0.1841398f, +0.1558367f, +0.2666251f, -0.0793761f, +0.0690624f, +0.2300257f, +0.0759881f, -0.0414332f,
  -0.1388308f, -0.1870379f, -0.3483011f, +0.1783116f, -0.6321024f, -0.0990490f, +0.0913608f, +0.0228606f,
  +0.1097789f, +0.2415387f, +0.4163447f, +0.0986245f, +0.1411137f, -0.5285197f, -0.0377073f, -0.3242645f,
  -0.2785702f, +0.1182302f, -0.0467121f, +0.0320925f, -0.2039173f, +0.0404139f, -0.2560212f, -0.0771049f,
  -0.0317787f, +0.1020972f, -0.3590070f, +0.1437943f, -0.1604189f, +0.1900463f, +0.6380732f, +0.2305205f,
  +0.1485869f, -0.1060433f, +0.3447458f, +0.0285685f, +0.2219949f, -0.2129793f, -0.3325503f, -0.2128157f,
  -0.1876916f, +0.2024470f, -0.3921975f, -0.1903352f, -0.1507494f, -0.1290076f, -0.1228272f, +0.1724071f,
  -0.0882089f, -0.8742876f, +0.6742901f, -0.1070560f, +0.5401608f, -0.3681923f, +0.3854704f, +0.2872454f,
  +0.6212943f, +0.5059602f, -0.2765104f, +0.0525066f, -0.1780237f, +0.5124768f, -0.2932347f, +0.5105545f,
  -0.0945596f, -0.7311472f, -0.0775903f, -0.1389465f, +0.2116008f, -0.4248043f, -0.2370949f, +0.2281674f,
  -0.0912902f, +0.1004703f, -0.2262902f, -0.3412308f, +0.5478271f, +0.3403100f, +0.4965158f, -0.0849599f,
  +0.5858939f, +0.6304162f, -0.5210995f, -0.1409837f, -0.1744949f, +0.4062012f, -0.1270228f, +0.4132766f,
  +0.1742585f, +0.1423912f, -0.0697895f, -0.1428833f, +0.1431770f, -0.1862457f, +0.1147631f, +0.3016002f,
  +0.0746509f, +0.2773857f, -0.1879046f, -0.1919560f, +0.1297812f, +0.0964466f, -0.2129376f, +0.2173813f,
  +0.0833217f, +0.0461550f, +0.1943682f, +0.3056250f, -0.3832952f, +0.2127137f, +0.1353949f, +0.1500915f,
  -0.1272275f, +0.2114405f, -0.3206384f, -0.0894552f, -0.1808620f, +0.0111780f, +0.0107380f, +0.0169105f,
  -0.1902727f, -0.3959623f, -0.0616554f, -0.2411727f, +0.2370003f, -0.4072888f, -0.1030456f, -0.1503665f,
  +0.0612985f, -0.1315441f, +0.4365803f, +0.1979337f, +0.0959834f, -0.2286963f, +0.1309850f, +0.4039573f,
  +0.0835639f, -0.2914655f, +0.2894556f, +0.0792742f, -0.2288069f, -0.3986737f, +0.0607008f, +0.1357982f,
  -0.7480214f, -0.2651367f, -0.0645904f, +0.1030203f, -0.5568481f, +0.0520132f, +0.1313279f, -1.0147835f,
  -0.1167916f, -0.2743894f, -0.0431628f, -0.2666299f, -0.0567743f, -0.4015194f, +0.1155964f, -0.9026191f,
  +0.0870119f, -0.0279968f, -0.0449007f, +0.0403359f, +0.1336976f, -0.2414212f, +0.0498273f, +0.1997001f,
  -0.2024808f, +0.4577123f, -0.3583579f, -0.3883140f, -0.0611139f, -0.0995442f, +0.1119757f, +0.3023334f,
  -0.0146472f, -0.0783276f, +0.1251142f, +0.1369224f, +0.1185034f, +0.2325294f, -0.1218415f, +0.0661119f
);

const float biases[4] = float[4](
  +0.0347354f, +0.0723114f, -0.0860250f, +0.0640864f
);

vec4 hook() {
    const vec4 r[9][2] = vec4[9][2](
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 1.0f)))
    );

    float sum[4] = biases;
    for (int n = 0; n < 4; n++) {
        for (int i = 0; i < 9; i++) {
            const vec4 k0 = vec4(kernels[n * 8 * 9 + 8 * i + 0], kernels[n * 8 * 9 + 8 * i + 1], kernels[n * 8 * 9 + 8 * i + 2], kernels[n * 8 * 9 + 8 * i + 3]);
            const vec4 k1 = vec4(kernels[n * 8 * 9 + 8 * i + 4], kernels[n * 8 * 9 + 8 * i + 5], kernels[n * 8 * 9 + 8 * i + 6], kernels[n * 8 * 9 + 8 * i + 7]);
            sum[n] += (dot(k0, r[i][0]) + dot(k1, r[i][1]));
        }
    }

    return ACTIVE(vec4(sum[0], sum[1], sum[2], sum[3]));
}

//!HOOK LUMA
//!DESC ARNet b8 Layer14 L0
//!WHEN OUTPUT.w LUMA.w / 1.2 > OUTPUT.h LUMA.h / 1.2 > *
//!BIND TMP1_L0
//!BIND TMP1_L1
//!BIND TMP2_L0
//!SAVE TMP2_L0
//!COMPONENTS 4

#define ACTIVE(v) (v)

#define TEX_BIND_L0_TEXOFF TMP1_L0_texOff
#define TEX_BIND_L0_TEX TMP1_L0_tex
#define TEX_BIND_L0_POS TMP1_L0_pos
#define TEX_BIND_L0_SIZE TMP1_L0_size
#define TEX_BIND_L0_PT TMP1_L0_pt

#define TEX_BIND_L1_TEXOFF TMP1_L1_texOff
#define TEX_BIND_L1_TEX TMP1_L1_tex
#define TEX_BIND_L1_POS TMP1_L1_pos
#define TEX_BIND_L1_SIZE TMP1_L1_size
#define TEX_BIND_L1_PT TMP1_L1_pt

#define TEX_BIND_L2_TEXOFF TMP2_L0_texOff
#define TEX_BIND_L2_TEX TMP2_L0_tex
#define TEX_BIND_L2_POS TMP2_L0_pos
#define TEX_BIND_L2_SIZE TMP2_L0_size
#define TEX_BIND_L2_PT TMP2_L0_pt

const float kernels[288] = float[288](
  +0.0851597f, -0.3478329f, -0.0389462f, -0.1239461f, -0.0621386f, -0.2470124f, -0.2432555f, +0.1274967f,
  +0.2069518f, -0.2846420f, -0.2238553f, +0.0000243f, +0.2403415f, +0.0820368f, +0.0131034f, -0.0461673f,
  -0.0112253f, +0.0178334f, -0.1527678f, -0.2019905f, -0.0011902f, +0.0369863f, -0.0455696f, -0.0964383f,
  -0.0235704f, -0.3011145f, +0.0683220f, -0.0877949f, +0.0981566f, +0.2006174f, +0.2433417f, -0.1750458f,
  +0.0240838f, -0.9537162f, -0.3274830f, -0.0770473f, +0.3344912f, -0.0566055f, -0.3336567f, +0.5379663f,
  -0.0696887f, +0.2844435f, +0.3545417f, -0.1642065f, -0.2537504f, +0.2999304f, -0.0753395f, -0.2956904f,
  -0.2077980f, +0.1982004f, -0.0152331f, +0.0927450f, +0.1992364f, +0.0594676f, +0.1038153f, -0.2477283f,
  -0.3019644f, +0.0165691f, +0.1761848f, +0.1821835f, -0.2421752f, -0.0775634f, -0.1302618f, -0.0423443f,
  -0.0152519f, -0.0894368f, -0.0702048f, -0.2035280f, -0.4102988f, -0.1369623f, -0.2243867f, +0.3132481f,
  +0.0474684f, -0.0553865f, +0.0794236f, +0.2718877f, -0.0039299f, +0.0995393f, -0.1792526f, +0.1106862f,
  -0.2581560f, +0.2224646f, +0.0135719f, -0.7454971f, -0.1916704f, -0.0008383f, +0.2969468f, -0.2002845f,
  -0.0164692f, -0.0719116f, -0.0511548f, +0.1032654f, +0.0332464f, -0.2182234f, -0.1035007f, -0.0063271f,
  -0.0609213f, +0.2883350f, +0.0028578f, +0.2109231f, +0.1295718f, +0.0179201f, -0.3040737f, -0.0249978f,
  -0.0389556f, +0.4734797f, -0.4257267f, -0.5982383f, -0.1936919f, +0.4391303f, +0.3930480f, -0.1850998f,
  +0.2081037f, -0.0318589f, -0.3955513f, -0.1834025f, +0.1615338f, -0.1091813f, +0.0126273f, +0.0779561f,
  +0.2578572f, -0.2576594f, +0.2001839f, -0.3443688f, -0.1064076f, -0.1420177f, -0.1565900f, +0.2564309f,
  +0.2580441f, -0.2201101f, -0.0169621f, +0.2578920f, -0.0338192f, +0.0961611f, +0.3367788f, +0.1447976f,
  +0.2156532f, -0.0476649f, +0.0311356f, +0.2372931f, +0.0521364f, -0.0275950f, +0.1218782f, -0.1585176f,
  +0.0010055f, -0.4774165f, -0.2805375f, -0.5895312f, +0.2321917f, -0.1624492f, -0.1891945f, +0.0956657f,
  +0.0603366f, -0.1826985f, -0.2048307f, +0.4171337f, +0.4740471f, +0.1895522f, +0.3885241f, -0.1517219f,
  +0.0281612f, -0.2561553f, -0.0890837f, -0.0184017f, +0.0512457f, -0.0574760f, +0.0683339f, +0.0711250f,
  -0.2389914f, +0.2488137f, +0.0514631f, +0.6606959f, -0.0136262f, +0.4151869f, +0.3072882f, -0.4701545f,
  -0.3809107f, +0.4600692f, +0.2101852f, +0.3795370f, -0.3083119f, +0.1601172f, -0.0507845f, +0.4714452f,
  -0.0453210f, +0.0287953f, +0.2480270f, +0.1233372f, +0.0015120f, -0.2146964f, +0.0236900f, -0.1526206f,
  +0.4113811f, -0.0096319f, -0.0243082f, +0.4220479f, -0.1355076f, -0.0751361f, -0.3221920f, +0.1634952f,
  +0.1367406f, -0.5089648f, -0.3548733f, +0.3310420f, -0.4992608f, +0.3604737f, +0.9368826f, +0.2437472f,
  +0.3399587f, -0.2021006f, -0.1031073f, +0.3558659f, +0.1560190f, -0.0288355f, -0.0073721f, -0.0149224f,
  +0.1380635f, +0.7598783f, -0.1043878f, +0.1171791f, -0.2389326f, +0.1937676f, +0.2959449f, -0.3467982f,
  -0.1117472f, -0.2577462f, -0.2411130f, +0.1246869f, -0.0809951f, -0.3750587f, -0.8469837f, +0.4469363f,
  +0.0076651f, +0.2058822f, +0.2687676f, +0.1260725f, +0.0507974f, +0.0611168f, +0.2537518f, -0.0735699f,
  +0.4281003f, -0.4255553f, +0.0276076f, +0.2903421f, -0.1540883f, -0.6396574f, -0.7166101f, +0.6532010f,
  +0.5069739f, +0.1333001f, +0.2278297f, +0.0932534f, +0.2716038f, +0.1045190f, +0.2767448f, -0.1645640f,
  +0.0301824f, -0.3780313f, +0.0748812f, +0.0551664f, -0.2481015f, -0.1778484f, +0.1801182f, +0.3894268f,
  +0.1466430f, -0.4053473f, +0.0648253f, -0.4394101f, +0.0321091f, -0.0191161f, +0.1518126f, +0.1852315f,
  -0.0104326f, -0.0311015f, -0.0332499f, +0.0818374f, +0.3842290f, -0.2604159f, -0.3669342f, +0.2622346f,
  -0.0422598f, +0.1732729f, -0.1166829f, -0.4096993f, -0.1567976f, -0.0421446f, +0.1658171f, -0.1917117f
);

const float biases[4] = float[4](
  +0.0191433f, +0.0218148f, +0.1739405f, -0.0476076f
);

vec4 hook() {
    const vec4 r[9][2] = vec4[9][2](
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 1.0f)))
    );

    float sum[4] = biases;
    for (int n = 0; n < 4; n++) {
        for (int i = 0; i < 9; i++) {
            const vec4 k0 = vec4(kernels[n * 8 * 9 + 8 * i + 0], kernels[n * 8 * 9 + 8 * i + 1], kernels[n * 8 * 9 + 8 * i + 2], kernels[n * 8 * 9 + 8 * i + 3]);
            const vec4 k1 = vec4(kernels[n * 8 * 9 + 8 * i + 4], kernels[n * 8 * 9 + 8 * i + 5], kernels[n * 8 * 9 + 8 * i + 6], kernels[n * 8 * 9 + 8 * i + 7]);
            sum[n] += (dot(k0, r[i][0]) + dot(k1, r[i][1]));
        }
    }

    return ACTIVE(vec4(sum[0], sum[1], sum[2], sum[3]) * 0.2000000f + TEX_BIND_L2_TEXOFF(vec2(0.0f, 0.0f)));
}

//!HOOK LUMA
//!DESC ARNet b8 Layer14 L1
//!WHEN OUTPUT.w LUMA.w / 1.2 > OUTPUT.h LUMA.h / 1.2 > *
//!BIND TMP1_L0
//!BIND TMP1_L1
//!BIND TMP2_L1
//!SAVE TMP2_L1
//!COMPONENTS 4

#define ACTIVE(v) (v)

#define TEX_BIND_L0_TEXOFF TMP1_L0_texOff
#define TEX_BIND_L0_TEX TMP1_L0_tex
#define TEX_BIND_L0_POS TMP1_L0_pos
#define TEX_BIND_L0_SIZE TMP1_L0_size
#define TEX_BIND_L0_PT TMP1_L0_pt

#define TEX_BIND_L1_TEXOFF TMP1_L1_texOff
#define TEX_BIND_L1_TEX TMP1_L1_tex
#define TEX_BIND_L1_POS TMP1_L1_pos
#define TEX_BIND_L1_SIZE TMP1_L1_size
#define TEX_BIND_L1_PT TMP1_L1_pt

#define TEX_BIND_L2_TEXOFF TMP2_L1_texOff
#define TEX_BIND_L2_TEX TMP2_L1_tex
#define TEX_BIND_L2_POS TMP2_L1_pos
#define TEX_BIND_L2_SIZE TMP2_L1_size
#define TEX_BIND_L2_PT TMP2_L1_pt

const float kernels[288] = float[288](
  -0.1676171f, +0.0293073f, -0.0359921f, +0.1167992f, -0.0747104f, -0.1585813f, -0.1189186f, -0.0758162f,
  +0.1827262f, -0.1884571f, -0.0602593f, +0.1805288f, -0.0530172f, +0.0456113f, -0.0666992f, +0.1041389f,
  -0.0107844f, +0.1048940f, -0.1407127f, +0.2421097f, +0.1920395f, +0.1175648f, +0.0008796f, -0.1165206f,
  -0.2387345f, +0.1412395f, -0.0923112f, -0.0843702f, -0.1178492f, -0.1594199f, +0.2961861f, -0.1376065f,
  -0.1118656f, -0.3601981f, -0.0772806f, -0.0884289f, -0.1580169f, +0.2138264f, -0.2113605f, +0.5150073f,
  -0.2364898f, -0.1109820f, -0.1545545f, -0.1115745f, -0.0622226f, -0.0963158f, -0.2069803f, +0.1434576f,
  +0.1842508f, -0.0739755f, -0.1227660f, +0.1448333f, -0.1225028f, -0.0310108f, -0.0467214f, +0.1630844f,
  -0.1307067f, +0.2591295f, +0.0463669f, +0.2661235f, -0.0885321f, +0.1838569f, -0.1571639f, -0.0677767f,
  +0.1174962f, +0.0344048f, -0.0134937f, +0.0612144f, +0.0351583f, +0.0573997f, -0.1364197f, -0.1970713f,
  -0.2756590f, +0.1615669f, -0.1612561f, +0.1280132f, +0.0142088f, -0.0307556f, +0.4337389f, -0.2406159f,
  +0.2557984f, -0.2149615f, -0.0176587f, -0.2280064f, +0.0243826f, -0.3061632f, -0.4764963f, +0.3613516f,
  -0.0448309f, +0.0571410f, -0.0114940f, +0.2797438f, +0.0532149f, +0.2874722f, +0.3269148f, -0.0808249f,
  -0.1751441f, -0.8303643f, +0.4535407f, -0.0370479f, +0.0587046f, +0.5639378f, -0.0041647f, +0.6143754f,
  -0.0561928f, -0.0750677f, -0.4544594f, -0.0423481f, -0.0271523f, -0.2532983f, +0.6099524f, -0.0342048f,
  -0.2660354f, -0.2057508f, +0.0663408f, +0.0277463f, +0.4701265f, -0.2298766f, -0.0868862f, -0.0253266f,
  +0.1054255f, +0.1285724f, +0.1085398f, +0.2293714f, -0.1259836f, +0.0818977f, +0.1110601f, +0.0188654f,
  -0.0322248f, -0.2688530f, +0.1067301f, -0.3346470f, -0.0251572f, +0.4332003f, +0.6602308f, +0.0439615f,
  -0.0982663f, -0.0863605f, +0.0965060f, +0.0567973f, +0.3426891f, +0.1545021f, -0.0900362f, +0.0190720f,
  +0.0968056f, +0.0159014f, +0.1510087f, +0.1953533f, -0.0594888f, -0.0578036f, +0.0857294f, +0.0241489f,
  -0.1796029f, -0.3716605f, +0.3480935f, -0.5619768f, +0.0693371f, -0.2683305f, -0.3508747f, +0.4510386f,
  +0.0676947f, +0.1761491f, +0.3041417f, +0.0159161f, -0.2199830f, +0.0926107f, +0.2767957f, -0.1492216f,
  -0.2245555f, +0.0259622f, +0.0222985f, +0.2506514f, -0.3175568f, +0.4393268f, +0.2564142f, -0.2466981f,
  -0.0914478f, -0.4507311f, -0.0767182f, +0.6323170f, +0.4140646f, +0.0348134f, +0.2630003f, +0.1093385f,
  +0.0654382f, -0.0716395f, +0.5385179f, +0.2928007f, -0.4303788f, -0.2726641f, -0.0063132f, +0.1332178f,
  +0.0288344f, +0.1803674f, -0.0708885f, +0.8290398f, -0.0577819f, +0.0210839f, -0.1962305f, -0.1645563f,
  +0.0167362f, -0.0325295f, -0.1108636f, +0.1296040f, -0.0230716f, -0.0644898f, +0.2056677f, +0.1770963f,
  +0.1794113f, +0.1199765f, -0.4865811f, -0.0827639f, -0.2248174f, -0.0369075f, +0.0277484f, -0.0278931f,
  +0.0868565f, -0.0671541f, -0.1408251f, -0.2914589f, +0.0485137f, +0.0623888f, +0.2096977f, -0.1041889f,
  +0.1714341f, +0.0492097f, -0.0735695f, -0.3582267f, -0.1772882f, -0.0748088f, +0.1242192f, -0.2237332f,
  +0.0967266f, +0.0597844f, +0.0120968f, +0.3599178f, -0.0865149f, -0.0020528f, -0.2134441f, +0.0518289f,
  +0.0884265f, -0.4368142f, +0.0488862f, -0.1929846f, +0.4136515f, -0.0123166f, -0.3058897f, +0.4885945f,
  +0.0148328f, -0.3790236f, +0.0658897f, -0.4470857f, +0.0140981f, -0.1275101f, -0.5671450f, +0.2684639f,
  -0.2319216f, +0.1476871f, -0.0149067f, +0.5962484f, -0.0323181f, +0.1276735f, +0.0678656f, +0.0782909f,
  -0.1816659f, +0.0329156f, -0.1136622f, -0.1677125f, +0.1854207f, +0.3162014f, +0.6163402f, -0.2923012f,
  -0.1806564f, +0.1835658f, -0.3741356f, -0.6642326f, +0.1330241f, -0.1699873f, -0.0675655f, -0.1454609f,
  -0.0368308f, +0.0478511f, -0.0672468f, -0.1225189f, -0.2230864f, -0.1515126f, -0.0771960f, +0.2449582f
);

const float biases[4] = float[4](
  +0.0749347f, -0.2071190f, +0.0268848f, -0.0477111f
);

vec4 hook() {
    const vec4 r[9][2] = vec4[9][2](
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 1.0f)))
    );

    float sum[4] = biases;
    for (int n = 0; n < 4; n++) {
        for (int i = 0; i < 9; i++) {
            const vec4 k0 = vec4(kernels[n * 8 * 9 + 8 * i + 0], kernels[n * 8 * 9 + 8 * i + 1], kernels[n * 8 * 9 + 8 * i + 2], kernels[n * 8 * 9 + 8 * i + 3]);
            const vec4 k1 = vec4(kernels[n * 8 * 9 + 8 * i + 4], kernels[n * 8 * 9 + 8 * i + 5], kernels[n * 8 * 9 + 8 * i + 6], kernels[n * 8 * 9 + 8 * i + 7]);
            sum[n] += (dot(k0, r[i][0]) + dot(k1, r[i][1]));
        }
    }

    return ACTIVE(vec4(sum[0], sum[1], sum[2], sum[3]) * 0.2000000f + TEX_BIND_L2_TEXOFF(vec2(0.0f, 0.0f)));
}

//!HOOK LUMA
//!DESC ARNet b8 Layer15 L0
//!WHEN OUTPUT.w LUMA.w / 1.2 > OUTPUT.h LUMA.h / 1.2 > *
//!BIND TMP2_L0
//!BIND TMP2_L1
//!SAVE TMP1_L0
//!COMPONENTS 4

#define ACTIVE(v) (max(v, v * 0.2000000f))

#define TEX_BIND_L0_TEXOFF TMP2_L0_texOff
#define TEX_BIND_L0_TEX TMP2_L0_tex
#define TEX_BIND_L0_POS TMP2_L0_pos
#define TEX_BIND_L0_SIZE TMP2_L0_size
#define TEX_BIND_L0_PT TMP2_L0_pt

#define TEX_BIND_L1_TEXOFF TMP2_L1_texOff
#define TEX_BIND_L1_TEX TMP2_L1_tex
#define TEX_BIND_L1_POS TMP2_L1_pos
#define TEX_BIND_L1_SIZE TMP2_L1_size
#define TEX_BIND_L1_PT TMP2_L1_pt

const float kernels[288] = float[288](
  +0.4238870f, +0.0533829f, -0.6030505f, -0.4241222f, -0.2021572f, +0.1849614f, -0.0169279f, -0.3330830f,
  +0.3708262f, +0.3804525f, -1.3935020f, -0.7613710f, -0.3606601f, -0.0972254f, +0.1159836f, -0.5348566f,
  +0.3145980f, +0.3295730f, -0.2832941f, -0.1720426f, +0.0116021f, -0.0167884f, +0.0554722f, -0.5922164f,
  +0.5164104f, +0.0151053f, +0.5523689f, +0.0663077f, +0.3560974f, -0.0364472f, +0.0967093f, +0.1202457f,
  +0.8256800f, +0.1457667f, +0.7941844f, +0.1435956f, +0.4601694f, +0.4032984f, +0.0380947f, -0.0970043f,
  -0.1017818f, -0.5307035f, +0.3443867f, +0.0002146f, +0.2932208f, -0.0772782f, -0.0683962f, -0.0776128f,
  -0.0489324f, -0.3774912f, +0.4317458f, +0.0253418f, -0.2040713f, -0.2020356f, -0.3727694f, -0.0101123f,
  -0.1327595f, -0.0307989f, +0.6270787f, -0.2468048f, -0.2398418f, -0.6907505f, -0.2640603f, -0.1160492f,
  +0.0077598f, +0.1243508f, +0.2599162f, -0.1141579f, -0.0140944f, -0.2621641f, +0.0156101f, -0.2412304f,
  +0.0422345f, +0.3617447f, -0.0514685f, -0.2828752f, -0.0320915f, +0.0761461f, +0.1737115f, +0.0413847f,
  +0.1000967f, +0.0334345f, -0.3576465f, -0.0163852f, -0.0576635f, -0.1727405f, -0.4654374f, -0.2192056f,
  +0.0651326f, +0.1831061f, -0.2287251f, -0.2624407f, -0.0169414f, +0.0916495f, -0.0954791f, -0.3882457f,
  +0.0352211f, -0.2444787f, +0.1103757f, -0.2935143f, +0.4986982f, +0.2719972f, +0.2888963f, +0.1127119f,
  +0.0468243f, -0.8224122f, +0.1677473f, +0.1778234f, +0.3313472f, -0.0697554f, -0.1521796f, +0.1255506f,
  -0.1792423f, -0.3238193f, +0.1441234f, -0.0941600f, -0.0508108f, -0.1502269f, +0.1954538f, -0.0322938f,
  +0.3125073f, +0.7383544f, +0.1464063f, -0.1236608f, +0.0570614f, +0.0317974f, +0.3671676f, +0.4092615f,
  +0.2068959f, +0.3145663f, -0.0774470f, -0.0126639f, +0.1445187f, +0.2399777f, -0.1765361f, +0.3793433f,
  -0.1225117f, +0.0823590f, +0.0514162f, -0.2169789f, +0.0820527f, -0.0734572f, +0.0138086f, +0.2545601f,
  -0.1826087f, +0.0599419f, +0.1207020f, +0.2170132f, +0.1751437f, -0.0253401f, -0.1508640f, +0.1637469f,
  -0.4662915f, -0.3595175f, +0.2269138f, -0.0014716f, -0.1425302f, +0.0639283f, -0.1080417f, +0.0999622f,
  -0.0272342f, +0.1026187f, -0.1001457f, +0.1890701f, -0.0837267f, +0.2606173f, +0.0442657f, +0.2301880f,
  -0.2408164f, -0.1453821f, +0.2213283f, +0.2167131f, +0.0346251f, -0.0420722f, +0.0201178f, +0.1722157f,
  -0.1245415f, -0.0736672f, +0.1042134f, +0.1832202f, +0.0896109f, +0.1186436f, +0.1563518f, +0.3114969f,
  -0.5984682f, -0.3617525f, +0.0086990f, -0.0101707f, -0.0988689f, +0.1585055f, +0.2224097f, +0.5001786f,
  -0.1476159f, +0.1317487f, -0.3464464f, -0.0239860f, +0.0018540f, +0.1273683f, -0.0067868f, +0.1458397f,
  -0.4366412f, +0.4195199f, -0.1837815f, -0.0058733f, +0.2105483f, -0.0910794f, +0.0744756f, +0.4288579f,
  -0.3093269f, -0.0684286f, -0.0549658f, +0.2539429f, +0.1102333f, +0.0250723f, -0.0940095f, +0.3435429f,
  +0.2281121f, +0.3216977f, +0.2421514f, -0.0967511f, +0.0051698f, +0.3756959f, +0.1468298f, -0.0078102f,
  -0.2779361f, -0.3391644f, -0.2075428f, +0.0619267f, -0.0172058f, -0.2682717f, -0.2335145f, +0.1539808f,
  -0.0612255f, -0.2109232f, +0.0364304f, +0.0404282f, -0.0917833f, -0.2809440f, -0.1764901f, -0.2014370f,
  -0.0154027f, +0.4401602f, +0.0966501f, -0.1563323f, -0.0873316f, +0.3301667f, +0.3988481f, -0.0519983f,
  -0.0854458f, -0.1326018f, -0.0815253f, -0.0278489f, -0.2286864f, -0.2490964f, +0.0153644f, +0.3224003f,
  +0.3304625f, +0.0940660f, -0.2365461f, -0.1035316f, +0.1933301f, -0.3115726f, +0.0265766f, -0.0777559f,
  +0.1299517f, +0.3276854f, +0.2247282f, -0.0683841f, -0.1665328f, +0.1299926f, -0.0074091f, +0.1276996f,
  +0.1213489f, +0.1144170f, +0.0044075f, +0.2390225f, -0.0350877f, -0.0754651f, +0.0429553f, +0.1633942f,
  +0.1113085f, -0.0053294f, +0.0274640f, +0.1382750f, -0.0938506f, -0.0916827f, -0.0625337f, +0.0847995f
);

const float biases[4] = float[4](
  -0.0400991f, -0.0353313f, +0.0414075f, -0.0579310f
);

vec4 hook() {
    const vec4 r[9][2] = vec4[9][2](
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 1.0f)))
    );

    float sum[4] = biases;
    for (int n = 0; n < 4; n++) {
        for (int i = 0; i < 9; i++) {
            const vec4 k0 = vec4(kernels[n * 8 * 9 + 8 * i + 0], kernels[n * 8 * 9 + 8 * i + 1], kernels[n * 8 * 9 + 8 * i + 2], kernels[n * 8 * 9 + 8 * i + 3]);
            const vec4 k1 = vec4(kernels[n * 8 * 9 + 8 * i + 4], kernels[n * 8 * 9 + 8 * i + 5], kernels[n * 8 * 9 + 8 * i + 6], kernels[n * 8 * 9 + 8 * i + 7]);
            sum[n] += (dot(k0, r[i][0]) + dot(k1, r[i][1]));
        }
    }

    return ACTIVE(vec4(sum[0], sum[1], sum[2], sum[3]));
}

//!HOOK LUMA
//!DESC ARNet b8 Layer15 L1
//!WHEN OUTPUT.w LUMA.w / 1.2 > OUTPUT.h LUMA.h / 1.2 > *
//!BIND TMP2_L0
//!BIND TMP2_L1
//!SAVE TMP1_L1
//!COMPONENTS 4

#define ACTIVE(v) (max(v, v * 0.2000000f))

#define TEX_BIND_L0_TEXOFF TMP2_L0_texOff
#define TEX_BIND_L0_TEX TMP2_L0_tex
#define TEX_BIND_L0_POS TMP2_L0_pos
#define TEX_BIND_L0_SIZE TMP2_L0_size
#define TEX_BIND_L0_PT TMP2_L0_pt

#define TEX_BIND_L1_TEXOFF TMP2_L1_texOff
#define TEX_BIND_L1_TEX TMP2_L1_tex
#define TEX_BIND_L1_POS TMP2_L1_pos
#define TEX_BIND_L1_SIZE TMP2_L1_size
#define TEX_BIND_L1_PT TMP2_L1_pt

const float kernels[288] = float[288](
  -0.3203608f, -0.1715434f, -0.1047247f, -0.2195854f, +0.2117786f, -0.1333978f, +0.0186800f, +0.0642458f,
  -0.5039166f, -0.1856172f, -0.1592625f, -0.3901930f, +0.1766267f, +0.2079525f, -0.0028727f, +0.0745014f,
  -0.3665547f, -0.3904659f, +0.0330925f, -0.1650695f, -0.1373998f, -0.0815982f, -0.0728414f, +0.0165903f,
  -0.2965389f, -0.3669213f, -0.0590809f, -0.0283166f, +0.1153678f, -0.2469350f, -0.1085933f, +0.0305187f,
  -0.6257117f, -0.2912522f, +0.5042916f, +0.0676822f, -0.0951848f, -0.0203043f, +0.0642262f, -0.0388206f,
  -0.4960673f, -0.2318642f, -0.0000847f, -0.0039071f, +0.3243492f, -0.1664989f, -0.0138996f, +0.4000426f,
  -0.0180294f, +0.2004191f, -0.1633151f, -0.1531383f, +0.0165289f, +0.0476610f, +0.1814543f, +0.1169809f,
  -0.1923110f, -0.2773789f, -0.0079315f, -0.0997178f, +0.3712496f, +0.0774166f, -0.1173940f, -0.0634260f,
  -0.0007112f, -0.0546007f, -0.0974657f, -0.0020683f, -0.0459443f, +0.0176327f, -0.1506711f, -0.0499041f,
  -0.0647353f, +0.0691577f, -0.1503022f, -0.0961917f, -0.1914922f, +0.0262885f, +0.0015717f, -0.1675026f,
  +0.1033024f, +0.1015451f, -0.4174063f, +0.0602504f, -0.1804722f, -0.1900828f, -0.0511416f, -0.3057042f,
  +0.0622666f, -0.0078662f, -0.3196209f, +0.0035454f, -0.0226966f, -0.1926659f, -0.1378472f, -0.2404875f,
  -0.3843110f, +0.2534076f, -0.3769609f, -0.3212428f, -0.3263047f, -0.2426729f, -0.1219441f, -0.4662661f,
  -0.3688516f, -0.7281908f, +0.2079536f, -0.1191180f, +0.0299191f, -0.1520943f, +0.4721811f, -0.4996186f,
  -0.1301024f, +0.0182609f, +0.1195549f, +0.4481874f, -0.0984836f, -0.2018523f, -0.1094999f, -0.0637264f,
  -0.2534948f, -0.7387776f, +0.3075562f, +0.0343140f, -0.0445329f, -0.3559679f, -0.2008067f, -0.0647919f,
  -0.1947158f, -0.2509116f, +0.1206044f, +0.0654363f, -0.0321030f, -0.3589773f, +0.1504686f, -0.5065532f,
  +0.1422539f, +0.2143274f, -0.1000041f, -0.0616462f, +0.0749864f, -0.0223522f, -0.1472967f, -0.1470191f,
  -0.2637378f, -0.2249164f, +0.1240873f, +0.0217265f, +0.1356382f, -0.0683255f, -0.0823219f, +0.1102085f,
  -0.3330022f, -0.1273232f, +0.1352951f, +0.0493714f, -0.0219003f, +0.1060784f, -0.1026535f, +0.0348311f,
  -0.0531713f, -0.0900195f, +0.0190474f, +0.0021751f, +0.2614108f, -0.0101896f, -0.1256811f, -0.0583576f,
  -0.2514479f, -0.0766944f, +0.2404456f, -0.0371804f, +0.4012773f, -0.0758682f, -0.2287431f, +0.0856504f,
  -0.1401042f, -0.2267391f, -0.4666302f, -0.4012437f, -0.1062139f, +0.2293555f, +0.0651783f, -0.4139572f,
  +0.3016138f, +0.1381644f, +0.1412117f, -0.0054554f, -0.2538691f, -0.1924310f, +0.0519202f, -0.3993582f,
  +0.1296669f, -0.1319299f, +0.2194717f, +0.0302725f, +0.3061111f, +0.0504670f, -0.1887790f, +0.0571274f,
  +0.2518277f, -0.0752617f, +0.1533649f, +0.2105165f, -0.1593583f, +0.3072266f, +0.0424281f, +0.0393394f,
  +0.1291004f, +0.1796514f, +0.1630838f, +0.0085103f, +0.0121786f, +0.0251854f, -0.0794660f, +0.1813696f,
  -0.3171691f, +0.0013805f, +0.0409509f, +0.1562294f, -0.4435888f, -0.0222123f, +0.0093472f, -0.0539460f,
  -0.0651700f, +0.2000252f, +0.3647459f, +0.2302562f, -0.1127596f, +0.5177042f, -0.0268525f, -0.0675270f,
  -0.1542118f, -0.0583281f, -0.0250029f, +0.2619311f, -0.0466710f, +0.0578494f, -0.0765913f, +0.1780569f,
  +0.0739594f, +0.4926027f, -0.1421895f, -0.0660709f, -0.2034580f, +0.2372136f, +0.1349940f, -0.0027112f,
  +0.2005999f, +0.6283411f, +0.1331558f, -0.2137788f, +0.6694654f, +0.6568748f, -0.0366611f, -0.2665875f,
  -0.1014280f, +0.2086363f, -0.1269697f, -0.0235200f, -0.0638404f, +0.4635697f, +0.1545189f, +0.5423255f,
  +0.0411743f, -0.0241931f, +0.1432672f, +0.1283000f, -0.2537888f, -0.2027344f, +0.0786407f, +0.0299713f,
  -0.2192890f, -0.1728018f, -0.0231276f, +0.1147095f, -0.1934768f, -0.3062262f, -0.0698377f, -0.1185381f,
  -0.0689210f, -0.0971707f, -0.3468488f, +0.0310317f, -0.1034529f, -0.2300766f, +0.1097069f, -0.3128160f
);

const float biases[4] = float[4](
  +0.0740271f, +0.0203103f, +0.0930900f, +0.0176107f
);

vec4 hook() {
    const vec4 r[9][2] = vec4[9][2](
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 1.0f)))
    );

    float sum[4] = biases;
    for (int n = 0; n < 4; n++) {
        for (int i = 0; i < 9; i++) {
            const vec4 k0 = vec4(kernels[n * 8 * 9 + 8 * i + 0], kernels[n * 8 * 9 + 8 * i + 1], kernels[n * 8 * 9 + 8 * i + 2], kernels[n * 8 * 9 + 8 * i + 3]);
            const vec4 k1 = vec4(kernels[n * 8 * 9 + 8 * i + 4], kernels[n * 8 * 9 + 8 * i + 5], kernels[n * 8 * 9 + 8 * i + 6], kernels[n * 8 * 9 + 8 * i + 7]);
            sum[n] += (dot(k0, r[i][0]) + dot(k1, r[i][1]));
        }
    }

    return ACTIVE(vec4(sum[0], sum[1], sum[2], sum[3]));
}

//!HOOK LUMA
//!DESC ARNet b8 Layer16 L0
//!WHEN OUTPUT.w LUMA.w / 1.2 > OUTPUT.h LUMA.h / 1.2 > *
//!BIND TMP1_L0
//!BIND TMP1_L1
//!BIND TMP2_L0
//!BIND FEAT_L0
//!SAVE TMP2_L0
//!COMPONENTS 4

#define ACTIVE(v) (v)

#define TEX_BIND_L0_TEXOFF TMP1_L0_texOff
#define TEX_BIND_L0_TEX TMP1_L0_tex
#define TEX_BIND_L0_POS TMP1_L0_pos
#define TEX_BIND_L0_SIZE TMP1_L0_size
#define TEX_BIND_L0_PT TMP1_L0_pt

#define TEX_BIND_L1_TEXOFF TMP1_L1_texOff
#define TEX_BIND_L1_TEX TMP1_L1_tex
#define TEX_BIND_L1_POS TMP1_L1_pos
#define TEX_BIND_L1_SIZE TMP1_L1_size
#define TEX_BIND_L1_PT TMP1_L1_pt

#define TEX_BIND_L2_TEXOFF TMP2_L0_texOff
#define TEX_BIND_L2_TEX TMP2_L0_tex
#define TEX_BIND_L2_POS TMP2_L0_pos
#define TEX_BIND_L2_SIZE TMP2_L0_size
#define TEX_BIND_L2_PT TMP2_L0_pt

#define TEX_BIND_L3_TEXOFF FEAT_L0_texOff
#define TEX_BIND_L3_TEX FEAT_L0_tex
#define TEX_BIND_L3_POS FEAT_L0_pos
#define TEX_BIND_L3_SIZE FEAT_L0_size
#define TEX_BIND_L3_PT FEAT_L0_pt

const float kernels[288] = float[288](
  -0.0063190f, +0.0506172f, +0.0791072f, -0.1224499f, -0.0841190f, -0.0514151f, -0.1028265f, +0.0644593f,
  +0.0423947f, +0.0737540f, +0.2151532f, -0.0386931f, +0.0330631f, +0.2847738f, -0.3054650f, +0.1879786f,
  -0.0720256f, -0.0000974f, -0.0930476f, +0.0521502f, +0.0398366f, -0.1697786f, +0.0045407f, -0.0304374f,
  -0.0598756f, +0.1762925f, +0.2248235f, -0.3613406f, +0.0983654f, +0.2399149f, -0.1712062f, +0.0471932f,
  +0.1420000f, +0.3495996f, -0.1262815f, +0.1891452f, -0.1349877f, +0.0804969f, +0.0686644f, +0.3671921f,
  +0.2401852f, -0.1315810f, -0.0109692f, +0.1368401f, +0.3117890f, +0.1757735f, -0.1667302f, -0.0604958f,
  +0.0150883f, -0.0042786f, +0.0289505f, -0.1063011f, +0.0029544f, -0.0460457f, +0.0235934f, -0.0124336f,
  -0.1021209f, +0.1258093f, -0.0359421f, +0.0233859f, +0.1575594f, -0.0920823f, -0.0662130f, +0.1544485f,
  -0.1073491f, -0.2967642f, +0.1622583f, -0.0171376f, +0.1171356f, -0.0651361f, +0.4210377f, +0.0728643f,
  +0.2549949f, -0.0940653f, +0.1148396f, -0.0454279f, +0.1463825f, -0.0207632f, -0.1510605f, +0.0478043f,
  -0.3373869f, -0.0927531f, -0.1215003f, +0.0291293f, +0.0800118f, -0.1696629f, -0.0891668f, -0.2057641f,
  -0.0059637f, +0.0389475f, -0.0320857f, -0.0856683f, -0.1699615f, +0.1484771f, -0.0734055f, -0.0555351f,
  -0.0048968f, -0.1167103f, -0.0275976f, +0.0913133f, -0.1025013f, -0.0677855f, -0.0093012f, -0.2668569f,
  -0.3429925f, -0.6075536f, +0.3145517f, +0.0476046f, +0.1998804f, +0.0780710f, +0.1339369f, -0.2899221f,
  -0.1693753f, -0.0454158f, +0.1189381f, +0.0508891f, -0.0056033f, -0.0842352f, +0.2807475f, -0.2077207f,
  -0.0238288f, -0.0355220f, -0.1020354f, -0.0585041f, +0.2056062f, +0.1026281f, -0.0188381f, -0.0663131f,
  -0.0603040f, -0.1870513f, +0.0071690f, -0.0025718f, +0.1912961f, -0.0810166f, +0.4141640f, +0.1156825f,
  +0.3324549f, +0.3222380f, -0.0247012f, +0.0139549f, +0.1572277f, -0.2076878f, +0.2082521f, +0.2228694f,
  +0.3612960f, -0.0971613f, +0.0916593f, -0.0522334f, +0.0765626f, +0.1615065f, -0.1879670f, -0.0257185f,
  -0.2221901f, -0.2173949f, +0.5288761f, +0.4176248f, -0.0560088f, -0.0512753f, +0.1778460f, -0.0497861f,
  +0.7383193f, -0.0019527f, +0.1964411f, +0.2054347f, -0.5654662f, -0.3185458f, -0.4358462f, +0.2392410f,
  +0.2204319f, -0.1476339f, -0.1566984f, +0.3132847f, +0.0755917f, -0.2925829f, -0.1483449f, -0.2164484f,
  +0.0292918f, -0.7192907f, +0.0763831f, -0.3858871f, -0.2371393f, -0.3913983f, +0.3742783f, -0.2985074f,
  -1.1511003f, -0.0529490f, -0.1004566f, +0.3698453f, -0.5743303f, +0.6762087f, +0.0993745f, -0.1888699f,
  -0.2195922f, +0.0110400f, +0.1039965f, -0.1006780f, +0.4914145f, +0.2085961f, +0.1175135f, +0.1200305f,
  +0.0433469f, -0.3438640f, -0.0194616f, +0.7709797f, +0.1200521f, -0.1395708f, +0.2183369f, +0.1035080f,
  +0.4779432f, +0.9755686f, -0.2521956f, +0.2512166f, +0.2353192f, -0.4678139f, -0.1420296f, +0.2146595f,
  -0.1241533f, -0.0200893f, -0.5120935f, +0.2526423f, +0.0802699f, -0.2148376f, +0.1124920f, +0.0802871f,
  -0.4487236f, +0.2739703f, -0.2911798f, -0.3942402f, -0.0851468f, +0.0315573f, -0.2135406f, +0.2080071f,
  -0.0093389f, -0.1703252f, -0.1699187f, -0.3936794f, +0.1712024f, +0.2257827f, +0.1881596f, -0.2257887f,
  -0.0006337f, -0.3623184f, -0.3592898f, +0.4322041f, -0.0539194f, -0.3849042f, +0.0930855f, +0.4852609f,
  +0.7413445f, +0.5557948f, +0.0270689f, -0.0224126f, -0.3316403f, -0.0713349f, +0.3361700f, +0.2383462f,
  +0.7074459f, +0.4165194f, +0.0595764f, -0.3829813f, +0.1256702f, -0.2691180f, +0.0039573f, -0.0044925f,
  +0.1094394f, -0.1928132f, -0.1351940f, +0.4128518f, -0.1916622f, -0.0095494f, -0.0472565f, -0.1156857f,
  +0.4407848f, +0.0325542f, +0.0043962f, -0.0126206f, -0.0199823f, -0.2026852f, -0.0194436f, +0.0204854f,
  -0.3547132f, +0.0752077f, +0.1631288f, -0.1198676f, -0.1862962f, +0.3393938f, -0.2033864f, +0.0217408f
);

const float biases[4] = float[4](
  +0.0045150f, +0.0423758f, +0.0113747f, -0.0048896f
);

vec4 hook() {
    const vec4 r[9][2] = vec4[9][2](
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 1.0f)))
    );

    float sum[4] = biases;
    for (int n = 0; n < 4; n++) {
        for (int i = 0; i < 9; i++) {
            const vec4 k0 = vec4(kernels[n * 8 * 9 + 8 * i + 0], kernels[n * 8 * 9 + 8 * i + 1], kernels[n * 8 * 9 + 8 * i + 2], kernels[n * 8 * 9 + 8 * i + 3]);
            const vec4 k1 = vec4(kernels[n * 8 * 9 + 8 * i + 4], kernels[n * 8 * 9 + 8 * i + 5], kernels[n * 8 * 9 + 8 * i + 6], kernels[n * 8 * 9 + 8 * i + 7]);
            sum[n] += (dot(k0, r[i][0]) + dot(k1, r[i][1]));
        }
    }

    return ACTIVE(vec4(sum[0], sum[1], sum[2], sum[3]) * 0.2000000f + TEX_BIND_L2_TEXOFF(vec2(0.0f, 0.0f)) + TEX_BIND_L3_TEXOFF(vec2(0.0f, 0.0f)));
}

//!HOOK LUMA
//!DESC ARNet b8 Layer16 L1
//!WHEN OUTPUT.w LUMA.w / 1.2 > OUTPUT.h LUMA.h / 1.2 > *
//!BIND TMP1_L0
//!BIND TMP1_L1
//!BIND TMP2_L1
//!BIND FEAT_L1
//!SAVE TMP2_L1
//!COMPONENTS 4

#define ACTIVE(v) (v)

#define TEX_BIND_L0_TEXOFF TMP1_L0_texOff
#define TEX_BIND_L0_TEX TMP1_L0_tex
#define TEX_BIND_L0_POS TMP1_L0_pos
#define TEX_BIND_L0_SIZE TMP1_L0_size
#define TEX_BIND_L0_PT TMP1_L0_pt

#define TEX_BIND_L1_TEXOFF TMP1_L1_texOff
#define TEX_BIND_L1_TEX TMP1_L1_tex
#define TEX_BIND_L1_POS TMP1_L1_pos
#define TEX_BIND_L1_SIZE TMP1_L1_size
#define TEX_BIND_L1_PT TMP1_L1_pt

#define TEX_BIND_L2_TEXOFF TMP2_L1_texOff
#define TEX_BIND_L2_TEX TMP2_L1_tex
#define TEX_BIND_L2_POS TMP2_L1_pos
#define TEX_BIND_L2_SIZE TMP2_L1_size
#define TEX_BIND_L2_PT TMP2_L1_pt

#define TEX_BIND_L3_TEXOFF FEAT_L1_texOff
#define TEX_BIND_L3_TEX FEAT_L1_tex
#define TEX_BIND_L3_POS FEAT_L1_pos
#define TEX_BIND_L3_SIZE FEAT_L1_size
#define TEX_BIND_L3_PT FEAT_L1_pt

const float kernels[288] = float[288](
  +0.0207657f, -0.0210956f, +0.0021615f, -0.0992178f, +0.0869365f, -0.0711566f, -0.2388640f, +0.0206384f,
  -0.4153673f, -0.0306906f, -0.1592215f, +0.0207597f, -0.3708463f, -0.1619186f, -0.2075254f, +0.1629240f,
  +0.3772971f, -0.4338552f, -0.2395434f, +0.2318946f, -0.3856948f, -0.0469167f, -0.3193138f, +0.1800204f,
  +0.2503060f, -0.0026973f, -0.0643922f, +0.0410431f, -0.2511980f, -0.1621057f, +0.0620904f, +0.0306828f,
  +0.1103389f, +0.0092769f, +0.3002148f, -0.5933362f, +0.0819158f, +0.1112144f, -0.1582857f, +0.1172557f,
  +0.3658418f, +0.0242010f, +0.0194811f, -0.2413680f, -0.4104707f, -0.1502997f, -0.0078494f, +0.2503849f,
  -0.0113041f, +0.0171974f, -0.0715507f, -0.0780454f, +0.2347114f, -0.0028154f, -0.0398693f, +0.1082293f,
  -0.1595795f, +0.0278180f, +0.0089611f, -0.2852175f, -0.0371327f, +0.1325732f, -0.0312812f, +0.0737987f,
  -0.1256611f, -0.1203048f, +0.0704684f, -0.3232074f, -0.2276209f, +0.1909638f, -0.0511441f, +0.1212356f,
  -0.2178997f, -0.0309239f, -0.1762359f, +0.1344178f, +0.2362187f, -0.0934882f, +0.1133890f, -0.0638335f,
  -0.1757117f, +0.0844858f, +0.1994085f, -0.1614870f, -0.0934512f, +0.4590339f, +0.2178375f, -0.1724689f,
  +0.5496580f, -0.2442043f, -0.1866402f, -0.1959403f, +0.0662078f, -0.3535384f, +0.0901428f, +0.1376099f,
  +0.2206172f, -0.0043494f, -0.0304805f, +0.2588133f, +0.1243401f, -0.0532863f, +0.5621169f, +0.3372004f,
  +0.4350615f, +0.2935421f, +0.0911938f, +0.3525889f, +0.4703580f, -0.7604387f, -0.1470827f, -0.6631461f,
  -0.3580880f, +0.6666573f, +0.2887705f, -0.0697029f, -0.0079649f, +0.5009269f, +0.0652061f, +0.1417454f,
  -0.0166737f, +0.1408192f, -0.1728204f, +0.1507463f, +0.1521500f, +0.0205985f, -0.1596292f, -0.2301544f,
  -0.2854846f, -0.0676818f, -0.1215097f, +0.5237010f, +0.1577422f, +0.0681050f, +0.2109165f, -0.1427348f,
  +0.2743515f, +0.1239389f, -0.0701059f, +0.3588558f, -0.2282709f, -0.1941874f, +0.0042716f, +0.1951714f,
  -0.0268402f, -0.0454448f, +0.1736208f, +0.1700437f, -0.0238926f, +0.0197576f, -0.1089711f, -0.0006418f,
  +0.5267122f, -0.2352248f, -0.0630111f, +0.0455324f, -0.1201007f, -0.2188677f, +0.1101824f, +0.1873485f,
  -0.0400979f, +0.1477608f, +0.0643961f, -0.1826659f, +0.0793498f, +0.1788701f, +0.1121010f, -0.0812201f,
  +0.2197990f, -0.0440735f, -0.5046802f, +0.3199711f, -0.1019573f, -0.0180495f, -0.3860044f, +0.0557926f,
  -0.1994081f, -0.3678107f, -0.3262771f, +0.6379892f, -0.4160531f, -0.3963822f, +0.2414420f, +0.1738362f,
  +0.1975222f, +0.3475419f, -0.1043446f, +0.1437074f, +0.0144524f, +0.1258349f, +0.1279187f, +0.0535075f,
  -0.0540046f, -0.1029045f, +0.2034977f, +0.0782940f, -0.2136488f, -0.0379062f, -0.1111177f, +0.2152117f,
  +0.3146659f, -0.2268298f, +0.0181072f, +0.2891574f, -0.1191762f, -0.0118365f, -0.3146147f, -0.0713140f,
  -0.3857479f, +0.3648646f, +0.0324907f, +0.0162391f, -0.0221954f, +0.2611735f, -0.4253152f, -0.0709908f,
  -0.2725559f, +0.0875413f, -0.0704566f, -0.1509535f, +0.0978308f, +0.0492002f, +0.3193423f, -0.0867414f,
  +0.1208277f, -0.1024711f, -0.0277575f, +0.0304440f, +0.0143641f, +0.2267903f, -0.1053544f, +0.0322487f,
  -0.1130108f, -0.0756976f, +0.1293059f, +0.1108489f, +0.0118012f, -0.0302948f, -0.1257758f, +0.1450359f,
  +0.0469391f, +0.1527966f, +0.1311049f, -0.3403744f, -0.0588740f, +0.0825886f, +0.3392492f, +0.2207677f,
  +0.2161615f, +0.2306292f, -0.0984207f, +0.0315522f, +0.2330792f, +0.2725277f, +0.1348615f, +0.3549663f,
  +0.1901369f, -0.1438731f, -0.4258199f, +0.0666179f, +0.0366860f, -0.0150967f, -0.0071143f, +0.1552928f,
  -0.0166586f, +0.1428692f, -0.1562535f, +0.0853596f, +0.0042560f, +0.0935255f, +0.1413309f, -0.0803700f,
  +0.1339916f, +0.1120337f, +0.1519448f, +0.1906944f, +0.0356967f, -0.1343108f, -0.0178386f, -0.2005240f,
  -0.3058503f, -0.0281225f, -0.0225179f, -0.2429663f, -0.1353181f, +0.1378887f, -0.4170110f, -0.0758255f
);

const float biases[4] = float[4](
  -0.0743779f, -0.1968048f, -0.0350547f, -0.0614546f
);

vec4 hook() {
    const vec4 r[9][2] = vec4[9][2](
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 1.0f)))
    );

    float sum[4] = biases;
    for (int n = 0; n < 4; n++) {
        for (int i = 0; i < 9; i++) {
            const vec4 k0 = vec4(kernels[n * 8 * 9 + 8 * i + 0], kernels[n * 8 * 9 + 8 * i + 1], kernels[n * 8 * 9 + 8 * i + 2], kernels[n * 8 * 9 + 8 * i + 3]);
            const vec4 k1 = vec4(kernels[n * 8 * 9 + 8 * i + 4], kernels[n * 8 * 9 + 8 * i + 5], kernels[n * 8 * 9 + 8 * i + 6], kernels[n * 8 * 9 + 8 * i + 7]);
            sum[n] += (dot(k0, r[i][0]) + dot(k1, r[i][1]));
        }
    }

    return ACTIVE(vec4(sum[0], sum[1], sum[2], sum[3]) * 0.2000000f + TEX_BIND_L2_TEXOFF(vec2(0.0f, 0.0f)) + TEX_BIND_L3_TEXOFF(vec2(0.0f, 0.0f)));
}

//!HOOK LUMA
//!DESC ARNet b8 Layer17 L0
//!WHEN OUTPUT.w LUMA.w / 1.2 > OUTPUT.h LUMA.h / 1.2 > *
//!BIND TMP2_L0
//!BIND TMP2_L1
//!SAVE TMP1_L0
//!COMPONENTS 4

#define ACTIVE(v) (v)

#define TEX_BIND_L0_TEXOFF TMP2_L0_texOff
#define TEX_BIND_L0_TEX TMP2_L0_tex
#define TEX_BIND_L0_POS TMP2_L0_pos
#define TEX_BIND_L0_SIZE TMP2_L0_size
#define TEX_BIND_L0_PT TMP2_L0_pt

#define TEX_BIND_L1_TEXOFF TMP2_L1_texOff
#define TEX_BIND_L1_TEX TMP2_L1_tex
#define TEX_BIND_L1_POS TMP2_L1_pos
#define TEX_BIND_L1_SIZE TMP2_L1_size
#define TEX_BIND_L1_PT TMP2_L1_pt

const float kernels[288] = float[288](
  -0.1835532f, -0.1732216f, +0.0615619f, +0.0727729f, +0.0534763f, -0.1888446f, -0.0349961f, +0.0951569f,
  -0.0029108f, +0.0649702f, -0.0850293f, -0.0887020f, -0.0458316f, +0.1590674f, +0.0785347f, -0.1800139f,
  -0.0398463f, -0.0837798f, +0.0499960f, +0.1511135f, +0.0633327f, -0.0680582f, +0.0557778f, +0.2063370f,
  -0.2389405f, -0.1477328f, +0.1171294f, -0.0902205f, -0.1059542f, -0.0518622f, -0.1159447f, +0.0237223f,
  -0.2561990f, +0.3325580f, -0.2766345f, -0.1964285f, -0.1950545f, +0.3220382f, +0.4386716f, +0.1320237f,
  -0.0134480f, +0.0436089f, -0.0507772f, -0.0119619f, -0.0638288f, -0.1132501f, -0.0024638f, -0.1793602f,
  +0.0412110f, +0.0217031f, -0.0113131f, +0.0220855f, +0.1311442f, -0.0375783f, +0.0359836f, +0.0612160f,
  -0.1068448f, +0.0195247f, +0.0516704f, +0.0838465f, -0.0031802f, -0.0928321f, -0.1644136f, +0.0816682f,
  -0.0243109f, -0.1515054f, +0.0755590f, +0.0852611f, +0.0447831f, +0.0329324f, -0.1190700f, +0.0272496f,
  +0.0148886f, -0.0126845f, +0.1356146f, +0.1750704f, -0.0360253f, -0.1490214f, +0.1187603f, +0.2550701f,
  -0.3343536f, -0.3036866f, -0.0334533f, -0.0123149f, +0.0807720f, -0.2244314f, -0.1808440f, -0.0807015f,
  -0.0649220f, -0.0464148f, -0.1270391f, -0.1673766f, +0.0308520f, +0.0760707f, -0.0609790f, -0.1246186f,
  -0.2963738f, +0.0599402f, -0.0690932f, -0.0757776f, -0.0108244f, -0.0838424f, +0.0935008f, +0.1520261f,
  -0.1282382f, -0.2588310f, +0.0105276f, -0.3030341f, -0.1512392f, +0.4267960f, -0.1661280f, -0.0067255f,
  -0.0027927f, +0.0598589f, -0.0318772f, -0.0785700f, +0.0623013f, -0.0924114f, +0.3115878f, -0.2140502f,
  +0.0470107f, +0.1355471f, -0.0401568f, -0.0117158f, +0.1571556f, -0.0319518f, -0.0005779f, +0.1108631f,
  +0.1351185f, -0.0754541f, +0.0819427f, +0.2304798f, +0.0210667f, +0.0587034f, -0.0452618f, -0.0784143f,
  -0.0978438f, +0.0634644f, -0.0185853f, +0.0308087f, -0.0000864f, +0.0186281f, -0.0874842f, +0.1763300f,
  -0.1119407f, -0.1855446f, +0.0547040f, +0.0069289f, +0.0991407f, -0.0084712f, -0.0535088f, -0.0368715f,
  +0.1003379f, +0.4469621f, -0.0623127f, +0.0499163f, -0.1227341f, +0.0889878f, +0.0198193f, +0.1113749f,
  +0.0123946f, -0.0445050f, -0.0731532f, -0.1703292f, +0.1432559f, -0.0306092f, +0.1121151f, -0.0601013f,
  -0.2850178f, +0.0210806f, -0.1171646f, -0.1238936f, +0.1176697f, -0.1551103f, +0.0053851f, +0.1838868f,
  +0.0933080f, -0.1958226f, +0.1893726f, +0.1359743f, -0.1452650f, +0.2864906f, +0.3884345f, +0.1648080f,
  -0.2005244f, -0.1825331f, +0.0270072f, +0.3569941f, -0.1281191f, -0.0722975f, -0.2736361f, -0.0110956f,
  -0.0177731f, -0.0984688f, +0.0996172f, +0.0996310f, -0.0138337f, -0.0330376f, -0.0691910f, +0.0162729f,
  -0.2465720f, -0.1602708f, +0.1877399f, -0.0193277f, +0.0478164f, -0.0954908f, -0.2284681f, +0.0374594f,
  +0.0073235f, +0.1921876f, -0.1638773f, -0.1891418f, +0.0932453f, +0.0380728f, +0.1517502f, -0.0428833f,
  +0.1175686f, -0.0218028f, +0.1185412f, +0.1404075f, +0.0097484f, -0.0858137f, +0.0500778f, +0.1688926f,
  -0.0436957f, +0.1064358f, +0.0001242f, +0.0528353f, -0.0210180f, -0.0496713f, -0.0349527f, +0.0155344f,
  +0.0396428f, +0.0271937f, +0.0099537f, -0.0392304f, +0.0077798f, -0.0015747f, +0.0383591f, -0.0299507f,
  -0.4311142f, -0.1569450f, -0.0739673f, -0.0732025f, -0.0009157f, -0.0941209f, +0.0330890f, +0.0210606f,
  -0.1049139f, -0.3532927f, -0.1110966f, -0.0973833f, +0.1023844f, +0.1691085f, -0.0566773f, +0.3398253f,
  +0.1427319f, +0.1240076f, -0.0358904f, +0.0981232f, +0.0312555f, +0.0821717f, -0.0576431f, +0.1120275f,
  -0.1003229f, +0.0966761f, -0.0174938f, -0.0824811f, +0.0714471f, -0.0791192f, -0.0038735f, +0.0857760f,
  +0.0057980f, -0.2713608f, +0.1700268f, +0.2390244f, +0.0904502f, +0.1764702f, -0.1703446f, -0.1396453f,
  +0.0221448f, +0.1618049f, -0.0620706f, -0.1149643f, -0.0170922f, +0.0084716f, +0.1051780f, +0.0217792f
);

const float biases[4] = float[4](
  +0.0376332f, +0.0712003f, +0.0583820f, +0.0926337f
);

vec4 hook() {
    const vec4 r[9][2] = vec4[9][2](
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f,-1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f,-1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 0.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 0.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2(-1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2(-1.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 0.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 0.0f, 1.0f))),
        vec4[2](TEX_BIND_L0_TEXOFF(vec2( 1.0f, 1.0f)), TEX_BIND_L1_TEXOFF(vec2( 1.0f, 1.0f)))
    );

    float sum[4] = biases;
    for (int n = 0; n < 4; n++) {
        for (int i = 0; i < 9; i++) {
            const vec4 k0 = vec4(kernels[n * 8 * 9 + 8 * i + 0], kernels[n * 8 * 9 + 8 * i + 1], kernels[n * 8 * 9 + 8 * i + 2], kernels[n * 8 * 9 + 8 * i + 3]);
            const vec4 k1 = vec4(kernels[n * 8 * 9 + 8 * i + 4], kernels[n * 8 * 9 + 8 * i + 5], kernels[n * 8 * 9 + 8 * i + 6], kernels[n * 8 * 9 + 8 * i + 7]);
            sum[n] += (dot(k0, r[i][0]) + dot(k1, r[i][1]));
        }
    }

    return ACTIVE(vec4(sum[0], sum[1], sum[2], sum[3]));
}

//!HOOK LUMA
//!DESC ACNet b8 Layer18 L0
//!WIDTH LUMA.w 2 *
//!HEIGHT LUMA.h 2 *
//!BIND TMP1_L0
//!COMPONENTS 1

#define TEX_BIND_L0_TEXOFF TMP1_L0_texOff
#define TEX_BIND_L0_TEX TMP1_L0_tex
#define TEX_BIND_L0_POS TMP1_L0_pos
#define TEX_BIND_L0_SIZE TMP1_L0_size
#define TEX_BIND_L0_PT TMP1_L0_pt

vec4 hook() {
    vec2 fcoord = fract(TEX_BIND_L0_POS * TEX_BIND_L0_SIZE);
    vec2 pos = TEX_BIND_L0_POS + (vec2(0.5f) - fcoord) * TEX_BIND_L0_PT;

    ivec2 icoord = ivec2(fcoord * vec2(2.0f));
    int index = icoord.y * 2 + icoord.x;

    vec4 r = TEX_BIND_L0_TEX(pos);

    return vec4(clamp(float[4](r.x, r.y, r.z, r.w)[index], 0.0f, 1.0f), 0.0f, 0.0f, 1.0f);
}
